=== Content from www.wordfence.com_1d436d61_20250111_095856.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Image Optimization by Optimole – Lazy Load, CDN, Convert WebP & AVIF <= 3.12.10 - Authenticated (Author+) Stored Cross-Site Scripting via SVG Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Image Optimization by Optimole – Lazy Load, CDN, Convert WebP & AVIF <= 3.12.10 - Authenticated (Author+) Stored Cross-Site Scripting via SVG Upload

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-4636](https://www.cve.org/CVERecord?id=CVE-2024-4636) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | May 14, 2024 |
| Last Updated | May 15, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Image Optimization by Optimole – Lazy Load, CDN, Convert WebP & AVIF plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘allow\_meme\_types’ function in versions up to, and including, 3.12.10 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with contributor-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/optimole-wp/tags/3.12.10/inc/admin.php#L1828)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3086306/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foptimole-wp%2Fimage-optimization-by-optimole-lazy-load-cdn-convert-webp-avif-31210-authenticated-author-stored-cross-site-scripting-via-svg-upload&t=Image%20Optimization%20by%20Optimole%20%E2%80%93%20Lazy%20Load%2C%20CDN%2C%20Convert%20WebP%20%26%20AVIF%20%3C%3D%203.12.10%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foptimole-wp%2Fimage-optimization-by-optimole-lazy-load-cdn-convert-webp-avif-31210-authenticated-author-stored-cross-site-scripting-via-svg-upload&text=Image%20Optimization%20by%20Optimole%20%E2%80%93%20Lazy%20Load%2C%20CDN%2C%20Convert%20WebP%20%26%20AVIF%20%3C%3D%203.12.10%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foptimole-wp%2Fimage-optimization-by-optimole-lazy-load-cdn-convert-webp-avif-31210-authenticated-author-stored-cross-site-scripting-via-svg-upload "LinkedIn")
Email

## Vulnerability Details for Image Optimization by Optimole – Lazy Load, CDN, Convert WebP & AVIF

#### [Image Optimization by Optimole – Lazy Load, CDN, Convert WebP & AVIF](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/optimole-wp)

| Software Type | Plugin |
| --- | --- |
| Software Slug | optimole-wp [(view on wordpress.org)](https://wordpress.org/plugins/optimole-wp) |
| Patched? | Yes |
| Remediation | Update to version 3.13.0, or a newer patched version |
| Affected Version | * <= 3.12.10 |
| Patched Version | * 3.13.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_3634cee4_20250111_095847.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Foptimole-wp%2Ftags%2F3.12.10%2Finc%2Fadmin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/optimole-wp/trunk/inc/admin.php?rev=3071327 "Revision 3071327")
* [Next Revision](/browser/optimole-wp/trunk/inc/admin.php?rev=3086306 "Revision 3086306") →
* [Blame](/browser/optimole-wp/trunk/inc/admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/optimole-wp/tags/3.12.10/inc/admin.php)

---

# [source:](/browser?order=name "Go to repository root") [optimole-wp](/browser/optimole-wp?order=name "View optimole-wp")/[tags](/browser/optimole-wp/tags?order=name "View tags")/[3.12.10](/browser/optimole-wp/tags/3.12.10?order=name "View 3.12.10")/[inc](/browser/optimole-wp/tags/3.12.10/inc?order=name "View inc")/[admin.php](/browser/optimole-wp/tags/3.12.10/inc/admin.php?order=name "View admin.php")

View diff against:

View revision:

| [Last change](/changeset/3072872/optimole-wp/trunk/inc/admin.php "View differences") on this file was [3072872](/changeset/3072872/ "View changeset 3072872"), checked in by optimole, [9 months ago](/timeline?from=2024-04-18T08%3A17%3A03Z&precision=second "See timeline at 04/18/2024 08:17:03 AM") |
| --- |
| Update to version 3.12.9 from GitHub |
| **File size:** 88.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Admin class. |
| [4](#L4) | \* |
| [5](#L5) | \* Author:          Andrei Baicus <andrei@themeisle.com> |
| [6](#L6) | \* Created on:      19/07/2018 |
| [7](#L7) | \* |
| [8](#L8) | \* @soundtrack Somewhere Else - Marillion |
| [9](#L9) | \* @package    \Optimole\Inc |
| [10](#L10) | \* @author     Optimole <friends@optimole.com> |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | /\*\* |
| [14](#L14) | \* Class Optml\_Admin |
| [15](#L15) | \*/ |
| [16](#L16) | class Optml\_Admin { |
| [17](#L17) | use Optml\_Normalizer; |
| [18](#L18) |  |
| [19](#L19) | const IMAGE\_DATA\_COLLECTED = 'optml\_image\_data\_collected'; |
| [20](#L20) |  |
| [21](#L21) | const IMAGE\_DATA\_COLLECTED\_BATCH = 100; |
| [22](#L22) | /\*\* |
| [23](#L23) | \* Hold the settings object. |
| [24](#L24) | \* |
| [25](#L25) | \* @var Optml\_Settings Settings object. |
| [26](#L26) | \*/ |
| [27](#L27) | public $settings; |
| [28](#L28) |  |
| [29](#L29) | /\*\* |
| [30](#L30) | \* Hold the plugin conflict object. |
| [31](#L31) | \* |
| [32](#L32) | \* @var Optml\_Conflicting\_Plugins Settings object. |
| [33](#L33) | \*/ |
| [34](#L34) | public $conflicting\_plugins; |
| [35](#L35) |  |
| [36](#L36) | const NEW\_USER\_DEFAULTS\_UPDATED = 'optml\_defaults\_updated'; |
| [37](#L37) | const OLD\_USER\_ENABLED\_LD = 'optml\_enabled\_limit\_dimensions'; |
| [38](#L38) | const OLD\_USER\_ENABLED\_CL = 'optml\_enabled\_cloud\_sites'; |
| [39](#L39) |  |
| [40](#L40) | /\*\* |
| [41](#L41) | \* Optml\_Admin constructor. |
| [42](#L42) | \*/ |
| [43](#L43) | public function \_\_construct() { |
| [44](#L44) | $this->settings            = new Optml\_Settings(); |
| [45](#L45) | $this->conflicting\_plugins = new Optml\_Conflicting\_Plugins(); |
| [46](#L46) |  |
| [47](#L47) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename( OPTML\_BASEFILE ), [ $this, 'add\_action\_links' ] ); |
| [48](#L48) | add\_action( 'admin\_menu', [ $this, 'add\_dashboard\_page' ] ); |
| [49](#L49) | add\_action( 'admin\_menu', [ $this, 'add\_settings\_subpage' ], 99 ); |
| [50](#L50) | add\_action( 'admin\_head', [ $this, 'menu\_icon\_style' ] ); |
| [51](#L51) | add\_action( 'admin\_enqueue\_scripts', [ $this, 'enqueue' ], PHP\_INT\_MIN ); |
| [52](#L52) | add\_action( 'admin\_notices', [ $this, 'add\_notice' ] ); |
| [53](#L53) | add\_action( 'admin\_notices', [ $this, 'add\_notice\_upgrade' ] ); |
| [54](#L54) | add\_action( 'admin\_notices', [ $this, 'add\_notice\_conflicts' ] ); |
| [55](#L55) | add\_action( 'optml\_daily\_sync', [ $this, 'daily\_sync' ] ); |
| [56](#L56) | add\_action( 'admin\_init', [ $this, 'redirect\_old\_dashboard' ] ); |
| [57](#L57) |  |
| [58](#L58) | if ( $this->settings->is\_connected() ) { |
| [59](#L59) | add\_action( 'init', [ $this, 'check\_domain\_change' ] ); |
| [60](#L60) | add\_action( 'optml\_pull\_image\_data\_init', [ $this, 'pull\_image\_data\_init' ] ); |
| [61](#L61) | add\_action( 'optml\_pull\_image\_data', [ $this, 'pull\_image\_data' ] ); |
| [62](#L62) |  |
| [63](#L63) | // Backwards compatibility for older versions of WordPress < 6.0.0 requiring 3 parameters for this specific filter. |
| [64](#L64) | $below\_6\_0\_0 = version\_compare( get\_bloginfo( 'version' ), '6.0.0', '<' ); |
| [65](#L65) | if ( $below\_6\_0\_0 ) { |
| [66](#L66) | add\_filter( 'wp\_insert\_attachment\_data', [ $this, 'legacy\_detect\_image\_title\_changes' ], 10, 3 ); |
| [67](#L67) | } else { |
| [68](#L68) | add\_filter( 'wp\_insert\_attachment\_data', [ $this, 'detect\_image\_title\_changes' ], 10, 4 ); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | add\_action( 'updated\_post\_meta', [ $this, 'detect\_image\_alt\_change' ], 10, 4 ); |
| [72](#L72) | add\_action( 'added\_post\_meta', [ $this, 'detect\_image\_alt\_change' ], 10, 4 ); |
| [73](#L73) | add\_action( 'init', [ $this, 'schedule\_data\_enhance\_cron' ] ); |
| [74](#L74) | } |
| [75](#L75) | add\_action( 'init', [ $this, 'update\_default\_settings' ] ); |
| [76](#L76) | add\_action( 'init', [ $this, 'update\_limit\_dimensions' ] ); |
| [77](#L77) | add\_action( 'init', [ $this, 'update\_cloud\_sites\_default' ] ); |
| [78](#L78) | add\_action( 'admin\_init', [ $this, 'maybe\_redirect' ] ); |
| [79](#L79) | add\_action( 'admin\_init', [ $this, 'init\_no\_script' ] ); |
| [80](#L80) | if ( ! is\_admin() && $this->settings->is\_connected() && ! wp\_next\_scheduled( 'optml\_daily\_sync' ) ) { |
| [81](#L81) | wp\_schedule\_event( time() + 10, 'daily', 'optml\_daily\_sync', [] ); |
| [82](#L82) | } |
| [83](#L83) | add\_action( 'optml\_after\_setup', [ $this, 'register\_public\_actions' ], 999999 ); |
| [84](#L84) |  |
| [85](#L85) | if ( ! function\_exists( 'is\_wpcom\_vip' ) ) { |
| [86](#L86) | add\_filter( |
| [87](#L87) | 'upload\_mimes', |
| [88](#L88) | [ |
| [89](#L89) | $this, |
| [90](#L90) | 'allow\_meme\_types', |
| [91](#L91) | ] |
| [92](#L92) | ); // phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.upload\_mimes |
| [93](#L93) | } |
| [94](#L94) | } |
| [95](#L95) |  |
| [96](#L96) | /\*\* |
| [97](#L97) | \* Schedules the hourly cron that starts the querying for images alt/title attributes |
| [98](#L98) | \* |
| [99](#L99) | \* @uses action: init |
| [100](#L100) | \*/ |
| [101](#L101) | public function schedule\_data\_enhance\_cron() { |
| [102](#L102) | if ( ! wp\_next\_scheduled( 'optml\_pull\_image\_data\_init' ) ) { |
| [103](#L103) | wp\_schedule\_event( time(), 'hourly', 'optml\_pull\_image\_data\_init' ); |
| [104](#L104) | } |
| [105](#L105) | } |
| [106](#L106) |  |
| [107](#L107) | /\*\* |
| [108](#L108) | \* Query the database for images and extract the alt/title to send them to the API |
| [109](#L109) | \* |
| [110](#L110) | \* @uses action: optml\_pull\_image\_data |
| [111](#L111) | \*/ |
| [112](#L112) | public function pull\_image\_data() { |
| [113](#L113) | // Get all image attachments that are not processed |
| [114](#L114) | $args        = [ |
| [115](#L115) | 'post\_type'      => 'attachment', |
| [116](#L116) | 'post\_mime\_type' => 'image', |
| [117](#L117) | 'posts\_per\_page' => self::IMAGE\_DATA\_COLLECTED\_BATCH, |
| [118](#L118) | 'meta\_query'     => [ |
| [119](#L119) | 'relation' => 'AND', |
| [120](#L120) | [ |
| [121](#L121) | 'key'     => self::IMAGE\_DATA\_COLLECTED, |
| [122](#L122) | 'compare' => 'NOT EXISTS', |
| [123](#L123) | ], |
| [124](#L124) | ], |
| [125](#L125) | ]; |
| [126](#L126) | $attachments = get\_posts( $args ); |
| [127](#L127) |  |
| [128](#L128) | $image\_data = []; |
| [129](#L129) |  |
| [130](#L130) | foreach ( $attachments as $attachment ) { |
| [131](#L131) | // Get image URL, alt, and title |
| [132](#L132) | $image\_url                = wp\_get\_attachment\_url( $attachment->ID ); |
| [133](#L133) | $image\_alt                = get\_post\_meta( $attachment->ID, '\_wp\_attachment\_image\_alt', true ); |
| [134](#L134) | $image\_title              = $attachment->post\_title; |
| [135](#L135) | $image\_data[ $image\_url ] = []; |
| [136](#L136) |  |
| [137](#L137) | if ( ! empty( $image\_alt ) ) { |
| [138](#L138) | $image\_data[ $image\_url ]['alt'] = $image\_alt; |
| [139](#L139) | } |
| [140](#L140) | if ( ! empty( $image\_title ) ) { |
| [141](#L141) | $image\_data[ $image\_url ]['title'] = $image\_title; |
| [142](#L142) | } |
| [143](#L143) | if ( empty( $image\_data[ $image\_url ] ) ) { |
| [144](#L144) | unset( $image\_data[ $image\_url ] ); |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) | // Mark the image as processed |
| [148](#L148) | update\_post\_meta( $attachment->ID, self::IMAGE\_DATA\_COLLECTED, 'yes' ); |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | if ( ! empty( $image\_data ) ) { |
| [152](#L152) | $api = new Optml\_Api(); |
| [153](#L153) | $api->call\_data\_enrich\_api( $image\_data ); |
| [154](#L154) | } |
| [155](#L155) | if ( ! empty( $attachments ) ) { |
| [156](#L156) | wp\_schedule\_single\_event( time() + 5, 'optml\_pull\_image\_data' ); |
| [157](#L157) | } |
| [158](#L158) | } |
| [159](#L159) |  |
| [160](#L160) | /\*\* |
| [161](#L161) | \* Schedule the event to pull image alt/title |
| [162](#L162) | \* |
| [163](#L163) | \* @uses action: optml\_pull\_image\_data\_init |
| [164](#L164) | \*/ |
| [165](#L165) | public function pull\_image\_data\_init() { |
| [166](#L166) | if ( ! wp\_next\_scheduled( 'optml\_pull\_image\_data' ) ) { |
| [167](#L167) | wp\_schedule\_single\_event( time() + 5, 'optml\_pull\_image\_data' ); |
| [168](#L168) | } |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | /\*\* |
| [172](#L172) | \* Delete the processed meta from an image when the alt text is changed |
| [173](#L173) | \* |
| [174](#L174) | \* @uses action: updated\_post\_meta, added\_post\_meta |
| [175](#L175) | \*/ |
| [176](#L176) | public function detect\_image\_alt\_change( $meta\_id, $post\_id, $meta\_key, $meta\_value ) { |
| [177](#L177) |  |
| [178](#L178) | // Check if the updated metadata is for alt text and it's an attachment |
| [179](#L179) | if ( $meta\_key === '\_wp\_attachment\_image\_alt' && get\_post\_type( $post\_id ) === 'attachment' ) { |
| [180](#L180) | delete\_post\_meta( $post\_id, self::IMAGE\_DATA\_COLLECTED ); |
| [181](#L181) | } |
| [182](#L182) | } |
| [183](#L183) |  |
| [184](#L184) | /\*\* |
| [185](#L185) | \* Delete the processed meta from an image when the title is changed |
| [186](#L186) | \* |
| [187](#L187) | \* @uses filter: wp\_insert\_attachment\_data |
| [188](#L188) | \*/ |
| [189](#L189) | public function detect\_image\_title\_changes( $data, $postarr, $unsanitized\_postarr, $update ) { |
| [190](#L190) |  |
| [191](#L191) | // Check if it's an attachment being updated |
| [192](#L192) | if ( $data['post\_type'] !== 'attachment' ) { |
| [193](#L193) | return $data; |
| [194](#L194) | } |
| [195](#L195) | if ( ! isset( $postarr['ID'] ) ) { |
| [196](#L196) | return $data; |
| [197](#L197) | } |
| [198](#L198) | if ( isset( $postarr['post\_title'] ) && isset( $postarr['original\_post\_title'] ) && $postarr['post\_title'] !== $postarr['original\_post\_title'] ) { |
| [199](#L199) | delete\_post\_meta( $postarr['ID'], self::IMAGE\_DATA\_COLLECTED ); |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | return $data; |
| [203](#L203) | } |
| [204](#L204) |  |
| [205](#L205) | /\*\* |
| [206](#L206) | \* Delete the processed meta from an image when the title is changed |
| [207](#L207) | \* |
| [208](#L208) | \* @uses filter: wp\_insert\_attachment\_data |
| [209](#L209) | \*/ |
| [210](#L210) | public function legacy\_detect\_image\_title\_changes( $data, $postarr, $unsanitized\_postarr ) { |
| [211](#L211) | return $this->detect\_image\_title\_changes( $data, $postarr, $unsanitized\_postarr, true ); |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | /\*\* |
| [215](#L215) | \* Init no\_script setup value based on whether the user is connected or not. |
| [216](#L216) | \*/ |
| [217](#L217) | public function init\_no\_script() { |
| [218](#L218) | if ( $this->settings->is\_connected() ) { |
| [219](#L219) | $raw\_settings = $this->settings->get\_raw\_settings(); |
| [220](#L220) | if ( ! isset( $raw\_settings['no\_script'] ) ) { |
| [221](#L221) | $this->settings->update( 'no\_script', 'enabled' ); |
| [222](#L222) | } |
| [223](#L223) | } |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | /\*\* |
| [227](#L227) | \* Checks if domain has changed |
| [228](#L228) | \*/ |
| [229](#L229) | public function check\_domain\_change() { |
| [230](#L230) | $previous\_domain = get\_option( 'optml\_current\_domain', 0 ); |
| [231](#L231) | $site\_url        = $this->to\_domain\_hash( get\_home\_url() ); |
| [232](#L232) |  |
| [233](#L233) | if ( $site\_url !== $previous\_domain ) { |
| [234](#L234) | update\_option( 'optml\_current\_domain', $site\_url ); |
| [235](#L235) | if ( $previous\_domain !== 0 ) { |
| [236](#L236) | $this->daily\_sync(); |
| [237](#L237) | } |
| [238](#L238) | } |
| [239](#L239) | } |
| [240](#L240) |  |
| [241](#L241) | /\*\* |
| [242](#L242) | \* Update the limit dimensions setting to enabled if the user is new. |
| [243](#L243) | \*/ |
| [244](#L244) | public function update\_default\_settings() { |
| [245](#L245) | if ( get\_option( self::NEW\_USER\_DEFAULTS\_UPDATED ) === 'yes' ) { |
| [246](#L246) | return; |
| [247](#L247) | } |
| [248](#L248) |  |
| [249](#L249) | if ( $this->settings->is\_connected() ) { |
| [250](#L250) | update\_option( self::NEW\_USER\_DEFAULTS\_UPDATED, 'yes' ); |
| [251](#L251) |  |
| [252](#L252) | return; |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | $this->settings->update( 'limit\_dimensions', 'enabled' ); |
| [256](#L256) | $this->settings->update( 'lazyload', 'enabled' ); |
| [257](#L257) | $this->settings->update( 'best\_format', 'disabled' ); |
| [258](#L258) | $this->settings->update( 'skip\_lazyload\_images', '2' ); |
| [259](#L259) | $this->settings->update( 'avif', 'disabled' ); |
| [260](#L260) |  |
| [261](#L261) | update\_option( self::NEW\_USER\_DEFAULTS\_UPDATED, 'yes' ); |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | /\*\* |
| [265](#L265) | \* Enable limit dimensions for old users after removing the Resize option. |
| [266](#L266) | \* |
| [267](#L267) | \* @return void |
| [268](#L268) | \*/ |
| [269](#L269) | public function update\_limit\_dimensions() { |
| [270](#L270) | if ( get\_option( self::OLD\_USER\_ENABLED\_LD ) === 'yes' ) { |
| [271](#L271) | return; |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) | // New users already have this enabled as we changed defaults. |
| [275](#L275) | if ( ! $this->settings->is\_connected() ) { |
| [276](#L276) | return; |
| [277](#L277) | } |
| [278](#L278) |  |
| [279](#L279) | $this->settings->update( 'limit\_dimensions', 'enabled' ); |
| [280](#L280) |  |
| [281](#L281) | update\_option( self::OLD\_USER\_ENABLED\_LD, 'yes' ); |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | /\*\* |
| [285](#L285) | \* Enable cloud sites and add the current site to the whitelist. |
| [286](#L286) | \* |
| [287](#L287) | \* @return void |
| [288](#L288) | \*/ |
| [289](#L289) | public function update\_cloud\_sites\_default() { |
| [290](#L290) | if ( get\_option( self::OLD\_USER\_ENABLED\_CL ) === 'yes' ) { |
| [291](#L291) | return; |
| [292](#L292) | } |
| [293](#L293) |  |
| [294](#L294) | if ( ! $this->settings->is\_connected() ) { |
| [295](#L295) | return; |
| [296](#L296) | } |
| [297](#L297) |  |
| [298](#L298) | // This is already enabled. Don't alter it. |
| [299](#L299) | if ( $this->settings->get( 'cloud\_images' ) === 'enabled' ) { |
| [300](#L300) | update\_option( self::OLD\_USER\_ENABLED\_CL, 'yes' ); |
| [301](#L301) |  |
| [302](#L302) | return; |
| [303](#L303) | } |
| [304](#L304) |  |
| [305](#L305) | $this->settings->update( 'cloud\_images', 'enabled' ); |
| [306](#L306) | $this->settings->update( 'cloud\_sites', $this->settings->get\_cloud\_sites\_whitelist\_default() ); |
| [307](#L307) |  |
| [308](#L308) | update\_option( self::OLD\_USER\_ENABLED\_CL, 'yes' ); |
| [309](#L309) | } |
| [310](#L310) |  |
| [311](#L311) | /\*\* |
| [312](#L312) | \* Adds Optimole tag to admin bar |
| [313](#L313) | \*/ |
| [314](#L314) | public function add\_report\_menu() { |
| [315](#L315) | global $wp\_admin\_bar; |
| [316](#L316) |  |
| [317](#L317) | $wp\_admin\_bar->add\_node( |
| [318](#L318) | [ |
| [319](#L319) | 'id'    => 'optml\_report\_script', |
| [320](#L320) | 'href'  => '#', |
| [321](#L321) | 'title' => '<span class="ab-icon"></span>Optimole ' . \_\_( 'debugger', 'optimole-wp' ), |
| [322](#L322) | ] |
| [323](#L323) | ); |
| [324](#L324) | $wp\_admin\_bar->add\_menu( |
| [325](#L325) | [ |
| [326](#L326) | 'id'     => 'optml\_status', |
| [327](#L327) | 'title'  => \_\_( 'Troubleshoot this page', 'optimole-wp' ), |
| [328](#L328) | 'parent' => 'optml\_report\_script', |
| [329](#L329) | ] |
| [330](#L330) | ); |
| [331](#L331) | } |
| [332](#L332) |  |
| [333](#L333) | /\*\* |
| [334](#L334) | \* Adds Optimole css to admin bar |
| [335](#L335) | \*/ |
| [336](#L336) | public function print\_report\_css() { |
| [337](#L337) | ?> |
| [338](#L338) | <style type="text/css"> |
| [339](#L339) | li#wp-admin-bar-optml\_report\_script > div :hover { |
| [340](#L340) | cursor: pointer; |
| [341](#L341) | color: #00b9eb !important; |
| [342](#L342) | text-decoration: underline; |
| [343](#L343) | } |
| [344](#L344) |  |
| [345](#L345) | #wpadminbar #wp-admin-bar-optml\_report\_script .ab-icon:before { |
| [346](#L346) | content: "\f227"; |
| [347](#L347) | top: 3px; |
| [348](#L348) | } |
| [349](#L349) |  |
| [350](#L350) | /\* The Modal (background) \*/ |
| [351](#L351) | .optml-modal { |
| [352](#L352) | display: none; /\* Hidden by default \*/ |
| [353](#L353) | position: fixed; /\* Stay in place \*/ |
| [354](#L354) | z-index: 2147483641; /\* Sit on top \*/ |
| [355](#L355) | padding-top: 100px; /\* Location of the box \*/ |
| [356](#L356) | left: 0; |
| [357](#L357) | top: 0; |
| [358](#L358) | width: 100%; /\* Full width \*/ |
| [359](#L359) | height: 100%; /\* Full height \*/ |
| [360](#L360) | overflow: auto; /\* Enable scroll if needed \*/ |
| [361](#L361) | background-color: rgb(0, 0, 0); /\* Fallback color \*/ |
| [362](#L362) | background-color: rgba(0, 0, 0, 0.4); /\* Black w/ opacity \*/ |
| [363](#L363) | } |
| [364](#L364) |  |
| [365](#L365) | /\* Modal Content \*/ |
| [366](#L366) | .optml-modal-content { |
| [367](#L367) | background-color: #fefefe; |
| [368](#L368) | margin: auto; |
| [369](#L369) | padding: 20px; |
| [370](#L370) | border: 1px solid #888; |
| [371](#L371) | width: 80%; |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | /\* The Close Button \*/ |
| [375](#L375) | .optml-close { |
| [376](#L376) | color: #aaaaaa; |
| [377](#L377) | float: right; |
| [378](#L378) | font-size: 28px; |
| [379](#L379) | font-weight: bold; |
| [380](#L380) | } |
| [381](#L381) |  |
| [382](#L382) | .optml-modal-content ul { |
| [383](#L383) | list-style: none; |
| [384](#L384) | font-size: 80%; |
| [385](#L385) | margin-top: 50px; |
| [386](#L386) | } |
| [387](#L387) |  |
| [388](#L388) | .optml-close:hover, |
| [389](#L389) | .optml-close:focus { |
| [390](#L390) | color: #000; |
| [391](#L391) | text-decoration: none; |
| [392](#L392) | cursor: pointer; |
| [393](#L393) | } |
| [394](#L394) | </style> |
| [395](#L395) | <?php |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | /\*\* |
| [399](#L399) | \* Register public actions. |
| [400](#L400) | \*/ |
| [401](#L401) | public function register\_public\_actions() { |
| [402](#L402) | add\_action( 'wp\_head', [ $this, 'generator' ] ); |
| [403](#L403) | add\_filter( 'wp\_resource\_hints', [ $this, 'add\_dns\_prefetch' ], 10, 2 ); |
| [404](#L404) |  |
| [405](#L405) | if ( Optml\_Manager::should\_ignore\_image\_tags() ) { |
| [406](#L406) | return; |
| [407](#L407) | } |
| [408](#L408) | if ( ! is\_admin() && $this->settings->get( 'report\_script' ) === 'enabled' && current\_user\_can( 'manage\_options' ) ) { |
| [409](#L409) |  |
| [410](#L410) | add\_action( 'wp\_head', [ $this, 'print\_report\_css' ] ); |
| [411](#L411) | add\_action( 'wp\_before\_admin\_bar\_render', [ $this, 'add\_report\_menu' ] ); |
| [412](#L412) | add\_action( 'wp\_enqueue\_scripts', [ $this, 'add\_diagnosis\_script' ] ); |
| [413](#L413) | } |
| [414](#L414) | if ( ! $this->settings->use\_lazyload() |
| [415](#L415) | || ( $this->settings->get( 'native\_lazyload' ) === 'enabled' |
| [416](#L416) | && $this->settings->get( 'video\_lazyload' ) === 'disabled' |
| [417](#L417) | && $this->settings->get( 'bg\_replacer' ) === 'disabled' ) ) { |
| [418](#L418) | return; |
| [419](#L419) | } |
| [420](#L420) | add\_action( 'wp\_enqueue\_scripts', [ $this, 'frontend\_scripts' ] ); |
| [421](#L421) | add\_action( 'wp\_head', [ $this, 'inline\_bootstrap\_script' ] ); |
| [422](#L422) |  |
| [423](#L423) | add\_filter( 'optml\_additional\_html\_classes', [ $this, 'add\_no\_js\_class\_to\_html\_tag' ], 10 ); |
| [424](#L424) | } |
| [425](#L425) |  |
| [426](#L426) | /\*\* |
| [427](#L427) | \* Use filter to add additional class to html tag. |
| [428](#L428) | \* |
| [429](#L429) | \* @param array $classes The classes to be added. |
| [430](#L430) | \* |
| [431](#L431) | \* @return array |
| [432](#L432) | \*/ |
| [433](#L433) | public function add\_no\_js\_class\_to\_html\_tag( $classes ) { |
| [434](#L434) | // we need the space padding since some plugins might not target correctly with js there own classes |
| [435](#L435) | // this causes some issues if they concat directly, this way we can protect against that since no matter what |
| [436](#L436) | // there will be an extra space padding so that classes can be easily identified |
| [437](#L437) | return array\_merge( $classes, [ ' optml\_no\_js ' ] ); |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) | /\*\* |
| [441](#L441) | \* Adds script for lazyload/js replacement. |
| [442](#L442) | \*/ |
| [443](#L443) | public function inline\_bootstrap\_script() { |
| [444](#L444) | $domain = 'https://' . $this->settings->get\_cdn\_url() . '/js-lib'; |
| [445](#L445) |  |
| [446](#L446) | if ( defined( 'OPTML\_JS\_CDN' ) && constant( 'OPTML\_JS\_CDN' ) ) { |
| [447](#L447) | $domain = 'https://' . constant( 'OPTML\_JS\_CDN' ) . '/js-lib'; |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) | $min                   = ! OPTML\_DEBUG ? '.min' : ''; |
| [451](#L451) | $bgclasses             = Optml\_Lazyload\_Replacer::get\_lazyload\_bg\_classes(); |
| [452](#L452) | $watcher\_classes       = Optml\_Lazyload\_Replacer::get\_watcher\_lz\_classes(); |
| [453](#L453) | $lazyload\_bg\_selectors = Optml\_Lazyload\_Replacer::get\_background\_lazyload\_selectors(); |
| [454](#L454) | foreach ( $bgclasses as $key ) { |
| [455](#L455) | $lazyload\_bg\_selectors[] = '.' . $key; |
| [456](#L456) | } |
| [457](#L457) | $lazyload\_bg\_selectors = empty( $lazyload\_bg\_selectors ) ? '' : sprintf( '%s', implode( ', ', (array) $lazyload\_bg\_selectors ) ); |
| [458](#L458) | $bgclasses             = empty( $bgclasses ) ? '' : sprintf( '"%s"', implode( '","', (array) $bgclasses ) ); |
| [459](#L459) | $watcher\_classes       = empty( $watcher\_classes ) ? '' : sprintf( '"%s"', implode( '","', (array) $watcher\_classes ) ); |
| [460](#L460) | $default\_network       = ( $this->settings->get( 'network\_optimization' ) === 'enabled' ); |
| [461](#L461) | $limit\_dimensions      = $this->settings->get( 'limit\_dimensions' ) === 'enabled'; |
| [462](#L462) | $limit\_width           = $limit\_dimensions ? $this->settings->get( 'limit\_width' ) : 0; |
| [463](#L463) | $limit\_height          = $limit\_dimensions ? $this->settings->get( 'limit\_height' ) : 0; |
| [464](#L464) | $retina\_ready          = $limit\_dimensions || |
| [465](#L465) | ! ( $this->settings->get( 'retina\_images' ) === 'enabled' ); |
| [466](#L466) | $scale\_is\_disabled     = ( $this->settings->get( 'scale' ) === 'enabled' ); |
| [467](#L467) | $native\_lazy\_enabled   = ( $this->settings->get( 'native\_lazyload' ) === 'enabled' ); |
| [468](#L468) | $output                = sprintf( |
| [469](#L469) | ' |
| [470](#L470) | <style type="text/css"> |
| [471](#L471) | img[data-opt-src]:not([data-opt-lazy-loaded]) { |
| [472](#L472) | transition: .2s filter linear, .2s opacity linear, .2s border-radius linear; |
| [473](#L473) | -webkit-transition: .2s filter linear, .2s opacity linear, .2s border-radius linear; |
| [474](#L474) | -moz-transition: .2s filter linear, .2s opacity linear, .2s border-radius linear; |
| [475](#L475) | -o-transition: .2s filter linear, .2s opacity linear, .2s border-radius linear; |
| [476](#L476) | } |
| [477](#L477) | img[data-opt-src]:not([data-opt-lazy-loaded]) { |
| [478](#L478) | opacity: .75; |
| [479](#L479) | -webkit-filter: blur(8px); |
| [480](#L480) | -moz-filter: blur(8px); |
| [481](#L481) | -o-filter: blur(8px); |
| [482](#L482) | -ms-filter: blur(8px); |
| [483](#L483) | filter: blur(8px); |
| [484](#L484) | transform: scale(1.04); |
| [485](#L485) | animation: 0.1s ease-in; |
| [486](#L486) | -webkit-transform: translate3d(0, 0, 0); |
| [487](#L487) | } |
| [488](#L488) | %s |
| [489](#L489) | </style> |
| [490](#L490) | <script type="application/javascript"> |
| [491](#L491) | document.documentElement.className = document.documentElement.className.replace(/\boptml\_no\_js\b/g, ""); |
| [492](#L492) | (function(w, d){ |
| [493](#L493) | var b = d.getElementsByTagName("head")[0]; |
| [494](#L494) | var s = d.createElement("script"); |
| [495](#L495) | var v = ("IntersectionObserver" in w && "isIntersecting" in w.IntersectionObserverEntry.prototype) ? "\_no\_poly" : ""; |
| [496](#L496) | s.async = true; |
| [497](#L497) | s.src = "%s/v2/latest/optimole\_lib" + v  + "%s.js"; |
| [498](#L498) | b.appendChild(s); |
| [499](#L499) | w.optimoleData = { |
| [500](#L500) | lazyloadOnly: "optimole-lazy-only", |
| [501](#L501) | backgroundReplaceClasses: [%s], |
| [502](#L502) | nativeLazyload : %s, |
| [503](#L503) | scalingDisabled: %s, |
| [504](#L504) | watchClasses: [%s], |
| [505](#L505) | backgroundLazySelectors: "%s", |
| [506](#L506) | network\_optimizations: %s, |
| [507](#L507) | ignoreDpr: %s, |
| [508](#L508) | quality: %d, |
| [509](#L509) | maxWidth: %d, |
| [510](#L510) | maxHeight: %d, |
| [511](#L511) | } |
| [512](#L512) | }(window, document)); |
| [513](#L513) | </script>', |
| [514](#L514) | Optml\_Lazyload\_Replacer::IFRAME\_TEMP\_COMMENT, |
| [515](#L515) | esc\_url( $domain ), |
| [516](#L516) | $min, |
| [517](#L517) | wp\_strip\_all\_tags( $bgclasses ), |
| [518](#L518) | $native\_lazy\_enabled ? 'true' : 'false', |
| [519](#L519) | $scale\_is\_disabled ? 'true' : 'false', |
| [520](#L520) | wp\_strip\_all\_tags( $watcher\_classes ), |
| [521](#L521) | addcslashes( wp\_strip\_all\_tags( $lazyload\_bg\_selectors ), '"' ), |
| [522](#L522) | defined( 'OPTML\_NETWORK\_ON' ) && constant( 'OPTML\_NETWORK\_ON' ) ? ( OPTML\_NETWORK\_ON ? 'true' : 'false' ) : ( $default\_network ? 'true' : 'false' ), |
| [523](#L523) | $retina\_ready ? 'true' : 'false', |
| [524](#L524) | $this->settings->get\_numeric\_quality(), |
| [525](#L525) | $limit\_width, |
| [526](#L526) | $limit\_height |
| [527](#L527) | ); |
| [528](#L528) | echo $output; |
| [529](#L529) | } |
| [530](#L530) |  |
| [531](#L531) | /\*\* |
| [532](#L532) | \* Adds script for lazyload/js replacement. |
| [533](#L533) | \*/ |
| [534](#L534) | public function add\_diagnosis\_script() { |
| [535](#L535) |  |
| [536](#L536) | wp\_enqueue\_script( 'optml-report', OPTML\_URL . 'assets/js/report\_script.js' ); |
| [537](#L537) | $ignored\_domains = [ 'gravatar.com', 'instagram.com', 'fbcdn' ]; |
| [538](#L538) | $report\_script   = [ |
| [539](#L539) | 'optmlCdn'       => $this->settings->get\_cdn\_url(), |
| [540](#L540) | 'restUrl'        => untrailingslashit( rest\_url( OPTML\_NAMESPACE . '/v1' ) ) . '/check\_redirects', |
| [541](#L541) | 'nonce'          => wp\_create\_nonce( 'wp\_rest' ), |
| [542](#L542) | 'ignoredDomains' => $ignored\_domains, |
| [543](#L543) | 'wait'           => \_\_( 'We are checking the current page for any issues with optimized images ...', 'optimole-wp' ), |
| [544](#L544) | 'description'    => \_\_( 'Optimole page analyzer', 'optimole-wp' ), |
| [545](#L545) | ]; |
| [546](#L546) | wp\_localize\_script( 'optml-report', 'reportScript', $report\_script ); |
| [547](#L547) | } |
| [548](#L548) |  |
| [549](#L549) | /\*\* |
| [550](#L550) | \* Add settings links in the plugin listing page. |
| [551](#L551) | \* |
| [552](#L552) | \* @param array $links Old plugin links. |
| [553](#L553) | \* |
| [554](#L554) | \* @return array Altered links. |
| [555](#L555) | \*/ |
| [556](#L556) | function add\_action\_links( $links ) { |
| [557](#L557) | if ( ! is\_array( $links ) ) { |
| [558](#L558) | return $links; |
| [559](#L559) | } |
| [560](#L560) |  |
| [561](#L561) | return array\_merge( |
| [562](#L562) | $links, |
| [563](#L563) | [ |
| [564](#L564) | '<a href="' . admin\_url( 'admin.php?page=optimole' ) . '">' . \_\_( 'Settings', 'optimole-wp' ) . '</a>', |
| [565](#L565) | ] |
| [566](#L566) | ); |
| [567](#L567) | } |
| [568](#L568) |  |
| [569](#L569) | /\*\* |
| [570](#L570) | \* Check if we should show the notice. |
| [571](#L571) | \* |
| [572](#L572) | \* @return bool Should show? |
| [573](#L573) | \*/ |
| [574](#L574) | public function should\_show\_notice() { |
| [575](#L575) | if ( ( defined( 'DOING\_AJAX' ) && DOING\_AJAX ) ) { |
| [576](#L576) | return false; |
| [577](#L577) | } |
| [578](#L578) |  |
| [579](#L579) | if ( is\_network\_admin() ) { |
| [580](#L580) | return false; |
| [581](#L581) | } |
| [582](#L582) |  |
| [583](#L583) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [584](#L584) | return false; |
| [585](#L585) | } |
| [586](#L586) |  |
| [587](#L587) | if ( $this->settings->is\_connected() ) { |
| [588](#L588) | return false; |
| [589](#L589) | } |
| [590](#L590) |  |
| [591](#L591) | $current\_screen = get\_current\_screen(); |
| [592](#L592) |  |
| [593](#L593) | if ( empty( $current\_screen ) ) { |
| [594](#L594) | return false; |
| [595](#L595) | } |
| [596](#L596) |  |
| [597](#L597) | if ( ( get\_option( 'optml\_notice\_optin', 'no' ) === 'yes' ) ) { |
| [598](#L598) | return false; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | return true; |
| [602](#L602) | } |
| [603](#L603) |  |
| [604](#L604) | /\*\* |
| [605](#L605) | \* Show upgrade notice. |
| [606](#L606) | \*/ |
| [607](#L607) | public function add\_notice\_upgrade() { |
| [608](#L608) | if ( ! $this->should\_show\_upgrade() ) { |
| [609](#L609) | return; |
| [610](#L610) | } |
| [611](#L611) | ?> |
| [612](#L612) | <div class="notice optml-notice-optin" |
| [613](#L613) | style="background-color: #577BF9; color:white; border: none !important; display: flex;"> |
| [614](#L614) | <div style="margin: 1% 2%;"> |
| [615](#L615) | <img src='<?php echo OPTML\_URL . 'assets/img/upgrade\_icon.png'; ?>'> |
| [616](#L616) | </div> |
| [617](#L617) | <div style="margin-top: 0.7%;"> |
| [618](#L618) | <p style="font-size: 16px !important;"> |
| [619](#L619) | <?php |
| [620](#L620) | printf( |
| [621](#L621) | /\* translators: 1 - opening strong tag, 2 - visits limit, 3 - closing strong tag, 4 - opening strong tag, 5 - closing strong tag, 6 -  br tag \*/ |
| [622](#L622) | \_\_( '%1$sIt seems you are close to the %2$s visits limit with %3$sOptimole%4$s for this month.%5$s %6$s For a larger quota you may want to check the upgrade plans. If you exceed the quota we will need to deliver back your original, un-optimized images, which might decrease your site speed performance.', 'optimole-wp' ), |
| [623](#L623) | '<strong>', |
| [624](#L624) | number\_format\_i18n( 1000 ), |
| [625](#L625) | '</strong>', |
| [626](#L626) | '<strong>', |
| [627](#L627) | '</strong>', |
| [628](#L628) | '<br/><br/>' |
| [629](#L629) | ); |
| [630](#L630) | ?> |
| [631](#L631) | </p> |
| [632](#L632) | <p style="margin: 1.5% 0;"> |
| [633](#L633) | <a href="<?php echo esc\_url( tsdk\_translate\_link( 'https://optimole.com/pricing' ) ); ?>" |
| [634](#L634) | target="\_blank" |
| [635](#L635) | style="border-radius: 4px;padding: 9px 10px;border: 2px solid #FFF;color: white;text-decoration: none;"><?php \_e( 'Check upgrade plans', 'optimole-wp' ); ?> |
| [636](#L636) | </a> |
| [637](#L637) | <a style="padding: 2%; color: white;" |
| [638](#L638) | href="<?php echo wp\_nonce\_url( add\_query\_arg( [ 'optml\_hide\_upg' => 'yes' ] ), 'hide\_nonce', 'optml\_nonce' ); ?>"><?php \_e( 'I have already done this', 'optimole-wp' ); ?></a> |
| [639](#L639) | </p> |
| [640](#L640) | </div> |
| [641](#L641) | </div> |
| [642](#L642) | <?php |
| [643](#L643) | } |
| [644](#L644) |  |
| [645](#L645) | /\*\* |
| [646](#L646) | \* Check if we should show the upgrade notice to users. |
| [647](#L647) | \* |
| [648](#L648) | \* @return bool Should we show it? |
| [649](#L649) | \*/ |
| [650](#L650) | public function should\_show\_upgrade() { |
| [651](#L651) | $current\_screen = get\_current\_screen(); |
| [652](#L652) | if ( ( defined( 'DOING\_AJAX' ) && DOING\_AJAX ) || |
| [653](#L653) | is\_network\_admin() || |
| [654](#L654) | ! current\_user\_can( 'manage\_options' ) || |
| [655](#L655) | ! $this->settings->is\_connected() || |
| [656](#L656) | empty( $current\_screen ) |
| [657](#L657) | ) { |
| [658](#L658) | return false; |
| [659](#L659) | } |
| [660](#L660) | if ( get\_option( 'optml\_notice\_hide\_upg', 'no' ) === 'yes' ) { |
| [661](#L661) | return false; |
| [662](#L662) | } |
| [663](#L663) | if ( $current\_screen->base !== 'upload' ) { |
| [664](#L664) | return false; |
| [665](#L665) | } |
| [666](#L666) | $service\_data = $this->settings->get( 'service\_data' ); |
| [667](#L667) | if ( ! isset( $service\_data['plan'] ) ) { |
| [668](#L668) | return false; |
| [669](#L669) | } |
| [670](#L670) | if ( $service\_data['plan'] !== 'free' ) { |
| [671](#L671) | return false; |
| [672](#L672) | } |
| [673](#L673) | $visitors\_limit = isset( $service\_data['visitors\_limit'] ) ? (int) $service\_data['visitors\_limit'] : 0; |
| [674](#L674) | $visitors\_left  = isset( $service\_data['visitors\_left'] ) ? (int) $service\_data['visitors\_left'] : 0; |
| [675](#L675) | if ( $visitors\_limit === 0 ) { |
| [676](#L676) | return false; |
| [677](#L677) | } |
| [678](#L678) | if ( $visitors\_left > 300 ) { |
| [679](#L679) | return false; |
| [680](#L680) | } |
| [681](#L681) |  |
| [682](#L682) | return true; |
| [683](#L683) | } |
| [684](#L684) |  |
| [685](#L685) | /\*\* |
| [686](#L686) | \* CSS styles for Notice. |
| [687](#L687) | \*/ |
| [688](#L688) | public static function notice\_styles() { |
| [689](#L689) | ?> |
| [690](#L690) | <style> |
| [691](#L691) | .optml-notice-optin:not(.has-dismiss) { |
| [692](#L692) | background: url(" <?php echo esc\_attr( OPTML\_URL . '/assets/img/disconnected.svg' ); ?> ") #fff 100% 0 no-repeat; |
| [693](#L693) | position: relative; |
| [694](#L694) | padding: 0; |
| [695](#L695) | } |
| [696](#L696) |  |
| [697](#L697) | .optml-notice-optin.has-dismiss { |
| [698](#L698) | position: relative; |
| [699](#L699) | } |
| [700](#L700) |  |
| [701](#L701) | .optml-notice-optin .content { |
| [702](#L702) | background: rgba(255, 255, 255, 0.75); |
| [703](#L703) | display: flex; |
| [704](#L704) | align-items: center; |
| [705](#L705) | padding: 20px; |
| [706](#L706) | } |
| [707](#L707) |  |
| [708](#L708) | .optml-notice-optin img { |
| [709](#L709) | max-width: 100px; |
| [710](#L710) | margin-right: 20px; |
| [711](#L711) | display: none; |
| [712](#L712) | } |
| [713](#L713) |  |
| [714](#L714) | .optml-notice-optin .description { |
| [715](#L715) | font-size: 14px; |
| [716](#L716) | margin-bottom: 20px; |
| [717](#L717) | color: #000; |
| [718](#L718) | } |
| [719](#L719) |  |
| [720](#L720) | .optml-notice-optin .actions { |
| [721](#L721) | margin-top: auto; |
| [722](#L722) | display: flex; |
| [723](#L723) | gap: 20px; |
| [724](#L724) | } |
| [725](#L725) |  |
| [726](#L726) | @media screen and (min-width: 768px) { |
| [727](#L727) | .optml-notice-optin img { |
| [728](#L728) | display: block; |
| [729](#L729) | } |
| [730](#L730) | } |
| [731](#L731) | </style> |
| [732](#L732) | <?php |
| [733](#L733) | } |
| [734](#L734) |  |
| [735](#L735) | /\*\* |
| [736](#L736) | \* JS for Notice. |
| [737](#L737) | \*/ |
| [738](#L738) | public static function notice\_js( $action ) { |
| [739](#L739) | ?> |
| [740](#L740) | <script> |
| [741](#L741) | jQuery(document).ready(function ($) { |
| [742](#L742) | // AJAX request to update the option value |
| [743](#L743) | $('.optml-notice-optin button.notice-dismiss').click(function (e) { |
| [744](#L744) | e.preventDefault(); |
| [745](#L745) |  |
| [746](#L746) | var notice = $(this).closest('.optml-notice-optin'); |
| [747](#L747) | var nonce = '<?php echo esc\_attr( wp\_create\_nonce( $action ) ); ?>'; |
| [748](#L748) |  |
| [749](#L749) | $.ajax({ |
| [750](#L750) | url: window.ajaxurl, |
| [751](#L751) | type: 'POST', |
| [752](#L752) | data: { |
| [753](#L753) | action: '<?php echo esc\_attr( $action ); ?>', |
| [754](#L754) | nonce |
| [755](#L755) | }, |
| [756](#L756) | complete() { |
| [757](#L757) | notice.remove(); |
| [758](#L758) | } |
| [759](#L759) | }); |
| [760](#L760) | }); |
| [761](#L761) | }); |
| [762](#L762) | </script> |
| [763](#L763) | <?php |
| [764](#L764) | } |
| [765](#L765) |  |
| [766](#L766) | /\*\* |
| [767](#L767) | \* Adds opt in notice. |
| [768](#L768) | \*/ |
| [769](#L769) | public function add\_notice() { |
| [770](#L770) | if ( ! $this->should\_show\_notice() ) { |
| [771](#L771) | return; |
| [772](#L772) | } |
| [773](#L773) |  |
| [774](#L774) | self::notice\_styles(); |
| [775](#L775) | ?> |
| [776](#L776) | <div class="notice notice-info optml-notice-optin"> |
| [777](#L777) | <div class="content"> |
| [778](#L778) | <img src="<?php echo OPTML\_URL . '/assets/img/logo.svg'; ?>" |
| [779](#L779) | alt="<?php echo esc\_attr\_\_( 'Logo', 'optimole-wp' ); ?>"/> |
| [780](#L780) |  |
| [781](#L781) | <div> |
| [782](#L782) | <p class="notice-title"> <?php echo esc\_html\_\_( 'Finish setting up!', 'optimole-wp' ); ?></p> |
| [783](#L783) | <p class="description"> |
| [784](#L784) | <?php |
| [785](#L785) | printf( |
| [786](#L786) | /\* translators: 1 - opening strong tag, 2 - closing strong tag, 3 - opening strong tag, 4 - closing strong tag \*/ |
| [787](#L787) | \_\_( 'Welcome to %1$sOptimole%2$s, the easiest way to optimize your website images. Your users will enjoy a %3$sfaster%4$s website after you connect it with our service.', 'optimole-wp' ), |
| [788](#L788) | '<strong>', |
| [789](#L789) | '</strong>', |
| [790](#L790) | '<strong>', |
| [791](#L791) | '</strong>' |
| [792](#L792) | ); |
| [793](#L793) | ?> |
| [794](#L794) | </p> |
| [795](#L795) | <div class="actions"> |
| [796](#L796) | <a href="<?php echo esc\_url( admin\_url( 'admin.php?page=optimole' ) ); ?>" |
| [797](#L797) | class="button button-primary button-hero"><?php \_e( 'Connect to OptiMole', 'optimole-wp' ); ?> |
| [798](#L798) | </a> |
| [799](#L799) | <a class="button button-secondary button-hero" |
| [800](#L800) | href="<?php echo wp\_nonce\_url( add\_query\_arg( [ 'optml\_hide\_optin' => 'yes' ] ), 'hide\_nonce', 'optml\_nonce' ); ?>"><?php \_e( 'I will do it later', 'optimole-wp' ); ?> |
| [801](#L801) | </a> |
| [802](#L802) | </div> |
| [803](#L803) | </div> |
| [804](#L804) | </div> |
| [805](#L805) | </div> |
| [806](#L806) | <?php |
| [807](#L807) | } |
| [808](#L808) |  |
| [809](#L809) | /\*\* |
| [810](#L810) | \* Adds conflicts notice. |
| [811](#L811) | \*/ |
| [812](#L812) | public function add\_notice\_conflicts() { |
| [813](#L813) | if ( $this->settings->is\_connected() || ! $this->conflicting\_plugins->should\_show\_notice() ) { |
| [814](#L814) | return; |
| [815](#L815) | } |
| [816](#L816) |  |
| [817](#L817) | $plugins = $this->conflicting\_plugins->get\_conflicting\_plugins(); |
| [818](#L818) | $names   = []; |
| [819](#L819) |  |
| [820](#L820) | foreach ( $plugins as $plugin ) { |
| [821](#L821) | $plugin\_data = get\_plugin\_data( WP\_PLUGIN\_DIR . DIRECTORY\_SEPARATOR . $plugin ); |
| [822](#L822) | $names[]     = $plugin\_data['Name']; |
| [823](#L823) | } |
| [824](#L824) |  |
| [825](#L825) | $names = implode( ', ', $names ); |
| [826](#L826) |  |
| [827](#L827) | self::notice\_styles(); |
| [828](#L828) | self::notice\_js( 'optml\_dismiss\_conflict\_notice' ); |
| [829](#L829) | ?> |
| [830](#L830) | <div class="notice notice-info optml-notice-optin has-dismiss"> |
| [831](#L831) | <div class="content"> |
| [832](#L832) | <img src="<?php echo OPTML\_URL . '/assets/img/logo.svg'; ?>" |
| [833](#L833) | alt="<?php echo esc\_attr\_\_( 'Logo', 'optimole-wp' ); ?>"/> |
| [834](#L834) |  |
| [835](#L835) | <div> |
| [836](#L836) | <p class="notice-title"> |
| [837](#L837) | <strong><?php echo esc\_html\_\_( 'Oops... Multiple image optimization plugins active', 'optimole-wp' ); ?></strong> |
| [838](#L838) | </p> |
| [839](#L839) | <p class="description"> |
| [840](#L840) | <?php |
| [841](#L841) | printf( |
| [842](#L842) | /\* translators: 1 - plugin name, 2 - opening bold tag, 3 - closing bold tag \*/ |
| [843](#L843) | \_\_( 'We noticed multiple image optimization plugins active on your site, which may cause issues in Optimole. We recommend using only one image optimization plugin on your site for the best results. The following plugins may cause issues in Optimole: %2$s%1$s%3$s.', 'optimole-wp' ), |
| [844](#L844) | $names, |
| [845](#L845) | '<strong>', |
| [846](#L846) | '</strong>' |
| [847](#L847) | ); |
| [848](#L848) | ?> |
| [849](#L849) | </p> |
| [850](#L850) | <div class="actions"> |
| [851](#L851) | <a href="<?php echo esc\_url( admin\_url( 'plugins.php?optimole\_conflicts' ) ); ?>" |
| [852](#L852) | class="button button-primary button-hero"><?php \_e( 'Manage Plugins', 'optimole-wp' ); ?> |
| [853](#L853) | </a> |
| [854](#L854) | </div> |
| [855](#L855) | </div> |
| [856](#L856) | </div> |
| [857](#L857) |  |
| [858](#L858) | <button type="button" class="notice-dismiss"> |
| [859](#L859) | <span class="screen-reader-text"><?php \_e( 'Dismiss this notice.', 'optimole-wp' ); ?></span> |
| [860](#L860) | </button> |
| [861](#L861) | </div> |
| [862](#L862) | <?php |
| [863](#L863) | } |
| [864](#L864) |  |
| [865](#L865) | /\*\* |
| [866](#L866) | \* Add style classes for lazy loading background images. |
| [867](#L867) | \*/ |
| [868](#L868) | protected function get\_background\_lazy\_css() { |
| [869](#L869) |  |
| [870](#L870) | $watchers = Optml\_Lazyload\_Replacer::get\_background\_lazyload\_selectors(); |
| [871](#L871) |  |
| [872](#L872) | $css = []; |
| [873](#L873) | foreach ( $watchers as $selector ) { |
| [874](#L874) | $css[] = 'html ' . $selector . ':not(.optml-bg-lazyloaded)'; |
| [875](#L875) | } |
| [876](#L876) | if ( empty( $css ) ) { |
| [877](#L877) | return ''; |
| [878](#L878) | } |
| [879](#L879) | $css = implode( ",\n", $css ) . ' { background-image: none !important; } '; |
| [880](#L880) |  |
| [881](#L881) | return strip\_tags( $css ); |
| [882](#L882) | } |
| [883](#L883) |  |
| [884](#L884) | /\*\* |
| [885](#L885) | \* Enqueue frontend scripts. |
| [886](#L886) | \*/ |
| [887](#L887) | public function frontend\_scripts() { |
| [888](#L888) |  |
| [889](#L889) | $bg\_css = $this->get\_background\_lazy\_css(); |
| [890](#L890) |  |
| [891](#L891) | wp\_register\_style( 'optm\_lazyload\_noscript\_style', false ); |
| [892](#L892) | wp\_enqueue\_style( 'optm\_lazyload\_noscript\_style' ); |
| [893](#L893) | wp\_add\_inline\_style( 'optm\_lazyload\_noscript\_style', "html.optml\_no\_js img[data-opt-src] { display: none !important; } \n " . $bg\_css ); |
| [894](#L894) |  |
| [895](#L895) | if ( $this->settings->use\_lazyload() === true ) { |
| [896](#L896) | wp\_register\_script( 'optml-print', false ); |
| [897](#L897) | wp\_enqueue\_script( 'optml-print' ); |
| [898](#L898) | $script = ' |
| [899](#L899) | (function(w, d){ |
| [900](#L900) | w.addEventListener("beforeprint", function(){ |
| [901](#L901) | let images = d.getElementsByTagName( "img" ); |
| [902](#L902) | for (let img of images) { |
| [903](#L903) | if ( !img.dataset.optSrc) { |
| [904](#L904) | continue; |
| [905](#L905) | } |
| [906](#L906) | img.src = img.dataset.optSrc; |
| [907](#L907) | delete img.dataset.optSrc; |
| [908](#L908) | } |
| [909](#L909) | }); |
| [910](#L910) |  |
| [911](#L911) | }(window, document)); |
| [912](#L912) | '; |
| [913](#L913) | wp\_add\_inline\_script( 'optml-print', $script ); |
| [914](#L914) | } |
| [915](#L915) |  |
| [916](#L916) | } |
| [917](#L917) |  |
| [918](#L918) | /\*\* |
| [919](#L919) | \* Maybe redirect to dashboard page. |
| [920](#L920) | \*/ |
| [921](#L921) | public function maybe\_redirect() { |
| [922](#L922) | if ( isset( $\_GET['optml\_nonce'] ) && isset( $\_GET['optml\_hide\_optin'] ) && $\_GET['optml\_hide\_optin'] === 'yes' && wp\_verify\_nonce( $\_GET['optml\_nonce'], 'hide\_nonce' ) ) { |
| [923](#L923) | update\_option( 'optml\_notice\_optin', 'yes' ); |
| [924](#L924) | } |
| [925](#L925) |  |
| [926](#L926) | if ( isset( $\_GET['optml\_nonce'] ) && isset( $\_GET['optml\_hide\_upg'] ) && $\_GET['optml\_hide\_upg'] === 'yes' && wp\_verify\_nonce( $\_GET['optml\_nonce'], 'hide\_nonce' ) ) { |
| [927](#L927) | update\_option( 'optml\_notice\_hide\_upg', 'yes' ); |
| [928](#L928) | } |
| [929](#L929) |  |
| [930](#L930) | if ( ! get\_transient( 'optml\_fresh\_install' ) ) { |
| [931](#L931) | return; |
| [932](#L932) | } |
| [933](#L933) |  |
| [934](#L934) | if ( defined( 'DOING\_AJAX' ) && DOING\_AJAX ) { |
| [935](#L935) | return; |
| [936](#L936) | } |
| [937](#L937) |  |
| [938](#L938) | delete\_transient( 'optml\_fresh\_install' ); |
| [939](#L939) |  |
| [940](#L940) | if ( is\_network\_admin() || isset( $\_GET['activate-multi'] ) ) { |
| [941](#L941) | return; |
| [942](#L942) | } |
| [943](#L943) |  |
| [944](#L944) | if ( $this->settings->is\_connected() ) { |
| [945](#L945) | return; |
| [946](#L946) | } |
| [947](#L947) |  |
| [948](#L948) | wp\_safe\_redirect( admin\_url( 'admin.php?page=optimole' ) ); |
| [949](#L949) | exit; |
| [950](#L950) | } |
| [951](#L951) |  |
| [952](#L952) | /\*\* |
| [953](#L953) | \* Output Generator tag. |
| [954](#L954) | \*/ |
| [955](#L955) | public function generator() { |
| [956](#L956) | if ( ! $this->settings->is\_connected() ) { |
| [957](#L957) | return; |
| [958](#L958) | } |
| [959](#L959) | if ( ! $this->settings->is\_enabled() ) { |
| [960](#L960) | return; |
| [961](#L961) | } |
| [962](#L962) | echo '<meta name="generator" content="Optimole ' . esc\_attr( OPTML\_VERSION ) . '">'; |
| [963](#L963) | } |
| [964](#L964) |  |
| [965](#L965) | /\*\* |
| [966](#L966) | \* Update daily the quota routine. |
| [967](#L967) | \*/ |
| [968](#L968) | function daily\_sync() { |
| [969](#L969) |  |
| [970](#L970) | $api\_key      = $this->settings->get( 'api\_key' ); |
| [971](#L971) | $service\_data = $this->settings->get( 'service\_data' ); |
| [972](#L972) | $application  = ''; |
| [973](#L973) |  |
| [974](#L974) | if ( isset( $service\_data['cdn\_key'] ) ) { |
| [975](#L975) | $application = $service\_data['cdn\_key']; |
| [976](#L976) | } |
| [977](#L977) |  |
| [978](#L978) | if ( empty( $api\_key ) ) { |
| [979](#L979) | return; |
| [980](#L980) | } |
| [981](#L981) |  |
| [982](#L982) | $request = new Optml\_Api(); |
| [983](#L983) | $data    = $request->get\_user\_data( $api\_key, $application ); |
| [984](#L984) | if ( $data === false || is\_wp\_error( $data ) ) { |
| [985](#L985) | return; |
| [986](#L986) | } |
| [987](#L987) | if ( $data === 'disconnect' ) { |
| [988](#L988) | $settings = new Optml\_Settings(); |
| [989](#L989) | $settings->reset(); |
| [990](#L990) |  |
| [991](#L991) | return; |
| [992](#L992) | } |
| [993](#L993) |  |
| [994](#L994) | add\_filter( 'optml\_dont\_trigger\_settings\_updated', '\_\_return\_true' ); |
| [995](#L995) | $this->settings->update( 'service\_data', $data ); |
| [996](#L996) |  |
| [997](#L997) | if ( isset( $data['extra\_visits'] ) ) { |
| [998](#L998) | $this->settings->update\_frontend\_banner\_from\_remote( $data['extra\_visits'] ); |
| [999](#L999) | } |
| [1000](#L1000) |  |
| [1001](#L1001) | remove\_filter( 'optml\_dont\_trigger\_settings\_updated', '\_\_return\_true' ); |
| [1002](#L1002) |  |
| [1003](#L1003) | } |
| [1004](#L1004) |  |
| [1005](#L1005) | /\*\* |
| [1006](#L1006) | \* Adds cdn url for prefetch. |
| [1007](#L1007) | \* |
| [1008](#L1008) | \* @param array  $hints Hints array. |
| [1009](#L1009) | \* @param string $relation\_type Type of relation. |
| [1010](#L1010) | \* |
| [1011](#L1011) | \* @return array Altered hints array. |
| [1012](#L1012) | \*/ |
| [1013](#L1013) | public function add\_dns\_prefetch( $hints, $relation\_type ) { |
| [1014](#L1014) | if ( 'dns-prefetch' !== $relation\_type && |
| [1015](#L1015) | 'preconnect' !== $relation\_type |
| [1016](#L1016) | ) { |
| [1017](#L1017) | return $hints; |
| [1018](#L1018) | } |
| [1019](#L1019) | if ( ! $this->settings->is\_connected() ) { |
| [1020](#L1020) | return $hints; |
| [1021](#L1021) | } |
| [1022](#L1022) | if ( ! $this->settings->is\_enabled() ) { |
| [1023](#L1023) | return $hints; |
| [1024](#L1024) | } |
| [1025](#L1025) | $hints[] = sprintf( 'https://%s', $this->settings->get\_cdn\_url() ); |
| [1026](#L1026) |  |
| [1027](#L1027) | return $hints; |
| [1028](#L1028) | } |
| [1029](#L1029) |  |
| [1030](#L1030) | /\*\* |
| [1031](#L1031) | \* Add the dashboard page. |
| [1032](#L1032) | \*/ |
| [1033](#L1033) | public function add\_dashboard\_page() { |
| [1034](#L1034) | if ( defined( 'OPTIOMLE\_HIDE\_ADMIN\_AREA' ) && OPTIOMLE\_HIDE\_ADMIN\_AREA ) { |
| [1035](#L1035) | return; |
| [1036](#L1036) | } |
| [1037](#L1037) |  |
| [1038](#L1038) | add\_menu\_page( |
| [1039](#L1039) | 'Optimole', |
| [1040](#L1040) | 'Optimole', |
| [1041](#L1041) | 'manage\_options', |
| [1042](#L1042) | 'optimole', |
| [1043](#L1043) | [ $this, 'render\_dashboard\_page' ], |
| [1044](#L1044) | OPTML\_URL . 'assets/img/logo.svg', |
| [1045](#L1045) | 11 |
| [1046](#L1046) | ); |
| [1047](#L1047) | } |
| [1048](#L1048) |  |
| [1049](#L1049) | /\*\* |
| [1050](#L1050) | \* Add menu icon style. |
| [1051](#L1051) | \* |
| [1052](#L1052) | \* @return void |
| [1053](#L1053) | \*/ |
| [1054](#L1054) | public function menu\_icon\_style() { |
| [1055](#L1055) | echo '<style>#toplevel\_page\_optimole img{ max-width:22px;padding-top:6px!important;opacity:.9!important;} #toplevel\_page\_optimole li.wp-first-item{ display:none }</style>'; |
| [1056](#L1056) | } |
| [1057](#L1057) |  |
| [1058](#L1058) | /\*\* |
| [1059](#L1059) | \* Add the settings page. |
| [1060](#L1060) | \* |
| [1061](#L1061) | \* We do it with another priority as it goes above the cloud library otherwise. |
| [1062](#L1062) | \*/ |
| [1063](#L1063) | public function add\_settings\_subpage() { |
| [1064](#L1064) | if ( defined( 'OPTIOMLE\_HIDE\_ADMIN\_AREA' ) && OPTIOMLE\_HIDE\_ADMIN\_AREA ) { |
| [1065](#L1065) | return; |
| [1066](#L1066) | } |
| [1067](#L1067) |  |
| [1068](#L1068) | if ( ! $this->settings->is\_connected() ) { |
| [1069](#L1069) | return; |
| [1070](#L1070) | } |
| [1071](#L1071) |  |
| [1072](#L1072) | add\_submenu\_page( |
| [1073](#L1073) | 'optimole', |
| [1074](#L1074) | \_\_( 'Settings', 'optimole-wp' ), |
| [1075](#L1075) | \_\_( 'Settings', 'optimole-wp' ), |
| [1076](#L1076) | 'manage\_options', |
| [1077](#L1077) | 'optimole#settings', |
| [1078](#L1078) | [ $this, 'render\_dashboard\_page' ] |
| [1079](#L1079) | ); |
| [1080](#L1080) | } |
| [1081](#L1081) |  |
| [1082](#L1082) |  |
| [1083](#L1083) | /\*\* |
| [1084](#L1084) | \* Redirect old dashboard. |
| [1085](#L1085) | \* |
| [1086](#L1086) | \* @return void |
| [1087](#L1087) | \*/ |
| [1088](#L1088) | public function redirect\_old\_dashboard() { |
| [1089](#L1089) | if ( ! is\_admin() ) { |
| [1090](#L1090) | return; |
| [1091](#L1091) | } |
| [1092](#L1092) |  |
| [1093](#L1093) | global $pagenow; |
| [1094](#L1094) |  |
| [1095](#L1095) | if ( $pagenow !== 'upload.php' ) { |
| [1096](#L1096) | return; |
| [1097](#L1097) | } |
| [1098](#L1098) |  |
| [1099](#L1099) | if ( ! isset( $\_GET['page'] ) ) { |
| [1100](#L1100) | return; |
| [1101](#L1101) | } |
| [1102](#L1102) |  |
| [1103](#L1103) | if ( $\_GET['page'] !== 'optimole' ) { |
| [1104](#L1104) | return; |
| [1105](#L1105) | } |
| [1106](#L1106) |  |
| [1107](#L1107) | wp\_safe\_redirect( admin\_url( 'admin.php?page=optimole' ) ); |
| [1108](#L1108) |  |
| [1109](#L1109) | exit; |
| [1110](#L1110) | } |
| [1111](#L1111) |  |
| [1112](#L1112) | /\*\* |
| [1113](#L1113) | \* Render dashboard page. |
| [1114](#L1114) | \*/ |
| [1115](#L1115) | public function render\_dashboard\_page() { |
| [1116](#L1116) | if ( get\_option( 'optml\_notice\_optin', 'no' ) !== 'yes' ) { |
| [1117](#L1117) | update\_option( 'optml\_notice\_optin', 'yes' ); |
| [1118](#L1118) | } |
| [1119](#L1119) | ?> |
| [1120](#L1120) | <style> |
| [1121](#L1121) | .notice:not(.optml-notice-optin) { |
| [1122](#L1122) | display: none !important; |
| [1123](#L1123) | } |
| [1124](#L1124) | </style> |
| [1125](#L1125) | <div id="optimole-app"></div> |
| [1126](#L1126) | <?php |
| [1127](#L1127) | } |
| [1128](#L1128) |  |
| [1129](#L1129) | /\*\* |
| [1130](#L1130) | \* Enqueue scripts needed for admin functionality. |
| [1131](#L1131) | \* |
| [1132](#L1132) | \* @codeCoverageIgnore |
| [1133](#L1133) | \*/ |
| [1134](#L1134) | public function enqueue() { |
| [1135](#L1135) |  |
| [1136](#L1136) | $current\_screen = get\_current\_screen(); |
| [1137](#L1137) | if ( ! isset( $current\_screen->id ) ) { |
| [1138](#L1138) | return; |
| [1139](#L1139) | } |
| [1140](#L1140) |  |
| [1141](#L1141) | if ( $current\_screen->id !== 'toplevel\_page\_optimole' ) { |
| [1142](#L1142) | return; |
| [1143](#L1143) | } |
| [1144](#L1144) |  |
| [1145](#L1145) | $asset\_file = include OPTML\_PATH . 'assets/build/dashboard/index.asset.php'; |
| [1146](#L1146) |  |
| [1147](#L1147) | wp\_register\_script( |
| [1148](#L1148) | OPTML\_NAMESPACE . '-admin', |
| [1149](#L1149) | OPTML\_URL . 'assets/build/dashboard/index.js', |
| [1150](#L1150) | $asset\_file['dependencies'], |
| [1151](#L1151) | $asset\_file['version'], |
| [1152](#L1152) | true |
| [1153](#L1153) | ); |
| [1154](#L1154) |  |
| [1155](#L1155) | wp\_localize\_script( OPTML\_NAMESPACE . '-admin', 'optimoleDashboardApp', $this->localize\_dashboard\_app() ); |
| [1156](#L1156) | wp\_enqueue\_script( OPTML\_NAMESPACE . '-admin' ); |
| [1157](#L1157) |  |
| [1158](#L1158) | wp\_enqueue\_style( |
| [1159](#L1159) | OPTML\_NAMESPACE . '-admin', |
| [1160](#L1160) | OPTML\_URL . 'assets/build/dashboard/style-index.css', |
| [1161](#L1161) | [ |
| [1162](#L1162) | 'wp-components', |
| [1163](#L1163) | ], |
| [1164](#L1164) | $asset\_file['version'] |
| [1165](#L1165) | ); |
| [1166](#L1166) | } |
| [1167](#L1167) |  |
| [1168](#L1168) | /\*\* |
| [1169](#L1169) | \* Localize the dashboard app. |
| [1170](#L1170) | \* |
| [1171](#L1171) | \* @codeCoverageIgnore |
| [1172](#L1172) | \* @return array |
| [1173](#L1173) | \*/ |
| [1174](#L1174) | private function localize\_dashboard\_app() { |
| [1175](#L1175) |  |
| [1176](#L1176) | global $wp\_version; |
| [1177](#L1177) | $is\_offload\_media\_available = 'no'; |
| [1178](#L1178) | if ( version\_compare( $wp\_version, '5.3', '>=' ) ) { |
| [1179](#L1179) | $is\_offload\_media\_available = 'yes'; |
| [1180](#L1180) | } |
| [1181](#L1181) | $api\_key        = $this->settings->get( 'api\_key' ); |
| [1182](#L1182) | $service\_data   = $this->settings->get( 'service\_data' ); |
| [1183](#L1183) | $user           = get\_userdata( get\_current\_user\_id() ); |
| [1184](#L1184) | $user\_status    = 'inactive'; |
| [1185](#L1185) | $auto\_connect   = get\_option( Optml\_Settings::OPTML\_USER\_EMAIL, 'no' ); |
| [1186](#L1186) | $available\_apps = isset( $service\_data['available\_apps'] ) ? $service\_data['available\_apps'] : null; |
| [1187](#L1187) | if ( isset( $service\_data['cdn\_key'] ) && $available\_apps !== null ) { |
| [1188](#L1188) | foreach ( $service\_data['available\_apps'] as $app ) { |
| [1189](#L1189) | if ( isset( $app['key'] ) && $app['key'] === $service\_data['cdn\_key'] && isset( $app['status'] ) && $app['status'] === 'active' ) { |
| [1190](#L1190) | $user\_status = 'active'; |
| [1191](#L1191) | } |
| [1192](#L1192) | } |
| [1193](#L1193) | } |
| [1194](#L1194) | $routes = []; |
| [1195](#L1195) | foreach ( Optml\_Rest::$rest\_routes as $route\_type ) { |
| [1196](#L1196) | foreach ( $route\_type as $route => $details ) { |
| [1197](#L1197) | $routes[ $route ] = OPTML\_NAMESPACE . '/v1/' . $route; |
| [1198](#L1198) | } |
| [1199](#L1199) | } |
| [1200](#L1200) | // Disable this for now, we need a better way to detect it. |
| [1201](#L1201) | // $cron\_disabled = apply\_filters( 'optml\_offload\_wp\_cron\_disabled', defined( 'DISABLE\_WP\_CRON' ) && constant( 'DISABLE\_WP\_CRON' ) === true ); |
| [1202](#L1202) |  |
| [1203](#L1203) | $language = get\_user\_locale(); |
| [1204](#L1204) | $available\_languages = [ |
| [1205](#L1205) | 'de\_DE'        => 'de', |
| [1206](#L1206) | 'de\_DE\_formal' => 'de', |
| [1207](#L1207) | ]; |
| [1208](#L1208) | $lang\_code = isset( $available\_languages[ $language ] ) ? 'de' : 'en'; |
| [1209](#L1209) |  |
| [1210](#L1210) | return [ |
| [1211](#L1211) | 'strings'                    => $this->get\_dashboard\_strings(), |
| [1212](#L1212) | 'assets\_url'                 => OPTML\_URL . 'assets/', |
| [1213](#L1213) | 'dam\_url'                    => 'admin.php?page=optimole-dam', |
| [1214](#L1214) | 'connection\_status'          => empty( $service\_data ) ? 'no' : 'yes', |
| [1215](#L1215) | 'has\_application'            => isset( $service\_data['app\_count'] ) && $service\_data['app\_count'] >= 1 ? 'yes' : 'no', |
| [1216](#L1216) | 'user\_status'                => $user\_status, |
| [1217](#L1217) | 'available\_apps'             => $available\_apps, |
| [1218](#L1218) | 'api\_key'                    => $api\_key, |
| [1219](#L1219) | 'routes'                     => $routes, |
| [1220](#L1220) | 'language'                   => $lang\_code, |
| [1221](#L1221) | 'nonce'                      => wp\_create\_nonce( 'wp\_rest' ), |
| [1222](#L1222) | 'user\_data'                  => $service\_data, |
| [1223](#L1223) | 'remove\_latest\_images'       => defined( 'OPTML\_REMOVE\_LATEST\_IMAGES' ) && constant( 'OPTML\_REMOVE\_LATEST\_IMAGES' ) ? ( OPTML\_REMOVE\_LATEST\_IMAGES ? 'yes' : 'no' ) : 'no', |
| [1224](#L1224) | 'current\_user'               => [ |
| [1225](#L1225) | 'email' => $user->user\_email, |
| [1226](#L1226) | ], |
| [1227](#L1227) | 'site\_settings'              => $this->settings->get\_site\_settings(), |
| [1228](#L1228) | 'offload\_limit'              => $this->settings->get( 'offload\_limit' ), |
| [1229](#L1229) | 'home\_url'                   => home\_url(), |
| [1230](#L1230) | 'optimoleHome'               => tsdk\_translate\_link( 'https://optimole.com/' ), |
| [1231](#L1231) | 'optimoleDashHome'           => tsdk\_translate\_link( 'https://dashboard.optimole.com/', 'query' ), |
| [1232](#L1232) | 'optimoleDashBilling'        => tsdk\_translate\_link( 'https://dashboard.optimole.com/settings/billing', 'query' ), |
| [1233](#L1233) | 'days\_since\_install'         => round( ( time() - get\_option( 'optimole\_wp\_install', 0 ) ) / DAY\_IN\_SECONDS ), |
| [1234](#L1234) | 'is\_offload\_media\_available' => $is\_offload\_media\_available, |
| [1235](#L1235) | 'auto\_connect'               => $auto\_connect, |
| [1236](#L1236) | 'cron\_disabled'              => false, // $cron\_disabled && ! function\_exists( 'as\_schedule\_single\_action' ), |
| [1237](#L1237) | 'submenu\_links'              => [ |
| [1238](#L1238) | [ |
| [1239](#L1239) | 'href' => 'admin.php?page=optimole#settings', |
| [1240](#L1240) | 'text' => \_\_( 'Settings', 'optimole-wp' ), |
| [1241](#L1241) | 'hash' => '#settings', |
| [1242](#L1242) | ], |
| [1243](#L1243) | ], |
| [1244](#L1244) | ]; |
| [1245](#L1245) | } |
| [1246](#L1246) |  |
| [1247](#L1247) | /\*\* |
| [1248](#L1248) | \* Get all dashboard strings. |
| [1249](#L1249) | \* |
| [1250](#L1250) | \* @codeCoverageIgnore |
| [1251](#L1251) | \* @return array |
| [1252](#L1252) | \*/ |
| [1253](#L1253) | private function get\_dashboard\_strings() { |
| [1254](#L1254) | return [ |
| [1255](#L1255) | 'optimole'                       => 'Optimole', |
| [1256](#L1256) | 'version'                        => OPTML\_VERSION, |
| [1257](#L1257) | 'terms\_menu'                     => \_\_( 'Terms', 'optimole-wp' ), |
| [1258](#L1258) | 'privacy\_menu'                   => \_\_( 'Privacy', 'optimole-wp' ), |
| [1259](#L1259) | 'testdrive\_menu'                 => \_\_( 'Test Optimole', 'optimole-wp' ), |
| [1260](#L1260) | 'service\_details'                => \_\_( 'Image optimization service', 'optimole-wp' ), |
| [1261](#L1261) | 'connect\_btn'                    => \_\_( 'Connect to Optimole', 'optimole-wp' ), |
| [1262](#L1262) | 'disconnect\_btn'                 => \_\_( 'Disconnect', 'optimole-wp' ), |
| [1263](#L1263) | 'select'                         => \_\_( 'Select', 'optimole-wp' ), |
| [1264](#L1264) | 'your\_domain'                    => \_\_( 'your domain', 'optimole-wp' ), |
| [1265](#L1265) | 'add\_api'                        => \_\_( 'Add your API Key', 'optimole-wp' ), |
| [1266](#L1266) | 'your\_api\_key'                   => \_\_( 'Your API Key', 'optimole-wp' ), |
| [1267](#L1267) | 'looking\_for\_api\_key'            => \_\_( 'LOOKING FOR YOUR API KEY?', 'optimole-wp' ), |
| [1268](#L1268) | 'refresh\_stats\_cta'              => \_\_( 'Refresh Stats', 'optimole-wp' ), |
| [1269](#L1269) | 'updating\_stats\_cta'             => \_\_( 'UPDATING STATS', 'optimole-wp' ), |
| [1270](#L1270) | 'api\_key\_placeholder'            => \_\_( 'API Key', 'optimole-wp' ), |
| [1271](#L1271) | 'account\_needed\_heading'         => \_\_( 'Sign-up for API key', 'optimole-wp' ), |
| [1272](#L1272) | 'invalid\_key'                    => \_\_( 'Invalid API Key', 'optimole-wp' ), |
| [1273](#L1273) | 'keep\_connected'                 => \_\_( 'Ok, keep me connected', 'optimole-wp' ), |
| [1274](#L1274) | 'cloud\_library'                  => \_\_( 'Cloud Library', 'optimole-wp' ), |
| [1275](#L1275) | 'image\_storage'                  => \_\_( 'Image Storage', 'optimole-wp' ), |
| [1276](#L1276) | 'disconnect\_title'               => \_\_( 'You are about to disconnect from the Optimole API', 'optimole-wp' ), |
| [1277](#L1277) | 'disconnect\_desc'                => \_\_( |
| [1278](#L1278) | 'Please note that disconnecting your site from the Optimole API will impact your website performance. |
| [1279](#L1279) | If you still want to disconnect click the button below.', |
| [1280](#L1280) | 'optimole-wp' |
| [1281](#L1281) | ), |
| [1282](#L1282) | 'email\_address\_label'            => \_\_( 'Your email address', 'optimole-wp' ), |
| [1283](#L1283) | 'steps\_connect\_api\_title'        => \_\_( 'Connect your account', 'optimole-wp' ), |
| [1284](#L1284) | 'register\_btn'                   => \_\_( 'Create & connect your account', 'optimole-wp' ), |
| [1285](#L1285) | 'step\_one\_api\_title'             => \_\_( 'Enter your API key.', 'optimole-wp' ), |
| [1286](#L1286) | 'optml\_dashboard'                => sprintf( |
| [1287](#L1287) | /\* translators: 1 is the opening anchor tag, 2 is the closing anchor tag \*/ |
| [1288](#L1288) | \_\_( 'Get it from the %1$s Optimole Dashboard%2$s.', 'optimole-wp' ), |
| [1289](#L1289) | '<a  style="white-space:nowrap; text-decoration: underline !important;" href="' . esc\_url( tsdk\_translate\_link( 'https://dashboard.optimole.com/', 'query' ) ) . '" target="\_blank"> ', |
| [1290](#L1290) | '<span style="text-decoration:none; font-size:15px; margin-top:2px;" class="dashicons dashicons-external"></span></a>' |
| [1291](#L1291) | ), |
| [1292](#L1292) | 'steps\_connect\_api\_desc'         => sprintf( |
| [1293](#L1293) | /\* translators: 1 is the opening anchor tag, 2 is the closing anchor tag \*/ |
| [1294](#L1294) | \_\_( 'Copy the API Key you have received via email or you can get it from %1$s Optimole dashboard%2$s. If your account has multiple domains select the one you want to use. <br/>', 'optimole-wp' ), |
| [1295](#L1295) | '<a href="' . esc\_url( tsdk\_translate\_link( 'https://dashboard.optimole.com/', 'query' ) ) . '" target="\_blank"> ', |
| [1296](#L1296) | '</a>' |
| [1297](#L1297) | ), |
| [1298](#L1298) | 'api\_exists'                     => \_\_( 'I already have an API key.', 'optimole-wp' ), |
| [1299](#L1299) | 'back\_to\_register'               => \_\_( 'Register account', 'optimole-wp' ), |
| [1300](#L1300) | 'back\_to\_connect'                => \_\_( 'Go to previous step', 'optimole-wp' ), |
| [1301](#L1301) | /\* translators: 1 is starting anchor tag, 2 is ending anchor tag \*/ |
| [1302](#L1302) | 'error\_register'                 => sprintf( \_\_( 'Error registering account. You can try again %1$shere%2$s', 'optimole-wp' ), '<a href="' . esc\_url( tsdk\_translate\_link( 'https://dashboard.optimole.com/register', 'query' ) ) . '" target="\_blank"> ', '</a>' ), |
| [1303](#L1303) | 'invalid\_email'                  => \_\_( 'Please use a valid email address.', 'optimole-wp' ), |
| [1304](#L1304) | 'connected'                      => \_\_( 'CONNECTED', 'optimole-wp' ), |
| [1305](#L1305) | 'connecting'                     => \_\_( 'CONNECTING', 'optimole-wp' ), |
| [1306](#L1306) | 'not\_connected'                  => \_\_( 'NOT CONNECTED', 'optimole-wp' ), |
| [1307](#L1307) | 'usage'                          => \_\_( 'Monthly Usage', 'optimole-wp' ), |
| [1308](#L1308) | 'quota'                          => \_\_( 'Monthly visits quota', 'optimole-wp' ), |
| [1309](#L1309) | 'logged\_in\_as'                   => \_\_( 'LOGGED IN AS', 'optimole-wp' ), |
| [1310](#L1310) | 'private\_cdn\_url'                => \_\_( 'IMAGES DOMAIN', 'optimole-wp' ), |
| [1311](#L1311) | 'existing\_user'                  => \_\_( 'Existing user?', 'optimole-wp' ), |
| [1312](#L1312) | 'notification\_message\_register'  => \_\_( 'We sent you the API Key in the email. Add it below to connect to Optimole.', 'optimole-wp' ), |
| [1313](#L1313) | 'premium\_support'                => \_\_( 'Access our Premium Support', 'optimole-wp' ), |
| [1314](#L1314) | 'account\_needed\_title'           => sprintf( |
| [1315](#L1315) | /\* translators: 1 is the link to optimole.com \*/ |
| [1316](#L1316) | \_\_( 'In order to get access to free image optimization service you will need an API key from %s.', 'optimole-wp' ), |
| [1317](#L1317) | ' <a href="' . esc\_url( tsdk\_translate\_link( 'https://dashboard.optimole.com/register', 'query' ) ) . '" target="\_blank">optimole.com</a>' |
| [1318](#L1318) | ), |
| [1319](#L1319) | 'account\_needed\_subtitle\_1'      => sprintf( |
| [1320](#L1320) | /\* translators: 1 is starting bold tag, 2 is ending bold tag, 3 is the starting bold tag, 4 is the limit number, 5 is ending bold tag, 6 is the starting anchor tag for the docs link on how we count visits, 7 is the ending anchor tag. \*/ |
| [1321](#L1321) | \_\_( 'You will get access to our %1$simage optimization service for FREE%2$s in the limit of %3$s%4$s%5$s %6$svisitors%7$s per month.', 'optimole-wp' ), |
| [1322](#L1322) | '<strong>', |
| [1323](#L1323) | '</strong>', |
| [1324](#L1324) | number\_format\_i18n( 1000 ), |
| [1325](#L1325) | '<strong>', |
| [1326](#L1326) | '</strong>', |
| [1327](#L1327) | '<a href="https://docs.optimole.com/article/1134-how-optimole-counts-the-number-of-visitors" target="\_blank">', |
| [1328](#L1328) | '</a>' |
| [1329](#L1329) | ), |
| [1330](#L1330) | 'account\_needed\_subtitle\_3'      => sprintf( |
| [1331](#L1331) | /\* translators: 1 is the starting anchor tag for the docs link, 2 is the ending anchor tag. \*/ |
| [1332](#L1332) | \_\_( 'Need help? %1$sGetting Started with Optimole%2$s', 'optimole-wp' ), |
| [1333](#L1333) | '<a target="\_blank" href="https://docs.optimole.com/article/1173-how-to-get-started-with-optimole-in-just-3-steps">', |
| [1334](#L1334) | '</a>' |
| [1335](#L1335) | ), |
| [1336](#L1336) | 'account\_needed\_subtitle\_2'      => sprintf( |
| [1337](#L1337) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/ |
| [1338](#L1338) | \_\_( |
| [1339](#L1339) | 'Bonus, if you dont use a CDN, we got you covered, %1$swe will serve the images using CloudFront CDN%2$s from 450+ locations.', |
| [1340](#L1340) | 'optimole-wp' |
| [1341](#L1341) | ), |
| [1342](#L1342) | '<strong>', |
| [1343](#L1343) | '</strong>' |
| [1344](#L1344) | ), |
| [1345](#L1345) | 'account\_needed\_footer'          => sprintf( |
| [1346](#L1346) | /\* translators: 1 is the number of users using Optimole \*/ |
| [1347](#L1347) | \_\_( 'Trusted by more than %1$s happy users', 'optimole-wp' ), |
| [1348](#L1348) | number\_format\_i18n( 200000, 0 ) |
| [1349](#L1349) | ), |
| [1350](#L1350) | 'account\_connecting\_title'       => \_\_( 'Connecting to Optimole', 'optimole-wp' ), |
| [1351](#L1351) | 'account\_connecting\_subtitle'    => \_\_( 'Sit tight while we connect you to the Dashboard', 'optimole-wp' ), |
| [1352](#L1352) | 'notice\_just\_activated'          => ! $this->settings->is\_connected() ? |
| [1353](#L1353) | sprintf( |
| [1354](#L1354) | /\* translators: 1 starting bold tag, 2 is the ending bold tag \*/ |
| [1355](#L1355) | \_\_( '%1$sImage optimisation is currently running.%2$s <br/> Your visitors will now view the best image for their device automatically, all served from the Optimole Cloud Service on the fly. You might see for the very first image request being redirected to the original URL while we do the optimization in the background. You can relax, we\'ll take it from here.', 'optimole-wp' ), |
| [1356](#L1356) | '<strong>', |
| [1357](#L1357) | '</strong>' |
| [1358](#L1358) | ) |
| [1359](#L1359) | : '', |
| [1360](#L1360) | 'notice\_api\_not\_working'         => \_\_( |
| [1361](#L1361) | 'It seems there is an issue with your WordPress configuration and the core REST API functionality is not available. This is crucial as Optimole relies on this functionality in order to work.<br/> |
| [1362](#L1362) | The root cause might be either a security plugin which blocks this feature or some faulty server configuration which constrain this WordPress feature.You can try to disable any of the security plugins that you use in order to see if the issue persists or ask the hosting company to further investigate.', |
| [1363](#L1363) | 'optimole-wp' |
| [1364](#L1364) | ), |
| [1365](#L1365) | 'notice\_disabled\_account'        => sprintf( |
| [1366](#L1366) | /\* translators: 1 anchor tag to pricing, 2 is the ending endin anchor tag, 3 is the bold tag start, 4 ending bold tag, 5 new line tag \*/ |
| [1367](#L1367) | \_\_( '%3$sYour account has been disabled due to exceeding quota.%4$s All images are being redirected to the original unoptimized URL. %5$sPlease %1$supgrade%2$s to re-activate the account.', 'optimole-wp' ), |
| [1368](#L1368) | '<b><a href="' . esc\_url( tsdk\_translate\_link( 'https://optimole.com/pricing' ) ) . '">', |
| [1369](#L1369) | '</a></b>', |
| [1370](#L1370) | '<b>', |
| [1371](#L1371) | '</b>', |
| [1372](#L1372) | '<br>' |
| [1373](#L1373) | ), |
| [1374](#L1374) | 'signup\_terms'                   => sprintf( |
| [1375](#L1375) | /\* translators: 1 is starting anchor tag to terms, 2 is starting anchor tag to privacy link and 3 is ending anchor tag. \*/ |
| [1376](#L1376) | \_\_( 'By signing up, you agree to our  %1$sTerms of Service %3$s and %2$sPrivacy Policy %3$s.', 'optimole-wp' ), |
| [1377](#L1377) | '<a href="' . esc\_url( tsdk\_translate\_link( 'https://optimole.com/terms/' ) ) . '" target="\_blank" >', |
| [1378](#L1378) | '<a href="' . esc\_url( tsdk\_translate\_link( 'https://optimole.com/privacy-policy/' ) ) . '" target="\_blank">', |
| [1379](#L1379) | '</a>' |
| [1380](#L1380) | ), |
| [1381](#L1381) | 'dashboard\_menu\_item'            => \_\_( 'Dashboard', 'optimole-wp' ), |
| [1382](#L1382) | 'settings\_menu\_item'             => \_\_( 'Settings', 'optimole-wp' ), |
| [1383](#L1383) | 'help\_menu\_item'                 => \_\_( 'Help', 'optimole-wp' ), |
| [1384](#L1384) | 'settings\_exclusions\_menu\_item'  => \_\_( 'Exclusions', 'optimole-wp' ), |
| [1385](#L1385) | 'settings\_resize\_menu\_item'      => \_\_( 'Resize', 'optimole-wp' ), |
| [1386](#L1386) | 'settings\_compression\_menu\_item' => \_\_( 'Compression', 'optimole-wp' ), |
| [1387](#L1387) | 'advanced\_settings\_menu\_item'    => \_\_( 'Advanced', 'optimole-wp' ), |
| [1388](#L1388) | 'general\_settings\_menu\_item'     => \_\_( 'General', 'optimole-wp' ), |
| [1389](#L1389) | 'lazyload\_settings\_menu\_item'    => \_\_( 'Lazyload', 'optimole-wp' ), |
| [1390](#L1390) | 'watermarks\_menu\_item'           => \_\_( 'Watermark', 'optimole-wp' ), |
| [1391](#L1391) | 'conflicts\_menu\_item'            => \_\_( 'Possible Issues', 'optimole-wp' ), |
| [1392](#L1392) | 'conflicts'                      => [ |
| [1393](#L1393) | 'title'              => \_\_( 'We might have some possible conflicts with the plugins that you use. In order to benefit from Optimole\'s full potential you will need to address this issues.', 'optimole-wp' ), |
| [1394](#L1394) | 'message'            => \_\_( 'Details', 'optimole-wp' ), |
| [1395](#L1395) | 'conflict\_close'     => \_\_( 'I\'ve done this.', 'optimole-wp' ), |
| [1396](#L1396) | 'no\_conflicts\_found' => \_\_( 'No conflicts found. We are all peachy now. 🍑', 'optimole-wp' ), |
| [1397](#L1397) | ], |
| [1398](#L1398) | 'upgrade'                        => [ |
| [1399](#L1399) | 'title'      => \_\_( 'Upgrade', 'optimole-wp' ), |
| [1400](#L1400) | 'title\_long' => \_\_( 'Upgrade to Optimole Pro', 'optimole-wp' ), |
| [1401](#L1401) | 'reason\_1'   => \_\_( 'Priority & Live Chat support', 'optimole-wp' ), |
| [1402](#L1402) | 'reason\_2'   => \_\_( 'Extend visits limit', 'optimole-wp' ), |
| [1403](#L1403) | 'reason\_3'   => \_\_( 'Custom domain', 'optimole-wp' ), |
| [1404](#L1404) | 'reason\_4'   => \_\_( 'Site audit', 'optimole-wp' ), |
| [1405](#L1405) | 'cta'        => \_\_( 'View plans', 'optimole-wp' ), |
| [1406](#L1406) | ], |
| [1407](#L1407) | 'neve'                           => [ |
| [1408](#L1408) | 'is\_active' => defined( 'NEVE\_VERSION' ) ? 'yes' : 'no', |
| [1409](#L1409) | 'byline'    => \_\_( 'Fast, perfomance built-in WordPress theme.', 'optimole-wp' ), |
| [1410](#L1410) | 'reason\_1'  => \_\_( 'Lightweight, 25kB in page-weight.', 'optimole-wp' ), |
| [1411](#L1411) | 'reason\_2'  => \_\_( '100+ Starter Sites available.', 'optimole-wp' ), |
| [1412](#L1412) | 'reason\_3'  => \_\_( 'AMP/Mobile ready.', 'optimole-wp' ), |
| [1413](#L1413) | 'reason\_4'  => \_\_( 'Lots of customizations options.', 'optimole-wp' ), |
| [1414](#L1414) | 'reason\_5'  => \_\_( 'Fully compatible with Optimole.', 'optimole-wp' ), |
| [1415](#L1415) | ], |
| [1416](#L1416) | 'metrics'                        => [ |
| [1417](#L1417) | 'metricsTitle1'    => \_\_( 'Images optimized', 'optimole-wp' ), |
| [1418](#L1418) | 'metricsSubtitle1' => \_\_( 'Since plugin activation', 'optimole-wp' ), |
| [1419](#L1419) | 'metricsTitle2'    => \_\_( 'Saved file size', 'optimole-wp' ), |
| [1420](#L1420) | 'metricsSubtitle2' => \_\_( 'For the latest 10 images', 'optimole-wp' ), |
| [1421](#L1421) | 'metricsTitle3'    => \_\_( 'Average compression', 'optimole-wp' ), |
| [1422](#L1422) | 'metricsSubtitle3' => \_\_( 'During last month', 'optimole-wp' ), |
| [1423](#L1423) | 'metricsTitle4'    => \_\_( 'Traffic', 'optimole-wp' ), |
| [1424](#L1424) | 'metricsSubtitle4' => \_\_( 'During last month', 'optimole-wp' ), |
| [1425](#L1425) | ], |
| [1426](#L1426) | 'options\_strings'                => [ |
| [1427](#L1427) | 'best\_format\_title'                   => \_\_( 'Automatic Best Image Format Selection', 'optimole-wp' ), |
| [1428](#L1428) | 'best\_format\_desc'                    => sprintf( |
| [1429](#L1429) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1430](#L1430) | \_\_( 'When enabled, Optimole picks the ideal format for your images, balancing quality and speed. It tests different formats, like AVIF and WebP, ensuring images look good and load quickly. %1$sLearn more%2$s.', 'optimole-wp' ), |
| [1431](#L1431) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1942-best-format">', |
| [1432](#L1432) | '</a>' |
| [1433](#L1433) | ), |
| [1434](#L1434) | 'add\_filter'                          => \_\_( 'Add filter', 'optimole-wp' ), |
| [1435](#L1435) | 'add\_site'                            => \_\_( 'Add site', 'optimole-wp' ), |
| [1436](#L1436) | 'admin\_bar\_desc'                      => \_\_( 'Show in the WordPress admin bar the available quota from Optimole service.', 'optimole-wp' ), |
| [1437](#L1437) | 'auto\_q\_title'                        => \_\_( 'Auto', 'optimole-wp' ), |
| [1438](#L1438) | 'cache\_desc'                          => sprintf( |
| [1439](#L1439) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1440](#L1440) | \_\_( 'Clears all Optimole’s cached resources (images, JS, CSS). Useful if you made changes to your images and don\'t see those applying on your site. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1441](#L1441) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1941-clear-cached-resources">', |
| [1442](#L1442) | '</a>' |
| [1443](#L1443) | ), |
| [1444](#L1444) | 'cache\_title'                         => \_\_( 'Clear Cached Resources', 'optimole-wp' ), |
| [1445](#L1445) | 'clear\_cache\_notice'                  => \_\_( 'Clearing cached resources will re-optimize the images and might affect the site performance for a few minutes.', 'optimole-wp' ), |
| [1446](#L1446) | 'image\_size\_notice'                   => sprintf( |
| [1447](#L1447) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1448](#L1448) | \_\_( 'Use this option if you notice images are not cropped correctly after using Optimole. Add the affected image sizes here to automatically adjust and correct their cropping for optimal display. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1449](#L1449) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1947-add-new-image-crop-size">', |
| [1450](#L1450) | '</a>' |
| [1451](#L1451) | ), |
| [1452](#L1452) | 'clear\_cache\_images'                  => \_\_( 'Clear cached images', 'optimole-wp' ), |
| [1453](#L1453) | 'clear\_cache\_assets'                  => \_\_( 'Clear cached CSS & JS', 'optimole-wp' ), |
| [1454](#L1454) | 'connect\_step\_0'                      => \_\_( 'Connecting your site to the Optimole service.', 'optimole-wp' ), |
| [1455](#L1455) | 'connect\_step\_1'                      => \_\_( 'Checking for possible conflicts.', 'optimole-wp' ), |
| [1456](#L1456) | 'connect\_step\_2'                      => \_\_( 'Inspecting the images from your site.', 'optimole-wp' ), |
| [1457](#L1457) | 'connect\_step\_3'                      => \_\_( 'All done, Optimole is currently optimizing your site.', 'optimole-wp' ), |
| [1458](#L1458) | 'disabled'                            => \_\_( 'Disabled', 'optimole-wp' ), |
| [1459](#L1459) | 'enable\_avif\_title'                   => \_\_( 'AVIF Image Support', 'optimole-wp' ), |
| [1460](#L1460) | 'enable\_avif\_desc'                    => sprintf( |
| [1461](#L1461) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1462](#L1462) | \_\_( 'Enable this to automatically convert images to the AVIF format on browsers that support it. This format provides quality images with reduced file sizes, and faster webpage loading. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1463](#L1463) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1943-avif-conversion">', |
| [1464](#L1464) | '</a>' |
| [1465](#L1465) | ), |
| [1466](#L1466) | 'enable\_bg\_lazyload\_desc'             => sprintf( |
| [1467](#L1467) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1468](#L1468) | \_\_( 'Enable this to lazy-load images set as CSS backgrounds. If Optimole misses any, you can directly target specific CSS selectors to ensure all background images are optimized. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1469](#L1469) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1169-how-to-enable-the-background-lazyload-feature-for-certain-background-images">', |
| [1470](#L1470) | '</a>' |
| [1471](#L1471) | ), |
| [1472](#L1472) | 'enable\_bg\_lazyload\_title'            => \_\_( 'CSS Background Lazy Load', 'optimole-wp' ), |
| [1473](#L1473) | 'enable\_video\_lazyload\_desc'          => sprintf( |
| [1474](#L1474) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1475](#L1475) | \_\_( 'By default, lazy loading does not work for embedded videos and iframes. Enable this option to activate the lazy-load on these elements. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1476](#L1476) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1952-lazy-loading-for-embedded-videos-and-iframes">', |
| [1477](#L1477) | '</a>' |
| [1478](#L1478) | ), |
| [1479](#L1479) | 'enable\_video\_lazyload\_title'         => \_\_( 'Lazy Loading for Embedded Videos and Iframes', 'optimole-wp' ), |
| [1480](#L1480) | 'enable\_noscript\_desc'                => sprintf( |
| [1481](#L1481) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1482](#L1482) | \_\_( 'Enables fallback images for browsers that can\'t handle JavaScript-based lazy loading or related features. Disabling it may resolve conflicts with other plugins or configurations and decrease HTML page size. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1483](#L1483) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1959-noscript-tag">', |
| [1484](#L1484) | '</a>' |
| [1485](#L1485) | ), |
| [1486](#L1486) | 'enable\_noscript\_title'               => \_\_( 'Noscript Tag', 'optimole-wp' ), |
| [1487](#L1487) | 'enable\_gif\_replace\_title'            => \_\_( 'GIF to Video Conversion', 'optimole-wp' ), |
| [1488](#L1488) | 'enable\_report\_title'                 => \_\_( 'Enable Error Diagnosis Tool', 'optimole-wp' ), |
| [1489](#L1489) | 'enable\_report\_desc'                  => sprintf( |
| [1490](#L1490) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1491](#L1491) | \_\_( 'Activates the Optimole debugging tool in the admin bar for reports on Optimole-related website issues using the built-in diagnostic feature. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1492](#L1492) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1390-how-does-the-error-diagnosis-tool-work">', |
| [1493](#L1493) | '</a>' |
| [1494](#L1494) | ), |
| [1495](#L1495) | 'enable\_offload\_media\_title'          => \_\_( 'Store Your Images in Optimole Cloud', 'optimole-wp' ), |
| [1496](#L1496) | 'enable\_offload\_media\_desc'           => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Free up space on your server by transferring your images to Optimole Cloud; you can transfer them back anytime. Once moved, the images will still be visible in the Media Library and can be used as before. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1967-store-your-images-in-optimole-cloud">', '</a>' ), |
| [1497](#L1497) | 'enable\_cloud\_images\_title'           => \_\_( 'Unified Image Access', 'optimole-wp' ), |
| [1498](#L1498) | 'enable\_cloud\_images\_desc'            => sprintf( |
| [1499](#L1499) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1500](#L1500) | \_\_( 'Enable this setting to access all your Optimole images, including those from other websites connected to your Optimole account, directly on this site. They will be available for browsing in the Cloud Library tab. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1501](#L1501) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1323-cloud-library-browsing">', |
| [1502](#L1502) | '</a>' |
| [1503](#L1503) | ), |
| [1504](#L1504) | 'enable\_image\_replace'                => \_\_( 'Enable Optimole Image Handling', 'optimole-wp' ), |
| [1505](#L1505) | 'enable\_lazyload\_placeholder\_desc'    => sprintf( |
| [1506](#L1506) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1507](#L1507) | \_\_( 'Enable this to use a generic transparent placeholder instead of the blurry images during lazy loading. Enhance the visual experience by selecting a custom color for the placeholder. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1508](#L1508) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1192-lazy-load-generic-placeholder">', |
| [1509](#L1509) | '</a>' |
| [1510](#L1510) | ), |
| [1511](#L1511) | 'enable\_lazyload\_placeholder\_title'   => \_\_( 'Lazy Load with Generic Placeholder', 'optimole-wp' ), |
| [1512](#L1512) | 'enable\_network\_opt\_desc'             => sprintf( |
| [1513](#L1513) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1514](#L1514) | \_\_( 'When enabled, Optimole will automatically reduce the image quality when it detects a slower network, making your images load faster on low-speed internet connections. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1515](#L1515) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1945-network-based-optimizations">', |
| [1516](#L1516) | '</a>' |
| [1517](#L1517) | ), |
| [1518](#L1518) | 'enable\_network\_opt\_title'            => \_\_( 'Network-based Optimizations', 'optimole-wp' ), |
| [1519](#L1519) | 'enable\_resize\_smart\_desc'            => sprintf( |
| [1520](#L1520) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1521](#L1521) | \_\_( 'When enabled, Optimole automatically detects the most interesting or important part of your images. When pictures are resized or cropped, this feature ensures the focus stays on the most interesting part of the picture. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1522](#L1522) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1871-how-to-use-the-smart-cropping-in-optimole">', |
| [1523](#L1523) | '</a>' |
| [1524](#L1524) | ), |
| [1525](#L1525) | 'enable\_resize\_smart\_title'           => \_\_( 'Smart Cropping', 'optimole-wp' ), |
| [1526](#L1526) | 'enable\_retina\_desc'                  => sprintf( |
| [1527](#L1527) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1528](#L1528) | \_\_( 'Enable this feature to optimize your images for Retina displays. Retina-ready images are optimized to look sharp on screens with higher pixel density, offering viewers enhanced visual quality. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1529](#L1529) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1391-what-is-a-retina-image">', |
| [1530](#L1530) | '</a>' |
| [1531](#L1531) | ), |
| [1532](#L1532) | 'enable\_retina\_title'                 => \_\_( 'Retina Quality', 'optimole-wp' ), |
| [1533](#L1533) | 'enable\_limit\_dimensions\_desc'        => sprintf( |
| [1534](#L1534) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1535](#L1535) | \_\_( 'Define the max width or height limits for images on your website. Larger images will be automatically adjusted to fit within these parameters while preserving their original aspect ratio. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1536](#L1536) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1946-limit-image-sizes">', |
| [1537](#L1537) | '</a>' |
| [1538](#L1538) | ), |
| [1539](#L1539) | 'enable\_limit\_dimensions\_title'       => \_\_( 'Limit Image Sizes', 'optimole-wp' ), |
| [1540](#L1540) | 'enable\_limit\_dimensions\_notice'      => \_\_( 'When you enable this feature to define a max width or height for image resizing, please note that DPR (retina) images will be disabled. This is done to ensure consistency in image dimensions across your website. Although this may result in slightly lower image quality for high-resolution displays, it will help maintain uniform image sizes, improving your website\'s overall layout and potentially boosting performance.', 'optimole-wp' ), |
| [1541](#L1541) | 'enable\_badge\_title'                  => \_\_( 'Enable Optimole Badge', 'optimole-wp' ), |
| [1542](#L1542) | 'enable\_badge\_description'            => sprintf( |
| [1543](#L1543) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1544](#L1544) | \_\_( 'Get 20.000 more visits for free by enabling the Optimole badge on your websites. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1545](#L1545) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1940-optimole-badge">', |
| [1546](#L1546) | '</a>' |
| [1547](#L1547) | ), |
| [1548](#L1548) | 'image\_sizes\_title'                   => \_\_( 'Your cropped image sizes', 'optimole-wp' ), |
| [1549](#L1549) | 'enabled'                             => \_\_( 'Enabled', 'optimole-wp' ), |
| [1550](#L1550) | 'exclude\_class\_desc'                  => sprintf( |
| [1551](#L1551) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/ |
| [1552](#L1552) | \_\_( '%1$sImage tag%2$s contains class', 'optimole-wp' ), |
| [1553](#L1553) | '<strong>', |
| [1554](#L1554) | '</strong>' |
| [1555](#L1555) | ), |
| [1556](#L1556) | 'exclude\_ext\_desc'                    => sprintf( |
| [1557](#L1557) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/ |
| [1558](#L1558) | \_\_( '%1$sImage extension%2$s is', 'optimole-wp' ), |
| [1559](#L1559) | '<strong>', |
| [1560](#L1560) | '</strong>' |
| [1561](#L1561) | ), |
| [1562](#L1562) | 'exclude\_filename\_desc'               => sprintf( |
| [1563](#L1563) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/                    \_\_( '%1$sImage filename%2$s contains', 'optimole-wp' ), |
| [1564](#L1564) | '<strong>', |
| [1565](#L1565) | '</strong>' |
| [1566](#L1566) | ), |
| [1567](#L1567) | 'exclude\_desc\_optimize'               => sprintf( |
| [1568](#L1568) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1569](#L1569) | \_\_( 'Here you can define exceptions, in case you don\'t want some images to be optimised. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1570](#L1570) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading">', |
| [1571](#L1571) | '</a>' |
| [1572](#L1572) | ), |
| [1573](#L1573) | 'exclude\_title\_lazyload'              => \_\_( 'Don\'t lazy-load images if', 'optimole-wp' ), |
| [1574](#L1574) | 'exclude\_desc\_lazyload'               => sprintf( |
| [1575](#L1575) | /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ |
| [1576](#L1576) | \_\_( 'Define exceptions, in case you don\'t want the lazy-load to be active on certain images. %1$sLearn more%2$s', 'optimole-wp' ), |
| [1577](#L1577) | '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading">', |
| [1578](#L1578) | '</a>' |
| [1579](#L1579) | ), |
| [1580](#L1580) | 'exclude\_title\_optimize'              => \_\_( 'Don\'t optimize images if', 'optimole-wp' ), |
| [1581](#L1581) | 'exclude\_url\_desc'                    => sprintf( |
| [1582](#L1582) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/                    \_\_( '%1$sPage url%2$s contains', 'optimole-wp' ), |
| [1583](#L1583) | '<strong>', |
| [1584](#L1584) | '</strong>' |
| [1585](#L1585) | ), |
| [1586](#L1586) | 'name'                                => sprintf( |
| [1587](#L1587) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/                    \_\_( '%1$sName: %2$s', 'optimole-wp' ), |
| [1588](#L1588) | '<strong>', |
| [1589](#L1589) | '</strong>' |
| [1590](#L1590) | ), |
| [1591](#L1591) | 'cropped'                             => \_\_( 'cropped', 'optimole-wp' ), |
| [1592](#L1592) | 'exclude\_url\_match\_desc'              => sprintf( |
| [1593](#L1593) | /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/                    \_\_( '%1$sPage url%2$s matches', 'optimole-wp' ), |
| [1594](#L1594) | '<strong>', |
| [1595](#L1595) | '</strong>' |
| [1596](#L1596) | ), |
| [1597](#L1597) | 'exclude\_first'                       => \_\_( 'Exclude first', 'optimole-wp' ), |
| [1598](#L1598) | 'images'                              => \_\_( 'images', 'optimole-wp' ), |
| [1599](#L1599) | 'exclude\_first\_images\_title'          => \_\_( 'Bypass Lazy Load for First Images', 'optimole-wp' ), |
| [1600](#L1600) | 'exclude\_first\_images\_desc'           => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Indicate how many images at the top of each page should bypass lazy loading, ensuring they’re instantly visible. Enter 0 to not exclude any images from the lazy loading process. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1948-bypass-lazy-load-for-first-images">', '</a>' ), |
| [1601](#L1601) | 'filter\_class'                        => \_\_( 'Image class', 'optimole-wp' ), |
| [1602](#L1602) | 'filter\_ext'                          => \_\_( 'Image extension', 'optimole-wp' ), |
| [1603](#L1603) | 'filter\_filename'                     => \_\_( 'Image filename', 'optimole-wp' ), |
| [1604](#L1604) | 'filter\_operator\_contains'            => \_\_( 'contains', 'optimole-wp' ), |
| [1605](#L1605) | 'filter\_operator\_matches'             => \_\_( 'matches', 'optimole-wp' ), |
| [1606](#L1606) | 'filter\_operator\_is'                  => \_\_( 'is', 'optimole-wp' ), |
| [1607](#L1607) | 'filter\_url'                          => \_\_( 'Page URL', 'optimole-wp' ), |
| [1608](#L1608) | 'filter\_helper'                       => \_\_( 'For homepage use `home` keyword.', 'optimole-wp' ), |
| [1609](#L1609) | 'gif\_replacer\_desc'                   => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Enable this to automatically convert GIF images to Video files (MP4 and WebM). %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1171-gif-to-video-conversion">', '</a>' ), |
| [1610](#L1610) | 'height\_field'                        => \_\_( 'Height', 'optimole-wp' ), |
| [1611](#L1611) | 'add\_image\_size\_button'               => \_\_( 'Add size', 'optimole-wp' ), |
| [1612](#L1612) | 'add\_image\_size\_desc'                 => \_\_( 'Add New Image Crop Size', 'optimole-wp' ), |
| [1613](#L1613) | 'here'                                => \_\_( ' here.', 'optimole-wp' ), |
| [1614](#L1614) | 'hide'                                => \_\_( 'Hide', 'optimole-wp' ), |
| [1615](#L1615) | 'high\_q\_title'                        => \_\_( 'High', 'optimole-wp' ), |
| [1616](#L1616) | 'image\_1\_label'                       => \_\_( 'Original', 'optimole-wp' ), |
| [1617](#L1617) | 'image\_2\_label'                       => \_\_( 'Optimized', 'optimole-wp' ), |
| [1618](#L1618) | 'lazyload\_desc'                       => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Scales large images to fit their display space, ensuring your website runs fast. With lazy loading, images appear when needed while scrolling, making navigation smoother. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1939-scale-images-lazy-load">', '</a>' ), |
| [1619](#L1619) | 'filter\_length\_error'                 => \_\_( 'The filter should be at least 3 characters long.', 'optimole-wp' ), |
| [1620](#L1620) | 'scale\_desc'                          => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Enable this to allow Optimole to resize lazy-loaded images for optimal display on your screen. Keep it disabled to retain the original image size, though it may result in slower page loads. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1950-image-scaling">', '</a>' ), |
| [1621](#L1621) | 'low\_q\_title'                         => \_\_( 'Low', 'optimole-wp' ), |
| [1622](#L1622) | 'medium\_q\_title'                      => \_\_( 'Medium', 'optimole-wp' ), |
| [1623](#L1623) | 'no\_images\_found'                     => \_\_( 'You dont have any images in your Media Library. Add one and check how the Optimole will perform.', 'optimole-wp' ), |
| [1624](#L1624) | 'native\_desc'                         => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Enable to use the browser\'s built-in lazy loading feature. Enabling this will disable the auto scale feature, meaning images will not be automatically resized to fit the screen dimensions. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1949-browser-native-lazy-load">', '</a>' ), |
| [1625](#L1625) | 'option\_saved'                        => \_\_( 'Option saved.', 'optimole-wp' ), |
| [1626](#L1626) | 'ml\_quality\_desc'                     => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Optimole ML algorithms will predict the optimal image quality to get the smallest possible size with minimum perceived quality losses. When disabled, you can control the quality manually. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1016-what-is-the-difference-between-the-auto-high-medium-low-compression-levels">', '</a>' ), |
| [1627](#L1627) | 'quality\_desc'                        => \_\_( 'Lower image quality might boost your loading speed by lowering the size. However, the low image quality may negatively impact the visual appearance of the images. Try experimenting with the setting, then click the View sample image link to see what option works best for you.', 'optimole-wp' ), |
| [1628](#L1628) | 'quality\_selected\_value'              => \_\_( 'Selected value', 'optimole-wp' ), |
| [1629](#L1629) | 'quality\_slider\_desc'                 => \_\_( 'See one sample image which will help you choose the right quality of the compression.', 'optimole-wp' ), |
| [1630](#L1630) | 'quality\_title'                       => \_\_( 'Auto Quality Powered by ML(Machine Learning)', 'optimole-wp' ), |
| [1631](#L1631) | 'strip\_meta\_title'                    => \_\_( 'Strip Image Metadata', 'optimole-wp' ), |
| [1632](#L1632) | 'strip\_meta\_desc'                     => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Removes extra information from images, including EXIF and IPTC data (like camera settings and copyright info). This makes the pictures lighter and helps your website load faster. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1944-strip-image-metadata">', '</a>' ), |
| [1633](#L1633) | 'replacer\_desc'                       => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'When enabled, Optimole will manage, optimize, and serve all the images on your website. If disabled, optimization, lazy loading, and other features will no longer be available. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1218-how-to-turn-off-image-replacement-in-optimoles-wordpress-plugin">', '</a>' ), |
| [1634](#L1634) | 'sample\_image\_loading'                => \_\_( 'Loading a sample image.', 'optimole-wp' ), |
| [1635](#L1635) | 'save\_changes'                        => \_\_( 'Save changes', 'optimole-wp' ), |
| [1636](#L1636) | 'show'                                => \_\_( 'Show', 'optimole-wp' ), |
| [1637](#L1637) | 'selected\_sites\_title'                => \_\_( 'CURRENTLY SHOWING IMAGES FROM', 'optimole-wp' ), |
| [1638](#L1638) | 'selected\_sites\_desc'                 => \_\_( 'Site:', 'optimole-wp' ), |
| [1639](#L1639) | 'selected\_all\_sites\_desc'             => \_\_( 'Currently viewing images from all sites', 'optimole-wp' ), |
| [1640](#L1640) | 'select\_all\_sites\_desc'               => \_\_( 'View images from all sites', 'optimole-wp' ), |
| [1641](#L1641) | 'select\_site'                         => \_\_( 'Select a website', 'optimole-wp' ), |
| [1642](#L1642) | 'cloud\_site\_title'                    => \_\_( 'Show images only from these sites:', 'optimole-wp' ), |
| [1643](#L1643) | 'cloud\_site\_desc'                     => \_\_( 'Browse images only from the specified websites. Otherwise, images from all websites will appear in the library.', 'optimole-wp' ), |
| [1644](#L1644) | 'toggle\_ab\_item'                      => \_\_( 'Admin bar status', 'optimole-wp' ), |
| [1645](#L1645) | 'toggle\_lazyload'                     => \_\_( 'Scale Images & Lazy loading', 'optimole-wp' ), |
| [1646](#L1646) | 'toggle\_scale'                        => \_\_( 'Image Scaling', 'optimole-wp' ), |
| [1647](#L1647) | 'toggle\_native'                       => \_\_( 'Browser Native Lazy Load', 'optimole-wp' ), |
| [1648](#L1648) | 'on\_toggle'                           => \_\_( 'On', 'optimole-wp' ), |
| [1649](#L1649) | 'off\_toggle'                          => \_\_( 'Off', 'optimole-wp' ), |
| [1650](#L1650) | 'view\_sample\_image'                   => \_\_( 'View sample image', 'optimole-wp' ), |
| [1651](#L1651) | 'watch\_placeholder\_lazyload'          => \_\_( 'Add each CSS selector on a new line or separated by comma(,)', 'optimole-wp' ), |
| [1652](#L1652) | 'watch\_desc\_lazyload'                 => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'Enter CSS selectors for any background images not covered by the default lazy loading. This ensures those images also benefit from the optimized loading process. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1169-how-to-enable-the-background-lazyload-feature-for-certain-background-images">', '</a>' ), |
| [1653](#L1653) | 'watch\_title\_lazyload'                => \_\_( 'Extend CSS Background Lazy Loading', 'optimole-wp' ), |
| [1654](#L1654) | 'width\_field'                         => \_\_( 'Width', 'optimole-wp' ), |
| [1655](#L1655) | 'crop'                                => \_\_( 'crop', 'optimole-wp' ), |
| [1656](#L1656) | 'toggle\_cdn'                          => \_\_( 'Serve CSS & JS Through Optimole', 'optimole-wp' ), |
| [1657](#L1657) | 'cdn\_desc'                            => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'When enabled, Optimole will optimize your CSS and JS files and, if they contain images, the images as well, then deliver them via the CDN for faster webpage loading. %1$sLearn more%2$s', 'optimole-wp' ), '<a class="inline-block text-purple-gray underline" target=”\_blank” href="https://docs.optimole.com/article/1966-serve-css-js-through-optimole">', '</a>' ), |
| [1658](#L1658) | 'enable\_css\_minify\_title'             => \_\_( 'Minify CSS files', 'optimole-wp' ), |
| [1659](#L1659) | 'css\_minify\_desc'                     => \_\_( 'Once Optimole will serve your CSS files, it will also minify the files and serve them via CDN.', 'optimole-wp' ), |
| [1660](#L1660) | 'enable\_js\_minify\_title'              => \_\_( 'Minify JS files', 'optimole-wp' ), |
| [1661](#L1661) | 'js\_minify\_desc'                      => \_\_( 'Once Optimole will serve your JS files, it will also minify the files and serve them via CDN.', 'optimole-wp' ), |
| [1662](#L1662) | 'sync\_title'                          => \_\_( 'Offload Existing Images', 'optimole-wp' ), |
| [1663](#L1663) | 'rollback\_title'                      => \_\_( 'Restore Offloaded Images', 'optimole-wp' ), |
| [1664](#L1664) | 'sync\_desc'                           => \_\_( 'Right now all the new images uploaded to your site are moved automatically to Optimole Cloud. In order to offload the existing ones, please click Sync images and wait for the process to finish. You can rollback anytime.', 'optimole-wp' ), |
| [1665](#L1665) | 'rollback\_desc'                       => \_\_( 'Pull all the offloaded images to Optimole Cloud back to your server.', 'optimole-wp' ), |
| [1666](#L1666) | 'sync\_media'                          => \_\_( 'Sync images', 'optimole-wp' ), |
| [1667](#L1667) | 'rollback\_media'                      => \_\_( 'Rollback images', 'optimole-wp' ), |
| [1668](#L1668) | 'sync\_media\_progress'                 => \_\_( 'Moving your images to Optimole...', 'optimole-wp' ), |
| [1669](#L1669) | 'estimated\_time'                      => \_\_( 'Estimated time remaining', 'optimole-wp' ), |
| [1670](#L1670) | 'calculating\_estimated\_time'          => \_\_( 'We are currently calculating the estimated time for this job...', 'optimole-wp' ), |
| [1671](#L1671) | 'images\_processing'                   => \_\_( 'We are currently processing your images in the background. Leaving the page won\'t stop the process.', 'optimole-wp' ), |
| [1672](#L1672) | 'active\_optimize\_exclusions'          => \_\_( 'Active Optimizing Exclusions', 'optimole-wp' ), |
| [1673](#L1673) | 'active\_lazyload\_exclusions'          => \_\_( 'Active Lazy-loading Exclusions', 'optimole-wp' ), |
| [1674](#L1674) | 'minutes'                             => \_\_( 'minutes', 'optimole-wp' ), |
| [1675](#L1675) | 'stop'                                => \_\_( 'Stop', 'optimole-wp' ), |
| [1676](#L1676) | 'show\_logs'                           => \_\_( 'Show Logs', 'optimole-wp' ), |
| [1677](#L1677) | 'hide\_logs'                           => \_\_( 'Hide Logs', 'optimole-wp' ), |
| [1678](#L1678) | 'view\_logs'                           => \_\_( 'View Full Logs', 'optimole-wp' ), |
| [1679](#L1679) | 'rollback\_media\_progress'             => \_\_( 'Moving images into your media library...', 'optimole-wp' ), |
| [1680](#L1680) | 'rollback\_media\_error'                => \_\_( 'An unexpected error occured while pulling the offloaded back to your site', 'optimole-wp' ), |
| [1681](#L1681) | 'rollback\_media\_error\_desc'           => \_\_( 'You can try again to pull back the rest of the images.', 'optimole-wp' ), |
| [1682](#L1682) | 'remove\_notice'                       => \_\_( 'Remove notice', 'optimole-wp' ), |
| [1683](#L1683) | 'sync\_media\_error'                    => \_\_( 'An unexpected error occured while offloading all existing images from your site to Optimole', 'optimole-wp' ), |
| [1684](#L1684) | 'sync\_media\_link'                     => \_\_( 'The selected images have been offloaded to our servers, you can check them', 'optimole-wp' ), |
| [1685](#L1685) | 'rollback\_media\_link'                 => \_\_( 'The selected images have been restored to your server, you can check them', 'optimole-wp' ), |
| [1686](#L1686) | 'sync\_media\_error\_desc'               => \_\_( 'You can try again to offload the rest of the images to Optimole.', 'optimole-wp' ), |
| [1687](#L1687) | 'offload\_disable\_warning\_title'       => \_\_( 'Important! Please read carefully', 'optimole-wp' ), |
| [1688](#L1688) | 'offload\_disable\_warning\_desc'        => \_\_( 'If you turn off this option, you will not be able to see the images in the Media Library without restoring the images first. Do you want to restore the images to your site upon turning off the option?', 'optimole-wp' ), |
| [1689](#L1689) | 'offload\_enable\_info\_desc'            => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'You are not required to use the offload functionality for the plugin to work, use it if you want to save on hosting space. %1$s More details%2$s', 'optimole-wp' ), '<a style="white-space: nowrap;" target=”\_blank” href="https://docs.optimole.com/article/1323-cloud-library-browsing">', '<span style="font-size:15px; margin-top:2px;" class="dashicons dashicons-external"></span></a>' ), |
| [1690](#L1690) | 'offload\_conflicts\_part\_1'            => \_\_( 'We have detected the following plugins that conflict with the offload features:', 'optimole-wp' ), |
| [1691](#L1691) | 'offload\_conflicts\_part\_2'            => \_\_( 'Please disable those plugins temporarily in order for Optimole to rollback the images to your site.', 'optimole-wp' ), |
| [1692](#L1692) | 'offloading\_success'                  => sprintf( /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/ \_\_( '%s Your images are now stored in Optimole Cloud.', 'optimole-wp' ), '<strong>' . \_\_( 'Transfer Complete.', 'optimole-wp' ) . '</strong>' ), |
| [1693](#L1693) | 'rollback\_success'                    => sprintf( /\* translators: 1 is the starting bold tag, 2 is the ending bold tag \*/ \_\_( '%s Your images have been restored to your website.', 'optimole-wp' ), '<strong>' . \_\_( 'Transfer Complete.', 'optimole-wp' ) . '</strong>' ), |
| [1694](#L1694) | 'offloading\_radio\_legend'             => \_\_( 'Where your images are stored', 'optimole-wp' ), |
| [1695](#L1695) | 'offload\_radio\_option\_rollback\_title' => \_\_( 'Optimole Cloud and your website', 'optimole-wp' ), |
| [1696](#L1696) | 'offload\_radio\_option\_rollback\_desc'  => \_\_( 'Images are stored in both the local WordPress media library and Optimole Cloud.', 'optimole-wp' ), |
| [1697](#L1697) | 'offload\_radio\_option\_offload\_title'  => \_\_( 'Optimole Cloud only', 'optimole-wp' ), |
| [1698](#L1698) | 'offload\_radio\_option\_offload\_desc'   => \_\_( 'Images are stored only in Optimole Cloud, allowing you to save space on your server. When enabled, any new images you upload in the Media Library will be automatically transferred to Optimole Cloud.', 'optimole-wp' ), |
| [1699](#L1699) | 'offload\_limit\_reached'               => sprintf( /\* translators: Current limit of offloaded images \*/ \_\_( 'You have reached the maximum offloading limit of %s images. To increase the offload limit and for more information, contact our support.', 'optimole-wp' ), '<strong>#offload\_limit#</strong>' ), |
| [1700](#L1700) | 'select'                              => \_\_( 'Please select one ...', 'optimole-wp' ), |
| [1701](#L1701) | 'yes'                                 => \_\_( 'Restore images after disabling', 'optimole-wp' ), |
| [1702](#L1702) | 'no'                                  => \_\_( 'Do not restore images after disabling', 'optimole-wp' ), |
| [1703](#L1703) | 'lazyload\_placeholder\_color'          => \_\_( 'Placeholder Color', 'optimole-wp' ), |
| [1704](#L1704) | 'clear'                               => \_\_( 'Clear', 'optimole-wp' ), |
| [1705](#L1705) | 'settings\_saved'                      => \_\_( 'Settings saved', 'optimole-wp' ), |
| [1706](#L1706) | 'settings\_saved\_error'                => \_\_( 'Error saving settings. Please reload the page and try again.', 'optimole-wp' ), |
| [1707](#L1707) | 'cache\_cleared'                       => \_\_( 'Cache cleared', 'optimole-wp' ), |
| [1708](#L1708) | 'cache\_cleared\_error'                 => \_\_( 'Error clearing cache. Please reload the page and try again.', 'optimole-wp' ), |
| [1709](#L1709) | 'offloading\_start\_title'              => \_\_( 'Transfer your images to Optimole', 'optimole-wp' ), |
| [1710](#L1710) | 'offloading\_start\_description'        => \_\_( 'This process will transfer and store your images in Optimole Cloud and may take a while, depending on the number of images.', 'optimole-wp' ), |
| [1711](#L1711) | 'offloading\_start\_action'             => \_\_( 'Transfer to Optimole Cloud', 'optimole-wp' ), |
| [1712](#L1712) | 'offloading\_stop\_title'               => \_\_( 'Are you sure?', 'optimole-wp' ), |
| [1713](#L1713) | 'offloading\_stop\_description'         => \_\_( 'This will halt the ongoing process. To retrieve images transferred from the Optimole Cloud, use the Rollback option.', 'optimole-wp' ), |
| [1714](#L1714) | 'offloading\_stop\_action'              => \_\_( 'Cancel the transfer to Optimole', 'optimole-wp' ), |
| [1715](#L1715) | 'rollback\_start\_title'                => \_\_( 'Transfer back all images to your site', 'optimole-wp' ), |
| [1716](#L1716) | 'rollback\_start\_description'          => \_\_( 'This process will transfer back all images from Optimole to your website and may take a while, depending on the number of images.', 'optimole-wp' ), |
| [1717](#L1717) | 'rollback\_start\_action'               => \_\_( 'Transfer back from Optimole', 'optimole-wp' ), |
| [1718](#L1718) | 'rollback\_stop\_title'                 => \_\_( 'Are you sure?', 'optimole-wp' ), |
| [1719](#L1719) | 'rollback\_stop\_description'           => \_\_( 'Canceling will halt the ongoing process, and any remaining images will stay in the Optimole Cloud. To transfer images to the Optimole Cloud, use the Offloading option.', 'optimole-wp' ), |
| [1720](#L1720) | 'rollback\_stop\_action'                => \_\_( 'Cancel the transfer from Optimole', 'optimole-wp' ), |
| [1721](#L1721) | ], |
| [1722](#L1722) | 'help'                           => [ |
| [1723](#L1723) | 'section\_one\_title'           => \_\_( 'Help and Support', 'optimole-wp' ), |
| [1724](#L1724) | 'section\_two\_title'           => \_\_( 'Documentation', 'optimole-wp' ), |
| [1725](#L1725) | 'section\_two\_sub'             => \_\_( 'Docs Page', 'optimole-wp' ), |
| [1726](#L1726) | 'get\_support\_title'           => \_\_( 'Get Support', 'optimole-wp' ), |
| [1727](#L1727) | 'get\_support\_desc'            => \_\_( 'Need help or got a question? Submit a ticket and we\'ll get back to you.', 'optimole-wp' ), |
| [1728](#L1728) | 'get\_support\_cta'             => \_\_( 'Contact Support', 'optimole-wp' ), |
| [1729](#L1729) | 'feat\_request\_title'          => \_\_( 'Have a feature request?', 'optimole-wp' ), |
| [1730](#L1730) | 'feat\_request\_desc'           => \_\_( 'Help us improve Optimole by sharing feedback and ideas for new features.', 'optimole-wp' ), |
| [1731](#L1731) | 'feat\_request\_cta'            => \_\_( 'Submit a Feature Request', 'optimole-wp' ), |
| [1732](#L1732) | 'feedback\_title'              => \_\_( 'Changelog', 'optimole-wp' ), |
| [1733](#L1733) | 'feedback\_desc'               => \_\_( 'Check our changelog to see latest fixes and features implemented.', 'optimole-wp' ), |
| [1734](#L1734) | 'feedback\_cta'                => \_\_( 'View Changelog', 'optimole-wp' ), |
| [1735](#L1735) | 'account\_title'               => \_\_( 'Account', 'optimole-wp' ), |
| [1736](#L1736) | 'account\_item\_one'            => \_\_( 'How Optimole counts the visitors?', 'optimole-wp' ), |
| [1737](#L1737) | 'account\_item\_two'            => \_\_( 'What happens if I exceed plan limits?', 'optimole-wp' ), |
| [1738](#L1738) | 'account\_item\_three'          => \_\_( 'Visits based plan', 'optimole-wp' ), |
| [1739](#L1739) | 'image\_processing\_title'      => \_\_( 'Image Processing', 'optimole-wp' ), |
| [1740](#L1740) | 'image\_processing\_item\_one'   => \_\_( 'Getting Started With Optimole', 'optimole-wp' ), |
| [1741](#L1741) | 'image\_processing\_item\_two'   => \_\_( 'How Optimole can serve WebP images', 'optimole-wp' ), |
| [1742](#L1742) | 'image\_processing\_item\_three' => \_\_( 'Adding Watermarks to your images', 'optimole-wp' ), |
| [1743](#L1743) | 'api\_title'                   => \_\_( 'API', 'optimole-wp' ), |
| [1744](#L1744) | 'api\_item\_one'                => \_\_( 'Cloud Library Browsing', 'optimole-wp' ), |
| [1745](#L1745) | 'api\_item\_two'                => \_\_( 'Exclude from Optimizing or Lazy Loading', 'optimole-wp' ), |
| [1746](#L1746) | 'api\_item\_three'              => \_\_( 'Custom Integration', 'optimole-wp' ), |
| [1747](#L1747) | ], |
| [1748](#L1748) | 'watermarks'                     => [ |
| [1749](#L1749) | 'image'                    => \_\_( 'Image', 'optimole-wp' ), |
| [1750](#L1750) | 'loading\_remove\_watermark' => \_\_( 'Removing watermark resource ...', 'optimole-wp' ), |
| [1751](#L1751) | 'max\_allowed'              => \_\_( 'You are allowed to save maximum 5 images.', 'optimole-wp' ), |
| [1752](#L1752) | 'list\_header'              => \_\_( 'Possible watermarks', 'optimole-wp' ), |
| [1753](#L1753) | 'settings\_header'          => \_\_( 'Watermarks position settings', 'optimole-wp' ), |
| [1754](#L1754) | 'no\_images\_found'          => \_\_( 'No images available for watermark. Please upload one.', 'optimole-wp' ), |
| [1755](#L1755) | 'id'                       => \_\_( 'ID', 'optimole-wp' ), |
| [1756](#L1756) | 'name'                     => \_\_( 'Name', 'optimole-wp' ), |
| [1757](#L1757) | 'type'                     => \_\_( 'Type', 'optimole-wp' ), |
| [1758](#L1758) | 'action'                   => \_\_( 'Action', 'optimole-wp' ), |
| [1759](#L1759) | 'upload'                   => \_\_( 'Upload', 'optimole-wp' ), |
| [1760](#L1760) | 'add\_desc'                 => \_\_( 'Add new watermark', 'optimole-wp' ), |
| [1761](#L1761) | 'wm\_title'                 => \_\_( 'Active watermark', 'optimole-wp' ), |
| [1762](#L1762) | 'wm\_desc'                  => \_\_( 'The active watermark to use from the list of uploaded watermarks.', 'optimole-wp' ), |
| [1763](#L1763) | 'opacity\_field'            => \_\_( 'Opacity', 'optimole-wp' ), |
| [1764](#L1764) | 'opacity\_title'            => \_\_( 'Watermark opacity', 'optimole-wp' ), |
| [1765](#L1765) | 'opacity\_desc'             => \_\_( 'A value between 0 and 100 for the opacity level. If set to 0 it will disable the watermark.', 'optimole-wp' ), |
| [1766](#L1766) | 'position\_title'           => \_\_( 'Watermark position', 'optimole-wp' ), |
| [1767](#L1767) | 'position\_desc'            => \_\_( 'The place relative to the image where the watermark should be placed.', 'optimole-wp' ), |
| [1768](#L1768) | 'pos\_nowe\_title'           => \_\_( 'North-West', 'optimole-wp' ), |
| [1769](#L1769) | 'pos\_no\_title'             => \_\_( 'North', 'optimole-wp' ), |
| [1770](#L1770) | 'pos\_noea\_title'           => \_\_( 'North-East', 'optimole-wp' ), |
| [1771](#L1771) | 'pos\_we\_title'             => \_\_( 'West', 'optimole-wp' ), |
| [1772](#L1772) | 'pos\_ce\_title'             => \_\_( 'Center', 'optimole-wp' ), |
| [1773](#L1773) | 'pos\_ea\_title'             => \_\_( 'East', 'optimole-wp' ), |
| [1774](#L1774) | 'pos\_sowe\_title'           => \_\_( 'South-West', 'optimole-wp' ), |
| [1775](#L1775) | 'pos\_so\_title'             => \_\_( 'South', 'optimole-wp' ), |
| [1776](#L1776) | 'pos\_soea\_title'           => \_\_( 'South-East', 'optimole-wp' ), |
| [1777](#L1777) | 'offset\_x\_field'           => \_\_( 'Offset X', 'optimole-wp' ), |
| [1778](#L1778) | 'offset\_y\_field'           => \_\_( 'Offset Y', 'optimole-wp' ), |
| [1779](#L1779) | 'offset\_title'             => \_\_( 'Watermark offset', 'optimole-wp' ), |
| [1780](#L1780) | 'offset\_desc'              => \_\_( 'Offset the watermark from set position on X and Y axis. Values can be positive or negative.', 'optimole-wp' ), |
| [1781](#L1781) | 'scale\_field'              => \_\_( 'Scale', 'optimole-wp' ), |
| [1782](#L1782) | 'scale\_title'              => \_\_( 'Watermark scale', 'optimole-wp' ), |
| [1783](#L1783) | 'scale\_desc'               => \_\_( 'A value between 0 and 300 for the scale of the watermark (100 is the original size and 300 is 3x the size) relative to the resulting image size. If set to 0 it will default to the original size.', 'optimole-wp' ), |
| [1784](#L1784) | 'save\_changes'             => \_\_( 'Save changes', 'optimole-wp' ), |
| [1785](#L1785) | ], |
| [1786](#L1786) | 'latest\_images'                  => [ |
| [1787](#L1787) | 'image'                 => \_\_( 'Image', 'optimole-wp' ), |
| [1788](#L1788) | 'no\_images\_found'       => sprintf( /\* translators: 1 is the starting anchor tag, 2 is the ending anchor tag \*/ \_\_( 'We are currently optimizing your images. Meanwhile you can visit your %1$shomepage%2$s and check how our plugin performs.', 'optimole-wp' ), '<a href="' . esc\_url( home\_url() ) . '" target="\_blank" >', '</a>' ), |
| [1789](#L1789) | 'compression'           => \_\_( 'Optimization', 'optimole-wp' ), |
| [1790](#L1790) | 'loading\_latest\_images' => \_\_( 'Loading your optimized images...', 'optimole-wp' ), |
| [1791](#L1791) | 'last'                  => \_\_( 'Last', 'optimole-wp' ), |
| [1792](#L1792) | 'saved'                 => \_\_( 'Saved', 'optimole-wp' ), |
| [1793](#L1793) | 'smaller'               => \_\_( 'smaller', 'optimole-wp' ), |
| [1794](#L1794) | 'optimized\_images'      => \_\_( 'optimized images', 'optimole-wp' ), |
| [1795](#L1795) | 'same\_size'             => \_\_( '🙉 We couldn\'t do better, this image is already optimized at maximum.', 'optimole-wp' ), |
| [1796](#L1796) | 'small\_optimization'    => \_\_( '😬 Not that much, just <strong>{ratio}</strong> smaller.', 'optimole-wp' ), |
| [1797](#L1797) | 'medium\_optimization'   => \_\_( '🤓 We are on the right track, <strong>{ratio}</strong> squeezed.', 'optimole-wp' ), |
| [1798](#L1798) | 'big\_optimization'      => \_\_( '❤️❤️❤️ Our moles just nailed it, this one is <strong>{ratio}</strong> smaller.', 'optimole-wp' ), |
| [1799](#L1799) | ], |
| [1800](#L1800) | 'csat'                           => [ |
| [1801](#L1801) | 'title'                => \_\_( 'Your opinion matters', 'optimole-wp' ), |
| [1802](#L1802) | 'close'                => \_\_( 'Close', 'optimole-wp' ), |
| [1803](#L1803) | 'heading\_one'          => \_\_( 'How easy did you find to get started using Optimole, on a scale of 1 to 5?', 'optimole-wp' ), |
| [1804](#L1804) | 'heading\_two'          => \_\_( 'Any specific feedback you would like to add?', 'optimole-wp' ), |
| [1805](#L1805) | 'heading\_three'        => \_\_( 'Thank you!', 'optimole-wp' ), |
| [1806](#L1806) | 'low'                  => \_\_( 'Very Poor', 'optimole-wp' ), |
| [1807](#L1807) | 'high'                 => \_\_( 'Excellent', 'optimole-wp' ), |
| [1808](#L1808) | 'feedback\_placeholder' => \_\_( 'Add your feedback here (optional)', 'optimole-wp' ), |
| [1809](#L1809) | 'skip'                 => \_\_( 'Skip', 'optimole-wp' ), |
| [1810](#L1810) | 'submit'               => \_\_( 'Submit', 'optimole-wp' ), |
| [1811](#L1811) | 'thank\_you'            => \_\_( 'Your input is highly appreciated and helps us shape a better experience in Optimole.', 'optimole-wp' ), |
| [1812](#L1812) | ], |
| [1813](#L1813) | 'cron\_error'                     => sprintf( /\* translators: 1 is code to disable cron, 2 value of the constant \*/ \_\_( 'It seems that you have the %1$s constant defined as %2$s. The offloading process uses cron events to offload the images in the background. Please remove the constant from your wp-config.php file in order for the offloading process to work.', 'optimole-wp' ), '<code>DISABLE\_WP\_CRON</code>', '<code>true</code>' ), |
| [1814](#L1814) | 'cancel'                         => \_\_( 'Cancel', 'optimole-wp' ), |
| [1815](#L1815) | ]; |
| [1816](#L1816) | } |
| [1817](#L1817) |  |
| [1818](#L1818) | /\*\* |
| [1819](#L1819) | \* Allow SVG uploads |
| [1820](#L1820) | \* |
| [1821](#L1821) | \* @param array $mimes Supported mimes. |
| [1822](#L1822) | \* |
| [1823](#L1823) | \* @return array |
| [1824](#L1824) | \* @access public |
| [1825](#L1825) | \* @uses filter:upload\_mimes |
| [1826](#L1826) | \*/ |
| [1827](#L1827) | public function allow\_meme\_types( $mimes ) { |
| [1828](#L1828) | $mimes['svg'] = 'image/svg+xml'; |
| [1829](#L1829) |  |
| [1830](#L1830) | return $mimes; |
| [1831](#L1831) | } |
| [1832](#L1832) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/optimole-wp/tags/3.12.10/inc/admin.php?format=txt)
* [Original Format](/export/3220651/optimole-wp/tags/3.12.10/inc/admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_59134315_20250111_095855.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3086306)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3086305 "Changeset 3086305")
* [Next Changeset](/changeset/3086307 "Changeset 3086307") →

---

# Changeset 3086306

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/14/2024 07:52:22 AM
([8 months](/timeline?from=2024-05-14T07%3A52%3A22Z&precision=second "See timeline at 05/14/2024 07:52:22 AM") ago)

Author:
optimole
Message:

Update to version 3.13.0 from GitHub

Location:
[optimole-wp](/browser/optimole-wp?rev=3086306)
Files:

126 added
10 deleted
60 edited
1 copied

* [tags/3.13.0](/browser/optimole-wp/tags/3.13.0?rev=3086306 "Show entry in browser")
  (copied)
  *(copied from [optimole-wp/trunk](/browser/optimole-wp/trunk?rev=3086305 "Show original file (revision 3086305)"))*
* [tags/3.13.0/CHANGELOG.md](/browser/optimole-wp/tags/3.13.0/CHANGELOG.md?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/3.13.0/assets/build/dashboard/index.asset.php](/browser/optimole-wp/tags/3.13.0/assets/build/dashboard/index.asset.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/3.13.0/assets/build/dashboard/index.js](/browser/optimole-wp/tags/3.13.0/assets/build/dashboard/index.js?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/3.13.0/inc/admin.php](/browser/optimole-wp/tags/3.13.0/inc/admin.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file4 "Show differences"))
* [tags/3.13.0/inc/app\_replacer.php](/browser/optimole-wp/tags/3.13.0/inc/app_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file5 "Show differences"))
* [tags/3.13.0/inc/asset.php](/browser/optimole-wp/trunk/inc/asset.php?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [tags/3.13.0/inc/asset\_properties](/browser/optimole-wp/trunk/inc/asset_properties?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [tags/3.13.0/inc/attachment\_cache.php](/browser/optimole-wp/tags/3.13.0/inc/attachment_cache.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [tags/3.13.0/inc/compatibilities/envira.php](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/envira.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [tags/3.13.0/inc/compatibilities/shortcode\_ultimate.php](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/shortcode_ultimate.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [tags/3.13.0/inc/config.php](/browser/optimole-wp/tags/3.13.0/inc/config.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file11 "Show differences"))
* [tags/3.13.0/inc/dam.php](/browser/optimole-wp/tags/3.13.0/inc/dam.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file12 "Show differences"))
* [tags/3.13.0/inc/image.php](/browser/optimole-wp/trunk/inc/image.php?rev=2999023 "Show what was removed (content at revision 3086305)")
  (deleted)
* [tags/3.13.0/inc/image\_properties](/browser/optimole-wp/trunk/inc/image_properties?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [tags/3.13.0/inc/lazyload\_replacer.php](/browser/optimole-wp/tags/3.13.0/inc/lazyload_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file15 "Show differences"))
* [tags/3.13.0/inc/main.php](/browser/optimole-wp/tags/3.13.0/inc/main.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [tags/3.13.0/inc/manager.php](/browser/optimole-wp/tags/3.13.0/inc/manager.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [tags/3.13.0/inc/media\_offload.php](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306 "Show entry in browser")
  (modified)
  ([12 diffs](#file18 "Show differences"))
* [tags/3.13.0/inc/resource.php](/browser/optimole-wp/trunk/inc/resource.php?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [tags/3.13.0/inc/rest.php](/browser/optimole-wp/tags/3.13.0/inc/rest.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file20 "Show differences"))
* [tags/3.13.0/inc/settings.php](/browser/optimole-wp/tags/3.13.0/inc/settings.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file21 "Show differences"))
* [tags/3.13.0/inc/tag\_replacer.php](/browser/optimole-wp/tags/3.13.0/inc/tag_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))
* [tags/3.13.0/inc/traits/dam\_offload\_utils.php](/browser/optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file23 "Show differences"))
* [tags/3.13.0/inc/traits/normalizer.php](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([6 diffs](#file24 "Show differences"))
* [tags/3.13.0/inc/url\_replacer.php](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([6 diffs](#file25 "Show differences"))
* [tags/3.13.0/optimole-wp.php](/browser/optimole-wp/tags/3.13.0/optimole-wp.php?rev=3086306 "Show entry in browser")
  (modified)
  ([4 diffs](#file26 "Show differences"))
* [tags/3.13.0/readme.txt](/browser/optimole-wp/tags/3.13.0/readme.txt?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file27 "Show differences"))
* [tags/3.13.0/vendor/autoload.php](/browser/optimole-wp/tags/3.13.0/vendor/autoload.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [tags/3.13.0/vendor/codeinwp/optimole-sdk](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/LICENSE](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/README.md](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/README.md?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Optimole.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Optimole.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AbstractResource.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AbstractResource.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/Asset.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/Asset.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/Image.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/Image.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/ValueObject](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/ValueObject?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/codeinwp/optimole-sdk/src/ValueObject/Position.php](/browser/optimole-wp/tags/3.13.0/vendor/codeinwp/optimole-sdk/src/ValueObject/Position.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/composer/autoload\_classmap.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_classmap.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file57 "Show differences"))
* [tags/3.13.0/vendor/composer/autoload\_files.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_files.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file58 "Show differences"))
* [tags/3.13.0/vendor/composer/autoload\_psr4.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_psr4.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file59 "Show differences"))
* [tags/3.13.0/vendor/composer/autoload\_real.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_real.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file60 "Show differences"))
* [tags/3.13.0/vendor/composer/autoload\_static.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_static.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file61 "Show differences"))
* [tags/3.13.0/vendor/composer/installed.json](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.json?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file62 "Show differences"))
* [tags/3.13.0/vendor/composer/installed.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file63 "Show differences"))
* [tags/3.13.0/vendor/composer/platform\_check.php](/browser/optimole-wp/tags/3.13.0/vendor/composer/platform_check.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined](/browser/optimole-wp/tags/3.13.0/vendor/enshrined?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/LICENSE](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/README.md](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/README.md?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/Exceptions](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/Exceptions?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/Helper.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/Helper.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/Sanitizer.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/Sanitizer.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/TagInterface.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/TagInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/XPath.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/data/XPath.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/enshrined/svg-sanitize/src/svg-scanner.php](/browser/optimole-wp/tags/3.13.0/vendor/enshrined/svg-sanitize/src/svg-scanner.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony](/browser/optimole-wp/tags/3.13.0/vendor/symfony?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/LICENSE](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Php80.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Php80.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/PhpToken.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/PhpToken.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/README.md](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/README.md?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/Attribute.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/Attribute.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/PhpToken.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/PhpToken.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/Stringable.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/Stringable.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/ValueError.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/Resources/stubs/ValueError.php?rev=3086306 "Show entry in browser")
  (added)
* [tags/3.13.0/vendor/symfony/polyfill-php80/bootstrap.php](/browser/optimole-wp/tags/3.13.0/vendor/symfony/polyfill-php80/bootstrap.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/CHANGELOG.md](/browser/optimole-wp/trunk/CHANGELOG.md?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file99 "Show differences"))
* [trunk/assets/build/dashboard/index.asset.php](/browser/optimole-wp/trunk/assets/build/dashboard/index.asset.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file100 "Show differences"))
* [trunk/assets/build/dashboard/index.js](/browser/optimole-wp/trunk/assets/build/dashboard/index.js?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file101 "Show differences"))
* [trunk/inc/admin.php](/browser/optimole-wp/trunk/inc/admin.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file102 "Show differences"))
* [trunk/inc/app\_replacer.php](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file103 "Show differences"))
* [trunk/inc/asset.php](/browser/optimole-wp/trunk/inc/asset.php?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [trunk/inc/asset\_properties](/browser/optimole-wp/trunk/inc/asset_properties?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [trunk/inc/attachment\_cache.php](/browser/optimole-wp/trunk/inc/attachment_cache.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file106 "Show differences"))
* [trunk/inc/compatibilities/envira.php](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file107 "Show differences"))
* [trunk/inc/compatibilities/shortcode\_ultimate.php](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file108 "Show differences"))
* [trunk/inc/config.php](/browser/optimole-wp/trunk/inc/config.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file109 "Show differences"))
* [trunk/inc/dam.php](/browser/optimole-wp/trunk/inc/dam.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file110 "Show differences"))
* [trunk/inc/image.php](/browser/optimole-wp/trunk/inc/image.php?rev=2999023 "Show what was removed (content at revision 3086305)")
  (deleted)
* [trunk/inc/image\_properties](/browser/optimole-wp/trunk/inc/image_properties?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [trunk/inc/lazyload\_replacer.php](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file113 "Show differences"))
* [trunk/inc/main.php](/browser/optimole-wp/trunk/inc/main.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file114 "Show differences"))
* [trunk/inc/manager.php](/browser/optimole-wp/trunk/inc/manager.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file115 "Show differences"))
* [trunk/inc/media\_offload.php](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306 "Show entry in browser")
  (modified)
  ([12 diffs](#file116 "Show differences"))
* [trunk/inc/resource.php](/browser/optimole-wp/trunk/inc/resource.php?rev=2935150 "Show what was removed (content at revision 3086305)")
  (deleted)
* [trunk/inc/rest.php](/browser/optimole-wp/trunk/inc/rest.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file118 "Show differences"))
* [trunk/inc/settings.php](/browser/optimole-wp/trunk/inc/settings.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file119 "Show differences"))
* [trunk/inc/tag\_replacer.php](/browser/optimole-wp/trunk/inc/tag_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file120 "Show differences"))
* [trunk/inc/traits/dam\_offload\_utils.php](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3086306 "Show entry in browser")
  (modified)
  ([3 diffs](#file121 "Show differences"))
* [trunk/inc/traits/normalizer.php](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([6 diffs](#file122 "Show differences"))
* [trunk/inc/url\_replacer.php](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306 "Show entry in browser")
  (modified)
  ([6 diffs](#file123 "Show differences"))
* [trunk/optimole-wp.php](/browser/optimole-wp/trunk/optimole-wp.php?rev=3086306 "Show entry in browser")
  (modified)
  ([4 diffs](#file124 "Show differences"))
* [trunk/readme.txt](/browser/optimole-wp/trunk/readme.txt?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file125 "Show differences"))
* [trunk/vendor/autoload.php](/browser/optimole-wp/trunk/vendor/autoload.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file126 "Show differences"))
* [trunk/vendor/codeinwp/optimole-sdk](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/LICENSE](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/README.md](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/README.md?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Optimole.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Optimole.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/AbstractResource.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/AbstractResource.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/Asset.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/Asset.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/Image.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/Image.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/ValueObject](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/ValueObject?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/codeinwp/optimole-sdk/src/ValueObject/Position.php](/browser/optimole-wp/trunk/vendor/codeinwp/optimole-sdk/src/ValueObject/Position.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/composer/autoload\_classmap.php](/browser/optimole-wp/trunk/vendor/composer/autoload_classmap.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file155 "Show differences"))
* [trunk/vendor/composer/autoload\_files.php](/browser/optimole-wp/trunk/vendor/composer/autoload_files.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file156 "Show differences"))
* [trunk/vendor/composer/autoload\_psr4.php](/browser/optimole-wp/trunk/vendor/composer/autoload_psr4.php?rev=3086306 "Show entry in browser")
  (modified)
  ([1 diff](#file157 "Show differences"))
* [trunk/vendor/composer/autoload\_real.php](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file158 "Show differences"))
* [trunk/vendor/composer/autoload\_static.php](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file159 "Show differences"))
* [trunk/vendor/composer/installed.json](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file160 "Show differences"))
* [trunk/vendor/composer/installed.php](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3086306 "Show entry in browser")
  (modified)
  ([2 diffs](#file161 "Show differences"))
* [trunk/vendor/composer/platform\_check.php](/browser/optimole-wp/trunk/vendor/composer/platform_check.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined](/browser/optimole-wp/trunk/vendor/enshrined?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/LICENSE](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/README.md](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/README.md?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/ElementReference?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Resolver.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Subject.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/ElementReference/Usage.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Exceptions](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/Exceptions?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/Exceptions/NestingException.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Helper.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/Helper.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/Sanitizer.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/Sanitizer.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data/AllowedAttributes.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data/AllowedTags.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data/AttributeInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/TagInterface.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data/TagInterface.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/data/XPath.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/data/XPath.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/enshrined/svg-sanitize/src/svg-scanner.php](/browser/optimole-wp/trunk/vendor/enshrined/svg-sanitize/src/svg-scanner.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony](/browser/optimole-wp/trunk/vendor/symfony?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/LICENSE](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/LICENSE?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Php80.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Php80.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/PhpToken.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/PhpToken.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/README.md](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/README.md?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs/Attribute.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs/Attribute.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs/PhpToken.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs/PhpToken.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs/Stringable.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs/Stringable.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/Resources/stubs/ValueError.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/Resources/stubs/ValueError.php?rev=3086306 "Show entry in browser")
  (added)
* [trunk/vendor/symfony/polyfill-php80/bootstrap.php](/browser/optimole-wp/trunk/vendor/symfony/polyfill-php80/bootstrap.php?rev=3086306 "Show entry in browser")
  (added)

### Legend:

Unmodified
Added
Removed

* ## [optimole-wp/tags/3.13.0/CHANGELOG.md](/changeset/3086306/optimole-wp/tags/3.13.0/CHANGELOG.md "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/CHANGELOG.md")

  | [r3073660](/browser/optimole-wp/trunk/CHANGELOG.md?rev=3073660#L1 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/CHANGELOG.md?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | #### [Version 3.13.0](https://github.com/Codeinwp/optimole-wp/compare/v3.12.10...v3.13.0) (2024-05-14) |
  |  | 2 |  |
  |  | 3 | - Optimole is now fully translated into German! This update makes our service more convenient for our German-speaking customers and helps you support your German-speaking clients more effectively. |
  |  | 4 | - We now have a PHP SDK available on GitHub: [Optimole PHP SDK](https://github.com/Optimole/optimole-php-sdk). This SDK simplifies the integration of Optimole’s features with any PHP-based website, making the process straightforward and efficient. |
  |  | 5 | - You can now associate a billing email to receive invoices. For more details, check out our [documentation](https://docs.optimole.com/article/1992-setting-a-billing-email-for-invoice-delivery). |
  |  | 6 | - Weve improved Largest Contentful Paint (LCP) by prioritizing the loading of initial images that are not affected by lazy loading. |
  |  | 7 | - Weve also improved LCP by using the srcset attribute for non-lazyloaded images. |
  |  | 8 | - Weve fixed various issues with offload compatibility to ensure all images load properly, making the service more robust. |
  |  | 9 | - Weve resolved an issue where the offloading process was getting stuck on large websites, making the process smoother and more reliable. |
  |  | 10 | - Weve improved the handling and sanitization of SVG files. |
  |  | 11 |  |
  | 1 | 12 | ##### [Version 3.12.10](https://github.com/Codeinwp/optimole-wp/compare/v3.12.9...v3.12.10) (2024-04-19) |
  | 2 | 13 |  |
* ## [optimole-wp/tags/3.13.0/assets/build/dashboard/index.asset.php](/changeset/3086306/optimole-wp/tags/3.13.0/assets/build/dashboard/index.asset.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/assets/build/dashboard/index.asset.php")

  | [r3071327](/browser/optimole-wp/trunk/assets/build/dashboard/index.asset.php?rev=3071327#L1 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/assets/build/dashboard/index.asset.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('lodash', 'react', 'wp-api', 'wp-api-fetch', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-i18n', 'wp-notices', 'wp-primitives', 'wp-url'), 'version' => '~~6ce0049a03c8935b767d~~'); |
  |  | 1 | <?php return array('dependencies' => array('lodash', 'react', 'wp-api', 'wp-api-fetch', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-i18n', 'wp-notices', 'wp-primitives', 'wp-url'), 'version' => 'bb66bc266c4f9d3eda68'); |
* ## [optimole-wp/tags/3.13.0/assets/build/dashboard/index.js](/changeset/3086306/optimole-wp/tags/3.13.0/assets/build/dashboard/index.js "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/assets/build/dashboard/index.js")

  | [r3071327](/browser/optimole-wp/trunk/assets/build/dashboard/index.js?rev=3071327#L1 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/assets/build/dashboard/index.js?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{var e,t={~~646:(e,t,s)=>{"use strict";var a=s(196);const o=window.wp.element,n={setAutoConnect:e=>({type:"SET\_AUTO\_CONNECT",autoConnect:e}),setAPIKey:e=>({type:"SET\_API\_KEY",apiKey:e}),setAvailableApps:e=>({type:"SET\_AVAILABLE\_APPS",availableApps:e}),setIsConnected:e=>({type:"SET\_IS\_CONNECTED",isConnected:e}),setIsConnecting:e=>({type:"SET\_IS\_CONNECTING",isConnecting:e}),setIsLoading:e=>({type:"SET\_IS\_LOADING",isLoading:e}),sethasDashboardLoaded:e=>({type:"SET\_HAS\_DASHBOARD\_LOADED",hasDashboardLoaded:e}),setHasRestError:e=>({type:"SET\_HAS\_REST\_ERROR",hasRestError:e}),setHasValidKey:e=>({type:"SET\_HAS\_VALID\_KEY",hasValidKey:e}),setHasApplication:e=>({type:"SET\_HAS\_APPLICATION",hasApplication:e}),setUserData:e=>({type:"SET\_USER\_DATA",data:e}),setUserStatus:e=>({type:"SET\_USER\_STATUS",status:e}),setShowDisconnect:e=>({type:"SET\_SHOW\_DISCONNECT",showDisconnect:e}),setConflicts:e=>({type:"SET\_CONFLICTS",conflicts:e}),setOptimizedImages:e=>({type:"SET\_OPTIMIZED\_IMAGES",optimizedImages:e}),setSiteSettings:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:e}),setExtraVisits:e=>({type:"SET\_EXTRA\_VISITS",extraVisitsStatus:e}),setSampleRate:e=>({type:"SET\_SAMPLE\_RATE",sampleRate:e}),setTotalNumberOfImages:e=>({type:"SET\_TOTAL\_NUMBER\_OF\_IMAGES",totalNumberOfImages:e}),setProcessedImages:e=>({type:"SET\_PROCESSED\_IMAGES",processedImages:e}),setOffloadLibraryLink:e=>({type:"SET\_OFFLOAD\_LIBRARY\_LINK",offloadLibraryLink:e}),setRollbackLibraryLink:e=>({type:"SET\_ROLLBACK\_LIBRARY\_LINK",rollbackLibraryLink:e}),setLoadingRollback:e=>({type:"SET\_LOADING\_ROLLBACK",loadingRollback:e}),setLoadingSync:e=>({type:"SET\_LOADING\_SYNC",loadingSync:e}),setQueryArgs:e=>({type:"SET\_QUERY\_ARGS",queryArgs:e}),setErrorMedia:e=>({type:"SET\_ERROR\_MEDIA",errorMedia:e}),setEstimatedTime:e=>({type:"SET\_ESTIMATED\_TIME",estimatedTime:e}),setCheckedOffloadConflicts:e=>({type:"SET\_CHECKED\_OFFLOAD\_CONFLICTS",checkedOffloadConflicts:e}),setOffloadConflicts:e=>({type:"SET\_OFFLOAD\_CONFLICTS",offloadConflicts:e}),setLogs:(e,t)=>({type:"SET\_LOGS",logsType:e,logs:t}),setShowFinishNotice:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{show\_offload\_finish\_notice:e}}),setOffloadLimitReached:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offload\_limit\_reached:e}}),ensureOffloadingRollbackDisabled:()=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offloading\_status:"disabled",rollback\_status:"disabled"}}),setOffloadLimit:e=>({type:"SET\_OFFLOAD\_LIMIT",offloadLimit:e})},r={autoConnect:optimoleDashboardApp.auto\_connect,isConnected:"yes"===optimoleDashboardApp.connection\_status,isConnecting:!1,isLoading:!1,hasRestError:!1,hasValidKey:!0,hasApplication:"yes"===optimoleDashboardApp.has\_application,apiKey:optimoleDashboardApp.api\_key?optimoleDashboardApp.api\_key:"",userStatus:optimoleDashboardApp.user\_status?optimoleDashboardApp.user\_status:"inactive",userData:optimoleDashboardApp.user\_data?optimoleDashboardApp.user\_data:null,availableApps:optimoleDashboardApp.available\_apps?optimoleDashboardApp.available\_apps:null,hasDashboardLoaded:"yes"===optimoleDashboardApp.connection\_status,showDisconnect:!1,conflicts:[],optimizedImages:[],siteSettings:optimoleDashboardApp.site\_settings,sampleRate:{},totalNumberOfImages:0,processedImages:0,offloadLibraryLink:!1,rollbackLibraryLink:!1,loadingRollback:!1,loadingSync:!1,queryArgs:[],errorMedia:!1,checkedOffloadConflicts:!1,offloadConflicts:[],offloadLimit:optimoleDashboardApp.offload\_limit||5e4,logs:{offload:"",rollback:""}},i=(e=r,t)=>{switch(t.type){case"SET\_AUTO\_CONNECT":return{...e,autoConnect:t.autoConnect};case"SET\_HAS\_REST\_ERROR":case"SET\_HAS\_REST\_ERROR":return{...e,hasRestError:t.hasRestError};case"SET\_API\_KEY":return{...e,apiKey:t.apiKey};case"SET\_AVAILABLE\_APPS":return{...e,availableApps:t.availableApps};case"SET\_IS\_CONNECTED":return{...e,isConnected:t.isConnected};case"SET\_IS\_CONNECTING":return{...e,isConnecting:t.isConnecting};case"SET\_IS\_LOADING":return{...e,isLoading:t.isLoading};case"SET\_HAS\_DASHBOARD\_LOADED":return{...e,hasDashboardLoaded:t.hasDashboardLoaded};case"SET\_HAS\_VALID\_KEY":return{...e,hasValidKey:t.hasValidKey};case"SET\_HAS\_APPLICATION":return{...e,hasApplication:t.hasApplication};case"SET\_USER\_DATA":let s="inactive";const{data:a}=t;if(a&&a.app\_count&&1<=a.app\_count&&a.cdn\_key)for(let e of a.available\_apps)e.key&&e.key===a.cdn\_key&&e.status&&"active"===e.status&&(s="active");return{...e,userData:t.data,userStatus:s};case"SET\_USER\_STATUS":return{...e,userStatus:t.status};case"SET\_SHOW\_DISCONNECT":return{...e,showDisconnect:t.showDisconnect};case"SET\_CONFLICTS":return{...e,conflicts:t.conflicts};case"SET\_OPTIMIZED\_IMAGES":return{...e,optimizedImages:t.optimizedImages};case"SET\_SITE\_SETTINGS":let{siteSettings:o}=e;for(let e in t.siteSettings)o[e]=t.siteSettings[e];return{...e,siteSettings:o};case"SET\_EXTRA\_VISITS":{let{siteSettings:s}=e;return s.banner\_frontend=t.extraVisitsStatus?"enabled":"disabled",{...e,siteSettings:s}}case"SET\_SAMPLE\_RATE":return{...e,sampleRate:t.sampleRate};case"SET\_TOTAL\_NUMBER\_OF\_IMAGES":return{...e,totalNumberOfImages:t.totalNumberOfImages};case"SET\_PROCESSED\_IMAGES":return{...e,processedImages:t.processedImages};case"SET\_OFFLOAD\_LIBRARY\_LINK":return{...e,offloadLibraryLink:t.offloadLibraryLink};case"SET\_ROLLBACK\_LIBRARY\_LINK":return{...e,rollbackLibraryLink:t.rollbackLibraryLink};case"SET\_LOADING\_ROLLBACK":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.rollbackLibraryLink=!t.loadingSync),{...e,loadingRollback:t.loadingRollback};case"SET\_LOADING\_SYNC":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.offloadLibraryLink=!t.loadingSync),{...e,loadingSync:t.loadingSync};case"SET\_QUERY\_ARGS":return{...e,queryArgs:t.queryArgs};case"SET\_ERROR\_MEDIA":return{...e,errorMedia:t.errorMedia};case"SET\_CHECKED\_OFFLOAD\_CONFLICTS":return{...e,checkedOffloadConflicts:t.checkedOffloadConflicts};case"SET\_OFFLOAD\_CONFLICTS":return{...e,offloadConflicts:t.offloadConflicts};case"SET\_LOGS":let{logs:n}=e;return n[t.logsType]=t.logs,{...e,logs:n};case"SET\_OFFLOAD\_LIMIT":return{...e,offloadLimit:t.offloadLimit};default:return e}},l={getAutoConnect:e=>e.autoConnect,getAPIKey:e=>e.apiKey,getAvailableApps:e=>e.availableApps,hasRestError:e=>e.hasRestError,hasValidKey:e=>e.hasValidKey,hasApplication:e=>e.hasApplication,hasDashboardLoaded:e=>e.hasDashboardLoaded,getUserData:e=>e.userData,getUserStatus:e=>e.userStatus,isConnected:e=>e.isConnected,isConnecting:e=>e.isConnecting,isLoading:e=>e.isLoading,showDisconnect:e=>e.showDisconnect,getConflicts:e=>e.conflicts,getOptimizedImages:e=>e.optimizedImages,getSiteSettings:(e,t=void 0)=>t?void 0!==e.siteSettings[t]?e.siteSettings[t]:void 0:e.siteSettings,getSampleRate:e=>e.sampleRate,getTotalNumberOfImages:e=>e.totalNumberOfImages,getProcessedImages:e=>e.processedImages,getOffloadLibraryLink:e=>e.offloadLibraryLink,getRollbackLibraryLink:e=>e.rollbackLibraryLink,getLoadingRollback:e=>e.loadingRollback,getLoadingSync:e=>e.loadingSync,getQueryArgs:e=>e.queryArgs,getErrorMedia:e=>e.errorMedia,getCheckedOffloadConflicts:e=>e.checkedOffloadConflicts,getOffloadConflicts:e=>e.offloadConflicts,getOffloadLimit:e=>e.offloadLimit,getLogs:(e,t=void 0)=>t?void 0!==e.logs[t]?e.logs[t]:void 0:e.logs};if(void 0!==wp.data.createReduxStore){const e=wp.data.createReduxStore("optimole",{reducer:i,actions:n,selectors:l});wp.data.register(e)}else wp.data.registerStore("optimole",{reducer:i,actions:n,selectors:l});const c=window.wp.data;var d=s(184),p=s.n(d);const m=window.wp.primitives,u=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})),g=window.wp.components,h=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"20",viewBox:"0 0 21 20",fill:"none"},(0,a.createElement)("path",{d:"M17.357 2.92894C16.9664 2.53842 16.3333 2.53842 15.9427 2.92894C15.5522 3.31946 15.5522 3.95263 15.9427 4.34315L17.357 2.92894ZM16.6499 16.364L15.9427 17.0711H15.9427L16.6499 16.364ZM14.5285 5.75737C14.138 5.36684 13.5048 5.36684 13.1143 5.75737C12.7238 6.14789 12.7238 6.78106 13.1143 7.17158L14.5285 5.75737ZM13.8214 13.5355L13.1143 14.2426L13.1143 14.2427L13.8214 13.5355ZM6.04325 14.2427C6.43377 14.6332 7.06694 14.6332 7.45746 14.2427C7.84799 13.8521 7.84799 13.219 7.45746 12.8284L6.04325 14.2427ZM6.32586 10.5662C6.24822 10.0194 5.74201 9.63905 5.19521 9.71669C4.64841 9.79434 4.26808 10.3005 4.34573 10.8473L6.32586 10.5662ZM3.21482 17.0711C3.60535 17.4616 4.23851 17.4616 4.62903 17.0711C5.01956 16.6806 5.01956 16.0474 4.62903 15.6569L3.21482 17.0711ZM2.70292 7.44452C2.87885 6.921 2.59707 6.354 2.07355 6.17807C1.55004 6.00215 0.98303 6.28393 0.807105 6.80744L2.70292 7.44452ZM1.993 0.292893C1.60247 -0.0976311 0.969306 -0.0976311 0.578782 0.292893C0.188258 0.683417 0.188258 1.31658 0.578782 1.70711L1.993 0.292893ZM18.5788 19.7071C18.9693 20.0976 19.6025 20.0976 19.993 19.7071C20.3835 19.3166 20.3835 18.6834 19.993 18.2929L18.5788 19.7071ZM15.9427 4.34315C19.0669 7.46735 19.0669 12.5327 15.9427 15.6569L17.357 17.0711C21.2622 13.1658 21.2622 6.83418 17.357 2.92894L15.9427 4.34315ZM13.1143 7.17158C14.6764 8.73368 14.6764 11.2663 13.1143 12.8284L14.5285 14.2427C16.8717 11.8995 16.8717 8.10051 14.5285 5.75737L13.1143 7.17158ZM10.2859 10H12.2859C12.2859 8.89544 11.3905 8.00001 10.2859 8.00001V10ZM7.45746 12.8284C6.81978 12.1908 6.44341 11.394 6.32586 10.5662L4.34573 10.8473C4.52209 12.0894 5.08876 13.2882 6.04325 14.2427L7.45746 12.8284ZM4.62903 15.6569C2.40899 13.4368 1.76507 10.2354 2.70292 7.44452L0.807105 6.80744C-0.363267 10.2902 0.43743 14.2937 3.21482 17.0711L4.62903 15.6569ZM10.2859 10L10.2859 10V8.00001C9.73388 8.00001 9.23252 8.22496 8.87168 8.58578L10.2859 10ZM0.578782 1.70711L8.87168 10L10.2859 8.58579L1.993 0.292893L0.578782 1.70711ZM8.87168 10L10.2859 11.4142L11.7001 10L10.2859 8.58579L8.87168 10ZM10.2859 11.4142L13.1143 14.2426L14.5285 12.8284L11.7001 10L10.2859 11.4142ZM13.1143 14.2427L15.9427 17.0711L17.357 15.6569L14.5285 12.8284L13.1143 14.2427ZM15.9427 17.0711L18.5788 19.7071L19.993 18.2929L17.357 15.6569L15.9427 17.0711ZM10.2859 10L10.2859 10L11.7001 11.4142C12.0609 11.0534 12.2859 10.552 12.2859 10H10.2859Z",fill:"#E77777"})),b=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"16",viewBox:"0 0 21 16",fill:"none"},(0,a.createElement)("path",{d:"M4.00127 14.3639C0.486555 10.8492 0.486555 5.15071 4.00127 1.63599M16.7292 1.63599C20.2439 5.15071 20.2439 10.8492 16.7292 14.3639M6.8297 11.5355C4.87708 9.58286 4.87708 6.41704 6.8297 4.46441M13.9008 4.46441C15.8534 6.41704 15.8534 9.58286 13.9008 11.5355M11.3652 7.99995C11.3652 8.55223 10.9175 8.99995 10.3652 8.99995C9.81295 8.99995 9.36523 8.55223 9.36523 7.99995C9.36523 7.44766 9.81295 6.99995 10.3652 6.99995C10.9175 6.99995 11.3652 7.44766 11.3652 7.99995Z",stroke:"#6D955A","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),f=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M46.6215 21.757C44.6278 22.9074 43.5209 25.0684 43.5415 27.3692C43.5415 27.4128 43.5415 27.4563 43.5415 27.4999C43.5415 27.5434 43.5415 27.5892 43.5415 27.6328C43.5209 29.9336 44.6278 32.0947 46.6215 33.2451L46.6399 33.2565C47.9943 34.038 49.7565 33.2657 50.043 31.728C50.5678 28.9047 50.5426 26.0378 50.0178 23.2717C49.7268 21.7386 47.9713 20.9778 46.6215 21.757V21.757Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M35.2025 41.5616C35.4065 41.4493 35.6081 41.3325 35.8075 41.211C37.7119 40.0514 40.1067 40.0721 42.0386 41.1881C43.3815 41.9627 43.6175 43.8556 42.4442 44.8685C40.3015 46.7202 37.815 48.1846 35.0879 49.1448C33.6213 49.6627 32.0881 48.5123 32.0881 46.9562C32.0881 44.731 33.2523 42.6364 35.2025 41.5616V41.5616Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9122 46.9357C22.9122 48.494 21.3745 49.633 19.9055 49.1196C17.2472 48.1915 14.7493 46.7798 12.5653 44.9098C11.3782 43.8923 11.5891 41.9834 12.9434 41.2019C14.8868 40.079 17.2953 40.0607 19.2157 41.2248C19.4128 41.344 19.6122 41.4609 19.8161 41.5709C21.7549 42.6365 22.9122 44.7219 22.9122 46.9357V46.9357Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M27.5 20.6256L34.3755 27.5011L27.5 34.3766L20.6245 27.5011L27.5 20.6256Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"})),\_=(0,a.createElement)("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.9581 0C13.5192 0 17.2136 3.58 17.2136 8C17.2136 12.42 13.5192 16 8.9581 16C4.39696 16 0.702637 12.42 0.702637 8C0.702637 3.58 4.39696 0 8.9581 0ZM10.6558 9L11.0219 3H7.92606L8.29211 9H10.6558ZM11.0219 11.5115C11.0219 11.9809 10.8811 12.3473 10.6213 12.6107C10.3507 12.874 9.97188 13 9.48478 13C8.99768 13 8.61882 12.874 8.33739 12.6107C8.06677 12.3473 7.92606 11.9809 7.92606 11.5115C7.92606 11.0305 8.05595 10.6641 8.32656 10.4008C8.59717 10.1374 8.97603 10 9.48478 10C9.99353 10 10.3724 10.1374 10.6322 10.4008C10.892 10.6641 11.0219 11.0305 11.0219 11.5115Z",fill:"#AF3535"})),v=(0,a.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M17.25 8.25H21V4.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M3 12C3 7.029 7.029 3 12 3C15.63 3 18.751 5.154 20.174 8.25",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M6.75 15.75H3V19.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M21 12C21 16.971 16.971 21 12 21C8.37 21 5.249 18.846 3.826 15.75",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),E=(0,a.createElement)("svg",{width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M35.8621 13.647L22.0095 27.4996L15.085 20.5733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.5 22C38.5 31.1135 31.1135 38.5 22 38.5C12.8865 38.5 5.5 31.1135 5.5 22C5.5 12.8865 12.8865 5.5 22 5.5C24.6638 5.5 27.1718 6.14717 29.3993 7.26733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"})),y=(0,a.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M13 12L10 9M10 9L7 12M10 9L10 21",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),w=(0,a.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M7 18L10 21M10 21L13 18M10 21V9",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),k=(0,a.createElement)("svg",{width:"20",height:"18",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M10.0015 8V10M10.0015 14H10.0115M3.0733 18H16.9297C18.4693 18 19.4316 16.3333 18.6618 15L11.7336 3C10.9637 1.66667 9.03925 1.66667 8.26945 3L1.34125 15C0.571445 16.3333 1.5337 18 3.0733 18Z",stroke:"#DE9F0C","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),x=window.wp.apiFetch;var C=s.n(x);const S=window.wp.url,A=window.wp.notices,D=window.optimoleDashboardApp.submenu\_links,L=(e=!0)=>{const t=document.querySelector("li#toplevel\_page\_optimole");let s=document.querySelector("li#toplevel\_page\_optimole .wp-submenu");s||(s=document.createElement("ul"),s.classList.add("wp-submenu","wp-submenu-wrap"),t.classList.add("wp-has-submenu","wp-has-current-submenu","wp-menu-open"),t.appendChild(s)),e?(D.forEach((e=>{if(document.querySelector(`li#toplevel\_page\_optimole a[href="${e.href}"]`))return;const t=document.createElement("li"),a=document.createElement("a");a.href=e.href,a.innerHTML=e.text,t.appendChild(a),e.hash&&e.hash===window.location.hash&&(t.classList.add("current"),a.classList.add("current")),s.appendChild(t)})),s.style.display="block"):s.style.display="none"},{setIsConnected:N,setIsConnecting:I,setIsLoading:T,setHasRestError:M,setHasValidKey:O,setHasApplication:F,setAPIKey:j,setUserData:H,setAvailableApps:B,sethasDashboardLoaded:z,setShowDisconnect:R,setConflicts:P,setOptimizedImages:V,setSiteSettings:$,setSampleRate:q,setCheckedOffloadConflicts:Z,setOffloadConflicts:U,setLoadingSync:G,setLoadingRollback:K,setTotalNumberOfImages:Y,setProcessedImages:Q,setErrorMedia:J,setOffloadLibraryLink:W,setRollbackLibraryLink:X,setExtraVisits:ee,setLogs:te,setShowFinishNotice:se,setOffloadLimitReached:ae,ensureOffloadingRollbackDisabled:oe,setOffloadLimit:ne}=(0,c.dispatch)("optimole"),{getOptimizedImages:re,getQueryArgs:ie,getTotalNumberOfImages:le,getSiteSettings:ce}=(0,c.select)("optimole"),{createNotice:de}=(0,c.dispatch)(A.store),pe=(e={})=>{e.offset=void 0!==e.offset?e.offset:0,C()({path:optimoleDashboardApp.routes.upload\_onboard\_images,method:"POST",data:e}).then((t=>{!1===t.data&&1e3>e.offset&&pe({offset:e.offset+100}),"success"===t.code&&console.log("%c Images Crawled.","color: #59B278")})).catch((e=>(console.log("Error while crawling images",e),e.data)))},me=(e,t=(()=>{}))=>{I(!0),T(!0),M(!1),C()({path:optimoleDashboardApp.routes.register\_service,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(I(!1),T(!1),"success"===e.code&&(N(!0),O(!0),F(!0),j(e.data.api\_key),H(e.data),B(e.data),pe(),L(!0)),t&&t(e),e.data))).catch((e=>(I(!1),T(!1),M(!0),e.data)))},ue=()=>{T(!0),C()({path:optimoleDashboardApp.routes.disconnect,method:"GET",parse:!1}).then((e=>{T(!1),F(!1),j(""),H(null),B(null),e.ok?(N(!1),z(!1),R(!1),L(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")):console.error(e)}))},ge=()=>{T(!0),C()({path:optimoleDashboardApp.routes.request\_update,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{T(!1),e&&(H(e.data),void 0!==e?.data?.extra\_visits&&ee(e.data.extra\_visits),"disconnected"===e.code&&(N(!1),z(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")))}))},he=(e=(()=>{}))=>{if(0<re().length)return console.log("%c Images already exist.","color: #59B278"),e&&e(),!1;C()({path:optimoleDashboardApp.routes.poll\_optimized\_images,method:"GET"}).then((t=>{"success"===t.code?(V(t.data),console.log("%c Images Fetched.","color: #59B278")):console.log("%c No images available.","color: #E7602A"),e&&e(t)})).catch((e=>(console.log("Error while polling images",e),e.data)))},be=(e,t=!1,s=!1,a=(()=>{}))=>{T(!0),C()({path:optimoleDashboardApp.routes.update\_option,method:"POST",data:{settings:e}}).then((e=>{T(!1),"success"===e.code&&($(e.data),s||ye(optimoleDashboardApp.strings.options\_strings.settings\_saved),console.log("%c Settings Saved.","color: #59B278"))})).then((()=>{t&&ge()})).then((()=>{a()})).catch((e=>(T(!1),ye(optimoleDashboardApp.strings.options\_strings.settings\_saved\_error),console.log("Error while saving settings",e),e.data)))},fe=e=>{T(!0),C()({path:optimoleDashboardApp.routes.clear\_cache\_request,method:"POST",data:{type:e},parse:!1}).then((e=>(T(!1),200<=e.status&&300>e.status?(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared),void console.log("%c New cache token generated.","color: #59B278")):(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared\_error),void console.log("%c Could not generate cache token.","color: #E7602A")))))},\_e=(e,t=(()=>{}))=>{C()({path:(0,S.addQueryArgs)(optimoleDashboardApp.routes.get\_sample\_rate,{quality:e.quality,force:e?.force||"no"}),method:"POST"}).then((e=>{"success"===e.code&&q(e.data),t&&t(e)}))},ve=(e=(()=>{}))=>{C()({path:optimoleDashboardApp.routes.get\_offload\_conflicts,method:"GET"}).then((t=>{Z(!0),0!==t.data.length&&U(t.data),e&&e(t)}))},Ee=e=>{const t=ie();"offload\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&W(!1),G(!0)),"rollback\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!1),K(!0)),T(!0);const s=void 0!==e.images?e.images:[];C()({path:optimoleDashboardApp.routes.number\_of\_images\_and\_pages,method:"POST",data:{action:e.action,refresh:e.refresh||!1,images:s},parse:!1}).then((t=>{if(200<=t.status&&300>t.status)return t.json();"offload\_images"===e.action&&(G(!1),T(!1)),"rollback\_images"===e.action&&(K(!1),T(!1))})).then((a=>{if(!a.data.count||0===a.data.count||!1===a.data.status)return console.log("%c No images available.","color: #E7602A"),G(!1),K(!1),T(!1),0===a.data.count&&(ae("disabled"),se(a.data.action)),a.data.reached\_limit&&ae(a.data.reached\_limit?"enabled":"disabled"),a.data.offload\_limit&&ne(a.data.offload\_limit),oe(),be(ce(),!1),"offload\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&W(!0),void("rollback\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!0));let o=le();e.refresh?(Q(0!==o?Math.abs(o-a.data.count):0),0!==a.data.count&&0===o&&Y(a.data.count)):Y(a.data.count),setTimeout((()=>{Ee({action:e.action,refresh:!0,images:s})}),1e4)})).finally((()=>{var t;t="offload\_images"===e.action?"offload":"rollback",jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"optml\_fetch\_logs",nonce:optimoleDashboardApp.nonce,type:t},success:e=>{te(t,e)}})})).catch((t=>{J(e.action),G(!1),K(!1)}))},ye=e=>{de("info",e,{isDismissible:!0,type:"snackbar"})},we=({tab:e,setTab:t})=>{const[s,n]=(0,o.useState)(!1),{setShowDisconnect:r}=(0,c.useDispatch)("optimole"),{isConnected:i,isLoading:l,hasApplication:d,hasDashboardLoaded:m,hasConflicts:f}=(0,c.useSelect)((e=>{const{isConnected:t,isLoading:s,hasApplication:a,hasDashboardLoaded:o,getConflicts:n}=e("optimole"),r=n();return{isConnected:t(),isLoading:s(),hasApplication:a(),hasDashboardLoaded:o(),hasConflicts:0<r.count||0}}));(0,o.useEffect)((()=>{f&&n(!0)}),[f]);const \_=[{label:optimoleDashboardApp.strings.dashboard\_menu\_item,value:"dashboard"},{label:optimoleDashboardApp.strings.conflicts\_menu\_item,value:"conflicts",isDisabled:!s},{label:optimoleDashboardApp.strings.settings\_menu\_item,value:"settings"},{label:optimoleDashboardApp.strings.help\_menu\_item,value:"help"}],v=i&&d&&!m;return(0,a.createElement)("header",{className:"bg-white shadow-sm px-2.5 py-5 pb-0"},(0,a.createElement)("div",{className:"flex flex-col sm:flex-row justify-between items-center max-w-screen-xl mx-auto my-0 pb-5"},(0,a.createElement)("div",{className:"items-center flex justify-start cursor-default"},(0,a.createElement)("img",{className:"max-width-64 w-16 h-16 mr-3",src:`${optimoleDashboardApp.assets\_url}/img/logo.png`,alt:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details,title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details}),(0,a.createElement)("h3",{className:"text-gray-800 text-2 font-serif font-bold"},optimoleDashboardApp.strings.optimole)),(0,a.createElement)("div",{className:"flex items-center"},i?(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.DropdownMenu,{icon:l||v?(0,a.createElement)(g.Icon,{icon:u,className:"animate-spin fill-success"}):(0,a.createElement)(g.Icon,{icon:b}),toggleProps:{className:"optml-header\_\_dropdown uppercase font-bold text-xs text-success hover:text-success active:text-success focus:text-success mr-3 border border-gray-300 rounded-md border-solid gap-2",iconPosition:"right"},popoverProps:{className:"optml-header\_\_dropdown\_\_popover"},text:v?optimoleDashboardApp.strings.connecting:optimoleDashboardApp.strings.connected,controls:[{title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.dashboard\_menu\_item,onClick:()=>window.open(optimoleDashboardApp.optimoleDashHome,"\_blank")},{title:optimoleDashboardApp.strings.refresh\_stats\_cta,onClick:ge,isDisabled:v},{title:optimoleDashboardApp.strings.disconnect\_btn,onClick:()=>r(!0),isDisabled:v}]})):(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"uppercase font-bold text-xs text-danger mr-3"},optimoleDashboardApp.strings.not\_connected),(0,a.createElement)(g.Icon,{icon:h})))),i&&d&&m&&(0,a.createElement)("ul",{className:"flex gap-8 items-center max-w-screen-xl mx-auto my-0 justify-center sm:justify-normal"},\_.filter((e=>!e?.isDisabled)).map((({label:s,value:o})=>(0,a.createElement)("li",{key:o,className:p()("cursor-pointer text-purple-gray font-bold text-lg m-0 py-2 px-3 transition-colors duration-200 ease-in-out border-0 border-b-4 border-b-white border-solid",{"text-black !border-b-info":e===o}),onClick:()=>t(o)},s)))))},ke=()=>{const{setShowDisconnect:e}=(0,c.useDispatch)("optimole"),{isLoading:t}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}));return(0,a.createElement)(g.Modal,{title:optimoleDashboardApp.strings.disconnect\_title,className:"optml\_\_modal",onRequestClose:()=>e(!1)},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.disconnect\_desc}}),(0,a.createElement)("div",{className:"flex gap-2"},(0,a.createElement)(g.Button,{variant:"default",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>e(!1)},optimoleDashboardApp.strings.keep\_connected),(0,a.createElement)(g.Button,{isDestructive:!0,className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",isBusy:t,disabled:t,onClick:ue},optimoleDashboardApp.strings.disconnect\_btn)))},xe=({setMethod:e})=>{const[t,s]=(0,o.useState)(""),[n,r]=(0,o.useState)({}),[i,l]=(0,o.useState)(0),{setShowDisconnect:d}=(0,c.useDispatch)("optimole"),{availableApps:p,hasValidKey:m,isConnected:u,isConnecting:h,isLoading:b}=(0,c.useSelect)((e=>{const{getAvailableApps:t,hasValidKey:s,isConnected:a,isConnecting:o,isLoading:n}=e("optimole");return{availableApps:t(),hasValidKey:s(),isConnected:a(),isConnecting:o(),isLoading:n()}}));return(0,a.createElement)("div",{className:"text-2 font-bold m-0 text-gray-700"},(0,a.createElement)("div",{className:"text-gray-800 font-serif leading-7"},optimoleDashboardApp.strings.connect\_btn),(0,a.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.steps\_connect\_api\_desc}}),(0,a.createElement)("div",{className:"flex flex-col gap-8 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,a.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,a.createElement)(g.TextControl,{label:u?optimoleDashboardApp.strings.your\_api\_key:optimoleDashboardApp.strings.add\_api,placeholder:optimoleDashboardApp.strings.email,disabled:u,value:t,onChange:s,className:"optml\_\_input basis-4/5"}),u?(0,a.createElement)(g.Button,{variant:"default",isBusy:b,disabled:b,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:d},optimoleDashboardApp.strings.disconnect\_btn):(0,a.createElement)(g.Button,{variant:"primary",isBusy:h,disabled:h||0===t.length,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{r({}),((e,t=(()=>{}))=>{I(!0),T(!0),M(!1),C()({path:optimoleDashboardApp.routes.connect,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(I(!1),T(!1),"success"===e.code?(N(!0),O(!0),j(e.data.api\_key),void 0!==e.data.app\_count&&1<e.data.app\_count?B(e.data):(F(!0),H(e.data)),pe(),L(!0),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e),e.data))).catch((e=>(I(!1),T(!1),M(!0),e.data)))})({api\_key:t},(e=>{"success"!==e.code&&r({error\_connect:e.data})}))}},optimoleDashboardApp.strings.connect\_btn)),p&&(0,a.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,a.createElement)("div",{className:"basis-4/5"},(0,a.createElement)(g.SelectControl,{label:optimoleDashboardApp.strings.select+" "+optimoleDashboardApp.strings.your\_domain,value:i,options:p.available\_apps.map(((e,t)=>({label:e.domain,value:t}))),onChange:l,className:"optml\_\_select has\_large\_title",\_\_nextHasNoMarginBottom:!0})),(0,a.createElement)(g.Button,{variant:"primary",isBusy:h,disabled:h,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{((e,t=(()=>{}))=>{I(!0),M(!1),C()({path:optimoleDashboardApp.routes.select\_application,method:"POST",data:e}).then((e=>{I(!1),T(!1),"success"===e.code?(O(!0),F(!0),j(e.data.api\_key),H(e.data),B(e.data),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e)})).catch((e=>(I(!1),M(!0),e.data)))})({api\_key:t,application:null!=p&&void 0!==p.available\_apps?p.available\_apps[i].key:""},(e=>{"success"!==e.code&&r({error\_connect:e.data})}))}},optimoleDashboardApp.strings.select))),!m&&void 0!==n.error\_connect&&(0,a.createElement)("p",{className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:n.error\_connect}}),(0,a.createElement)("div",{className:"text-center py-3"},(0,a.createElement)(g.Button,{variant:"link",onClick:()=>e("email")},optimoleDashboardApp.strings.back\_to\_connect)))},Ce="optml-connect flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md",Se="flex gap-8 p-8 flex-col md:flex-row",Ae=()=>(0,a.createElement)("div",{className:"bg-danger text-white rounded relative px-6 py-5 mb-0 m-12",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_api\_not\_working}}),De=()=>{const[e,t]=(0,o.useState)(optimoleDashboardApp.current\_user.email),[s,n]=(0,o.useState)("email"),[r,i]=(0,o.useState)({}),{setAutoConnect:l}=(0,c.useDispatch)("optimole"),{autoConnect:d,hasRestError:p,isConnecting:m}=(0,c.useSelect)((e=>{const{getAutoConnect:t,hasRestError:s,isConnecting:a}=e("optimole");return{autoConnect:t(),hasRestError:s(),isConnecting:a()}}));return(0,o.useEffect)((()=>{"no"!==d&&me({email:d,auto\_connect:!0},(e=>{l("no"),"email\_registered"!==e.code?"site\_exists"!==e.code?"success"!==e.code&&e.message&&i({error\_autoconnect:e.message}):i({site\_exists:e.message}):i({email\_registered:e.message})}))}),[]),(0,o.useEffect)((()=>{(0===e.length||(0,S.isEmail)(e))&&r.invalid\_email&&(delete r.invalid\_email,i(r))}),[e]),"key"===s?(0,a.createElement)("div",{className:Ce},p&&(0,a.createElement)(Ae,null),(0,a.createElement)("div",{className:Se},(0,a.createElement)(xe,{setMethod:n}))):(0,a.createElement)("div",{className:Ce},p&&(0,a.createElement)(Ae,null),(0,a.createElement)("div",{className:Se},(0,a.createElement)("div",{className:"optml-connect\_\_content basis-8/12"},(0,a.createElement)("div",{className:"text-gray-700 font-serif text-2 font-bold leading-7 m-0"},optimoleDashboardApp.strings.account\_needed\_heading),(0,a.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_title}}),(0,a.createElement)("div",{className:"flex py-3"},(0,a.createElement)(g.Icon,{icon:"yes-alt"}),(0,a.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_1}})),(0,a.createElement)("div",{className:"flex py-3"},(0,a.createElement)(g.Icon,{icon:"yes-alt"}),(0,a.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_2}}))),(0,a.createElement)("div",{className:"optml-connect\_\_form basis-4/12 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.email\_address\_label,placeholder:optimoleDashboardApp.strings.email,value:e,onChange:t,className:"optml\_\_input",onBlur:()=>{0===e.length||(0,S.isEmail)(e)||i({invalid\_email:optimoleDashboardApp.strings.invalid\_email})}}),0<Object.keys(r).length&&Object.keys(r).map((e=>(0,a.createElement)("p",{key:e,className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:r[e]}})))||(0,a.createElement)("br",null),(0,a.createElement)(g.Button,{variant:"primary",isBusy:m,disabled:m||0===e.length||!(0,S.isEmail)(e),className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40",onClick:()=>{i({}),me({email:e},(e=>{"email\_registered"!==e.code?"site\_exists"!==e.code?"domain\_not\_accessible"!==e.code?"success"!==e.code&&i({error\_register:optimoleDashboardApp.strings.error\_register}):i({domain\_not\_accessible:e.message}):i({site\_exists:e.message}):i({email\_registered:e.message})}))}},optimoleDashboardApp.strings.register\_btn),(0,a.createElement)("br",null),(0,a.createElement)("br",null),(0,a.createElement)("div",{className:"base-control-label"},optimoleDashboardApp.strings.existing\_user),(0,a.createElement)(g.Button,{variant:"secondary",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>n("key")},optimoleDashboardApp.strings.api\_exists),(0,a.createElement)("p",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.signup\_terms}}))),(0,a.createElement)("div",{className:"bg-grayish-blue text-gray-800 text-center font-bold uppercase p-2.5 rounded-b-lg"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_footer}})))},Le=({value:e,max:t=100,className:s,...o})=>{const n=Math.round(e/t\*100),r=(o.background,p()("w-full h-2.5 border rounded-md border-solid bg-white border-light-gray relative overflow-hidden",s));return(0,a.createElement)("div",{className:r,role:"progressbar","aria-valuemin":"0","aria-valuemax":t,"aria-valuenow":e,...o},(0,a.createElement)("div",{className:"absolute left-0 h-full bg-info",style:{width:`${n}%`}}))},Ne=[optimoleDashboardApp.strings.options\_strings.connect\_step\_0,optimoleDashboardApp.strings.options\_strings.connect\_step\_1,optimoleDashboardApp.strings.options\_strings.connect\_step\_2,optimoleDashboardApp.strings.options\_strings.connect\_step\_3],Ie=()=>{const[e,t]=(0,o.useState)(0),[s,n]=(0,o.useState)(0),[r,i]=(0,o.useState)(0),{sethasDashboardLoaded:l}=(0,c.useDispatch)("optimole");(0,o.useEffect)((()=>{r<=25&&setTimeout((()=>{d()}),1e3)}),[r]);const d=()=>{if(i(r+1),r>=25)return l(!0),i(0),n(0),void t(0);t(Math.floor(r/25\*100)),e>30\*(s+1)&&n(s+1)};return(0,a.createElement)("div",{className:"optml-connecting flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md"},(0,a.createElement)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-5 px-8 sm:px-0 py-24"},(0,a.createElement)("img",{className:"max-w-full",src:optimoleDashboardApp.assets\_url+"img/connecting.png"}),(0,a.createElement)("div",{className:"text-center md:text-left"},(0,a.createElement)("div",{className:"font-bold text-2xl"},optimoleDashboardApp.strings.account\_connecting\_title),(0,a.createElement)("div",{className:"text-base"},optimoleDashboardApp.strings.account\_connecting\_subtitle),(0,a.createElement)(Le,{className:"mt-2.5 mb-1.5 mx-0 h-5 border-gray-200",value:r,max:25,background:"#e6e6e6"}),(0,a.createElement)("div",{className:"text-xs"},Ne[s]+" ("+e+"%)"))))},Te=function(){const[e,t]=(0,a.useState)(null),[s,o]=(0,a.useState)({width:0,height:0}),n=(0,a.useCallback)((()=>{o({width:(null==e?void 0:e.offsetWidth)||0,height:(null==e?void 0:e.offsetHeight)||0})}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]);return Me("resize",n),Oe((()=>{n()}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]),[t,s]},Me=function(e,t,s,o){const n=(0,a.useRef)(t);Oe((()=>{n.current=t}),[t]),(0,a.useEffect)((()=>{var t;const a=null!==(t=null==s?void 0:s.current)&&void 0!==t?t:window;if(!a||!a.addEventListener)return;const r=e=>n.current(e);return a.addEventListener(e,r,o),()=>{a.removeEventListener(e,r,o)}}),[e,s,o])},Oe="undefined"!=typeof window?a.useLayoutEffect:a.useEffect,Fe="yes"!==optimoleDashboardApp.connection\_status,je=({src:e,oldSize:t,newSize:s})=>{const[o,{width:n}]=Te();return(0,a.createElement)("div",{className:"basis-1/4"},(0,a.createElement)("img",{src:e,className:"w-full border border-slate-200 rounded-md border-solid",style:{height:n},ref:o}),(0,a.createElement)("p",{className:"optml\_\_bullet w-full h-4"},(()=>{let e=(100\*(1-s/t)).toFixed(1);return 1>e?"1":100<e?(Math.floor(e/10+10)/10).toFixed(1).toString():e.toString()})(),"% ",optimoleDashboardApp.strings.latest\_images.saved," "))},He=()=>{const[e,{width:t}]=Te();return(0,a.createElement)("div",{className:"basis-1/4"},(0,a.createElement)("div",{className:"optml\_\_loader w-full rounded-md",style:{height:t},ref:e}),(0,a.createElement)("p",{className:"optml\_\_loader w-full h-4"}))},Be=()=>{const[e,t]=(0,o.useState)(!1),[s,n]=(0,o.useState)(0),[r,i]=(0,o.useState)(0),[l,d]=(0,o.useState)(0);(0,o.useEffect)((()=>{l<=20&&setTimeout((()=>{m()}),1e3)}),[l]);const{images:p}=(0,c.useSelect)((e=>{const{getOptimizedImages:t}=e("optimole");return{images:t()||[]}}));(0,o.useEffect)((()=>{8<=p.length?t(!0):e||Fe||he((()=>{t(!0)}))}),[]);const m=()=>{d(l+1),l>=20?he((()=>{t(!0),d(0),i(0),n(0),ge()})):(n(Math.floor(l/20\*100)),s>30\*(r+1)&&i(r+1))};return(0,a.createElement)("div",{className:"hidden lg:block pt-5 border-grayish-blue border-0 border-t-2 border-solid"},(0,a.createElement)("h3",{className:"text-base m-0"},optimoleDashboardApp.strings.latest\_images.last," ",optimoleDashboardApp.strings.latest\_images.optimized\_images),Fe&&!e&&(0,a.createElement)("div",{className:"flex items-center flex-col py-2"},(0,a.createElement)("p",{className:"font-semibold"},optimoleDashboardApp.strings.latest\_images.loading\_latest\_images),(0,a.createElement)(Le,{max:20,value:l})),!Fe&&!e&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,a.createElement)(He,null)))),(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,a.createElement)(He,null))))),e&&4>p?.length&&(0,a.createElement)("div",{className:"text-center py-12"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.latest\_images.no\_images\_found}})),e&&4<=p?.length&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(0,a.createElement)(je,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))),8<=p?.length&&(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(t+=4,(0,a.createElement)(je,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))))))},ze="flex p-6 bg-light-blue border border-blue-300 rounded-md",Re=[{label:optimoleDashboardApp.strings.metrics.metricsTitle1,description:optimoleDashboardApp.strings.metrics.metricsSubtitle1,value:"images\_number",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M42.0235 45.3568L45.0279 46.6928C46.5427 47.3666 48.25 46.2574 48.25 44.5982V10.402C48.25 8.74281 46.5427 7.63364 45.0279 8.30739L42.0235 9.64343C32.8569 13.718 22.3931 13.718 13.2265 9.64343L10.2221 8.30739C8.70729 7.63364 7 8.74281 7 10.402V44.5982C7 46.2574 8.70729 47.3666 10.2221 46.6928L13.2265 45.3568C22.3931 41.2845 32.8569 41.2845 42.0235 45.3568Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M34.5002 35.5209H20.7502C19.4852 35.5209 18.4585 34.4942 18.4585 33.2292V21.7709C18.4585 20.5059 19.4852 19.4792 20.7502 19.4792H34.5002C35.7652 19.4792 36.7918 20.5059 36.7918 21.7709V33.2292C36.7918 34.4942 35.7652 35.5209 34.5002 35.5209Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.9707 25.0939L36.7915 29.8376",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.9711 25.0939L26.0669 30.2043",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M26.0665 30.2043L23.3853 28.4167",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M23.3856 28.4167L18.4585 32.5647",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle2,description:optimoleDashboardApp.strings.metrics.metricsSubtitle2,value:"saved\_size",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"56",height:"55",viewBox:"0 0 56 55",fill:"none"},(0,a.createElement)("path",{d:"M36.681 6.875H13.7643C8.70203 6.875 4.59766 10.9794 4.59766 16.0417C4.59766 21.104 8.70203 25.2083 13.7643 25.2083H36.681C41.7433 25.2083 45.8477 21.104 45.8477 16.0417C45.8477 10.9794 41.7433 6.875 36.681 6.875Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.7643 25.2084C8.70203 25.2084 4.59766 29.3127 4.59766 34.375C4.59766 39.4373 8.70203 43.5417 13.7643 43.5417H29.806",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9307 16.0416H36.6807",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.845 15.9606C13.8898 16.0053 13.8898 16.0779 13.845 16.1226C13.8003 16.1674 13.7277 16.1674 13.683 16.1226C13.6382 16.0779 13.6382 16.0053 13.683 15.9606C13.7277 15.9158 13.8003 15.9158 13.845 15.9606Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9307 34.375H27.7432",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.845 34.2938C13.8898 34.3386 13.8898 34.4111 13.845 34.4559C13.8003 34.5006 13.7277 34.5006 13.683 34.4559C13.6382 34.4111 13.6382 34.3386 13.683 34.2938C13.7277 34.2491 13.8003 34.2491 13.845 34.2938Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.9725 48.125C32.6452 48.125 27.5142 42.994 27.5142 36.6667C27.5142 30.3394 32.6452 25.2084 38.9725 25.2084C45.3021 25.2084 50.4308 30.3394 50.4308 36.6667C50.4308 42.994 45.3021 48.125 38.9725 48.125Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M40.2465 31.5745L36.4263 35.3924L41.5184 37.9407L37.6981 41.7586",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle3,description:optimoleDashboardApp.strings.metrics.metricsSubtitle3,value:"compression\_percentage",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M43.5418 32.0833C41.0095 32.0833 38.9585 30.0323 38.9585 27.5C38.9585 24.9677 41.0095 22.9166 43.5418 22.9166C46.0741 22.9166 48.1252 24.9677 48.1252 27.5C48.1252 30.0323 46.0741 32.0833 43.5418 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0832 43.5417C32.0832 46.074 30.0321 48.1251 27.4998 48.1251C24.9675 48.1251 22.9165 46.074 22.9165 43.5417C22.9165 41.0094 24.9675 38.9584 27.4998 38.9584C30.0321 38.9584 32.0832 41.0094 32.0832 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M43.5418 48.1251C41.0095 48.1251 38.9585 46.074 38.9585 43.5417C38.9585 41.0094 41.0095 38.9584 43.5418 38.9584C46.0741 38.9584 48.1252 41.0094 48.1252 43.5417C48.1252 46.074 46.0741 48.1251 43.5418 48.1251Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M27.4998 16.0417C24.9675 16.0417 22.9165 13.9906 22.9165 11.4583C22.9165 8.92604 24.9675 6.875 27.4998 6.875C30.0321 6.875 32.0832 8.92604 32.0832 11.4583C32.0832 13.9906 30.0321 16.0417 27.4998 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.9585 11.4583C38.9585 8.92604 41.0095 6.875 43.5418 6.875C46.0741 6.875 48.1252 8.92604 48.1252 11.4583C48.1252 13.9906 46.0741 16.0417 43.5418 16.0417C41.0095 16.0417 38.9585 13.9906 38.9585 11.4583Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.7314 40.3104L40.3106 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M14.6895 40.3104L24.2686 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.7314 24.2687L40.3106 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9165 27.5C22.9165 24.9677 24.9675 22.9166 27.4998 22.9166C30.0321 22.9166 32.0832 24.9677 32.0832 27.5C32.0832 30.0323 30.0321 32.0833 27.4998 32.0833C24.9675 32.0833 22.9165 30.0323 22.9165 27.5Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M14.6895 24.2687L24.2686 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M11.4583 32.0833C8.92604 32.0833 6.875 30.0323 6.875 27.5C6.875 24.9677 8.92604 22.9166 11.4583 22.9166C13.9906 22.9166 16.0417 24.9677 16.0417 27.5C16.0417 30.0323 13.9906 32.0833 11.4583 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M16.0417 43.5417C16.0417 46.074 13.9906 48.1251 11.4583 48.1251C8.92604 48.1251 6.875 46.074 6.875 43.5417C6.875 41.0094 8.92604 38.9584 11.4583 38.9584C13.9906 38.9584 16.0417 41.0094 16.0417 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M11.4583 16.0417C8.92604 16.0417 6.875 13.9906 6.875 11.4583C6.875 8.92604 8.92604 6.875 11.4583 6.875C13.9906 6.875 16.0417 8.92604 16.0417 11.4583C16.0417 13.9906 13.9906 16.0417 11.4583 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle4,description:optimoleDashboardApp.strings.metrics.metricsSubtitle4,value:"traffic",icon:()=>(0,a.createElement)("svg",{width:"55",height:"55",viewBox:"0 0 64 64",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false"},(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667M24 32h10.667",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48M42.667 16H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48M42.667 26.667H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48M42.667 37.333H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48M42.667 48H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}))}],Pe=()=>(0,a.createElement)("div",{className:"flex gap-2 bg-warning text-danger border border-solid border-danger rounded relative px-6 py-5 mb-5"},(0,a.createElement)(g.Icon,{icon:\_}),(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_disabled\_account}})),Ve=()=>(0,a.createElement)("div",{className:"flex gap-2 bg-success text-white rounded relative px-6 py-5 mb-5"},(0,a.createElement)(g.Icon,{icon:"cloud-saved"}),(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_just\_activated}})),$e=()=>{const{userData:e,userStatus:t}=(0,c.useSelect)((e=>{const{getUserData:t,getUserStatus:s}=e("optimole");return{userData:t(),userStatus:s()}})),s=(e.visitors/e.visitors\_limit\*100).toFixed(0);return(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},0<optimoleDashboardApp.strings.notice\_just\_activated.length&&"active"===t&&(0,a.createElement)(Ve,null),"inactive"===t&&(0,a.createElement)(Pe,null),(0,a.createElement)("div",{className:p()(ze,"gap-8 flex-col sm:flex-row items-start sm:items-center")},(0,a.createElement)(g.Icon,{icon:f}),(0,a.createElement)("div",{className:"flex w-full flex-col"},(0,a.createElement)("div",{className:"flex w-full justify-between"},(0,a.createElement)("div",{className:"text-gray-800 text-2xl font-bold"},e.visitors\_pretty," / ",e.visitors\_limit\_pretty,(0,a.createElement)("span",{className:"text-gray-600 text-base font-normal ml-2"},optimoleDashboardApp.strings.quota)),70>s&&(0,a.createElement)(g.Button,{variant:"default",className:"optml\_\_button rounded font-bold min-h-40",href:optimoleDashboardApp.optimoleDashBilling,target:"\_blank"},optimoleDashboardApp.strings.upgrade.title)),(0,a.createElement)("div",null,(0,a.createElement)(Le,{className:"mt-2.5 mb-3 mx-0",value:e.visitors,max:e.visitors\_limit}),(0,a.createElement)("div",{className:"optml\_\_tooltip",style:{left:s+"%",marginLeft:15>s?"-15px":"-20px",display:100<s?"none":"block"}},(0,a.createElement)("span",null,s,"%"))))),(0,a.createElement)("div",{className:"flex py-5 gap-5 flex-col md:flex-row"},Re.map((t=>(0,a.createElement)("div",{key:t.value,className:p()(ze,"basis-1/4 flex-col items-start")},(0,a.createElement)(g.Icon,{icon:t.icon}),(0,a.createElement)("div",{className:"flex w-full flex-col"},(0,a.createElement)("div",{className:"not-italic font-bold text-xl py-2 text-gray-800"},(t=>{const s=(t=>void 0!==e[t]?e[t]:"saved\_size"===t?Math.floor(2500\*Math.random())+500:Math.floor(40\*Math.random())+10)(t);return"saved\_size"===t?(s/1e3).toFixed(2)+"MB":"compression\_percentage"===t?s.toFixed(2)+"%":"traffic"===t?s.toFixed(2)+"MB":s})(t.value)),(0,a.createElement)("div",{className:"not-italic font-normal text-sm text-gray-800"},t.label),(0,a.createElement)("div",{className:"font-normal text-xs text-gray-600"},t.description)))))),"yes"!==optimoleDashboardApp.remove\_latest\_images&&(0,a.createElement)(Be,null))},qe=({conflict:e})=>{const[t,s]=(0,o.useState)(!1);return(0,a.createElement)("div",{className:p()("flex gap-2 text-white rounded relative px-6 py-5 mb-5",{"bg-danger":"high"===e.severity,"bg-info":"medium"===e.severity,"bg-success":"high"!==e.severity&&"medium"!==e.severity})},(0,a.createElement)("p",{className:"m-0 text-white",dangerouslySetInnerHTML:{\_\_html:e.message}}),(0,a.createElement)(g.Button,{icon:t?u:"no-alt",label:optimoleDashboardApp.strings.conflicts.conflict\_close,disabled:t,className:p()("text-white hover:text-white",{"animate-spin":t}),onClick:()=>{s(!0),((e,t=(()=>{}))=>{T(!0),C()({path:optimoleDashboardApp.routes.dismiss\_conflict,method:"POST",data:{conflictID:e}}).then((e=>{T(!1),"success"===e.code&&P(e.data),t&&t(e)}))})(e.id,(()=>{s(!1)}))}}))},Ze=()=>{const{conflicts:e}=(0,c.useSelect)((e=>{const{getConflicts:t}=e("optimole");return{conflicts:t().conflicts||[]}}));return(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},Boolean(e.length)&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,optimoleDashboardApp.strings.conflicts.title),e.map((e=>(0,a.createElement)(qe,{key:e.id,conflict:e})))),!Boolean(e.length)&&(0,a.createElement)("div",{className:"text-center py-12"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.conflicts.no\_conflicts\_found}})))},Ue=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),Ge=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),{strings:Ke}=optimoleDashboardApp,Ye=[{label:Ke.general\_settings\_menu\_item,value:"general"},{label:Ke.advanced\_settings\_menu\_item,value:"compression",children:[{label:Ke.settings\_compression\_menu\_item,value:"compression"},{label:Ke.settings\_resize\_menu\_item,value:"resize"},{label:Ke.lazyload\_settings\_menu\_item,value:"lazyload"},{label:Ke.settings\_exclusions\_menu\_item,value:"exclusions"}]},{label:Ke.cloud\_library,value:"cloud\_library"},{label:Ke.image\_storage,value:"offload\_media"}],Qe=({children:e,tab:t,settings:s,setTab:o})=>(0,a.createElement)("ul",{className:"flex flex-col gap-1 m-0 mt-1"},e.map((e=>{const{value:n,label:r}=e;if("lazyload"===e.value&&"disabled"===s.lazyload)return;const i=p()({"bg-light-blue hover:text-purple-gray":t===n,"bg-transparent hover:text-info":t!==n},"w-full text-left border-0 font-normal text-base text-purple-gray cursor-pointer rounded px-4 py-2 m-0 hover:text-info");return(0,a.createElement)("li",{key:n},(0,a.createElement)("button",{className:i,onClick:()=>o(n)},r))}))),Je=({tab:e,settings:t,setTab:s})=>(0,a.createElement)("div",{className:"basis-1/5"},(0,a.createElement)("ul",{className:"grid m-0 gap-1"},Ye.map((o=>{const n=e===o.value||o.children&&o.children.some((t=>t.value===e)),r=p()({"!text-info":n},"w-full bg-transparent border-0 flex items-center appearance-none not-italic font-semibold text-base text-purple-gray cursor-pointer hover:text-info py-2");return(0,a.createElement)("li",{key:o.value,className:"m-0"},(0,a.createElement)("button",{className:r,onClick:()=>s(o.value)},o.label,o.children&&(0,a.createElement)(g.Icon,{icon:n?Ue:Ge,className:"inline-block ml-2 fill-current"})),o.children&&n&&(0,a.createElement)(Qe,{children:o.children,tab:e,settings:t,setTab:s}))})))),We=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,a.createElement)(m.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),Xe=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),et=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),tt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),st=(0,o.forwardRef)((function({icon:e,size:t=24,...s},a){return(0,o.cloneElement)(e,{width:t,height:t,...s,ref:a})})),at=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}));function ot({text:e,title:t,disableIcon:s=!1,type:o="info",className:n="",smallTitle:r=!1,children:i,onDismiss:l}){const c=p()({"bg-yellow-50 text-yellow-700":"warning"===o,"bg-green-50 text-green-700":"success"===o,"bg-red-50 text-red-700":"error"===o,"bg-blue-50 text-blue-700":"info"===o,"bg-info text-white":"primary"===o},`rounded-md my-5 text-sm p-4 om-notice om-notice-${o} relative`),d=p()({"fill-yellow-500":"warning"===o,"fill-green-500":"success"===o,"fill-red-500":"error"===o,"fill-blue-500":"info"===o,"fill-white":"primary"===o,"h-6 w-6":"primary"!==o,"h-12 w-12":"primary"===o}),m=p()({"ml-3 mt-0.5":!s&&!t,"mt-2 mx-1.5":t}),u=p()({"text-yellow-800":"warning"===o,"text-green-800":"success"===o,"text-red-800":"error"===o,"text-blue-800":"info"===o,"font-bold text-base":"primary"!==o,"text-white text-sm":"primary"===o,"text-s":r},"m-0"),g={warning:We,success:Xe,error:et,info:tt,primary:E};return(0,a.createElement)("div",{className:c},l&&(0,a.createElement)("button",{className:"flex items-center justify-center absolute bg-transparent text-current right-1 top-1 border-0 rounded-full p-0 cursor-pointer hover:bg-white transition-all hover:text-info",onClick:l},(0,a.createElement)(st,{className:"fill-current",icon:at})),(0,a.createElement)("div",{className:t?"grid":"flex"},(0,a.createElement)("div",{className:p()("flex-shrink-0 flex gap-2",{"items-center":t})},!s&&(0,a.createElement)(st,{icon:g[o]||null,className:d}),t&&(0,a.createElement)("div",{className:u,dangerouslySetInnerHTML:{\_\_html:t}})),i||e&&(0,a.createElement)("div",{className:m},e&&(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:e}}),i)))}const nt=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:o}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),n="disabled"!==e.image\_replacer,r="disabled"!==e.lazyload,i="disabled"!==e.report\_script,l="disabled"!==e.cdn,d="disabled"!==e.banner\_frontend,m=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_image\_replace,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.replacer\_desc}}),checked:n,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("image\_replacer",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_lazyload,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.lazyload\_desc}}),checked:r,disabled:!n||o,className:p()({"is-disabled":!n||o}),onChange:e=>m("lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_report\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_report\_desc}}),checked:i,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("report\_script",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_badge\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_badge\_description}}),checked:d,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("banner\_frontend",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.cache\_title,className:p()({"is-disabled":o||!n})},(0,a.createElement)("p",{className:"components-base-control\_\_help m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cache\_desc}}),(0,a.createElement)("div",{className:"flex my-4 gap-3"},(0,a.createElement)(g.Button,{variant:"default",isBusy:o,disabled:o||!n,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>fe()},optimoleDashboardApp.strings.options\_strings.clear\_cache\_images),l&&(0,a.createElement)(g.Button,{variant:"default",isBusy:o,disabled:o||!n,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>fe("assets")},optimoleDashboardApp.strings.options\_strings.clear\_cache\_assets))),(0,a.createElement)(ot,{type:"warning",text:optimoleDashboardApp.strings.options\_strings.clear\_cache\_notice,disableIcon:!0}))};var rt=s(864),it=s.n(rt);const lt=({settings:e,setSettings:t,setCanSave:s,showSample:o,isSampleLoading:n,setIsSampleLoading:r})=>{const{sampleImages:i,isLoading:l}=(0,c.useSelect)((e=>{const{getSampleRate:t,isLoading:s}=e("optimole");return{sampleImages:t(),isLoading:s()}})),d="disabled"!==e.network\_optimization,m="disabled"!==e.cdn,h="disabled"!==e.img\_to\_video,b="disabled"!==e.avif,f="disabled"!==e.strip\_metadata,\_="disabled"!==e.autoquality,v="disabled"!==e.best\_format,E=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},y=()=>i.optimized\_size>i.original\_size?Math.floor(60\*Math.random())+10:(100\*parseFloat(i.optimized\_size/i.original\_size)).toFixed(0);return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.best\_format\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.best\_format\_desc}}),checked:v,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("best\_format",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_desc}}),checked:d,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("network\_optimization",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_cdn,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cdn\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("cdn",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_gif\_replace\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.gif\_replacer\_desc}}),checked:h,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("img\_to\_video",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_avif\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_avif\_desc}}),checked:b,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("avif",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.strip\_meta\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.strip\_meta\_desc}}),checked:f,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("strip\_metadata",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{help:!\_&&optimoleDashboardApp.strings.options\_strings.quality\_desc},(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.quality\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.ml\_quality\_desc}}),checked:\_,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("autoquality",e)})),!\_&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.RangeControl,{value:(w=e.quality,"number"==typeof w?w:"auto"===w||"high\_c"===w?90:"medium\_c"===w?75:"low\_c"===w?55:90),min:50,max:100,step:1,withInputField:!1,marks:[{value:55,label:optimoleDashboardApp.strings.options\_strings.low\_q\_title},{value:75,label:optimoleDashboardApp.strings.options\_strings.medium\_q\_title},{value:90,label:optimoleDashboardApp.strings.options\_strings.high\_q\_title}],onChange:a=>{s(!0);const o={...e};o.quality=a,t(o)}}),o&&(0,a.createElement)("div",{className:"flex justify-center w-full text-center"},n?(0,a.createElement)("div",{className:"flex items-center gap-5"},(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.sample\_image\_loading),(0,a.createElement)(g.Icon,{icon:u,className:"animate-spin"})):(0,a.createElement)(a.Fragment,null,i.id&&0<i.original\_size&&(0,a.createElement)("div",null,0<y()?(0,a.createElement)("p",{className:"text-base"},100-y(),"% ",optimoleDashboardApp.strings.latest\_images.smaller):(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.latest\_images.same\_size),(0,a.createElement)(Le,{max:100,value:100-y()}),(0,a.createElement)("hr",{className:"my-4 border-grayish-blue"}),(0,a.createElement)(it(),{leftImageLabel:optimoleDashboardApp.strings.options\_strings.image\_1\_label,rightImageLabel:optimoleDashboardApp.strings.options\_strings.image\_2\_label,leftImage:i.original,rightImage:i.optimized}),(0,a.createElement)(g.Button,{variant:"default",icon:u,className:"mt-2",onClick:()=>{r(!0),\_e({quality:e.quality,force:"yes"},(()=>r(!1)))}}),(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.quality\_slider\_desc)),!(i.id&&0<i.original\_size)&&0>i.id&&(0,a.createElement)("div",{className:"flex items-center gap-5 text-center"},(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.no\_images\_found))))));var w},ct=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:n}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[r,i]=(0,o.useState)(""),[l,d]=(0,o.useState)(""),m="disabled"!==e.resize\_smart,u="disabled"!==e.retina\_images,h="disabled"!==e.limit\_dimensions,b=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},f=(a,o)=>{s(!0);const n={...e};n[a]=o,t(n)},\_=Object.keys(e.defined\_image\_sizes).filter((t=>"object"==typeof e.defined\_image\_sizes[t]));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_desc}}),checked:m,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("resize\_smart",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),"disabled"!==e.lazyload&&(0,a.createElement)(a.Fragment,null," ",(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_retina\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_retina\_desc}}),checked:u,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("retina\_images",e)})," ",(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"})," "),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_desc}}),checked:h,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("limit\_dimensions",e)}),h&&(0,a.createElement)(g.BaseControl,null,(0,a.createElement)("div",{className:"flex gap-8"},(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,labelPosition:"side",value:e.limit\_width,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>f("limit\_width",e)}),(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,labelPosition:"side",value:e.limit\_height,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>f("limit\_height",e)})),(0,a.createElement)(ot,{disableIcon:!0,type:"warning",text:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_notice})),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.add\_image\_size\_desc},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.image\_size\_notice}}),(0,a.createElement)("div",{className:"flex flex-col sm:flex-row p-6 bg-light-blue border border-blue-300 rounded-md items-stretch sm:items-center gap-8"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,placeholder:optimoleDashboardApp.strings.options\_strings.width\_field,hideLabelFromVision:!0,type:"number",min:1,value:r,onChange:i,className:"optml\_\_input sm:basis-2/5"}),(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,placeholder:optimoleDashboardApp.strings.options\_strings.height\_field,value:l,onChange:d,hideLabelFromVision:!0,type:"number",min:1,className:"optml\_\_input sm:basis-2/5"}),(0,a.createElement)(g.Button,{variant:"primary",isBusy:n,disabled:n,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(!r||!l||isNaN(r)||isNaN(l))return;const a="optimole\_"+r+"\_"+l+"\_crop",o={...e.defined\_image\_sizes,[a]:{width:r,height:l}};s(!0);const n={...e};n.defined\_image\_sizes=o,t(n),i(""),d("")}},optimoleDashboardApp.strings.options\_strings.add\_image\_size\_button))),0<\_.length&&(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.image\_sizes\_title,className:"pt-4"},\_.map((o=>(0,a.createElement)("div",{key:o,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex flex-wrap items-center gap-2"},(0,a.createElement)("div",null,(0,a.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.name}})," ",o),(0,a.createElement)("p",{className:"m-0"},(0,a.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.width\_field),": ",e.defined\_image\_sizes[o].width),(0,a.createElement)("p",{className:"m-0"},(0,a.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.height\_field),": ",e.defined\_image\_sizes[o].height)),(0,a.createElement)(g.Button,{variant:"default",icon:"trash",disabled:n,onClick:()=>(a=>{const o={...e.defined\_image\_sizes,[a]:"remove"};s(!0);const n={...e};n.defined\_image\_sizes=o,t(n)})(o)}))))))},dt=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:n}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),r="disabled"!==e.lazyload\_placeholder,i="disabled"!==e.native\_lazyload,l="disabled"===e.scale,d="disabled"!==e.bg\_replacer,m="disabled"!==e.video\_lazyload,u="disabled"!==e.no\_script,h=e.placeholder\_color,[b,f]=(0,o.useState)(!1),\_=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},v=(a,o)=>{s(!0);const n={...e};n[a]=o,t(n)},E=e=>{v("placeholder\_color",e)};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.BaseControl,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_desc}}),checked:r,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("lazyload\_placeholder",e)}),r&&(0,a.createElement)("div",{className:"relative inline-block"},(0,a.createElement)(g.Button,{disabled:n,className:"gap-3 mt-2 py-3 h-auto rounded text-inherit border-gray-400 border-2 border-solid font-medium",onClick:()=>{f(!b)}},(0,a.createElement)(g.ColorIndicator,{colorValue:h}),(0,a.createElement)("span",null,optimoleDashboardApp.strings.options\_strings.lazyload\_placeholder\_color)),b&&(0,a.createElement)(g.Popover,{placement:"bottom",position:"middle center",variant:"unstyled",className:"shadow-md border-grayish-blue border border-solid rounded bg-white p-2",onFocusOutside:()=>f(!1)},(0,a.createElement)(g.ColorPicker,{color:h,onChange:E,enableAlpha:!0,defaultValue:""}),(0,a.createElement)(g.Button,{isDestructive:!0,className:"w-full text-center flex justify-center",variant:"secondary",onClick:()=>{E("")}},optimoleDashboardApp.strings.options\_strings.clear)))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_title},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_desc}}),(0,a.createElement)("div",{className:"flex gap-8"},(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first,labelPosition:"side",value:e.skip\_lazyload\_images,type:"number",min:0,className:"basis-1/2 md:basis-1/3",onChange:e=>v("skip\_lazyload\_images",e)}))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_native,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.native\_desc}}),checked:i,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("native\_lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_scale,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.scale\_desc}}),checked:l,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("scale",!e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_desc}}),checked:m,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("video\_lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_desc}}),checked:u,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("no\_script",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_desc}}),checked:d,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("bg\_replacer",e)}),d&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.watch\_title\_lazyload,id:"optml-css-watchers"},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.watch\_desc\_lazyload}}),(0,a.createElement)(g.TextareaControl,{id:"optml-css-watchers",placeholder:optimoleDashboardApp.strings.options\_strings.watch\_placeholder\_lazyload,value:e.watchers,onChange:e=>v("watchers",e)}))))},pt="extension",mt="page\_url",ut="page\_url\_match",gt="filename",ht="class",bt=[{label:optimoleDashboardApp.strings.options\_strings.filter\_filename,value:gt},{label:optimoleDashboardApp.strings.options\_strings.filter\_ext,value:pt},{label:optimoleDashboardApp.strings.options\_strings.filter\_url,value:mt},{label:optimoleDashboardApp.strings.options\_strings.filter\_class,value:ht}],ft=[{label:optimoleDashboardApp.strings.options\_strings.exclude\_filename\_desc,value:gt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_ext\_desc,value:pt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_desc,value:mt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_match\_desc,value:ut},{label:optimoleDashboardApp.strings.options\_strings.exclude\_class\_desc,value:ht}],\_t=[{label:".SVG",value:"svg"},{label:".JPG",value:"jpg"},{label:".PNG",value:"png"},{label:".GIF",value:"gif"},{label:".WEBP",value:"webp"}],vt=({label:e,help:t,type:s,settings:n,setSettings:r,setCanSave:i})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[d,p]=(0,o.useState)(gt),[m,u]=(0,o.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[h,b]=(0,o.useState)(""),[f,\_]=(0,o.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[v,E]=(0,o.useState)(!1),y=0<Object.keys(n.filters[s][pt]).length&&Object.values(n.filters[s][pt]).some((e=>!1!==e))||0<Object.keys(n.filters[s][ht]).length&&Object.values(n.filters[s][ht]).some((e=>!1!==e))||0<Object.keys(n.filters[s][mt]).length&&Object.values(n.filters[s][mt]).some((e=>!1!==e))||0<Object.keys(n.filters[s][ut]).length&&Object.values(n.filters[s][ut]).some((e=>!1!==e))||0<Object.keys(n.filters[s][gt]).length&&Object.values(n.filters[s][gt]).some((e=>!1!==e));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.BaseControl,{label:e,help:d===mt&&optimoleDashboardApp.strings.options\_strings.filter\_helper},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:t}}),(0,a.createElement)("div",{className:"flex flex-col md:flex-row p-6 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex justify-start items-center gap-4"},(0,a.createElement)(g.SelectControl,{value:d,options:bt,onChange:e=>{let t="";e===pt&&(t="svg",u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_is)),e===gt&&u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),e===ht&&u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),E(!1),b(t),p(e)},className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}),d===mt?(0,a.createElement)(g.SelectControl,{value:f,options:[{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains},{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches}],onChange:\_,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,a.createElement)("p",{className:"m-0"},m),d===pt?(0,a.createElement)(g.SelectControl,{value:h,options:\_t,onChange:b,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,a.createElement)(g.TextControl,{value:h,placeholder:"matches"===f?"path":"word",onChange:e=>{b(e),E(!1)},className:"optml\_\_input"})),(0,a.createElement)(g.Button,{variant:"primary",isBusy:l,disabled:l,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(3>h.length)return void E(!0);const e={...n.filters};let t=d;d===mt&&"matches"===f&&(t=ut),e[s]&&"object"==typeof e[s]||(e[s]={}),e[s][t]&&!Array.isArray(e[s][t])||(e[s][t]={}),e[s][t][h]=!0,r({...n,filters:e}),d!==pt&&b(""),i(!0)}},optimoleDashboardApp.strings.options\_strings.add\_filter)),v&&(0,a.createElement)("p",{className:"text-red-500 bg-red-100 p-2 rounded-md border border-solid border-red-200"},optimoleDashboardApp.strings.options\_strings.filter\_length\_error)),y&&(0,a.createElement)(g.BaseControl,{label:"optimize"===s?optimoleDashboardApp.strings.options\_strings.active\_optimize\_exclusions:optimoleDashboardApp.strings.options\_strings.active\_lazyload\_exclusions,className:"py-4"},ft.map((e=>Object.keys(n.filters[s][e.value]).filter((t=>!1!==n.filters[s][e.value][t])).map((t=>(0,a.createElement)("div",{key:t,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex items-center gap-1"},(0,a.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:e.label}}),(0,a.createElement)("b",null,t)),(0,a.createElement)(g.Button,{variant:"default",icon:"trash",disabled:l,onClick:()=>((e,t)=>{const a={...n.filters};a[s][e][t]=!1,r({...n,filters:a}),i(!0)})(e.value,t)}))))))))},Et=({settings:e,setSettings:t,setCanSave:s})=>{const o="disabled"!==e.lazyload;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(vt,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_optimize,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_optimize,type:"optimize",settings:e,setSettings:t,setCanSave:s}),o&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(vt,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_lazyload,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_lazyload,type:"lazyload",settings:e,setSettings:t,setCanSave:s})))};function yt({options:e,value:t,onChange:s,label:o,disabled:n=!1,className:r}){return p()({"opacity-50":n},"transition-all my-6 gap-6 grid opacity-100"),(0,a.createElement)("fieldset",{className:`my-6 gap-6 grid ${r}`,onChange:e=>{s(e.target.value)}},o&&(0,a.createElement)("legend",{className:"uppercase font-semibold text-s text-light-black mb-6"},o),e.map(((e,s)=>{const{title:o,value:r,description:i}=e,l=t===r,c=p()({"outline-info":l,"outline-transparent":!l},"flex gap-6 items-start bg-gray-50 rounded-md p-4 outline -outline-offset-3 outline-3 transition-all");return(0,a.createElement)("label",{htmlFor:r,key:r,className:c},(0,a.createElement)(wt,{isActive:l}),(0,a.createElement)("div",{className:"grid space-y-2"},o&&(0,a.createElement)("div",{className:"text-base font-medium text-gray-700"},o),i&&(0,a.createElement)("div",{className:"text-sm text-gray-500"},i)),(0,a.createElement)("input",{type:"radio",name:"label",value:r,id:r,className:"!opacity-0 !w-0 !h-0 !overflow-hidden !absolute !pointer-events-none",disabled:n}))})))}const wt=({isActive:e})=>{const t=p()({"bg-white outline-info":e,"bg-gray-200 outline-transparent":!e},"w-[24px] h-[24px] rounded-full flex items-center justify-center flex-shrink-0 outline outline-3 -outline-offset-3 transition-all"),s=p()({"bg-info":e},"w-[12px] h-[12px] rounded-full background-info transition-all");return(0,a.createElement)("div",{className:t},e&&(0,a.createElement)("div",{className:s}))};function kt({title:e,progress:t,description:s,onCancel:o,hideCancel:n=!1}){const{strings:r}=optimoleDashboardApp;return(0,a.createElement)("div",{className:"bg-gray-50 rounded-md p-4 space-y-4"},(0,a.createElement)("div",{className:"flex gap-3 items-center"},(0,a.createElement)(st,{icon:v,className:"text-info animate-spin -scale-y-100"}),e&&(0,a.createElement)("p",{className:"uppercase text-s font-semibold text-light-black m-0"},e),!n&&(0,a.createElement)("button",{onClick:o,className:"appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-s hover:border-red-500 hover:bg-red-500 hover:text-white cursor-pointer"},r.cancel)),(0,a.createElement)(Le,{value:t}),s&&(0,a.createElement)("p",{className:"text-xs text-gray-500"},s))}const xt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),Ct=window.wp.compose;function St({icon:e,labels:t={},onRequestClose:s=(()=>{}),onConfirm:o=(()=>{}),variant:n="default"}){const r=(0,Ct.useViewportMatch)("small","<"),i=p()({"bg-stale-yellow":"warning"===n,"bg-light-blue":"default"===n},"p-3 rounded-full"),l=p()({"bg-mango-yellow":"warning"===n},"optml\_\_button flex justify-center px-5 py-3 rounded font-bold min-h-40 basis-1/5");return(0,a.createElement)(g.Modal,{\_\_experimentalHideHeader:!0,className:"max-w-xl antialiased",onRequestClose:s,isFullScreen:r},(0,a.createElement)(g.Button,{icon:xt,onClick:s,label:optimoleDashboardApp.strings.csat.close,className:"fixed right-3 top-3 cursor-pointer"}),(0,a.createElement)("div",{className:"flex flex-col items-center"},(0,a.createElement)(g.Icon,{icon:e,size:24,className:i}),(0,a.createElement)("h2",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:t.title}}),(0,a.createElement)("p",{className:"text-center mx-0 my-4 text-gray-700",dangerouslySetInnerHTML:{\_\_html:t.description}}),(0,a.createElement)(g.Button,{variant:"primary",className:l,onClick:o},t.action)))}const At=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12.5 5L10 19h1.9l2.5-14z"})),Dt=({type:e})=>{const{logs:t}=(0,c.useSelect)((e=>{const{getLogs:t}=e("optimole");return{logs:t()}})),[s,n]=(0,o.useState)(!1),r=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const s=setInterval((()=>{r.current&&(r.current.innerHTML=t[e],r.current.scrollTop=r.current.scrollHeight)}),15e3);return()=>clearInterval(s)}),[]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"w-full flex justify-end text-info my-2"},(0,a.createElement)(g.Button,{variant:"tertiary",className:"py-2 px-0",target:"\_blank",href:`${window.ajaxurl}?action=optml\_fetch\_logs&nonce=${optimoleDashboardApp.nonce}&type=${e}`},optimoleDashboardApp.strings.options\_strings.view\_logs),(0,a.createElement)(g.Icon,{icon:At,className:"fill-info py-2"}),(0,a.createElement)(g.Button,{variant:"tertiary",className:"py-2 px-0",onClick:()=>n(!s)},s?optimoleDashboardApp.strings.options\_strings.hide\_logs:optimoleDashboardApp.strings.options\_strings.show\_logs)),s&&(0,a.createElement)("div",{className:"flex flex-col p-6 bg-light-blue border border-blue-300 rounded-md min-h-[200px] max-h-[200px] overflow-y-scroll",ref:r,dangerouslySetInnerHTML:{\_\_html:t[e]}}))},Lt=({settings:e,canSave:t,setSettings:s,setCanSave:n})=>{const{strings:r,cron\_disabled:i}=optimoleDashboardApp,{conflicts:l,options\_strings:d}=r,m="offload",u="rollback",g="stopOffload",h="stopRollback",{offloadConflicts:b,errorMedia:f,offloadLibraryLink:\_,isLoading:E,loadingSync:x,loadingRollback:C,rollbackLibraryLink:S,queryArgs:A,totalNumberOfImages:D,processedImages:L,offloadFinishNotice:N,offloadLimitReached:I,offloadLimit:T}=(0,c.useSelect)((e=>{const{getOffloadConflicts:t,getErrorMedia:s,getLoadingSync:a,getLoadingRollback:o,getOffloadLibraryLink:n,getRollbackLibraryLink:r,getTotalNumberOfImages:i,getProcessedImages:l,getQueryArgs:c,isLoading:d,getSiteSettings:p,getOffloadLimit:m}=e("optimole");return{offloadConflicts:t(),errorMedia:s(),offloadLibraryLink:n(),isLoading:d(),loadingSync:a(),loadingRollback:o(),rollbackLibraryLink:r(),queryArgs:c(),totalNumberOfImages:i(),processedImages:l(),offloadFinishNotice:p("show\_offload\_finish\_notice"),offloadLimitReached:"enabled"===p("offload\_limit\_reached"),offloadLimit:m()}}),[]),{setErrorMedia:M,setCheckedOffloadConflicts:O,setOffloadConflicts:F,setProcessedImages:j,setOffloadLimitReached:H}=(0,c.useDispatch)("optimole"),[B,z]=(0,o.useState)(null),R="disabled"!==e.offloading\_status,P="disabled"!==e.rollback\_status;(0,o.useEffect)((()=>{A?.optimole\_action&&A?.images&&("offload\_images"===A.optimole\_action&&V(A.images),"rollback\_images"===A.optimole\_action&&$(A.images))}),[]),(0,o.useEffect)((()=>{R&&Ee({action:"offload\_images",refresh:!0}),P&&Ee({action:"rollback\_images",refresh:!0})}),[]);const V=(t=[])=>{const a={...e};a.show\_offload\_finish\_notice="",a.offloading\_status="enabled",s(a),be(a,!1,!0,(()=>{M(!1),j(0),H(!1),Ee({action:"offload\_images",images:t}),n(!1)}))},$=(t=[])=>{O(!1),F([]),ve((s=>{if(0===s.data.length){const s={...e};s.show\_offload\_finish\_notice="",s.rollback\_status="enabled",be(s,!1,!0,(()=>{M(!1),j(0),Ee({action:"rollback\_images",images:t}),n(!1)}))}}))},q=[{title:d.offload\_radio\_option\_rollback\_title,description:d.offload\_radio\_option\_rollback\_desc,value:"rollback"},{title:d.offload\_radio\_option\_offload\_title,description:d.offload\_radio\_option\_offload\_desc,value:"offload"}],Z="enabled"===e.offload\_media?"offload":"rollback",U=x||C;return(0,a.createElement)("div",null,(0,a.createElement)("h1",{className:"text-xl font-bold"},d.enable\_offload\_media\_title),(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:d.enable\_offload\_media\_desc}}),N&&(0,a.createElement)(ot,{title:"offload"===N?d.offloading\_success:d.rollback\_success,type:"primary",onDismiss:()=>{be({show\_offload\_finish\_notice:""},!1,!0)}}),i&&(0,a.createElement)(ot,{type:"error",text:r.cron\_error}),!U&&(0,a.createElement)(yt,{className:p()({"opacity-50 pointer-events-none":E||i}),label:d.offloading\_radio\_legend,options:q,value:Z,onChange:t=>{const a="offload"===t,o={...e};o.offload\_media=a?"enabled":"disabled",s(o),n(!0),z(a?m:u)}}),U&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(kt,{title:x?d.sync\_media\_progress:d.rollback\_media\_progress,progress:Math.round(L/D\*100),onCancel:()=>{x&&z(g),C&&z(h)},description:0===D?d.calculating\_estimated\_time:d.images\_processing}),(0,a.createElement)(Dt,{type:x?"offload":"rollback"})),"offload\_images"===f&&(0,a.createElement)(ot,{type:"error",smallTitle:!0,title:d.sync\_media\_error,text:d.sync\_media\_error\_desc}),"rollback\_images"===f&&(0,a.createElement)(ot,{type:"error",smallTitle:!0,title:d.rollback\_media\_error,text:d.rollback\_media\_error\_desc}),0<b.length&&(0,a.createElement)(ot,{type:"warning",title:d.offload\_conflicts\_part\_1},(0,a.createElement)("div",{className:"list-disc grid gap-3 mt-2"},(0,a.createElement)("ul",{className:"grid gap-1"},b.map((e=>(0,a.createElement)("li",{key:e,className:"font-semibold text-base m-0"},e)))),(0,a.createElement)("p",{className:"m-0 text-sm"},d.offload\_conflicts\_part\_2),(0,a.createElement)("button",{disabled:E,className:p()({"opacity-50 pointer-events-none":E},"justify-self-start font-semibold flex items-center appearance-none border border-info text-info bg-white rounded px-4 py-2 text-sm hover:text-white hover:bg-info cursor-pointer"),onClick:()=>F([])},l.conflict\_close))),!U&&(0,a.createElement)("button",{onClick:e=>{e.preventDefault(),"offload"===Z&&z(m),"rollback"===Z&&z(u)},disabled:E||i,className:p()({"opacity-50 pointer-events-none":E||i},"font-semibold flex items-center gap-2 appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-sm hover:text-white hover:bg-info cursor-pointer")},(0,a.createElement)(st,{icon:v,className:"w-4 h-4"}),(0,a.createElement)("span",null,d.sync\_media)),!U&&I&&(0,a.createElement)(ot,{type:"warning",text:d.offload\_limit\_reached.replace("#offload\_limit#",T)}),B&&(0,a.createElement)(St,{...(G=B,{onRequestClose:()=>z(null),...{[m]:{icon:y,onConfirm:()=>{V(),z(null)},labels:{title:d.offloading\_start\_title,description:d.offloading\_start\_description,action:d.offloading\_start\_action}},[u]:{icon:w,onConfirm:()=>{$(),z(null)},labels:{title:d.rollback\_start\_title,description:d.rollback\_start\_description,action:d.rollback\_start\_action}},[g]:{variant:"warning",icon:k,onConfirm:()=>{z(null);const t=e;t.offloading\_status="disabled",be(t)},labels:{title:d.offloading\_stop\_title,description:d.offloading\_stop\_description,action:d.offloading\_stop\_action}},[h]:{variant:"warning",icon:k,onConfirm:()=>{z(null);const t=e;t.rollback\_status="disabled",be(t)},labels:{title:d.rollback\_stop\_title,description:d.rollback\_stop\_description,action:d.rollback\_stop\_action}}}[G]})}),\_&&(0,a.createElement)("p",{className:"m-0"},d.sync\_media\_link," ",(0,a.createElement)("a",{href:A.url},d.here)),S&&(0,a.createElement)("p",{className:"m-0"},d.rollback\_media\_link," ",(0,a.createElement)("a",{href:A.url},optimoleDashboardApp.strings.options\_strings.here)));var G};function Nt(e){const{user\_data:t,strings:s}=optimoleDashboardApp,{options\_strings:o}=s,{settings:n,setSettings:r,setCanSave:i}=e,l=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}),[]),{isLoading:d}=l,m="disabled"!==n.cloud\_images,u=t.whitelist||[];return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:o.enable\_cloud\_images\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:o.enable\_cloud\_images\_desc}}),checked:m,disabled:d,className:p()({"is-disabled":d}),onChange:e=>((e,t)=>{i(!0);const s={...n};s.cloud\_images=t?"enabled":"disabled",r(s)})(0,e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),m&&(0,a.createElement)(g.BaseControl,{label:o.cloud\_site\_title,help:o.cloud\_site\_desc},(0,a.createElement)("div",{className:"optml\_\_token\_\_base flex p-6 bg-light-blue border border-blue-300 rounded-md items-center gap-8"},(0,a.createElement)(g.FormTokenField,{value:Object.keys(n.cloud\_sites).filter((e=>"all"!==e&&"false"!==n.cloud\_sites[e])).map((e=>e))||[],suggestions:u,onChange:e=>{i(!0);const t={},s={...n};0===e.length?t.all="true":e.forEach((e=>{t[e]="true"})),Object.keys(s.cloud\_sites).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)||(t[e]="false")})),s.cloud\_sites=t,r(s)},\_\_experimentalExpandOnFocus:!0,\_\_experimentalShowHowTo:!1,\_\_experimentalValidateInput:e=>u.includes(e),className:"optml\_\_token"}))))}const It=({tab:e,setTab:t,canSave:s,setCanSave:n,settings:r,setSettings:i})=>{const{siteSettings:l,isLoading:d,damEnabled:p}=(0,c.useSelect)((e=>{const{getSiteSettings:t,getQueryArgs:s,isLoading:a}=e("optimole"),o=t();return{siteSettings:o,damEnabled:o.cloud\_images,isLoading:a(),queryArgs:s()}}),[]),[m,u]=(0,o.useState)(!1),[h,b]=(0,o.useState)(!1);(0,o.useEffect)((()=>{((e=!0)=>{const{dam\_url:t,strings:s}=window.optimoleDashboardApp,{cloud\_library:a}=s,o=document.querySelector('a[href\*="page=optimole-dam"]');if(!e&&!o)return;if(!e){if(!o)return;return void(o.style.display="none")}if(o)return void(o.style={});const n=document.createElement("li"),r=document.createElement("a");n.appendChild(r),r.href=t,r.innerHTML=a;const i=document.querySelector("#toplevel\_page\_optimole ul");i&&i.insertBefore(n,i.firstChild)})("enabled"===p)}),[p]),(0,o.useEffect)((()=>{const e=localStorage.getItem("optimole\_settings\_visits");3<e||localStorage.setItem("optimole\_settings\_visits",e?parseInt(e)+1:1)}),[e]);const f=()=>{be(r,l.banner\_frontend!==r.banner\_frontend),n(!1)};return(0,a.createElement)("div",{className:"optml-settings flex flex-col sm:flex-row bg-white p-8 border-0 rounded-lg shadow-md gap-8"},(0,a.createElement)(Je,{tab:e,setTab:t,settings:r}),(0,a.createElement)("div",{className:"basis-4/5"},"general"===e&&(0,a.createElement)(nt,{settings:r,setSettings:i,setCanSave:n}),"compression"===e&&(0,a.createElement)(lt,{settings:r,setSettings:i,setCanSave:n,showSample:m,isSampleLoading:h,setIsSampleLoading:b}),"resize"===e&&(0,a.createElement)(ct,{settings:r,setSettings:i,setCanSave:n}),"lazyload"===e&&(0,a.createElement)(dt,{settings:r,setSettings:i,setCanSave:n}),"exclusions"===e&&(0,a.createElement)(Et,{settings:r,setSettings:i,setCanSave:n}),"cloud\_library"===e&&(0,a.createElement)(Nt,{settings:r,canSave:s,setSettings:i,setCanSave:n,onSaveSettings:f}),"offload\_media"===e&&(0,a.createElement)(Lt,{settings:r,canSave:s,setSettings:i,setCanSave:n,onSaveSettings:f}),(0,a.createElement)("div",{className:"flex justify-start items-center gap-5 mt-8"},(0,a.createElement)(g.Button,{variant:"primary",isBusy:d,disabled:!s,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:f},optimoleDashboardApp.strings.options\_strings.save\_changes),"disabled"===r.autoquality&&"compression"===e&&(0,a.createElement)(g.Button,{variant:"default",disabled:d,onClick:()=>{m||(b(!0),\_e({quality:r.quality},(()=>b(!1)))),u(!m)}},optimoleDashboardApp.strings.options\_strings.view\_sample\_image))))},Tt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),Mt=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M6.68822 16.625L5.5 17.8145L5.5 5.5L18.5 5.5L18.5 16.625L6.68822 16.625ZM7.31 18.125L19 18.125C19.5523 18.125 20 17.6773 20 17.125L20 5C20 4.44772 19.5523 4 19 4H5C4.44772 4 4 4.44772 4 5V19.5247C4 19.8173 4.16123 20.086 4.41935 20.2237C4.72711 20.3878 5.10601 20.3313 5.35252 20.0845L7.31 18.125ZM16 9.99997H8V8.49997H16V9.99997ZM8 14H13V12.5H8V14Z"})),Ot=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),Ft=[{title:optimoleDashboardApp.strings.help.get\_support\_title,description:optimoleDashboardApp.strings.help.get\_support\_desc,cta:optimoleDashboardApp.strings.help.get\_support\_cta,link:"https://wordpress.org/support/plugin/optimole-wp/",icon:Tt},{title:optimoleDashboardApp.strings.help.feat\_request\_title,description:optimoleDashboardApp.strings.help.feat\_request\_desc,cta:optimoleDashboardApp.strings.help.feat\_request\_cta,link:"https://github.com/Codeinwp/optimole-wp/discussions",icon:Mt},{title:optimoleDashboardApp.strings.help.feedback\_title,description:optimoleDashboardApp.strings.help.feedback\_desc,cta:optimoleDashboardApp.strings.help.feedback\_cta,link:"https://wordpress.org/plugins/optimole-wp/#developers",icon:Ot}],jt=[{title:optimoleDashboardApp.strings.help.account\_title,items:[{label:optimoleDashboardApp.strings.help.account\_item\_one,value:"https://docs.optimole.com/article/1134-how-optimole-counts-the-number-of-visitors"},{label:optimoleDashboardApp.strings.help.account\_item\_two,value:"https://docs.optimole.com/article/1008-what-happens-if-i-exceed-plan-limits"},{label:optimoleDashboardApp.strings.help.account\_item\_three,value:"https://docs.optimole.com/article/1133-visitors-based-plan"}]},{title:optimoleDashboardApp.strings.help.image\_processing\_title,items:[{label:optimoleDashboardApp.strings.help.image\_processing\_item\_one,value:"https://docs.optimole.com/article/1173-how-to-get-started-with-optimole-in-just-3-steps"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_two,value:"https://docs.optimole.com/article/1068-how-optimole-can-serve-webp-images"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_three,value:"https://docs.optimole.com/article/1475-adding-watermarks-to-your-images"}]},{title:optimoleDashboardApp.strings.help.api\_title,items:[{label:optimoleDashboardApp.strings.help.api\_item\_one,value:"https://docs.optimole.com/article/1323-cloud-library-browsing"},{label:optimoleDashboardApp.strings.help.api\_item\_two,value:"https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading"},{label:optimoleDashboardApp.strings.help.api\_item\_three,value:"https://docs.optimole.com/article/1307-custom-integration"}]}],Ht="flex p-6 border-2 border-solid border-grayish-blue rounded-md items-start gap-8 basis-1/3",Bt=()=>(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},(0,a.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_one\_title),(0,a.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},Ft.map(((e,t)=>(0,a.createElement)("div",{key:t,className:Ht},(0,a.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,a.createElement)(g.Icon,{icon:e.icon,className:"fill-info",size:42}),(0,a.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),(0,a.createElement)("div",{className:"not-italic font-normal text-s text-gray-800"},e.description),(0,a.createElement)(g.ExternalLink,{href:e.link},e.cta)))))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)("div",{className:"flex items-center justify-between"},(0,a.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_two\_title),(0,a.createElement)(g.ExternalLink,{href:"https://docs.optimole.com/"},optimoleDashboardApp.strings.help.section\_two\_sub)),(0,a.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},jt.map(((e,t)=>(0,a.createElement)("div",{key:t,className:Ht},(0,a.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,a.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),e.items.map(((e,t)=>(0,a.createElement)("a",{key:t,href:e.value,target:"\_blank"},e.label))))))))),zt=[optimoleDashboardApp.strings.upgrade.reason\_1,optimoleDashboardApp.strings.upgrade.reason\_2,optimoleDashboardApp.strings.upgrade.reason\_3,optimoleDashboardApp.strings.upgrade.reason\_4],Rt=()=>{const{name:e,domain:t,plan:s}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole"),s=t();let a=s?.cdn\_key+".i.optimole.com";return void 0!==s?.domain&&""!==s?.domain&&(a=s?.domain),{name:s?.display\_name,domain:a,plan:s?.plan}}));return(0,a.createElement)("div",{className:"flex flex-col mt-8 mb-5 p-0 transition-all ease-in-out duration-700 gap-5 basis-3/12"},(0,a.createElement)("div",{className:"bg-white gap-5 flex flex-col text-gray-700 border-0 rounded-lg shadow-md p-8"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.logged\_in\_as,value:e,className:"optml\_\_placeholder",disabled:!0}),(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.private\_cdn\_url,value:t,className:"optml\_\_placeholder",disabled:!0}),(0,a.createElement)("hr",{className:"m-0 border-grayish-blue"}),(0,a.createElement)("p",{className:"font-semibold text-xs text-light-black m-0"},optimoleDashboardApp.strings.looking\_for\_api\_key),(0,a.createElement)("p",{className:"m-0 -mt-3",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.optml\_dashboard}})),"free"===s?(0,a.createElement)("div",{className:"bg-info flex flex-col text-white border-0 rounded-lg shadow-md p-8 bg-promo bg-no-repeat",style:{backgroundImage:`url( ${optimoleDashboardApp.assets\_url}/img/logo2.png )`}},(0,a.createElement)("h3",{className:"mt-0 text-white text-lg"},optimoleDashboardApp.strings.upgrade.title\_long),(0,a.createElement)("ul",null,zt.map(((e,t)=>(0,a.createElement)("li",{key:t,className:"flex items-center gap-2"},(0,a.createElement)(g.Icon,{icon:"yes-alt",className:"text-white"}),(0,a.createElement)("span",{className:"text-white font-normal text-base"},e))))),(0,a.createElement)(g.Button,{variant:"link",className:"optml\_\_button flex w-full justify-center font-bold min-h-40 !no-underline !text-white !bg-opaque-black !rounded",href:optimoleDashboardApp.optimoleHome+"pricing",target:"\_blank"},optimoleDashboardApp.strings.upgrade.cta)):(0,a.createElement)(g.Button,{variant:"default",className:"bg-white flex font-bold border-0 rounded-lg shadow-md p-8 text-sm justify-center",href:(0,S.addQueryArgs)(optimoleDashboardApp.optimoleHome+"contact/",{contact\_name:window.optimoleDashboardApp.user\_data.display\_name,contact\_email:optimoleDashboardApp.user\_data.user\_email,contact\_website:optimoleDashboardApp.home\_url}),target:"\_blank"},optimoleDashboardApp.strings.premium\_support))},Pt=({strings:e,onClose:t})=>(0,a.createElement)("div",{className:"flex justify-between px-8 pt-8"},(0,a.createElement)("p",{className:"text-purple-gray text-sm m-0 py-2"},e.title),(0,a.createElement)(g.Button,{label:e.close,icon:at,onClick:t,className:"text-gray-950"}));window.optimoleCSAT={hasSubmitted:!1,data:{}};const Vt=({id:e,show:t=!1,strings:s={},pages:n=[],onDismiss:r=(()=>{})})=>{const[i,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(0),[p,m]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),[b,f]=(0,o.useState)({});(0,o.useEffect)((()=>{const t=()=>{!window.optimoleCSAT.hasSubmitted&&window.optimoleCSAT.data?.score&&localStorage.setItem(`optimole\_csat\_data\_${e}`,JSON.stringify(window.optimoleCSAT.data))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,o.useEffect)((()=>{t&&!p&&l(t)}),[t]),(0,o.useEffect)((()=>{window.optimoleCSAT={hasSubmitted:u,data:b}}),[u,b]);const \_=(e=!1,t=b)=>{if(r(),u||!t?.score)return m(!0),null;const s={email:optimoleDashboardApp.user\_data.user\_email,product:"Optimole",site:optimoleDashboardApp.home\_url,...t};try{fetch(`https://api.themeisle.com/tracking/csat/${t?.score}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, \*/\*;q=0.1","Cache-Control":"no-cache"},body:JSON.stringify(s)})}catch(e){console.warn(e)}h(!0),d(n.length),e&&(l(!1),m(!0))};if((0,o.useEffect)((()=>{const t=localStorage.getItem(`optimole\_csat\_data\_${e}`);t&&(\_(!0,JSON.parse(t)),localStorage.removeItem(`optimole\_csat\_data\_${e}`))}),[]),!i)return null;if(0===n.length)return null;const v=c<n.length,E=n[c]?.content;return(0,a.createElement)("div",{className:"bg-white fixed left-0 w-auto sm:right-0 sm:left-auto sm:w-full bottom-0 m-12 gap-2 max-w-lg flex flex-col text-gray-700 border-0 rounded-lg shadow-lg z-50"},n[c]&&(0,a.createElement)(a.Fragment,null,n[c]?.showHeader&&(0,a.createElement)(Pt,{onClose:()=>{l(!1),m(!0),\_()},strings:s}),(0,a.createElement)(E,{data:b,changeData:(e,t=!1)=>{f({...b,...e}),t&&d(c+1)},onSubmit:\_})),!v&&(0,a.createElement)("div",{className:"flex flex-col gap-5 p-8 items-center"},(0,a.createElement)(g.Icon,{icon:Xe,size:40,className:"bg-success rounded-full fill-white p-2"}),(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_three),(0,a.createElement)("div",{className:"text-sm text-center"},optimoleDashboardApp.strings.csat.thank\_you),(0,a.createElement)(g.Button,{variant:"primary",onClick:()=>l(!1),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.close)))},$t=window.wp.api;var qt=s.n($t);const Zt=window.wp.i18n,Ut=()=>{const[e,t]=(0,o.useState)(!1),[s,n,r]=(()=>{const[e,t]=(0,o.useState)({}),[s,a]=(0,o.useState)("loading"),n=()=>{qt().loadPromise.then((async()=>{try{const e=new(qt().models.Settings),s=await e.fetch();t(s)}catch(e){a("error")}finally{a("loaded")}}))};return(0,o.useEffect)((()=>{n()}),[]),[t=>e?.[t],(e,t,s=(0,Zt.\_\_)("Settings saved.","textdomain"))=>{a("saving");const o=new(qt().models.Settings)({[e]:t}).save();o.success(((e,t)=>{"success"===t&&a("loaded"),"error"===t&&a("error"),n()})),o.error((e=>{a("error")}))},s]})(),i="loaded"===r&&void 0!==s("optml\_csat")&&JSON.parse(s("optml\_csat")),{hasImages:l,isFirstSite:d}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole");return{hasImages:0<t()?.images\_number,isFirstSite:1===t()?.whitelist?.length}})),p=localStorage.getItem("optimole\_settings\_visits");return(0,o.useEffect)((()=>{t(l&&d&&3<=parseInt(p)&&!1!==i&&!0!==i?.firstImpressions)}),[p,i]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Vt,{id:"first-impressions",show:e,onDismiss:()=>n("optml\_csat",JSON.stringify({...i,firstImpressions:!0})),strings:{title:optimoleDashboardApp.strings.csat.title,close:optimoleDashboardApp.strings.csat.close},pages:[{showHeader:!0,content:e=>(0,a.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_one),(0,a.createElement)("div",{className:"flex gap-5"},[1,2,3,4,5].map((t=>(0,a.createElement)(g.Button,{key:t,onClick:()=>e.changeData({score:t},!0),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},t)))),(0,a.createElement)("div",{className:"flex justify-between"},(0,a.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.low),(0,a.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.high)))},{showHeader:!0,content:e=>(0,a.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_two),(0,a.createElement)(g.TextareaControl,{label:optimoleDashboardApp.strings.csat.heading\_two,hideLabelFromVision:!0,value:e.data?.feedback,placeholder:optimoleDashboardApp.strings.csat.feedback\_placeholder,onChange:t=>e.changeData({feedback:t})}),(0,a.createElement)("div",{className:"flex justify-end"},(0,a.createElement)("div",{className:"flex gap-2"},(0,a.createElement)(g.Button,{onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.skip),(0,a.createElement)(g.Button,{variant:"primary",onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.submit))))}]}))};var Gt=Object.defineProperty,Kt=(e,t,s)=>(((e,t,s)=>{t in e?Gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const Yt=e=>({ok:!1,error:e});async function Qt(e,t,s,a){const o=new URL(t,e),n=JSON.stringify(a),r=(i=fetch,(...e)=>{try{return{ok:!0,data:i(...e)}}catch(e){return{ok:!1,error:e}}})(o.toString(),{method:s,headers:{"Content-Type":"application/json"},body:n});var i;if(!1===r.ok)return Yt(r.error);const l=await r.data,{data:c}=await l.json();return l.ok?(e=>({ok:!0,data:e}))(c):Yt({code:"network\_error",message:l.statusText,status:l.status,url:o})}class Jt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/actions`,"POST",e)}}class Wt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/displays`,"POST",e)}async update(e,t){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/displays/${e}`,"PUT",t)}}class Xt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/people`,"POST",{environmentId:this.environmentId,userId:e})}async update(e,t){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/people/${e}`,"POST",t)}}class es{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/responses`,"POST",e)}async update({responseId:e,finished:t,data:s,ttc:a}){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/responses/${e}`,"PUT",{finished:t,data:s,ttc:a})}}class ts{constructor(e,t){this.apiHost=e,this.environmentId=t}async uploadFile(e,{allowedFileExtensions:t,surveyId:s}={}){if(!(e instanceof Blob&&e instanceof File))throw new Error("Invalid file type. Expected Blob or File, but received "+typeof e);const a={fileName:e.name,fileType:e.type,allowedFileExtensions:t,surveyId:s},o=await fetch(`${this.apiHost}/api/v1/client/${this.environmentId}/storage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`Upload failed with status: ${o.status}`);const n=await o.json(),{data:r}=n,{signedUrl:i,fileUrl:l,signingData:c,presignedFields:d,updatedFileName:p}=r;let m={};if(c){const{signature:t,timestamp:a,uuid:o}=c;m={"X-File-Type":e.type,"X-File-Name":encodeURIComponent(p),"X-Survey-ID":s??"","X-Signature":t,"X-Timestamp":String(a),"X-UUID":o}}const u=new FormData;d&&Object.keys(d).forEach((e=>{u.append(e,d[e])})),u.append("file",e);const g=await fetch(i,{method:"POST",...c?{headers:m}:{},body:u});if(!g.ok){if(c){const e=await g.json(),t=new Error(e.message);throw t.name="FileTooLargeError",t}const e=await g.text();if(d&&e&&e.includes("EntityTooLarge")){const e=new Error("File size exceeds the size limit for your plan");throw e.name="FileTooLargeError",e}throw new Error(`Upload failed with status: ${g.status}`)}return l}}class ss{constructor(e){const{apiHost:t,environmentId:s}=e;this.response=new es(t,s),this.display=new Wt(t,s),this.action=new Jt(t,s),this.people=new Xt(t,s),this.storage=new ts(t,s)}}class as{constructor(e){this.client=new ss(e)}}class os{constructor(){this.logLevel="error"}static getInstance(){return os.instance||(os.instance=new os),os.instance}configure(e){e&&void 0!==e.logLevel&&(this.logLevel=e.logLevel)}logger(e,t){if("debug"===t&&"debug"!==this.logLevel)return;const s=`🧱 Formbricks - ${(new Date).toISOString()} [${t.toUpperCase()}] - ${e}`;"error"===t?console.error(s):console.log(s)}debug(e){this.logger(e,"debug")}error(e){this.logger(e,"error")}}const ns=e=>({ok:!0,value:e}),rs=e=>({ok:!1,error:e}),is=e=>(...t)=>{try{return{ok:!0,value:e(...t)}}catch(e){return{ok:!1,error:e}}},ls=os.getInstance(),cs=class e{constructor(e){this.customized=!1,e?(this.handleError=e,this.customized=!0):this.handleError=e=>os.getInstance().error(JSON.stringify(e))}static getInstance(){return e.instance||(e.instance=new e),e.instance}static init(t){this.initialized=!0,e.instance=new e(t)}printStatus(){ls.debug("Custom error handler: "+(this.customized?"yes":"no"))}handle(e){console.warn("🧱 Formbricks - Global error: ",e),this.handleError(e)}};cs.initialized=!1;let ds=cs;const ps="formbricks-js";class ms{constructor(){this.config=null;const e=this.loadFromLocalStorage();e.ok&&(this.config=e.value)}static getInstance(){return ms.instance||(ms.instance=new ms),ms.instance}update(e){e&&(this.config={...this.config,...e,status:e.status||"success"},this.saveToLocalStorage())}get(){if(!this.config)throw new Error("config is null, maybe the init function was not called?");return this.config}loadFromLocalStorage(){if("undefined"!=typeof window){const e=localStorage.getItem(ps);if(e){const t=JSON.parse(e);return t.expiresAt&&new Date(t.expiresAt)<=new Date?rs(new Error("Config in local storage has expired")):ns(JSON.parse(e))}}return rs(new Error("No or invalid config in local storage"))}saveToLocalStorage(){return is((()=>localStorage.setItem(ps,JSON.stringify(this.config))))()}resetConfig(){return this.config=null,is((()=>localStorage.removeItem(ps)))()}}const us=(e,t)=>{const s=Math.abs(t.getTime()-e.getTime());return Math.floor(s/864e5)},gs=()=>window.location.search.includes("formbricksDebug=true"),hs=ms.getInstance(),bs=os.getInstance();let fs=null;const \_s=async(e,t=!1)=>{var s;try{const a=await(async({apiHost:e,environmentId:t,userId:s},a)=>{try{const o=`${e}/api/v1/client/${t}/in-app/sync`,n="?version=1.6.5";let r={};if((a||gs())&&(r.cache="no-cache",bs.debug("No cache option set for sync")),!s){const e=o+n,t=await fetch(e,r);if(!t.ok){const s=await t.json();return rs({code:"network\_error",status:t.status,message:"Error syncing with backend",url:e,responseMessage:s.message})}return ns((await t.json()).data)}const i=`${o}/${s}${n}`,l=await fetch(i,r);if(!l.ok){const e=await l.json();return rs({code:"network\_error",status:l.status,message:"Error syncing with backend",url:i,responseMessage:e.message})}const c=await l.json(),{data:d}=c;return ns(d)}catch(e){return rs(e)}})(e,t);if(!0!==(null==a?void 0:a.ok))throw a.error;let o;try{o=hs.get().state}catch(e){}let n={surveys:a.value.surveys,noCodeActionClasses:a.value.noCodeActionClasses,product:a.value.product,attributes:(null==(s=a.value.person)?void 0:s.attributes)||{}};if(e.userId){const e=n.surveys.map((e=>e.name));bs.debug("Fetched "+e.length+" surveys during sync: "+e.join(", "))}else{n={...n,displays:(null==o?void 0:o.displays)||[]},n=vs(n);const e=n.surveys.map((e=>e.name));bs.debug("Fetched "+e.length+" surveys during sync: "+e.join(", "))}hs.update({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId,state:n,expiresAt:new Date((new Date).getTime()+12e4)})}catch(e){throw bs.error(`Error during sync: ${e}`),e}},vs=e=>{const{displays:t,product:s}=e;let{surveys:a}=e;if(!t)return e;let o=a.filter((e=>{if("respondMultiple"===e.displayOption)return!0;if("displayOnce"===e.displayOption)return 0===t.filter((t=>t.surveyId===e.id)).length;if("displayMultiple"===e.displayOption)return 0===t.filter((t=>t.surveyId===e.id&&t.responded)).length;throw Error("Invalid displayOption")}));const n=t.length>0?t[t.length-1]:void 0;return o=o.filter((e=>{if(n){if(null!==e.recontactDays){const s=t.filter((t=>t.surveyId===e.id))[0];return!s||us(new Date,new Date(s.createdAt))>=e.recontactDays}return null===s.recontactDays||us(new Date,new Date(n.createdAt))>=s.recontactDays}return!0})),{...e,surveys:o}},Es=()=>{"undefined"!=typeof window&&null!==fs&&(window.clearInterval(fs),fs=null)},ys=e=>new Promise((t=>setTimeout(t,e)));class ws{constructor(e,t){Kt(this,"queue",[]),Kt(this,"config"),Kt(this,"surveyState"),Kt(this,"isRequestInProgress",!1),Kt(this,"api"),this.config=e,this.surveyState=t,this.api=new as({apiHost:e.apiHost,environmentId:e.environmentId})}add(e){this.surveyState.accumulateResponse(e),this.config.setSurveyState&&this.config.setSurveyState(this.surveyState),this.queue.push(e),this.processQueue()}async processQueue(){if(this.isRequestInProgress)return;if(0===this.queue.length)return;this.isRequestInProgress=!0;const e=this.queue[0];let t=0;for(;t<this.config.retryAttempts;){if(await this.sendResponse(e)){this.queue.shift();break}console.error("Formbricks: Failed to send response. Retrying...",t),await ys(1e3),t++}t>=this.config.retryAttempts?(console.error("Failed to send response after 2 attempts."),this.config.onResponseSendingFailed&&this.config.onResponseSendingFailed(e),this.isRequestInProgress=!1):(e.finished&&this.config.onResponseSendingFinished&&this.config.onResponseSendingFinished(),this.isRequestInProgress=!1,this.processQueue())}async sendResponse(e){try{if(null!==this.surveyState.responseId)await this.api.client.response.update({...e,responseId:this.surveyState.responseId});else{const t=await this.api.client.response.create({...e,surveyId:this.surveyState.surveyId,userId:this.surveyState.userId||null,singleUseId:this.surveyState.singleUseId||null});if(!t.ok)throw new Error("Could not create response");if(this.surveyState.displayId)try{await this.api.client.display.update(this.surveyState.displayId,{responseId:t.data.id})}catch(e){console.error("Failed to update display, proceeding with the response.",e)}this.surveyState.updateResponseId(t.data.id),this.config.setSurveyState&&this.config.setSurveyState(this.surveyState)}return!0}catch(e){return console.error(e),!1}}updateSurveyState(e){this.surveyState=e}}class ks{constructor(e,t,s,a){Kt(this,"responseId",null),Kt(this,"displayId",null),Kt(this,"userId",null),Kt(this,"surveyId"),Kt(this,"responseAcc",{finished:!1,data:{},ttc:{}}),Kt(this,"singleUseId"),this.surveyId=e,this.userId=a??null,this.singleUseId=t??null,this.responseId=s??null}setSurveyId(e){this.surveyId=e,this.clear()}copy(){const e=new ks(this.surveyId,this.singleUseId??void 0,this.responseId??void 0,this.userId??void 0);return e.responseId=this.responseId,e.responseAcc=this.responseAcc,e}updateResponseId(e){this.responseId=e}updateDisplayId(e){this.displayId=e}updateUserId(e){this.userId=e}accumulateResponse(e){this.responseAcc={finished:e.finished,ttc:e.ttc,data:{...this.responseAcc.data,...e.data}}}isResponseFinished(){return this.responseAcc.finished}clear(){this.responseId=null,this.responseAcc={finished:!1,data:{},ttc:{}}}}const xs=ks;let Cs=!1,Ss=async function(e){if(e.clientY<=0){const e=await \_a("Exit Intent (Desktop)");if(!0!==e.ok)return rs(e.error)}};const As=()=>{Cs&&(document.removeEventListener("mouseleave",Ss),Cs=!1)};let Ds=!1,Ls=!1,Ns=async()=>{const e=window.scrollY,t=window.innerHeight,s=document.documentElement.scrollHeight;if(0===e&&(Ls=!1),!Ls&&e/(s-t)>=.5){Ls=!0;const e=await \_a("50% Scroll");if(!0!==e.ok)return rs(e.error)}};const Is=()=>{Ds&&(window.removeEventListener("scroll",Ns),Ds=!1)},Ts=ms.getInstance(),Ms=os.getInstance(),Os=ds.getInstance(),Fs=async()=>{var e;Ms.debug(`Checking page url: ${window.location.href}`);const{state:t}=Ts.get(),{noCodeActionClasses:s=[],surveys:a=[]}=t??{},o=s.filter((e=>{const{innerHtml:t,cssSelector:s,pageUrl:a}=e.noCodeConfig||{};return a&&!t&&!s})),n=a.filter((e=>{var t;const{pageUrl:s,cssSelector:a,innerHtml:o}=(null==(t=e.inlineTriggers)?void 0:t.noCodeConfig)||{};return s&&!a&&!o}));if(o.length>0)for(const t of o){if(!(null==(e=t.noCodeConfig)?void 0:e.pageUrl))continue;const{noCodeConfig:{pageUrl:s}}=t,a=Rs(window.location.href,s.value,s.rule);if(!0!==a.ok)return rs(a.error);if(!1===a.value)continue;const o=await \_a(t.name);if(!0!==o.ok)return rs(o.error)}return n.length>0&&n.forEach((e=>{const{noCodeConfig:t}=e.inlineTriggers??{},{pageUrl:s}=t??{};if(s){const t=Rs(window.location.href,s.value,s.rule);if(!0!==t.ok)return rs(t.error);if(!1===t.value)return;da(e)}})),{ok:!0,value:void 0}};let js=!1;const Hs=()=>Fs(),Bs=["hashchange","popstate","pushstate","replacestate","load"],zs=()=>{"undefined"!=typeof window&&js&&(Bs.forEach((e=>window.removeEventListener(e,Hs))),js=!1)};function Rs(e,t,s){switch(s){case"exactMatch":return ns(e===t);case"contains":return ns(e.includes(t));case"startsWith":return ns(e.startsWith(t));case"endsWith":return ns(e.endsWith(t));case"notMatch":return ns(e!==t);case"notContains":return ns(!e.includes(t));default:return rs({code:"invalid\_match\_type",message:"Invalid match type"})}}const Ps=(e,t)=>{var s,a,o,n,r,i,l,c;const d=null==(a=null==(s=t.noCodeConfig)?void 0:s.innerHtml)?void 0:a.value,p=null==(n=null==(o=t.noCodeConfig)?void 0:o.cssSelector)?void 0:n.value,m=null==(i=null==(r=t.noCodeConfig)?void 0:r.pageUrl)?void 0:i.value,u=null==(c=null==(l=t.noCodeConfig)?void 0:l.pageUrl)?void 0:c.rule;if(!d&&!p&&!m)return!1;if(d&&e.innerHTML!==d)return!1;if(p){const t=p.split(/\s\*(?=[.#])/);for(let s of t)if(!e.matches(s))return!1}if(m&&u){const e=Rs(window.location.href,m,u);if(!e.ok||!e.value)return!1}return!0};let Vs=!1;const $s=e=>(e=>{const{state:t}=Ts.get();if(!t)return;const{noCodeActionClasses:s}=t;if(!s)return;const a=e.target;s.forEach((e=>{Ps(a,e)&&\_a(e.name).then((e=>{var t,s;s=e=>{Os.handle(e)},!0===(t=e).ok?t.value:s(t.error)}))}));const o=t.surveys;o&&0!==o.length&&o.forEach((e=>{const{inlineTriggers:t}=e;t&&Ps(a,t)&&da(e)}))})(e),qs=()=>{Vs&&(document.removeEventListener("click",$s),Vs=!1)};let Zs=!1;const Us=ms.getInstance(),Gs=os.getInstance(),Ks=ms.getInstance(),Ys=os.getInstance();let Qs=!1;const Js=e=>{Qs=e},Ws=async e=>{if(gs()&&Ys.configure({logLevel:"debug"}),Qs)return Ys.debug("Already initialized, skipping initialization."),{ok:!0,value:void 0};let t;try{t=Ks.get(),Ys.debug("Found existing configuration.")}catch(e){Ys.debug("No existing configuration found.")}if("error"===(null==t?void 0:t.status)){if(Ys.debug("Formbricks was set to an error state."),(null==t?void 0:t.expiresAt)&&new Date(t.expiresAt)>new Date)return Ys.debug("Error state is not expired, skipping initialization"),{ok:!0,value:void 0};Ys.debug("Error state is expired. Continue with initialization.")}if(ds.getInstance().printStatus(),Ys.debug("Start initialize"),!e.environmentId)return Ys.debug("No environmentId provided"),rs({code:"missing\_field",field:"environmentId"});if(!e.apiHost)return Ys.debug("No apiHost provided"),rs({code:"missing\_field",field:"apiHost"});if(Ys.debug("Adding widget container to DOM"),ma(),!e.userId&&e.attributes)return Ys.error("No userId provided but attributes. Cannot update attributes without userId."),rs({code:"missing\_field",field:"userId"});let s=null;if(e.userId&&e.attributes){const t=await(async(e,t,s,a)=>{var o,n;if(!s)return rs({code:"missing\_person",message:"Unable to update attribute. User identification deactivated. No userId set."});const r={...a};try{const e=null==(n=null==(o=Us.get())?void 0:o.state)?void 0:n.attributes;if(e)for(const[t,s]of Object.entries(e))r[t]===s&&delete r[t]}catch(e){Gs.debug("config not set; sending all attributes to backend")}if(0===Object.keys(r).length)return Gs.debug("No attributes to update. Skipping update."),ns(r);Gs.debug("Updating attributes: "+JSON.stringify(r));const i={attributes:r},l=new as({apiHost:e,environmentId:t}),c=await l.client.people.update(s,i);return c.ok?ns(r):rs({code:"network\_error",status:500,message:`Error updating person with userId ${s}`,url:`${e}/api/v1/client/${t}/people/${s}`,responseMessage:c.error.message})})(e.apiHost,e.environmentId,e.userId,e.attributes);if(!0!==t.ok)return rs(t.error);s=t.value}if(t&&t.state&&t.environmentId===e.environmentId&&t.apiHost===e.apiHost&&t.userId===e.userId&&t.expiresAt)if(Ys.debug("Configuration fits init parameters."),t.expiresAt<new Date){Ys.debug("Configuration expired.");try{await \_s({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId})}catch(e){ta()}}else Ys.debug("Configuration not expired. Extending expiration."),Ks.update(t);else{Ys.debug("No valid configuration found or it has been expired. Resetting config and creating new one."),Ks.resetConfig(),Ys.debug("Syncing.");try{await \_s({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId})}catch(e){Xs()}await \_a("New Session")}return s&&Object.keys(s).length>0&&Ks.update({environmentId:Ks.get().environmentId,apiHost:Ks.get().apiHost,userId:Ks.get().userId,state:{...Ks.get().state,attributes:{...Ks.get().state.attributes,...e.attributes}},expiresAt:Ks.get().expiresAt}),Ys.debug("Adding event listeners"),"undefined"!=typeof window&&null===fs&&(fs=window.setInterval((async()=>{try{if(hs.get().expiresAt&&new Date(hs.get().expiresAt)>=new Date)return;bs.debug("Config has expired. Starting sync."),await \_s({apiHost:hs.get().apiHost,environmentId:hs.get().environmentId,userId:hs.get().userId})}catch(e){bs.error(`Error during expiry check: ${e}`),bs.debug("Extending config and try again later.");const t=hs.get();hs.update(t)}}),3e4)),"undefined"==typeof window||js||(Bs.forEach((e=>window.addEventListener(e,Hs))),js=!0),"undefined"==typeof window||Vs||(document.addEventListener("click",$s),Vs=!0),"undefined"==typeof document||Cs||(document.querySelector("body").addEventListener("mouseleave",Ss),Cs=!0),"undefined"==typeof window||Ds||(window.addEventListener("load",(()=>{window.addEventListener("scroll",Ns)})),Ds=!0),Zs||(window.addEventListener("beforeunload",(()=>{Es(),zs(),qs(),As(),Is()})),Zs=!0),Js(!0),Ys.debug("Initialized"),Fs(),{ok:!0,value:void 0}},Xs=()=>{const e={status:"error",expiresAt:new Date((new Date).getTime()+6e5)};throw is((()=>localStorage.setItem(ps,JSON.stringify(e))))(),new Error("Could not initialize formbricks")},ea=()=>{Ys.debug("Deinitializing"),ua(),ca(!1),Es(),zs(),qs(),As(),Is(),Zs&&(window.removeEventListener("beforeunload",(()=>{Es(),zs(),qs(),As(),Is()})),Zs=!1),Js(!1)},ta=()=>{Ys.debug("Putting formbricks in error state"),Ks.update({...Ks.get(),status:"error",expiresAt:new Date((new Date).getTime()+6e5)}),ea()},sa="formbricks-web-container",aa=ms.getInstance(),oa=os.getInstance(),na=ds.getInstance();let ra=!1,ia=e=>{},la=e=>{};const ca=e=>{ra=e},da=async e=>{if(ra)return void oa.debug("A survey is already running. Skipping.");ca(!0),e.delay&&oa.debug(`Delaying survey by ${e.delay} seconds.`);const t=aa.get().state.product,s=new xs(e.id,null,null,aa.get().userId),a=new ws({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId,retryAttempts:2,onResponseSendingFailed:()=>{ia(!0)},onResponseSendingFinished:()=>{la(!0)}},s),o=e.productOverwrites??{},n=o.brandColor??t.brandColor,r=o.highlightBorderColor??t.highlightBorderColor,i=o.clickOutsideClose??t.clickOutsideClose,l=o.darkOverlay??t.darkOverlay,c=o.placement??t.placement,d=t.inAppSurveyBranding,p=await ga();setTimeout((()=>{p.renderSurveyModal({survey:e,brandColor:n,isBrandingEnabled:d,clickOutside:i,darkOverlay:l,highlightBorderColor:r,placement:c,getSetIsError:e=>{ia=e},getSetIsResponseSendingFinished:e=>{la=e},onDisplay:async()=>{const{userId:t}=aa.get();if(!t){const t={createdAt:new Date,surveyId:e.id,responded:!1},s=aa.get().state.displays,a=s?[...s,t]:[t],o=aa.get();let n=vs({...o.state,displays:a});aa.update({...o,state:n})}const o=new as({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId}),n=await o.client.display.create({surveyId:e.id,userId:t});if(!n.ok)throw new Error("Could not create display");const{id:r}=n.data;s.updateDisplayId(r),a.updateSurveyState(s)},onResponse:e=>{const{userId:t}=aa.get();if(!t){const e=aa.get().state.displays,t=e&&e[e.length-1];if(!t)throw new Error("No lastDisplay found");if(!t.responded){t.responded=!0;const s=aa.get();let a=vs({...s.state,displays:e});aa.update({...s,state:a})}}t&&s.updateUserId(t),a.updateSurveyState(s),a.add({data:e.data,ttc:e.ttc,finished:e.finished})},onClose:pa,onFileUpload:async(e,t)=>{const s=new as({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId});return await s.client.storage.uploadFile(e,t)},onRetry:()=>{ia(!1),a.processQueue()}})}),1e3\*e.delay)},pa=async()=>{if(ua(),ma(),!aa.get().userId){const e=aa.get().state,t=vs(e);return aa.update({...aa.get(),state:t}),void ca(!1)}try{await \_s({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId,userId:aa.get().userId},!0),ca(!1)}catch(e){na.handle(e),ta()}},ma=()=>{const e=document.createElement("div");e.id=sa,document.body.appendChild(e)},ua=()=>{var e;null==(e=document.getElementById(sa))||e.remove()},ga=()=>new Promise(((e,t)=>{if(window.formbricksSurveys)e(window.formbricksSurveys);else{const s=document.createElement("script");s.src="https://unpkg.com/@formbricks/surveys@~1.6.3/dist/index.umd.js",s.async=!0,s.onload=()=>e(window.formbricksSurveys),s.onerror=e=>{console.error("Failed to load Formbricks Surveys library:",e),t(e)},document.head.appendChild(s)}})),ha=os.getInstance(),ba=ms.getInstance(),fa=["Exit Intent (Desktop)","50% Scroll"],\_a=async e=>{var t;const{userId:s,state:{surveys:a=[]}}=ba.get();a.forEach((async t=>{const{inlineTriggers:s}=t,{codeConfig:a}=s??{};e!==(null==a?void 0:a.identifier)||await da(t)}));const o={environmentId:ba.get().environmentId,userId:s,name:e};if(s&&!fa.includes(e)){ha.debug(`Sending action "${e}" to backend`);const t=new as({apiHost:ba.get().apiHost,environmentId:ba.get().environmentId}),a=await t.client.action.create({...o,userId:s});if(!a.ok)return rs({code:"network\_error",message:`Error tracking action ${e}`,status:500,url:`${ba.get().apiHost}/api/v1/client/${ba.get().environmentId}/actions`,responseMessage:a.error.message});gs()&&await \_s({environmentId:ba.get().environmentId,apiHost:ba.get().apiHost,userId:s},!0)}ha.debug(`Formbricks: Action "${e}" tracked`);const n=null==(t=ba.get().state)?void 0:t.surveys;return n&&n.length>0?await va(e,n):ha.debug("No active surveys to display"),{ok:!0,value:void 0}},va=async(e,t)=>{for(const a of t)if(!a.displayPercentage||(s=a.displayPercentage,Math.floor(100\*Math.random())+1<=s)){for(const t of a.triggers)if(t===e)return ha.debug(`Formbricks: survey ${a.id} triggered by action "${e}"`),void await da(a)}else ha.debug("Survey display skipped based on displayPercentage.");var s},Ea=e=>async(...t)=>{try{return{ok:!0,data:await e(...t)}}catch(e){return{ok:!1,error:e}}};os.getInstance().debug("Create command queue");const ya=new class{constructor(){this.queue=[],this.running=!1,this.resolvePromise=null,this.commandPromise=null}add(e=!0,t,...s){this.queue.push({command:t,checkInitialized:e,commandArgs:s}),this.running||(this.commandPromise=new Promise((e=>{this.resolvePromise=e,this.run()})))}async wait(){this.running&&await this.commandPromise}async run(){for(this.running=!0;this.queue.length>0;){const e=ds.getInstance(),t=this.queue.shift();if(!t)continue;if(t.checkInitialized){const t=(Ys.debug("Check if initialized"),Qs&&ds.initialized?{ok:!0,value:void 0}:rs({code:"not\_initialized",message:"Formbricks not initialized. Call initialize() first."}));if(t&&!0!==t.ok){e.handle(t.error);continue}}const s=async()=>await(null==t?void 0:t.command.apply(null,null==t?void 0:t.commandArgs)),a=await Ea(s)();a&&(a.ok&&a.data&&!a.data.ok&&e.handle(a.data.error),!0!==a.ok&&e.handle(a.error))}this.running=!1,this.resolvePromise&&(this.resolvePromise(),this.resolvePromise=null,this.commandPromise=null)}};function wa(e,t=1){const s=Math.round(e/t);return 0===s||1===s?0:1<s&&8>s?7:8<=s&&31>s?30:30<s&&90>s?90:90<s?91:void 0}"undefined"!=typeof window&&optimoleDashboardApp.user\_data.plan&&(async e=>{ds.init(e.errorHandler),ya.add(!1,Ws,e),await ya.wait()})({environmentId:"clo8wxwzj44orpm0gjchurujm",apiHost:"https://app.formbricks.com",userId:"optml\_"+optimoleDashboardApp.user\_data.id,attributes:{plan:optimoleDashboardApp.user\_data.plan,status:optimoleDashboardApp.user\_data.status,language:optimoleDashboardApp.language,cname\_assigned:optimoleDashboardApp.user\_data.is\_cname\_assigned||"no",connected\_websites:optimoleDashboardApp.user\_data.whitelist.length,traffic:wa(optimoleDashboardApp.user\_data.traffic,500),images\_number:wa(optimoleDashboardApp.user\_data.images\_number,100),days\_since\_install:wa(optimoleDashboardApp.days\_since\_install)}});const ka=({tab:e,setTab:t})=>{const{isConnected:s,hasApplication:n,hasConflicts:r,siteSettings:i,extraVisits:l}=(0,c.useSelect)((e=>{const{isConnected:t,hasApplication:s,getConflicts:a,getSiteSettings:o}=e("optimole"),n=a(),r=o();return{isConnected:t(),hasApplication:s(),hasConflicts:0<n.count||0,siteSettings:r,extraVisits:r.banner\_frontend}})),{setQueryArgs:d}=(0,c.useDispatch)("optimole"),[p,m]=(0,o.useState)(!1),[u,g]=(0,o.useState)("general"),[h,b]=(0,o.useState)(!1),[f,\_]=(0,o.useState)(i);return(0,o.useEffect)((()=>{const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries());let a=[];if(Object.prototype.hasOwnProperty.call(s,"optimole\_action")){for(let e=0;20>e;e++)Object.prototype.hasOwnProperty.call(s,e)&&(isNaN(s[e])||(a[e]=parseInt(s[e],10)));s.images=a,s.url=window.location.href.split("?")[0]+(Object.prototype.hasOwnProperty.call(s,"paged")?"?paged="+s.paged:""),d(s),t("settings"),g("offload\_media")}}),[]),(0,o.useEffect)((()=>{s&&n&&(T(!0),C()({path:optimoleDashboardApp.routes.poll\_conflicts,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{T(!1),e&&P(e.data)})))}),[]),(0,o.useEffect)((()=>{r&&m(!0)}),[r]),(0,o.useEffect)((()=>{\_({...f,banner\_frontend:l})}),[l]),(0,o.useEffect)((()=>{window.onbeforeunload=h?()=>!0:null}),[h]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"optml-connected max-w-screen-xl flex flex-col lg:flex-row mx-auto gap-5"},(0,a.createElement)("div",{className:"flex flex-col justify-between mt-8 mb-5 p-0 transition-all ease-in-out duration-700 relative text-gray-700 basis-9/12"},"dashboard"===e&&(0,a.createElement)($e,null),"conflicts"===e&&p&&(0,a.createElement)(Ze,null),"settings"===e&&(0,a.createElement)(It,{tab:u,setTab:g,canSave:h,setCanSave:b,settings:f,setSettings:\_}),"help"===e&&(0,a.createElement)(Bt,null)),(0,a.createElement)(Rt,null)),(0,a.createElement)(Ut,null))},xa=[{label:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.version,href:optimoleDashboardApp.optimoleHome},{label:optimoleDashboardApp.strings.terms\_menu,href:optimoleDashboardApp.optimoleHome+"terms/"},{label:optimoleDashboardApp.strings.privacy\_menu,href:optimoleDashboardApp.optimoleHome+"privacy-policy/"},{label:optimoleDashboardApp.strings.testdrive\_menu,href:optimoleDashboardApp.optimoleHome+"test-drive?url="+optimoleDashboardApp.home\_url}],Ca=()=>(0,a.createElement)("footer",{className:"max-w-screen-xl gap-3 md:gap-0 mx-auto my-5 flex justify-between text-base flex-col md:flex-row"},(0,a.createElement)("div",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_3}}),(0,a.createElement)("nav",{className:"flex gap-0 sm:gap-3 flex-wrap md:flex-nowrap"},xa.map(((e,t)=>(0,a.createElement)(g.ExternalLink,{key:t,href:e.href,className:"basis-1/2 sm:basis-auto"},e.label))))),Sa=window.lodash;function Aa(){const e=(0,c.useSelect)((e=>e(A.store).getNotices()),[]),{removeNotice:t}=(0,c.useDispatch)(A.store),s=(0,Sa.filter)(e,{type:"snackbar"});return(0,a.createElement)(g.SnackbarList,{notices:s,className:"px-2 bottom-4 fixed",onRemove:t})}(0,o.render)((0,a.createElement)((()=>{const e=window.location.hash.replace("#","");let t=["dashboard","settings","help"].includes(e)?e:"dashboard";const[s,n]=(0,o.useState)(t),r=e=>{e.preventDefault(),n("settings")},i=e=>{e.preventDefault(),n("dashboard")},{showDisconnect:l,isConnected:d,hasApplication:p,hasDashboardLoaded:m}=(0,c.useSelect)((e=>{const{showDisconnect:t,isConnected:s,hasApplication:a,hasDashboardLoaded:o}=e("optimole");return{showDisconnect:t(),isConnected:s(),hasApplication:a(),hasDashboardLoaded:o()}}));return(0,o.useEffect)((()=>{d&&(window.location.hash=`#${s}`,D.forEach((e=>{const t=document.querySelector(`a[href="${e.href}"]`);if(!t)return;const s=t.parentNode;if(e.hash&&e.hash===window.location.hash)return t.classList.add("current"),void s.classList.add("current");t.classList.remove("current"),s.classList.remove("current")})))}),[s]),(0,o.useEffect)((()=>{if(!d)return;const e=document.querySelector('a[href\*="page=optimole"]'),t=document.querySelector('a[href\*="page=optimole#settings"]');return e&&t?(e.addEventListener("click",i),t.addEventListener("click",r),()=>{e&&t&&(e.removeEventListener("click",i),t.removeEventListener("click",r))}):void 0}),[]),(0,a.createElement)("div",{className:"antialiased"},(0,a.createElement)(we,{tab:s,setTab:n}),!(d&&p)&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(De,null),(0,a.createElement)(Ca,null)),d&&p&&!m&&(0,a.createElement)(Ie,null),d&&l&&(0,a.createElement)(ke,null),d&&p&&m&&(0,a.createElement)(ka,{tab:s,setTab:n}),(0,a.createElement)(Aa,null))}),null),document.getElementById("optimole-app"))},184:(e,t)=>{var s;!function(){"use strict";var a={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var s=arguments[t];if(s){var n=typeof s;if("string"===n||"number"===n)e.push(s);else if(Array.isArray(s)){if(s.length){var r=o.apply(null,s);r&&e.push(r)}}else if("object"===n){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){e.push(s.toString());continue}for(var i in s)a.call(s,i)&&s[i]&&e.push(i)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(s=function(){return o}.apply(t,[]))||(e.exports=s)}()},864:(e,t,s)=>{(()=>{"use strict";var t={n:e=>{var s=e&&e.\_\_esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},a={};t.r(a),t.d(a,{default:()=>c});const o=s(196);var n=t.n(o);function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c=e=>{const{aspectRatio:t="taller",handle:s=null,handleSize:a=40,hover:r=!1,leftImage:l,leftImageAlt:c="",leftImageCss:d={},leftImageLabel:p=null,onSliderPositionChange:m=(()=>{}),rightImage:u,rightImageAlt:g="",rightImageCss:h={},rightImageLabel:b=null,skeleton:f=null,sliderLineColor:\_="#ffffff",sliderLineWidth:v=2,sliderPositionPercentage:E=.5,vertical:y=!1}=e,w=!y,[k,x]=(0,o.useState)(E),[C,S]=(0,o.useState)(0),[A,D]=(0,o.useState)(0),[L,N]=(0,o.useState)(!1),[I,T]=(0,o.useState)(!1),[M,O]=(0,o.useState)(!1),F=(0,o.useRef)(null),j=(0,o.useRef)(null),H=(0,o.useRef)(null);(0,o.useEffect)((()=>{const e=F.current,t=new ResizeObserver((e=>{let[t,...s]=e;const a=t.target.getBoundingClientRect().width;S(a)}));return t.observe(e),()=>t.disconnect()}),[]),(0,o.useEffect)((()=>(H.current.complete&&N(!0),()=>{N(!1)})),[l]),(0,o.useEffect)((()=>(j.current.complete&&T(!0),()=>{T(!1)})),[u]);const B=I&&L;(0,o.useEffect)((()=>{const e=e=>{const t=e||window.event,s=t.touches?t.touches[0].pageX:t.pageX,a=t.touches?t.touches[0].pageY:t.pageY,o=s-window.pageXOffset,n=a-window.pageYOffset,r=j.current.getBoundingClientRect();let i=w?o-r.left:n-r.top;const l=0+v/2,c=w?C-v/2:A-v/2;i<l&&(i=l),i>c&&(i=c),x(w?i/C:i/A),m&&m(w?i/C:i/A)},s=t=>{O(!0),"touches"in t||t.preventDefault(),e(t),window.addEventListener("mousemove",e),window.addEventListener("touchmove",e)},a=()=>{O(!1),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)},o=F.current;if(B){o.addEventListener("touchstart",s),window.addEventListener("touchend",a),r?(o.addEventListener("mousemove",e),o.addEventListener("mouseleave",a)):(o.addEventListener("mousedown",s),window.addEventListener("mouseup",a));const n=H.current.naturalHeight/H.current.naturalWidth,i=j.current.naturalHeight/j.current.naturalWidth,l="taller"===t?Math.max(n,i):Math.min(n,i);D(C\*l)}return()=>{o.removeEventListener("touchstart",s),window.removeEventListener("touchend",a),o.removeEventListener("mousemove",e),o.removeEventListener("mouseleave",a),o.removeEventListener("mousedown",s),window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}}),[B,t,A,C,w,r,v,y]);const z={container:{boxSizing:"border-box",position:"relative",width:"100%",height:`${A}px`,overflow:"hidden"},rightImage:i({clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},h),leftImage:i({clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},d),slider:{alignItems:"center",cursor:!r&&w?"ew-resize":!r&&!w&&"ns-resize",display:"flex",flexDirection:w?"column":"row",height:w?"100%":`${a}px`,justifyContent:"center",left:w?C\*k-a/2+"px":0,position:"absolute",top:w?0:A\*k-a/2+"px",width:w?`${a}px`:"100%"},line:{background:\_,boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",flex:"0 1 auto",height:w?"100%":`${v}px`,width:w?`${v}px`:"100%"},handleCustom:{alignItems:"center",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:"auto",justifyContent:"center",width:"auto"},handleDefault:{alignItems:"center",border:`${v}px solid ${\_}`,borderRadius:"100%",boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:`${a}px`,justifyContent:"center",width:`${a}px`,transform:w?"none":"rotate(90deg)"},leftArrow:{border:`inset ${.15\*a}px rgba(0,0,0,0)`,borderRight:`${.15\*a}px solid ${\_}`,height:"0px",marginLeft:`-${.25\*a}px`,marginRight:.25\*a+"px",width:"0px"},rightArrow:{border:`inset ${.15\*a}px rgba(0,0,0,0)`,borderLeft:`${.15\*a}px solid ${\_}`,height:"0px",marginRight:`-${.25\*a}px`,width:"0px"},leftLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",left:w?"5%":"50%",opacity:M?0:1,padding:"10px 20px",position:"absolute",top:w?"50%":"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},rightLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",opacity:M?0:1,padding:"10px 20px",position:"absolute",left:w?null:"50%",right:w?"5%":null,top:w?"50%":null,bottom:w?null:"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},leftLabelContainer:{clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,height:"100%",position:"absolute",width:"100%"},rightLabelContainer:{clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,height:"100%",position:"absolute",width:"100%"}};return n().createElement(n().Fragment,null,f&&!B&&n().createElement("div",{style:i({},z.container)},f),n().createElement("div",{style:i(i({},z.container),{},{display:B?"block":"none"}),ref:F,"data-testid":"container"},n().createElement("img",{onLoad:()=>T(!0),alt:g,"data-testid":"right-image",ref:j,src:u,style:z.rightImage}),n().createElement("img",{onLoad:()=>N(!0),alt:c,"data-testid":"left-image",ref:H,src:l,style:z.leftImage}),n().createElement("div",{style:z.slider},n().createElement("div",{style:z.line}),s?n().createElement("div",{style:z.handleCustom},s):n().createElement("div",{style:z.handleDefault},n().createElement("div",{style:z.leftArrow}),n().createElement("div",{style:z.rightArrow})),n().createElement("div",{style:z.line})),p&&n().createElement("div",{style:z.leftLabelContainer},n().createElement("div",{style:z.leftLabel},p)),b&&n().createElement("div",{style:z.rightLabelContainer},n().createElement("div",{style:z.rightLabel},b))))};e.exports=a})()},196:e=>{"use strict";e.exports=window.React}},s={};function a(e){var o=s[e];if(void 0!==o)return o.exports;var n=s[e]={exports:{}};return t[e](n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,s,o,n)=>{if(!s){var r=1/0;for(d=0;d<e.length;d++){for(var[s,o,n]=e[d],i=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(i=!1,n<r&&(r=n));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,o,n]},a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var o,n,[r,i,l]=s,c=0;if(r.some((t=>0!==e[t]))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(l)var d=l(a)}for(t&&t(s);c<r.length;c++)n=r[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=globalThis.webpackChunkoptimole\_wp=globalThis.webpackChunkoptimole\_wp||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var o=a.O(void 0,[431],(()=>a(646)));o=a.O(o~~)})(); |
  |  | 1 | (()=>{var e,t={976:(e,t,a)=>{"use strict";var o=a(196);const s=window.wp.element,l={setAutoConnect:e=>({type:"SET\_AUTO\_CONNECT",autoConnect:e}),setAPIKey:e=>({type:"SET\_API\_KEY",apiKey:e}),setAvailableApps:e=>({type:"SET\_AVAILABLE\_APPS",availableApps:e}),setIsConnected:e=>({type:"SET\_IS\_CONNECTED",isConnected:e}),setIsConnecting:e=>({type:"SET\_IS\_CONNECTING",isConnecting:e}),setIsLoading:e=>({type:"SET\_IS\_LOADING",isLoading:e}),sethasDashboardLoaded:e=>({type:"SET\_HAS\_DASHBOARD\_LOADED",hasDashboardLoaded:e}),setHasRestError:e=>({type:"SET\_HAS\_REST\_ERROR",hasRestError:e}),setHasValidKey:e=>({type:"SET\_HAS\_VALID\_KEY",hasValidKey:e}),setHasApplication:e=>({type:"SET\_HAS\_APPLICATION",hasApplication:e}),setUserData:e=>({type:"SET\_USER\_DATA",data:e}),setUserStatus:e=>({type:"SET\_USER\_STATUS",status:e}),setShowDisconnect:e=>({type:"SET\_SHOW\_DISCONNECT",showDisconnect:e}),setConflicts:e=>({type:"SET\_CONFLICTS",conflicts:e}),setOptimizedImages:e=>({type:"SET\_OPTIMIZED\_IMAGES",optimizedImages:e}),setSiteSettings:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:e}),setExtraVisits:e=>({type:"SET\_EXTRA\_VISITS",extraVisitsStatus:e}),setSampleRate:e=>({type:"SET\_SAMPLE\_RATE",sampleRate:e}),setTotalNumberOfImages:e=>({type:"SET\_TOTAL\_NUMBER\_OF\_IMAGES",totalNumberOfImages:e}),setProcessedImages:e=>({type:"SET\_PROCESSED\_IMAGES",processedImages:e}),setOffloadLibraryLink:e=>({type:"SET\_OFFLOAD\_LIBRARY\_LINK",offloadLibraryLink:e}),setRollbackLibraryLink:e=>({type:"SET\_ROLLBACK\_LIBRARY\_LINK",rollbackLibraryLink:e}),setLoadingRollback:e=>({type:"SET\_LOADING\_ROLLBACK",loadingRollback:e}),setLoadingSync:e=>({type:"SET\_LOADING\_SYNC",loadingSync:e}),setQueryArgs:e=>({type:"SET\_QUERY\_ARGS",queryArgs:e}),setErrorMedia:e=>({type:"SET\_ERROR\_MEDIA",errorMedia:e}),setEstimatedTime:e=>({type:"SET\_ESTIMATED\_TIME",estimatedTime:e}),setCheckedOffloadConflicts:e=>({type:"SET\_CHECKED\_OFFLOAD\_CONFLICTS",checkedOffloadConflicts:e}),setOffloadConflicts:e=>({type:"SET\_OFFLOAD\_CONFLICTS",offloadConflicts:e}),setLogs:(e,t)=>({type:"SET\_LOGS",logsType:e,logs:t}),setShowFinishNotice:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{show\_offload\_finish\_notice:e}}),setOffloadLimitReached:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offload\_limit\_reached:e}}),ensureOffloadingRollbackDisabled:()=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offloading\_status:"disabled",rollback\_status:"disabled"}}),setOffloadLimit:e=>({type:"SET\_OFFLOAD\_LIMIT",offloadLimit:e})},n={autoConnect:optimoleDashboardApp.auto\_connect,isConnected:"yes"===optimoleDashboardApp.connection\_status,isConnecting:!1,isLoading:!1,hasRestError:!1,hasValidKey:!0,hasApplication:"yes"===optimoleDashboardApp.has\_application,apiKey:optimoleDashboardApp.api\_key?optimoleDashboardApp.api\_key:"",userStatus:optimoleDashboardApp.user\_status?optimoleDashboardApp.user\_status:"inactive",userData:optimoleDashboardApp.user\_data?optimoleDashboardApp.user\_data:null,availableApps:optimoleDashboardApp.available\_apps?optimoleDashboardApp.available\_apps:null,hasDashboardLoaded:"yes"===optimoleDashboardApp.connection\_status,showDisconnect:!1,conflicts:[],optimizedImages:[],siteSettings:optimoleDashboardApp.site\_settings,sampleRate:{},totalNumberOfImages:0,processedImages:0,offloadLibraryLink:!1,rollbackLibraryLink:!1,loadingRollback:!1,loadingSync:!1,queryArgs:[],errorMedia:!1,checkedOffloadConflicts:!1,offloadConflicts:[],offloadLimit:optimoleDashboardApp.offload\_limit||5e4,logs:{offload:"",rollback:""}},r=(e=n,t)=>{switch(t.type){case"SET\_AUTO\_CONNECT":return{...e,autoConnect:t.autoConnect};case"SET\_HAS\_REST\_ERROR":case"SET\_HAS\_REST\_ERROR":return{...e,hasRestError:t.hasRestError};case"SET\_API\_KEY":return{...e,apiKey:t.apiKey};case"SET\_AVAILABLE\_APPS":return{...e,availableApps:t.availableApps};case"SET\_IS\_CONNECTED":return{...e,isConnected:t.isConnected};case"SET\_IS\_CONNECTING":return{...e,isConnecting:t.isConnecting};case"SET\_IS\_LOADING":return{...e,isLoading:t.isLoading};case"SET\_HAS\_DASHBOARD\_LOADED":return{...e,hasDashboardLoaded:t.hasDashboardLoaded};case"SET\_HAS\_VALID\_KEY":return{...e,hasValidKey:t.hasValidKey};case"SET\_HAS\_APPLICATION":return{...e,hasApplication:t.hasApplication};case"SET\_USER\_DATA":let a="inactive";const{data:o}=t;if(o&&o.app\_count&&1<=o.app\_count&&o.cdn\_key)for(let e of o.available\_apps)e.key&&e.key===o.cdn\_key&&e.status&&"active"===e.status&&(a="active");return{...e,userData:t.data,userStatus:a};case"SET\_USER\_STATUS":return{...e,userStatus:t.status};case"SET\_SHOW\_DISCONNECT":return{...e,showDisconnect:t.showDisconnect};case"SET\_CONFLICTS":return{...e,conflicts:t.conflicts};case"SET\_OPTIMIZED\_IMAGES":return{...e,optimizedImages:t.optimizedImages};case"SET\_SITE\_SETTINGS":let{siteSettings:s}=e;for(let e in t.siteSettings)s[e]=t.siteSettings[e];return{...e,siteSettings:s};case"SET\_EXTRA\_VISITS":{let{siteSettings:a}=e;return a.banner\_frontend=t.extraVisitsStatus?"enabled":"disabled",{...e,siteSettings:a}}case"SET\_SAMPLE\_RATE":return{...e,sampleRate:t.sampleRate};case"SET\_TOTAL\_NUMBER\_OF\_IMAGES":return{...e,totalNumberOfImages:t.totalNumberOfImages};case"SET\_PROCESSED\_IMAGES":return{...e,processedImages:t.processedImages};case"SET\_OFFLOAD\_LIBRARY\_LINK":return{...e,offloadLibraryLink:t.offloadLibraryLink};case"SET\_ROLLBACK\_LIBRARY\_LINK":return{...e,rollbackLibraryLink:t.rollbackLibraryLink};case"SET\_LOADING\_ROLLBACK":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.rollbackLibraryLink=!t.loadingSync),{...e,loadingRollback:t.loadingRollback};case"SET\_LOADING\_SYNC":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.offloadLibraryLink=!t.loadingSync),{...e,loadingSync:t.loadingSync};case"SET\_QUERY\_ARGS":return{...e,queryArgs:t.queryArgs};case"SET\_ERROR\_MEDIA":return{...e,errorMedia:t.errorMedia};case"SET\_CHECKED\_OFFLOAD\_CONFLICTS":return{...e,checkedOffloadConflicts:t.checkedOffloadConflicts};case"SET\_OFFLOAD\_CONFLICTS":return{...e,offloadConflicts:t.offloadConflicts};case"SET\_LOGS":let{logs:l}=e;return l[t.logsType]=t.logs,{...e,logs:l};case"SET\_OFFLOAD\_LIMIT":return{...e,offloadLimit:t.offloadLimit};default:return e}},i={getAutoConnect:e=>e.autoConnect,getAPIKey:e=>e.apiKey,getAvailableApps:e=>e.availableApps,hasRestError:e=>e.hasRestError,hasValidKey:e=>e.hasValidKey,hasApplication:e=>e.hasApplication,hasDashboardLoaded:e=>e.hasDashboardLoaded,getUserData:e=>e.userData,getUserStatus:e=>e.userStatus,isConnected:e=>e.isConnected,isConnecting:e=>e.isConnecting,isLoading:e=>e.isLoading,showDisconnect:e=>e.showDisconnect,getConflicts:e=>e.conflicts,getOptimizedImages:e=>e.optimizedImages,getSiteSettings:(e,t=void 0)=>t?void 0!==e.siteSettings[t]?e.siteSettings[t]:void 0:e.siteSettings,getSampleRate:e=>e.sampleRate,getTotalNumberOfImages:e=>e.totalNumberOfImages,getProcessedImages:e=>e.processedImages,getOffloadLibraryLink:e=>e.offloadLibraryLink,getRollbackLibraryLink:e=>e.rollbackLibraryLink,getLoadingRollback:e=>e.loadingRollback,getLoadingSync:e=>e.loadingSync,getQueryArgs:e=>e.queryArgs,getErrorMedia:e=>e.errorMedia,getCheckedOffloadConflicts:e=>e.checkedOffloadConflicts,getOffloadConflicts:e=>e.offloadConflicts,getOffloadLimit:e=>e.offloadLimit,getLogs:(e,t=void 0)=>t?void 0!==e.logs[t]?e.logs[t]:void 0:e.logs};if(void 0!==wp.data.createReduxStore){const e=wp.data.createReduxStore("optimole",{reducer:r,actions:l,selectors:i});wp.data.register(e)}else wp.data.registerStore("optimole",{reducer:r,actions:l,selectors:i});const c=window.wp.data;var d=a(184),p=a.n(d);const m=window.wp.primitives,g=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})),u=window.wp.components,h=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"20",viewBox:"0 0 21 20",fill:"none"},(0,o.createElement)("path",{d:"M17.357 2.92894C16.9664 2.53842 16.3333 2.53842 15.9427 2.92894C15.5522 3.31946 15.5522 3.95263 15.9427 4.34315L17.357 2.92894ZM16.6499 16.364L15.9427 17.0711H15.9427L16.6499 16.364ZM14.5285 5.75737C14.138 5.36684 13.5048 5.36684 13.1143 5.75737C12.7238 6.14789 12.7238 6.78106 13.1143 7.17158L14.5285 5.75737ZM13.8214 13.5355L13.1143 14.2426L13.1143 14.2427L13.8214 13.5355ZM6.04325 14.2427C6.43377 14.6332 7.06694 14.6332 7.45746 14.2427C7.84799 13.8521 7.84799 13.219 7.45746 12.8284L6.04325 14.2427ZM6.32586 10.5662C6.24822 10.0194 5.74201 9.63905 5.19521 9.71669C4.64841 9.79434 4.26808 10.3005 4.34573 10.8473L6.32586 10.5662ZM3.21482 17.0711C3.60535 17.4616 4.23851 17.4616 4.62903 17.0711C5.01956 16.6806 5.01956 16.0474 4.62903 15.6569L3.21482 17.0711ZM2.70292 7.44452C2.87885 6.921 2.59707 6.354 2.07355 6.17807C1.55004 6.00215 0.98303 6.28393 0.807105 6.80744L2.70292 7.44452ZM1.993 0.292893C1.60247 -0.0976311 0.969306 -0.0976311 0.578782 0.292893C0.188258 0.683417 0.188258 1.31658 0.578782 1.70711L1.993 0.292893ZM18.5788 19.7071C18.9693 20.0976 19.6025 20.0976 19.993 19.7071C20.3835 19.3166 20.3835 18.6834 19.993 18.2929L18.5788 19.7071ZM15.9427 4.34315C19.0669 7.46735 19.0669 12.5327 15.9427 15.6569L17.357 17.0711C21.2622 13.1658 21.2622 6.83418 17.357 2.92894L15.9427 4.34315ZM13.1143 7.17158C14.6764 8.73368 14.6764 11.2663 13.1143 12.8284L14.5285 14.2427C16.8717 11.8995 16.8717 8.10051 14.5285 5.75737L13.1143 7.17158ZM10.2859 10H12.2859C12.2859 8.89544 11.3905 8.00001 10.2859 8.00001V10ZM7.45746 12.8284C6.81978 12.1908 6.44341 11.394 6.32586 10.5662L4.34573 10.8473C4.52209 12.0894 5.08876 13.2882 6.04325 14.2427L7.45746 12.8284ZM4.62903 15.6569C2.40899 13.4368 1.76507 10.2354 2.70292 7.44452L0.807105 6.80744C-0.363267 10.2902 0.43743 14.2937 3.21482 17.0711L4.62903 15.6569ZM10.2859 10L10.2859 10V8.00001C9.73388 8.00001 9.23252 8.22496 8.87168 8.58578L10.2859 10ZM0.578782 1.70711L8.87168 10L10.2859 8.58579L1.993 0.292893L0.578782 1.70711ZM8.87168 10L10.2859 11.4142L11.7001 10L10.2859 8.58579L8.87168 10ZM10.2859 11.4142L13.1143 14.2426L14.5285 12.8284L11.7001 10L10.2859 11.4142ZM13.1143 14.2427L15.9427 17.0711L17.357 15.6569L14.5285 12.8284L13.1143 14.2427ZM15.9427 17.0711L18.5788 19.7071L19.993 18.2929L17.357 15.6569L15.9427 17.0711ZM10.2859 10L10.2859 10L11.7001 11.4142C12.0609 11.0534 12.2859 10.552 12.2859 10H10.2859Z",fill:"#E77777"})),b=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"16",viewBox:"0 0 21 16",fill:"none"},(0,o.createElement)("path",{d:"M4.00127 14.3639C0.486555 10.8492 0.486555 5.15071 4.00127 1.63599M16.7292 1.63599C20.2439 5.15071 20.2439 10.8492 16.7292 14.3639M6.8297 11.5355C4.87708 9.58286 4.87708 6.41704 6.8297 4.46441M13.9008 4.46441C15.8534 6.41704 15.8534 9.58286 13.9008 11.5355M11.3652 7.99995C11.3652 8.55223 10.9175 8.99995 10.3652 8.99995C9.81295 8.99995 9.36523 8.55223 9.36523 7.99995C9.36523 7.44766 9.81295 6.99995 10.3652 6.99995C10.9175 6.99995 11.3652 7.44766 11.3652 7.99995Z",stroke:"#6D955A","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),\_=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M46.6215 21.757C44.6278 22.9074 43.5209 25.0684 43.5415 27.3692C43.5415 27.4128 43.5415 27.4563 43.5415 27.4999C43.5415 27.5434 43.5415 27.5892 43.5415 27.6328C43.5209 29.9336 44.6278 32.0947 46.6215 33.2451L46.6399 33.2565C47.9943 34.038 49.7565 33.2657 50.043 31.728C50.5678 28.9047 50.5426 26.0378 50.0178 23.2717C49.7268 21.7386 47.9713 20.9778 46.6215 21.757V21.757Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M35.2025 41.5616C35.4065 41.4493 35.6081 41.3325 35.8075 41.211C37.7119 40.0514 40.1067 40.0721 42.0386 41.1881C43.3815 41.9627 43.6175 43.8556 42.4442 44.8685C40.3015 46.7202 37.815 48.1846 35.0879 49.1448C33.6213 49.6627 32.0881 48.5123 32.0881 46.9562C32.0881 44.731 33.2523 42.6364 35.2025 41.5616V41.5616Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9122 46.9357C22.9122 48.494 21.3745 49.633 19.9055 49.1196C17.2472 48.1915 14.7493 46.7798 12.5653 44.9098C11.3782 43.8923 11.5891 41.9834 12.9434 41.2019C14.8868 40.079 17.2953 40.0607 19.2157 41.2248C19.4128 41.344 19.6122 41.4609 19.8161 41.5709C21.7549 42.6365 22.9122 44.7219 22.9122 46.9357V46.9357Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M27.5 20.6256L34.3755 27.5011L27.5 34.3766L20.6245 27.5011L27.5 20.6256Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"})),f=(0,o.createElement)("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.9581 0C13.5192 0 17.2136 3.58 17.2136 8C17.2136 12.42 13.5192 16 8.9581 16C4.39696 16 0.702637 12.42 0.702637 8C0.702637 3.58 4.39696 0 8.9581 0ZM10.6558 9L11.0219 3H7.92606L8.29211 9H10.6558ZM11.0219 11.5115C11.0219 11.9809 10.8811 12.3473 10.6213 12.6107C10.3507 12.874 9.97188 13 9.48478 13C8.99768 13 8.61882 12.874 8.33739 12.6107C8.06677 12.3473 7.92606 11.9809 7.92606 11.5115C7.92606 11.0305 8.05595 10.6641 8.32656 10.4008C8.59717 10.1374 8.97603 10 9.48478 10C9.99353 10 10.3724 10.1374 10.6322 10.4008C10.892 10.6641 11.0219 11.0305 11.0219 11.5115Z",fill:"#AF3535"})),E=(0,o.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M17.25 8.25H21V4.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M3 12C3 7.029 7.029 3 12 3C15.63 3 18.751 5.154 20.174 8.25",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M6.75 15.75H3V19.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M21 12C21 16.971 16.971 21 12 21C8.37 21 5.249 18.846 3.826 15.75",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),v=(0,o.createElement)("svg",{width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M35.8621 13.647L22.0095 27.4996L15.085 20.5733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.5 22C38.5 31.1135 31.1135 38.5 22 38.5C12.8865 38.5 5.5 31.1135 5.5 22C5.5 12.8865 12.8865 5.5 22 5.5C24.6638 5.5 27.1718 6.14717 29.3993 7.26733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"})),y=(0,o.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M13 12L10 9M10 9L7 12M10 9L10 21",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),w=(0,o.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M7 18L10 21M10 21L13 18M10 21V9",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),k=(0,o.createElement)("svg",{width:"20",height:"18",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M10.0015 8V10M10.0015 14H10.0115M3.0733 18H16.9297C18.4693 18 19.4316 16.3333 18.6618 15L11.7336 3C10.9637 1.66667 9.03925 1.66667 8.26945 3L1.34125 15C0.571445 16.3333 1.5337 18 3.0733 18Z",stroke:"#DE9F0C","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),x=window.wp.apiFetch;var C=a.n(x);const S=window.wp.url,A=window.wp.notices,D=window.optimoleDashboardApp.submenu\_links,L=(e=!0)=>{const t=document.querySelector("li#toplevel\_page\_optimole");let a=document.querySelector("li#toplevel\_page\_optimole .wp-submenu");a||(a=document.createElement("ul"),a.classList.add("wp-submenu","wp-submenu-wrap"),t.classList.add("wp-has-submenu","wp-has-current-submenu","wp-menu-open"),t.appendChild(a)),e?(D.forEach((e=>{if(document.querySelector(`li#toplevel\_page\_optimole a[href="${e.href}"]`))return;const t=document.createElement("li"),o=document.createElement("a");o.href=e.href,o.innerHTML=e.text,t.appendChild(o),e.hash&&e.hash===window.location.hash&&(t.classList.add("current"),o.classList.add("current")),a.appendChild(t)})),a.style.display="block"):a.style.display="none"},{setIsConnected:N,setIsConnecting:T,setIsLoading:M,setHasRestError:I,setHasValidKey:O,setHasApplication:j,setAPIKey:F,setUserData:B,setAvailableApps:z,sethasDashboardLoaded:H,setShowDisconnect:R,setConflicts:P,setOptimizedImages:V,setSiteSettings:Z,setSampleRate:q,setCheckedOffloadConflicts:G,setOffloadConflicts:$,setLoadingSync:K,setLoadingRollback:U,setTotalNumberOfImages:Y,setProcessedImages:Q,setErrorMedia:W,setOffloadLibraryLink:J,setRollbackLibraryLink:X,setExtraVisits:ee,setLogs:te,setShowFinishNotice:ae,setOffloadLimitReached:oe,ensureOffloadingRollbackDisabled:se,setOffloadLimit:le}=(0,c.dispatch)("optimole"),{getOptimizedImages:ne,getQueryArgs:re,getTotalNumberOfImages:ie,getSiteSettings:ce}=(0,c.select)("optimole"),{createNotice:de}=(0,c.dispatch)(A.store),pe=(e={})=>{e.offset=void 0!==e.offset?e.offset:0,C()({path:optimoleDashboardApp.routes.upload\_onboard\_images,method:"POST",data:e}).then((t=>{!1===t.data&&1e3>e.offset&&pe({offset:e.offset+100}),"success"===t.code&&console.log("%c Images Crawled.","color: #59B278")})).catch((e=>(console.log("Error while crawling images",e),e.data)))},me=(e,t=(()=>{}))=>{T(!0),M(!0),I(!1),C()({path:optimoleDashboardApp.routes.register\_service,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(T(!1),M(!1),"success"===e.code&&(N(!0),O(!0),j(!0),F(e.data.api\_key),B(e.data),z(e.data),pe(),L(!0)),t&&t(e),e.data))).catch((e=>(T(!1),M(!1),I(!0),e.data)))},ge=()=>{M(!0),C()({path:optimoleDashboardApp.routes.disconnect,method:"GET",parse:!1}).then((e=>{M(!1),j(!1),F(""),B(null),z(null),e.ok?(N(!1),H(!1),R(!1),L(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")):console.error(e)}))},ue=()=>{M(!0),C()({path:optimoleDashboardApp.routes.request\_update,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{M(!1),e&&(B(e.data),void 0!==e?.data?.extra\_visits&&ee(e.data.extra\_visits),"disconnected"===e.code&&(N(!1),H(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")))}))},he=(e=(()=>{}))=>{if(0<ne().length)return console.log("%c Images already exist.","color: #59B278"),e&&e(),!1;C()({path:optimoleDashboardApp.routes.poll\_optimized\_images,method:"GET"}).then((t=>{"success"===t.code?(V(t.data),console.log("%c Images Fetched.","color: #59B278")):console.log("%c No images available.","color: #E7602A"),e&&e(t)})).catch((e=>(console.log("Error while polling images",e),e.data)))},be=(e,t=!1,a=!1,o=(()=>{}))=>{M(!0),C()({path:optimoleDashboardApp.routes.update\_option,method:"POST",data:{settings:e}}).then((e=>{M(!1),"success"===e.code&&(Z(e.data),a||ye(optimoleDashboardApp.strings.options\_strings.settings\_saved),console.log("%c Settings Saved.","color: #59B278"))})).then((()=>{t&&ue()})).then((()=>{o()})).catch((e=>(M(!1),ye(optimoleDashboardApp.strings.options\_strings.settings\_saved\_error),console.log("Error while saving settings",e),e.data)))},\_e=e=>{M(!0),C()({path:optimoleDashboardApp.routes.clear\_cache\_request,method:"POST",data:{type:e},parse:!1}).then((e=>(M(!1),200<=e.status&&300>e.status?(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared),void console.log("%c New cache token generated.","color: #59B278")):(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared\_error),void console.log("%c Could not generate cache token.","color: #E7602A")))))},fe=(e,t=(()=>{}))=>{C()({path:(0,S.addQueryArgs)(optimoleDashboardApp.routes.get\_sample\_rate,{quality:e.quality,force:e?.force||"no"}),method:"POST"}).then((e=>{"success"===e.code&&q(e.data),t&&t(e)}))},Ee=(e=(()=>{}))=>{C()({path:optimoleDashboardApp.routes.get\_offload\_conflicts,method:"GET"}).then((t=>{G(!0),0!==t.data.length&&$(t.data),e&&e(t)}))},ve=e=>{const t=re();"offload\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&J(!1),K(!0)),"rollback\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!1),U(!0)),M(!0);const a=void 0!==e.images?e.images:[];C()({path:optimoleDashboardApp.routes.number\_of\_images\_and\_pages,method:"POST",data:{action:e.action,refresh:e.refresh||!1,images:a},parse:!1}).then((t=>{if(200<=t.status&&300>t.status)return t.json();"offload\_images"===e.action&&(K(!1),M(!1)),"rollback\_images"===e.action&&(U(!1),M(!1))})).then((o=>{if(!o.data.count||0===o.data.count||!1===o.data.status)return console.log("%c No images available.","color: #E7602A"),K(!1),U(!1),M(!1),0===o.data.count&&(oe("disabled"),ae(o.data.action)),o.data.reached\_limit&&oe(o.data.reached\_limit?"enabled":"disabled"),o.data.offload\_limit&&le(o.data.offload\_limit),se(),be(ce(),!1),"offload\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&J(!0),void("rollback\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!0));let s=ie();e.refresh?(Q(0!==s?Math.abs(s-o.data.count):0),0!==o.data.count&&0===s&&Y(o.data.count)):Y(o.data.count),setTimeout((()=>{ve({action:e.action,refresh:!0,images:a})}),1e4)})).finally((()=>{var t;t="offload\_images"===e.action?"offload":"rollback",jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"optml\_fetch\_logs",nonce:optimoleDashboardApp.nonce,type:t},success:e=>{te(t,e)}})})).catch((t=>{W(e.action),K(!1),U(!1)}))},ye=e=>{de("info",e,{isDismissible:!0,type:"snackbar"})},we=({tab:e,setTab:t})=>{const[a,l]=(0,s.useState)(!1),{setShowDisconnect:n}=(0,c.useDispatch)("optimole"),{isConnected:r,isLoading:i,hasApplication:d,hasDashboardLoaded:m,hasConflicts:\_}=(0,c.useSelect)((e=>{const{isConnected:t,isLoading:a,hasApplication:o,hasDashboardLoaded:s,getConflicts:l}=e("optimole"),n=l();return{isConnected:t(),isLoading:a(),hasApplication:o(),hasDashboardLoaded:s(),hasConflicts:0<n.count||0}}));(0,s.useEffect)((()=>{\_&&l(!0)}),[\_]);const f=[{label:optimoleDashboardApp.strings.dashboard\_menu\_item,value:"dashboard"},{label:optimoleDashboardApp.strings.conflicts\_menu\_item,value:"conflicts",isDisabled:!a},{label:optimoleDashboardApp.strings.settings\_menu\_item,value:"settings"},{label:optimoleDashboardApp.strings.help\_menu\_item,value:"help"}],E=r&&d&&!m;return(0,o.createElement)("header",{className:"bg-white shadow-sm px-2.5 py-5 pb-0"},(0,o.createElement)("div",{className:"flex flex-col sm:flex-row justify-between items-center max-w-screen-xl mx-auto my-0 pb-5"},(0,o.createElement)("div",{className:"items-center flex justify-start cursor-default"},(0,o.createElement)("img",{className:"max-width-64 w-16 h-16 mr-3",src:`${optimoleDashboardApp.assets\_url}/img/logo.png`,alt:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details,title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details}),(0,o.createElement)("h3",{className:"text-gray-800 text-2 font-serif font-bold"},optimoleDashboardApp.strings.optimole)),(0,o.createElement)("div",{className:"flex items-center"},r?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.DropdownMenu,{icon:i||E?(0,o.createElement)(u.Icon,{icon:g,className:"animate-spin fill-success"}):(0,o.createElement)(u.Icon,{icon:b}),toggleProps:{className:"optml-header\_\_dropdown uppercase font-bold text-xs text-success hover:text-success active:text-success focus:text-success mr-3 border border-gray-300 rounded-md border-solid gap-2",iconPosition:"right"},popoverProps:{className:"optml-header\_\_dropdown\_\_popover"},text:E?optimoleDashboardApp.strings.connecting:optimoleDashboardApp.strings.connected,controls:[{title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.dashboard\_menu\_item,onClick:()=>window.open(optimoleDashboardApp.optimoleDashHome,"\_blank")},{title:optimoleDashboardApp.strings.refresh\_stats\_cta,onClick:ue,isDisabled:E},{title:optimoleDashboardApp.strings.disconnect\_btn,onClick:()=>n(!0),isDisabled:E}]})):(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"uppercase font-bold text-xs text-danger mr-3"},optimoleDashboardApp.strings.not\_connected),(0,o.createElement)(u.Icon,{icon:h})))),r&&d&&m&&(0,o.createElement)("ul",{className:"flex gap-8 items-center max-w-screen-xl mx-auto my-0 justify-center sm:justify-normal"},f.filter((e=>!e?.isDisabled)).map((({label:a,value:s})=>(0,o.createElement)("li",{key:s,className:p()("cursor-pointer text-purple-gray font-bold text-lg m-0 py-2 px-3 transition-colors duration-200 ease-in-out border-0 border-b-4 border-b-white border-solid",{"text-black !border-b-info":e===s}),onClick:()=>t(s)},a)))))},ke=()=>{const{setShowDisconnect:e}=(0,c.useDispatch)("optimole"),{isLoading:t}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}));return(0,o.createElement)(u.Modal,{title:optimoleDashboardApp.strings.disconnect\_title,className:"optml\_\_modal",onRequestClose:()=>e(!1)},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.disconnect\_desc}}),(0,o.createElement)("div",{className:"flex gap-2"},(0,o.createElement)(u.Button,{variant:"default",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>e(!1)},optimoleDashboardApp.strings.keep\_connected),(0,o.createElement)(u.Button,{isDestructive:!0,className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",isBusy:t,disabled:t,onClick:ge},optimoleDashboardApp.strings.disconnect\_btn)))},xe=({setMethod:e})=>{const[t,a]=(0,s.useState)(""),[l,n]=(0,s.useState)({}),[r,i]=(0,s.useState)(0),{setShowDisconnect:d}=(0,c.useDispatch)("optimole"),{availableApps:p,hasValidKey:m,isConnected:g,isConnecting:h,isLoading:b}=(0,c.useSelect)((e=>{const{getAvailableApps:t,hasValidKey:a,isConnected:o,isConnecting:s,isLoading:l}=e("optimole");return{availableApps:t(),hasValidKey:a(),isConnected:o(),isConnecting:s(),isLoading:l()}}));return(0,o.createElement)("div",{className:"text-2 font-bold m-0 text-gray-700"},(0,o.createElement)("div",{className:"text-gray-800 font-serif leading-7"},optimoleDashboardApp.strings.connect\_btn),(0,o.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.steps\_connect\_api\_desc}}),(0,o.createElement)("div",{className:"flex flex-col gap-8 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,o.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,o.createElement)(u.TextControl,{label:g?optimoleDashboardApp.strings.your\_api\_key:optimoleDashboardApp.strings.add\_api,placeholder:optimoleDashboardApp.strings.email,disabled:g,value:t,onChange:a,className:"optml\_\_input basis-4/5"}),g?(0,o.createElement)(u.Button,{variant:"default",isBusy:b,disabled:b,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:d},optimoleDashboardApp.strings.disconnect\_btn):(0,o.createElement)(u.Button,{variant:"primary",isBusy:h,disabled:h||0===t.length,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{n({}),((e,t=(()=>{}))=>{T(!0),M(!0),I(!1),C()({path:optimoleDashboardApp.routes.connect,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(T(!1),M(!1),"success"===e.code?(N(!0),O(!0),F(e.data.api\_key),void 0!==e.data.app\_count&&1<e.data.app\_count?z(e.data):(j(!0),B(e.data)),pe(),L(!0),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e),e.data))).catch((e=>(T(!1),M(!1),I(!0),e.data)))})({api\_key:t},(e=>{"success"!==e.code&&n({error\_connect:e.data})}))}},optimoleDashboardApp.strings.connect\_btn)),p&&(0,o.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,o.createElement)("div",{className:"basis-4/5"},(0,o.createElement)(u.SelectControl,{label:optimoleDashboardApp.strings.select+" "+optimoleDashboardApp.strings.your\_domain,value:r,options:p.available\_apps.map(((e,t)=>({label:e.domain,value:t}))),onChange:i,className:"optml\_\_select has\_large\_title",\_\_nextHasNoMarginBottom:!0})),(0,o.createElement)(u.Button,{variant:"primary",isBusy:h,disabled:h,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{((e,t=(()=>{}))=>{T(!0),I(!1),C()({path:optimoleDashboardApp.routes.select\_application,method:"POST",data:e}).then((e=>{T(!1),M(!1),"success"===e.code?(O(!0),j(!0),F(e.data.api\_key),B(e.data),z(e.data),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e)})).catch((e=>(T(!1),I(!0),e.data)))})({api\_key:t,application:null!=p&&void 0!==p.available\_apps?p.available\_apps[r].key:""},(e=>{"success"!==e.code&&n({error\_connect:e.data})}))}},optimoleDashboardApp.strings.select))),!m&&void 0!==l.error\_connect&&(0,o.createElement)("p",{className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:l.error\_connect}}),(0,o.createElement)("div",{className:"text-center py-3"},(0,o.createElement)(u.Button,{variant:"link",onClick:()=>e("email")},optimoleDashboardApp.strings.back\_to\_connect)))},Ce="optml-connect flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md",Se="flex gap-8 p-8 flex-col md:flex-row",Ae=()=>(0,o.createElement)("div",{className:"bg-danger text-white rounded relative px-6 py-5 mb-0 m-12",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_api\_not\_working}}),De=()=>{const[e,t]=(0,s.useState)(optimoleDashboardApp.current\_user.email),[a,l]=(0,s.useState)("email"),[n,r]=(0,s.useState)({}),{setAutoConnect:i}=(0,c.useDispatch)("optimole"),{autoConnect:d,hasRestError:p,isConnecting:m}=(0,c.useSelect)((e=>{const{getAutoConnect:t,hasRestError:a,isConnecting:o}=e("optimole");return{autoConnect:t(),hasRestError:a(),isConnecting:o()}}));return(0,s.useEffect)((()=>{"no"!==d&&me({email:d,auto\_connect:!0},(e=>{i("no"),"email\_registered"!==e.code?"site\_exists"!==e.code?"success"!==e.code&&e.message&&r({error\_autoconnect:e.message}):r({site\_exists:e.message}):r({email\_registered:e.message})}))}),[]),(0,s.useEffect)((()=>{(0===e.length||(0,S.isEmail)(e))&&n.invalid\_email&&(delete n.invalid\_email,r(n))}),[e]),"key"===a?(0,o.createElement)("div",{className:Ce},p&&(0,o.createElement)(Ae,null),(0,o.createElement)("div",{className:Se},(0,o.createElement)(xe,{setMethod:l}))):(0,o.createElement)("div",{className:Ce},p&&(0,o.createElement)(Ae,null),(0,o.createElement)("div",{className:Se},(0,o.createElement)("div",{className:"optml-connect\_\_content basis-8/12"},(0,o.createElement)("div",{className:"text-gray-700 font-serif text-2 font-bold leading-7 m-0"},optimoleDashboardApp.strings.account\_needed\_heading),(0,o.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_title}}),(0,o.createElement)("div",{className:"flex py-3"},(0,o.createElement)(u.Icon,{icon:"yes-alt"}),(0,o.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_1}})),(0,o.createElement)("div",{className:"flex py-3"},(0,o.createElement)(u.Icon,{icon:"yes-alt"}),(0,o.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_2}}))),(0,o.createElement)("div",{className:"optml-connect\_\_form basis-4/12 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.email\_address\_label,placeholder:optimoleDashboardApp.strings.email,value:e,onChange:t,className:"optml\_\_input",onBlur:()=>{0===e.length||(0,S.isEmail)(e)||r({invalid\_email:optimoleDashboardApp.strings.invalid\_email})}}),0<Object.keys(n).length&&Object.keys(n).map((e=>(0,o.createElement)("p",{key:e,className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:n[e]}})))||(0,o.createElement)("br",null),(0,o.createElement)(u.Button,{variant:"primary",isBusy:m,disabled:m||0===e.length||!(0,S.isEmail)(e),className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40",onClick:()=>{r({}),me({email:e},(e=>{"email\_registered"!==e.code?"site\_exists"!==e.code?"domain\_not\_accessible"!==e.code?"success"!==e.code&&r({error\_register:optimoleDashboardApp.strings.error\_register}):r({domain\_not\_accessible:e.message}):r({site\_exists:e.message}):r({email\_registered:e.message})}))}},optimoleDashboardApp.strings.register\_btn),(0,o.createElement)("br",null),(0,o.createElement)("br",null),(0,o.createElement)("div",{className:"base-control-label"},optimoleDashboardApp.strings.existing\_user),(0,o.createElement)(u.Button,{variant:"secondary",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>l("key")},optimoleDashboardApp.strings.api\_exists),(0,o.createElement)("p",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.signup\_terms}}))),(0,o.createElement)("div",{className:"bg-grayish-blue text-gray-800 text-center font-bold uppercase p-2.5 rounded-b-lg"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_footer}})))},Le=({value:e,max:t=100,className:a,...s})=>{const l=Math.round(e/t\*100),n=(s.background,p()("w-full h-2.5 border rounded-md border-solid bg-white border-light-gray relative overflow-hidden",a));return(0,o.createElement)("div",{className:n,role:"progressbar","aria-valuemin":"0","aria-valuemax":t,"aria-valuenow":e,...s},(0,o.createElement)("div",{className:"absolute left-0 h-full bg-info",style:{width:`${l}%`}}))},Ne=[optimoleDashboardApp.strings.options\_strings.connect\_step\_0,optimoleDashboardApp.strings.options\_strings.connect\_step\_1,optimoleDashboardApp.strings.options\_strings.connect\_step\_2,optimoleDashboardApp.strings.options\_strings.connect\_step\_3],Te=()=>{const[e,t]=(0,s.useState)(0),[a,l]=(0,s.useState)(0),[n,r]=(0,s.useState)(0),{sethasDashboardLoaded:i}=(0,c.useDispatch)("optimole");(0,s.useEffect)((()=>{n<=25&&setTimeout((()=>{d()}),1e3)}),[n]);const d=()=>{if(r(n+1),n>=25)return i(!0),r(0),l(0),void t(0);t(Math.floor(n/25\*100)),e>30\*(a+1)&&l(a+1)};return(0,o.createElement)("div",{className:"optml-connecting flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md"},(0,o.createElement)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-5 px-8 sm:px-0 py-24"},(0,o.createElement)("img",{className:"max-w-full",src:optimoleDashboardApp.assets\_url+"img/connecting.png"}),(0,o.createElement)("div",{className:"text-center md:text-left"},(0,o.createElement)("div",{className:"font-bold text-2xl"},optimoleDashboardApp.strings.account\_connecting\_title),(0,o.createElement)("div",{className:"text-base"},optimoleDashboardApp.strings.account\_connecting\_subtitle),(0,o.createElement)(Le,{className:"mt-2.5 mb-1.5 mx-0 h-5 border-gray-200",value:n,max:25,background:"#e6e6e6"}),(0,o.createElement)("div",{className:"text-xs"},Ne[a]+" ("+e+"%)"))))},Me=function(){const[e,t]=(0,o.useState)(null),[a,s]=(0,o.useState)({width:0,height:0}),l=(0,o.useCallback)((()=>{s({width:(null==e?void 0:e.offsetWidth)||0,height:(null==e?void 0:e.offsetHeight)||0})}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]);return Ie("resize",l),Oe((()=>{l()}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]),[t,a]},Ie=function(e,t,a,s){const l=(0,o.useRef)(t);Oe((()=>{l.current=t}),[t]),(0,o.useEffect)((()=>{var t;const o=null!==(t=null==a?void 0:a.current)&&void 0!==t?t:window;if(!o||!o.addEventListener)return;const n=e=>l.current(e);return o.addEventListener(e,n,s),()=>{o.removeEventListener(e,n,s)}}),[e,a,s])},Oe="undefined"!=typeof window?o.useLayoutEffect:o.useEffect,je="yes"!==optimoleDashboardApp.connection\_status,Fe=({src:e,oldSize:t,newSize:a})=>{const[s,{width:l}]=Me();return(0,o.createElement)("div",{className:"basis-1/4"},(0,o.createElement)("img",{src:e,className:"w-full border border-slate-200 rounded-md border-solid",style:{height:l},ref:s}),(0,o.createElement)("p",{className:"optml\_\_bullet w-full h-4"},(()=>{let e=(100\*(1-a/t)).toFixed(1);return 1>e?"1":100<e?(Math.floor(e/10+10)/10).toFixed(1).toString():e.toString()})(),"% ",optimoleDashboardApp.strings.latest\_images.saved," "))},Be=()=>{const[e,{width:t}]=Me();return(0,o.createElement)("div",{className:"basis-1/4"},(0,o.createElement)("div",{className:"optml\_\_loader w-full rounded-md",style:{height:t},ref:e}),(0,o.createElement)("p",{className:"optml\_\_loader w-full h-4"}))},ze=()=>{const[e,t]=(0,s.useState)(!1),[a,l]=(0,s.useState)(0),[n,r]=(0,s.useState)(0),[i,d]=(0,s.useState)(0);(0,s.useEffect)((()=>{i<=20&&setTimeout((()=>{m()}),1e3)}),[i]);const{images:p}=(0,c.useSelect)((e=>{const{getOptimizedImages:t}=e("optimole");return{images:t()||[]}}));(0,s.useEffect)((()=>{8<=p.length?t(!0):e||je||he((()=>{t(!0)}))}),[]);const m=()=>{d(i+1),i>=20?he((()=>{t(!0),d(0),r(0),l(0),ue()})):(l(Math.floor(i/20\*100)),a>30\*(n+1)&&r(n+1))};return(0,o.createElement)("div",{className:"hidden lg:block pt-5 border-grayish-blue border-0 border-t-2 border-solid"},(0,o.createElement)("h3",{className:"text-base m-0"},optimoleDashboardApp.strings.latest\_images.last," ",optimoleDashboardApp.strings.latest\_images.optimized\_images),je&&!e&&(0,o.createElement)("div",{className:"flex items-center flex-col py-2"},(0,o.createElement)("p",{className:"font-semibold"},optimoleDashboardApp.strings.latest\_images.loading\_latest\_images),(0,o.createElement)(Le,{max:20,value:i})),!je&&!e&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,o.createElement)(Be,null)))),(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,o.createElement)(Be,null))))),e&&4>p?.length&&(0,o.createElement)("div",{className:"text-center py-12"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.latest\_images.no\_images\_found}})),e&&4<=p?.length&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(0,o.createElement)(Fe,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))),8<=p?.length&&(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(t+=4,(0,o.createElement)(Fe,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))))))},He="flex p-6 bg-light-blue border border-blue-300 rounded-md",Re=[{label:optimoleDashboardApp.strings.metrics.metricsTitle1,description:optimoleDashboardApp.strings.metrics.metricsSubtitle1,value:"images\_number",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M42.0235 45.3568L45.0279 46.6928C46.5427 47.3666 48.25 46.2574 48.25 44.5982V10.402C48.25 8.74281 46.5427 7.63364 45.0279 8.30739L42.0235 9.64343C32.8569 13.718 22.3931 13.718 13.2265 9.64343L10.2221 8.30739C8.70729 7.63364 7 8.74281 7 10.402V44.5982C7 46.2574 8.70729 47.3666 10.2221 46.6928L13.2265 45.3568C22.3931 41.2845 32.8569 41.2845 42.0235 45.3568Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M34.5002 35.5209H20.7502C19.4852 35.5209 18.4585 34.4942 18.4585 33.2292V21.7709C18.4585 20.5059 19.4852 19.4792 20.7502 19.4792H34.5002C35.7652 19.4792 36.7918 20.5059 36.7918 21.7709V33.2292C36.7918 34.4942 35.7652 35.5209 34.5002 35.5209Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.9707 25.0939L36.7915 29.8376",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.9711 25.0939L26.0669 30.2043",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M26.0665 30.2043L23.3853 28.4167",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M23.3856 28.4167L18.4585 32.5647",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle2,description:optimoleDashboardApp.strings.metrics.metricsSubtitle2,value:"saved\_size",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"56",height:"55",viewBox:"0 0 56 55",fill:"none"},(0,o.createElement)("path",{d:"M36.681 6.875H13.7643C8.70203 6.875 4.59766 10.9794 4.59766 16.0417C4.59766 21.104 8.70203 25.2083 13.7643 25.2083H36.681C41.7433 25.2083 45.8477 21.104 45.8477 16.0417C45.8477 10.9794 41.7433 6.875 36.681 6.875Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.7643 25.2084C8.70203 25.2084 4.59766 29.3127 4.59766 34.375C4.59766 39.4373 8.70203 43.5417 13.7643 43.5417H29.806",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9307 16.0416H36.6807",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.845 15.9606C13.8898 16.0053 13.8898 16.0779 13.845 16.1226C13.8003 16.1674 13.7277 16.1674 13.683 16.1226C13.6382 16.0779 13.6382 16.0053 13.683 15.9606C13.7277 15.9158 13.8003 15.9158 13.845 15.9606Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9307 34.375H27.7432",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.845 34.2938C13.8898 34.3386 13.8898 34.4111 13.845 34.4559C13.8003 34.5006 13.7277 34.5006 13.683 34.4559C13.6382 34.4111 13.6382 34.3386 13.683 34.2938C13.7277 34.2491 13.8003 34.2491 13.845 34.2938Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.9725 48.125C32.6452 48.125 27.5142 42.994 27.5142 36.6667C27.5142 30.3394 32.6452 25.2084 38.9725 25.2084C45.3021 25.2084 50.4308 30.3394 50.4308 36.6667C50.4308 42.994 45.3021 48.125 38.9725 48.125Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M40.2465 31.5745L36.4263 35.3924L41.5184 37.9407L37.6981 41.7586",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle3,description:optimoleDashboardApp.strings.metrics.metricsSubtitle3,value:"compression\_percentage",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M43.5418 32.0833C41.0095 32.0833 38.9585 30.0323 38.9585 27.5C38.9585 24.9677 41.0095 22.9166 43.5418 22.9166C46.0741 22.9166 48.1252 24.9677 48.1252 27.5C48.1252 30.0323 46.0741 32.0833 43.5418 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0832 43.5417C32.0832 46.074 30.0321 48.1251 27.4998 48.1251C24.9675 48.1251 22.9165 46.074 22.9165 43.5417C22.9165 41.0094 24.9675 38.9584 27.4998 38.9584C30.0321 38.9584 32.0832 41.0094 32.0832 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M43.5418 48.1251C41.0095 48.1251 38.9585 46.074 38.9585 43.5417C38.9585 41.0094 41.0095 38.9584 43.5418 38.9584C46.0741 38.9584 48.1252 41.0094 48.1252 43.5417C48.1252 46.074 46.0741 48.1251 43.5418 48.1251Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M27.4998 16.0417C24.9675 16.0417 22.9165 13.9906 22.9165 11.4583C22.9165 8.92604 24.9675 6.875 27.4998 6.875C30.0321 6.875 32.0832 8.92604 32.0832 11.4583C32.0832 13.9906 30.0321 16.0417 27.4998 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.9585 11.4583C38.9585 8.92604 41.0095 6.875 43.5418 6.875C46.0741 6.875 48.1252 8.92604 48.1252 11.4583C48.1252 13.9906 46.0741 16.0417 43.5418 16.0417C41.0095 16.0417 38.9585 13.9906 38.9585 11.4583Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.7314 40.3104L40.3106 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M14.6895 40.3104L24.2686 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.7314 24.2687L40.3106 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9165 27.5C22.9165 24.9677 24.9675 22.9166 27.4998 22.9166C30.0321 22.9166 32.0832 24.9677 32.0832 27.5C32.0832 30.0323 30.0321 32.0833 27.4998 32.0833C24.9675 32.0833 22.9165 30.0323 22.9165 27.5Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M14.6895 24.2687L24.2686 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M11.4583 32.0833C8.92604 32.0833 6.875 30.0323 6.875 27.5C6.875 24.9677 8.92604 22.9166 11.4583 22.9166C13.9906 22.9166 16.0417 24.9677 16.0417 27.5C16.0417 30.0323 13.9906 32.0833 11.4583 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M16.0417 43.5417C16.0417 46.074 13.9906 48.1251 11.4583 48.1251C8.92604 48.1251 6.875 46.074 6.875 43.5417C6.875 41.0094 8.92604 38.9584 11.4583 38.9584C13.9906 38.9584 16.0417 41.0094 16.0417 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M11.4583 16.0417C8.92604 16.0417 6.875 13.9906 6.875 11.4583C6.875 8.92604 8.92604 6.875 11.4583 6.875C13.9906 6.875 16.0417 8.92604 16.0417 11.4583C16.0417 13.9906 13.9906 16.0417 11.4583 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle4,description:optimoleDashboardApp.strings.metrics.metricsSubtitle4,value:"traffic",icon:()=>(0,o.createElement)("svg",{width:"55",height:"55",viewBox:"0 0 64 64",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false"},(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667M24 32h10.667",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48M42.667 16H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48M42.667 26.667H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48M42.667 37.333H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48M42.667 48H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}))}],Pe=()=>(0,o.createElement)("div",{className:"flex gap-2 bg-warning text-danger border border-solid border-danger rounded relative px-6 py-5 mb-5"},(0,o.createElement)(u.Icon,{icon:f}),(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_disabled\_account}})),Ve=()=>(0,o.createElement)("div",{className:"flex gap-2 bg-success text-white rounded relative px-6 py-5 mb-5"},(0,o.createElement)(u.Icon,{icon:"cloud-saved"}),(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_just\_activated}})),Ze=()=>{const{userData:e,userStatus:t}=(0,c.useSelect)((e=>{const{getUserData:t,getUserStatus:a}=e("optimole");return{userData:t(),userStatus:a()}})),a=(e.visitors/e.visitors\_limit\*100).toFixed(0);return(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},0<optimoleDashboardApp.strings.notice\_just\_activated.length&&"active"===t&&(0,o.createElement)(Ve,null),"inactive"===t&&(0,o.createElement)(Pe,null),(0,o.createElement)("div",{className:p()(He,"gap-8 flex-col sm:flex-row items-start sm:items-center")},(0,o.createElement)(u.Icon,{icon:\_}),(0,o.createElement)("div",{className:"flex w-full flex-col"},(0,o.createElement)("div",{className:"flex w-full justify-between"},(0,o.createElement)("div",{className:"text-gray-800 text-2xl font-bold"},e.visitors\_pretty," / ",e.visitors\_limit\_pretty,(0,o.createElement)("span",{className:"text-gray-600 text-base font-normal ml-2"},optimoleDashboardApp.strings.quota)),70>a&&(0,o.createElement)(u.Button,{variant:"default",className:"optml\_\_button rounded font-bold min-h-40",href:optimoleDashboardApp.optimoleDashBilling,target:"\_blank"},optimoleDashboardApp.strings.upgrade.title)),(0,o.createElement)("div",null,(0,o.createElement)(Le,{className:"mt-2.5 mb-3 mx-0",value:e.visitors,max:e.visitors\_limit}),(0,o.createElement)("div",{className:"optml\_\_tooltip",style:{left:a+"%",marginLeft:15>a?"-15px":"-20px",display:100<a?"none":"block"}},(0,o.createElement)("span",null,a,"%"))))),(0,o.createElement)("div",{className:"flex py-5 gap-5 flex-col md:flex-row"},Re.map((t=>(0,o.createElement)("div",{key:t.value,className:p()(He,"basis-1/4 flex-col items-start")},(0,o.createElement)(u.Icon,{icon:t.icon}),(0,o.createElement)("div",{className:"flex w-full flex-col"},(0,o.createElement)("div",{className:"not-italic font-bold text-xl py-2 text-gray-800"},(t=>{const a=(t=>void 0!==e[t]?e[t]:"saved\_size"===t?Math.floor(2500\*Math.random())+500:Math.floor(40\*Math.random())+10)(t);return"saved\_size"===t?(a/1e3).toFixed(2)+"MB":"compression\_percentage"===t?a.toFixed(2)+"%":"traffic"===t?a.toFixed(2)+"MB":a})(t.value)),(0,o.createElement)("div",{className:"not-italic font-normal text-sm text-gray-800"},t.label),(0,o.createElement)("div",{className:"font-normal text-xs text-gray-600"},t.description)))))),"yes"!==optimoleDashboardApp.remove\_latest\_images&&(0,o.createElement)(ze,null))},qe=({conflict:e})=>{const[t,a]=(0,s.useState)(!1);return(0,o.createElement)("div",{className:p()("flex gap-2 text-white rounded relative px-6 py-5 mb-5",{"bg-danger":"high"===e.severity,"bg-info":"medium"===e.severity,"bg-success":"high"!==e.severity&&"medium"!==e.severity})},(0,o.createElement)("p",{className:"m-0 text-white",dangerouslySetInnerHTML:{\_\_html:e.message}}),(0,o.createElement)(u.Button,{icon:t?g:"no-alt",label:optimoleDashboardApp.strings.conflicts.conflict\_close,disabled:t,className:p()("text-white hover:text-white",{"animate-spin":t}),onClick:()=>{a(!0),((e,t=(()=>{}))=>{M(!0),C()({path:optimoleDashboardApp.routes.dismiss\_conflict,method:"POST",data:{conflictID:e}}).then((e=>{M(!1),"success"===e.code&&P(e.data),t&&t(e)}))})(e.id,(()=>{a(!1)}))}}))},Ge=()=>{const{conflicts:e}=(0,c.useSelect)((e=>{const{getConflicts:t}=e("optimole");return{conflicts:t().conflicts||[]}}));return(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},Boolean(e.length)&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("p",null,optimoleDashboardApp.strings.conflicts.title),e.map((e=>(0,o.createElement)(qe,{key:e.id,conflict:e})))),!Boolean(e.length)&&(0,o.createElement)("div",{className:"text-center py-12"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.conflicts.no\_conflicts\_found}})))},$e=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),Ke=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),{strings:Ue}=optimoleDashboardApp,Ye=[{label:Ue.general\_settings\_menu\_item,value:"general"},{label:Ue.advanced\_settings\_menu\_item,value:"compression",children:[{label:Ue.settings\_compression\_menu\_item,value:"compression"},{label:Ue.settings\_resize\_menu\_item,value:"resize"},{label:Ue.lazyload\_settings\_menu\_item,value:"lazyload"},{label:Ue.settings\_exclusions\_menu\_item,value:"exclusions"}]},{label:Ue.cloud\_library,value:"cloud\_library"},{label:Ue.image\_storage,value:"offload\_media"}],Qe=({children:e,tab:t,settings:a,setTab:s})=>(0,o.createElement)("ul",{className:"flex flex-col gap-1 m-0 mt-1"},e.map((e=>{const{value:l,label:n}=e;if("lazyload"===e.value&&"disabled"===a.lazyload)return;const r=p()({"bg-light-blue hover:text-purple-gray":t===l,"bg-transparent hover:text-info":t!==l},"w-full text-left border-0 font-normal text-base text-purple-gray cursor-pointer rounded px-4 py-2 m-0 hover:text-info");return(0,o.createElement)("li",{key:l},(0,o.createElement)("button",{className:r,onClick:()=>s(l)},n))}))),We=({tab:e,settings:t,setTab:a})=>(0,o.createElement)("div",{className:"basis-1/5"},(0,o.createElement)("ul",{className:"grid m-0 gap-1"},Ye.map((s=>{const l=e===s.value||s.children&&s.children.some((t=>t.value===e)),n=p()({"!text-info":l},"w-full bg-transparent border-0 flex items-center appearance-none not-italic font-semibold text-base text-purple-gray cursor-pointer hover:text-info py-2");return(0,o.createElement)("li",{key:s.value,className:"m-0"},(0,o.createElement)("button",{className:n,onClick:()=>a(s.value)},s.label,s.children&&(0,o.createElement)(u.Icon,{icon:l?$e:Ke,className:"inline-block ml-2 fill-current"})),s.children&&l&&(0,o.createElement)(Qe,{children:s.children,tab:e,settings:t,setTab:a}))})))),Je=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,o.createElement)(m.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),Xe=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),et=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),tt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),at=(0,s.forwardRef)((function({icon:e,size:t=24,...a},o){return(0,s.cloneElement)(e,{width:t,height:t,...a,ref:o})})),ot=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}));function st({text:e,title:t,disableIcon:a=!1,type:s="info",className:l="",smallTitle:n=!1,children:r,onDismiss:i}){const c=p()({"bg-yellow-50 text-yellow-700":"warning"===s,"bg-green-50 text-green-700":"success"===s,"bg-red-50 text-red-700":"error"===s,"bg-blue-50 text-blue-700":"info"===s,"bg-info text-white":"primary"===s},`rounded-md my-5 text-sm p-4 om-notice om-notice-${s} relative`),d=p()({"fill-yellow-500":"warning"===s,"fill-green-500":"success"===s,"fill-red-500":"error"===s,"fill-blue-500":"info"===s,"fill-white":"primary"===s,"h-6 w-6":"primary"!==s,"h-12 w-12":"primary"===s}),m=p()({"ml-3 mt-0.5":!a&&!t,"mt-2 mx-1.5":t}),g=p()({"text-yellow-800":"warning"===s,"text-green-800":"success"===s,"text-red-800":"error"===s,"text-blue-800":"info"===s,"font-bold text-base":"primary"!==s,"text-white text-sm":"primary"===s,"text-s":n},"m-0"),u={warning:Je,success:Xe,error:et,info:tt,primary:v};return(0,o.createElement)("div",{className:c},i&&(0,o.createElement)("button",{className:"flex items-center justify-center absolute bg-transparent text-current right-1 top-1 border-0 rounded-full p-0 cursor-pointer hover:bg-white transition-all hover:text-info",onClick:i},(0,o.createElement)(at,{className:"fill-current",icon:ot})),(0,o.createElement)("div",{className:t?"grid":"flex"},(0,o.createElement)("div",{className:p()("flex-shrink-0 flex gap-2",{"items-center":t})},!a&&(0,o.createElement)(at,{icon:u[s]||null,className:d}),t&&(0,o.createElement)("div",{className:g,dangerouslySetInnerHTML:{\_\_html:t}})),r||e&&(0,o.createElement)("div",{className:m},e&&(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:e}}),r)))}const lt=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:s}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),l="disabled"!==e.image\_replacer,n="disabled"!==e.lazyload,r="disabled"!==e.report\_script,i="disabled"!==e.cdn,d="disabled"!==e.banner\_frontend,m=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_image\_replace,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.replacer\_desc}}),checked:l,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("image\_replacer",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_lazyload,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.lazyload\_desc}}),checked:n,disabled:!l||s,className:p()({"is-disabled":!l||s}),onChange:e=>m("lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_report\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_report\_desc}}),checked:r,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("report\_script",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_badge\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_badge\_description}}),checked:d,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("banner\_frontend",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.cache\_title,className:p()({"is-disabled":s||!l})},(0,o.createElement)("p",{className:"components-base-control\_\_help m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cache\_desc}}),(0,o.createElement)("div",{className:"flex my-4 gap-3"},(0,o.createElement)(u.Button,{variant:"default",isBusy:s,disabled:s||!l,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>\_e()},optimoleDashboardApp.strings.options\_strings.clear\_cache\_images),i&&(0,o.createElement)(u.Button,{variant:"default",isBusy:s,disabled:s||!l,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>\_e("assets")},optimoleDashboardApp.strings.options\_strings.clear\_cache\_assets))),(0,o.createElement)(st,{type:"warning",text:optimoleDashboardApp.strings.options\_strings.clear\_cache\_notice,disableIcon:!0}))};var nt=a(864),rt=a.n(nt);const it=({settings:e,setSettings:t,setCanSave:a,showSample:s,isSampleLoading:l,setIsSampleLoading:n})=>{const{sampleImages:r,isLoading:i}=(0,c.useSelect)((e=>{const{getSampleRate:t,isLoading:a}=e("optimole");return{sampleImages:t(),isLoading:a()}})),d="disabled"!==e.network\_optimization,m="disabled"!==e.cdn,h="disabled"!==e.img\_to\_video,b="disabled"!==e.avif,\_="disabled"!==e.strip\_metadata,f="disabled"!==e.autoquality,E="disabled"!==e.best\_format,v=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},y=()=>r.optimized\_size>r.original\_size?Math.floor(60\*Math.random())+10:(100\*parseFloat(r.optimized\_size/r.original\_size)).toFixed(0);return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.best\_format\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.best\_format\_desc}}),checked:E,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("best\_format",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_desc}}),checked:d,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("network\_optimization",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_cdn,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cdn\_desc}}),checked:m,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("cdn",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_gif\_replace\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.gif\_replacer\_desc}}),checked:h,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("img\_to\_video",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_avif\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_avif\_desc}}),checked:b,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("avif",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.strip\_meta\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.strip\_meta\_desc}}),checked:\_,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("strip\_metadata",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{help:!f&&optimoleDashboardApp.strings.options\_strings.quality\_desc},(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.quality\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.ml\_quality\_desc}}),checked:f,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("autoquality",e)})),!f&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.RangeControl,{value:(w=e.quality,"number"==typeof w?w:"auto"===w||"high\_c"===w?90:"medium\_c"===w?75:"low\_c"===w?55:90),min:50,max:100,step:1,withInputField:!1,marks:[{value:55,label:optimoleDashboardApp.strings.options\_strings.low\_q\_title},{value:75,label:optimoleDashboardApp.strings.options\_strings.medium\_q\_title},{value:90,label:optimoleDashboardApp.strings.options\_strings.high\_q\_title}],onChange:o=>{a(!0);const s={...e};s.quality=o,t(s)}}),s&&(0,o.createElement)("div",{className:"flex justify-center w-full text-center"},l?(0,o.createElement)("div",{className:"flex items-center gap-5"},(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.sample\_image\_loading),(0,o.createElement)(u.Icon,{icon:g,className:"animate-spin"})):(0,o.createElement)(o.Fragment,null,r.id&&0<r.original\_size&&(0,o.createElement)("div",null,0<y()?(0,o.createElement)("p",{className:"text-base"},100-y(),"% ",optimoleDashboardApp.strings.latest\_images.smaller):(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.latest\_images.same\_size),(0,o.createElement)(Le,{max:100,value:100-y()}),(0,o.createElement)("hr",{className:"my-4 border-grayish-blue"}),(0,o.createElement)(rt(),{leftImageLabel:optimoleDashboardApp.strings.options\_strings.image\_1\_label,rightImageLabel:optimoleDashboardApp.strings.options\_strings.image\_2\_label,leftImage:r.original,rightImage:r.optimized}),(0,o.createElement)(u.Button,{variant:"default",icon:g,className:"mt-2",onClick:()=>{n(!0),fe({quality:e.quality,force:"yes"},(()=>n(!1)))}}),(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.quality\_slider\_desc)),!(r.id&&0<r.original\_size)&&0>r.id&&(0,o.createElement)("div",{className:"flex items-center gap-5 text-center"},(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.no\_images\_found))))));var w},ct=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[n,r]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),m="disabled"!==e.resize\_smart,g="disabled"!==e.retina\_images,h="disabled"!==e.limit\_dimensions,b=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},\_=(o,s)=>{a(!0);const l={...e};l[o]=s,t(l)},f=Object.keys(e.defined\_image\_sizes).filter((t=>"object"==typeof e.defined\_image\_sizes[t]));return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("resize\_smart",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),"disabled"!==e.lazyload&&(0,o.createElement)(o.Fragment,null," ",(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_retina\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_retina\_desc}}),checked:g,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("retina\_images",e)})," ",(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"})," "),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_desc}}),checked:h,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("limit\_dimensions",e)}),h&&(0,o.createElement)(u.BaseControl,null,(0,o.createElement)("div",{className:"flex gap-8"},(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,labelPosition:"side",value:e.limit\_width,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>\_("limit\_width",e)}),(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,labelPosition:"side",value:e.limit\_height,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>\_("limit\_height",e)})),(0,o.createElement)(st,{disableIcon:!0,type:"warning",text:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_notice})),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.add\_image\_size\_desc},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.image\_size\_notice}}),(0,o.createElement)("div",{className:"flex flex-col sm:flex-row p-6 bg-light-blue border border-blue-300 rounded-md items-stretch sm:items-center gap-8"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,placeholder:optimoleDashboardApp.strings.options\_strings.width\_field,hideLabelFromVision:!0,type:"number",min:1,value:n,onChange:r,className:"optml\_\_input sm:basis-2/5"}),(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,placeholder:optimoleDashboardApp.strings.options\_strings.height\_field,value:i,onChange:d,hideLabelFromVision:!0,type:"number",min:1,className:"optml\_\_input sm:basis-2/5"}),(0,o.createElement)(u.Button,{variant:"primary",isBusy:l,disabled:l,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(!n||!i||isNaN(n)||isNaN(i))return;const o="optimole\_"+n+"\_"+i+"\_crop",s={...e.defined\_image\_sizes,[o]:{width:n,height:i}};a(!0);const l={...e};l.defined\_image\_sizes=s,t(l),r(""),d("")}},optimoleDashboardApp.strings.options\_strings.add\_image\_size\_button))),0<f.length&&(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.image\_sizes\_title,className:"pt-4"},f.map((s=>(0,o.createElement)("div",{key:s,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex flex-wrap items-center gap-2"},(0,o.createElement)("div",null,(0,o.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.name}})," ",s),(0,o.createElement)("p",{className:"m-0"},(0,o.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.width\_field),": ",e.defined\_image\_sizes[s].width),(0,o.createElement)("p",{className:"m-0"},(0,o.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.height\_field),": ",e.defined\_image\_sizes[s].height)),(0,o.createElement)(u.Button,{variant:"default",icon:"trash",disabled:l,onClick:()=>(o=>{const s={...e.defined\_image\_sizes,[o]:"remove"};a(!0);const l={...e};l.defined\_image\_sizes=s,t(l)})(s)}))))))},dt=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),n="disabled"!==e.lazyload\_placeholder,r="disabled"!==e.native\_lazyload,i="disabled"===e.scale,d="disabled"!==e.bg\_replacer,m="disabled"!==e.video\_lazyload,g="disabled"!==e.no\_script,h=e.placeholder\_color,[b,\_]=(0,s.useState)(!1),f=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},E=(o,s)=>{a(!0);const l={...e};l[o]=s,t(l)},v=e=>{E("placeholder\_color",e)};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.BaseControl,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_desc}}),checked:n,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("lazyload\_placeholder",e)}),n&&(0,o.createElement)("div",{className:"relative inline-block"},(0,o.createElement)(u.Button,{disabled:l,className:"gap-3 mt-2 py-3 h-auto rounded text-inherit border-gray-400 border-2 border-solid font-medium",onClick:()=>{\_(!b)}},(0,o.createElement)(u.ColorIndicator,{colorValue:h}),(0,o.createElement)("span",null,optimoleDashboardApp.strings.options\_strings.lazyload\_placeholder\_color)),b&&(0,o.createElement)(u.Popover,{placement:"bottom",position:"middle center",variant:"unstyled",className:"shadow-md border-grayish-blue border border-solid rounded bg-white p-2",onFocusOutside:()=>\_(!1)},(0,o.createElement)(u.ColorPicker,{color:h,onChange:v,enableAlpha:!0,defaultValue:""}),(0,o.createElement)(u.Button,{isDestructive:!0,className:"w-full text-center flex justify-center",variant:"secondary",onClick:()=>{v("")}},optimoleDashboardApp.strings.options\_strings.clear)))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_title},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_desc}}),(0,o.createElement)("div",{className:"flex gap-8"},(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first,labelPosition:"side",value:e.skip\_lazyload\_images,type:"number",min:0,className:"basis-1/2 md:basis-1/3",onChange:e=>E("skip\_lazyload\_images",e)}))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_native,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.native\_desc}}),checked:r,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("native\_lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_scale,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.scale\_desc}}),checked:i,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("scale",!e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("video\_lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_desc}}),checked:g,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("no\_script",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_desc}}),checked:d,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("bg\_replacer",e)}),d&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.watch\_title\_lazyload,id:"optml-css-watchers"},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.watch\_desc\_lazyload}}),(0,o.createElement)(u.TextareaControl,{id:"optml-css-watchers",placeholder:optimoleDashboardApp.strings.options\_strings.watch\_placeholder\_lazyload,value:e.watchers,onChange:e=>E("watchers",e)}))))},pt="extension",mt="page\_url",gt="page\_url\_match",ut="filename",ht="class",bt=[{label:optimoleDashboardApp.strings.options\_strings.filter\_filename,value:ut},{label:optimoleDashboardApp.strings.options\_strings.filter\_ext,value:pt},{label:optimoleDashboardApp.strings.options\_strings.filter\_url,value:mt},{label:optimoleDashboardApp.strings.options\_strings.filter\_class,value:ht}],\_t=[{label:optimoleDashboardApp.strings.options\_strings.exclude\_filename\_desc,value:ut},{label:optimoleDashboardApp.strings.options\_strings.exclude\_ext\_desc,value:pt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_desc,value:mt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_match\_desc,value:gt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_class\_desc,value:ht}],ft=[{label:".SVG",value:"svg"},{label:".JPG",value:"jpg"},{label:".PNG",value:"png"},{label:".GIF",value:"gif"},{label:".WEBP",value:"webp"}],Et=({label:e,help:t,type:a,settings:l,setSettings:n,setCanSave:r})=>{const{isLoading:i}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[d,p]=(0,s.useState)(ut),[m,g]=(0,s.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[h,b]=(0,s.useState)(""),[\_,f]=(0,s.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[E,v]=(0,s.useState)(!1),y=0<Object.keys(l.filters[a][pt]).length&&Object.values(l.filters[a][pt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][ht]).length&&Object.values(l.filters[a][ht]).some((e=>!1!==e))||0<Object.keys(l.filters[a][mt]).length&&Object.values(l.filters[a][mt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][gt]).length&&Object.values(l.filters[a][gt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][ut]).length&&Object.values(l.filters[a][ut]).some((e=>!1!==e));return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.BaseControl,{label:e,help:d===mt&&optimoleDashboardApp.strings.options\_strings.filter\_helper},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:t}}),(0,o.createElement)("div",{className:"flex flex-col md:flex-row p-6 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex justify-start items-center gap-4"},(0,o.createElement)(u.SelectControl,{value:d,options:bt,onChange:e=>{let t="";e===pt&&(t="svg",g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_is)),e===ut&&g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),e===ht&&g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),v(!1),b(t),p(e)},className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}),d===mt?(0,o.createElement)(u.SelectControl,{value:\_,options:[{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains},{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches}],onChange:f,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,o.createElement)("p",{className:"m-0"},m),d===pt?(0,o.createElement)(u.SelectControl,{value:h,options:ft,onChange:b,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,o.createElement)(u.TextControl,{value:h,placeholder:"matches"===\_?"path":"word",onChange:e=>{b(e),v(!1)},className:"optml\_\_input"})),(0,o.createElement)(u.Button,{variant:"primary",isBusy:i,disabled:i,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(3>h.length)return void v(!0);const e={...l.filters};let t=d;d===mt&&"matches"===\_&&(t=gt),e[a]&&"object"==typeof e[a]||(e[a]={}),e[a][t]&&!Array.isArray(e[a][t])||(e[a][t]={}),e[a][t][h]=!0,n({...l,filters:e}),d!==pt&&b(""),r(!0)}},optimoleDashboardApp.strings.options\_strings.add\_filter)),E&&(0,o.createElement)("p",{className:"text-red-500 bg-red-100 p-2 rounded-md border border-solid border-red-200"},optimoleDashboardApp.strings.options\_strings.filter\_length\_error)),y&&(0,o.createElement)(u.BaseControl,{label:"optimize"===a?optimoleDashboardApp.strings.options\_strings.active\_optimize\_exclusions:optimoleDashboardApp.strings.options\_strings.active\_lazyload\_exclusions,className:"py-4"},\_t.map((e=>Object.keys(l.filters[a][e.value]).filter((t=>!1!==l.filters[a][e.value][t])).map((t=>(0,o.createElement)("div",{key:t,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex items-center gap-1"},(0,o.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:e.label}}),(0,o.createElement)("b",null,t)),(0,o.createElement)(u.Button,{variant:"default",icon:"trash",disabled:i,onClick:()=>((e,t)=>{const o={...l.filters};o[a][e][t]=!1,n({...l,filters:o}),r(!0)})(e.value,t)}))))))))},vt=({settings:e,setSettings:t,setCanSave:a})=>{const s="disabled"!==e.lazyload;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(Et,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_optimize,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_optimize,type:"optimize",settings:e,setSettings:t,setCanSave:a}),s&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(Et,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_lazyload,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_lazyload,type:"lazyload",settings:e,setSettings:t,setCanSave:a})))};function yt({options:e,value:t,onChange:a,label:s,disabled:l=!1,className:n}){return p()({"opacity-50":l},"transition-all my-6 gap-6 grid opacity-100"),(0,o.createElement)("fieldset",{className:`my-6 gap-6 grid ${n}`,onChange:e=>{a(e.target.value)}},s&&(0,o.createElement)("legend",{className:"uppercase font-semibold text-s text-light-black mb-6"},s),e.map(((e,a)=>{const{title:s,value:n,description:r}=e,i=t===n,c=p()({"outline-info":i,"outline-transparent":!i},"flex gap-6 items-start bg-gray-50 rounded-md p-4 outline -outline-offset-3 outline-3 transition-all");return(0,o.createElement)("label",{htmlFor:n,key:n,className:c},(0,o.createElement)(wt,{isActive:i}),(0,o.createElement)("div",{className:"grid space-y-2"},s&&(0,o.createElement)("div",{className:"text-base font-medium text-gray-700"},s),r&&(0,o.createElement)("div",{className:"text-sm text-gray-500"},r)),(0,o.createElement)("input",{type:"radio",name:"label",value:n,id:n,className:"!opacity-0 !w-0 !h-0 !overflow-hidden !absolute !pointer-events-none",disabled:l}))})))}const wt=({isActive:e})=>{const t=p()({"bg-white outline-info":e,"bg-gray-200 outline-transparent":!e},"w-[24px] h-[24px] rounded-full flex items-center justify-center flex-shrink-0 outline outline-3 -outline-offset-3 transition-all"),a=p()({"bg-info":e},"w-[12px] h-[12px] rounded-full background-info transition-all");return(0,o.createElement)("div",{className:t},e&&(0,o.createElement)("div",{className:a}))};function kt({title:e,progress:t,description:a,onCancel:s,hideCancel:l=!1}){const{strings:n}=optimoleDashboardApp;return(0,o.createElement)("div",{className:"bg-gray-50 rounded-md p-4 space-y-4"},(0,o.createElement)("div",{className:"flex gap-3 items-center"},(0,o.createElement)(at,{icon:E,className:"text-info animate-spin -scale-y-100"}),e&&(0,o.createElement)("p",{className:"uppercase text-s font-semibold text-light-black m-0"},e),!l&&(0,o.createElement)("button",{onClick:s,className:"appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-s hover:border-red-500 hover:bg-red-500 hover:text-white cursor-pointer"},n.cancel)),(0,o.createElement)(Le,{value:t}),a&&(0,o.createElement)("p",{className:"text-xs text-gray-500"},a))}const xt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),Ct=window.wp.compose;function St({icon:e,labels:t={},onRequestClose:a=(()=>{}),onConfirm:s=(()=>{}),variant:l="default"}){const n=(0,Ct.useViewportMatch)("small","<"),r=p()({"bg-stale-yellow":"warning"===l,"bg-light-blue":"default"===l},"p-3 rounded-full"),i=p()({"bg-mango-yellow":"warning"===l},"optml\_\_button flex justify-center px-5 py-3 rounded font-bold min-h-40 basis-1/5");return(0,o.createElement)(u.Modal,{\_\_experimentalHideHeader:!0,className:"max-w-xl antialiased",onRequestClose:a,isFullScreen:n},(0,o.createElement)(u.Button,{icon:xt,onClick:a,label:optimoleDashboardApp.strings.csat.close,className:"fixed right-3 top-3 cursor-pointer"}),(0,o.createElement)("div",{className:"flex flex-col items-center"},(0,o.createElement)(u.Icon,{icon:e,size:24,className:r}),(0,o.createElement)("h2",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:t.title}}),(0,o.createElement)("p",{className:"text-center mx-0 my-4 text-gray-700",dangerouslySetInnerHTML:{\_\_html:t.description}}),(0,o.createElement)(u.Button,{variant:"primary",className:i,onClick:s},t.action)))}const At=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12.5 5L10 19h1.9l2.5-14z"})),Dt=({type:e})=>{const{logs:t}=(0,c.useSelect)((e=>{const{getLogs:t}=e("optimole");return{logs:t()}})),[a,l]=(0,s.useState)(!1),n=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const a=setInterval((()=>{n.current&&(n.current.innerHTML=t[e],n.current.scrollTop=n.current.scrollHeight)}),15e3);return()=>clearInterval(a)}),[]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"w-full flex justify-end text-info my-2"},(0,o.createElement)(u.Button,{variant:"tertiary",className:"py-2 px-0",target:"\_blank",href:`${window.ajaxurl}?action=optml\_fetch\_logs&nonce=${optimoleDashboardApp.nonce}&type=${e}`},optimoleDashboardApp.strings.options\_strings.view\_logs),(0,o.createElement)(u.Icon,{icon:At,className:"fill-info py-2"}),(0,o.createElement)(u.Button,{variant:"tertiary",className:"py-2 px-0",onClick:()=>l(!a)},a?optimoleDashboardApp.strings.options\_strings.hide\_logs:optimoleDashboardApp.strings.options\_strings.show\_logs)),a&&(0,o.createElement)("div",{className:"flex flex-col p-6 bg-light-blue border border-blue-300 rounded-md min-h-[200px] max-h-[200px] overflow-y-scroll",ref:n,dangerouslySetInnerHTML:{\_\_html:t[e]}}))},Lt=({settings:e,canSave:t,setSettings:a,setCanSave:l})=>{const{strings:n,cron\_disabled:r}=optimoleDashboardApp,{conflicts:i,options\_strings:d}=n,m="offload",g="rollback",u="stopOffload",h="stopRollback",{offloadConflicts:b,errorMedia:\_,offloadLibraryLink:f,isLoading:v,loadingSync:x,loadingRollback:C,rollbackLibraryLink:S,queryArgs:A,totalNumberOfImages:D,processedImages:L,offloadFinishNotice:N,offloadLimitReached:T,offloadLimit:M}=(0,c.useSelect)((e=>{const{getOffloadConflicts:t,getErrorMedia:a,getLoadingSync:o,getLoadingRollback:s,getOffloadLibraryLink:l,getRollbackLibraryLink:n,getTotalNumberOfImages:r,getProcessedImages:i,getQueryArgs:c,isLoading:d,getSiteSettings:p,getOffloadLimit:m}=e("optimole");return{offloadConflicts:t(),errorMedia:a(),offloadLibraryLink:l(),isLoading:d(),loadingSync:o(),loadingRollback:s(),rollbackLibraryLink:n(),queryArgs:c(),totalNumberOfImages:r(),processedImages:i(),offloadFinishNotice:p("show\_offload\_finish\_notice"),offloadLimitReached:"enabled"===p("offload\_limit\_reached"),offloadLimit:m()}}),[]),{setErrorMedia:I,setCheckedOffloadConflicts:O,setOffloadConflicts:j,setProcessedImages:F,setOffloadLimitReached:B}=(0,c.useDispatch)("optimole"),[z,H]=(0,s.useState)(null),R="disabled"!==e.offloading\_status,P="disabled"!==e.rollback\_status;(0,s.useEffect)((()=>{A?.optimole\_action&&A?.images&&("offload\_images"===A.optimole\_action&&V(A.images),"rollback\_images"===A.optimole\_action&&Z(A.images))}),[]),(0,s.useEffect)((()=>{R&&ve({action:"offload\_images",refresh:!0}),P&&ve({action:"rollback\_images",refresh:!0})}),[]);const V=(t=[])=>{const o={...e};o.show\_offload\_finish\_notice="",o.offloading\_status="enabled",a(o),be(o,!1,!0,(()=>{I(!1),F(0),B(!1),ve({action:"offload\_images",images:t}),l(!1)}))},Z=(t=[])=>{O(!1),j([]),Ee((a=>{if(0===a.data.length){const a={...e};a.show\_offload\_finish\_notice="",a.rollback\_status="enabled",be(a,!1,!0,(()=>{I(!1),F(0),ve({action:"rollback\_images",images:t}),l(!1)}))}}))},q=[{title:d.offload\_radio\_option\_rollback\_title,description:d.offload\_radio\_option\_rollback\_desc,value:"rollback"},{title:d.offload\_radio\_option\_offload\_title,description:d.offload\_radio\_option\_offload\_desc,value:"offload"}],G="enabled"===e.offload\_media?"offload":"rollback",$=x||C;return(0,o.createElement)("div",null,(0,o.createElement)("h1",{className:"text-xl font-bold"},d.enable\_offload\_media\_title),(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:d.enable\_offload\_media\_desc}}),N&&(0,o.createElement)(st,{title:"offload"===N?d.offloading\_success:d.rollback\_success,type:"primary",onDismiss:()=>{be({show\_offload\_finish\_notice:""},!1,!0)}}),r&&(0,o.createElement)(st,{type:"error",text:n.cron\_error}),!$&&(0,o.createElement)(yt,{className:p()({"opacity-50 pointer-events-none":v||r}),label:d.offloading\_radio\_legend,options:q,value:G,onChange:t=>{const o="offload"===t,s={...e};s.offload\_media=o?"enabled":"disabled",a(s),l(!0),H(o?m:g)}}),$&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(kt,{title:x?d.sync\_media\_progress:d.rollback\_media\_progress,progress:Math.round(L/D\*100),onCancel:()=>{x&&H(u),C&&H(h)},description:0===D?d.calculating\_estimated\_time:d.images\_processing}),(0,o.createElement)(Dt,{type:x?"offload":"rollback"})),"offload\_images"===\_&&(0,o.createElement)(st,{type:"error",smallTitle:!0,title:d.sync\_media\_error,text:d.sync\_media\_error\_desc}),"rollback\_images"===\_&&(0,o.createElement)(st,{type:"error",smallTitle:!0,title:d.rollback\_media\_error,text:d.rollback\_media\_error\_desc}),0<b.length&&(0,o.createElement)(st,{type:"warning",title:d.offload\_conflicts\_part\_1},(0,o.createElement)("div",{className:"list-disc grid gap-3 mt-2"},(0,o.createElement)("ul",{className:"grid gap-1"},b.map((e=>(0,o.createElement)("li",{key:e,className:"font-semibold text-base m-0"},e)))),(0,o.createElement)("p",{className:"m-0 text-sm"},d.offload\_conflicts\_part\_2),(0,o.createElement)("button",{disabled:v,className:p()({"opacity-50 pointer-events-none":v},"justify-self-start font-semibold flex items-center appearance-none border border-info text-info bg-white rounded px-4 py-2 text-sm hover:text-white hover:bg-info cursor-pointer"),onClick:()=>j([])},i.conflict\_close))),!$&&(0,o.createElement)("button",{onClick:e=>{e.preventDefault(),"offload"===G&&H(m),"rollback"===G&&H(g)},disabled:v||r,className:p()({"opacity-50 pointer-events-none":v||r},"font-semibold flex items-center gap-2 appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-sm hover:text-white hover:bg-info cursor-pointer")},(0,o.createElement)(at,{icon:E,className:"w-4 h-4"}),(0,o.createElement)("span",null,d.sync\_media)),!$&&T&&(0,o.createElement)(st,{type:"warning",text:d.offload\_limit\_reached.replace("#offload\_limit#",M)}),z&&(0,o.createElement)(St,{...(K=z,{onRequestClose:()=>H(null),...{[m]:{icon:y,onConfirm:()=>{V(),H(null)},labels:{title:d.offloading\_start\_title,description:d.offloading\_start\_description,action:d.offloading\_start\_action}},[g]:{icon:w,onConfirm:()=>{Z(),H(null)},labels:{title:d.rollback\_start\_title,description:d.rollback\_start\_description,action:d.rollback\_start\_action}},[u]:{variant:"warning",icon:k,onConfirm:()=>{H(null);const t=e;t.offloading\_status="disabled",be(t)},labels:{title:d.offloading\_stop\_title,description:d.offloading\_stop\_description,action:d.offloading\_stop\_action}},[h]:{variant:"warning",icon:k,onConfirm:()=>{H(null);const t=e;t.rollback\_status="disabled",be(t)},labels:{title:d.rollback\_stop\_title,description:d.rollback\_stop\_description,action:d.rollback\_stop\_action}}}[K]})}),f&&(0,o.createElement)("p",{className:"m-0"},d.sync\_media\_link," ",(0,o.createElement)("a",{href:A.url},d.here)),S&&(0,o.createElement)("p",{className:"m-0"},d.rollback\_media\_link," ",(0,o.createElement)("a",{href:A.url},optimoleDashboardApp.strings.options\_strings.here)));var K};function Nt(e){const{user\_data:t,strings:a}=optimoleDashboardApp,{options\_strings:s}=a,{settings:l,setSettings:n,setCanSave:r}=e,i=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}),[]),{isLoading:d}=i,m="disabled"!==l.cloud\_images,g=t.whitelist||[];return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:s.enable\_cloud\_images\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:s.enable\_cloud\_images\_desc}}),checked:m,disabled:d,className:p()({"is-disabled":d}),onChange:e=>((e,t)=>{r(!0);const a={...l};a.cloud\_images=t?"enabled":"disabled",n(a)})(0,e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),m&&(0,o.createElement)(u.BaseControl,{label:s.cloud\_site\_title,help:s.cloud\_site\_desc},(0,o.createElement)("div",{className:"optml\_\_token\_\_base flex p-6 bg-light-blue border border-blue-300 rounded-md items-center gap-8"},(0,o.createElement)(u.FormTokenField,{value:Object.keys(l.cloud\_sites).filter((e=>"all"!==e&&"false"!==l.cloud\_sites[e])).map((e=>e))||[],suggestions:g,onChange:e=>{r(!0);const t={},a={...l};0===e.length?t.all="true":e.forEach((e=>{t[e]="true"})),Object.keys(a.cloud\_sites).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)||(t[e]="false")})),a.cloud\_sites=t,n(a)},\_\_experimentalExpandOnFocus:!0,\_\_experimentalShowHowTo:!1,\_\_experimentalValidateInput:e=>g.includes(e),className:"optml\_\_token"}))))}const Tt=({tab:e,setTab:t,canSave:a,setCanSave:l,settings:n,setSettings:r})=>{const{siteSettings:i,isLoading:d,damEnabled:p}=(0,c.useSelect)((e=>{const{getSiteSettings:t,getQueryArgs:a,isLoading:o}=e("optimole"),s=t();return{siteSettings:s,damEnabled:s.cloud\_images,isLoading:o(),queryArgs:a()}}),[]),[m,g]=(0,s.useState)(!1),[h,b]=(0,s.useState)(!1);(0,s.useEffect)((()=>{((e=!0)=>{const{dam\_url:t,strings:a}=window.optimoleDashboardApp,{cloud\_library:o}=a,s=document.querySelector('a[href\*="page=optimole-dam"]');if(!e&&!s)return;if(!e){if(!s)return;return void(s.style.display="none")}if(s)return void(s.style={});const l=document.createElement("li"),n=document.createElement("a");l.appendChild(n),n.href=t,n.innerHTML=o;const r=document.querySelector("#toplevel\_page\_optimole ul");r&&r.insertBefore(l,r.firstChild)})("enabled"===p)}),[p]),(0,s.useEffect)((()=>{const e=localStorage.getItem("optimole\_settings\_visits");3<e||localStorage.setItem("optimole\_settings\_visits",e?parseInt(e)+1:1)}),[e]);const \_=()=>{be(n,i.banner\_frontend!==n.banner\_frontend),l(!1)};return(0,o.createElement)("div",{className:"optml-settings flex flex-col sm:flex-row bg-white p-8 border-0 rounded-lg shadow-md gap-8"},(0,o.createElement)(We,{tab:e,setTab:t,settings:n}),(0,o.createElement)("div",{className:"basis-4/5"},"general"===e&&(0,o.createElement)(lt,{settings:n,setSettings:r,setCanSave:l}),"compression"===e&&(0,o.createElement)(it,{settings:n,setSettings:r,setCanSave:l,showSample:m,isSampleLoading:h,setIsSampleLoading:b}),"resize"===e&&(0,o.createElement)(ct,{settings:n,setSettings:r,setCanSave:l}),"lazyload"===e&&(0,o.createElement)(dt,{settings:n,setSettings:r,setCanSave:l}),"exclusions"===e&&(0,o.createElement)(vt,{settings:n,setSettings:r,setCanSave:l}),"cloud\_library"===e&&(0,o.createElement)(Nt,{settings:n,canSave:a,setSettings:r,setCanSave:l,onSaveSettings:\_}),"offload\_media"===e&&(0,o.createElement)(Lt,{settings:n,canSave:a,setSettings:r,setCanSave:l,onSaveSettings:\_}),(0,o.createElement)("div",{className:"flex justify-start items-center gap-5 mt-8"},(0,o.createElement)(u.Button,{variant:"primary",isBusy:d,disabled:!a,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:\_},optimoleDashboardApp.strings.options\_strings.save\_changes),"disabled"===n.autoquality&&"compression"===e&&(0,o.createElement)(u.Button,{variant:"default",disabled:d,onClick:()=>{m||(b(!0),fe({quality:n.quality},(()=>b(!1)))),g(!m)}},optimoleDashboardApp.strings.options\_strings.view\_sample\_image))))},Mt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),It=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M6.68822 16.625L5.5 17.8145L5.5 5.5L18.5 5.5L18.5 16.625L6.68822 16.625ZM7.31 18.125L19 18.125C19.5523 18.125 20 17.6773 20 17.125L20 5C20 4.44772 19.5523 4 19 4H5C4.44772 4 4 4.44772 4 5V19.5247C4 19.8173 4.16123 20.086 4.41935 20.2237C4.72711 20.3878 5.10601 20.3313 5.35252 20.0845L7.31 18.125ZM16 9.99997H8V8.49997H16V9.99997ZM8 14H13V12.5H8V14Z"})),Ot=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),jt=[{title:optimoleDashboardApp.strings.help.get\_support\_title,description:optimoleDashboardApp.strings.help.get\_support\_desc,cta:optimoleDashboardApp.strings.help.get\_support\_cta,link:"https://wordpress.org/support/plugin/optimole-wp/",icon:Mt},{title:optimoleDashboardApp.strings.help.feat\_request\_title,description:optimoleDashboardApp.strings.help.feat\_request\_desc,cta:optimoleDashboardApp.strings.help.feat\_request\_cta,link:"https://github.com/Codeinwp/optimole-wp/discussions",icon:It},{title:optimoleDashboardApp.strings.help.feedback\_title,description:optimoleDashboardApp.strings.help.feedback\_desc,cta:optimoleDashboardApp.strings.help.feedback\_cta,link:"https://wordpress.org/plugins/optimole-wp/#developers",icon:Ot}],Ft=[{title:optimoleDashboardApp.strings.help.account\_title,items:[{label:optimoleDashboardApp.strings.help.account\_item\_one,value:"https://docs.optimole.com/article/1134-how-optimole-counts-the-number-of-visitors"},{label:optimoleDashboardApp.strings.help.account\_item\_two,value:"https://docs.optimole.com/article/1008-what-happens-if-i-exceed-plan-limits"},{label:optimoleDashboardApp.strings.help.account\_item\_three,value:"https://docs.optimole.com/article/1133-visitors-based-plan"}]},{title:optimoleDashboardApp.strings.help.image\_processing\_title,items:[{label:optimoleDashboardApp.strings.help.image\_processing\_item\_one,value:"https://docs.optimole.com/article/1173-how-to-get-started-with-optimole-in-just-3-steps"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_two,value:"https://docs.optimole.com/article/1068-how-optimole-can-serve-webp-images"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_three,value:"https://docs.optimole.com/article/1475-adding-watermarks-to-your-images"}]},{title:optimoleDashboardApp.strings.help.api\_title,items:[{label:optimoleDashboardApp.strings.help.api\_item\_one,value:"https://docs.optimole.com/article/1323-cloud-library-browsing"},{label:optimoleDashboardApp.strings.help.api\_item\_two,value:"https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading"},{label:optimoleDashboardApp.strings.help.api\_item\_three,value:"https://docs.optimole.com/article/1307-custom-integration"}]}],Bt="flex p-6 border-2 border-solid border-grayish-blue rounded-md items-start gap-8 basis-1/3",zt=()=>(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},(0,o.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_one\_title),(0,o.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},jt.map(((e,t)=>(0,o.createElement)("div",{key:t,className:Bt},(0,o.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,o.createElement)(u.Icon,{icon:e.icon,className:"fill-info",size:42}),(0,o.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),(0,o.createElement)("div",{className:"not-italic font-normal text-s text-gray-800"},e.description),(0,o.createElement)(u.ExternalLink,{href:e.link},e.cta)))))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)("div",{className:"flex items-center justify-between"},(0,o.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_two\_title),(0,o.createElement)(u.ExternalLink,{href:"https://docs.optimole.com/"},optimoleDashboardApp.strings.help.section\_two\_sub)),(0,o.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},Ft.map(((e,t)=>(0,o.createElement)("div",{key:t,className:Bt},(0,o.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,o.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),e.items.map(((e,t)=>(0,o.createElement)("a",{key:t,href:e.value,target:"\_blank"},e.label))))))))),Ht=[optimoleDashboardApp.strings.upgrade.reason\_1,optimoleDashboardApp.strings.upgrade.reason\_2,optimoleDashboardApp.strings.upgrade.reason\_3,optimoleDashboardApp.strings.upgrade.reason\_4],Rt=()=>{const{name:e,domain:t,plan:a}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole"),a=t();let o=a?.cdn\_key+".i.optimole.com";return void 0!==a?.domain&&""!==a?.domain&&(o=a?.domain),{name:a?.display\_name,domain:o,plan:a?.plan}}));return(0,o.createElement)("div",{className:"flex flex-col mt-8 mb-5 p-0 transition-all ease-in-out duration-700 gap-5 basis-3/12"},(0,o.createElement)("div",{className:"bg-white gap-5 flex flex-col text-gray-700 border-0 rounded-lg shadow-md p-8"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.logged\_in\_as,value:e,className:"optml\_\_placeholder",disabled:!0}),(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.private\_cdn\_url,value:t,className:"optml\_\_placeholder",disabled:!0}),(0,o.createElement)("hr",{className:"m-0 border-grayish-blue"}),(0,o.createElement)("p",{className:"font-semibold text-xs text-light-black m-0"},optimoleDashboardApp.strings.looking\_for\_api\_key),(0,o.createElement)("p",{className:"m-0 -mt-3",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.optml\_dashboard}})),"free"===a?(0,o.createElement)("div",{className:"bg-info flex flex-col text-white border-0 rounded-lg shadow-md p-8 bg-promo bg-no-repeat",style:{backgroundImage:`url( ${optimoleDashboardApp.assets\_url}/img/logo2.png )`}},(0,o.createElement)("h3",{className:"mt-0 text-white text-lg"},optimoleDashboardApp.strings.upgrade.title\_long),(0,o.createElement)("ul",null,Ht.map(((e,t)=>(0,o.createElement)("li",{key:t,className:"flex items-center gap-2"},(0,o.createElement)(u.Icon,{icon:"yes-alt",className:"text-white"}),(0,o.createElement)("span",{className:"text-white font-normal text-base"},e))))),(0,o.createElement)(u.Button,{variant:"link",className:"optml\_\_button flex w-full justify-center font-bold min-h-40 !no-underline !text-white !bg-opaque-black !rounded",href:optimoleDashboardApp.optimoleHome+"pricing",target:"\_blank"},optimoleDashboardApp.strings.upgrade.cta)):(0,o.createElement)(u.Button,{variant:"default",className:"bg-white flex font-bold border-0 rounded-lg shadow-md p-8 text-sm justify-center",href:(0,S.addQueryArgs)(optimoleDashboardApp.optimoleHome+"contact/",{contact\_name:window.optimoleDashboardApp.user\_data.display\_name,contact\_email:optimoleDashboardApp.user\_data.user\_email,contact\_website:optimoleDashboardApp.home\_url}),target:"\_blank"},optimoleDashboardApp.strings.premium\_support))},Pt=({strings:e,onClose:t})=>(0,o.createElement)("div",{className:"flex justify-between px-8 pt-8"},(0,o.createElement)("p",{className:"text-purple-gray text-sm m-0 py-2"},e.title),(0,o.createElement)(u.Button,{label:e.close,icon:ot,onClick:t,className:"text-gray-950"}));window.optimoleCSAT={hasSubmitted:!1,data:{}};const Vt=({id:e,show:t=!1,strings:a={},pages:l=[],onDismiss:n=(()=>{})})=>{const[r,i]=(0,s.useState)(!1),[c,d]=(0,s.useState)(0),[p,m]=(0,s.useState)(!1),[g,h]=(0,s.useState)(!1),[b,\_]=(0,s.useState)({});(0,s.useEffect)((()=>{const t=()=>{!window.optimoleCSAT.hasSubmitted&&window.optimoleCSAT.data?.score&&localStorage.setItem(`optimole\_csat\_data\_${e}`,JSON.stringify(window.optimoleCSAT.data))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,s.useEffect)((()=>{t&&!p&&i(t)}),[t]),(0,s.useEffect)((()=>{window.optimoleCSAT={hasSubmitted:g,data:b}}),[g,b]);const f=(e=!1,t=b)=>{if(n(),g||!t?.score)return m(!0),null;const a={email:optimoleDashboardApp.user\_data.user\_email,product:"Optimole",site:optimoleDashboardApp.home\_url,...t};try{fetch(`https://api.themeisle.com/tracking/csat/${t?.score}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, \*/\*;q=0.1","Cache-Control":"no-cache"},body:JSON.stringify(a)})}catch(e){console.warn(e)}h(!0),d(l.length),e&&(i(!1),m(!0))};if((0,s.useEffect)((()=>{const t=localStorage.getItem(`optimole\_csat\_data\_${e}`);t&&(f(!0,JSON.parse(t)),localStorage.removeItem(`optimole\_csat\_data\_${e}`))}),[]),!r)return null;if(0===l.length)return null;const E=c<l.length,v=l[c]?.content;return(0,o.createElement)("div",{className:"bg-white fixed left-0 w-auto sm:right-0 sm:left-auto sm:w-full bottom-0 m-12 gap-2 max-w-lg flex flex-col text-gray-700 border-0 rounded-lg shadow-lg z-50"},l[c]&&(0,o.createElement)(o.Fragment,null,l[c]?.showHeader&&(0,o.createElement)(Pt,{onClose:()=>{i(!1),m(!0),f()},strings:a}),(0,o.createElement)(v,{data:b,changeData:(e,t=!1)=>{\_({...b,...e}),t&&d(c+1)},onSubmit:f})),!E&&(0,o.createElement)("div",{className:"flex flex-col gap-5 p-8 items-center"},(0,o.createElement)(u.Icon,{icon:Xe,size:40,className:"bg-success rounded-full fill-white p-2"}),(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_three),(0,o.createElement)("div",{className:"text-sm text-center"},optimoleDashboardApp.strings.csat.thank\_you),(0,o.createElement)(u.Button,{variant:"primary",onClick:()=>i(!1),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.close)))},Zt=window.wp.api;var qt=a.n(Zt);const Gt=window.wp.i18n,$t=()=>{const[e,t]=(0,s.useState)(!1),[a,l,n]=(()=>{const[e,t]=(0,s.useState)({}),[a,o]=(0,s.useState)("loading"),l=()=>{qt().loadPromise.then((async()=>{try{const e=new(qt().models.Settings),a=await e.fetch();t(a)}catch(e){o("error")}finally{o("loaded")}}))};return(0,s.useEffect)((()=>{l()}),[]),[t=>e?.[t],(e,t,a=(0,Gt.\_\_)("Settings saved.","textdomain"))=>{o("saving");const s=new(qt().models.Settings)({[e]:t}).save();s.success(((e,t)=>{"success"===t&&o("loaded"),"error"===t&&o("error"),l()})),s.error((e=>{o("error")}))},a]})(),r="loaded"===n&&void 0!==a("optml\_csat")&&JSON.parse(a("optml\_csat")),{hasImages:i,isFirstSite:d}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole");return{hasImages:0<t()?.images\_number,isFirstSite:1===t()?.whitelist?.length}})),p=localStorage.getItem("optimole\_settings\_visits");return(0,s.useEffect)((()=>{t(i&&d&&3<=parseInt(p)&&!1!==r&&!0!==r?.firstImpressions)}),[p,r]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(Vt,{id:"first-impressions",show:e,onDismiss:()=>l("optml\_csat",JSON.stringify({...r,firstImpressions:!0})),strings:{title:optimoleDashboardApp.strings.csat.title,close:optimoleDashboardApp.strings.csat.close},pages:[{showHeader:!0,content:e=>(0,o.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_one),(0,o.createElement)("div",{className:"flex gap-5"},[1,2,3,4,5].map((t=>(0,o.createElement)(u.Button,{key:t,onClick:()=>e.changeData({score:t},!0),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},t)))),(0,o.createElement)("div",{className:"flex justify-between"},(0,o.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.low),(0,o.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.high)))},{showHeader:!0,content:e=>(0,o.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_two),(0,o.createElement)(u.TextareaControl,{label:optimoleDashboardApp.strings.csat.heading\_two,hideLabelFromVision:!0,value:e.data?.feedback,placeholder:optimoleDashboardApp.strings.csat.feedback\_placeholder,onChange:t=>e.changeData({feedback:t})}),(0,o.createElement)("div",{className:"flex justify-end"},(0,o.createElement)("div",{className:"flex gap-2"},(0,o.createElement)(u.Button,{onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.skip),(0,o.createElement)(u.Button,{variant:"primary",onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.submit))))}]}))};async function Kt(e){if(!window.formbricks){const t=await fetch(`${e}/api/packages/app`);if(!t.ok)return{ok:!1,error:new Error("Failed to load Formbricks App SDK")};const a=await t.text(),o=document.createElement("script");o.innerHTML=a,document.head.appendChild(o);const s=async()=>new Promise(((e,t)=>{const a=setInterval((()=>{window.formbricks&&(clearInterval(a),e())}),100);setTimeout((()=>{clearInterval(a),t(new Error("Formbricks App SDK loading timed out"))}),1e4)}));try{return await s(),{ok:!0,data:void 0}}catch(e){return{ok:!1,error:new Error(e.message??"Failed to load Formbricks App SDK")}}}return{ok:!0,data:void 0}}const Ut=new Proxy({},{get:(e,t,a)=>async(...e)=>{if(!window.formbricks){if("init"!==t)return void console.error("🧱 Formbricks - Global error: You need to call formbricks.init before calling any other method");if(!e[0])return void console.error("🧱 Formbricks - Global error: You need to pass the apiHost as the first argument");const{apiHost:o}=e[0],s=await(a=Kt,async(...e)=>{try{return{ok:!0,data:await a(...e)}}catch(e){return{ok:!1,error:e}}})(o);if(!s.ok)return void console.error(`🧱 Formbricks - Global error: ${s.error.message}`)}var a;if(window.formbricks&&"function"!=typeof window.formbricks[t])console.error(`🧱 Formbricks - Global error: Formbricks App SDK does not support method ${String(t)}`);else try{return window.formbricks[t](...e)}catch(e){return void console.error(`Something went wrong: ${e}`)}}});function Yt(e,t=1){const a=Math.round(e/t);return 0===a||1===a?0:1<a&&8>a?7:8<=a&&31>a?30:30<a&&90>a?90:90<a?91:void 0}"undefined"!=typeof window&&optimoleDashboardApp.user\_data.plan&&Ut.init({environmentId:"clo8wxwzj44orpm0gjchurujm",apiHost:"https://app.formbricks.com",userId:"optml\_"+optimoleDashboardApp.user\_data.id,attributes:{plan:optimoleDashboardApp.user\_data.plan,status:optimoleDashboardApp.user\_data.status,language:optimoleDashboardApp.language,cname\_assigned:optimoleDashboardApp.user\_data.is\_cname\_assigned||"no",connected\_websites:optimoleDashboardApp.user\_data.whitelist.length,traffic:Yt(optimoleDashboardApp.user\_data.traffic,500),images\_number:Yt(optimoleDashboardApp.user\_data.images\_number,100),days\_since\_install:Yt(optimoleDashboardApp.days\_since\_install)}});const Qt=({tab:e,setTab:t})=>{const{isConnected:a,hasApplication:l,hasConflicts:n,siteSettings:r,extraVisits:i}=(0,c.useSelect)((e=>{const{isConnected:t,hasApplication:a,getConflicts:o,getSiteSettings:s}=e("optimole"),l=o(),n=s();return{isConnected:t(),hasApplication:a(),hasConflicts:0<l.count||0,siteSettings:n,extraVisits:n.banner\_frontend}})),{setQueryArgs:d}=(0,c.useDispatch)("optimole"),[p,m]=(0,s.useState)(!1),[g,u]=(0,s.useState)("general"),[h,b]=(0,s.useState)(!1),[\_,f]=(0,s.useState)(r);return(0,s.useEffect)((()=>{const e=new URLSearchParams(window.location.search),a=Object.fromEntries(e.entries());let o=[];if(Object.prototype.hasOwnProperty.call(a,"optimole\_action")){for(let e=0;20>e;e++)Object.prototype.hasOwnProperty.call(a,e)&&(isNaN(a[e])||(o[e]=parseInt(a[e],10)));a.images=o,a.url=window.location.href.split("?")[0]+(Object.prototype.hasOwnProperty.call(a,"paged")?"?paged="+a.paged:""),d(a),t("settings"),u("offload\_media")}}),[]),(0,s.useEffect)((()=>{a&&l&&(M(!0),C()({path:optimoleDashboardApp.routes.poll\_conflicts,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{M(!1),e&&P(e.data)})))}),[]),(0,s.useEffect)((()=>{n&&m(!0)}),[n]),(0,s.useEffect)((()=>{f({...\_,banner\_frontend:i})}),[i]),(0,s.useEffect)((()=>{window.onbeforeunload=h?()=>!0:null}),[h]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"optml-connected max-w-screen-xl flex flex-col lg:flex-row mx-auto gap-5"},(0,o.createElement)("div",{className:"flex flex-col justify-between mt-8 mb-5 p-0 transition-all ease-in-out duration-700 relative text-gray-700 basis-9/12"},"dashboard"===e&&(0,o.createElement)(Ze,null),"conflicts"===e&&p&&(0,o.createElement)(Ge,null),"settings"===e&&(0,o.createElement)(Tt,{tab:g,setTab:u,canSave:h,setCanSave:b,settings:\_,setSettings:f}),"help"===e&&(0,o.createElement)(zt,null)),(0,o.createElement)(Rt,null)),(0,o.createElement)($t,null))},Wt=[{label:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.version,href:optimoleDashboardApp.optimoleHome},{label:optimoleDashboardApp.strings.terms\_menu,href:optimoleDashboardApp.optimoleHome+"terms/"},{label:optimoleDashboardApp.strings.privacy\_menu,href:optimoleDashboardApp.optimoleHome+"privacy-policy/"},{label:optimoleDashboardApp.strings.testdrive\_menu,href:optimoleDashboardApp.optimoleHome+"test-drive?url="+optimoleDashboardApp.home\_url}],Jt=()=>(0,o.createElement)("footer",{className:"max-w-screen-xl gap-3 md:gap-0 mx-auto my-5 flex justify-between text-base flex-col md:flex-row"},(0,o.createElement)("div",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_3}}),(0,o.createElement)("nav",{className:"flex gap-0 sm:gap-3 flex-wrap md:flex-nowrap"},Wt.map(((e,t)=>(0,o.createElement)(u.ExternalLink,{key:t,href:e.href,className:"basis-1/2 sm:basis-auto"},e.label))))),Xt=window.lodash;function ea(){const e=(0,c.useSelect)((e=>e(A.store).getNotices()),[]),{removeNotice:t}=(0,c.useDispatch)(A.store),a=(0,Xt.filter)(e,{type:"snackbar"});return(0,o.createElement)(u.SnackbarList,{notices:a,className:"px-2 bottom-4 fixed",onRemove:t})}(0,s.render)((0,o.createElement)((()=>{const e=window.location.hash.replace("#","");let t=["dashboard","settings","help"].includes(e)?e:"dashboard";const[a,l]=(0,s.useState)(t),n=e=>{e.preventDefault(),l("settings")},r=e=>{e.preventDefault(),l("dashboard")},{showDisconnect:i,isConnected:d,hasApplication:p,hasDashboardLoaded:m}=(0,c.useSelect)((e=>{const{showDisconnect:t,isConnected:a,hasApplication:o,hasDashboardLoaded:s}=e("optimole");return{showDisconnect:t(),isConnected:a(),hasApplication:o(),hasDashboardLoaded:s()}}));return(0,s.useEffect)((()=>{d&&(window.location.hash=`#${a}`,D.forEach((e=>{const t=document.querySelector(`a[href="${e.href}"]`);if(!t)return;const a=t.parentNode;if(e.hash&&e.hash===window.location.hash)return t.classList.add("current"),void a.classList.add("current");t.classList.remove("current"),a.classList.remove("current")})))}),[a]),(0,s.useEffect)((()=>{if(!d)return;const e=document.querySelector('a[href\*="page=optimole"]'),t=document.querySelector('a[href\*="page=optimole#settings"]');return e&&t?(e.addEventListener("click",r),t.addEventListener("click",n),()=>{e&&t&&(e.removeEventListener("click",r),t.removeEventListener("click",n))}):void 0}),[]),(0,o.createElement)("div",{className:"antialiased"},(0,o.createElement)(we,{tab:a,setTab:l}),!(d&&p)&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(De,null),(0,o.createElement)(Jt,null)),d&&p&&!m&&(0,o.createElement)(Te,null),d&&i&&(0,o.createElement)(ke,null),d&&p&&m&&(0,o.createElement)(Qt,{tab:a,setTab:l}),(0,o.createElement)(ea,null))}),null),document.getElementById("optimole-app"))},184:(e,t)=>{var a;!function(){"use strict";var o={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var l=typeof a;if("string"===l||"number"===l)e.push(a);else if(Array.isArray(a)){if(a.length){var n=s.apply(null,a);n&&e.push(n)}}else if("object"===l){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){e.push(a.toString());continue}for(var r in a)o.call(a,r)&&a[r]&&e.push(r)}}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(a=function(){return s}.apply(t,[]))||(e.exports=a)}()},864:(e,t,a)=>{(()=>{"use strict";var t={n:e=>{var a=e&&e.\_\_esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},o={};t.r(o),t.d(o,{default:()=>c});const s=a(196);var l=t.n(s);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c=e=>{const{aspectRatio:t="taller",handle:a=null,handleSize:o=40,hover:n=!1,leftImage:i,leftImageAlt:c="",leftImageCss:d={},leftImageLabel:p=null,onSliderPositionChange:m=(()=>{}),rightImage:g,rightImageAlt:u="",rightImageCss:h={},rightImageLabel:b=null,skeleton:\_=null,sliderLineColor:f="#ffffff",sliderLineWidth:E=2,sliderPositionPercentage:v=.5,vertical:y=!1}=e,w=!y,[k,x]=(0,s.useState)(v),[C,S]=(0,s.useState)(0),[A,D]=(0,s.useState)(0),[L,N]=(0,s.useState)(!1),[T,M]=(0,s.useState)(!1),[I,O]=(0,s.useState)(!1),j=(0,s.useRef)(null),F=(0,s.useRef)(null),B=(0,s.useRef)(null);(0,s.useEffect)((()=>{const e=j.current,t=new ResizeObserver((e=>{let[t,...a]=e;const o=t.target.getBoundingClientRect().width;S(o)}));return t.observe(e),()=>t.disconnect()}),[]),(0,s.useEffect)((()=>(B.current.complete&&N(!0),()=>{N(!1)})),[i]),(0,s.useEffect)((()=>(F.current.complete&&M(!0),()=>{M(!1)})),[g]);const z=T&&L;(0,s.useEffect)((()=>{const e=e=>{const t=e||window.event,a=t.touches?t.touches[0].pageX:t.pageX,o=t.touches?t.touches[0].pageY:t.pageY,s=a-window.pageXOffset,l=o-window.pageYOffset,n=F.current.getBoundingClientRect();let r=w?s-n.left:l-n.top;const i=0+E/2,c=w?C-E/2:A-E/2;r<i&&(r=i),r>c&&(r=c),x(w?r/C:r/A),m&&m(w?r/C:r/A)},a=t=>{O(!0),"touches"in t||t.preventDefault(),e(t),window.addEventListener("mousemove",e),window.addEventListener("touchmove",e)},o=()=>{O(!1),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)},s=j.current;if(z){s.addEventListener("touchstart",a),window.addEventListener("touchend",o),n?(s.addEventListener("mousemove",e),s.addEventListener("mouseleave",o)):(s.addEventListener("mousedown",a),window.addEventListener("mouseup",o));const l=B.current.naturalHeight/B.current.naturalWidth,r=F.current.naturalHeight/F.current.naturalWidth,i="taller"===t?Math.max(l,r):Math.min(l,r);D(C\*i)}return()=>{s.removeEventListener("touchstart",a),window.removeEventListener("touchend",o),s.removeEventListener("mousemove",e),s.removeEventListener("mouseleave",o),s.removeEventListener("mousedown",a),window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}}),[z,t,A,C,w,n,E,y]);const H={container:{boxSizing:"border-box",position:"relative",width:"100%",height:`${A}px`,overflow:"hidden"},rightImage:r({clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},h),leftImage:r({clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},d),slider:{alignItems:"center",cursor:!n&&w?"ew-resize":!n&&!w&&"ns-resize",display:"flex",flexDirection:w?"column":"row",height:w?"100%":`${o}px`,justifyContent:"center",left:w?C\*k-o/2+"px":0,position:"absolute",top:w?0:A\*k-o/2+"px",width:w?`${o}px`:"100%"},line:{background:f,boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",flex:"0 1 auto",height:w?"100%":`${E}px`,width:w?`${E}px`:"100%"},handleCustom:{alignItems:"center",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:"auto",justifyContent:"center",width:"auto"},handleDefault:{alignItems:"center",border:`${E}px solid ${f}`,borderRadius:"100%",boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:`${o}px`,justifyContent:"center",width:`${o}px`,transform:w?"none":"rotate(90deg)"},leftArrow:{border:`inset ${.15\*o}px rgba(0,0,0,0)`,borderRight:`${.15\*o}px solid ${f}`,height:"0px",marginLeft:`-${.25\*o}px`,marginRight:.25\*o+"px",width:"0px"},rightArrow:{border:`inset ${.15\*o}px rgba(0,0,0,0)`,borderLeft:`${.15\*o}px solid ${f}`,height:"0px",marginRight:`-${.25\*o}px`,width:"0px"},leftLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",left:w?"5%":"50%",opacity:I?0:1,padding:"10px 20px",position:"absolute",top:w?"50%":"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},rightLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",opacity:I?0:1,padding:"10px 20px",position:"absolute",left:w?null:"50%",right:w?"5%":null,top:w?"50%":null,bottom:w?null:"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},leftLabelContainer:{clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,height:"100%",position:"absolute",width:"100%"},rightLabelContainer:{clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,height:"100%",position:"absolute",width:"100%"}};return l().createElement(l().Fragment,null,\_&&!z&&l().createElement("div",{style:r({},H.container)},\_),l().createElement("div",{style:r(r({},H.container),{},{display:z?"block":"none"}),ref:j,"data-testid":"container"},l().createElement("img",{onLoad:()=>M(!0),alt:u,"data-testid":"right-image",ref:F,src:g,style:H.rightImage}),l().createElement("img",{onLoad:()=>N(!0),alt:c,"data-testid":"left-image",ref:B,src:i,style:H.leftImage}),l().createElement("div",{style:H.slider},l().createElement("div",{style:H.line}),a?l().createElement("div",{style:H.handleCustom},a):l().createElement("div",{style:H.handleDefault},l().createElement("div",{style:H.leftArrow}),l().createElement("div",{style:H.rightArrow})),l().createElement("div",{style:H.line})),p&&l().createElement("div",{style:H.leftLabelContainer},l().createElement("div",{style:H.leftLabel},p)),b&&l().createElement("div",{style:H.rightLabelContainer},l().createElement("div",{style:H.rightLabel},b))))};e.exports=o})()},196:e=>{"use strict";e.exports=window.React}},a={};function o(e){var s=a[e];if(void 0!==s)return s.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,o),l.exports}o.m=t,e=[],o.O=(t,a,s,l)=>{if(!a){var n=1/0;for(d=0;d<e.length;d++){for(var[a,s,l]=e[d],r=!0,i=0;i<a.length;i++)(!1&l||n>=l)&&Object.keys(o.O).every((e=>o.O[e](a[i])))?a.splice(i--,1):(r=!1,l<n&&(n=l));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[a,s,l]},o.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var s,l,[n,r,i]=a,c=0;if(n.some((t=>0!==e[t]))){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(i)var d=i(o)}for(t&&t(a);c<n.length;c++)l=n[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},a=globalThis.webpackChunkoptimole\_wp=globalThis.webpackChunkoptimole\_wp||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var s=o.O(void 0,[431],(()=>o(976)));s=o.O(s)})(); |
* ## [optimole-wp/tags/3.13.0/inc/admin.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/admin.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/admin.php")

  | [r3072872](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L11 "Show revision 3072872 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/admin.php?rev=3086306#L11 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  |  | 13 | use enshrined\svgSanitize\Sanitizer; |
  | 13 | 14 | /\*\* |
  | 14 | 15 | \* Class Optml\_Admin |
  | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L88) | […](/browser/optimole-wp/tags/3.13.0/inc/admin.php?rev=3086306#L89) |  |
  | 88 | 89 | [ |
  | 89 | 90 | $this, |
  | 90 |  | 'allow\_~~meme\_types~~', |
  |  | 91 | 'allow\_svg', |
  | 91 | 92 | ] |
  | 92 | 93 | ); // phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.upload\_mimes |
  | 93 |  | } |
  | 94 |  | } |
  | 95 |  |  |
  |  | 94 | add\_filter( 'wp\_handle\_upload\_prefilter', [ $this, 'check\_svg\_and\_sanitize' ] ); |
  |  | 95 | } |
  |  | 96 | } |
  |  | 97 | /\*\* |
  |  | 98 | \* Check if the file is an SVG, if so handle appropriately |
  |  | 99 | \* |
  |  | 100 | \* @param array $file An array of data for a single file. |
  |  | 101 | \* |
  |  | 102 | \* @return mixed |
  |  | 103 | \*/ |
  |  | 104 | public function check\_svg\_and\_sanitize( $file ) { |
  |  | 105 | // Ensure we have a proper file path before processing. |
  |  | 106 | if ( ! isset( $file['tmp\_name'] ) ) { |
  |  | 107 | return $file; |
  |  | 108 | } |
  |  | 109 |  |
  |  | 110 | $file\_name   = isset( $file['name'] ) ? $file['name'] : ''; |
  |  | 111 | $wp\_filetype = wp\_check\_filetype\_and\_ext( $file['tmp\_name'], $file\_name ); |
  |  | 112 | $type        = ! empty( $wp\_filetype['type'] ) ? $wp\_filetype['type'] : ''; |
  |  | 113 |  |
  |  | 114 | if ( 'image/svg+xml' === $type ) { |
  |  | 115 | if ( ! current\_user\_can( 'upload\_files' ) ) { |
  |  | 116 | $file['error'] = 'Invalid'; |
  |  | 117 | return $file; |
  |  | 118 | } |
  |  | 119 |  |
  |  | 120 | if ( ! $this->sanitize\_svg( $file['tmp\_name'] ) ) { |
  |  | 121 | $file['error'] = 'Invalid'; |
  |  | 122 | } |
  |  | 123 | } |
  |  | 124 |  |
  |  | 125 | return $file; |
  |  | 126 | } |
  |  | 127 |  |
  |  | 128 | /\*\* |
  |  | 129 | \* Sanitize the SVG |
  |  | 130 | \* |
  |  | 131 | \* @param string $file Temp file path. |
  |  | 132 | \* |
  |  | 133 | \* @return bool|int |
  |  | 134 | \*/ |
  |  | 135 | protected function sanitize\_svg( $file ) { |
  |  | 136 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 137 | $dirty = file\_get\_contents( $file ); // phpcs:ignore |
  |  | 138 |  |
  |  | 139 | // Is the SVG gzipped? If so we try and decode the string. |
  |  | 140 | $is\_zipped = $this->is\_gzipped( $dirty ); |
  |  | 141 | if ( $is\_zipped && ( ! function\_exists( 'gzdecode' ) || ! function\_exists( 'gzencode' ) ) ) { |
  |  | 142 | return false; |
  |  | 143 | } |
  |  | 144 |  |
  |  | 145 | if ( $is\_zipped ) { |
  |  | 146 | $dirty = gzdecode( $dirty ); |
  |  | 147 |  |
  |  | 148 | // If decoding fails, bail as we're not secure. |
  |  | 149 | if ( false === $dirty ) { |
  |  | 150 | return false; |
  |  | 151 | } |
  |  | 152 | } |
  |  | 153 |  |
  |  | 154 | $sanitizer = new Sanitizer(); |
  |  | 155 | $clean     = $sanitizer->sanitize( $dirty ); |
  |  | 156 |  |
  |  | 157 | if ( false === $clean ) { |
  |  | 158 | return false; |
  |  | 159 | } |
  |  | 160 |  |
  |  | 161 | // If we were gzipped, we need to re-zip. |
  |  | 162 | if ( $is\_zipped ) { |
  |  | 163 | $clean = gzencode( $clean ); |
  |  | 164 | } |
  |  | 165 |  |
  |  | 166 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 167 | file\_put\_contents( $file, $clean ); // phpcs:ignore |
  |  | 168 |  |
  |  | 169 | return true; |
  |  | 170 | } |
  |  | 171 |  |
  |  | 172 | /\*\* |
  |  | 173 | \* Check if the contents are gzipped |
  |  | 174 | \* |
  |  | 175 | \* @see http://www.gzip.org/zlib/rfc-gzip.html#member-format |
  |  | 176 | \* |
  |  | 177 | \* @param string $contents Content to check. |
  |  | 178 | \* |
  |  | 179 | \* @return bool |
  |  | 180 | \*/ |
  |  | 181 | protected function is\_gzipped( $contents ) { |
  |  | 182 | // phpcs:disable Generic.Strings.UnnecessaryStringConcat.Found |
  |  | 183 | if ( function\_exists( 'mb\_strpos' ) ) { |
  |  | 184 | return 0 === mb\_strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 185 | } else { |
  |  | 186 | return 0 === strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 187 | } |
  |  | 188 | // phpcs:enable |
  |  | 189 | } |
  | 96 | 190 | /\*\* |
  | 97 | 191 | \* Schedules the hourly cron that starts the querying for images alt/title attributes |
  | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L1825) | […](/browser/optimole-wp/tags/3.13.0/inc/admin.php?rev=3086306#L1919) |  |
  | 1825 | 1919 | \* @uses filter:upload\_mimes |
  | 1826 | 1920 | \*/ |
  | 1827 |  | public function allow\_~~meme\_types~~( $mimes ) { |
  |  | 1921 | public function allow\_svg( $mimes ) { |
  | 1828 | 1922 | $mimes['svg'] = 'image/svg+xml'; |
  | 1829 | 1923 |  |
* ## [optimole-wp/tags/3.13.0/inc/app\_replacer.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/app_replacer.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/app_replacer.php")

  | [r2999023](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L1 "Show revision 2999023 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/app_replacer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L616) | […](/browser/optimole-wp/tags/3.13.0/inc/app_replacer.php?rev=3086306#L619) |  |
  | 616 | 619 | \*/ |
  | 617 | 620 | public function get\_media\_optimized\_url( $url, $table\_id, $width = 'auto', $height = 'auto', $resize = [] ) { |
  | 618 |  | $optimized\_url = ( new Optml\_Image( $url, ['width' => $width, 'height' => $height, 'resize' => $resize, 'quality' => $this->settings->get\_numeric\_quality()], $this->settings->get( 'cache\_buster' ) ) )->get\_url(); |
  | 619 |  | $optimized\_url = str\_replace( $url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] . 'media\_cloud' . '/' . Optml\_Media\_Offload::KEYS['uploaded\_flag'] . $table\_id . '/' . $url, $optimized\_url ); |
  | 620 |  | return $optimized\_url; |
  |  | 621 | return str\_replace( $url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] . 'media\_cloud' . '/' . Optml\_Media\_Offload::KEYS['uploaded\_flag'] . $table\_id . '/' . $url, $this->get\_optimized\_image\_url( $url, $width, $height, $resize ) ); |
  | 621 | 622 | } |
  | 622 | 623 |  |
  | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L631) | […](/browser/optimole-wp/tags/3.13.0/inc/app_replacer.php?rev=3086306#L632) |  |
  | 631 | 632 | return strpos( $url, Optml\_Dam::URL\_DAM\_FLAG ) !== false; |
  | 632 | 633 | } |
  |  | 634 |  |
  |  | 635 | /\*\* |
  |  | 636 | \* Get the optimized image url for the image url. |
  |  | 637 | \* |
  |  | 638 | \* @param string $url    The image URL. |
  |  | 639 | \* @param mixed  $width  The image width. |
  |  | 640 | \* @param mixed  $height The image height. |
  |  | 641 | \* @param array  $resize The resize properties. |
  |  | 642 | \* |
  |  | 643 | \* @return string |
  |  | 644 | \*/ |
  |  | 645 | protected function get\_optimized\_image\_url( $url, $width, $height, $resize = [] ) { |
  |  | 646 | $optimized\_image = Optimole::image( $url, $this->settings->get( 'cache\_buster' ) ) |
  |  | 647 | ->width( $width ) |
  |  | 648 | ->height( $height ); |
  |  | 649 |  |
  |  | 650 | if ( is\_array( $resize ) && ! empty( $resize['type'] ) ) { |
  |  | 651 | $optimized\_image->resize( $resize['type'], $resize['gravity'] ?? Position::CENTER, $resize['enlarge'] ?? false ); |
  |  | 652 |  |
  |  | 653 | } |
  |  | 654 |  |
  |  | 655 | $optimized\_image->quality( $this->settings->to\_accepted\_quality( $this->settings->get\_quality() ) ); |
  |  | 656 |  |
  |  | 657 | return $optimized\_image->getUrl(); |
  |  | 658 | } |
  | 633 | 659 | } |
* ## [optimole-wp/tags/3.13.0/inc/attachment\_cache.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/attachment_cache.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/attachment_cache.php")

  | [r2999023](/browser/optimole-wp/trunk/inc/attachment_cache.php?rev=2999023#L12 "Show revision 2999023 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/attachment_cache.php?rev=3086306#L12 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \*/ |
  | 13 | 13 | private static $cache\_map = []; |
  | 14 |  |  |
  |  | 14 | /\*\* |
  |  | 15 | \* Reset the memory cache. |
  |  | 16 | \*/ |
  |  | 17 | public static function reset() { |
  |  | 18 | self::$cache\_map = []; |
  |  | 19 | } |
  | 15 | 20 | /\*\* |
  | 16 | 21 | \* Get the cached attachment ID. |
* ## [optimole-wp/tags/3.13.0/inc/compatibilities/envira.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/compatibilities/envira.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/compatibilities/envira.php")

  | [r2935150](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=2935150#L1 "Show revision 2935150 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/envira.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=2935150#L57) | […](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/envira.php?rev=3086306#L60) |  |
  | 57 | 60 | if ( preg\_match( '/(\_c)\.(?:' . implode( '|', array\_keys( Optml\_Config::$image\_extensions ) ) . ')/i', $tag, $match ) ) { |
  | 58 | 61 | return [ |
  | 59 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  | 60 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 62 | 'type'    => ResizeTypeProperty::FILL, |
  |  | 63 | 'gravity' => Position::CENTER, |
  | 61 | 64 | ]; |
  | 62 | 65 | } |
* ## [optimole-wp/tags/3.13.0/inc/compatibilities/shortcode\_ultimate.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/compatibilities/shortcode_ultimate.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/compatibilities/shortcode_ultimate.php")

  | [r2441517](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=2441517#L1 "Show revision 2441517 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/shortcode_ultimate.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=2441517#L72) | […](/browser/optimole-wp/tags/3.13.0/inc/compatibilities/shortcode_ultimate.php?rev=3086306#L75) |  |
  | 72 | 75 | public function change\_default\_crop() { |
  | 73 | 76 | return [ |
  | 74 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  | 75 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 77 | 'type'    => ResizeTypeProperty::FILL, |
  |  | 78 | 'gravity' => Position::CENTER, |
  | 76 | 79 | ]; |
  | 77 | 80 | } |
* ## [optimole-wp/tags/3.13.0/inc/config.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/config.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/config.php")

  | [r3013029](/browser/optimole-wp/trunk/inc/config.php?rev=3013029#L1 "Show revision 3013029 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/config.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  | 2 | 4 |  |
  | 3 | 5 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/config.php?rev=3013029#L125) | […](/browser/optimole-wp/tags/3.13.0/inc/config.php?rev=3086306#L127) |  |
  | 125 | 127 | self::$service\_url = constant( 'OPTML\_CUSTOM\_DOMAIN' ); |
  | 126 | 128 | } |
  |  | 129 |  |
  |  | 130 | Optimole::init( self::$key, [ 'domain' => parse\_url( self::$service\_url, PHP\_URL\_HOST ) ] ); |
  | 127 | 131 | } |
  | 128 | 132 | } |
* ## [optimole-wp/tags/3.13.0/inc/dam.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/dam.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/dam.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/dam.php?rev=3071327#L9 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/dam.php?rev=3086306#L9 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | \* @author     Optimole <friends@optimole.com> |
  | 10 | 10 | \*/ |
  |  | 11 |  |
  |  | 12 | use Optimole\Sdk\Resource\ImageProperty\GravityProperty; |
  |  | 13 | use Optimole\Sdk\ValueObject\Position; |
  | 11 | 14 |  |
  | 12 | 15 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/dam.php?rev=3071327#L745) | […](/browser/optimole-wp/tags/3.13.0/inc/dam.php?rev=3086306#L748) |  |
  | 745 | 748 | $crop = (bool) $args['crop']; |
  | 746 | 749 |  |
  | 747 |  | $gravity = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 750 | $gravity = Position::CENTER; |
  | 748 | 751 |  |
  | 749 | 752 | if ( $this->settings->get( 'resize\_smart' ) === 'enabled' ) { |
  | 750 |  | $gravity = ~~Optml\_Resize::GRAVITY\_~~SMART; |
  |  | 753 | $gravity = GravityProperty::SMART; |
  | 751 | 754 | } |
  | 752 | 755 |  |
* ## [optimole-wp/tags/3.13.0/inc/lazyload\_replacer.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/lazyload_replacer.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/lazyload_replacer.php")

  | [r3018634](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3018634#L197 "Show revision 3018634 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/lazyload_replacer.php?rev=3086306#L197 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 197 | 197 | } |
  | 198 | 198 |  |
  | 199 |  | ~~add\_filter(~~ |
  | 200 |  | ~~'max\_srcset\_image\_width',~~ |
  | 201 |  | ~~function () {~~ |
  | 202 |  | ~~return 1;~~ |
  | 203 |  | ~~}~~ |
  | 204 |  | ~~);~~ |
  | 205 | 199 | self::$is\_lazyload\_placeholder = self::$instance->settings->get( 'lazyload\_placeholder' ) === 'enabled'; |
  | 206 | 200 |  |
  | […](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3018634#L323) | […](/browser/optimole-wp/tags/3.13.0/inc/lazyload_replacer.php?rev=3086306#L317) |  |
  | 323 | 317 | 1 |
  | 324 | 318 | ); |
  |  | 319 |  |
  |  | 320 | // We remove srcset and sizes attributes since our lazyload does not need them. |
  |  | 321 | $pattern = '/\s+(?:srcset|sizes)=("[^"]\*"|\'[^\']\*\'|\\\\"[^\\\\"]\*\\\\")/i'; |
  |  | 322 | $new\_tag = preg\_replace( $pattern, '', $new\_tag ); |
  |  | 323 |  |
  |  | 324 | // We keep this for srcset lazyload compatibility that might break our mechanism. |
  | 325 | 325 | $new\_tag = str\_replace( 'srcset=', 'old-srcset=', $new\_tag ); |
  | 326 | 326 |  |
* ## [optimole-wp/tags/3.13.0/inc/main.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/main.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/main.php")

  | [r2996263](/browser/optimole-wp/trunk/inc/main.php?rev=2996263#L86 "Show revision 2996263 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/main.php?rev=3086306#L86 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 86 | 86 | \*/ |
  | 87 | 87 | public static function instance() { |
  |  | 88 | $vendor\_file = OPTML\_PATH . 'vendor/autoload.php'; |
  |  | 89 | if ( is\_readable( $vendor\_file ) ) { |
  |  | 90 | include\_once $vendor\_file; |
  |  | 91 | } |
  |  | 92 |  |
  | 88 | 93 | if ( null === self::$\_instance ) { |
  | 89 | 94 | add\_filter( 'themeisle\_sdk\_products', [ \_\_CLASS\_\_, 'register\_sdk' ] ); |
  | […](/browser/optimole-wp/trunk/inc/main.php?rev=2996263#L104) | […](/browser/optimole-wp/tags/3.13.0/inc/main.php?rev=3086306#L109) |  |
  | 104 | 109 | } |
  | 105 | 110 | } |
  | 106 |  | ~~$vendor\_file = OPTML\_PATH . 'vendor/autoload.php';~~ |
  | 107 |  | ~~if ( is\_readable( $vendor\_file ) ) {~~ |
  | 108 |  | ~~include\_once $vendor\_file;~~ |
  | 109 |  | ~~}~~ |
  | 110 | 111 |  |
  | 111 | 112 | return self::$\_instance; |
* ## [optimole-wp/tags/3.13.0/inc/manager.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/manager.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/manager.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/manager.php?rev=3071327#L267 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/manager.php?rev=3086306#L267 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 267 | 267 | return false; // @codeCoverageIgnore |
  | 268 | 268 | } |
  | 269 |  | if ( array\_key\_exists( 'preview', $\_GET ) && ! empty( $\_GET['preview'] ) ) { |
  |  | 269 |  |
  |  | 270 | if ( array\_key\_exists( 'preview', $\_GET ) && ! empty( $\_GET['preview'] ) && ! $this->settings->is\_offload\_enabled() ) { |
  | 270 | 271 | return false; // @codeCoverageIgnore |
  | 271 | 272 | } |
* ## [optimole-wp/tags/3.13.0/inc/media\_offload.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/media_offload.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/media_offload.php")

  | [r3073660](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L541 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L541 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 541 | 541 | $size       = 'full'; |
  | 542 | 542 | $found\_size = $this->parse\_dimensions\_from\_filename( $url ); |
  | 543 |  | $strip\_url  = $url; |
  | 544 |  | $scaled\_url = $url; |
  |  | 543 | $url        = $this->add\_schema( $url ); |
  | 545 | 544 | if ( $found\_size[0] !== false && $found\_size[1] !== false ) { |
  | 546 |  | $size       = $found\_size; |
  | 547 |  | $strip\_url  = str\_replace( '-' . $found\_size[0] . 'x' . $found\_size[1], '', $url ); |
  | 548 |  | $scaled\_url = str\_replace( '-' . $found\_size[0] . 'x' . $found\_size[1], '-scaled', $url ); |
  | 549 |  | } |
  | 550 |  | $strip\_url = $this->add\_schema( $strip\_url ); |
  | 551 |  |  |
  | 552 |  | $attachment\_id = attachment\_url\_to\_postid( $strip\_url ); |
  | 553 |  | if ( $attachment\_id === 0 ) { |
  | 554 |  | $scaled\_url    = $this->add\_schema( $scaled\_url ); |
  | 555 |  | $attachment\_id = attachment\_url\_to\_postid( $scaled\_url ); |
  | 556 |  | } |
  |  | 545 | $size = $found\_size; |
  |  | 546 |  |
  |  | 547 | } |
  |  | 548 | $url           = $this->add\_schema( $url ); |
  |  | 549 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $url ); |
  | 557 | 550 |  |
  | 558 | 551 | return [ 'attachment\_id' => $attachment\_id, 'size' => $size ]; |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L814) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L807) |  |
  | 814 | 807 | if ( self::is\_uploaded\_image( wp\_get\_attachment\_metadata( $id )['file'] ) ) { |
  | 815 | 808 | // if this meta flag below failed at the initial update but the file meta above is updated it will cause an infinite query loop |
  | 816 |  | update\_post\_meta( $id, 'optimole\_offload', 'true' ); |
  |  | 809 | update\_post\_meta( $id, self::META\_KEYS['offloaded'], 'true' ); |
  |  | 810 | update\_post\_meta( $id, self::OM\_OFFLOADED\_FLAG, true ); |
  | 817 | 811 | $success\_up ++; |
  | 818 | 812 | continue; |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1174) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L1168) |  |
  | 1174 | 1168 | $file = $meta['file']; |
  | 1175 | 1169 | if ( self::is\_uploaded\_image( $file ) ) { |
  | 1176 |  | $optimized\_url = ( new Optml\_Image( |
  | 1177 |  | $url, |
  | 1178 |  | [ |
  | 1179 |  | 'width'   => 'auto', |
  | 1180 |  | 'height'  => 'auto', |
  | 1181 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1182 |  | ], |
  | 1183 |  | $this->settings->get( 'cache\_buster' ) |
  | 1184 |  | ) )->get\_url(); |
  | 1185 |  |  |
  | 1186 |  | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $attachment\_id . $file, $optimized\_url ); |
  |  | 1170 | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $attachment\_id . $file, $this->get\_optimized\_image\_url( $url, 'auto', 'auto' ) ); |
  | 1187 | 1171 | } else { |
  | 1188 | 1172 | // this is for the users that already offloaded the images before the other fixes |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1195) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L1179) |  |
  | 1195 | 1179 | $duplicated\_meta = wp\_get\_attachment\_metadata( $id ); |
  | 1196 | 1180 | if ( isset( $duplicated\_meta['file'] ) && self::is\_uploaded\_image( $duplicated\_meta['file'] ) ) { |
  | 1197 |  | $optimized\_url = ( new Optml\_Image( |
  | 1198 |  | $url, |
  | 1199 |  | [ |
  | 1200 |  | 'width'   => 'auto', |
  | 1201 |  | 'height'  => 'auto', |
  | 1202 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1203 |  | ], |
  | 1204 |  | $this->settings->get( 'cache\_buster' ) |
  | 1205 |  | ) )->get\_url(); |
  | 1206 |  |  |
  | 1207 |  | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $id . $duplicated\_meta['file'], $optimized\_url ); |
  |  | 1181 | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $id . $duplicated\_meta['file'], $this->get\_optimized\_image\_url( $url, 'auto', 'auto' ) ); |
  | 1208 | 1182 | } |
  | 1209 | 1183 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1212) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L1186) |  |
  | 1212 | 1186 | } |
  | 1213 | 1187 | } |
  | 1214 |  |  |
  | 1215 | 1188 | return $url; |
  | 1216 | 1189 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1262) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L1235) |  |
  | 1262 | 1235 | } |
  | 1263 | 1236 | $url           = self::get\_original\_url( $attachment\_id ); |
  | 1264 |  | $optimized\_url = ( new Optml\_Image( |
  | 1265 |  | $url, |
  | 1266 |  | [ |
  | 1267 |  | 'width'   => $data['width'], |
  | 1268 |  | 'height'  => $data['height'], |
  | 1269 |  | 'resize'  => $resize, |
  | 1270 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1271 |  | ], |
  | 1272 |  | $this->settings->get( 'cache\_buster' ) |
  | 1273 |  | ) )->get\_url(); |
  | 1274 |  | $optimized\_url = str\_replace( $url, $id\_filename[1], $optimized\_url ); |
  | 1275 |  | $image         = [ |
  | 1276 |  | $optimized\_url, |
  |  | 1237 |  |
  |  | 1238 | return [ |
  |  | 1239 | str\_replace( $url, $id\_filename[1], $this->get\_optimized\_image\_url( $url, $data['width'], $data['height'], $resize ) ), |
  | 1277 | 1240 | $data['width'], |
  | 1278 | 1241 | $data['height'], |
  | 1279 | 1242 | true, |
  | 1280 | 1243 | ]; |
  | 1281 |  |  |
  | 1282 |  | ~~return $image;~~ |
  | 1283 | 1244 | } |
  | 1284 | 1245 |  |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2467) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2428) |  |
  | 2467 | 2428 | $file = $meta['file']; |
  | 2468 | 2429 | if ( self::is\_uploaded\_image( $file ) ) { |
  | 2469 |  | $optimized\_url = ( new Optml\_Image( |
  | 2470 |  | $url, |
  | 2471 |  | [ |
  | 2472 |  | 'width'         => $args['width'], |
  | 2473 |  | 'height'        => $args['height'], |
  | 2474 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2475 |  | 'resize'        => $args['resize'], |
  | 2476 |  | 'attachment\_id' => $attachment\_id, |
  | 2477 |  | ], |
  | 2478 |  | $this->settings->get( 'cache\_buster' ) |
  | 2479 |  | ) )->get\_url(); |
  | 2480 |  |  |
  | 2481 |  | if ( strpos( $optimized\_url, $process\_flag ) !== false ) { |
  | 2482 |  | return $optimized\_url; |
  | 2483 |  | } |
  | 2484 |  |  |
  | 2485 |  | $process\_flag = $process\_flag . $file; |
  | 2486 |  |  |
  | 2487 |  | return str\_replace( '/' . $url, '/' . $process\_flag, $optimized\_url ); |
  |  | 2430 | $optimized\_url = $this->get\_optimized\_image\_url( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), $args['width'], $args['height'], $args['resize'] ); |
  |  | 2431 |  |
  |  | 2432 | return strpos( $optimized\_url, $process\_flag ) === false ? str\_replace( '/' . ltrim( $file, '/' ), '/' . $process\_flag . $file, $optimized\_url ) : $optimized\_url; |
  | 2488 | 2433 | } else { |
  | 2489 | 2434 | // this is for the users that already offloaded the images before the other fixes |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2496) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2441) |  |
  | 2496 | 2441 | $duplicated\_meta = wp\_get\_attachment\_metadata( $id ); |
  | 2497 | 2442 | if ( isset( $duplicated\_meta['file'] ) && self::is\_uploaded\_image( $duplicated\_meta['file'] ) ) { |
  | 2498 |  | $optimized\_url = ( new Optml\_Image( |
  | 2499 |  | $url, |
  | 2500 |  | [ |
  | 2501 |  | 'width'         => $args['width'], |
  | 2502 |  | 'height'        => $args['height'], |
  | 2503 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2504 |  | 'attachment\_id' => $attachment\_id, |
  | 2505 |  | ], |
  | 2506 |  | $this->settings->get( 'cache\_buster' ) |
  | 2507 |  | ) )->get\_url(); |
  | 2508 |  |  |
  | 2509 |  | return $optimized\_url; |
  |  | 2443 | return $this->get\_optimized\_image\_url( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), $args['width'], $args['height'], $args['resize'] ); |
  | 2510 | 2444 | } |
  | 2511 | 2445 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2514) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2448) |  |
  | 2514 | 2448 | } |
  | 2515 | 2449 | } |
  | 2516 |  |  |
  | 2517 | 2450 | return $url; |
  | 2518 | 2451 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2564) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2497) |  |
  | 2564 | 2497 |  |
  | 2565 | 2498 | // Build the optimized URL. |
  | 2566 |  | $optimized\_url = ( new Optml\_Image( |
  | 2567 |  | $url, |
  | 2568 |  | [ |
  | 2569 |  | 'width'         => $width, |
  | 2570 |  | 'height'        => $height, |
  | 2571 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2572 |  | 'resize'        => $resize, |
  | 2573 |  | 'attachment\_id' => $attachment\_id, |
  | 2574 |  | ], |
  | 2575 |  | $this->settings->get( 'cache\_buster' ) |
  | 2576 |  | ) )->get\_url(); |
  |  | 2499 | $optimized\_url = $this->get\_optimized\_image\_url( self::KEYS['not\_processed\_flag'] . $attachment\_id . '/' . ltrim( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), '/' ), $width, $height, $resize ); |
  | 2577 | 2500 |  |
  | 2578 | 2501 | // Drop any image size from the URL. |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2783) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2706) |  |
  | 2783 | 2706 | // Filter loaded data in the editors to use local attachments. |
  | 2784 | 2707 | add\_filter( 'content\_edit\_pre', [ self::$instance, 'replace\_urls\_in\_editor\_content' ], 10, 1 ); |
  | 2785 |  | $types = get\_post\_types\_by\_support( 'editor' ); |
  | 2786 |  | foreach ( $types as $type ) { |
  | 2787 |  | $post\_type = get\_post\_type\_object( $type ); |
  | 2788 |  | if ( property\_exists( $post\_type, 'show\_in\_rest' ) && true === $post\_type->show\_in\_rest ) { |
  | 2789 |  | add\_filter( |
  | 2790 |  | 'rest\_prepare\_' . $type, |
  | 2791 |  | [ |
  | 2792 |  | self::$instance, |
  | 2793 |  | 'pre\_filter\_rest\_content', |
  | 2794 |  | ], |
  | 2795 |  | 10, |
  | 2796 |  | 3 |
  | 2797 |  | ); |
  | 2798 |  | } |
  | 2799 |  | } |
  |  | 2708 |  |
  |  | 2709 | add\_action( |
  |  | 2710 | 'init', |
  |  | 2711 | function() { |
  |  | 2712 | $types = get\_post\_types\_by\_support( 'editor' ); |
  |  | 2713 |  |
  |  | 2714 | foreach ( $types as $type ) { |
  |  | 2715 |  |
  |  | 2716 | $post\_type = get\_post\_type\_object( $type ); |
  |  | 2717 |  |
  |  | 2718 | if ( property\_exists( $post\_type, 'show\_in\_rest' ) && true === $post\_type->show\_in\_rest ) { |
  |  | 2719 | add\_filter( 'rest\_prepare\_' . $type, [ self::$instance, 'pre\_filter\_rest\_content' ], 10, 3 ); |
  |  | 2720 | } |
  |  | 2721 | } |
  |  | 2722 | }, |
  |  | 2723 | PHP\_INT\_MAX |
  |  | 2724 | ); |
  | 2800 | 2725 |  |
  | 2801 | 2726 | add\_filter( 'get\_attached\_file', [ $this, 'alter\_attached\_file\_response' ], 10, 2 ); |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2861) | […](/browser/optimole-wp/tags/3.13.0/inc/media_offload.php?rev=3086306#L2786) |  |
  | 2861 | 2786 | return defined( 'OPTML\_PHPUNIT\_TESTING' ) && OPTML\_PHPUNIT\_TESTING === true; |
  | 2862 | 2787 | } |
  |  | 2788 |  |
  |  | 2789 | /\*\* |
  |  | 2790 | \* Get offloaded image attachment URL based on the given attachment ID and URL. |
  |  | 2791 | \* |
  |  | 2792 | \* @param mixed  $attachment\_id The attachment ID. |
  |  | 2793 | \* @param string $url           The attachment URL. |
  |  | 2794 | \* |
  |  | 2795 | \* @return string |
  |  | 2796 | \*/ |
  |  | 2797 | private function get\_offloaded\_attachment\_url( $attachment\_id, $url ) { |
  |  | 2798 | if ( ! $this->settings->is\_offload\_enabled() || ! is\_numeric( $attachment\_id ) ) { |
  |  | 2799 | return $url; |
  |  | 2800 | } elseif ( empty( $attachment\_id ) && strpos( $url, self::KEYS['not\_processed\_flag'] ) !== false ) { |
  |  | 2801 | $attachment\_id = (int) self::get\_attachment\_id\_from\_url( $url ); |
  |  | 2802 | } elseif ( empty( $attachment\_id ) ) { |
  |  | 2803 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $url ); |
  |  | 2804 | } |
  |  | 2805 |  |
  |  | 2806 | if ( $attachment\_id > 0 || ! empty( get\_post\_meta( $attachment\_id, self::OM\_OFFLOADED\_FLAG, true ) ) ) { |
  |  | 2807 | $url = wp\_get\_attachment\_metadata( $attachment\_id )['file']; |
  |  | 2808 | } |
  |  | 2809 |  |
  |  | 2810 | return $url; |
  |  | 2811 | } |
  | 2863 | 2812 | } |
* ## [optimole-wp/tags/3.13.0/inc/rest.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/rest.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/rest.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L7 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/rest.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \* @license     http://opensource.org/licenses/gpl-2.0.php GNU Public License |
  | 8 | 8 | \*/ |
  |  | 9 |  |
  |  | 10 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 11 | use Optimole\Sdk\ValueObject\Position; |
  | 9 | 12 |  |
  | 10 | 13 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L272) | […](/browser/optimole-wp/tags/3.13.0/inc/rest.php?rev=3086306#L275) |  |
  | 272 | 275 |  |
  | 273 | 276 | if ( $data === false || is\_wp\_error( $data ) ) { |
  | 274 |  | if ( $data->get\_error\_code() === 'domain\_not\_accessible' ) { |
  | 275 |  | return $this->response( $data->get\_error\_message(), 400 ); |
  | 276 |  | } |
  |  | 277 |  |
  | 277 | 278 | $extra = ''; |
  | 278 | 279 | if ( is\_wp\_error( $data ) ) { |
  |  | 280 | if ( $data->get\_error\_code() === 'domain\_not\_accessible' ) { |
  |  | 281 | return $this->response( $data->get\_error\_message(), 400 ); |
  |  | 282 | } |
  | 279 | 283 | /\*\* |
  | 280 | 284 | \* Error from api. |
  | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L608) | […](/browser/optimole-wp/tags/3.13.0/inc/rest.php?rev=3086306#L612) |  |
  | 608 | 612 | 140, |
  | 609 | 613 | [ |
  | 610 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 614 | 'type'    => ResizeTypeProperty::FILL, |
  | 611 | 615 | 'enlarge' => false, |
  | 612 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 616 | 'gravity' => Position::CENTER, |
  | 613 | 617 | ] |
  | 614 | 618 | ); |
* ## [optimole-wp/tags/3.13.0/inc/settings.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/settings.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/settings.php")

  | [r3073660](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L1 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/settings.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 4 |  |
  | 3 | 5 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L74) | […](/browser/optimole-wp/tags/3.13.0/inc/settings.php?rev=3086306#L76) |  |
  | 74 | 76 | 'wm\_id'                      => - 1, |
  | 75 | 77 | 'wm\_opacity'                 => 1, |
  | 76 |  | 'wm\_position'                => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  |  | 78 | 'wm\_position'                => Position::SOUTH\_EAST, |
  | 77 | 79 | 'wm\_x'                       => 0, |
  | 78 | 80 | 'wm\_y'                       => 0, |
  | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L338) | […](/browser/optimole-wp/tags/3.13.0/inc/settings.php?rev=3086306#L340) |  |
  | 338 | 340 | $value, |
  | 339 | 341 | [ |
  | 340 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 341 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 342 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 343 |  | ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  | 344 |  | ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 345 |  | ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 346 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  | 347 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 348 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  |  | 342 | Position::NORTH, |
  |  | 343 | Position::NORTH\_EAST, |
  |  | 344 | Position::NORTH\_WEST, |
  |  | 345 | Position::CENTER, |
  |  | 346 | Position::EAST, |
  |  | 347 | Position::WEST, |
  |  | 348 | Position::SOUTH\_EAST, |
  |  | 349 | Position::SOUTH, |
  |  | 350 | Position::SOUTH\_WEST, |
  | 349 | 351 | ], |
  | 350 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST |
  |  | 352 | Position::SOUTH\_EAST |
  | 351 | 353 | ); |
  | 352 | 354 | break; |
* ## [optimole-wp/tags/3.13.0/inc/tag\_replacer.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/tag_replacer.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/tag_replacer.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/tag_replacer.php?rev=3071327#L491 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/tag_replacer.php?rev=3086306#L491 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 491 | 491 | $sizes['height'] = $image\_resized[7]; |
  | 492 | 492 | } |
  | 493 |  |  |
  |  | 493 | // There are cases when the image meta is missing and image size is non existent, see SVG image handling. |
  |  | 494 | if ( ! $sizes['width'] || ! $sizes['height'] ) { |
  |  | 495 | break; |
  |  | 496 | } |
  | 494 | 497 | list( $sizes['width'], $sizes['height'] ) = image\_constrain\_size\_for\_editor( $sizes['width'], $sizes['height'], $size, 'display' ); |
  | 495 | 498 |  |
* ## [optimole-wp/tags/3.13.0/inc/traits/dam\_offload\_utils.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php")

  | [r3005642](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L224 "Show revision 3005642 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php?rev=3086306#L224 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 224 | 224 | return strpos( $url, '-scaled.' ) !== false; |
  | 225 | 225 | } |
  |  | 226 |  |
  |  | 227 | /\*\* |
  |  | 228 | \* Check if the image has been offloaded completely. |
  |  | 229 | \* |
  |  | 230 | \* @param int $id The attachment ID. |
  |  | 231 | \* |
  |  | 232 | \* @return bool |
  |  | 233 | \*/ |
  |  | 234 | private function is\_completed\_offload( $id ) { |
  |  | 235 | // This is the flag that is used to mark the image as offloaded at the end. |
  |  | 236 | $completed = ! empty( get\_post\_meta( $id, Optml\_Media\_Offload::OM\_OFFLOADED\_FLAG, true ) ); |
  |  | 237 | if ( $completed ) { |
  |  | 238 | return true; |
  |  | 239 | } |
  |  | 240 | // In some rare cases the image is offloaded but the flag is not set so we can alternatively check this using the file path. |
  |  | 241 | $meta = wp\_get\_attachment\_metadata( $id ); |
  |  | 242 | if ( ! isset( $meta['file'] ) ) { |
  |  | 243 | return false; |
  |  | 244 | } |
  |  | 245 | if ( Optml\_Media\_Offload::is\_uploaded\_image( $meta['file'] ) ) { |
  |  | 246 | return true; |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 | return false; |
  |  | 250 | } |
  | 226 | 251 | /\*\* |
  | 227 | 252 | \* Get the attachment ID from URL. |
  | 228 | 253 | \* |
  | 229 |  | \* @param string $url The attachment URL. |
  |  | 254 | \* @param string $input\_url The attachment URL. |
  | 230 | 255 | \* |
  | 231 | 256 | \* @return int |
  | 232 | 257 | \*/ |
  | 233 |  | private function attachment\_url\_to\_post\_id( $url ) { |
  | 234 |  | $cached = Optml\_Attachment\_Cache::get\_cached\_attachment\_id( $url ); |
  |  | 258 | private function attachment\_url\_to\_post\_id( $input\_url ) { |
  |  | 259 | $cached = Optml\_Attachment\_Cache::get\_cached\_attachment\_id( $input\_url ); |
  | 235 | 260 |  |
  | 236 | 261 | if ( $cached !== false ) { |
  | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L238) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php?rev=3086306#L263) |  |
  | 238 | 263 | } |
  | 239 | 264 |  |
  | 240 |  | $url = $this->strip\_image\_size( $url ); |
  |  | 265 | $url = $this->strip\_image\_size( $input\_url ); |
  | 241 | 266 |  |
  | 242 | 267 | $attachment\_id = attachment\_url\_to\_postid( $url ); |
  | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L248) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/dam_offload_utils.php?rev=3086306#L273) |  |
  | 248 | 273 | } |
  | 249 | 274 |  |
  | 250 |  | Optml\_Attachment\_Cache::set\_cached\_attachment\_id( $url, $attachment\_id ); |
  |  | 275 | /\* |
  |  | 276 | \* TODO: The logic is a mess, we need to refactor at some point. |
  |  | 277 | \* Websites may transition between 'www' subdomains and apex domains, potentially breaking references to hosted images. This can cause issues when attempting to match attachment IDs if images are linked using outdated domains. The logic is checking for alternative domains and consider the use of 'scaled' prefixes in image URLs for large images, which might affect ID matching. |
  |  | 278 | \*/ |
  |  | 279 | if ( $attachment\_id === 0 ) { |
  |  | 280 | if ( strpos( $url, 'www.' ) !== false ) { |
  |  | 281 | $variant\_url   = str\_replace( 'www.', '', $url ); |
  |  | 282 | $attachment\_id = attachment\_url\_to\_postid( $variant\_url ); |
  |  | 283 | } else { |
  |  | 284 | $variant\_url   = str\_replace( '://', '://www.', $url ); |
  |  | 285 | $attachment\_id = attachment\_url\_to\_postid( $variant\_url ); |
  |  | 286 | } |
  |  | 287 | if ( $attachment\_id === 0 && ! $this->is\_scaled\_url( $variant\_url ) ) { |
  |  | 288 | $scaled\_url = $this->get\_scaled\_url( $variant\_url ); |
  |  | 289 |  |
  |  | 290 | $attachment\_id = attachment\_url\_to\_postid( $scaled\_url ); |
  |  | 291 | } |
  |  | 292 | } |
  |  | 293 | Optml\_Attachment\_Cache::set\_cached\_attachment\_id( $input\_url, $attachment\_id ); |
  | 251 | 294 |  |
  | 252 | 295 | return $attachment\_id; |
* ## [optimole-wp/tags/3.13.0/inc/traits/normalizer.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/traits/normalizer.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/traits/normalizer.php")

  | [r2935150](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L1 "Show revision 2935150 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L168) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L171) |  |
  | 168 | 171 | if ( $crop\_args === true ) { |
  | 169 | 172 | return [ |
  | 170 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 173 | 'type'    => ResizeTypeProperty::FILL, |
  | 171 | 174 | 'enlarge' => $enlarge, |
  | 172 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 175 | 'gravity' => Position::CENTER, |
  | 173 | 176 | ]; |
  | 174 | 177 | } |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L188) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L191) |  |
  | 188 | 191 | ]; |
  | 189 | 192 | $allowed\_gravities = [ |
  | 190 |  | 'left'         => ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 191 |  | 'right'        => ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 192 |  | 'top'          => ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 193 |  | 'bottom'       => ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 194 |  | 'lefttop'      => ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 195 |  | 'leftbottom'   => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  | 196 |  | 'righttop'     => ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 197 |  | 'rightbottom'  => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  |  | 193 | 'left'         => Position::WEST, |
  |  | 194 | 'right'        => Position::EAST, |
  |  | 195 | 'top'          => Position::NORTH, |
  |  | 196 | 'bottom'       => Position::SOUTH, |
  |  | 197 | 'lefttop'      => Position::NORTH\_WEST, |
  |  | 198 | 'leftbottom'   => Position::SOUTH\_WEST, |
  |  | 199 | 'righttop'     => Position::NORTH\_EAST, |
  |  | 200 | 'rightbottom'  => Position::SOUTH\_EAST, |
  | 198 | 201 | 'centertop'    => [ 0.5, 0 ], |
  | 199 | 202 | 'centerbottom' => [ 0.5, 1 ], |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L202) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L205) |  |
  | 202 | 205 | ]; |
  | 203 | 206 |  |
  | 204 |  | $gravity    = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 207 | $gravity    = Position::CENTER; |
  | 205 | 208 | $key\_search = ( $crop\_args[0] === true ? '' : |
  | 206 | 209 | ( isset( $allowed\_x[ $crop\_args[0] ] ) ? $crop\_args[0] : '' ) ) . |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L213) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L216) |  |
  | 213 | 216 |  |
  | 214 | 217 | return [ |
  | 215 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 218 | 'type'    => ResizeTypeProperty::FILL, |
  | 216 | 219 | 'enlarge' => $enlarge, |
  | 217 | 220 | 'gravity' => $gravity, |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L228) | […](/browser/optimole-wp/tags/3.13.0/inc/traits/normalizer.php?rev=3086306#L231) |  |
  | 228 | 231 | public function to\_optml\_watermark( $watermark\_args = [] ) { |
  | 229 | 232 | $allowed\_gravities = [ |
  | 230 |  | 'left'         => ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 231 |  | 'right'        => ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 232 |  | 'top'          => ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 233 |  | 'bottom'       => ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 234 |  | 'left\_top'     => ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 235 |  | 'left\_bottom'  => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  | 236 |  | 'right\_top'    => ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 237 |  | 'right\_bottom' => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  | 238 |  | ]; |
  | 239 |  | $gravity           = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 233 | 'left'         => Position::WEST, |
  |  | 234 | 'right'        => Position::EAST, |
  |  | 235 | 'top'          => Position::NORTH, |
  |  | 236 | 'bottom'       => Position::SOUTH, |
  |  | 237 | 'left\_top'     => Position::NORTH\_WEST, |
  |  | 238 | 'left\_bottom'  => Position::SOUTH\_WEST, |
  |  | 239 | 'right\_top'    => Position::NORTH\_EAST, |
  |  | 240 | 'right\_bottom' => Position::SOUTH\_EAST, |
  |  | 241 | ]; |
  |  | 242 | $gravity           = Position::CENTER; |
  | 240 | 243 | if ( isset( $watermark\_args['position'] ) && array\_key\_exists( $watermark\_args['position'], $allowed\_gravities ) ) { |
  | 241 | 244 | $gravity = $allowed\_gravities[ $watermark\_args['position'] ]; |
* ## [optimole-wp/tags/3.13.0/inc/url\_replacer.php](/changeset/3086306/optimole-wp/tags/3.13.0/inc/url_replacer.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/inc/url_replacer.php")

  | [r3005642](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L1 "Show revision 3005642 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  |  | 4 | use Optimole\Sdk\Resource\Image; |
  |  | 5 | use Optimole\Sdk\Resource\ImageProperty\GravityProperty; |
  |  | 6 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 7 |  |
  | 3 | 8 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L38) | […](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L43) |  |
  | 38 | 43 | } |
  | 39 | 44 |  |
  | 40 |  | ~~/\*\*~~ |
  | 41 |  | ~~\* A filter which turns a local url into an optimized CDN image url or an array of image urls.~~ |
  | 42 |  | ~~\*~~ |
  | 43 |  | ~~\* @param string|array $url The url which should be replaced.~~ |
  | 44 |  | ~~\*~~ |
  | 45 |  | ~~\* @return string|array Replaced url.~~ |
  | 46 |  | ~~\*/~~ |
  | 47 |  | ~~public function replace\_option\_url( $url ) {~~ |
  | 48 |  | ~~if ( empty( $url ) ) {~~ |
  | 49 |  | ~~return $url;~~ |
  | 50 |  | ~~}~~ |
  | 51 |  |  |
  | 52 |  | ~~// $url might be an array or an json encoded array with urls.~~ |
  | 53 |  | ~~if ( is\_array( $url ) || filter\_var( $url, FILTER\_VALIDATE\_URL ) === false ) {~~ |
  | 54 |  | ~~$array   = $url;~~ |
  | 55 |  | ~~$encoded = false;~~ |
  | 56 |  |  |
  | 57 |  | ~~// it might a json encoded array~~ |
  | 58 |  | ~~if ( is\_string( $url ) ) {~~ |
  | 59 |  | ~~$array   = json\_decode( $url, true );~~ |
  | 60 |  | ~~$encoded = true;~~ |
  | 61 |  | ~~}~~ |
  | 62 |  |  |
  | 63 |  | ~~// in case there is an array, apply it recursively.~~ |
  | 64 |  | ~~if ( is\_array( $array ) ) {~~ |
  | 65 |  | ~~foreach ( $array as $index => $value ) {~~ |
  | 66 |  | ~~$array[ $index ] = $this->replace\_option\_url( $value );~~ |
  | 67 |  | ~~}~~ |
  | 68 |  |  |
  | 69 |  | ~~if ( $encoded ) {~~ |
  | 70 |  | ~~return json\_encode( $array );~~ |
  | 71 |  | ~~}~~ |
  | 72 |  |  |
  | 73 |  | ~~return $array;~~ |
  | 74 |  | ~~}~~ |
  | 75 |  |  |
  | 76 |  | ~~if ( filter\_var( $url, FILTER\_VALIDATE\_URL ) === false ) {~~ |
  | 77 |  | ~~return $url;~~ |
  | 78 |  | ~~}~~ |
  | 79 |  | ~~}~~ |
  | 80 |  |  |
  | 81 |  | ~~return apply\_filters( 'optml\_content\_url', $url );~~ |
  | 82 |  | ~~}~~ |
  | 83 | 45 |  |
  | 84 | 46 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L90) | […](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L52) |  |
  | 90 | 52 | parent::init(); |
  | 91 | 53 |  |
  | 92 |  | ~~Optml\_Quality::$default\_quality = $this->to\_accepted\_quality( $this->settings->get\_quality() );~~ |
  | 93 |  | ~~Optml\_Image::$watermark         = new Optml\_Watermark( $this->settings->get\_site\_settings()['watermark'] );~~ |
  | 94 |  | ~~Optml\_Resize::$default\_enlarge  = apply\_filters( 'optml\_always\_enlarge', false );~~ |
  | 95 | 54 | add\_filter( 'optml\_content\_url', [ $this, 'build\_url' ], 1, 2 ); |
  | 96 | 55 |  |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L191) | […](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L150) |  |
  | 191 | 150 | } |
  | 192 | 151 | } else { |
  | 193 |  | $new\_url = ( new Optml\_Asset( $url, $args, $this->active\_cache\_buster\_assets, $this->is\_css\_minify\_on, $this->is\_js\_minify\_on ) )->get\_url(); |
  |  | 152 | $asset = Optimole::asset( $url, $this->active\_cache\_buster\_assets ); |
  |  | 153 |  |
  |  | 154 | if ( stripos( $url, '.css' ) || stripos( $url, '.js' ) ) { |
  |  | 155 | $asset->quality(); |
  |  | 156 | } |
  |  | 157 |  |
  |  | 158 | $asset->minify( ( $this->is\_css\_minify\_on && str\_ends\_with( strtolower( $url ), '.css' ) ) || ( $this->is\_js\_minify\_on && str\_ends\_with( strtolower( $url ), '.js' ) ) ); |
  |  | 159 |  |
  |  | 160 | return $asset->getUrl(); |
  | 194 | 161 | } |
  | 195 | 162 | return $is\_slashed ? addcslashes( $new\_url, '/' ) : $new\_url; |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L253) | […](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L220) |  |
  | 253 | 220 | } |
  | 254 | 221 |  |
  |  | 222 | if ( empty( $args['quality'] ) ) { |
  |  | 223 | $args['quality'] = $this->to\_accepted\_quality( $this->settings->get\_quality() ); |
  |  | 224 | } |
  |  | 225 |  |
  | 255 | 226 | if ( isset( $args['resize'], $args['resize']['gravity'] ) && $this->settings->is\_smart\_cropping() ) { |
  | 256 |  | $args['resize']['gravity'] = ~~Optml\_Resize::GRAVITY\_~~SMART; |
  |  | 227 | $args['resize']['gravity'] = GravityProperty::SMART; |
  | 257 | 228 | } |
  | 258 | 229 |  |
  | 259 | 230 | $args = apply\_filters( 'optml\_image\_args', $args, $original\_url ); |
  | 260 |  |  |
  | 261 |  | $arguments = [ |
  | 262 |  | 'apply\_watermark' => apply\_filters( 'optml\_apply\_watermark\_for', true, $url ), |
  | 263 |  | ]; |
  | 264 |  |  |
  | 265 |  | if ( isset( $args['format'] ) && ! empty( $args['format'] ) ) { |
  | 266 |  | $arguments['format'] = $args['format']; |
  | 267 |  | } |
  | 268 |  |  |
  | 269 |  | // If format is not already set, we use best format if it's enabled. |
  | 270 |  | if ( ! isset( $arguments['format'] ) && $this->settings->is\_best\_format() ) { |
  | 271 |  | $arguments['format'] = 'best'; |
  |  | 231 | $image = Optimole::image( apply\_filters( 'optml\_processed\_url', $url ), $this->active\_cache\_buster ); |
  |  | 232 |  |
  |  | 233 | $image->width( ! empty( $args['width'] ) ? $args['width'] : 'auto' ); |
  |  | 234 | $image->height( ! empty( $args['height'] ) ? $args['height'] : 'auto' ); |
  |  | 235 |  |
  |  | 236 | $image->quality( $args['quality'] ); |
  |  | 237 |  |
  |  | 238 | if ( ! empty( $args['resize'] ) ) { |
  |  | 239 | $this->apply\_resize( $image, $args['resize'] ); |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | if ( apply\_filters( 'optml\_apply\_watermark\_for', true, $url ) ) { |
  |  | 243 | $this->apply\_watermark( $image ); |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | if ( ! empty( $args['format'] ) ) { |
  |  | 247 | $image->format( (string) $args['format'] ); |
  |  | 248 | } elseif ( $this->settings->is\_best\_format() ) { |
  |  | 249 | // If format is not already set, we use best format if it's enabled. |
  |  | 250 | $image->format( 'best' ); |
  | 272 | 251 | } |
  | 273 | 252 |  |
  | 274 | 253 | if ( $this->settings->get( 'strip\_metadata' ) === 'disabled' ) { |
  | 275 |  | $arguments['strip\_metadata'] = '0'; |
  | 276 |  | } |
  | 277 |  |  |
  | 278 |  | if ( ! apply\_filters( 'optml\_should\_avif\_ext', true, $ext, $original\_url ) ) { |
  | 279 |  | $arguments['ignore\_avif'] = true; |
  | 280 |  | } |
  | 281 |  |  |
  | 282 |  | if ( ! isset( $arguments['ignore\_avif'] ) && $this->settings->get( 'avif' ) === 'disabled' ) { |
  | 283 |  | $arguments['ignore\_avif'] = true; |
  | 284 |  | } |
  | 285 |  |  |
  | 286 |  | return  ( new Optml\_Image( $url, $args, $this->active\_cache\_buster ) )->get\_url( $arguments ); |
  | 287 |  |  |
  |  | 254 | $image->stripMetadata( false ); |
  |  | 255 | } |
  |  | 256 |  |
  |  | 257 | if ( ! apply\_filters( 'optml\_should\_avif\_ext', true, $ext, $original\_url ) || $this->settings->get( 'avif' ) === 'disabled' ) { |
  |  | 258 | $image->ignoreAvif(); |
  |  | 259 | } |
  |  | 260 |  |
  |  | 261 | if ( apply\_filters( 'optml\_keep\_copyright', false ) === true ) { |
  |  | 262 | $image->keepCopyright(); |
  |  | 263 | } |
  |  | 264 |  |
  |  | 265 | if ( $this->is\_dam\_url( $image->getSource() ) ) { |
  |  | 266 | return $this->get\_dam\_url( $image ); |
  |  | 267 | } |
  |  | 268 |  |
  |  | 269 | $offloaded\_id = $this->is\_offloaded\_url( $image->getSource() ); |
  |  | 270 |  |
  |  | 271 | if ( $offloaded\_id !== 0 ) { |
  |  | 272 | return $this->get\_offloaded\_url( $offloaded\_id, $image->getUrl(), $image->getSource() ); |
  |  | 273 | } |
  |  | 274 |  |
  |  | 275 | return $image->getUrl(); |
  | 288 | 276 | } |
  | 289 | 277 |  |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L316) | […](/browser/optimole-wp/tags/3.13.0/inc/url_replacer.php?rev=3086306#L304) |  |
  | 316 | 304 | \_doing\_it\_wrong( \_\_FUNCTION\_\_, esc\_html\_\_( 'Cheatin&#8217; huh?', 'optimole-wp' ), '1.0.0' ); |
  | 317 | 305 | } |
  |  | 306 |  |
  |  | 307 | /\*\* |
  |  | 308 | \* Apply resize to image. |
  |  | 309 | \* |
  |  | 310 | \* @param Image $image Image object. |
  |  | 311 | \* @param mixed $resize Resize arguments. |
  |  | 312 | \*/ |
  |  | 313 | private function apply\_resize( Image $image, $resize ) { |
  |  | 314 | if ( ! is\_array( $resize ) || empty( $resize['type'] ) ) { |
  |  | 315 | return; |
  |  | 316 | } |
  |  | 317 |  |
  |  | 318 | $image->resize( $resize['type'], $resize['gravity'] ?? Position::CENTER, $resize['enlarge'] ?? false ); |
  |  | 319 | } |
  |  | 320 |  |
  |  | 321 | /\*\* |
  |  | 322 | \* Apply watermark to image. |
  |  | 323 | \* |
  |  | 324 | \* @param Image $image Image object. |
  |  | 325 | \*/ |
  |  | 326 | private function apply\_watermark( Image $image ) { |
  |  | 327 | $settings = $this->settings->get\_site\_settings(); |
  |  | 328 |  |
  |  | 329 | if ( empty( $settings['watermark'] ) ) { |
  |  | 330 | return; |
  |  | 331 | } |
  |  | 332 |  |
  |  | 333 | $watermark = $settings['watermark']; |
  |  | 334 |  |
  |  | 335 | if ( ! isset( $watermark['id'], $watermark['opacity'], $watermark['position'] ) || $watermark['id'] <= 0 ) { |
  |  | 336 | return; |
  |  | 337 | } |
  |  | 338 |  |
  |  | 339 | $image->watermark( $watermark['id'], $watermark['opacity'], $watermark['position'], $watermark['x\_offset'] ?? 0, $watermark['y\_offset'] ?? 0, $watermark['scale'] ?? 0 ); |
  |  | 340 | } |
  |  | 341 |  |
  |  | 342 | /\*\* |
  |  | 343 | \* Get the DAM image URL. |
  |  | 344 | \* |
  |  | 345 | \* @param Image $image Image object. |
  |  | 346 | \* |
  |  | 347 | \* @return string |
  |  | 348 | \*/ |
  |  | 349 | private function get\_dam\_url( Image $image ) { |
  |  | 350 | // Remove DAM flag. |
  |  | 351 | $url = str\_replace( Optml\_Dam::URL\_DAM\_FLAG, '', $image->getSource() ); |
  |  | 352 |  |
  |  | 353 | foreach ( $image->getProperties() as $property ) { |
  |  | 354 | [ $name, $value ] = explode( ':', $property ); |
  |  | 355 |  |
  |  | 356 | // Check if the property exists in the URL, if so, replace it with the current property value. Otherwise, add it before the /q: param. |
  |  | 357 | $url = strpos( $url, '/' . $name . ':' ) !== false |
  |  | 358 | ? preg\_replace( '/\/' . $name . ':.\*?\//', '/' . $name . ':' . $value . '/', $url ) |
  |  | 359 | : str\_replace( '/q:', '/' . $name . ':' . $value . '/q:', $url ); |
  |  | 360 | } |
  |  | 361 |  |
  |  | 362 | return $url; |
  |  | 363 | } |
  |  | 364 |  |
  |  | 365 | /\*\* |
  |  | 366 | \* Check if this contains the DAM flag. |
  |  | 367 | \* |
  |  | 368 | \* @param string $url The URL to check. |
  |  | 369 | \* |
  |  | 370 | \* @return bool |
  |  | 371 | \*/ |
  |  | 372 | private function is\_dam\_url( $url ) { |
  |  | 373 | return is\_string( $url ) && strpos( $url, Optml\_Dam::URL\_DAM\_FLAG ) !== false; |
  |  | 374 | } |
  |  | 375 |  |
  |  | 376 | /\*\* |
  |  | 377 | \* Check if the URL is offloaded. |
  |  | 378 | \* |
  |  | 379 | \* @param string $source\_url The source image URL. |
  |  | 380 | \* |
  |  | 381 | \* @return int |
  |  | 382 | \*/ |
  |  | 383 | private function is\_offloaded\_url( $source\_url ) { |
  |  | 384 | $attachment\_id = 0; |
  |  | 385 |  |
  |  | 386 | if ( strpos( $source\_url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] ) !== false ) { |
  |  | 387 | $attachment\_id = (int) Optml\_Media\_Offload::get\_attachment\_id\_from\_url( $source\_url ); |
  |  | 388 | } else { |
  |  | 389 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $source\_url ); |
  |  | 390 | } |
  |  | 391 |  |
  |  | 392 | if ( $attachment\_id === 0 ) { |
  |  | 393 | return 0; |
  |  | 394 | } |
  |  | 395 |  |
  |  | 396 | if ( ! $this->is\_completed\_offload( $attachment\_id ) ) { |
  |  | 397 | return 0; |
  |  | 398 | } |
  |  | 399 |  |
  |  | 400 | return (int) $attachment\_id; |
  |  | 401 | } |
  |  | 402 |  |
  |  | 403 | /\*\* |
  |  | 404 | \* Get the offloaded URL for an image. |
  |  | 405 | \* |
  |  | 406 | \* @param int    $id The attachment ID. |
  |  | 407 | \* @param string $optimized\_url The optimized image URL. |
  |  | 408 | \* @param string $source\_url The source image URL. |
  |  | 409 | \* |
  |  | 410 | \* @return string |
  |  | 411 | \*/ |
  |  | 412 | private function get\_offloaded\_url( $id, $optimized\_url, $source\_url ) { |
  |  | 413 | $suffix   = wp\_get\_attachment\_metadata( $id )['file']; |
  |  | 414 |  |
  |  | 415 | return str\_replace( $source\_url, ltrim( $suffix, '/' ), $optimized\_url ); |
  |  | 416 | } |
  | 318 | 417 | } |
* ## [optimole-wp/tags/3.13.0/optimole-wp.php](/changeset/3086306/optimole-wp/tags/3.13.0/optimole-wp.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/optimole-wp.php")

  | [r3073660](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L3 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/optimole-wp.php?rev=3086306#L3 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name:       Image optimization service by Optimole |
  | 4 | 4 | \* Description:       Complete handling of your website images. |
  | 5 |  | \* Version:           3.1~~2.1~~0 |
  |  | 5 | \* Version:           3.13.0 |
  | 6 | 6 | \* Author:            Optimole |
  | 7 | 7 | \* Author URI:        https://optimole.com |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L62) | […](/browser/optimole-wp/tags/3.13.0/optimole-wp.php?rev=3086306#L62) |  |
  | 62 | 62 | \_\_( '%1$s You\'re using a PHP version lower than %2$s! %3$sOptimole%4$s requires at least %5$sPHP %2$s%6$s to function properly. Plugin has been deactivated. %7$sLearn more here%8$s. %9$s', 'optimole-wp' ), |
  | 63 | 63 | '<p>', |
  | 64 |  | '~~5~~.4', |
  |  | 64 | '7.4', |
  | 65 | 65 | '<b>', |
  | 66 | 66 | '</b>', |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L82) | […](/browser/optimole-wp/tags/3.13.0/optimole-wp.php?rev=3086306#L82) |  |
  | 82 | 82 | \*/ |
  | 83 | 83 | function optml() { |
  | 84 |  | if ( version\_compare( PHP\_VERSION, '~~5~~.4.0', '<' ) ) { |
  |  | 84 | if ( version\_compare( PHP\_VERSION, '7.4.0', '<' ) ) { |
  | 85 | 85 | add\_action( 'admin\_notices', 'optml\_php\_notice' ); |
  | 86 | 86 | add\_action( 'admin\_init', 'optml\_deactivate' ); |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L90) | […](/browser/optimole-wp/tags/3.13.0/optimole-wp.php?rev=3086306#L90) |  |
  | 90 | 90 | define( 'OPTML\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) ); |
  | 91 | 91 | define( 'OPTML\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
  | 92 |  | define( 'OPTML\_VERSION', '3.1~~2.1~~0' ); |
  |  | 92 | define( 'OPTML\_VERSION', '3.13.0' ); |
  | 93 | 93 | define( 'OPTML\_NAMESPACE', 'optml' ); |
  | 94 | 94 | define( 'OPTML\_BASEFILE', \_\_FILE\_\_ ); |
* ## [optimole-wp/tags/3.13.0/readme.txt](/changeset/3086306/optimole-wp/tags/3.13.0/readme.txt "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/readme.txt")

  | [r3086305](/browser/optimole-wp/trunk/readme.txt?rev=3086305#L5 "Show revision 3086305 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/readme.txt?rev=3086306#L5 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 7.4 |
  | 7 |  | Stable tag: 3.1~~2.1~~0 |
  |  | 7 | Stable tag: 3.13.0 |
  | 8 | 8 | License: GPLv3 |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-3.0.en.html |
  | […](/browser/optimole-wp/trunk/readme.txt?rev=3086305#L151) | […](/browser/optimole-wp/tags/3.13.0/readme.txt?rev=3086306#L151) |  |
  | 151 | 151 | == Changelog == |
  | 152 | 152 |  |
  | 153 |  | ##### [Version 3.12.10](https://github.com/Codeinwp/optimole-wp/compare/v3.12.9...v3.12.10) (2024-04-19) |
  | 154 |  |  |
  | 155 |  | - Addressed an issue with offloading/rollback transfers getting stuck by adding a check for scheduled cron jobs. If no cron is scheduled and a transfer is in progress, the cron will be rescheduled. |
  |  | 153 | #### [Version 3.13.0](https://github.com/Codeinwp/optimole-wp/compare/v3.12.10...v3.13.0) (2024-05-14) |
  |  | 154 |  |
  |  | 155 | - Optimole is now fully translated into German! This update makes our service more convenient for our German-speaking customers and helps you support your German-speaking clients more effectively. |
  |  | 156 | - We now have a PHP SDK available on GitHub: [Optimole PHP SDK](https://github.com/Optimole/optimole-php-sdk). This SDK simplifies the integration of Optimole’s features with any PHP-based website, making the process straightforward and efficient. |
  |  | 157 | - You can now associate a billing email to receive invoices. For more details, check out our [documentation](https://docs.optimole.com/article/1992-setting-a-billing-email-for-invoice-delivery). |
  |  | 158 | - Weve improved Largest Contentful Paint (LCP) by prioritizing the loading of initial images that are not affected by lazy loading. |
  |  | 159 | - Weve also improved LCP by using the srcset attribute for non-lazyloaded images. |
  |  | 160 | - Weve fixed various issues with offload compatibility to ensure all images load properly, making the service more robust. |
  |  | 161 | - Weve resolved an issue where the offloading process was getting stuck on large websites, making the process smoother and more reliable. |
  |  | 162 | - Weve improved the handling and sanitization of SVG files. |
  | 156 | 163 |  |
  | 157 | 164 |  |
* ## [optimole-wp/tags/3.13.0/vendor/autoload.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/autoload.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/autoload.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/autoload.php?rev=3056805#L23 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/autoload.php?rev=3086306#L23 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 24 | 24 |  |
  | 25 |  | return ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4::getLoader(); |
* ## [optimole-wp/tags/3.13.0/vendor/composer/autoload\_classmap.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/autoload_classmap.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/autoload_classmap.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_classmap.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_classmap.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'Attribute' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/Attribute.php', |
  | 9 | 10 | 'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php', |
  |  | 11 | 'Optimole\\Sdk\\Optimole' => $vendorDir . '/codeinwp/optimole-sdk/src/Optimole.php', |
  |  | 12 | 'Optimole\\Sdk\\Resource\\AbstractResource' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AbstractResource.php', |
  |  | 13 | 'Optimole\\Sdk\\Resource\\Asset' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/Asset.php', |
  |  | 14 | 'Optimole\\Sdk\\Resource\\AssetProperty\\MinifyProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php', |
  |  | 15 | 'Optimole\\Sdk\\Resource\\AssetProperty\\TypeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php', |
  |  | 16 | 'Optimole\\Sdk\\Resource\\CacheBusterProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php', |
  |  | 17 | 'Optimole\\Sdk\\Resource\\Image' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/Image.php', |
  |  | 18 | 'Optimole\\Sdk\\Resource\\ImageProperty\\EnlargeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php', |
  |  | 19 | 'Optimole\\Sdk\\Resource\\ImageProperty\\FormatProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php', |
  |  | 20 | 'Optimole\\Sdk\\Resource\\ImageProperty\\GravityProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php', |
  |  | 21 | 'Optimole\\Sdk\\Resource\\ImageProperty\\HeightProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php', |
  |  | 22 | 'Optimole\\Sdk\\Resource\\ImageProperty\\IgnoreAvifProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php', |
  |  | 23 | 'Optimole\\Sdk\\Resource\\ImageProperty\\KeepCopyrightProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php', |
  |  | 24 | 'Optimole\\Sdk\\Resource\\ImageProperty\\QualityProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php', |
  |  | 25 | 'Optimole\\Sdk\\Resource\\ImageProperty\\ResizeTypeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php', |
  |  | 26 | 'Optimole\\Sdk\\Resource\\ImageProperty\\StripMetadataProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php', |
  |  | 27 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WatermarkProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php', |
  |  | 28 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WidthProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php', |
  |  | 29 | 'Optimole\\Sdk\\Resource\\PropertyInterface' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php', |
  |  | 30 | 'Optimole\\Sdk\\ValueObject\\Position' => $vendorDir . '/codeinwp/optimole-sdk/src/ValueObject/Position.php', |
  |  | 31 | 'PhpToken' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/PhpToken.php', |
  |  | 32 | 'Stringable' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/Stringable.php', |
  |  | 33 | 'Symfony\\Polyfill\\Php80\\Php80' => $vendorDir . '/symfony/polyfill-php80/Php80.php', |
  |  | 34 | 'Symfony\\Polyfill\\Php80\\PhpToken' => $vendorDir . '/symfony/polyfill-php80/PhpToken.php', |
  |  | 35 | 'UnhandledMatchError' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php', |
  |  | 36 | 'ValueError' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/ValueError.php', |
  |  | 37 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 38 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 39 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 40 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => $vendorDir . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 41 | 'enshrined\\svgSanitize\\Helper' => $vendorDir . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 42 | 'enshrined\\svgSanitize\\Sanitizer' => $vendorDir . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 43 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 44 | 'enshrined\\svgSanitize\\data\\AllowedTags' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 45 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 46 | 'enshrined\\svgSanitize\\data\\TagInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 47 | 'enshrined\\svgSanitize\\data\\XPath' => $vendorDir . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 10 | 48 | ); |
* ## [optimole-wp/tags/3.13.0/vendor/composer/autoload\_files.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/autoload_files.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/autoload_files.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_files.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_files.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'a4a119a56e50fbb293281d9a48007e0e' => $vendorDir . '/symfony/polyfill-php80/bootstrap.php', |
  | 9 | 10 | '9fef4034ed73e26a337d9856ea126f7f' => $vendorDir . '/codeinwp/themeisle-sdk/load.php', |
  | 10 | 11 | ); |
* ## [optimole-wp/tags/3.13.0/vendor/composer/autoload\_psr4.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/autoload_psr4.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/autoload_psr4.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_psr4.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_psr4.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'enshrined\\svgSanitize\\' => array($vendorDir . '/enshrined/svg-sanitize/src'), |
  |  | 10 | 'Symfony\\Polyfill\\Php80\\' => array($vendorDir . '/symfony/polyfill-php80'), |
  |  | 11 | 'Optimole\\Sdk\\' => array($vendorDir . '/codeinwp/optimole-sdk/src'), |
  | 9 | 12 | ); |
* ## [optimole-wp/tags/3.13.0/vendor/composer/autoload\_real.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/autoload_real.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/autoload_real.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3056805#L3 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_real.php?rev=3086306#L3 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~ |
  |  | 5 | class ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4 |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3056805#L23) | […](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_real.php?rev=3086306#L23) |  |
  | 23 | 23 | } |
  | 24 | 24 |  |
  | 25 |  | spl\_autoload\_register(array('ComposerAutoloaderInit64430b9934df8fa232784c2a6edefb8c', 'loadClassLoader'), true, true); |
  |  | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  |  | 26 |  |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4', 'loadClassLoader'), true, true); |
  | 26 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 27 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4', 'loadClassLoader')); |
  | 28 | 30 |  |
  | 29 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 30 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::getInitializer($loader)); |
  | 31 | 33 |  |
  | 32 | 34 | $loader->register(true); |
  | 33 | 35 |  |
  | 34 |  | $filesToLoad = \Composer\Autoload\ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~::$files; |
  |  | 36 | $filesToLoad = \Composer\Autoload\ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$files; |
  | 35 | 37 | $requireFile = \Closure::bind(static function ($fileIdentifier, $file) { |
  | 36 | 38 | if (empty($GLOBALS['\_\_composer\_autoload\_files'][$fileIdentifier])) { |
* ## [optimole-wp/tags/3.13.0/vendor/composer/autoload\_static.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/autoload_static.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/autoload_static.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3056805#L5 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_static.php?rev=3086306#L5 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~ |
  |  | 7 | class ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4 |
  | 8 | 8 | { |
  | 9 | 9 | public static $files = array ( |
  |  | 10 | 'a4a119a56e50fbb293281d9a48007e0e' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/bootstrap.php', |
  | 10 | 11 | '9fef4034ed73e26a337d9856ea126f7f' => \_\_DIR\_\_ . '/..' . '/codeinwp/themeisle-sdk/load.php', |
  | 11 | 12 | ); |
  | 12 | 13 |  |
  |  | 14 | public static $prefixLengthsPsr4 = array ( |
  |  | 15 | 'e' => |
  |  | 16 | array ( |
  |  | 17 | 'enshrined\\svgSanitize\\' => 22, |
  |  | 18 | ), |
  |  | 19 | 'S' => |
  |  | 20 | array ( |
  |  | 21 | 'Symfony\\Polyfill\\Php80\\' => 23, |
  |  | 22 | ), |
  |  | 23 | 'O' => |
  |  | 24 | array ( |
  |  | 25 | 'Optimole\\Sdk\\' => 13, |
  |  | 26 | ), |
  |  | 27 | ); |
  |  | 28 |  |
  |  | 29 | public static $prefixDirsPsr4 = array ( |
  |  | 30 | 'enshrined\\svgSanitize\\' => |
  |  | 31 | array ( |
  |  | 32 | 0 => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src', |
  |  | 33 | ), |
  |  | 34 | 'Symfony\\Polyfill\\Php80\\' => |
  |  | 35 | array ( |
  |  | 36 | 0 => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80', |
  |  | 37 | ), |
  |  | 38 | 'Optimole\\Sdk\\' => |
  |  | 39 | array ( |
  |  | 40 | 0 => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src', |
  |  | 41 | ), |
  |  | 42 | ); |
  |  | 43 |  |
  | 13 | 44 | public static $classMap = array ( |
  |  | 45 | 'Attribute' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/Attribute.php', |
  | 14 | 46 | 'Composer\\InstalledVersions' => \_\_DIR\_\_ . '/..' . '/composer/InstalledVersions.php', |
  |  | 47 | 'Optimole\\Sdk\\Optimole' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Optimole.php', |
  |  | 48 | 'Optimole\\Sdk\\Resource\\AbstractResource' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AbstractResource.php', |
  |  | 49 | 'Optimole\\Sdk\\Resource\\Asset' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/Asset.php', |
  |  | 50 | 'Optimole\\Sdk\\Resource\\AssetProperty\\MinifyProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php', |
  |  | 51 | 'Optimole\\Sdk\\Resource\\AssetProperty\\TypeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php', |
  |  | 52 | 'Optimole\\Sdk\\Resource\\CacheBusterProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php', |
  |  | 53 | 'Optimole\\Sdk\\Resource\\Image' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/Image.php', |
  |  | 54 | 'Optimole\\Sdk\\Resource\\ImageProperty\\EnlargeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php', |
  |  | 55 | 'Optimole\\Sdk\\Resource\\ImageProperty\\FormatProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php', |
  |  | 56 | 'Optimole\\Sdk\\Resource\\ImageProperty\\GravityProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php', |
  |  | 57 | 'Optimole\\Sdk\\Resource\\ImageProperty\\HeightProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php', |
  |  | 58 | 'Optimole\\Sdk\\Resource\\ImageProperty\\IgnoreAvifProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php', |
  |  | 59 | 'Optimole\\Sdk\\Resource\\ImageProperty\\KeepCopyrightProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php', |
  |  | 60 | 'Optimole\\Sdk\\Resource\\ImageProperty\\QualityProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php', |
  |  | 61 | 'Optimole\\Sdk\\Resource\\ImageProperty\\ResizeTypeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php', |
  |  | 62 | 'Optimole\\Sdk\\Resource\\ImageProperty\\StripMetadataProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php', |
  |  | 63 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WatermarkProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php', |
  |  | 64 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WidthProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php', |
  |  | 65 | 'Optimole\\Sdk\\Resource\\PropertyInterface' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php', |
  |  | 66 | 'Optimole\\Sdk\\ValueObject\\Position' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/ValueObject/Position.php', |
  |  | 67 | 'PhpToken' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/PhpToken.php', |
  |  | 68 | 'Stringable' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/Stringable.php', |
  |  | 69 | 'Symfony\\Polyfill\\Php80\\Php80' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Php80.php', |
  |  | 70 | 'Symfony\\Polyfill\\Php80\\PhpToken' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/PhpToken.php', |
  |  | 71 | 'UnhandledMatchError' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php', |
  |  | 72 | 'ValueError' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/ValueError.php', |
  |  | 73 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 74 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 75 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 76 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 77 | 'enshrined\\svgSanitize\\Helper' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 78 | 'enshrined\\svgSanitize\\Sanitizer' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 79 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 80 | 'enshrined\\svgSanitize\\data\\AllowedTags' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 81 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 82 | 'enshrined\\svgSanitize\\data\\TagInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 83 | 'enshrined\\svgSanitize\\data\\XPath' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 15 | 84 | ); |
  | 16 | 85 |  |
  | […](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3056805#L18) | […](/browser/optimole-wp/tags/3.13.0/vendor/composer/autoload_static.php?rev=3086306#L87) |  |
  | 18 | 87 | { |
  | 19 | 88 | return \Closure::bind(function () use ($loader) { |
  | 20 |  | $loader->classMap = ComposerStaticInit64430b9934df8fa232784c2a6edefb8c::$classMap; |
  |  | 89 | $loader->prefixLengthsPsr4 = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$prefixLengthsPsr4; |
  |  | 90 | $loader->prefixDirsPsr4 = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$prefixDirsPsr4; |
  |  | 91 | $loader->classMap = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$classMap; |
  | 21 | 92 |  |
  | 22 | 93 | }, null, ClassLoader::class); |
* ## [optimole-wp/tags/3.13.0/vendor/composer/installed.json](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/installed.json "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/installed.json")

  | [r3071598](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3071598#L1 "Show revision 3071598 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.json?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | { |
  | 2 | 2 | "packages": [ |
  |  | 3 | { |
  |  | 4 | "name": "codeinwp/optimole-sdk", |
  |  | 5 | "version": "v1.0.0", |
  |  | 6 | "version\_normalized": "1.0.0.0", |
  |  | 7 | "source": { |
  |  | 8 | "type": "git", |
  |  | 9 | "url": "https://github.com/Codeinwp/optimole-php-sdk.git", |
  |  | 10 | "reference": "637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee" |
  |  | 11 | }, |
  |  | 12 | "dist": { |
  |  | 13 | "type": "zip", |
  |  | 14 | "url": "https://api.github.com/repos/Codeinwp/optimole-php-sdk/zipball/637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee", |
  |  | 15 | "reference": "637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee", |
  |  | 16 | "shasum": "" |
  |  | 17 | }, |
  |  | 18 | "require": { |
  |  | 19 | "php": ">=7.4", |
  |  | 20 | "symfony/polyfill-php80": "^1.29" |
  |  | 21 | }, |
  |  | 22 | "require-dev": { |
  |  | 23 | "friendsofphp/php-cs-fixer": "^3.0", |
  |  | 24 | "phpstan/phpstan": "^1.0", |
  |  | 25 | "phpunit/phpunit": "^9.6" |
  |  | 26 | }, |
  |  | 27 | "time": "2024-04-07T10:55:45+00:00", |
  |  | 28 | "type": "library", |
  |  | 29 | "installation-source": "dist", |
  |  | 30 | "autoload": { |
  |  | 31 | "psr-4": { |
  |  | 32 | "Optimole\\Sdk\\": "src" |
  |  | 33 | } |
  |  | 34 | }, |
  |  | 35 | "notification-url": "https://packagist.org/downloads/", |
  |  | 36 | "license": [ |
  |  | 37 | "MIT" |
  |  | 38 | ], |
  |  | 39 | "authors": [ |
  |  | 40 | { |
  |  | 41 | "name": "Optimole Team", |
  |  | 42 | "email": "friends@optimole.com", |
  |  | 43 | "homepage": "https://optimole.com" |
  |  | 44 | } |
  |  | 45 | ], |
  |  | 46 | "description": "SDK for Optimole cloud-based image optimization service", |
  |  | 47 | "homepage": "https://optimole.com", |
  |  | 48 | "support": { |
  |  | 49 | "issues": "https://github.com/Codeinwp/codeinwp/optimole-php-sdk/issues", |
  |  | 50 | "source": "https://github.com/Codeinwp/optimole-php-sdk" |
  |  | 51 | }, |
  |  | 52 | "install-path": "../codeinwp/optimole-sdk" |
  |  | 53 | }, |
  | 3 | 54 | { |
  | 4 | 55 | "name": "codeinwp/themeisle-sdk", |
  | […](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3071598#L43) | […](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.json?rev=3086306#L94) |  |
  | 43 | 94 | }, |
  | 44 | 95 | "install-path": "../codeinwp/themeisle-sdk" |
  |  | 96 | }, |
  |  | 97 | { |
  |  | 98 | "name": "enshrined/svg-sanitize", |
  |  | 99 | "version": "0.18.0", |
  |  | 100 | "version\_normalized": "0.18.0.0", |
  |  | 101 | "source": { |
  |  | 102 | "type": "git", |
  |  | 103 | "url": "https://github.com/darylldoyle/svg-sanitizer.git", |
  |  | 104 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0" |
  |  | 105 | }, |
  |  | 106 | "dist": { |
  |  | 107 | "type": "zip", |
  |  | 108 | "url": "https://api.github.com/repos/darylldoyle/svg-sanitizer/zipball/6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 109 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 110 | "shasum": "" |
  |  | 111 | }, |
  |  | 112 | "require": { |
  |  | 113 | "ext-dom": "\*", |
  |  | 114 | "ext-libxml": "\*", |
  |  | 115 | "php": "^5.6 || ^7.0 || ^8.0" |
  |  | 116 | }, |
  |  | 117 | "require-dev": { |
  |  | 118 | "phpunit/phpunit": "^5.7 || ^6.5 || ^8.5" |
  |  | 119 | }, |
  |  | 120 | "time": "2024-02-22T17:51:05+00:00", |
  |  | 121 | "type": "library", |
  |  | 122 | "installation-source": "dist", |
  |  | 123 | "autoload": { |
  |  | 124 | "psr-4": { |
  |  | 125 | "enshrined\\svgSanitize\\": "src" |
  |  | 126 | } |
  |  | 127 | }, |
  |  | 128 | "notification-url": "https://packagist.org/downloads/", |
  |  | 129 | "license": [ |
  |  | 130 | "GPL-2.0-or-later" |
  |  | 131 | ], |
  |  | 132 | "authors": [ |
  |  | 133 | { |
  |  | 134 | "name": "Daryll Doyle", |
  |  | 135 | "email": "daryll@enshrined.co.uk" |
  |  | 136 | } |
  |  | 137 | ], |
  |  | 138 | "description": "An SVG sanitizer for PHP", |
  |  | 139 | "support": { |
  |  | 140 | "issues": "https://github.com/darylldoyle/svg-sanitizer/issues", |
  |  | 141 | "source": "https://github.com/darylldoyle/svg-sanitizer/tree/0.18.0" |
  |  | 142 | }, |
  |  | 143 | "install-path": "../enshrined/svg-sanitize" |
  |  | 144 | }, |
  |  | 145 | { |
  |  | 146 | "name": "symfony/polyfill-php80", |
  |  | 147 | "version": "v1.29.0", |
  |  | 148 | "version\_normalized": "1.29.0.0", |
  |  | 149 | "source": { |
  |  | 150 | "type": "git", |
  |  | 151 | "url": "https://github.com/symfony/polyfill-php80.git", |
  |  | 152 | "reference": "87b68208d5c1188808dd7839ee1e6c8ec3b02f1b" |
  |  | 153 | }, |
  |  | 154 | "dist": { |
  |  | 155 | "type": "zip", |
  |  | 156 | "url": "https://api.github.com/repos/symfony/polyfill-php80/zipball/87b68208d5c1188808dd7839ee1e6c8ec3b02f1b", |
  |  | 157 | "reference": "87b68208d5c1188808dd7839ee1e6c8ec3b02f1b", |
  |  | 158 | "shasum": "" |
  |  | 159 | }, |
  |  | 160 | "require": { |
  |  | 161 | "php": ">=7.1" |
  |  | 162 | }, |
  |  | 163 | "time": "2024-01-29T20:11:03+00:00", |
  |  | 164 | "type": "library", |
  |  | 165 | "extra": { |
  |  | 166 | "thanks": { |
  |  | 167 | "name": "symfony/polyfill", |
  |  | 168 | "url": "https://github.com/symfony/polyfill" |
  |  | 169 | } |
  |  | 170 | }, |
  |  | 171 | "installation-source": "dist", |
  |  | 172 | "autoload": { |
  |  | 173 | "files": [ |
  |  | 174 | "bootstrap.php" |
  |  | 175 | ], |
  |  | 176 | "psr-4": { |
  |  | 177 | "Symfony\\Polyfill\\Php80\\": "" |
  |  | 178 | }, |
  |  | 179 | "classmap": [ |
  |  | 180 | "Resources/stubs" |
  |  | 181 | ] |
  |  | 182 | }, |
  |  | 183 | "notification-url": "https://packagist.org/downloads/", |
  |  | 184 | "license": [ |
  |  | 185 | "MIT" |
  |  | 186 | ], |
  |  | 187 | "authors": [ |
  |  | 188 | { |
  |  | 189 | "name": "Ion Bazan", |
  |  | 190 | "email": "ion.bazan@gmail.com" |
  |  | 191 | }, |
  |  | 192 | { |
  |  | 193 | "name": "Nicolas Grekas", |
  |  | 194 | "email": "p@tchwork.com" |
  |  | 195 | }, |
  |  | 196 | { |
  |  | 197 | "name": "Symfony Community", |
  |  | 198 | "homepage": "https://symfony.com/contributors" |
  |  | 199 | } |
  |  | 200 | ], |
  |  | 201 | "description": "Symfony polyfill backporting some PHP 8.0+ features to lower PHP versions", |
  |  | 202 | "homepage": "https://symfony.com", |
  |  | 203 | "keywords": [ |
  |  | 204 | "compatibility", |
  |  | 205 | "polyfill", |
  |  | 206 | "portable", |
  |  | 207 | "shim" |
  |  | 208 | ], |
  |  | 209 | "support": { |
  |  | 210 | "source": "https://github.com/symfony/polyfill-php80/tree/v1.29.0" |
  |  | 211 | }, |
  |  | 212 | "funding": [ |
  |  | 213 | { |
  |  | 214 | "url": "https://symfony.com/sponsor", |
  |  | 215 | "type": "custom" |
  |  | 216 | }, |
  |  | 217 | { |
  |  | 218 | "url": "https://github.com/fabpot", |
  |  | 219 | "type": "github" |
  |  | 220 | }, |
  |  | 221 | { |
  |  | 222 | "url": "https://tidelift.com/funding/github/packagist/symfony/symfony", |
  |  | 223 | "type": "tidelift" |
  |  | 224 | } |
  |  | 225 | ], |
  |  | 226 | "install-path": "../symfony/polyfill-php80" |
  | 45 | 227 | } |
  | 46 | 228 | ], |
* ## [optimole-wp/tags/3.13.0/vendor/composer/installed.php](/changeset/3086306/optimole-wp/tags/3.13.0/vendor/composer/installed.php "Show the changeset 3086306 restricted to optimole-wp/tags/3.13.0/vendor/composer/installed.php")

  | [r3071598](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3071598#L11 "Show revision 3071598 of this file in browser") | [r3086306](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.php?rev=3086306#L11 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | ), |
  | 12 | 12 | 'versions' => array( |
  |  | 13 | 'codeinwp/optimole-sdk' => array( |
  |  | 14 | 'pretty\_version' => 'v1.0.0', |
  |  | 15 | 'version' => '1.0.0.0', |
  |  | 16 | 'reference' => '637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee', |
  |  | 17 | 'type' => 'library', |
  |  | 18 | 'install\_path' => \_\_DIR\_\_ . '/../codeinwp/optimole-sdk', |
  |  | 19 | 'aliases' => array(), |
  |  | 20 | 'dev\_requirement' => false, |
  |  | 21 | ), |
  | 13 | 22 | 'codeinwp/optimole-wp' => array( |
  | 14 | 23 | 'pretty\_version' => '1.1.2', |
  | […](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3071598#L29) | […](/browser/optimole-wp/tags/3.13.0/vendor/composer/installed.php?rev=3086306#L38) |  |
  | 29 | 38 | 'dev\_requirement' => false, |
  | 30 | 39 | ), |
  |  | 40 | 'enshrined/svg-sanitize' => array( |
  |  | 41 | 'pretty\_version' => '0.18.0', |
  |  | 42 | 'version' => '0.18.0.0', |
  |  | 43 | 'reference' => '6a2c069dab3843ca4d887ff09c972fc7033888d0', |
  |  | 44 | 'type' => 'library', |
  |  | 45 | 'install\_path' => \_\_DIR\_\_ . '/../enshrined/svg-sanitize', |
  |  | 46 | 'aliases' => array(), |
  |  | 47 | 'dev\_requirement' => false, |
  |  | 48 | ), |
  |  | 49 | 'symfony/polyfill-php80' => array( |
  |  | 50 | 'pretty\_version' => 'v1.29.0', |
  |  | 51 | 'version' => '1.29.0.0', |
  |  | 52 | 'reference' => '87b68208d5c1188808dd7839ee1e6c8ec3b02f1b', |
  |  | 53 | 'type' => 'library', |
  |  | 54 | 'install\_path' => \_\_DIR\_\_ . '/../symfony/polyfill-php80', |
  |  | 55 | 'aliases' => array(), |
  |  | 56 | 'dev\_requirement' => false, |
  |  | 57 | ), |
  | 31 | 58 | ), |
  | 32 | 59 | ); |
* ## [optimole-wp/trunk/CHANGELOG.md](/changeset/3086306/optimole-wp/trunk/CHANGELOG.md "Show the changeset 3086306 restricted to optimole-wp/trunk/CHANGELOG.md")

  | [r3073660](/browser/optimole-wp/trunk/CHANGELOG.md?rev=3073660#L1 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/CHANGELOG.md?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | #### [Version 3.13.0](https://github.com/Codeinwp/optimole-wp/compare/v3.12.10...v3.13.0) (2024-05-14) |
  |  | 2 |  |
  |  | 3 | - Optimole is now fully translated into German! This update makes our service more convenient for our German-speaking customers and helps you support your German-speaking clients more effectively. |
  |  | 4 | - We now have a PHP SDK available on GitHub: [Optimole PHP SDK](https://github.com/Optimole/optimole-php-sdk). This SDK simplifies the integration of Optimole’s features with any PHP-based website, making the process straightforward and efficient. |
  |  | 5 | - You can now associate a billing email to receive invoices. For more details, check out our [documentation](https://docs.optimole.com/article/1992-setting-a-billing-email-for-invoice-delivery). |
  |  | 6 | - Weve improved Largest Contentful Paint (LCP) by prioritizing the loading of initial images that are not affected by lazy loading. |
  |  | 7 | - Weve also improved LCP by using the srcset attribute for non-lazyloaded images. |
  |  | 8 | - Weve fixed various issues with offload compatibility to ensure all images load properly, making the service more robust. |
  |  | 9 | - Weve resolved an issue where the offloading process was getting stuck on large websites, making the process smoother and more reliable. |
  |  | 10 | - Weve improved the handling and sanitization of SVG files. |
  |  | 11 |  |
  | 1 | 12 | ##### [Version 3.12.10](https://github.com/Codeinwp/optimole-wp/compare/v3.12.9...v3.12.10) (2024-04-19) |
  | 2 | 13 |  |
* ## [optimole-wp/trunk/assets/build/dashboard/index.asset.php](/changeset/3086306/optimole-wp/trunk/assets/build/dashboard/index.asset.php "Show the changeset 3086306 restricted to optimole-wp/trunk/assets/build/dashboard/index.asset.php")

  | [r3071327](/browser/optimole-wp/trunk/assets/build/dashboard/index.asset.php?rev=3071327#L1 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/assets/build/dashboard/index.asset.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('lodash', 'react', 'wp-api', 'wp-api-fetch', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-i18n', 'wp-notices', 'wp-primitives', 'wp-url'), 'version' => '~~6ce0049a03c8935b767d~~'); |
  |  | 1 | <?php return array('dependencies' => array('lodash', 'react', 'wp-api', 'wp-api-fetch', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-i18n', 'wp-notices', 'wp-primitives', 'wp-url'), 'version' => 'bb66bc266c4f9d3eda68'); |
* ## [optimole-wp/trunk/assets/build/dashboard/index.js](/changeset/3086306/optimole-wp/trunk/assets/build/dashboard/index.js "Show the changeset 3086306 restricted to optimole-wp/trunk/assets/build/dashboard/index.js")

  | [r3071327](/browser/optimole-wp/trunk/assets/build/dashboard/index.js?rev=3071327#L1 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/assets/build/dashboard/index.js?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{var e,t={~~646:(e,t,s)=>{"use strict";var a=s(196);const o=window.wp.element,n={setAutoConnect:e=>({type:"SET\_AUTO\_CONNECT",autoConnect:e}),setAPIKey:e=>({type:"SET\_API\_KEY",apiKey:e}),setAvailableApps:e=>({type:"SET\_AVAILABLE\_APPS",availableApps:e}),setIsConnected:e=>({type:"SET\_IS\_CONNECTED",isConnected:e}),setIsConnecting:e=>({type:"SET\_IS\_CONNECTING",isConnecting:e}),setIsLoading:e=>({type:"SET\_IS\_LOADING",isLoading:e}),sethasDashboardLoaded:e=>({type:"SET\_HAS\_DASHBOARD\_LOADED",hasDashboardLoaded:e}),setHasRestError:e=>({type:"SET\_HAS\_REST\_ERROR",hasRestError:e}),setHasValidKey:e=>({type:"SET\_HAS\_VALID\_KEY",hasValidKey:e}),setHasApplication:e=>({type:"SET\_HAS\_APPLICATION",hasApplication:e}),setUserData:e=>({type:"SET\_USER\_DATA",data:e}),setUserStatus:e=>({type:"SET\_USER\_STATUS",status:e}),setShowDisconnect:e=>({type:"SET\_SHOW\_DISCONNECT",showDisconnect:e}),setConflicts:e=>({type:"SET\_CONFLICTS",conflicts:e}),setOptimizedImages:e=>({type:"SET\_OPTIMIZED\_IMAGES",optimizedImages:e}),setSiteSettings:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:e}),setExtraVisits:e=>({type:"SET\_EXTRA\_VISITS",extraVisitsStatus:e}),setSampleRate:e=>({type:"SET\_SAMPLE\_RATE",sampleRate:e}),setTotalNumberOfImages:e=>({type:"SET\_TOTAL\_NUMBER\_OF\_IMAGES",totalNumberOfImages:e}),setProcessedImages:e=>({type:"SET\_PROCESSED\_IMAGES",processedImages:e}),setOffloadLibraryLink:e=>({type:"SET\_OFFLOAD\_LIBRARY\_LINK",offloadLibraryLink:e}),setRollbackLibraryLink:e=>({type:"SET\_ROLLBACK\_LIBRARY\_LINK",rollbackLibraryLink:e}),setLoadingRollback:e=>({type:"SET\_LOADING\_ROLLBACK",loadingRollback:e}),setLoadingSync:e=>({type:"SET\_LOADING\_SYNC",loadingSync:e}),setQueryArgs:e=>({type:"SET\_QUERY\_ARGS",queryArgs:e}),setErrorMedia:e=>({type:"SET\_ERROR\_MEDIA",errorMedia:e}),setEstimatedTime:e=>({type:"SET\_ESTIMATED\_TIME",estimatedTime:e}),setCheckedOffloadConflicts:e=>({type:"SET\_CHECKED\_OFFLOAD\_CONFLICTS",checkedOffloadConflicts:e}),setOffloadConflicts:e=>({type:"SET\_OFFLOAD\_CONFLICTS",offloadConflicts:e}),setLogs:(e,t)=>({type:"SET\_LOGS",logsType:e,logs:t}),setShowFinishNotice:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{show\_offload\_finish\_notice:e}}),setOffloadLimitReached:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offload\_limit\_reached:e}}),ensureOffloadingRollbackDisabled:()=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offloading\_status:"disabled",rollback\_status:"disabled"}}),setOffloadLimit:e=>({type:"SET\_OFFLOAD\_LIMIT",offloadLimit:e})},r={autoConnect:optimoleDashboardApp.auto\_connect,isConnected:"yes"===optimoleDashboardApp.connection\_status,isConnecting:!1,isLoading:!1,hasRestError:!1,hasValidKey:!0,hasApplication:"yes"===optimoleDashboardApp.has\_application,apiKey:optimoleDashboardApp.api\_key?optimoleDashboardApp.api\_key:"",userStatus:optimoleDashboardApp.user\_status?optimoleDashboardApp.user\_status:"inactive",userData:optimoleDashboardApp.user\_data?optimoleDashboardApp.user\_data:null,availableApps:optimoleDashboardApp.available\_apps?optimoleDashboardApp.available\_apps:null,hasDashboardLoaded:"yes"===optimoleDashboardApp.connection\_status,showDisconnect:!1,conflicts:[],optimizedImages:[],siteSettings:optimoleDashboardApp.site\_settings,sampleRate:{},totalNumberOfImages:0,processedImages:0,offloadLibraryLink:!1,rollbackLibraryLink:!1,loadingRollback:!1,loadingSync:!1,queryArgs:[],errorMedia:!1,checkedOffloadConflicts:!1,offloadConflicts:[],offloadLimit:optimoleDashboardApp.offload\_limit||5e4,logs:{offload:"",rollback:""}},i=(e=r,t)=>{switch(t.type){case"SET\_AUTO\_CONNECT":return{...e,autoConnect:t.autoConnect};case"SET\_HAS\_REST\_ERROR":case"SET\_HAS\_REST\_ERROR":return{...e,hasRestError:t.hasRestError};case"SET\_API\_KEY":return{...e,apiKey:t.apiKey};case"SET\_AVAILABLE\_APPS":return{...e,availableApps:t.availableApps};case"SET\_IS\_CONNECTED":return{...e,isConnected:t.isConnected};case"SET\_IS\_CONNECTING":return{...e,isConnecting:t.isConnecting};case"SET\_IS\_LOADING":return{...e,isLoading:t.isLoading};case"SET\_HAS\_DASHBOARD\_LOADED":return{...e,hasDashboardLoaded:t.hasDashboardLoaded};case"SET\_HAS\_VALID\_KEY":return{...e,hasValidKey:t.hasValidKey};case"SET\_HAS\_APPLICATION":return{...e,hasApplication:t.hasApplication};case"SET\_USER\_DATA":let s="inactive";const{data:a}=t;if(a&&a.app\_count&&1<=a.app\_count&&a.cdn\_key)for(let e of a.available\_apps)e.key&&e.key===a.cdn\_key&&e.status&&"active"===e.status&&(s="active");return{...e,userData:t.data,userStatus:s};case"SET\_USER\_STATUS":return{...e,userStatus:t.status};case"SET\_SHOW\_DISCONNECT":return{...e,showDisconnect:t.showDisconnect};case"SET\_CONFLICTS":return{...e,conflicts:t.conflicts};case"SET\_OPTIMIZED\_IMAGES":return{...e,optimizedImages:t.optimizedImages};case"SET\_SITE\_SETTINGS":let{siteSettings:o}=e;for(let e in t.siteSettings)o[e]=t.siteSettings[e];return{...e,siteSettings:o};case"SET\_EXTRA\_VISITS":{let{siteSettings:s}=e;return s.banner\_frontend=t.extraVisitsStatus?"enabled":"disabled",{...e,siteSettings:s}}case"SET\_SAMPLE\_RATE":return{...e,sampleRate:t.sampleRate};case"SET\_TOTAL\_NUMBER\_OF\_IMAGES":return{...e,totalNumberOfImages:t.totalNumberOfImages};case"SET\_PROCESSED\_IMAGES":return{...e,processedImages:t.processedImages};case"SET\_OFFLOAD\_LIBRARY\_LINK":return{...e,offloadLibraryLink:t.offloadLibraryLink};case"SET\_ROLLBACK\_LIBRARY\_LINK":return{...e,rollbackLibraryLink:t.rollbackLibraryLink};case"SET\_LOADING\_ROLLBACK":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.rollbackLibraryLink=!t.loadingSync),{...e,loadingRollback:t.loadingRollback};case"SET\_LOADING\_SYNC":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.offloadLibraryLink=!t.loadingSync),{...e,loadingSync:t.loadingSync};case"SET\_QUERY\_ARGS":return{...e,queryArgs:t.queryArgs};case"SET\_ERROR\_MEDIA":return{...e,errorMedia:t.errorMedia};case"SET\_CHECKED\_OFFLOAD\_CONFLICTS":return{...e,checkedOffloadConflicts:t.checkedOffloadConflicts};case"SET\_OFFLOAD\_CONFLICTS":return{...e,offloadConflicts:t.offloadConflicts};case"SET\_LOGS":let{logs:n}=e;return n[t.logsType]=t.logs,{...e,logs:n};case"SET\_OFFLOAD\_LIMIT":return{...e,offloadLimit:t.offloadLimit};default:return e}},l={getAutoConnect:e=>e.autoConnect,getAPIKey:e=>e.apiKey,getAvailableApps:e=>e.availableApps,hasRestError:e=>e.hasRestError,hasValidKey:e=>e.hasValidKey,hasApplication:e=>e.hasApplication,hasDashboardLoaded:e=>e.hasDashboardLoaded,getUserData:e=>e.userData,getUserStatus:e=>e.userStatus,isConnected:e=>e.isConnected,isConnecting:e=>e.isConnecting,isLoading:e=>e.isLoading,showDisconnect:e=>e.showDisconnect,getConflicts:e=>e.conflicts,getOptimizedImages:e=>e.optimizedImages,getSiteSettings:(e,t=void 0)=>t?void 0!==e.siteSettings[t]?e.siteSettings[t]:void 0:e.siteSettings,getSampleRate:e=>e.sampleRate,getTotalNumberOfImages:e=>e.totalNumberOfImages,getProcessedImages:e=>e.processedImages,getOffloadLibraryLink:e=>e.offloadLibraryLink,getRollbackLibraryLink:e=>e.rollbackLibraryLink,getLoadingRollback:e=>e.loadingRollback,getLoadingSync:e=>e.loadingSync,getQueryArgs:e=>e.queryArgs,getErrorMedia:e=>e.errorMedia,getCheckedOffloadConflicts:e=>e.checkedOffloadConflicts,getOffloadConflicts:e=>e.offloadConflicts,getOffloadLimit:e=>e.offloadLimit,getLogs:(e,t=void 0)=>t?void 0!==e.logs[t]?e.logs[t]:void 0:e.logs};if(void 0!==wp.data.createReduxStore){const e=wp.data.createReduxStore("optimole",{reducer:i,actions:n,selectors:l});wp.data.register(e)}else wp.data.registerStore("optimole",{reducer:i,actions:n,selectors:l});const c=window.wp.data;var d=s(184),p=s.n(d);const m=window.wp.primitives,u=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})),g=window.wp.components,h=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"20",viewBox:"0 0 21 20",fill:"none"},(0,a.createElement)("path",{d:"M17.357 2.92894C16.9664 2.53842 16.3333 2.53842 15.9427 2.92894C15.5522 3.31946 15.5522 3.95263 15.9427 4.34315L17.357 2.92894ZM16.6499 16.364L15.9427 17.0711H15.9427L16.6499 16.364ZM14.5285 5.75737C14.138 5.36684 13.5048 5.36684 13.1143 5.75737C12.7238 6.14789 12.7238 6.78106 13.1143 7.17158L14.5285 5.75737ZM13.8214 13.5355L13.1143 14.2426L13.1143 14.2427L13.8214 13.5355ZM6.04325 14.2427C6.43377 14.6332 7.06694 14.6332 7.45746 14.2427C7.84799 13.8521 7.84799 13.219 7.45746 12.8284L6.04325 14.2427ZM6.32586 10.5662C6.24822 10.0194 5.74201 9.63905 5.19521 9.71669C4.64841 9.79434 4.26808 10.3005 4.34573 10.8473L6.32586 10.5662ZM3.21482 17.0711C3.60535 17.4616 4.23851 17.4616 4.62903 17.0711C5.01956 16.6806 5.01956 16.0474 4.62903 15.6569L3.21482 17.0711ZM2.70292 7.44452C2.87885 6.921 2.59707 6.354 2.07355 6.17807C1.55004 6.00215 0.98303 6.28393 0.807105 6.80744L2.70292 7.44452ZM1.993 0.292893C1.60247 -0.0976311 0.969306 -0.0976311 0.578782 0.292893C0.188258 0.683417 0.188258 1.31658 0.578782 1.70711L1.993 0.292893ZM18.5788 19.7071C18.9693 20.0976 19.6025 20.0976 19.993 19.7071C20.3835 19.3166 20.3835 18.6834 19.993 18.2929L18.5788 19.7071ZM15.9427 4.34315C19.0669 7.46735 19.0669 12.5327 15.9427 15.6569L17.357 17.0711C21.2622 13.1658 21.2622 6.83418 17.357 2.92894L15.9427 4.34315ZM13.1143 7.17158C14.6764 8.73368 14.6764 11.2663 13.1143 12.8284L14.5285 14.2427C16.8717 11.8995 16.8717 8.10051 14.5285 5.75737L13.1143 7.17158ZM10.2859 10H12.2859C12.2859 8.89544 11.3905 8.00001 10.2859 8.00001V10ZM7.45746 12.8284C6.81978 12.1908 6.44341 11.394 6.32586 10.5662L4.34573 10.8473C4.52209 12.0894 5.08876 13.2882 6.04325 14.2427L7.45746 12.8284ZM4.62903 15.6569C2.40899 13.4368 1.76507 10.2354 2.70292 7.44452L0.807105 6.80744C-0.363267 10.2902 0.43743 14.2937 3.21482 17.0711L4.62903 15.6569ZM10.2859 10L10.2859 10V8.00001C9.73388 8.00001 9.23252 8.22496 8.87168 8.58578L10.2859 10ZM0.578782 1.70711L8.87168 10L10.2859 8.58579L1.993 0.292893L0.578782 1.70711ZM8.87168 10L10.2859 11.4142L11.7001 10L10.2859 8.58579L8.87168 10ZM10.2859 11.4142L13.1143 14.2426L14.5285 12.8284L11.7001 10L10.2859 11.4142ZM13.1143 14.2427L15.9427 17.0711L17.357 15.6569L14.5285 12.8284L13.1143 14.2427ZM15.9427 17.0711L18.5788 19.7071L19.993 18.2929L17.357 15.6569L15.9427 17.0711ZM10.2859 10L10.2859 10L11.7001 11.4142C12.0609 11.0534 12.2859 10.552 12.2859 10H10.2859Z",fill:"#E77777"})),b=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"16",viewBox:"0 0 21 16",fill:"none"},(0,a.createElement)("path",{d:"M4.00127 14.3639C0.486555 10.8492 0.486555 5.15071 4.00127 1.63599M16.7292 1.63599C20.2439 5.15071 20.2439 10.8492 16.7292 14.3639M6.8297 11.5355C4.87708 9.58286 4.87708 6.41704 6.8297 4.46441M13.9008 4.46441C15.8534 6.41704 15.8534 9.58286 13.9008 11.5355M11.3652 7.99995C11.3652 8.55223 10.9175 8.99995 10.3652 8.99995C9.81295 8.99995 9.36523 8.55223 9.36523 7.99995C9.36523 7.44766 9.81295 6.99995 10.3652 6.99995C10.9175 6.99995 11.3652 7.44766 11.3652 7.99995Z",stroke:"#6D955A","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),f=()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M46.6215 21.757C44.6278 22.9074 43.5209 25.0684 43.5415 27.3692C43.5415 27.4128 43.5415 27.4563 43.5415 27.4999C43.5415 27.5434 43.5415 27.5892 43.5415 27.6328C43.5209 29.9336 44.6278 32.0947 46.6215 33.2451L46.6399 33.2565C47.9943 34.038 49.7565 33.2657 50.043 31.728C50.5678 28.9047 50.5426 26.0378 50.0178 23.2717C49.7268 21.7386 47.9713 20.9778 46.6215 21.757V21.757Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M35.2025 41.5616C35.4065 41.4493 35.6081 41.3325 35.8075 41.211C37.7119 40.0514 40.1067 40.0721 42.0386 41.1881C43.3815 41.9627 43.6175 43.8556 42.4442 44.8685C40.3015 46.7202 37.815 48.1846 35.0879 49.1448C33.6213 49.6627 32.0881 48.5123 32.0881 46.9562C32.0881 44.731 33.2523 42.6364 35.2025 41.5616V41.5616Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9122 46.9357C22.9122 48.494 21.3745 49.633 19.9055 49.1196C17.2472 48.1915 14.7493 46.7798 12.5653 44.9098C11.3782 43.8923 11.5891 41.9834 12.9434 41.2019C14.8868 40.079 17.2953 40.0607 19.2157 41.2248C19.4128 41.344 19.6122 41.4609 19.8161 41.5709C21.7549 42.6365 22.9122 44.7219 22.9122 46.9357V46.9357Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M27.5 20.6256L34.3755 27.5011L27.5 34.3766L20.6245 27.5011L27.5 20.6256Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"})),\_=(0,a.createElement)("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.9581 0C13.5192 0 17.2136 3.58 17.2136 8C17.2136 12.42 13.5192 16 8.9581 16C4.39696 16 0.702637 12.42 0.702637 8C0.702637 3.58 4.39696 0 8.9581 0ZM10.6558 9L11.0219 3H7.92606L8.29211 9H10.6558ZM11.0219 11.5115C11.0219 11.9809 10.8811 12.3473 10.6213 12.6107C10.3507 12.874 9.97188 13 9.48478 13C8.99768 13 8.61882 12.874 8.33739 12.6107C8.06677 12.3473 7.92606 11.9809 7.92606 11.5115C7.92606 11.0305 8.05595 10.6641 8.32656 10.4008C8.59717 10.1374 8.97603 10 9.48478 10C9.99353 10 10.3724 10.1374 10.6322 10.4008C10.892 10.6641 11.0219 11.0305 11.0219 11.5115Z",fill:"#AF3535"})),v=(0,a.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M17.25 8.25H21V4.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M3 12C3 7.029 7.029 3 12 3C15.63 3 18.751 5.154 20.174 8.25",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M6.75 15.75H3V19.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M21 12C21 16.971 16.971 21 12 21C8.37 21 5.249 18.846 3.826 15.75",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),E=(0,a.createElement)("svg",{width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M35.8621 13.647L22.0095 27.4996L15.085 20.5733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.5 22C38.5 31.1135 31.1135 38.5 22 38.5C12.8865 38.5 5.5 31.1135 5.5 22C5.5 12.8865 12.8865 5.5 22 5.5C24.6638 5.5 27.1718 6.14717 29.3993 7.26733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"})),y=(0,a.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M13 12L10 9M10 9L7 12M10 9L10 21",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),w=(0,a.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M7 18L10 21M10 21L13 18M10 21V9",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),k=(0,a.createElement)("svg",{width:"20",height:"18",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)("path",{d:"M10.0015 8V10M10.0015 14H10.0115M3.0733 18H16.9297C18.4693 18 19.4316 16.3333 18.6618 15L11.7336 3C10.9637 1.66667 9.03925 1.66667 8.26945 3L1.34125 15C0.571445 16.3333 1.5337 18 3.0733 18Z",stroke:"#DE9F0C","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),x=window.wp.apiFetch;var C=s.n(x);const S=window.wp.url,A=window.wp.notices,D=window.optimoleDashboardApp.submenu\_links,L=(e=!0)=>{const t=document.querySelector("li#toplevel\_page\_optimole");let s=document.querySelector("li#toplevel\_page\_optimole .wp-submenu");s||(s=document.createElement("ul"),s.classList.add("wp-submenu","wp-submenu-wrap"),t.classList.add("wp-has-submenu","wp-has-current-submenu","wp-menu-open"),t.appendChild(s)),e?(D.forEach((e=>{if(document.querySelector(`li#toplevel\_page\_optimole a[href="${e.href}"]`))return;const t=document.createElement("li"),a=document.createElement("a");a.href=e.href,a.innerHTML=e.text,t.appendChild(a),e.hash&&e.hash===window.location.hash&&(t.classList.add("current"),a.classList.add("current")),s.appendChild(t)})),s.style.display="block"):s.style.display="none"},{setIsConnected:N,setIsConnecting:I,setIsLoading:T,setHasRestError:M,setHasValidKey:O,setHasApplication:F,setAPIKey:j,setUserData:H,setAvailableApps:B,sethasDashboardLoaded:z,setShowDisconnect:R,setConflicts:P,setOptimizedImages:V,setSiteSettings:$,setSampleRate:q,setCheckedOffloadConflicts:Z,setOffloadConflicts:U,setLoadingSync:G,setLoadingRollback:K,setTotalNumberOfImages:Y,setProcessedImages:Q,setErrorMedia:J,setOffloadLibraryLink:W,setRollbackLibraryLink:X,setExtraVisits:ee,setLogs:te,setShowFinishNotice:se,setOffloadLimitReached:ae,ensureOffloadingRollbackDisabled:oe,setOffloadLimit:ne}=(0,c.dispatch)("optimole"),{getOptimizedImages:re,getQueryArgs:ie,getTotalNumberOfImages:le,getSiteSettings:ce}=(0,c.select)("optimole"),{createNotice:de}=(0,c.dispatch)(A.store),pe=(e={})=>{e.offset=void 0!==e.offset?e.offset:0,C()({path:optimoleDashboardApp.routes.upload\_onboard\_images,method:"POST",data:e}).then((t=>{!1===t.data&&1e3>e.offset&&pe({offset:e.offset+100}),"success"===t.code&&console.log("%c Images Crawled.","color: #59B278")})).catch((e=>(console.log("Error while crawling images",e),e.data)))},me=(e,t=(()=>{}))=>{I(!0),T(!0),M(!1),C()({path:optimoleDashboardApp.routes.register\_service,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(I(!1),T(!1),"success"===e.code&&(N(!0),O(!0),F(!0),j(e.data.api\_key),H(e.data),B(e.data),pe(),L(!0)),t&&t(e),e.data))).catch((e=>(I(!1),T(!1),M(!0),e.data)))},ue=()=>{T(!0),C()({path:optimoleDashboardApp.routes.disconnect,method:"GET",parse:!1}).then((e=>{T(!1),F(!1),j(""),H(null),B(null),e.ok?(N(!1),z(!1),R(!1),L(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")):console.error(e)}))},ge=()=>{T(!0),C()({path:optimoleDashboardApp.routes.request\_update,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{T(!1),e&&(H(e.data),void 0!==e?.data?.extra\_visits&&ee(e.data.extra\_visits),"disconnected"===e.code&&(N(!1),z(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")))}))},he=(e=(()=>{}))=>{if(0<re().length)return console.log("%c Images already exist.","color: #59B278"),e&&e(),!1;C()({path:optimoleDashboardApp.routes.poll\_optimized\_images,method:"GET"}).then((t=>{"success"===t.code?(V(t.data),console.log("%c Images Fetched.","color: #59B278")):console.log("%c No images available.","color: #E7602A"),e&&e(t)})).catch((e=>(console.log("Error while polling images",e),e.data)))},be=(e,t=!1,s=!1,a=(()=>{}))=>{T(!0),C()({path:optimoleDashboardApp.routes.update\_option,method:"POST",data:{settings:e}}).then((e=>{T(!1),"success"===e.code&&($(e.data),s||ye(optimoleDashboardApp.strings.options\_strings.settings\_saved),console.log("%c Settings Saved.","color: #59B278"))})).then((()=>{t&&ge()})).then((()=>{a()})).catch((e=>(T(!1),ye(optimoleDashboardApp.strings.options\_strings.settings\_saved\_error),console.log("Error while saving settings",e),e.data)))},fe=e=>{T(!0),C()({path:optimoleDashboardApp.routes.clear\_cache\_request,method:"POST",data:{type:e},parse:!1}).then((e=>(T(!1),200<=e.status&&300>e.status?(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared),void console.log("%c New cache token generated.","color: #59B278")):(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared\_error),void console.log("%c Could not generate cache token.","color: #E7602A")))))},\_e=(e,t=(()=>{}))=>{C()({path:(0,S.addQueryArgs)(optimoleDashboardApp.routes.get\_sample\_rate,{quality:e.quality,force:e?.force||"no"}),method:"POST"}).then((e=>{"success"===e.code&&q(e.data),t&&t(e)}))},ve=(e=(()=>{}))=>{C()({path:optimoleDashboardApp.routes.get\_offload\_conflicts,method:"GET"}).then((t=>{Z(!0),0!==t.data.length&&U(t.data),e&&e(t)}))},Ee=e=>{const t=ie();"offload\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&W(!1),G(!0)),"rollback\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!1),K(!0)),T(!0);const s=void 0!==e.images?e.images:[];C()({path:optimoleDashboardApp.routes.number\_of\_images\_and\_pages,method:"POST",data:{action:e.action,refresh:e.refresh||!1,images:s},parse:!1}).then((t=>{if(200<=t.status&&300>t.status)return t.json();"offload\_images"===e.action&&(G(!1),T(!1)),"rollback\_images"===e.action&&(K(!1),T(!1))})).then((a=>{if(!a.data.count||0===a.data.count||!1===a.data.status)return console.log("%c No images available.","color: #E7602A"),G(!1),K(!1),T(!1),0===a.data.count&&(ae("disabled"),se(a.data.action)),a.data.reached\_limit&&ae(a.data.reached\_limit?"enabled":"disabled"),a.data.offload\_limit&&ne(a.data.offload\_limit),oe(),be(ce(),!1),"offload\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&W(!0),void("rollback\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!0));let o=le();e.refresh?(Q(0!==o?Math.abs(o-a.data.count):0),0!==a.data.count&&0===o&&Y(a.data.count)):Y(a.data.count),setTimeout((()=>{Ee({action:e.action,refresh:!0,images:s})}),1e4)})).finally((()=>{var t;t="offload\_images"===e.action?"offload":"rollback",jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"optml\_fetch\_logs",nonce:optimoleDashboardApp.nonce,type:t},success:e=>{te(t,e)}})})).catch((t=>{J(e.action),G(!1),K(!1)}))},ye=e=>{de("info",e,{isDismissible:!0,type:"snackbar"})},we=({tab:e,setTab:t})=>{const[s,n]=(0,o.useState)(!1),{setShowDisconnect:r}=(0,c.useDispatch)("optimole"),{isConnected:i,isLoading:l,hasApplication:d,hasDashboardLoaded:m,hasConflicts:f}=(0,c.useSelect)((e=>{const{isConnected:t,isLoading:s,hasApplication:a,hasDashboardLoaded:o,getConflicts:n}=e("optimole"),r=n();return{isConnected:t(),isLoading:s(),hasApplication:a(),hasDashboardLoaded:o(),hasConflicts:0<r.count||0}}));(0,o.useEffect)((()=>{f&&n(!0)}),[f]);const \_=[{label:optimoleDashboardApp.strings.dashboard\_menu\_item,value:"dashboard"},{label:optimoleDashboardApp.strings.conflicts\_menu\_item,value:"conflicts",isDisabled:!s},{label:optimoleDashboardApp.strings.settings\_menu\_item,value:"settings"},{label:optimoleDashboardApp.strings.help\_menu\_item,value:"help"}],v=i&&d&&!m;return(0,a.createElement)("header",{className:"bg-white shadow-sm px-2.5 py-5 pb-0"},(0,a.createElement)("div",{className:"flex flex-col sm:flex-row justify-between items-center max-w-screen-xl mx-auto my-0 pb-5"},(0,a.createElement)("div",{className:"items-center flex justify-start cursor-default"},(0,a.createElement)("img",{className:"max-width-64 w-16 h-16 mr-3",src:`${optimoleDashboardApp.assets\_url}/img/logo.png`,alt:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details,title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details}),(0,a.createElement)("h3",{className:"text-gray-800 text-2 font-serif font-bold"},optimoleDashboardApp.strings.optimole)),(0,a.createElement)("div",{className:"flex items-center"},i?(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.DropdownMenu,{icon:l||v?(0,a.createElement)(g.Icon,{icon:u,className:"animate-spin fill-success"}):(0,a.createElement)(g.Icon,{icon:b}),toggleProps:{className:"optml-header\_\_dropdown uppercase font-bold text-xs text-success hover:text-success active:text-success focus:text-success mr-3 border border-gray-300 rounded-md border-solid gap-2",iconPosition:"right"},popoverProps:{className:"optml-header\_\_dropdown\_\_popover"},text:v?optimoleDashboardApp.strings.connecting:optimoleDashboardApp.strings.connected,controls:[{title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.dashboard\_menu\_item,onClick:()=>window.open(optimoleDashboardApp.optimoleDashHome,"\_blank")},{title:optimoleDashboardApp.strings.refresh\_stats\_cta,onClick:ge,isDisabled:v},{title:optimoleDashboardApp.strings.disconnect\_btn,onClick:()=>r(!0),isDisabled:v}]})):(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"uppercase font-bold text-xs text-danger mr-3"},optimoleDashboardApp.strings.not\_connected),(0,a.createElement)(g.Icon,{icon:h})))),i&&d&&m&&(0,a.createElement)("ul",{className:"flex gap-8 items-center max-w-screen-xl mx-auto my-0 justify-center sm:justify-normal"},\_.filter((e=>!e?.isDisabled)).map((({label:s,value:o})=>(0,a.createElement)("li",{key:o,className:p()("cursor-pointer text-purple-gray font-bold text-lg m-0 py-2 px-3 transition-colors duration-200 ease-in-out border-0 border-b-4 border-b-white border-solid",{"text-black !border-b-info":e===o}),onClick:()=>t(o)},s)))))},ke=()=>{const{setShowDisconnect:e}=(0,c.useDispatch)("optimole"),{isLoading:t}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}));return(0,a.createElement)(g.Modal,{title:optimoleDashboardApp.strings.disconnect\_title,className:"optml\_\_modal",onRequestClose:()=>e(!1)},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.disconnect\_desc}}),(0,a.createElement)("div",{className:"flex gap-2"},(0,a.createElement)(g.Button,{variant:"default",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>e(!1)},optimoleDashboardApp.strings.keep\_connected),(0,a.createElement)(g.Button,{isDestructive:!0,className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",isBusy:t,disabled:t,onClick:ue},optimoleDashboardApp.strings.disconnect\_btn)))},xe=({setMethod:e})=>{const[t,s]=(0,o.useState)(""),[n,r]=(0,o.useState)({}),[i,l]=(0,o.useState)(0),{setShowDisconnect:d}=(0,c.useDispatch)("optimole"),{availableApps:p,hasValidKey:m,isConnected:u,isConnecting:h,isLoading:b}=(0,c.useSelect)((e=>{const{getAvailableApps:t,hasValidKey:s,isConnected:a,isConnecting:o,isLoading:n}=e("optimole");return{availableApps:t(),hasValidKey:s(),isConnected:a(),isConnecting:o(),isLoading:n()}}));return(0,a.createElement)("div",{className:"text-2 font-bold m-0 text-gray-700"},(0,a.createElement)("div",{className:"text-gray-800 font-serif leading-7"},optimoleDashboardApp.strings.connect\_btn),(0,a.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.steps\_connect\_api\_desc}}),(0,a.createElement)("div",{className:"flex flex-col gap-8 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,a.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,a.createElement)(g.TextControl,{label:u?optimoleDashboardApp.strings.your\_api\_key:optimoleDashboardApp.strings.add\_api,placeholder:optimoleDashboardApp.strings.email,disabled:u,value:t,onChange:s,className:"optml\_\_input basis-4/5"}),u?(0,a.createElement)(g.Button,{variant:"default",isBusy:b,disabled:b,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:d},optimoleDashboardApp.strings.disconnect\_btn):(0,a.createElement)(g.Button,{variant:"primary",isBusy:h,disabled:h||0===t.length,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{r({}),((e,t=(()=>{}))=>{I(!0),T(!0),M(!1),C()({path:optimoleDashboardApp.routes.connect,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(I(!1),T(!1),"success"===e.code?(N(!0),O(!0),j(e.data.api\_key),void 0!==e.data.app\_count&&1<e.data.app\_count?B(e.data):(F(!0),H(e.data)),pe(),L(!0),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e),e.data))).catch((e=>(I(!1),T(!1),M(!0),e.data)))})({api\_key:t},(e=>{"success"!==e.code&&r({error\_connect:e.data})}))}},optimoleDashboardApp.strings.connect\_btn)),p&&(0,a.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,a.createElement)("div",{className:"basis-4/5"},(0,a.createElement)(g.SelectControl,{label:optimoleDashboardApp.strings.select+" "+optimoleDashboardApp.strings.your\_domain,value:i,options:p.available\_apps.map(((e,t)=>({label:e.domain,value:t}))),onChange:l,className:"optml\_\_select has\_large\_title",\_\_nextHasNoMarginBottom:!0})),(0,a.createElement)(g.Button,{variant:"primary",isBusy:h,disabled:h,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{((e,t=(()=>{}))=>{I(!0),M(!1),C()({path:optimoleDashboardApp.routes.select\_application,method:"POST",data:e}).then((e=>{I(!1),T(!1),"success"===e.code?(O(!0),F(!0),j(e.data.api\_key),H(e.data),B(e.data),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e)})).catch((e=>(I(!1),M(!0),e.data)))})({api\_key:t,application:null!=p&&void 0!==p.available\_apps?p.available\_apps[i].key:""},(e=>{"success"!==e.code&&r({error\_connect:e.data})}))}},optimoleDashboardApp.strings.select))),!m&&void 0!==n.error\_connect&&(0,a.createElement)("p",{className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:n.error\_connect}}),(0,a.createElement)("div",{className:"text-center py-3"},(0,a.createElement)(g.Button,{variant:"link",onClick:()=>e("email")},optimoleDashboardApp.strings.back\_to\_connect)))},Ce="optml-connect flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md",Se="flex gap-8 p-8 flex-col md:flex-row",Ae=()=>(0,a.createElement)("div",{className:"bg-danger text-white rounded relative px-6 py-5 mb-0 m-12",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_api\_not\_working}}),De=()=>{const[e,t]=(0,o.useState)(optimoleDashboardApp.current\_user.email),[s,n]=(0,o.useState)("email"),[r,i]=(0,o.useState)({}),{setAutoConnect:l}=(0,c.useDispatch)("optimole"),{autoConnect:d,hasRestError:p,isConnecting:m}=(0,c.useSelect)((e=>{const{getAutoConnect:t,hasRestError:s,isConnecting:a}=e("optimole");return{autoConnect:t(),hasRestError:s(),isConnecting:a()}}));return(0,o.useEffect)((()=>{"no"!==d&&me({email:d,auto\_connect:!0},(e=>{l("no"),"email\_registered"!==e.code?"site\_exists"!==e.code?"success"!==e.code&&e.message&&i({error\_autoconnect:e.message}):i({site\_exists:e.message}):i({email\_registered:e.message})}))}),[]),(0,o.useEffect)((()=>{(0===e.length||(0,S.isEmail)(e))&&r.invalid\_email&&(delete r.invalid\_email,i(r))}),[e]),"key"===s?(0,a.createElement)("div",{className:Ce},p&&(0,a.createElement)(Ae,null),(0,a.createElement)("div",{className:Se},(0,a.createElement)(xe,{setMethod:n}))):(0,a.createElement)("div",{className:Ce},p&&(0,a.createElement)(Ae,null),(0,a.createElement)("div",{className:Se},(0,a.createElement)("div",{className:"optml-connect\_\_content basis-8/12"},(0,a.createElement)("div",{className:"text-gray-700 font-serif text-2 font-bold leading-7 m-0"},optimoleDashboardApp.strings.account\_needed\_heading),(0,a.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_title}}),(0,a.createElement)("div",{className:"flex py-3"},(0,a.createElement)(g.Icon,{icon:"yes-alt"}),(0,a.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_1}})),(0,a.createElement)("div",{className:"flex py-3"},(0,a.createElement)(g.Icon,{icon:"yes-alt"}),(0,a.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_2}}))),(0,a.createElement)("div",{className:"optml-connect\_\_form basis-4/12 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.email\_address\_label,placeholder:optimoleDashboardApp.strings.email,value:e,onChange:t,className:"optml\_\_input",onBlur:()=>{0===e.length||(0,S.isEmail)(e)||i({invalid\_email:optimoleDashboardApp.strings.invalid\_email})}}),0<Object.keys(r).length&&Object.keys(r).map((e=>(0,a.createElement)("p",{key:e,className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:r[e]}})))||(0,a.createElement)("br",null),(0,a.createElement)(g.Button,{variant:"primary",isBusy:m,disabled:m||0===e.length||!(0,S.isEmail)(e),className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40",onClick:()=>{i({}),me({email:e},(e=>{"email\_registered"!==e.code?"site\_exists"!==e.code?"domain\_not\_accessible"!==e.code?"success"!==e.code&&i({error\_register:optimoleDashboardApp.strings.error\_register}):i({domain\_not\_accessible:e.message}):i({site\_exists:e.message}):i({email\_registered:e.message})}))}},optimoleDashboardApp.strings.register\_btn),(0,a.createElement)("br",null),(0,a.createElement)("br",null),(0,a.createElement)("div",{className:"base-control-label"},optimoleDashboardApp.strings.existing\_user),(0,a.createElement)(g.Button,{variant:"secondary",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>n("key")},optimoleDashboardApp.strings.api\_exists),(0,a.createElement)("p",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.signup\_terms}}))),(0,a.createElement)("div",{className:"bg-grayish-blue text-gray-800 text-center font-bold uppercase p-2.5 rounded-b-lg"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_footer}})))},Le=({value:e,max:t=100,className:s,...o})=>{const n=Math.round(e/t\*100),r=(o.background,p()("w-full h-2.5 border rounded-md border-solid bg-white border-light-gray relative overflow-hidden",s));return(0,a.createElement)("div",{className:r,role:"progressbar","aria-valuemin":"0","aria-valuemax":t,"aria-valuenow":e,...o},(0,a.createElement)("div",{className:"absolute left-0 h-full bg-info",style:{width:`${n}%`}}))},Ne=[optimoleDashboardApp.strings.options\_strings.connect\_step\_0,optimoleDashboardApp.strings.options\_strings.connect\_step\_1,optimoleDashboardApp.strings.options\_strings.connect\_step\_2,optimoleDashboardApp.strings.options\_strings.connect\_step\_3],Ie=()=>{const[e,t]=(0,o.useState)(0),[s,n]=(0,o.useState)(0),[r,i]=(0,o.useState)(0),{sethasDashboardLoaded:l}=(0,c.useDispatch)("optimole");(0,o.useEffect)((()=>{r<=25&&setTimeout((()=>{d()}),1e3)}),[r]);const d=()=>{if(i(r+1),r>=25)return l(!0),i(0),n(0),void t(0);t(Math.floor(r/25\*100)),e>30\*(s+1)&&n(s+1)};return(0,a.createElement)("div",{className:"optml-connecting flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md"},(0,a.createElement)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-5 px-8 sm:px-0 py-24"},(0,a.createElement)("img",{className:"max-w-full",src:optimoleDashboardApp.assets\_url+"img/connecting.png"}),(0,a.createElement)("div",{className:"text-center md:text-left"},(0,a.createElement)("div",{className:"font-bold text-2xl"},optimoleDashboardApp.strings.account\_connecting\_title),(0,a.createElement)("div",{className:"text-base"},optimoleDashboardApp.strings.account\_connecting\_subtitle),(0,a.createElement)(Le,{className:"mt-2.5 mb-1.5 mx-0 h-5 border-gray-200",value:r,max:25,background:"#e6e6e6"}),(0,a.createElement)("div",{className:"text-xs"},Ne[s]+" ("+e+"%)"))))},Te=function(){const[e,t]=(0,a.useState)(null),[s,o]=(0,a.useState)({width:0,height:0}),n=(0,a.useCallback)((()=>{o({width:(null==e?void 0:e.offsetWidth)||0,height:(null==e?void 0:e.offsetHeight)||0})}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]);return Me("resize",n),Oe((()=>{n()}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]),[t,s]},Me=function(e,t,s,o){const n=(0,a.useRef)(t);Oe((()=>{n.current=t}),[t]),(0,a.useEffect)((()=>{var t;const a=null!==(t=null==s?void 0:s.current)&&void 0!==t?t:window;if(!a||!a.addEventListener)return;const r=e=>n.current(e);return a.addEventListener(e,r,o),()=>{a.removeEventListener(e,r,o)}}),[e,s,o])},Oe="undefined"!=typeof window?a.useLayoutEffect:a.useEffect,Fe="yes"!==optimoleDashboardApp.connection\_status,je=({src:e,oldSize:t,newSize:s})=>{const[o,{width:n}]=Te();return(0,a.createElement)("div",{className:"basis-1/4"},(0,a.createElement)("img",{src:e,className:"w-full border border-slate-200 rounded-md border-solid",style:{height:n},ref:o}),(0,a.createElement)("p",{className:"optml\_\_bullet w-full h-4"},(()=>{let e=(100\*(1-s/t)).toFixed(1);return 1>e?"1":100<e?(Math.floor(e/10+10)/10).toFixed(1).toString():e.toString()})(),"% ",optimoleDashboardApp.strings.latest\_images.saved," "))},He=()=>{const[e,{width:t}]=Te();return(0,a.createElement)("div",{className:"basis-1/4"},(0,a.createElement)("div",{className:"optml\_\_loader w-full rounded-md",style:{height:t},ref:e}),(0,a.createElement)("p",{className:"optml\_\_loader w-full h-4"}))},Be=()=>{const[e,t]=(0,o.useState)(!1),[s,n]=(0,o.useState)(0),[r,i]=(0,o.useState)(0),[l,d]=(0,o.useState)(0);(0,o.useEffect)((()=>{l<=20&&setTimeout((()=>{m()}),1e3)}),[l]);const{images:p}=(0,c.useSelect)((e=>{const{getOptimizedImages:t}=e("optimole");return{images:t()||[]}}));(0,o.useEffect)((()=>{8<=p.length?t(!0):e||Fe||he((()=>{t(!0)}))}),[]);const m=()=>{d(l+1),l>=20?he((()=>{t(!0),d(0),i(0),n(0),ge()})):(n(Math.floor(l/20\*100)),s>30\*(r+1)&&i(r+1))};return(0,a.createElement)("div",{className:"hidden lg:block pt-5 border-grayish-blue border-0 border-t-2 border-solid"},(0,a.createElement)("h3",{className:"text-base m-0"},optimoleDashboardApp.strings.latest\_images.last," ",optimoleDashboardApp.strings.latest\_images.optimized\_images),Fe&&!e&&(0,a.createElement)("div",{className:"flex items-center flex-col py-2"},(0,a.createElement)("p",{className:"font-semibold"},optimoleDashboardApp.strings.latest\_images.loading\_latest\_images),(0,a.createElement)(Le,{max:20,value:l})),!Fe&&!e&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,a.createElement)(He,null)))),(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,a.createElement)(He,null))))),e&&4>p?.length&&(0,a.createElement)("div",{className:"text-center py-12"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.latest\_images.no\_images\_found}})),e&&4<=p?.length&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(0,a.createElement)(je,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))),8<=p?.length&&(0,a.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(t+=4,(0,a.createElement)(je,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))))))},ze="flex p-6 bg-light-blue border border-blue-300 rounded-md",Re=[{label:optimoleDashboardApp.strings.metrics.metricsTitle1,description:optimoleDashboardApp.strings.metrics.metricsSubtitle1,value:"images\_number",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M42.0235 45.3568L45.0279 46.6928C46.5427 47.3666 48.25 46.2574 48.25 44.5982V10.402C48.25 8.74281 46.5427 7.63364 45.0279 8.30739L42.0235 9.64343C32.8569 13.718 22.3931 13.718 13.2265 9.64343L10.2221 8.30739C8.70729 7.63364 7 8.74281 7 10.402V44.5982C7 46.2574 8.70729 47.3666 10.2221 46.6928L13.2265 45.3568C22.3931 41.2845 32.8569 41.2845 42.0235 45.3568Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M34.5002 35.5209H20.7502C19.4852 35.5209 18.4585 34.4942 18.4585 33.2292V21.7709C18.4585 20.5059 19.4852 19.4792 20.7502 19.4792H34.5002C35.7652 19.4792 36.7918 20.5059 36.7918 21.7709V33.2292C36.7918 34.4942 35.7652 35.5209 34.5002 35.5209Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.9707 25.0939L36.7915 29.8376",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.9711 25.0939L26.0669 30.2043",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M26.0665 30.2043L23.3853 28.4167",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M23.3856 28.4167L18.4585 32.5647",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle2,description:optimoleDashboardApp.strings.metrics.metricsSubtitle2,value:"saved\_size",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"56",height:"55",viewBox:"0 0 56 55",fill:"none"},(0,a.createElement)("path",{d:"M36.681 6.875H13.7643C8.70203 6.875 4.59766 10.9794 4.59766 16.0417C4.59766 21.104 8.70203 25.2083 13.7643 25.2083H36.681C41.7433 25.2083 45.8477 21.104 45.8477 16.0417C45.8477 10.9794 41.7433 6.875 36.681 6.875Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.7643 25.2084C8.70203 25.2084 4.59766 29.3127 4.59766 34.375C4.59766 39.4373 8.70203 43.5417 13.7643 43.5417H29.806",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9307 16.0416H36.6807",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.845 15.9606C13.8898 16.0053 13.8898 16.0779 13.845 16.1226C13.8003 16.1674 13.7277 16.1674 13.683 16.1226C13.6382 16.0779 13.6382 16.0053 13.683 15.9606C13.7277 15.9158 13.8003 15.9158 13.845 15.9606Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9307 34.375H27.7432",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M13.845 34.2938C13.8898 34.3386 13.8898 34.4111 13.845 34.4559C13.8003 34.5006 13.7277 34.5006 13.683 34.4559C13.6382 34.4111 13.6382 34.3386 13.683 34.2938C13.7277 34.2491 13.8003 34.2491 13.845 34.2938Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.9725 48.125C32.6452 48.125 27.5142 42.994 27.5142 36.6667C27.5142 30.3394 32.6452 25.2084 38.9725 25.2084C45.3021 25.2084 50.4308 30.3394 50.4308 36.6667C50.4308 42.994 45.3021 48.125 38.9725 48.125Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M40.2465 31.5745L36.4263 35.3924L41.5184 37.9407L37.6981 41.7586",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle3,description:optimoleDashboardApp.strings.metrics.metricsSubtitle3,value:"compression\_percentage",icon:()=>(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,a.createElement)("path",{d:"M43.5418 32.0833C41.0095 32.0833 38.9585 30.0323 38.9585 27.5C38.9585 24.9677 41.0095 22.9166 43.5418 22.9166C46.0741 22.9166 48.1252 24.9677 48.1252 27.5C48.1252 30.0323 46.0741 32.0833 43.5418 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M32.0832 43.5417C32.0832 46.074 30.0321 48.1251 27.4998 48.1251C24.9675 48.1251 22.9165 46.074 22.9165 43.5417C22.9165 41.0094 24.9675 38.9584 27.4998 38.9584C30.0321 38.9584 32.0832 41.0094 32.0832 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M43.5418 48.1251C41.0095 48.1251 38.9585 46.074 38.9585 43.5417C38.9585 41.0094 41.0095 38.9584 43.5418 38.9584C46.0741 38.9584 48.1252 41.0094 48.1252 43.5417C48.1252 46.074 46.0741 48.1251 43.5418 48.1251Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M27.4998 16.0417C24.9675 16.0417 22.9165 13.9906 22.9165 11.4583C22.9165 8.92604 24.9675 6.875 27.4998 6.875C30.0321 6.875 32.0832 8.92604 32.0832 11.4583C32.0832 13.9906 30.0321 16.0417 27.4998 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M38.9585 11.4583C38.9585 8.92604 41.0095 6.875 43.5418 6.875C46.0741 6.875 48.1252 8.92604 48.1252 11.4583C48.1252 13.9906 46.0741 16.0417 43.5418 16.0417C41.0095 16.0417 38.9585 13.9906 38.9585 11.4583Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.7314 40.3104L40.3106 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M14.6895 40.3104L24.2686 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M30.7314 24.2687L40.3106 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M22.9165 27.5C22.9165 24.9677 24.9675 22.9166 27.4998 22.9166C30.0321 22.9166 32.0832 24.9677 32.0832 27.5C32.0832 30.0323 30.0321 32.0833 27.4998 32.0833C24.9675 32.0833 22.9165 30.0323 22.9165 27.5Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M14.6895 24.2687L24.2686 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M11.4583 32.0833C8.92604 32.0833 6.875 30.0323 6.875 27.5C6.875 24.9677 8.92604 22.9166 11.4583 22.9166C13.9906 22.9166 16.0417 24.9677 16.0417 27.5C16.0417 30.0323 13.9906 32.0833 11.4583 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M16.0417 43.5417C16.0417 46.074 13.9906 48.1251 11.4583 48.1251C8.92604 48.1251 6.875 46.074 6.875 43.5417C6.875 41.0094 8.92604 38.9584 11.4583 38.9584C13.9906 38.9584 16.0417 41.0094 16.0417 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{d:"M11.4583 16.0417C8.92604 16.0417 6.875 13.9906 6.875 11.4583C6.875 8.92604 8.92604 6.875 11.4583 6.875C13.9906 6.875 16.0417 8.92604 16.0417 11.4583C16.0417 13.9906 13.9906 16.0417 11.4583 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle4,description:optimoleDashboardApp.strings.metrics.metricsSubtitle4,value:"traffic",icon:()=>(0,a.createElement)("svg",{width:"55",height:"55",viewBox:"0 0 64 64",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false"},(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667M24 32h10.667",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48M42.667 16H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48M42.667 26.667H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48M42.667 37.333H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48M42.667 48H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}))}],Pe=()=>(0,a.createElement)("div",{className:"flex gap-2 bg-warning text-danger border border-solid border-danger rounded relative px-6 py-5 mb-5"},(0,a.createElement)(g.Icon,{icon:\_}),(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_disabled\_account}})),Ve=()=>(0,a.createElement)("div",{className:"flex gap-2 bg-success text-white rounded relative px-6 py-5 mb-5"},(0,a.createElement)(g.Icon,{icon:"cloud-saved"}),(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_just\_activated}})),$e=()=>{const{userData:e,userStatus:t}=(0,c.useSelect)((e=>{const{getUserData:t,getUserStatus:s}=e("optimole");return{userData:t(),userStatus:s()}})),s=(e.visitors/e.visitors\_limit\*100).toFixed(0);return(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},0<optimoleDashboardApp.strings.notice\_just\_activated.length&&"active"===t&&(0,a.createElement)(Ve,null),"inactive"===t&&(0,a.createElement)(Pe,null),(0,a.createElement)("div",{className:p()(ze,"gap-8 flex-col sm:flex-row items-start sm:items-center")},(0,a.createElement)(g.Icon,{icon:f}),(0,a.createElement)("div",{className:"flex w-full flex-col"},(0,a.createElement)("div",{className:"flex w-full justify-between"},(0,a.createElement)("div",{className:"text-gray-800 text-2xl font-bold"},e.visitors\_pretty," / ",e.visitors\_limit\_pretty,(0,a.createElement)("span",{className:"text-gray-600 text-base font-normal ml-2"},optimoleDashboardApp.strings.quota)),70>s&&(0,a.createElement)(g.Button,{variant:"default",className:"optml\_\_button rounded font-bold min-h-40",href:optimoleDashboardApp.optimoleDashBilling,target:"\_blank"},optimoleDashboardApp.strings.upgrade.title)),(0,a.createElement)("div",null,(0,a.createElement)(Le,{className:"mt-2.5 mb-3 mx-0",value:e.visitors,max:e.visitors\_limit}),(0,a.createElement)("div",{className:"optml\_\_tooltip",style:{left:s+"%",marginLeft:15>s?"-15px":"-20px",display:100<s?"none":"block"}},(0,a.createElement)("span",null,s,"%"))))),(0,a.createElement)("div",{className:"flex py-5 gap-5 flex-col md:flex-row"},Re.map((t=>(0,a.createElement)("div",{key:t.value,className:p()(ze,"basis-1/4 flex-col items-start")},(0,a.createElement)(g.Icon,{icon:t.icon}),(0,a.createElement)("div",{className:"flex w-full flex-col"},(0,a.createElement)("div",{className:"not-italic font-bold text-xl py-2 text-gray-800"},(t=>{const s=(t=>void 0!==e[t]?e[t]:"saved\_size"===t?Math.floor(2500\*Math.random())+500:Math.floor(40\*Math.random())+10)(t);return"saved\_size"===t?(s/1e3).toFixed(2)+"MB":"compression\_percentage"===t?s.toFixed(2)+"%":"traffic"===t?s.toFixed(2)+"MB":s})(t.value)),(0,a.createElement)("div",{className:"not-italic font-normal text-sm text-gray-800"},t.label),(0,a.createElement)("div",{className:"font-normal text-xs text-gray-600"},t.description)))))),"yes"!==optimoleDashboardApp.remove\_latest\_images&&(0,a.createElement)(Be,null))},qe=({conflict:e})=>{const[t,s]=(0,o.useState)(!1);return(0,a.createElement)("div",{className:p()("flex gap-2 text-white rounded relative px-6 py-5 mb-5",{"bg-danger":"high"===e.severity,"bg-info":"medium"===e.severity,"bg-success":"high"!==e.severity&&"medium"!==e.severity})},(0,a.createElement)("p",{className:"m-0 text-white",dangerouslySetInnerHTML:{\_\_html:e.message}}),(0,a.createElement)(g.Button,{icon:t?u:"no-alt",label:optimoleDashboardApp.strings.conflicts.conflict\_close,disabled:t,className:p()("text-white hover:text-white",{"animate-spin":t}),onClick:()=>{s(!0),((e,t=(()=>{}))=>{T(!0),C()({path:optimoleDashboardApp.routes.dismiss\_conflict,method:"POST",data:{conflictID:e}}).then((e=>{T(!1),"success"===e.code&&P(e.data),t&&t(e)}))})(e.id,(()=>{s(!1)}))}}))},Ze=()=>{const{conflicts:e}=(0,c.useSelect)((e=>{const{getConflicts:t}=e("optimole");return{conflicts:t().conflicts||[]}}));return(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},Boolean(e.length)&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,optimoleDashboardApp.strings.conflicts.title),e.map((e=>(0,a.createElement)(qe,{key:e.id,conflict:e})))),!Boolean(e.length)&&(0,a.createElement)("div",{className:"text-center py-12"},(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.conflicts.no\_conflicts\_found}})))},Ue=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),Ge=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),{strings:Ke}=optimoleDashboardApp,Ye=[{label:Ke.general\_settings\_menu\_item,value:"general"},{label:Ke.advanced\_settings\_menu\_item,value:"compression",children:[{label:Ke.settings\_compression\_menu\_item,value:"compression"},{label:Ke.settings\_resize\_menu\_item,value:"resize"},{label:Ke.lazyload\_settings\_menu\_item,value:"lazyload"},{label:Ke.settings\_exclusions\_menu\_item,value:"exclusions"}]},{label:Ke.cloud\_library,value:"cloud\_library"},{label:Ke.image\_storage,value:"offload\_media"}],Qe=({children:e,tab:t,settings:s,setTab:o})=>(0,a.createElement)("ul",{className:"flex flex-col gap-1 m-0 mt-1"},e.map((e=>{const{value:n,label:r}=e;if("lazyload"===e.value&&"disabled"===s.lazyload)return;const i=p()({"bg-light-blue hover:text-purple-gray":t===n,"bg-transparent hover:text-info":t!==n},"w-full text-left border-0 font-normal text-base text-purple-gray cursor-pointer rounded px-4 py-2 m-0 hover:text-info");return(0,a.createElement)("li",{key:n},(0,a.createElement)("button",{className:i,onClick:()=>o(n)},r))}))),Je=({tab:e,settings:t,setTab:s})=>(0,a.createElement)("div",{className:"basis-1/5"},(0,a.createElement)("ul",{className:"grid m-0 gap-1"},Ye.map((o=>{const n=e===o.value||o.children&&o.children.some((t=>t.value===e)),r=p()({"!text-info":n},"w-full bg-transparent border-0 flex items-center appearance-none not-italic font-semibold text-base text-purple-gray cursor-pointer hover:text-info py-2");return(0,a.createElement)("li",{key:o.value,className:"m-0"},(0,a.createElement)("button",{className:r,onClick:()=>s(o.value)},o.label,o.children&&(0,a.createElement)(g.Icon,{icon:n?Ue:Ge,className:"inline-block ml-2 fill-current"})),o.children&&n&&(0,a.createElement)(Qe,{children:o.children,tab:e,settings:t,setTab:s}))})))),We=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,a.createElement)(m.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),Xe=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),et=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),tt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),st=(0,o.forwardRef)((function({icon:e,size:t=24,...s},a){return(0,o.cloneElement)(e,{width:t,height:t,...s,ref:a})})),at=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}));function ot({text:e,title:t,disableIcon:s=!1,type:o="info",className:n="",smallTitle:r=!1,children:i,onDismiss:l}){const c=p()({"bg-yellow-50 text-yellow-700":"warning"===o,"bg-green-50 text-green-700":"success"===o,"bg-red-50 text-red-700":"error"===o,"bg-blue-50 text-blue-700":"info"===o,"bg-info text-white":"primary"===o},`rounded-md my-5 text-sm p-4 om-notice om-notice-${o} relative`),d=p()({"fill-yellow-500":"warning"===o,"fill-green-500":"success"===o,"fill-red-500":"error"===o,"fill-blue-500":"info"===o,"fill-white":"primary"===o,"h-6 w-6":"primary"!==o,"h-12 w-12":"primary"===o}),m=p()({"ml-3 mt-0.5":!s&&!t,"mt-2 mx-1.5":t}),u=p()({"text-yellow-800":"warning"===o,"text-green-800":"success"===o,"text-red-800":"error"===o,"text-blue-800":"info"===o,"font-bold text-base":"primary"!==o,"text-white text-sm":"primary"===o,"text-s":r},"m-0"),g={warning:We,success:Xe,error:et,info:tt,primary:E};return(0,a.createElement)("div",{className:c},l&&(0,a.createElement)("button",{className:"flex items-center justify-center absolute bg-transparent text-current right-1 top-1 border-0 rounded-full p-0 cursor-pointer hover:bg-white transition-all hover:text-info",onClick:l},(0,a.createElement)(st,{className:"fill-current",icon:at})),(0,a.createElement)("div",{className:t?"grid":"flex"},(0,a.createElement)("div",{className:p()("flex-shrink-0 flex gap-2",{"items-center":t})},!s&&(0,a.createElement)(st,{icon:g[o]||null,className:d}),t&&(0,a.createElement)("div",{className:u,dangerouslySetInnerHTML:{\_\_html:t}})),i||e&&(0,a.createElement)("div",{className:m},e&&(0,a.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:e}}),i)))}const nt=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:o}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),n="disabled"!==e.image\_replacer,r="disabled"!==e.lazyload,i="disabled"!==e.report\_script,l="disabled"!==e.cdn,d="disabled"!==e.banner\_frontend,m=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_image\_replace,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.replacer\_desc}}),checked:n,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("image\_replacer",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_lazyload,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.lazyload\_desc}}),checked:r,disabled:!n||o,className:p()({"is-disabled":!n||o}),onChange:e=>m("lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_report\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_report\_desc}}),checked:i,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("report\_script",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_badge\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_badge\_description}}),checked:d,disabled:o,className:p()({"is-disabled":o}),onChange:e=>m("banner\_frontend",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.cache\_title,className:p()({"is-disabled":o||!n})},(0,a.createElement)("p",{className:"components-base-control\_\_help m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cache\_desc}}),(0,a.createElement)("div",{className:"flex my-4 gap-3"},(0,a.createElement)(g.Button,{variant:"default",isBusy:o,disabled:o||!n,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>fe()},optimoleDashboardApp.strings.options\_strings.clear\_cache\_images),l&&(0,a.createElement)(g.Button,{variant:"default",isBusy:o,disabled:o||!n,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>fe("assets")},optimoleDashboardApp.strings.options\_strings.clear\_cache\_assets))),(0,a.createElement)(ot,{type:"warning",text:optimoleDashboardApp.strings.options\_strings.clear\_cache\_notice,disableIcon:!0}))};var rt=s(864),it=s.n(rt);const lt=({settings:e,setSettings:t,setCanSave:s,showSample:o,isSampleLoading:n,setIsSampleLoading:r})=>{const{sampleImages:i,isLoading:l}=(0,c.useSelect)((e=>{const{getSampleRate:t,isLoading:s}=e("optimole");return{sampleImages:t(),isLoading:s()}})),d="disabled"!==e.network\_optimization,m="disabled"!==e.cdn,h="disabled"!==e.img\_to\_video,b="disabled"!==e.avif,f="disabled"!==e.strip\_metadata,\_="disabled"!==e.autoquality,v="disabled"!==e.best\_format,E=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},y=()=>i.optimized\_size>i.original\_size?Math.floor(60\*Math.random())+10:(100\*parseFloat(i.optimized\_size/i.original\_size)).toFixed(0);return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.best\_format\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.best\_format\_desc}}),checked:v,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("best\_format",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_desc}}),checked:d,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("network\_optimization",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_cdn,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cdn\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("cdn",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_gif\_replace\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.gif\_replacer\_desc}}),checked:h,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("img\_to\_video",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_avif\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_avif\_desc}}),checked:b,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("avif",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.strip\_meta\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.strip\_meta\_desc}}),checked:f,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("strip\_metadata",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{help:!\_&&optimoleDashboardApp.strings.options\_strings.quality\_desc},(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.quality\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.ml\_quality\_desc}}),checked:\_,disabled:l,className:p()({"is-disabled":l}),onChange:e=>E("autoquality",e)})),!\_&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.RangeControl,{value:(w=e.quality,"number"==typeof w?w:"auto"===w||"high\_c"===w?90:"medium\_c"===w?75:"low\_c"===w?55:90),min:50,max:100,step:1,withInputField:!1,marks:[{value:55,label:optimoleDashboardApp.strings.options\_strings.low\_q\_title},{value:75,label:optimoleDashboardApp.strings.options\_strings.medium\_q\_title},{value:90,label:optimoleDashboardApp.strings.options\_strings.high\_q\_title}],onChange:a=>{s(!0);const o={...e};o.quality=a,t(o)}}),o&&(0,a.createElement)("div",{className:"flex justify-center w-full text-center"},n?(0,a.createElement)("div",{className:"flex items-center gap-5"},(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.sample\_image\_loading),(0,a.createElement)(g.Icon,{icon:u,className:"animate-spin"})):(0,a.createElement)(a.Fragment,null,i.id&&0<i.original\_size&&(0,a.createElement)("div",null,0<y()?(0,a.createElement)("p",{className:"text-base"},100-y(),"% ",optimoleDashboardApp.strings.latest\_images.smaller):(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.latest\_images.same\_size),(0,a.createElement)(Le,{max:100,value:100-y()}),(0,a.createElement)("hr",{className:"my-4 border-grayish-blue"}),(0,a.createElement)(it(),{leftImageLabel:optimoleDashboardApp.strings.options\_strings.image\_1\_label,rightImageLabel:optimoleDashboardApp.strings.options\_strings.image\_2\_label,leftImage:i.original,rightImage:i.optimized}),(0,a.createElement)(g.Button,{variant:"default",icon:u,className:"mt-2",onClick:()=>{r(!0),\_e({quality:e.quality,force:"yes"},(()=>r(!1)))}}),(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.quality\_slider\_desc)),!(i.id&&0<i.original\_size)&&0>i.id&&(0,a.createElement)("div",{className:"flex items-center gap-5 text-center"},(0,a.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.no\_images\_found))))));var w},ct=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:n}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[r,i]=(0,o.useState)(""),[l,d]=(0,o.useState)(""),m="disabled"!==e.resize\_smart,u="disabled"!==e.retina\_images,h="disabled"!==e.limit\_dimensions,b=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},f=(a,o)=>{s(!0);const n={...e};n[a]=o,t(n)},\_=Object.keys(e.defined\_image\_sizes).filter((t=>"object"==typeof e.defined\_image\_sizes[t]));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_desc}}),checked:m,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("resize\_smart",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),"disabled"!==e.lazyload&&(0,a.createElement)(a.Fragment,null," ",(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_retina\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_retina\_desc}}),checked:u,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("retina\_images",e)})," ",(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"})," "),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_desc}}),checked:h,disabled:n,className:p()({"is-disabled":n}),onChange:e=>b("limit\_dimensions",e)}),h&&(0,a.createElement)(g.BaseControl,null,(0,a.createElement)("div",{className:"flex gap-8"},(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,labelPosition:"side",value:e.limit\_width,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>f("limit\_width",e)}),(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,labelPosition:"side",value:e.limit\_height,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>f("limit\_height",e)})),(0,a.createElement)(ot,{disableIcon:!0,type:"warning",text:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_notice})),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.add\_image\_size\_desc},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.image\_size\_notice}}),(0,a.createElement)("div",{className:"flex flex-col sm:flex-row p-6 bg-light-blue border border-blue-300 rounded-md items-stretch sm:items-center gap-8"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,placeholder:optimoleDashboardApp.strings.options\_strings.width\_field,hideLabelFromVision:!0,type:"number",min:1,value:r,onChange:i,className:"optml\_\_input sm:basis-2/5"}),(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,placeholder:optimoleDashboardApp.strings.options\_strings.height\_field,value:l,onChange:d,hideLabelFromVision:!0,type:"number",min:1,className:"optml\_\_input sm:basis-2/5"}),(0,a.createElement)(g.Button,{variant:"primary",isBusy:n,disabled:n,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(!r||!l||isNaN(r)||isNaN(l))return;const a="optimole\_"+r+"\_"+l+"\_crop",o={...e.defined\_image\_sizes,[a]:{width:r,height:l}};s(!0);const n={...e};n.defined\_image\_sizes=o,t(n),i(""),d("")}},optimoleDashboardApp.strings.options\_strings.add\_image\_size\_button))),0<\_.length&&(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.image\_sizes\_title,className:"pt-4"},\_.map((o=>(0,a.createElement)("div",{key:o,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex flex-wrap items-center gap-2"},(0,a.createElement)("div",null,(0,a.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.name}})," ",o),(0,a.createElement)("p",{className:"m-0"},(0,a.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.width\_field),": ",e.defined\_image\_sizes[o].width),(0,a.createElement)("p",{className:"m-0"},(0,a.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.height\_field),": ",e.defined\_image\_sizes[o].height)),(0,a.createElement)(g.Button,{variant:"default",icon:"trash",disabled:n,onClick:()=>(a=>{const o={...e.defined\_image\_sizes,[a]:"remove"};s(!0);const n={...e};n.defined\_image\_sizes=o,t(n)})(o)}))))))},dt=({settings:e,setSettings:t,setCanSave:s})=>{const{isLoading:n}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),r="disabled"!==e.lazyload\_placeholder,i="disabled"!==e.native\_lazyload,l="disabled"===e.scale,d="disabled"!==e.bg\_replacer,m="disabled"!==e.video\_lazyload,u="disabled"!==e.no\_script,h=e.placeholder\_color,[b,f]=(0,o.useState)(!1),\_=(a,o)=>{s(!0);const n={...e};n[a]=o?"enabled":"disabled",t(n)},v=(a,o)=>{s(!0);const n={...e};n[a]=o,t(n)},E=e=>{v("placeholder\_color",e)};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.BaseControl,null,(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_desc}}),checked:r,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("lazyload\_placeholder",e)}),r&&(0,a.createElement)("div",{className:"relative inline-block"},(0,a.createElement)(g.Button,{disabled:n,className:"gap-3 mt-2 py-3 h-auto rounded text-inherit border-gray-400 border-2 border-solid font-medium",onClick:()=>{f(!b)}},(0,a.createElement)(g.ColorIndicator,{colorValue:h}),(0,a.createElement)("span",null,optimoleDashboardApp.strings.options\_strings.lazyload\_placeholder\_color)),b&&(0,a.createElement)(g.Popover,{placement:"bottom",position:"middle center",variant:"unstyled",className:"shadow-md border-grayish-blue border border-solid rounded bg-white p-2",onFocusOutside:()=>f(!1)},(0,a.createElement)(g.ColorPicker,{color:h,onChange:E,enableAlpha:!0,defaultValue:""}),(0,a.createElement)(g.Button,{isDestructive:!0,className:"w-full text-center flex justify-center",variant:"secondary",onClick:()=>{E("")}},optimoleDashboardApp.strings.options\_strings.clear)))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_title},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_desc}}),(0,a.createElement)("div",{className:"flex gap-8"},(0,a.createElement)(g.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first,labelPosition:"side",value:e.skip\_lazyload\_images,type:"number",min:0,className:"basis-1/2 md:basis-1/3",onChange:e=>v("skip\_lazyload\_images",e)}))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_native,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.native\_desc}}),checked:i,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("native\_lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_scale,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.scale\_desc}}),checked:l,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("scale",!e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_desc}}),checked:m,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("video\_lazyload",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_desc}}),checked:u,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("no\_script",e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_desc}}),checked:d,disabled:n,className:p()({"is-disabled":n}),onChange:e=>\_("bg\_replacer",e)}),d&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(g.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.watch\_title\_lazyload,id:"optml-css-watchers"},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.watch\_desc\_lazyload}}),(0,a.createElement)(g.TextareaControl,{id:"optml-css-watchers",placeholder:optimoleDashboardApp.strings.options\_strings.watch\_placeholder\_lazyload,value:e.watchers,onChange:e=>v("watchers",e)}))))},pt="extension",mt="page\_url",ut="page\_url\_match",gt="filename",ht="class",bt=[{label:optimoleDashboardApp.strings.options\_strings.filter\_filename,value:gt},{label:optimoleDashboardApp.strings.options\_strings.filter\_ext,value:pt},{label:optimoleDashboardApp.strings.options\_strings.filter\_url,value:mt},{label:optimoleDashboardApp.strings.options\_strings.filter\_class,value:ht}],ft=[{label:optimoleDashboardApp.strings.options\_strings.exclude\_filename\_desc,value:gt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_ext\_desc,value:pt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_desc,value:mt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_match\_desc,value:ut},{label:optimoleDashboardApp.strings.options\_strings.exclude\_class\_desc,value:ht}],\_t=[{label:".SVG",value:"svg"},{label:".JPG",value:"jpg"},{label:".PNG",value:"png"},{label:".GIF",value:"gif"},{label:".WEBP",value:"webp"}],vt=({label:e,help:t,type:s,settings:n,setSettings:r,setCanSave:i})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[d,p]=(0,o.useState)(gt),[m,u]=(0,o.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[h,b]=(0,o.useState)(""),[f,\_]=(0,o.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[v,E]=(0,o.useState)(!1),y=0<Object.keys(n.filters[s][pt]).length&&Object.values(n.filters[s][pt]).some((e=>!1!==e))||0<Object.keys(n.filters[s][ht]).length&&Object.values(n.filters[s][ht]).some((e=>!1!==e))||0<Object.keys(n.filters[s][mt]).length&&Object.values(n.filters[s][mt]).some((e=>!1!==e))||0<Object.keys(n.filters[s][ut]).length&&Object.values(n.filters[s][ut]).some((e=>!1!==e))||0<Object.keys(n.filters[s][gt]).length&&Object.values(n.filters[s][gt]).some((e=>!1!==e));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.BaseControl,{label:e,help:d===mt&&optimoleDashboardApp.strings.options\_strings.filter\_helper},(0,a.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:t}}),(0,a.createElement)("div",{className:"flex flex-col md:flex-row p-6 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex justify-start items-center gap-4"},(0,a.createElement)(g.SelectControl,{value:d,options:bt,onChange:e=>{let t="";e===pt&&(t="svg",u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_is)),e===gt&&u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),e===ht&&u(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),E(!1),b(t),p(e)},className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}),d===mt?(0,a.createElement)(g.SelectControl,{value:f,options:[{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains},{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches}],onChange:\_,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,a.createElement)("p",{className:"m-0"},m),d===pt?(0,a.createElement)(g.SelectControl,{value:h,options:\_t,onChange:b,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,a.createElement)(g.TextControl,{value:h,placeholder:"matches"===f?"path":"word",onChange:e=>{b(e),E(!1)},className:"optml\_\_input"})),(0,a.createElement)(g.Button,{variant:"primary",isBusy:l,disabled:l,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(3>h.length)return void E(!0);const e={...n.filters};let t=d;d===mt&&"matches"===f&&(t=ut),e[s]&&"object"==typeof e[s]||(e[s]={}),e[s][t]&&!Array.isArray(e[s][t])||(e[s][t]={}),e[s][t][h]=!0,r({...n,filters:e}),d!==pt&&b(""),i(!0)}},optimoleDashboardApp.strings.options\_strings.add\_filter)),v&&(0,a.createElement)("p",{className:"text-red-500 bg-red-100 p-2 rounded-md border border-solid border-red-200"},optimoleDashboardApp.strings.options\_strings.filter\_length\_error)),y&&(0,a.createElement)(g.BaseControl,{label:"optimize"===s?optimoleDashboardApp.strings.options\_strings.active\_optimize\_exclusions:optimoleDashboardApp.strings.options\_strings.active\_lazyload\_exclusions,className:"py-4"},ft.map((e=>Object.keys(n.filters[s][e.value]).filter((t=>!1!==n.filters[s][e.value][t])).map((t=>(0,a.createElement)("div",{key:t,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,a.createElement)("div",{className:"flex items-center gap-1"},(0,a.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:e.label}}),(0,a.createElement)("b",null,t)),(0,a.createElement)(g.Button,{variant:"default",icon:"trash",disabled:l,onClick:()=>((e,t)=>{const a={...n.filters};a[s][e][t]=!1,r({...n,filters:a}),i(!0)})(e.value,t)}))))))))},Et=({settings:e,setSettings:t,setCanSave:s})=>{const o="disabled"!==e.lazyload;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(vt,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_optimize,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_optimize,type:"optimize",settings:e,setSettings:t,setCanSave:s}),o&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)(vt,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_lazyload,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_lazyload,type:"lazyload",settings:e,setSettings:t,setCanSave:s})))};function yt({options:e,value:t,onChange:s,label:o,disabled:n=!1,className:r}){return p()({"opacity-50":n},"transition-all my-6 gap-6 grid opacity-100"),(0,a.createElement)("fieldset",{className:`my-6 gap-6 grid ${r}`,onChange:e=>{s(e.target.value)}},o&&(0,a.createElement)("legend",{className:"uppercase font-semibold text-s text-light-black mb-6"},o),e.map(((e,s)=>{const{title:o,value:r,description:i}=e,l=t===r,c=p()({"outline-info":l,"outline-transparent":!l},"flex gap-6 items-start bg-gray-50 rounded-md p-4 outline -outline-offset-3 outline-3 transition-all");return(0,a.createElement)("label",{htmlFor:r,key:r,className:c},(0,a.createElement)(wt,{isActive:l}),(0,a.createElement)("div",{className:"grid space-y-2"},o&&(0,a.createElement)("div",{className:"text-base font-medium text-gray-700"},o),i&&(0,a.createElement)("div",{className:"text-sm text-gray-500"},i)),(0,a.createElement)("input",{type:"radio",name:"label",value:r,id:r,className:"!opacity-0 !w-0 !h-0 !overflow-hidden !absolute !pointer-events-none",disabled:n}))})))}const wt=({isActive:e})=>{const t=p()({"bg-white outline-info":e,"bg-gray-200 outline-transparent":!e},"w-[24px] h-[24px] rounded-full flex items-center justify-center flex-shrink-0 outline outline-3 -outline-offset-3 transition-all"),s=p()({"bg-info":e},"w-[12px] h-[12px] rounded-full background-info transition-all");return(0,a.createElement)("div",{className:t},e&&(0,a.createElement)("div",{className:s}))};function kt({title:e,progress:t,description:s,onCancel:o,hideCancel:n=!1}){const{strings:r}=optimoleDashboardApp;return(0,a.createElement)("div",{className:"bg-gray-50 rounded-md p-4 space-y-4"},(0,a.createElement)("div",{className:"flex gap-3 items-center"},(0,a.createElement)(st,{icon:v,className:"text-info animate-spin -scale-y-100"}),e&&(0,a.createElement)("p",{className:"uppercase text-s font-semibold text-light-black m-0"},e),!n&&(0,a.createElement)("button",{onClick:o,className:"appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-s hover:border-red-500 hover:bg-red-500 hover:text-white cursor-pointer"},r.cancel)),(0,a.createElement)(Le,{value:t}),s&&(0,a.createElement)("p",{className:"text-xs text-gray-500"},s))}const xt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),Ct=window.wp.compose;function St({icon:e,labels:t={},onRequestClose:s=(()=>{}),onConfirm:o=(()=>{}),variant:n="default"}){const r=(0,Ct.useViewportMatch)("small","<"),i=p()({"bg-stale-yellow":"warning"===n,"bg-light-blue":"default"===n},"p-3 rounded-full"),l=p()({"bg-mango-yellow":"warning"===n},"optml\_\_button flex justify-center px-5 py-3 rounded font-bold min-h-40 basis-1/5");return(0,a.createElement)(g.Modal,{\_\_experimentalHideHeader:!0,className:"max-w-xl antialiased",onRequestClose:s,isFullScreen:r},(0,a.createElement)(g.Button,{icon:xt,onClick:s,label:optimoleDashboardApp.strings.csat.close,className:"fixed right-3 top-3 cursor-pointer"}),(0,a.createElement)("div",{className:"flex flex-col items-center"},(0,a.createElement)(g.Icon,{icon:e,size:24,className:i}),(0,a.createElement)("h2",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:t.title}}),(0,a.createElement)("p",{className:"text-center mx-0 my-4 text-gray-700",dangerouslySetInnerHTML:{\_\_html:t.description}}),(0,a.createElement)(g.Button,{variant:"primary",className:l,onClick:o},t.action)))}const At=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M12.5 5L10 19h1.9l2.5-14z"})),Dt=({type:e})=>{const{logs:t}=(0,c.useSelect)((e=>{const{getLogs:t}=e("optimole");return{logs:t()}})),[s,n]=(0,o.useState)(!1),r=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const s=setInterval((()=>{r.current&&(r.current.innerHTML=t[e],r.current.scrollTop=r.current.scrollHeight)}),15e3);return()=>clearInterval(s)}),[]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"w-full flex justify-end text-info my-2"},(0,a.createElement)(g.Button,{variant:"tertiary",className:"py-2 px-0",target:"\_blank",href:`${window.ajaxurl}?action=optml\_fetch\_logs&nonce=${optimoleDashboardApp.nonce}&type=${e}`},optimoleDashboardApp.strings.options\_strings.view\_logs),(0,a.createElement)(g.Icon,{icon:At,className:"fill-info py-2"}),(0,a.createElement)(g.Button,{variant:"tertiary",className:"py-2 px-0",onClick:()=>n(!s)},s?optimoleDashboardApp.strings.options\_strings.hide\_logs:optimoleDashboardApp.strings.options\_strings.show\_logs)),s&&(0,a.createElement)("div",{className:"flex flex-col p-6 bg-light-blue border border-blue-300 rounded-md min-h-[200px] max-h-[200px] overflow-y-scroll",ref:r,dangerouslySetInnerHTML:{\_\_html:t[e]}}))},Lt=({settings:e,canSave:t,setSettings:s,setCanSave:n})=>{const{strings:r,cron\_disabled:i}=optimoleDashboardApp,{conflicts:l,options\_strings:d}=r,m="offload",u="rollback",g="stopOffload",h="stopRollback",{offloadConflicts:b,errorMedia:f,offloadLibraryLink:\_,isLoading:E,loadingSync:x,loadingRollback:C,rollbackLibraryLink:S,queryArgs:A,totalNumberOfImages:D,processedImages:L,offloadFinishNotice:N,offloadLimitReached:I,offloadLimit:T}=(0,c.useSelect)((e=>{const{getOffloadConflicts:t,getErrorMedia:s,getLoadingSync:a,getLoadingRollback:o,getOffloadLibraryLink:n,getRollbackLibraryLink:r,getTotalNumberOfImages:i,getProcessedImages:l,getQueryArgs:c,isLoading:d,getSiteSettings:p,getOffloadLimit:m}=e("optimole");return{offloadConflicts:t(),errorMedia:s(),offloadLibraryLink:n(),isLoading:d(),loadingSync:a(),loadingRollback:o(),rollbackLibraryLink:r(),queryArgs:c(),totalNumberOfImages:i(),processedImages:l(),offloadFinishNotice:p("show\_offload\_finish\_notice"),offloadLimitReached:"enabled"===p("offload\_limit\_reached"),offloadLimit:m()}}),[]),{setErrorMedia:M,setCheckedOffloadConflicts:O,setOffloadConflicts:F,setProcessedImages:j,setOffloadLimitReached:H}=(0,c.useDispatch)("optimole"),[B,z]=(0,o.useState)(null),R="disabled"!==e.offloading\_status,P="disabled"!==e.rollback\_status;(0,o.useEffect)((()=>{A?.optimole\_action&&A?.images&&("offload\_images"===A.optimole\_action&&V(A.images),"rollback\_images"===A.optimole\_action&&$(A.images))}),[]),(0,o.useEffect)((()=>{R&&Ee({action:"offload\_images",refresh:!0}),P&&Ee({action:"rollback\_images",refresh:!0})}),[]);const V=(t=[])=>{const a={...e};a.show\_offload\_finish\_notice="",a.offloading\_status="enabled",s(a),be(a,!1,!0,(()=>{M(!1),j(0),H(!1),Ee({action:"offload\_images",images:t}),n(!1)}))},$=(t=[])=>{O(!1),F([]),ve((s=>{if(0===s.data.length){const s={...e};s.show\_offload\_finish\_notice="",s.rollback\_status="enabled",be(s,!1,!0,(()=>{M(!1),j(0),Ee({action:"rollback\_images",images:t}),n(!1)}))}}))},q=[{title:d.offload\_radio\_option\_rollback\_title,description:d.offload\_radio\_option\_rollback\_desc,value:"rollback"},{title:d.offload\_radio\_option\_offload\_title,description:d.offload\_radio\_option\_offload\_desc,value:"offload"}],Z="enabled"===e.offload\_media?"offload":"rollback",U=x||C;return(0,a.createElement)("div",null,(0,a.createElement)("h1",{className:"text-xl font-bold"},d.enable\_offload\_media\_title),(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:d.enable\_offload\_media\_desc}}),N&&(0,a.createElement)(ot,{title:"offload"===N?d.offloading\_success:d.rollback\_success,type:"primary",onDismiss:()=>{be({show\_offload\_finish\_notice:""},!1,!0)}}),i&&(0,a.createElement)(ot,{type:"error",text:r.cron\_error}),!U&&(0,a.createElement)(yt,{className:p()({"opacity-50 pointer-events-none":E||i}),label:d.offloading\_radio\_legend,options:q,value:Z,onChange:t=>{const a="offload"===t,o={...e};o.offload\_media=a?"enabled":"disabled",s(o),n(!0),z(a?m:u)}}),U&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(kt,{title:x?d.sync\_media\_progress:d.rollback\_media\_progress,progress:Math.round(L/D\*100),onCancel:()=>{x&&z(g),C&&z(h)},description:0===D?d.calculating\_estimated\_time:d.images\_processing}),(0,a.createElement)(Dt,{type:x?"offload":"rollback"})),"offload\_images"===f&&(0,a.createElement)(ot,{type:"error",smallTitle:!0,title:d.sync\_media\_error,text:d.sync\_media\_error\_desc}),"rollback\_images"===f&&(0,a.createElement)(ot,{type:"error",smallTitle:!0,title:d.rollback\_media\_error,text:d.rollback\_media\_error\_desc}),0<b.length&&(0,a.createElement)(ot,{type:"warning",title:d.offload\_conflicts\_part\_1},(0,a.createElement)("div",{className:"list-disc grid gap-3 mt-2"},(0,a.createElement)("ul",{className:"grid gap-1"},b.map((e=>(0,a.createElement)("li",{key:e,className:"font-semibold text-base m-0"},e)))),(0,a.createElement)("p",{className:"m-0 text-sm"},d.offload\_conflicts\_part\_2),(0,a.createElement)("button",{disabled:E,className:p()({"opacity-50 pointer-events-none":E},"justify-self-start font-semibold flex items-center appearance-none border border-info text-info bg-white rounded px-4 py-2 text-sm hover:text-white hover:bg-info cursor-pointer"),onClick:()=>F([])},l.conflict\_close))),!U&&(0,a.createElement)("button",{onClick:e=>{e.preventDefault(),"offload"===Z&&z(m),"rollback"===Z&&z(u)},disabled:E||i,className:p()({"opacity-50 pointer-events-none":E||i},"font-semibold flex items-center gap-2 appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-sm hover:text-white hover:bg-info cursor-pointer")},(0,a.createElement)(st,{icon:v,className:"w-4 h-4"}),(0,a.createElement)("span",null,d.sync\_media)),!U&&I&&(0,a.createElement)(ot,{type:"warning",text:d.offload\_limit\_reached.replace("#offload\_limit#",T)}),B&&(0,a.createElement)(St,{...(G=B,{onRequestClose:()=>z(null),...{[m]:{icon:y,onConfirm:()=>{V(),z(null)},labels:{title:d.offloading\_start\_title,description:d.offloading\_start\_description,action:d.offloading\_start\_action}},[u]:{icon:w,onConfirm:()=>{$(),z(null)},labels:{title:d.rollback\_start\_title,description:d.rollback\_start\_description,action:d.rollback\_start\_action}},[g]:{variant:"warning",icon:k,onConfirm:()=>{z(null);const t=e;t.offloading\_status="disabled",be(t)},labels:{title:d.offloading\_stop\_title,description:d.offloading\_stop\_description,action:d.offloading\_stop\_action}},[h]:{variant:"warning",icon:k,onConfirm:()=>{z(null);const t=e;t.rollback\_status="disabled",be(t)},labels:{title:d.rollback\_stop\_title,description:d.rollback\_stop\_description,action:d.rollback\_stop\_action}}}[G]})}),\_&&(0,a.createElement)("p",{className:"m-0"},d.sync\_media\_link," ",(0,a.createElement)("a",{href:A.url},d.here)),S&&(0,a.createElement)("p",{className:"m-0"},d.rollback\_media\_link," ",(0,a.createElement)("a",{href:A.url},optimoleDashboardApp.strings.options\_strings.here)));var G};function Nt(e){const{user\_data:t,strings:s}=optimoleDashboardApp,{options\_strings:o}=s,{settings:n,setSettings:r,setCanSave:i}=e,l=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}),[]),{isLoading:d}=l,m="disabled"!==n.cloud\_images,u=t.whitelist||[];return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(g.ToggleControl,{label:o.enable\_cloud\_images\_title,help:()=>(0,a.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:o.enable\_cloud\_images\_desc}}),checked:m,disabled:d,className:p()({"is-disabled":d}),onChange:e=>((e,t)=>{i(!0);const s={...n};s.cloud\_images=t?"enabled":"disabled",r(s)})(0,e)}),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),m&&(0,a.createElement)(g.BaseControl,{label:o.cloud\_site\_title,help:o.cloud\_site\_desc},(0,a.createElement)("div",{className:"optml\_\_token\_\_base flex p-6 bg-light-blue border border-blue-300 rounded-md items-center gap-8"},(0,a.createElement)(g.FormTokenField,{value:Object.keys(n.cloud\_sites).filter((e=>"all"!==e&&"false"!==n.cloud\_sites[e])).map((e=>e))||[],suggestions:u,onChange:e=>{i(!0);const t={},s={...n};0===e.length?t.all="true":e.forEach((e=>{t[e]="true"})),Object.keys(s.cloud\_sites).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)||(t[e]="false")})),s.cloud\_sites=t,r(s)},\_\_experimentalExpandOnFocus:!0,\_\_experimentalShowHowTo:!1,\_\_experimentalValidateInput:e=>u.includes(e),className:"optml\_\_token"}))))}const It=({tab:e,setTab:t,canSave:s,setCanSave:n,settings:r,setSettings:i})=>{const{siteSettings:l,isLoading:d,damEnabled:p}=(0,c.useSelect)((e=>{const{getSiteSettings:t,getQueryArgs:s,isLoading:a}=e("optimole"),o=t();return{siteSettings:o,damEnabled:o.cloud\_images,isLoading:a(),queryArgs:s()}}),[]),[m,u]=(0,o.useState)(!1),[h,b]=(0,o.useState)(!1);(0,o.useEffect)((()=>{((e=!0)=>{const{dam\_url:t,strings:s}=window.optimoleDashboardApp,{cloud\_library:a}=s,o=document.querySelector('a[href\*="page=optimole-dam"]');if(!e&&!o)return;if(!e){if(!o)return;return void(o.style.display="none")}if(o)return void(o.style={});const n=document.createElement("li"),r=document.createElement("a");n.appendChild(r),r.href=t,r.innerHTML=a;const i=document.querySelector("#toplevel\_page\_optimole ul");i&&i.insertBefore(n,i.firstChild)})("enabled"===p)}),[p]),(0,o.useEffect)((()=>{const e=localStorage.getItem("optimole\_settings\_visits");3<e||localStorage.setItem("optimole\_settings\_visits",e?parseInt(e)+1:1)}),[e]);const f=()=>{be(r,l.banner\_frontend!==r.banner\_frontend),n(!1)};return(0,a.createElement)("div",{className:"optml-settings flex flex-col sm:flex-row bg-white p-8 border-0 rounded-lg shadow-md gap-8"},(0,a.createElement)(Je,{tab:e,setTab:t,settings:r}),(0,a.createElement)("div",{className:"basis-4/5"},"general"===e&&(0,a.createElement)(nt,{settings:r,setSettings:i,setCanSave:n}),"compression"===e&&(0,a.createElement)(lt,{settings:r,setSettings:i,setCanSave:n,showSample:m,isSampleLoading:h,setIsSampleLoading:b}),"resize"===e&&(0,a.createElement)(ct,{settings:r,setSettings:i,setCanSave:n}),"lazyload"===e&&(0,a.createElement)(dt,{settings:r,setSettings:i,setCanSave:n}),"exclusions"===e&&(0,a.createElement)(Et,{settings:r,setSettings:i,setCanSave:n}),"cloud\_library"===e&&(0,a.createElement)(Nt,{settings:r,canSave:s,setSettings:i,setCanSave:n,onSaveSettings:f}),"offload\_media"===e&&(0,a.createElement)(Lt,{settings:r,canSave:s,setSettings:i,setCanSave:n,onSaveSettings:f}),(0,a.createElement)("div",{className:"flex justify-start items-center gap-5 mt-8"},(0,a.createElement)(g.Button,{variant:"primary",isBusy:d,disabled:!s,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:f},optimoleDashboardApp.strings.options\_strings.save\_changes),"disabled"===r.autoquality&&"compression"===e&&(0,a.createElement)(g.Button,{variant:"default",disabled:d,onClick:()=>{m||(b(!0),\_e({quality:r.quality},(()=>b(!1)))),u(!m)}},optimoleDashboardApp.strings.options\_strings.view\_sample\_image))))},Tt=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),Mt=(0,a.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,a.createElement)(m.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M6.68822 16.625L5.5 17.8145L5.5 5.5L18.5 5.5L18.5 16.625L6.68822 16.625ZM7.31 18.125L19 18.125C19.5523 18.125 20 17.6773 20 17.125L20 5C20 4.44772 19.5523 4 19 4H5C4.44772 4 4 4.44772 4 5V19.5247C4 19.8173 4.16123 20.086 4.41935 20.2237C4.72711 20.3878 5.10601 20.3313 5.35252 20.0845L7.31 18.125ZM16 9.99997H8V8.49997H16V9.99997ZM8 14H13V12.5H8V14Z"})),Ot=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),Ft=[{title:optimoleDashboardApp.strings.help.get\_support\_title,description:optimoleDashboardApp.strings.help.get\_support\_desc,cta:optimoleDashboardApp.strings.help.get\_support\_cta,link:"https://wordpress.org/support/plugin/optimole-wp/",icon:Tt},{title:optimoleDashboardApp.strings.help.feat\_request\_title,description:optimoleDashboardApp.strings.help.feat\_request\_desc,cta:optimoleDashboardApp.strings.help.feat\_request\_cta,link:"https://github.com/Codeinwp/optimole-wp/discussions",icon:Mt},{title:optimoleDashboardApp.strings.help.feedback\_title,description:optimoleDashboardApp.strings.help.feedback\_desc,cta:optimoleDashboardApp.strings.help.feedback\_cta,link:"https://wordpress.org/plugins/optimole-wp/#developers",icon:Ot}],jt=[{title:optimoleDashboardApp.strings.help.account\_title,items:[{label:optimoleDashboardApp.strings.help.account\_item\_one,value:"https://docs.optimole.com/article/1134-how-optimole-counts-the-number-of-visitors"},{label:optimoleDashboardApp.strings.help.account\_item\_two,value:"https://docs.optimole.com/article/1008-what-happens-if-i-exceed-plan-limits"},{label:optimoleDashboardApp.strings.help.account\_item\_three,value:"https://docs.optimole.com/article/1133-visitors-based-plan"}]},{title:optimoleDashboardApp.strings.help.image\_processing\_title,items:[{label:optimoleDashboardApp.strings.help.image\_processing\_item\_one,value:"https://docs.optimole.com/article/1173-how-to-get-started-with-optimole-in-just-3-steps"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_two,value:"https://docs.optimole.com/article/1068-how-optimole-can-serve-webp-images"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_three,value:"https://docs.optimole.com/article/1475-adding-watermarks-to-your-images"}]},{title:optimoleDashboardApp.strings.help.api\_title,items:[{label:optimoleDashboardApp.strings.help.api\_item\_one,value:"https://docs.optimole.com/article/1323-cloud-library-browsing"},{label:optimoleDashboardApp.strings.help.api\_item\_two,value:"https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading"},{label:optimoleDashboardApp.strings.help.api\_item\_three,value:"https://docs.optimole.com/article/1307-custom-integration"}]}],Ht="flex p-6 border-2 border-solid border-grayish-blue rounded-md items-start gap-8 basis-1/3",Bt=()=>(0,a.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},(0,a.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_one\_title),(0,a.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},Ft.map(((e,t)=>(0,a.createElement)("div",{key:t,className:Ht},(0,a.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,a.createElement)(g.Icon,{icon:e.icon,className:"fill-info",size:42}),(0,a.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),(0,a.createElement)("div",{className:"not-italic font-normal text-s text-gray-800"},e.description),(0,a.createElement)(g.ExternalLink,{href:e.link},e.cta)))))),(0,a.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,a.createElement)("div",{className:"flex items-center justify-between"},(0,a.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_two\_title),(0,a.createElement)(g.ExternalLink,{href:"https://docs.optimole.com/"},optimoleDashboardApp.strings.help.section\_two\_sub)),(0,a.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},jt.map(((e,t)=>(0,a.createElement)("div",{key:t,className:Ht},(0,a.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,a.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),e.items.map(((e,t)=>(0,a.createElement)("a",{key:t,href:e.value,target:"\_blank"},e.label))))))))),zt=[optimoleDashboardApp.strings.upgrade.reason\_1,optimoleDashboardApp.strings.upgrade.reason\_2,optimoleDashboardApp.strings.upgrade.reason\_3,optimoleDashboardApp.strings.upgrade.reason\_4],Rt=()=>{const{name:e,domain:t,plan:s}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole"),s=t();let a=s?.cdn\_key+".i.optimole.com";return void 0!==s?.domain&&""!==s?.domain&&(a=s?.domain),{name:s?.display\_name,domain:a,plan:s?.plan}}));return(0,a.createElement)("div",{className:"flex flex-col mt-8 mb-5 p-0 transition-all ease-in-out duration-700 gap-5 basis-3/12"},(0,a.createElement)("div",{className:"bg-white gap-5 flex flex-col text-gray-700 border-0 rounded-lg shadow-md p-8"},(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.logged\_in\_as,value:e,className:"optml\_\_placeholder",disabled:!0}),(0,a.createElement)(g.TextControl,{label:optimoleDashboardApp.strings.private\_cdn\_url,value:t,className:"optml\_\_placeholder",disabled:!0}),(0,a.createElement)("hr",{className:"m-0 border-grayish-blue"}),(0,a.createElement)("p",{className:"font-semibold text-xs text-light-black m-0"},optimoleDashboardApp.strings.looking\_for\_api\_key),(0,a.createElement)("p",{className:"m-0 -mt-3",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.optml\_dashboard}})),"free"===s?(0,a.createElement)("div",{className:"bg-info flex flex-col text-white border-0 rounded-lg shadow-md p-8 bg-promo bg-no-repeat",style:{backgroundImage:`url( ${optimoleDashboardApp.assets\_url}/img/logo2.png )`}},(0,a.createElement)("h3",{className:"mt-0 text-white text-lg"},optimoleDashboardApp.strings.upgrade.title\_long),(0,a.createElement)("ul",null,zt.map(((e,t)=>(0,a.createElement)("li",{key:t,className:"flex items-center gap-2"},(0,a.createElement)(g.Icon,{icon:"yes-alt",className:"text-white"}),(0,a.createElement)("span",{className:"text-white font-normal text-base"},e))))),(0,a.createElement)(g.Button,{variant:"link",className:"optml\_\_button flex w-full justify-center font-bold min-h-40 !no-underline !text-white !bg-opaque-black !rounded",href:optimoleDashboardApp.optimoleHome+"pricing",target:"\_blank"},optimoleDashboardApp.strings.upgrade.cta)):(0,a.createElement)(g.Button,{variant:"default",className:"bg-white flex font-bold border-0 rounded-lg shadow-md p-8 text-sm justify-center",href:(0,S.addQueryArgs)(optimoleDashboardApp.optimoleHome+"contact/",{contact\_name:window.optimoleDashboardApp.user\_data.display\_name,contact\_email:optimoleDashboardApp.user\_data.user\_email,contact\_website:optimoleDashboardApp.home\_url}),target:"\_blank"},optimoleDashboardApp.strings.premium\_support))},Pt=({strings:e,onClose:t})=>(0,a.createElement)("div",{className:"flex justify-between px-8 pt-8"},(0,a.createElement)("p",{className:"text-purple-gray text-sm m-0 py-2"},e.title),(0,a.createElement)(g.Button,{label:e.close,icon:at,onClick:t,className:"text-gray-950"}));window.optimoleCSAT={hasSubmitted:!1,data:{}};const Vt=({id:e,show:t=!1,strings:s={},pages:n=[],onDismiss:r=(()=>{})})=>{const[i,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(0),[p,m]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),[b,f]=(0,o.useState)({});(0,o.useEffect)((()=>{const t=()=>{!window.optimoleCSAT.hasSubmitted&&window.optimoleCSAT.data?.score&&localStorage.setItem(`optimole\_csat\_data\_${e}`,JSON.stringify(window.optimoleCSAT.data))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,o.useEffect)((()=>{t&&!p&&l(t)}),[t]),(0,o.useEffect)((()=>{window.optimoleCSAT={hasSubmitted:u,data:b}}),[u,b]);const \_=(e=!1,t=b)=>{if(r(),u||!t?.score)return m(!0),null;const s={email:optimoleDashboardApp.user\_data.user\_email,product:"Optimole",site:optimoleDashboardApp.home\_url,...t};try{fetch(`https://api.themeisle.com/tracking/csat/${t?.score}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, \*/\*;q=0.1","Cache-Control":"no-cache"},body:JSON.stringify(s)})}catch(e){console.warn(e)}h(!0),d(n.length),e&&(l(!1),m(!0))};if((0,o.useEffect)((()=>{const t=localStorage.getItem(`optimole\_csat\_data\_${e}`);t&&(\_(!0,JSON.parse(t)),localStorage.removeItem(`optimole\_csat\_data\_${e}`))}),[]),!i)return null;if(0===n.length)return null;const v=c<n.length,E=n[c]?.content;return(0,a.createElement)("div",{className:"bg-white fixed left-0 w-auto sm:right-0 sm:left-auto sm:w-full bottom-0 m-12 gap-2 max-w-lg flex flex-col text-gray-700 border-0 rounded-lg shadow-lg z-50"},n[c]&&(0,a.createElement)(a.Fragment,null,n[c]?.showHeader&&(0,a.createElement)(Pt,{onClose:()=>{l(!1),m(!0),\_()},strings:s}),(0,a.createElement)(E,{data:b,changeData:(e,t=!1)=>{f({...b,...e}),t&&d(c+1)},onSubmit:\_})),!v&&(0,a.createElement)("div",{className:"flex flex-col gap-5 p-8 items-center"},(0,a.createElement)(g.Icon,{icon:Xe,size:40,className:"bg-success rounded-full fill-white p-2"}),(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_three),(0,a.createElement)("div",{className:"text-sm text-center"},optimoleDashboardApp.strings.csat.thank\_you),(0,a.createElement)(g.Button,{variant:"primary",onClick:()=>l(!1),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.close)))},$t=window.wp.api;var qt=s.n($t);const Zt=window.wp.i18n,Ut=()=>{const[e,t]=(0,o.useState)(!1),[s,n,r]=(()=>{const[e,t]=(0,o.useState)({}),[s,a]=(0,o.useState)("loading"),n=()=>{qt().loadPromise.then((async()=>{try{const e=new(qt().models.Settings),s=await e.fetch();t(s)}catch(e){a("error")}finally{a("loaded")}}))};return(0,o.useEffect)((()=>{n()}),[]),[t=>e?.[t],(e,t,s=(0,Zt.\_\_)("Settings saved.","textdomain"))=>{a("saving");const o=new(qt().models.Settings)({[e]:t}).save();o.success(((e,t)=>{"success"===t&&a("loaded"),"error"===t&&a("error"),n()})),o.error((e=>{a("error")}))},s]})(),i="loaded"===r&&void 0!==s("optml\_csat")&&JSON.parse(s("optml\_csat")),{hasImages:l,isFirstSite:d}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole");return{hasImages:0<t()?.images\_number,isFirstSite:1===t()?.whitelist?.length}})),p=localStorage.getItem("optimole\_settings\_visits");return(0,o.useEffect)((()=>{t(l&&d&&3<=parseInt(p)&&!1!==i&&!0!==i?.firstImpressions)}),[p,i]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Vt,{id:"first-impressions",show:e,onDismiss:()=>n("optml\_csat",JSON.stringify({...i,firstImpressions:!0})),strings:{title:optimoleDashboardApp.strings.csat.title,close:optimoleDashboardApp.strings.csat.close},pages:[{showHeader:!0,content:e=>(0,a.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_one),(0,a.createElement)("div",{className:"flex gap-5"},[1,2,3,4,5].map((t=>(0,a.createElement)(g.Button,{key:t,onClick:()=>e.changeData({score:t},!0),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},t)))),(0,a.createElement)("div",{className:"flex justify-between"},(0,a.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.low),(0,a.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.high)))},{showHeader:!0,content:e=>(0,a.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,a.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_two),(0,a.createElement)(g.TextareaControl,{label:optimoleDashboardApp.strings.csat.heading\_two,hideLabelFromVision:!0,value:e.data?.feedback,placeholder:optimoleDashboardApp.strings.csat.feedback\_placeholder,onChange:t=>e.changeData({feedback:t})}),(0,a.createElement)("div",{className:"flex justify-end"},(0,a.createElement)("div",{className:"flex gap-2"},(0,a.createElement)(g.Button,{onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.skip),(0,a.createElement)(g.Button,{variant:"primary",onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.submit))))}]}))};var Gt=Object.defineProperty,Kt=(e,t,s)=>(((e,t,s)=>{t in e?Gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const Yt=e=>({ok:!1,error:e});async function Qt(e,t,s,a){const o=new URL(t,e),n=JSON.stringify(a),r=(i=fetch,(...e)=>{try{return{ok:!0,data:i(...e)}}catch(e){return{ok:!1,error:e}}})(o.toString(),{method:s,headers:{"Content-Type":"application/json"},body:n});var i;if(!1===r.ok)return Yt(r.error);const l=await r.data,{data:c}=await l.json();return l.ok?(e=>({ok:!0,data:e}))(c):Yt({code:"network\_error",message:l.statusText,status:l.status,url:o})}class Jt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/actions`,"POST",e)}}class Wt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/displays`,"POST",e)}async update(e,t){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/displays/${e}`,"PUT",t)}}class Xt{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/people`,"POST",{environmentId:this.environmentId,userId:e})}async update(e,t){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/people/${e}`,"POST",t)}}class es{constructor(e,t){this.apiHost=e,this.environmentId=t}async create(e){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/responses`,"POST",e)}async update({responseId:e,finished:t,data:s,ttc:a}){return Qt(this.apiHost,`/api/v1/client/${this.environmentId}/responses/${e}`,"PUT",{finished:t,data:s,ttc:a})}}class ts{constructor(e,t){this.apiHost=e,this.environmentId=t}async uploadFile(e,{allowedFileExtensions:t,surveyId:s}={}){if(!(e instanceof Blob&&e instanceof File))throw new Error("Invalid file type. Expected Blob or File, but received "+typeof e);const a={fileName:e.name,fileType:e.type,allowedFileExtensions:t,surveyId:s},o=await fetch(`${this.apiHost}/api/v1/client/${this.environmentId}/storage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`Upload failed with status: ${o.status}`);const n=await o.json(),{data:r}=n,{signedUrl:i,fileUrl:l,signingData:c,presignedFields:d,updatedFileName:p}=r;let m={};if(c){const{signature:t,timestamp:a,uuid:o}=c;m={"X-File-Type":e.type,"X-File-Name":encodeURIComponent(p),"X-Survey-ID":s??"","X-Signature":t,"X-Timestamp":String(a),"X-UUID":o}}const u=new FormData;d&&Object.keys(d).forEach((e=>{u.append(e,d[e])})),u.append("file",e);const g=await fetch(i,{method:"POST",...c?{headers:m}:{},body:u});if(!g.ok){if(c){const e=await g.json(),t=new Error(e.message);throw t.name="FileTooLargeError",t}const e=await g.text();if(d&&e&&e.includes("EntityTooLarge")){const e=new Error("File size exceeds the size limit for your plan");throw e.name="FileTooLargeError",e}throw new Error(`Upload failed with status: ${g.status}`)}return l}}class ss{constructor(e){const{apiHost:t,environmentId:s}=e;this.response=new es(t,s),this.display=new Wt(t,s),this.action=new Jt(t,s),this.people=new Xt(t,s),this.storage=new ts(t,s)}}class as{constructor(e){this.client=new ss(e)}}class os{constructor(){this.logLevel="error"}static getInstance(){return os.instance||(os.instance=new os),os.instance}configure(e){e&&void 0!==e.logLevel&&(this.logLevel=e.logLevel)}logger(e,t){if("debug"===t&&"debug"!==this.logLevel)return;const s=`🧱 Formbricks - ${(new Date).toISOString()} [${t.toUpperCase()}] - ${e}`;"error"===t?console.error(s):console.log(s)}debug(e){this.logger(e,"debug")}error(e){this.logger(e,"error")}}const ns=e=>({ok:!0,value:e}),rs=e=>({ok:!1,error:e}),is=e=>(...t)=>{try{return{ok:!0,value:e(...t)}}catch(e){return{ok:!1,error:e}}},ls=os.getInstance(),cs=class e{constructor(e){this.customized=!1,e?(this.handleError=e,this.customized=!0):this.handleError=e=>os.getInstance().error(JSON.stringify(e))}static getInstance(){return e.instance||(e.instance=new e),e.instance}static init(t){this.initialized=!0,e.instance=new e(t)}printStatus(){ls.debug("Custom error handler: "+(this.customized?"yes":"no"))}handle(e){console.warn("🧱 Formbricks - Global error: ",e),this.handleError(e)}};cs.initialized=!1;let ds=cs;const ps="formbricks-js";class ms{constructor(){this.config=null;const e=this.loadFromLocalStorage();e.ok&&(this.config=e.value)}static getInstance(){return ms.instance||(ms.instance=new ms),ms.instance}update(e){e&&(this.config={...this.config,...e,status:e.status||"success"},this.saveToLocalStorage())}get(){if(!this.config)throw new Error("config is null, maybe the init function was not called?");return this.config}loadFromLocalStorage(){if("undefined"!=typeof window){const e=localStorage.getItem(ps);if(e){const t=JSON.parse(e);return t.expiresAt&&new Date(t.expiresAt)<=new Date?rs(new Error("Config in local storage has expired")):ns(JSON.parse(e))}}return rs(new Error("No or invalid config in local storage"))}saveToLocalStorage(){return is((()=>localStorage.setItem(ps,JSON.stringify(this.config))))()}resetConfig(){return this.config=null,is((()=>localStorage.removeItem(ps)))()}}const us=(e,t)=>{const s=Math.abs(t.getTime()-e.getTime());return Math.floor(s/864e5)},gs=()=>window.location.search.includes("formbricksDebug=true"),hs=ms.getInstance(),bs=os.getInstance();let fs=null;const \_s=async(e,t=!1)=>{var s;try{const a=await(async({apiHost:e,environmentId:t,userId:s},a)=>{try{const o=`${e}/api/v1/client/${t}/in-app/sync`,n="?version=1.6.5";let r={};if((a||gs())&&(r.cache="no-cache",bs.debug("No cache option set for sync")),!s){const e=o+n,t=await fetch(e,r);if(!t.ok){const s=await t.json();return rs({code:"network\_error",status:t.status,message:"Error syncing with backend",url:e,responseMessage:s.message})}return ns((await t.json()).data)}const i=`${o}/${s}${n}`,l=await fetch(i,r);if(!l.ok){const e=await l.json();return rs({code:"network\_error",status:l.status,message:"Error syncing with backend",url:i,responseMessage:e.message})}const c=await l.json(),{data:d}=c;return ns(d)}catch(e){return rs(e)}})(e,t);if(!0!==(null==a?void 0:a.ok))throw a.error;let o;try{o=hs.get().state}catch(e){}let n={surveys:a.value.surveys,noCodeActionClasses:a.value.noCodeActionClasses,product:a.value.product,attributes:(null==(s=a.value.person)?void 0:s.attributes)||{}};if(e.userId){const e=n.surveys.map((e=>e.name));bs.debug("Fetched "+e.length+" surveys during sync: "+e.join(", "))}else{n={...n,displays:(null==o?void 0:o.displays)||[]},n=vs(n);const e=n.surveys.map((e=>e.name));bs.debug("Fetched "+e.length+" surveys during sync: "+e.join(", "))}hs.update({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId,state:n,expiresAt:new Date((new Date).getTime()+12e4)})}catch(e){throw bs.error(`Error during sync: ${e}`),e}},vs=e=>{const{displays:t,product:s}=e;let{surveys:a}=e;if(!t)return e;let o=a.filter((e=>{if("respondMultiple"===e.displayOption)return!0;if("displayOnce"===e.displayOption)return 0===t.filter((t=>t.surveyId===e.id)).length;if("displayMultiple"===e.displayOption)return 0===t.filter((t=>t.surveyId===e.id&&t.responded)).length;throw Error("Invalid displayOption")}));const n=t.length>0?t[t.length-1]:void 0;return o=o.filter((e=>{if(n){if(null!==e.recontactDays){const s=t.filter((t=>t.surveyId===e.id))[0];return!s||us(new Date,new Date(s.createdAt))>=e.recontactDays}return null===s.recontactDays||us(new Date,new Date(n.createdAt))>=s.recontactDays}return!0})),{...e,surveys:o}},Es=()=>{"undefined"!=typeof window&&null!==fs&&(window.clearInterval(fs),fs=null)},ys=e=>new Promise((t=>setTimeout(t,e)));class ws{constructor(e,t){Kt(this,"queue",[]),Kt(this,"config"),Kt(this,"surveyState"),Kt(this,"isRequestInProgress",!1),Kt(this,"api"),this.config=e,this.surveyState=t,this.api=new as({apiHost:e.apiHost,environmentId:e.environmentId})}add(e){this.surveyState.accumulateResponse(e),this.config.setSurveyState&&this.config.setSurveyState(this.surveyState),this.queue.push(e),this.processQueue()}async processQueue(){if(this.isRequestInProgress)return;if(0===this.queue.length)return;this.isRequestInProgress=!0;const e=this.queue[0];let t=0;for(;t<this.config.retryAttempts;){if(await this.sendResponse(e)){this.queue.shift();break}console.error("Formbricks: Failed to send response. Retrying...",t),await ys(1e3),t++}t>=this.config.retryAttempts?(console.error("Failed to send response after 2 attempts."),this.config.onResponseSendingFailed&&this.config.onResponseSendingFailed(e),this.isRequestInProgress=!1):(e.finished&&this.config.onResponseSendingFinished&&this.config.onResponseSendingFinished(),this.isRequestInProgress=!1,this.processQueue())}async sendResponse(e){try{if(null!==this.surveyState.responseId)await this.api.client.response.update({...e,responseId:this.surveyState.responseId});else{const t=await this.api.client.response.create({...e,surveyId:this.surveyState.surveyId,userId:this.surveyState.userId||null,singleUseId:this.surveyState.singleUseId||null});if(!t.ok)throw new Error("Could not create response");if(this.surveyState.displayId)try{await this.api.client.display.update(this.surveyState.displayId,{responseId:t.data.id})}catch(e){console.error("Failed to update display, proceeding with the response.",e)}this.surveyState.updateResponseId(t.data.id),this.config.setSurveyState&&this.config.setSurveyState(this.surveyState)}return!0}catch(e){return console.error(e),!1}}updateSurveyState(e){this.surveyState=e}}class ks{constructor(e,t,s,a){Kt(this,"responseId",null),Kt(this,"displayId",null),Kt(this,"userId",null),Kt(this,"surveyId"),Kt(this,"responseAcc",{finished:!1,data:{},ttc:{}}),Kt(this,"singleUseId"),this.surveyId=e,this.userId=a??null,this.singleUseId=t??null,this.responseId=s??null}setSurveyId(e){this.surveyId=e,this.clear()}copy(){const e=new ks(this.surveyId,this.singleUseId??void 0,this.responseId??void 0,this.userId??void 0);return e.responseId=this.responseId,e.responseAcc=this.responseAcc,e}updateResponseId(e){this.responseId=e}updateDisplayId(e){this.displayId=e}updateUserId(e){this.userId=e}accumulateResponse(e){this.responseAcc={finished:e.finished,ttc:e.ttc,data:{...this.responseAcc.data,...e.data}}}isResponseFinished(){return this.responseAcc.finished}clear(){this.responseId=null,this.responseAcc={finished:!1,data:{},ttc:{}}}}const xs=ks;let Cs=!1,Ss=async function(e){if(e.clientY<=0){const e=await \_a("Exit Intent (Desktop)");if(!0!==e.ok)return rs(e.error)}};const As=()=>{Cs&&(document.removeEventListener("mouseleave",Ss),Cs=!1)};let Ds=!1,Ls=!1,Ns=async()=>{const e=window.scrollY,t=window.innerHeight,s=document.documentElement.scrollHeight;if(0===e&&(Ls=!1),!Ls&&e/(s-t)>=.5){Ls=!0;const e=await \_a("50% Scroll");if(!0!==e.ok)return rs(e.error)}};const Is=()=>{Ds&&(window.removeEventListener("scroll",Ns),Ds=!1)},Ts=ms.getInstance(),Ms=os.getInstance(),Os=ds.getInstance(),Fs=async()=>{var e;Ms.debug(`Checking page url: ${window.location.href}`);const{state:t}=Ts.get(),{noCodeActionClasses:s=[],surveys:a=[]}=t??{},o=s.filter((e=>{const{innerHtml:t,cssSelector:s,pageUrl:a}=e.noCodeConfig||{};return a&&!t&&!s})),n=a.filter((e=>{var t;const{pageUrl:s,cssSelector:a,innerHtml:o}=(null==(t=e.inlineTriggers)?void 0:t.noCodeConfig)||{};return s&&!a&&!o}));if(o.length>0)for(const t of o){if(!(null==(e=t.noCodeConfig)?void 0:e.pageUrl))continue;const{noCodeConfig:{pageUrl:s}}=t,a=Rs(window.location.href,s.value,s.rule);if(!0!==a.ok)return rs(a.error);if(!1===a.value)continue;const o=await \_a(t.name);if(!0!==o.ok)return rs(o.error)}return n.length>0&&n.forEach((e=>{const{noCodeConfig:t}=e.inlineTriggers??{},{pageUrl:s}=t??{};if(s){const t=Rs(window.location.href,s.value,s.rule);if(!0!==t.ok)return rs(t.error);if(!1===t.value)return;da(e)}})),{ok:!0,value:void 0}};let js=!1;const Hs=()=>Fs(),Bs=["hashchange","popstate","pushstate","replacestate","load"],zs=()=>{"undefined"!=typeof window&&js&&(Bs.forEach((e=>window.removeEventListener(e,Hs))),js=!1)};function Rs(e,t,s){switch(s){case"exactMatch":return ns(e===t);case"contains":return ns(e.includes(t));case"startsWith":return ns(e.startsWith(t));case"endsWith":return ns(e.endsWith(t));case"notMatch":return ns(e!==t);case"notContains":return ns(!e.includes(t));default:return rs({code:"invalid\_match\_type",message:"Invalid match type"})}}const Ps=(e,t)=>{var s,a,o,n,r,i,l,c;const d=null==(a=null==(s=t.noCodeConfig)?void 0:s.innerHtml)?void 0:a.value,p=null==(n=null==(o=t.noCodeConfig)?void 0:o.cssSelector)?void 0:n.value,m=null==(i=null==(r=t.noCodeConfig)?void 0:r.pageUrl)?void 0:i.value,u=null==(c=null==(l=t.noCodeConfig)?void 0:l.pageUrl)?void 0:c.rule;if(!d&&!p&&!m)return!1;if(d&&e.innerHTML!==d)return!1;if(p){const t=p.split(/\s\*(?=[.#])/);for(let s of t)if(!e.matches(s))return!1}if(m&&u){const e=Rs(window.location.href,m,u);if(!e.ok||!e.value)return!1}return!0};let Vs=!1;const $s=e=>(e=>{const{state:t}=Ts.get();if(!t)return;const{noCodeActionClasses:s}=t;if(!s)return;const a=e.target;s.forEach((e=>{Ps(a,e)&&\_a(e.name).then((e=>{var t,s;s=e=>{Os.handle(e)},!0===(t=e).ok?t.value:s(t.error)}))}));const o=t.surveys;o&&0!==o.length&&o.forEach((e=>{const{inlineTriggers:t}=e;t&&Ps(a,t)&&da(e)}))})(e),qs=()=>{Vs&&(document.removeEventListener("click",$s),Vs=!1)};let Zs=!1;const Us=ms.getInstance(),Gs=os.getInstance(),Ks=ms.getInstance(),Ys=os.getInstance();let Qs=!1;const Js=e=>{Qs=e},Ws=async e=>{if(gs()&&Ys.configure({logLevel:"debug"}),Qs)return Ys.debug("Already initialized, skipping initialization."),{ok:!0,value:void 0};let t;try{t=Ks.get(),Ys.debug("Found existing configuration.")}catch(e){Ys.debug("No existing configuration found.")}if("error"===(null==t?void 0:t.status)){if(Ys.debug("Formbricks was set to an error state."),(null==t?void 0:t.expiresAt)&&new Date(t.expiresAt)>new Date)return Ys.debug("Error state is not expired, skipping initialization"),{ok:!0,value:void 0};Ys.debug("Error state is expired. Continue with initialization.")}if(ds.getInstance().printStatus(),Ys.debug("Start initialize"),!e.environmentId)return Ys.debug("No environmentId provided"),rs({code:"missing\_field",field:"environmentId"});if(!e.apiHost)return Ys.debug("No apiHost provided"),rs({code:"missing\_field",field:"apiHost"});if(Ys.debug("Adding widget container to DOM"),ma(),!e.userId&&e.attributes)return Ys.error("No userId provided but attributes. Cannot update attributes without userId."),rs({code:"missing\_field",field:"userId"});let s=null;if(e.userId&&e.attributes){const t=await(async(e,t,s,a)=>{var o,n;if(!s)return rs({code:"missing\_person",message:"Unable to update attribute. User identification deactivated. No userId set."});const r={...a};try{const e=null==(n=null==(o=Us.get())?void 0:o.state)?void 0:n.attributes;if(e)for(const[t,s]of Object.entries(e))r[t]===s&&delete r[t]}catch(e){Gs.debug("config not set; sending all attributes to backend")}if(0===Object.keys(r).length)return Gs.debug("No attributes to update. Skipping update."),ns(r);Gs.debug("Updating attributes: "+JSON.stringify(r));const i={attributes:r},l=new as({apiHost:e,environmentId:t}),c=await l.client.people.update(s,i);return c.ok?ns(r):rs({code:"network\_error",status:500,message:`Error updating person with userId ${s}`,url:`${e}/api/v1/client/${t}/people/${s}`,responseMessage:c.error.message})})(e.apiHost,e.environmentId,e.userId,e.attributes);if(!0!==t.ok)return rs(t.error);s=t.value}if(t&&t.state&&t.environmentId===e.environmentId&&t.apiHost===e.apiHost&&t.userId===e.userId&&t.expiresAt)if(Ys.debug("Configuration fits init parameters."),t.expiresAt<new Date){Ys.debug("Configuration expired.");try{await \_s({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId})}catch(e){ta()}}else Ys.debug("Configuration not expired. Extending expiration."),Ks.update(t);else{Ys.debug("No valid configuration found or it has been expired. Resetting config and creating new one."),Ks.resetConfig(),Ys.debug("Syncing.");try{await \_s({apiHost:e.apiHost,environmentId:e.environmentId,userId:e.userId})}catch(e){Xs()}await \_a("New Session")}return s&&Object.keys(s).length>0&&Ks.update({environmentId:Ks.get().environmentId,apiHost:Ks.get().apiHost,userId:Ks.get().userId,state:{...Ks.get().state,attributes:{...Ks.get().state.attributes,...e.attributes}},expiresAt:Ks.get().expiresAt}),Ys.debug("Adding event listeners"),"undefined"!=typeof window&&null===fs&&(fs=window.setInterval((async()=>{try{if(hs.get().expiresAt&&new Date(hs.get().expiresAt)>=new Date)return;bs.debug("Config has expired. Starting sync."),await \_s({apiHost:hs.get().apiHost,environmentId:hs.get().environmentId,userId:hs.get().userId})}catch(e){bs.error(`Error during expiry check: ${e}`),bs.debug("Extending config and try again later.");const t=hs.get();hs.update(t)}}),3e4)),"undefined"==typeof window||js||(Bs.forEach((e=>window.addEventListener(e,Hs))),js=!0),"undefined"==typeof window||Vs||(document.addEventListener("click",$s),Vs=!0),"undefined"==typeof document||Cs||(document.querySelector("body").addEventListener("mouseleave",Ss),Cs=!0),"undefined"==typeof window||Ds||(window.addEventListener("load",(()=>{window.addEventListener("scroll",Ns)})),Ds=!0),Zs||(window.addEventListener("beforeunload",(()=>{Es(),zs(),qs(),As(),Is()})),Zs=!0),Js(!0),Ys.debug("Initialized"),Fs(),{ok:!0,value:void 0}},Xs=()=>{const e={status:"error",expiresAt:new Date((new Date).getTime()+6e5)};throw is((()=>localStorage.setItem(ps,JSON.stringify(e))))(),new Error("Could not initialize formbricks")},ea=()=>{Ys.debug("Deinitializing"),ua(),ca(!1),Es(),zs(),qs(),As(),Is(),Zs&&(window.removeEventListener("beforeunload",(()=>{Es(),zs(),qs(),As(),Is()})),Zs=!1),Js(!1)},ta=()=>{Ys.debug("Putting formbricks in error state"),Ks.update({...Ks.get(),status:"error",expiresAt:new Date((new Date).getTime()+6e5)}),ea()},sa="formbricks-web-container",aa=ms.getInstance(),oa=os.getInstance(),na=ds.getInstance();let ra=!1,ia=e=>{},la=e=>{};const ca=e=>{ra=e},da=async e=>{if(ra)return void oa.debug("A survey is already running. Skipping.");ca(!0),e.delay&&oa.debug(`Delaying survey by ${e.delay} seconds.`);const t=aa.get().state.product,s=new xs(e.id,null,null,aa.get().userId),a=new ws({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId,retryAttempts:2,onResponseSendingFailed:()=>{ia(!0)},onResponseSendingFinished:()=>{la(!0)}},s),o=e.productOverwrites??{},n=o.brandColor??t.brandColor,r=o.highlightBorderColor??t.highlightBorderColor,i=o.clickOutsideClose??t.clickOutsideClose,l=o.darkOverlay??t.darkOverlay,c=o.placement??t.placement,d=t.inAppSurveyBranding,p=await ga();setTimeout((()=>{p.renderSurveyModal({survey:e,brandColor:n,isBrandingEnabled:d,clickOutside:i,darkOverlay:l,highlightBorderColor:r,placement:c,getSetIsError:e=>{ia=e},getSetIsResponseSendingFinished:e=>{la=e},onDisplay:async()=>{const{userId:t}=aa.get();if(!t){const t={createdAt:new Date,surveyId:e.id,responded:!1},s=aa.get().state.displays,a=s?[...s,t]:[t],o=aa.get();let n=vs({...o.state,displays:a});aa.update({...o,state:n})}const o=new as({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId}),n=await o.client.display.create({surveyId:e.id,userId:t});if(!n.ok)throw new Error("Could not create display");const{id:r}=n.data;s.updateDisplayId(r),a.updateSurveyState(s)},onResponse:e=>{const{userId:t}=aa.get();if(!t){const e=aa.get().state.displays,t=e&&e[e.length-1];if(!t)throw new Error("No lastDisplay found");if(!t.responded){t.responded=!0;const s=aa.get();let a=vs({...s.state,displays:e});aa.update({...s,state:a})}}t&&s.updateUserId(t),a.updateSurveyState(s),a.add({data:e.data,ttc:e.ttc,finished:e.finished})},onClose:pa,onFileUpload:async(e,t)=>{const s=new as({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId});return await s.client.storage.uploadFile(e,t)},onRetry:()=>{ia(!1),a.processQueue()}})}),1e3\*e.delay)},pa=async()=>{if(ua(),ma(),!aa.get().userId){const e=aa.get().state,t=vs(e);return aa.update({...aa.get(),state:t}),void ca(!1)}try{await \_s({apiHost:aa.get().apiHost,environmentId:aa.get().environmentId,userId:aa.get().userId},!0),ca(!1)}catch(e){na.handle(e),ta()}},ma=()=>{const e=document.createElement("div");e.id=sa,document.body.appendChild(e)},ua=()=>{var e;null==(e=document.getElementById(sa))||e.remove()},ga=()=>new Promise(((e,t)=>{if(window.formbricksSurveys)e(window.formbricksSurveys);else{const s=document.createElement("script");s.src="https://unpkg.com/@formbricks/surveys@~1.6.3/dist/index.umd.js",s.async=!0,s.onload=()=>e(window.formbricksSurveys),s.onerror=e=>{console.error("Failed to load Formbricks Surveys library:",e),t(e)},document.head.appendChild(s)}})),ha=os.getInstance(),ba=ms.getInstance(),fa=["Exit Intent (Desktop)","50% Scroll"],\_a=async e=>{var t;const{userId:s,state:{surveys:a=[]}}=ba.get();a.forEach((async t=>{const{inlineTriggers:s}=t,{codeConfig:a}=s??{};e!==(null==a?void 0:a.identifier)||await da(t)}));const o={environmentId:ba.get().environmentId,userId:s,name:e};if(s&&!fa.includes(e)){ha.debug(`Sending action "${e}" to backend`);const t=new as({apiHost:ba.get().apiHost,environmentId:ba.get().environmentId}),a=await t.client.action.create({...o,userId:s});if(!a.ok)return rs({code:"network\_error",message:`Error tracking action ${e}`,status:500,url:`${ba.get().apiHost}/api/v1/client/${ba.get().environmentId}/actions`,responseMessage:a.error.message});gs()&&await \_s({environmentId:ba.get().environmentId,apiHost:ba.get().apiHost,userId:s},!0)}ha.debug(`Formbricks: Action "${e}" tracked`);const n=null==(t=ba.get().state)?void 0:t.surveys;return n&&n.length>0?await va(e,n):ha.debug("No active surveys to display"),{ok:!0,value:void 0}},va=async(e,t)=>{for(const a of t)if(!a.displayPercentage||(s=a.displayPercentage,Math.floor(100\*Math.random())+1<=s)){for(const t of a.triggers)if(t===e)return ha.debug(`Formbricks: survey ${a.id} triggered by action "${e}"`),void await da(a)}else ha.debug("Survey display skipped based on displayPercentage.");var s},Ea=e=>async(...t)=>{try{return{ok:!0,data:await e(...t)}}catch(e){return{ok:!1,error:e}}};os.getInstance().debug("Create command queue");const ya=new class{constructor(){this.queue=[],this.running=!1,this.resolvePromise=null,this.commandPromise=null}add(e=!0,t,...s){this.queue.push({command:t,checkInitialized:e,commandArgs:s}),this.running||(this.commandPromise=new Promise((e=>{this.resolvePromise=e,this.run()})))}async wait(){this.running&&await this.commandPromise}async run(){for(this.running=!0;this.queue.length>0;){const e=ds.getInstance(),t=this.queue.shift();if(!t)continue;if(t.checkInitialized){const t=(Ys.debug("Check if initialized"),Qs&&ds.initialized?{ok:!0,value:void 0}:rs({code:"not\_initialized",message:"Formbricks not initialized. Call initialize() first."}));if(t&&!0!==t.ok){e.handle(t.error);continue}}const s=async()=>await(null==t?void 0:t.command.apply(null,null==t?void 0:t.commandArgs)),a=await Ea(s)();a&&(a.ok&&a.data&&!a.data.ok&&e.handle(a.data.error),!0!==a.ok&&e.handle(a.error))}this.running=!1,this.resolvePromise&&(this.resolvePromise(),this.resolvePromise=null,this.commandPromise=null)}};function wa(e,t=1){const s=Math.round(e/t);return 0===s||1===s?0:1<s&&8>s?7:8<=s&&31>s?30:30<s&&90>s?90:90<s?91:void 0}"undefined"!=typeof window&&optimoleDashboardApp.user\_data.plan&&(async e=>{ds.init(e.errorHandler),ya.add(!1,Ws,e),await ya.wait()})({environmentId:"clo8wxwzj44orpm0gjchurujm",apiHost:"https://app.formbricks.com",userId:"optml\_"+optimoleDashboardApp.user\_data.id,attributes:{plan:optimoleDashboardApp.user\_data.plan,status:optimoleDashboardApp.user\_data.status,language:optimoleDashboardApp.language,cname\_assigned:optimoleDashboardApp.user\_data.is\_cname\_assigned||"no",connected\_websites:optimoleDashboardApp.user\_data.whitelist.length,traffic:wa(optimoleDashboardApp.user\_data.traffic,500),images\_number:wa(optimoleDashboardApp.user\_data.images\_number,100),days\_since\_install:wa(optimoleDashboardApp.days\_since\_install)}});const ka=({tab:e,setTab:t})=>{const{isConnected:s,hasApplication:n,hasConflicts:r,siteSettings:i,extraVisits:l}=(0,c.useSelect)((e=>{const{isConnected:t,hasApplication:s,getConflicts:a,getSiteSettings:o}=e("optimole"),n=a(),r=o();return{isConnected:t(),hasApplication:s(),hasConflicts:0<n.count||0,siteSettings:r,extraVisits:r.banner\_frontend}})),{setQueryArgs:d}=(0,c.useDispatch)("optimole"),[p,m]=(0,o.useState)(!1),[u,g]=(0,o.useState)("general"),[h,b]=(0,o.useState)(!1),[f,\_]=(0,o.useState)(i);return(0,o.useEffect)((()=>{const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries());let a=[];if(Object.prototype.hasOwnProperty.call(s,"optimole\_action")){for(let e=0;20>e;e++)Object.prototype.hasOwnProperty.call(s,e)&&(isNaN(s[e])||(a[e]=parseInt(s[e],10)));s.images=a,s.url=window.location.href.split("?")[0]+(Object.prototype.hasOwnProperty.call(s,"paged")?"?paged="+s.paged:""),d(s),t("settings"),g("offload\_media")}}),[]),(0,o.useEffect)((()=>{s&&n&&(T(!0),C()({path:optimoleDashboardApp.routes.poll\_conflicts,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{T(!1),e&&P(e.data)})))}),[]),(0,o.useEffect)((()=>{r&&m(!0)}),[r]),(0,o.useEffect)((()=>{\_({...f,banner\_frontend:l})}),[l]),(0,o.useEffect)((()=>{window.onbeforeunload=h?()=>!0:null}),[h]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"optml-connected max-w-screen-xl flex flex-col lg:flex-row mx-auto gap-5"},(0,a.createElement)("div",{className:"flex flex-col justify-between mt-8 mb-5 p-0 transition-all ease-in-out duration-700 relative text-gray-700 basis-9/12"},"dashboard"===e&&(0,a.createElement)($e,null),"conflicts"===e&&p&&(0,a.createElement)(Ze,null),"settings"===e&&(0,a.createElement)(It,{tab:u,setTab:g,canSave:h,setCanSave:b,settings:f,setSettings:\_}),"help"===e&&(0,a.createElement)(Bt,null)),(0,a.createElement)(Rt,null)),(0,a.createElement)(Ut,null))},xa=[{label:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.version,href:optimoleDashboardApp.optimoleHome},{label:optimoleDashboardApp.strings.terms\_menu,href:optimoleDashboardApp.optimoleHome+"terms/"},{label:optimoleDashboardApp.strings.privacy\_menu,href:optimoleDashboardApp.optimoleHome+"privacy-policy/"},{label:optimoleDashboardApp.strings.testdrive\_menu,href:optimoleDashboardApp.optimoleHome+"test-drive?url="+optimoleDashboardApp.home\_url}],Ca=()=>(0,a.createElement)("footer",{className:"max-w-screen-xl gap-3 md:gap-0 mx-auto my-5 flex justify-between text-base flex-col md:flex-row"},(0,a.createElement)("div",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_3}}),(0,a.createElement)("nav",{className:"flex gap-0 sm:gap-3 flex-wrap md:flex-nowrap"},xa.map(((e,t)=>(0,a.createElement)(g.ExternalLink,{key:t,href:e.href,className:"basis-1/2 sm:basis-auto"},e.label))))),Sa=window.lodash;function Aa(){const e=(0,c.useSelect)((e=>e(A.store).getNotices()),[]),{removeNotice:t}=(0,c.useDispatch)(A.store),s=(0,Sa.filter)(e,{type:"snackbar"});return(0,a.createElement)(g.SnackbarList,{notices:s,className:"px-2 bottom-4 fixed",onRemove:t})}(0,o.render)((0,a.createElement)((()=>{const e=window.location.hash.replace("#","");let t=["dashboard","settings","help"].includes(e)?e:"dashboard";const[s,n]=(0,o.useState)(t),r=e=>{e.preventDefault(),n("settings")},i=e=>{e.preventDefault(),n("dashboard")},{showDisconnect:l,isConnected:d,hasApplication:p,hasDashboardLoaded:m}=(0,c.useSelect)((e=>{const{showDisconnect:t,isConnected:s,hasApplication:a,hasDashboardLoaded:o}=e("optimole");return{showDisconnect:t(),isConnected:s(),hasApplication:a(),hasDashboardLoaded:o()}}));return(0,o.useEffect)((()=>{d&&(window.location.hash=`#${s}`,D.forEach((e=>{const t=document.querySelector(`a[href="${e.href}"]`);if(!t)return;const s=t.parentNode;if(e.hash&&e.hash===window.location.hash)return t.classList.add("current"),void s.classList.add("current");t.classList.remove("current"),s.classList.remove("current")})))}),[s]),(0,o.useEffect)((()=>{if(!d)return;const e=document.querySelector('a[href\*="page=optimole"]'),t=document.querySelector('a[href\*="page=optimole#settings"]');return e&&t?(e.addEventListener("click",i),t.addEventListener("click",r),()=>{e&&t&&(e.removeEventListener("click",i),t.removeEventListener("click",r))}):void 0}),[]),(0,a.createElement)("div",{className:"antialiased"},(0,a.createElement)(we,{tab:s,setTab:n}),!(d&&p)&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(De,null),(0,a.createElement)(Ca,null)),d&&p&&!m&&(0,a.createElement)(Ie,null),d&&l&&(0,a.createElement)(ke,null),d&&p&&m&&(0,a.createElement)(ka,{tab:s,setTab:n}),(0,a.createElement)(Aa,null))}),null),document.getElementById("optimole-app"))},184:(e,t)=>{var s;!function(){"use strict";var a={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var s=arguments[t];if(s){var n=typeof s;if("string"===n||"number"===n)e.push(s);else if(Array.isArray(s)){if(s.length){var r=o.apply(null,s);r&&e.push(r)}}else if("object"===n){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){e.push(s.toString());continue}for(var i in s)a.call(s,i)&&s[i]&&e.push(i)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(s=function(){return o}.apply(t,[]))||(e.exports=s)}()},864:(e,t,s)=>{(()=>{"use strict";var t={n:e=>{var s=e&&e.\_\_esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},a={};t.r(a),t.d(a,{default:()=>c});const o=s(196);var n=t.n(o);function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c=e=>{const{aspectRatio:t="taller",handle:s=null,handleSize:a=40,hover:r=!1,leftImage:l,leftImageAlt:c="",leftImageCss:d={},leftImageLabel:p=null,onSliderPositionChange:m=(()=>{}),rightImage:u,rightImageAlt:g="",rightImageCss:h={},rightImageLabel:b=null,skeleton:f=null,sliderLineColor:\_="#ffffff",sliderLineWidth:v=2,sliderPositionPercentage:E=.5,vertical:y=!1}=e,w=!y,[k,x]=(0,o.useState)(E),[C,S]=(0,o.useState)(0),[A,D]=(0,o.useState)(0),[L,N]=(0,o.useState)(!1),[I,T]=(0,o.useState)(!1),[M,O]=(0,o.useState)(!1),F=(0,o.useRef)(null),j=(0,o.useRef)(null),H=(0,o.useRef)(null);(0,o.useEffect)((()=>{const e=F.current,t=new ResizeObserver((e=>{let[t,...s]=e;const a=t.target.getBoundingClientRect().width;S(a)}));return t.observe(e),()=>t.disconnect()}),[]),(0,o.useEffect)((()=>(H.current.complete&&N(!0),()=>{N(!1)})),[l]),(0,o.useEffect)((()=>(j.current.complete&&T(!0),()=>{T(!1)})),[u]);const B=I&&L;(0,o.useEffect)((()=>{const e=e=>{const t=e||window.event,s=t.touches?t.touches[0].pageX:t.pageX,a=t.touches?t.touches[0].pageY:t.pageY,o=s-window.pageXOffset,n=a-window.pageYOffset,r=j.current.getBoundingClientRect();let i=w?o-r.left:n-r.top;const l=0+v/2,c=w?C-v/2:A-v/2;i<l&&(i=l),i>c&&(i=c),x(w?i/C:i/A),m&&m(w?i/C:i/A)},s=t=>{O(!0),"touches"in t||t.preventDefault(),e(t),window.addEventListener("mousemove",e),window.addEventListener("touchmove",e)},a=()=>{O(!1),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)},o=F.current;if(B){o.addEventListener("touchstart",s),window.addEventListener("touchend",a),r?(o.addEventListener("mousemove",e),o.addEventListener("mouseleave",a)):(o.addEventListener("mousedown",s),window.addEventListener("mouseup",a));const n=H.current.naturalHeight/H.current.naturalWidth,i=j.current.naturalHeight/j.current.naturalWidth,l="taller"===t?Math.max(n,i):Math.min(n,i);D(C\*l)}return()=>{o.removeEventListener("touchstart",s),window.removeEventListener("touchend",a),o.removeEventListener("mousemove",e),o.removeEventListener("mouseleave",a),o.removeEventListener("mousedown",s),window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}}),[B,t,A,C,w,r,v,y]);const z={container:{boxSizing:"border-box",position:"relative",width:"100%",height:`${A}px`,overflow:"hidden"},rightImage:i({clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},h),leftImage:i({clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},d),slider:{alignItems:"center",cursor:!r&&w?"ew-resize":!r&&!w&&"ns-resize",display:"flex",flexDirection:w?"column":"row",height:w?"100%":`${a}px`,justifyContent:"center",left:w?C\*k-a/2+"px":0,position:"absolute",top:w?0:A\*k-a/2+"px",width:w?`${a}px`:"100%"},line:{background:\_,boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",flex:"0 1 auto",height:w?"100%":`${v}px`,width:w?`${v}px`:"100%"},handleCustom:{alignItems:"center",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:"auto",justifyContent:"center",width:"auto"},handleDefault:{alignItems:"center",border:`${v}px solid ${\_}`,borderRadius:"100%",boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:`${a}px`,justifyContent:"center",width:`${a}px`,transform:w?"none":"rotate(90deg)"},leftArrow:{border:`inset ${.15\*a}px rgba(0,0,0,0)`,borderRight:`${.15\*a}px solid ${\_}`,height:"0px",marginLeft:`-${.25\*a}px`,marginRight:.25\*a+"px",width:"0px"},rightArrow:{border:`inset ${.15\*a}px rgba(0,0,0,0)`,borderLeft:`${.15\*a}px solid ${\_}`,height:"0px",marginRight:`-${.25\*a}px`,width:"0px"},leftLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",left:w?"5%":"50%",opacity:M?0:1,padding:"10px 20px",position:"absolute",top:w?"50%":"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},rightLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",opacity:M?0:1,padding:"10px 20px",position:"absolute",left:w?null:"50%",right:w?"5%":null,top:w?"50%":null,bottom:w?null:"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},leftLabelContainer:{clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,height:"100%",position:"absolute",width:"100%"},rightLabelContainer:{clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,height:"100%",position:"absolute",width:"100%"}};return n().createElement(n().Fragment,null,f&&!B&&n().createElement("div",{style:i({},z.container)},f),n().createElement("div",{style:i(i({},z.container),{},{display:B?"block":"none"}),ref:F,"data-testid":"container"},n().createElement("img",{onLoad:()=>T(!0),alt:g,"data-testid":"right-image",ref:j,src:u,style:z.rightImage}),n().createElement("img",{onLoad:()=>N(!0),alt:c,"data-testid":"left-image",ref:H,src:l,style:z.leftImage}),n().createElement("div",{style:z.slider},n().createElement("div",{style:z.line}),s?n().createElement("div",{style:z.handleCustom},s):n().createElement("div",{style:z.handleDefault},n().createElement("div",{style:z.leftArrow}),n().createElement("div",{style:z.rightArrow})),n().createElement("div",{style:z.line})),p&&n().createElement("div",{style:z.leftLabelContainer},n().createElement("div",{style:z.leftLabel},p)),b&&n().createElement("div",{style:z.rightLabelContainer},n().createElement("div",{style:z.rightLabel},b))))};e.exports=a})()},196:e=>{"use strict";e.exports=window.React}},s={};function a(e){var o=s[e];if(void 0!==o)return o.exports;var n=s[e]={exports:{}};return t[e](n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,s,o,n)=>{if(!s){var r=1/0;for(d=0;d<e.length;d++){for(var[s,o,n]=e[d],i=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(i=!1,n<r&&(r=n));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,o,n]},a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var o,n,[r,i,l]=s,c=0;if(r.some((t=>0!==e[t]))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(l)var d=l(a)}for(t&&t(s);c<r.length;c++)n=r[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=globalThis.webpackChunkoptimole\_wp=globalThis.webpackChunkoptimole\_wp||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var o=a.O(void 0,[431],(()=>a(646)));o=a.O(o~~)})(); |
  |  | 1 | (()=>{var e,t={976:(e,t,a)=>{"use strict";var o=a(196);const s=window.wp.element,l={setAutoConnect:e=>({type:"SET\_AUTO\_CONNECT",autoConnect:e}),setAPIKey:e=>({type:"SET\_API\_KEY",apiKey:e}),setAvailableApps:e=>({type:"SET\_AVAILABLE\_APPS",availableApps:e}),setIsConnected:e=>({type:"SET\_IS\_CONNECTED",isConnected:e}),setIsConnecting:e=>({type:"SET\_IS\_CONNECTING",isConnecting:e}),setIsLoading:e=>({type:"SET\_IS\_LOADING",isLoading:e}),sethasDashboardLoaded:e=>({type:"SET\_HAS\_DASHBOARD\_LOADED",hasDashboardLoaded:e}),setHasRestError:e=>({type:"SET\_HAS\_REST\_ERROR",hasRestError:e}),setHasValidKey:e=>({type:"SET\_HAS\_VALID\_KEY",hasValidKey:e}),setHasApplication:e=>({type:"SET\_HAS\_APPLICATION",hasApplication:e}),setUserData:e=>({type:"SET\_USER\_DATA",data:e}),setUserStatus:e=>({type:"SET\_USER\_STATUS",status:e}),setShowDisconnect:e=>({type:"SET\_SHOW\_DISCONNECT",showDisconnect:e}),setConflicts:e=>({type:"SET\_CONFLICTS",conflicts:e}),setOptimizedImages:e=>({type:"SET\_OPTIMIZED\_IMAGES",optimizedImages:e}),setSiteSettings:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:e}),setExtraVisits:e=>({type:"SET\_EXTRA\_VISITS",extraVisitsStatus:e}),setSampleRate:e=>({type:"SET\_SAMPLE\_RATE",sampleRate:e}),setTotalNumberOfImages:e=>({type:"SET\_TOTAL\_NUMBER\_OF\_IMAGES",totalNumberOfImages:e}),setProcessedImages:e=>({type:"SET\_PROCESSED\_IMAGES",processedImages:e}),setOffloadLibraryLink:e=>({type:"SET\_OFFLOAD\_LIBRARY\_LINK",offloadLibraryLink:e}),setRollbackLibraryLink:e=>({type:"SET\_ROLLBACK\_LIBRARY\_LINK",rollbackLibraryLink:e}),setLoadingRollback:e=>({type:"SET\_LOADING\_ROLLBACK",loadingRollback:e}),setLoadingSync:e=>({type:"SET\_LOADING\_SYNC",loadingSync:e}),setQueryArgs:e=>({type:"SET\_QUERY\_ARGS",queryArgs:e}),setErrorMedia:e=>({type:"SET\_ERROR\_MEDIA",errorMedia:e}),setEstimatedTime:e=>({type:"SET\_ESTIMATED\_TIME",estimatedTime:e}),setCheckedOffloadConflicts:e=>({type:"SET\_CHECKED\_OFFLOAD\_CONFLICTS",checkedOffloadConflicts:e}),setOffloadConflicts:e=>({type:"SET\_OFFLOAD\_CONFLICTS",offloadConflicts:e}),setLogs:(e,t)=>({type:"SET\_LOGS",logsType:e,logs:t}),setShowFinishNotice:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{show\_offload\_finish\_notice:e}}),setOffloadLimitReached:e=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offload\_limit\_reached:e}}),ensureOffloadingRollbackDisabled:()=>({type:"SET\_SITE\_SETTINGS",siteSettings:{offloading\_status:"disabled",rollback\_status:"disabled"}}),setOffloadLimit:e=>({type:"SET\_OFFLOAD\_LIMIT",offloadLimit:e})},n={autoConnect:optimoleDashboardApp.auto\_connect,isConnected:"yes"===optimoleDashboardApp.connection\_status,isConnecting:!1,isLoading:!1,hasRestError:!1,hasValidKey:!0,hasApplication:"yes"===optimoleDashboardApp.has\_application,apiKey:optimoleDashboardApp.api\_key?optimoleDashboardApp.api\_key:"",userStatus:optimoleDashboardApp.user\_status?optimoleDashboardApp.user\_status:"inactive",userData:optimoleDashboardApp.user\_data?optimoleDashboardApp.user\_data:null,availableApps:optimoleDashboardApp.available\_apps?optimoleDashboardApp.available\_apps:null,hasDashboardLoaded:"yes"===optimoleDashboardApp.connection\_status,showDisconnect:!1,conflicts:[],optimizedImages:[],siteSettings:optimoleDashboardApp.site\_settings,sampleRate:{},totalNumberOfImages:0,processedImages:0,offloadLibraryLink:!1,rollbackLibraryLink:!1,loadingRollback:!1,loadingSync:!1,queryArgs:[],errorMedia:!1,checkedOffloadConflicts:!1,offloadConflicts:[],offloadLimit:optimoleDashboardApp.offload\_limit||5e4,logs:{offload:"",rollback:""}},r=(e=n,t)=>{switch(t.type){case"SET\_AUTO\_CONNECT":return{...e,autoConnect:t.autoConnect};case"SET\_HAS\_REST\_ERROR":case"SET\_HAS\_REST\_ERROR":return{...e,hasRestError:t.hasRestError};case"SET\_API\_KEY":return{...e,apiKey:t.apiKey};case"SET\_AVAILABLE\_APPS":return{...e,availableApps:t.availableApps};case"SET\_IS\_CONNECTED":return{...e,isConnected:t.isConnected};case"SET\_IS\_CONNECTING":return{...e,isConnecting:t.isConnecting};case"SET\_IS\_LOADING":return{...e,isLoading:t.isLoading};case"SET\_HAS\_DASHBOARD\_LOADED":return{...e,hasDashboardLoaded:t.hasDashboardLoaded};case"SET\_HAS\_VALID\_KEY":return{...e,hasValidKey:t.hasValidKey};case"SET\_HAS\_APPLICATION":return{...e,hasApplication:t.hasApplication};case"SET\_USER\_DATA":let a="inactive";const{data:o}=t;if(o&&o.app\_count&&1<=o.app\_count&&o.cdn\_key)for(let e of o.available\_apps)e.key&&e.key===o.cdn\_key&&e.status&&"active"===e.status&&(a="active");return{...e,userData:t.data,userStatus:a};case"SET\_USER\_STATUS":return{...e,userStatus:t.status};case"SET\_SHOW\_DISCONNECT":return{...e,showDisconnect:t.showDisconnect};case"SET\_CONFLICTS":return{...e,conflicts:t.conflicts};case"SET\_OPTIMIZED\_IMAGES":return{...e,optimizedImages:t.optimizedImages};case"SET\_SITE\_SETTINGS":let{siteSettings:s}=e;for(let e in t.siteSettings)s[e]=t.siteSettings[e];return{...e,siteSettings:s};case"SET\_EXTRA\_VISITS":{let{siteSettings:a}=e;return a.banner\_frontend=t.extraVisitsStatus?"enabled":"disabled",{...e,siteSettings:a}}case"SET\_SAMPLE\_RATE":return{...e,sampleRate:t.sampleRate};case"SET\_TOTAL\_NUMBER\_OF\_IMAGES":return{...e,totalNumberOfImages:t.totalNumberOfImages};case"SET\_PROCESSED\_IMAGES":return{...e,processedImages:t.processedImages};case"SET\_OFFLOAD\_LIBRARY\_LINK":return{...e,offloadLibraryLink:t.offloadLibraryLink};case"SET\_ROLLBACK\_LIBRARY\_LINK":return{...e,rollbackLibraryLink:t.rollbackLibraryLink};case"SET\_LOADING\_ROLLBACK":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.rollbackLibraryLink=!t.loadingSync),{...e,loadingRollback:t.loadingRollback};case"SET\_LOADING\_SYNC":return Object.prototype.hasOwnProperty.call(e.queryArgs,"optimole\_action")&&(e.offloadLibraryLink=!t.loadingSync),{...e,loadingSync:t.loadingSync};case"SET\_QUERY\_ARGS":return{...e,queryArgs:t.queryArgs};case"SET\_ERROR\_MEDIA":return{...e,errorMedia:t.errorMedia};case"SET\_CHECKED\_OFFLOAD\_CONFLICTS":return{...e,checkedOffloadConflicts:t.checkedOffloadConflicts};case"SET\_OFFLOAD\_CONFLICTS":return{...e,offloadConflicts:t.offloadConflicts};case"SET\_LOGS":let{logs:l}=e;return l[t.logsType]=t.logs,{...e,logs:l};case"SET\_OFFLOAD\_LIMIT":return{...e,offloadLimit:t.offloadLimit};default:return e}},i={getAutoConnect:e=>e.autoConnect,getAPIKey:e=>e.apiKey,getAvailableApps:e=>e.availableApps,hasRestError:e=>e.hasRestError,hasValidKey:e=>e.hasValidKey,hasApplication:e=>e.hasApplication,hasDashboardLoaded:e=>e.hasDashboardLoaded,getUserData:e=>e.userData,getUserStatus:e=>e.userStatus,isConnected:e=>e.isConnected,isConnecting:e=>e.isConnecting,isLoading:e=>e.isLoading,showDisconnect:e=>e.showDisconnect,getConflicts:e=>e.conflicts,getOptimizedImages:e=>e.optimizedImages,getSiteSettings:(e,t=void 0)=>t?void 0!==e.siteSettings[t]?e.siteSettings[t]:void 0:e.siteSettings,getSampleRate:e=>e.sampleRate,getTotalNumberOfImages:e=>e.totalNumberOfImages,getProcessedImages:e=>e.processedImages,getOffloadLibraryLink:e=>e.offloadLibraryLink,getRollbackLibraryLink:e=>e.rollbackLibraryLink,getLoadingRollback:e=>e.loadingRollback,getLoadingSync:e=>e.loadingSync,getQueryArgs:e=>e.queryArgs,getErrorMedia:e=>e.errorMedia,getCheckedOffloadConflicts:e=>e.checkedOffloadConflicts,getOffloadConflicts:e=>e.offloadConflicts,getOffloadLimit:e=>e.offloadLimit,getLogs:(e,t=void 0)=>t?void 0!==e.logs[t]?e.logs[t]:void 0:e.logs};if(void 0!==wp.data.createReduxStore){const e=wp.data.createReduxStore("optimole",{reducer:r,actions:l,selectors:i});wp.data.register(e)}else wp.data.registerStore("optimole",{reducer:r,actions:l,selectors:i});const c=window.wp.data;var d=a(184),p=a.n(d);const m=window.wp.primitives,g=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})),u=window.wp.components,h=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"20",viewBox:"0 0 21 20",fill:"none"},(0,o.createElement)("path",{d:"M17.357 2.92894C16.9664 2.53842 16.3333 2.53842 15.9427 2.92894C15.5522 3.31946 15.5522 3.95263 15.9427 4.34315L17.357 2.92894ZM16.6499 16.364L15.9427 17.0711H15.9427L16.6499 16.364ZM14.5285 5.75737C14.138 5.36684 13.5048 5.36684 13.1143 5.75737C12.7238 6.14789 12.7238 6.78106 13.1143 7.17158L14.5285 5.75737ZM13.8214 13.5355L13.1143 14.2426L13.1143 14.2427L13.8214 13.5355ZM6.04325 14.2427C6.43377 14.6332 7.06694 14.6332 7.45746 14.2427C7.84799 13.8521 7.84799 13.219 7.45746 12.8284L6.04325 14.2427ZM6.32586 10.5662C6.24822 10.0194 5.74201 9.63905 5.19521 9.71669C4.64841 9.79434 4.26808 10.3005 4.34573 10.8473L6.32586 10.5662ZM3.21482 17.0711C3.60535 17.4616 4.23851 17.4616 4.62903 17.0711C5.01956 16.6806 5.01956 16.0474 4.62903 15.6569L3.21482 17.0711ZM2.70292 7.44452C2.87885 6.921 2.59707 6.354 2.07355 6.17807C1.55004 6.00215 0.98303 6.28393 0.807105 6.80744L2.70292 7.44452ZM1.993 0.292893C1.60247 -0.0976311 0.969306 -0.0976311 0.578782 0.292893C0.188258 0.683417 0.188258 1.31658 0.578782 1.70711L1.993 0.292893ZM18.5788 19.7071C18.9693 20.0976 19.6025 20.0976 19.993 19.7071C20.3835 19.3166 20.3835 18.6834 19.993 18.2929L18.5788 19.7071ZM15.9427 4.34315C19.0669 7.46735 19.0669 12.5327 15.9427 15.6569L17.357 17.0711C21.2622 13.1658 21.2622 6.83418 17.357 2.92894L15.9427 4.34315ZM13.1143 7.17158C14.6764 8.73368 14.6764 11.2663 13.1143 12.8284L14.5285 14.2427C16.8717 11.8995 16.8717 8.10051 14.5285 5.75737L13.1143 7.17158ZM10.2859 10H12.2859C12.2859 8.89544 11.3905 8.00001 10.2859 8.00001V10ZM7.45746 12.8284C6.81978 12.1908 6.44341 11.394 6.32586 10.5662L4.34573 10.8473C4.52209 12.0894 5.08876 13.2882 6.04325 14.2427L7.45746 12.8284ZM4.62903 15.6569C2.40899 13.4368 1.76507 10.2354 2.70292 7.44452L0.807105 6.80744C-0.363267 10.2902 0.43743 14.2937 3.21482 17.0711L4.62903 15.6569ZM10.2859 10L10.2859 10V8.00001C9.73388 8.00001 9.23252 8.22496 8.87168 8.58578L10.2859 10ZM0.578782 1.70711L8.87168 10L10.2859 8.58579L1.993 0.292893L0.578782 1.70711ZM8.87168 10L10.2859 11.4142L11.7001 10L10.2859 8.58579L8.87168 10ZM10.2859 11.4142L13.1143 14.2426L14.5285 12.8284L11.7001 10L10.2859 11.4142ZM13.1143 14.2427L15.9427 17.0711L17.357 15.6569L14.5285 12.8284L13.1143 14.2427ZM15.9427 17.0711L18.5788 19.7071L19.993 18.2929L17.357 15.6569L15.9427 17.0711ZM10.2859 10L10.2859 10L11.7001 11.4142C12.0609 11.0534 12.2859 10.552 12.2859 10H10.2859Z",fill:"#E77777"})),b=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"16",viewBox:"0 0 21 16",fill:"none"},(0,o.createElement)("path",{d:"M4.00127 14.3639C0.486555 10.8492 0.486555 5.15071 4.00127 1.63599M16.7292 1.63599C20.2439 5.15071 20.2439 10.8492 16.7292 14.3639M6.8297 11.5355C4.87708 9.58286 4.87708 6.41704 6.8297 4.46441M13.9008 4.46441C15.8534 6.41704 15.8534 9.58286 13.9008 11.5355M11.3652 7.99995C11.3652 8.55223 10.9175 8.99995 10.3652 8.99995C9.81295 8.99995 9.36523 8.55223 9.36523 7.99995C9.36523 7.44766 9.81295 6.99995 10.3652 6.99995C10.9175 6.99995 11.3652 7.44766 11.3652 7.99995Z",stroke:"#6D955A","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),\_=()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M46.6215 21.757C44.6278 22.9074 43.5209 25.0684 43.5415 27.3692C43.5415 27.4128 43.5415 27.4563 43.5415 27.4999C43.5415 27.5434 43.5415 27.5892 43.5415 27.6328C43.5209 29.9336 44.6278 32.0947 46.6215 33.2451L46.6399 33.2565C47.9943 34.038 49.7565 33.2657 50.043 31.728C50.5678 28.9047 50.5426 26.0378 50.0178 23.2717C49.7268 21.7386 47.9713 20.9778 46.6215 21.757V21.757Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M19.8137 13.4291C19.6052 13.5437 19.3989 13.6629 19.195 13.7866C17.2906 14.9462 14.8958 14.9256 12.9639 13.8096C11.621 13.035 11.385 11.1421 12.5583 10.1291C14.701 8.27747 17.1875 6.8131 19.9145 5.85518C21.3812 5.33955 22.912 6.48997 22.912 8.04372V8.06205C22.912 10.2781 21.7547 12.3635 19.8137 13.4291V13.4291Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M35.2025 41.5616C35.4065 41.4493 35.6081 41.3325 35.8075 41.211C37.7119 40.0514 40.1067 40.0721 42.0386 41.1881C43.3815 41.9627 43.6175 43.8556 42.4442 44.8685C40.3015 46.7202 37.815 48.1846 35.0879 49.1448C33.6213 49.6627 32.0881 48.5123 32.0881 46.9562C32.0881 44.731 33.2523 42.6364 35.2025 41.5616V41.5616Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M8.37836 33.243C7.02857 34.0221 5.27315 33.2613 4.98211 31.7305C4.45732 28.9644 4.43211 26.0953 4.9569 23.2719C5.24336 21.7342 7.00336 20.9619 8.35773 21.7434L8.37836 21.7548C10.3721 22.9053 11.479 25.0663 11.4584 27.3671C11.4584 27.4107 11.4584 27.4565 11.4584 27.5001C11.4584 27.5436 11.4584 27.5871 11.4584 27.6307C11.479 29.9315 10.3721 32.0926 8.37836 33.243V33.243Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0881 8.06439C32.0881 6.50605 33.6258 5.36709 35.0948 5.88043C37.7531 6.80855 40.2511 8.22022 42.435 10.0902C43.6221 11.1077 43.4113 13.0167 42.0569 13.7981L42.0363 13.8096C40.1044 14.9233 37.7119 14.9463 35.8075 13.7867C35.6036 13.6629 35.3973 13.5415 35.1865 13.4269C33.2454 12.3636 32.0881 10.2781 32.0881 8.06439V8.06439Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9122 46.9357C22.9122 48.494 21.3745 49.633 19.9055 49.1196C17.2472 48.1915 14.7493 46.7798 12.5653 44.9098C11.3782 43.8923 11.5891 41.9834 12.9434 41.2019C14.8868 40.079 17.2953 40.0607 19.2157 41.2248C19.4128 41.344 19.6122 41.4609 19.8161 41.5709C21.7549 42.6365 22.9122 44.7219 22.9122 46.9357V46.9357Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M27.5 20.6256L34.3755 27.5011L27.5 34.3766L20.6245 27.5011L27.5 20.6256Z",stroke:"#577BF9","stroke-width":"1.91406","stroke-linecap":"round","stroke-linejoin":"round"})),f=(0,o.createElement)("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.9581 0C13.5192 0 17.2136 3.58 17.2136 8C17.2136 12.42 13.5192 16 8.9581 16C4.39696 16 0.702637 12.42 0.702637 8C0.702637 3.58 4.39696 0 8.9581 0ZM10.6558 9L11.0219 3H7.92606L8.29211 9H10.6558ZM11.0219 11.5115C11.0219 11.9809 10.8811 12.3473 10.6213 12.6107C10.3507 12.874 9.97188 13 9.48478 13C8.99768 13 8.61882 12.874 8.33739 12.6107C8.06677 12.3473 7.92606 11.9809 7.92606 11.5115C7.92606 11.0305 8.05595 10.6641 8.32656 10.4008C8.59717 10.1374 8.97603 10 9.48478 10C9.99353 10 10.3724 10.1374 10.6322 10.4008C10.892 10.6641 11.0219 11.0305 11.0219 11.5115Z",fill:"#AF3535"})),E=(0,o.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M17.25 8.25H21V4.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M3 12C3 7.029 7.029 3 12 3C15.63 3 18.751 5.154 20.174 8.25",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M6.75 15.75H3V19.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M21 12C21 16.971 16.971 21 12 21C8.37 21 5.249 18.846 3.826 15.75",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),v=(0,o.createElement)("svg",{width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M35.8621 13.647L22.0095 27.4996L15.085 20.5733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.5 22C38.5 31.1135 31.1135 38.5 22 38.5C12.8865 38.5 5.5 31.1135 5.5 22C5.5 12.8865 12.8865 5.5 22 5.5C24.6638 5.5 27.1718 6.14717 29.3993 7.26733",fill:"none",stroke:"white","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"})),y=(0,o.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M13 12L10 9M10 9L7 12M10 9L10 21",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),w=(0,o.createElement)("svg",{width:"20",height:"22",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M5 15C2.79086 15 1 13.2091 1 11C1 9.09295 2.33457 7.4976 4.12071 7.09695C4.04169 6.74395 4 6.37684 4 6C4 3.23858 6.23858 1 9 1C11.4193 1 13.4373 2.71825 13.9002 5.00098C13.9334 5.00033 13.9666 5 14 5C16.7614 5 19 7.23858 19 10C19 12.419 17.2822 14.4367 15 14.9M7 18L10 21M10 21L13 18M10 21V9",stroke:"#577BF9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),k=(0,o.createElement)("svg",{width:"20",height:"18",viewBox:"0 0 20 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)("path",{d:"M10.0015 8V10M10.0015 14H10.0115M3.0733 18H16.9297C18.4693 18 19.4316 16.3333 18.6618 15L11.7336 3C10.9637 1.66667 9.03925 1.66667 8.26945 3L1.34125 15C0.571445 16.3333 1.5337 18 3.0733 18Z",stroke:"#DE9F0C","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})),x=window.wp.apiFetch;var C=a.n(x);const S=window.wp.url,A=window.wp.notices,D=window.optimoleDashboardApp.submenu\_links,L=(e=!0)=>{const t=document.querySelector("li#toplevel\_page\_optimole");let a=document.querySelector("li#toplevel\_page\_optimole .wp-submenu");a||(a=document.createElement("ul"),a.classList.add("wp-submenu","wp-submenu-wrap"),t.classList.add("wp-has-submenu","wp-has-current-submenu","wp-menu-open"),t.appendChild(a)),e?(D.forEach((e=>{if(document.querySelector(`li#toplevel\_page\_optimole a[href="${e.href}"]`))return;const t=document.createElement("li"),o=document.createElement("a");o.href=e.href,o.innerHTML=e.text,t.appendChild(o),e.hash&&e.hash===window.location.hash&&(t.classList.add("current"),o.classList.add("current")),a.appendChild(t)})),a.style.display="block"):a.style.display="none"},{setIsConnected:N,setIsConnecting:T,setIsLoading:M,setHasRestError:I,setHasValidKey:O,setHasApplication:j,setAPIKey:F,setUserData:B,setAvailableApps:z,sethasDashboardLoaded:H,setShowDisconnect:R,setConflicts:P,setOptimizedImages:V,setSiteSettings:Z,setSampleRate:q,setCheckedOffloadConflicts:G,setOffloadConflicts:$,setLoadingSync:K,setLoadingRollback:U,setTotalNumberOfImages:Y,setProcessedImages:Q,setErrorMedia:W,setOffloadLibraryLink:J,setRollbackLibraryLink:X,setExtraVisits:ee,setLogs:te,setShowFinishNotice:ae,setOffloadLimitReached:oe,ensureOffloadingRollbackDisabled:se,setOffloadLimit:le}=(0,c.dispatch)("optimole"),{getOptimizedImages:ne,getQueryArgs:re,getTotalNumberOfImages:ie,getSiteSettings:ce}=(0,c.select)("optimole"),{createNotice:de}=(0,c.dispatch)(A.store),pe=(e={})=>{e.offset=void 0!==e.offset?e.offset:0,C()({path:optimoleDashboardApp.routes.upload\_onboard\_images,method:"POST",data:e}).then((t=>{!1===t.data&&1e3>e.offset&&pe({offset:e.offset+100}),"success"===t.code&&console.log("%c Images Crawled.","color: #59B278")})).catch((e=>(console.log("Error while crawling images",e),e.data)))},me=(e,t=(()=>{}))=>{T(!0),M(!0),I(!1),C()({path:optimoleDashboardApp.routes.register\_service,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(T(!1),M(!1),"success"===e.code&&(N(!0),O(!0),j(!0),F(e.data.api\_key),B(e.data),z(e.data),pe(),L(!0)),t&&t(e),e.data))).catch((e=>(T(!1),M(!1),I(!0),e.data)))},ge=()=>{M(!0),C()({path:optimoleDashboardApp.routes.disconnect,method:"GET",parse:!1}).then((e=>{M(!1),j(!1),F(""),B(null),z(null),e.ok?(N(!1),H(!1),R(!1),L(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")):console.error(e)}))},ue=()=>{M(!0),C()({path:optimoleDashboardApp.routes.request\_update,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{M(!1),e&&(B(e.data),void 0!==e?.data?.extra\_visits&&ee(e.data.extra\_visits),"disconnected"===e.code&&(N(!1),H(!1),console.log("%c Disconnected from OptiMole API.","color: #59B278")))}))},he=(e=(()=>{}))=>{if(0<ne().length)return console.log("%c Images already exist.","color: #59B278"),e&&e(),!1;C()({path:optimoleDashboardApp.routes.poll\_optimized\_images,method:"GET"}).then((t=>{"success"===t.code?(V(t.data),console.log("%c Images Fetched.","color: #59B278")):console.log("%c No images available.","color: #E7602A"),e&&e(t)})).catch((e=>(console.log("Error while polling images",e),e.data)))},be=(e,t=!1,a=!1,o=(()=>{}))=>{M(!0),C()({path:optimoleDashboardApp.routes.update\_option,method:"POST",data:{settings:e}}).then((e=>{M(!1),"success"===e.code&&(Z(e.data),a||ye(optimoleDashboardApp.strings.options\_strings.settings\_saved),console.log("%c Settings Saved.","color: #59B278"))})).then((()=>{t&&ue()})).then((()=>{o()})).catch((e=>(M(!1),ye(optimoleDashboardApp.strings.options\_strings.settings\_saved\_error),console.log("Error while saving settings",e),e.data)))},\_e=e=>{M(!0),C()({path:optimoleDashboardApp.routes.clear\_cache\_request,method:"POST",data:{type:e},parse:!1}).then((e=>(M(!1),200<=e.status&&300>e.status?(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared),void console.log("%c New cache token generated.","color: #59B278")):(ye(optimoleDashboardApp.strings.options\_strings.cache\_cleared\_error),void console.log("%c Could not generate cache token.","color: #E7602A")))))},fe=(e,t=(()=>{}))=>{C()({path:(0,S.addQueryArgs)(optimoleDashboardApp.routes.get\_sample\_rate,{quality:e.quality,force:e?.force||"no"}),method:"POST"}).then((e=>{"success"===e.code&&q(e.data),t&&t(e)}))},Ee=(e=(()=>{}))=>{C()({path:optimoleDashboardApp.routes.get\_offload\_conflicts,method:"GET"}).then((t=>{G(!0),0!==t.data.length&&$(t.data),e&&e(t)}))},ve=e=>{const t=re();"offload\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&J(!1),K(!0)),"rollback\_images"===e.action&&(Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!1),U(!0)),M(!0);const a=void 0!==e.images?e.images:[];C()({path:optimoleDashboardApp.routes.number\_of\_images\_and\_pages,method:"POST",data:{action:e.action,refresh:e.refresh||!1,images:a},parse:!1}).then((t=>{if(200<=t.status&&300>t.status)return t.json();"offload\_images"===e.action&&(K(!1),M(!1)),"rollback\_images"===e.action&&(U(!1),M(!1))})).then((o=>{if(!o.data.count||0===o.data.count||!1===o.data.status)return console.log("%c No images available.","color: #E7602A"),K(!1),U(!1),M(!1),0===o.data.count&&(oe("disabled"),ae(o.data.action)),o.data.reached\_limit&&oe(o.data.reached\_limit?"enabled":"disabled"),o.data.offload\_limit&&le(o.data.offload\_limit),se(),be(ce(),!1),"offload\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&J(!0),void("rollback\_images"===e.action&&Object.prototype.hasOwnProperty.call(t,"optimole\_action")&&X(!0));let s=ie();e.refresh?(Q(0!==s?Math.abs(s-o.data.count):0),0!==o.data.count&&0===s&&Y(o.data.count)):Y(o.data.count),setTimeout((()=>{ve({action:e.action,refresh:!0,images:a})}),1e4)})).finally((()=>{var t;t="offload\_images"===e.action?"offload":"rollback",jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"optml\_fetch\_logs",nonce:optimoleDashboardApp.nonce,type:t},success:e=>{te(t,e)}})})).catch((t=>{W(e.action),K(!1),U(!1)}))},ye=e=>{de("info",e,{isDismissible:!0,type:"snackbar"})},we=({tab:e,setTab:t})=>{const[a,l]=(0,s.useState)(!1),{setShowDisconnect:n}=(0,c.useDispatch)("optimole"),{isConnected:r,isLoading:i,hasApplication:d,hasDashboardLoaded:m,hasConflicts:\_}=(0,c.useSelect)((e=>{const{isConnected:t,isLoading:a,hasApplication:o,hasDashboardLoaded:s,getConflicts:l}=e("optimole"),n=l();return{isConnected:t(),isLoading:a(),hasApplication:o(),hasDashboardLoaded:s(),hasConflicts:0<n.count||0}}));(0,s.useEffect)((()=>{\_&&l(!0)}),[\_]);const f=[{label:optimoleDashboardApp.strings.dashboard\_menu\_item,value:"dashboard"},{label:optimoleDashboardApp.strings.conflicts\_menu\_item,value:"conflicts",isDisabled:!a},{label:optimoleDashboardApp.strings.settings\_menu\_item,value:"settings"},{label:optimoleDashboardApp.strings.help\_menu\_item,value:"help"}],E=r&&d&&!m;return(0,o.createElement)("header",{className:"bg-white shadow-sm px-2.5 py-5 pb-0"},(0,o.createElement)("div",{className:"flex flex-col sm:flex-row justify-between items-center max-w-screen-xl mx-auto my-0 pb-5"},(0,o.createElement)("div",{className:"items-center flex justify-start cursor-default"},(0,o.createElement)("img",{className:"max-width-64 w-16 h-16 mr-3",src:`${optimoleDashboardApp.assets\_url}/img/logo.png`,alt:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details,title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.service\_details}),(0,o.createElement)("h3",{className:"text-gray-800 text-2 font-serif font-bold"},optimoleDashboardApp.strings.optimole)),(0,o.createElement)("div",{className:"flex items-center"},r?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.DropdownMenu,{icon:i||E?(0,o.createElement)(u.Icon,{icon:g,className:"animate-spin fill-success"}):(0,o.createElement)(u.Icon,{icon:b}),toggleProps:{className:"optml-header\_\_dropdown uppercase font-bold text-xs text-success hover:text-success active:text-success focus:text-success mr-3 border border-gray-300 rounded-md border-solid gap-2",iconPosition:"right"},popoverProps:{className:"optml-header\_\_dropdown\_\_popover"},text:E?optimoleDashboardApp.strings.connecting:optimoleDashboardApp.strings.connected,controls:[{title:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.dashboard\_menu\_item,onClick:()=>window.open(optimoleDashboardApp.optimoleDashHome,"\_blank")},{title:optimoleDashboardApp.strings.refresh\_stats\_cta,onClick:ue,isDisabled:E},{title:optimoleDashboardApp.strings.disconnect\_btn,onClick:()=>n(!0),isDisabled:E}]})):(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"uppercase font-bold text-xs text-danger mr-3"},optimoleDashboardApp.strings.not\_connected),(0,o.createElement)(u.Icon,{icon:h})))),r&&d&&m&&(0,o.createElement)("ul",{className:"flex gap-8 items-center max-w-screen-xl mx-auto my-0 justify-center sm:justify-normal"},f.filter((e=>!e?.isDisabled)).map((({label:a,value:s})=>(0,o.createElement)("li",{key:s,className:p()("cursor-pointer text-purple-gray font-bold text-lg m-0 py-2 px-3 transition-colors duration-200 ease-in-out border-0 border-b-4 border-b-white border-solid",{"text-black !border-b-info":e===s}),onClick:()=>t(s)},a)))))},ke=()=>{const{setShowDisconnect:e}=(0,c.useDispatch)("optimole"),{isLoading:t}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}));return(0,o.createElement)(u.Modal,{title:optimoleDashboardApp.strings.disconnect\_title,className:"optml\_\_modal",onRequestClose:()=>e(!1)},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.disconnect\_desc}}),(0,o.createElement)("div",{className:"flex gap-2"},(0,o.createElement)(u.Button,{variant:"default",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>e(!1)},optimoleDashboardApp.strings.keep\_connected),(0,o.createElement)(u.Button,{isDestructive:!0,className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",isBusy:t,disabled:t,onClick:ge},optimoleDashboardApp.strings.disconnect\_btn)))},xe=({setMethod:e})=>{const[t,a]=(0,s.useState)(""),[l,n]=(0,s.useState)({}),[r,i]=(0,s.useState)(0),{setShowDisconnect:d}=(0,c.useDispatch)("optimole"),{availableApps:p,hasValidKey:m,isConnected:g,isConnecting:h,isLoading:b}=(0,c.useSelect)((e=>{const{getAvailableApps:t,hasValidKey:a,isConnected:o,isConnecting:s,isLoading:l}=e("optimole");return{availableApps:t(),hasValidKey:a(),isConnected:o(),isConnecting:s(),isLoading:l()}}));return(0,o.createElement)("div",{className:"text-2 font-bold m-0 text-gray-700"},(0,o.createElement)("div",{className:"text-gray-800 font-serif leading-7"},optimoleDashboardApp.strings.connect\_btn),(0,o.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.steps\_connect\_api\_desc}}),(0,o.createElement)("div",{className:"flex flex-col gap-8 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,o.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,o.createElement)(u.TextControl,{label:g?optimoleDashboardApp.strings.your\_api\_key:optimoleDashboardApp.strings.add\_api,placeholder:optimoleDashboardApp.strings.email,disabled:g,value:t,onChange:a,className:"optml\_\_input basis-4/5"}),g?(0,o.createElement)(u.Button,{variant:"default",isBusy:b,disabled:b,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:d},optimoleDashboardApp.strings.disconnect\_btn):(0,o.createElement)(u.Button,{variant:"primary",isBusy:h,disabled:h||0===t.length,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{n({}),((e,t=(()=>{}))=>{T(!0),M(!0),I(!1),C()({path:optimoleDashboardApp.routes.connect,method:"POST",data:e,parse:!1}).then((e=>e.json())).then((e=>(T(!1),M(!1),"success"===e.code?(N(!0),O(!0),F(e.data.api\_key),void 0!==e.data.app\_count&&1<e.data.app\_count?z(e.data):(j(!0),B(e.data)),pe(),L(!0),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e),e.data))).catch((e=>(T(!1),M(!1),I(!0),e.data)))})({api\_key:t},(e=>{"success"!==e.code&&n({error\_connect:e.data})}))}},optimoleDashboardApp.strings.connect\_btn)),p&&(0,o.createElement)("div",{className:"flex flex-col sm:flex-row gap-8 items-stretch sm:items-end"},(0,o.createElement)("div",{className:"basis-4/5"},(0,o.createElement)(u.SelectControl,{label:optimoleDashboardApp.strings.select+" "+optimoleDashboardApp.strings.your\_domain,value:r,options:p.available\_apps.map(((e,t)=>({label:e.domain,value:t}))),onChange:i,className:"optml\_\_select has\_large\_title",\_\_nextHasNoMarginBottom:!0})),(0,o.createElement)(u.Button,{variant:"primary",isBusy:h,disabled:h,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{((e,t=(()=>{}))=>{T(!0),I(!1),C()({path:optimoleDashboardApp.routes.select\_application,method:"POST",data:e}).then((e=>{T(!1),M(!1),"success"===e.code?(O(!0),j(!0),F(e.data.api\_key),B(e.data),z(e.data),console.log("%c OptiMole API connection successful.","color: #59B278")):(O(!1),console.log("%c Invalid API Key.","color: #E7602A")),t&&t(e)})).catch((e=>(T(!1),I(!0),e.data)))})({api\_key:t,application:null!=p&&void 0!==p.available\_apps?p.available\_apps[r].key:""},(e=>{"success"!==e.code&&n({error\_connect:e.data})}))}},optimoleDashboardApp.strings.select))),!m&&void 0!==l.error\_connect&&(0,o.createElement)("p",{className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:l.error\_connect}}),(0,o.createElement)("div",{className:"text-center py-3"},(0,o.createElement)(u.Button,{variant:"link",onClick:()=>e("email")},optimoleDashboardApp.strings.back\_to\_connect)))},Ce="optml-connect flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md",Se="flex gap-8 p-8 flex-col md:flex-row",Ae=()=>(0,o.createElement)("div",{className:"bg-danger text-white rounded relative px-6 py-5 mb-0 m-12",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_api\_not\_working}}),De=()=>{const[e,t]=(0,s.useState)(optimoleDashboardApp.current\_user.email),[a,l]=(0,s.useState)("email"),[n,r]=(0,s.useState)({}),{setAutoConnect:i}=(0,c.useDispatch)("optimole"),{autoConnect:d,hasRestError:p,isConnecting:m}=(0,c.useSelect)((e=>{const{getAutoConnect:t,hasRestError:a,isConnecting:o}=e("optimole");return{autoConnect:t(),hasRestError:a(),isConnecting:o()}}));return(0,s.useEffect)((()=>{"no"!==d&&me({email:d,auto\_connect:!0},(e=>{i("no"),"email\_registered"!==e.code?"site\_exists"!==e.code?"success"!==e.code&&e.message&&r({error\_autoconnect:e.message}):r({site\_exists:e.message}):r({email\_registered:e.message})}))}),[]),(0,s.useEffect)((()=>{(0===e.length||(0,S.isEmail)(e))&&n.invalid\_email&&(delete n.invalid\_email,r(n))}),[e]),"key"===a?(0,o.createElement)("div",{className:Ce},p&&(0,o.createElement)(Ae,null),(0,o.createElement)("div",{className:Se},(0,o.createElement)(xe,{setMethod:l}))):(0,o.createElement)("div",{className:Ce},p&&(0,o.createElement)(Ae,null),(0,o.createElement)("div",{className:Se},(0,o.createElement)("div",{className:"optml-connect\_\_content basis-8/12"},(0,o.createElement)("div",{className:"text-gray-700 font-serif text-2 font-bold leading-7 m-0"},optimoleDashboardApp.strings.account\_needed\_heading),(0,o.createElement)("p",{className:"text-xl font-normal text-gray-800",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_title}}),(0,o.createElement)("div",{className:"flex py-3"},(0,o.createElement)(u.Icon,{icon:"yes-alt"}),(0,o.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_1}})),(0,o.createElement)("div",{className:"flex py-3"},(0,o.createElement)(u.Icon,{icon:"yes-alt"}),(0,o.createElement)("p",{className:"text-base ml-3 m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_2}}))),(0,o.createElement)("div",{className:"optml-connect\_\_form basis-4/12 p-8 bg-light-blue border border-blue-300 rounded-md"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.email\_address\_label,placeholder:optimoleDashboardApp.strings.email,value:e,onChange:t,className:"optml\_\_input",onBlur:()=>{0===e.length||(0,S.isEmail)(e)||r({invalid\_email:optimoleDashboardApp.strings.invalid\_email})}}),0<Object.keys(n).length&&Object.keys(n).map((e=>(0,o.createElement)("p",{key:e,className:"block text-xs mt-1 text-danger",dangerouslySetInnerHTML:{\_\_html:n[e]}})))||(0,o.createElement)("br",null),(0,o.createElement)(u.Button,{variant:"primary",isBusy:m,disabled:m||0===e.length||!(0,S.isEmail)(e),className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40",onClick:()=>{r({}),me({email:e},(e=>{"email\_registered"!==e.code?"site\_exists"!==e.code?"domain\_not\_accessible"!==e.code?"success"!==e.code&&r({error\_register:optimoleDashboardApp.strings.error\_register}):r({domain\_not\_accessible:e.message}):r({site\_exists:e.message}):r({email\_registered:e.message})}))}},optimoleDashboardApp.strings.register\_btn),(0,o.createElement)("br",null),(0,o.createElement)("br",null),(0,o.createElement)("div",{className:"base-control-label"},optimoleDashboardApp.strings.existing\_user),(0,o.createElement)(u.Button,{variant:"secondary",className:"optml\_\_button flex w-full justify-center rounded font-bold mt-4 min-h-40",onClick:()=>l("key")},optimoleDashboardApp.strings.api\_exists),(0,o.createElement)("p",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.signup\_terms}}))),(0,o.createElement)("div",{className:"bg-grayish-blue text-gray-800 text-center font-bold uppercase p-2.5 rounded-b-lg"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_footer}})))},Le=({value:e,max:t=100,className:a,...s})=>{const l=Math.round(e/t\*100),n=(s.background,p()("w-full h-2.5 border rounded-md border-solid bg-white border-light-gray relative overflow-hidden",a));return(0,o.createElement)("div",{className:n,role:"progressbar","aria-valuemin":"0","aria-valuemax":t,"aria-valuenow":e,...s},(0,o.createElement)("div",{className:"absolute left-0 h-full bg-info",style:{width:`${l}%`}}))},Ne=[optimoleDashboardApp.strings.options\_strings.connect\_step\_0,optimoleDashboardApp.strings.options\_strings.connect\_step\_1,optimoleDashboardApp.strings.options\_strings.connect\_step\_2,optimoleDashboardApp.strings.options\_strings.connect\_step\_3],Te=()=>{const[e,t]=(0,s.useState)(0),[a,l]=(0,s.useState)(0),[n,r]=(0,s.useState)(0),{sethasDashboardLoaded:i}=(0,c.useDispatch)("optimole");(0,s.useEffect)((()=>{n<=25&&setTimeout((()=>{d()}),1e3)}),[n]);const d=()=>{if(r(n+1),n>=25)return i(!0),r(0),l(0),void t(0);t(Math.floor(n/25\*100)),e>30\*(a+1)&&l(a+1)};return(0,o.createElement)("div",{className:"optml-connecting flex flex-col justify-between max-w-screen-xl mt-8 mb-5 mx-auto p-0 transition-all ease-in-out duration-700 relative bg-white text-gray-700 border-0 rounded-lg shadow-md"},(0,o.createElement)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-5 px-8 sm:px-0 py-24"},(0,o.createElement)("img",{className:"max-w-full",src:optimoleDashboardApp.assets\_url+"img/connecting.png"}),(0,o.createElement)("div",{className:"text-center md:text-left"},(0,o.createElement)("div",{className:"font-bold text-2xl"},optimoleDashboardApp.strings.account\_connecting\_title),(0,o.createElement)("div",{className:"text-base"},optimoleDashboardApp.strings.account\_connecting\_subtitle),(0,o.createElement)(Le,{className:"mt-2.5 mb-1.5 mx-0 h-5 border-gray-200",value:n,max:25,background:"#e6e6e6"}),(0,o.createElement)("div",{className:"text-xs"},Ne[a]+" ("+e+"%)"))))},Me=function(){const[e,t]=(0,o.useState)(null),[a,s]=(0,o.useState)({width:0,height:0}),l=(0,o.useCallback)((()=>{s({width:(null==e?void 0:e.offsetWidth)||0,height:(null==e?void 0:e.offsetHeight)||0})}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]);return Ie("resize",l),Oe((()=>{l()}),[null==e?void 0:e.offsetHeight,null==e?void 0:e.offsetWidth]),[t,a]},Ie=function(e,t,a,s){const l=(0,o.useRef)(t);Oe((()=>{l.current=t}),[t]),(0,o.useEffect)((()=>{var t;const o=null!==(t=null==a?void 0:a.current)&&void 0!==t?t:window;if(!o||!o.addEventListener)return;const n=e=>l.current(e);return o.addEventListener(e,n,s),()=>{o.removeEventListener(e,n,s)}}),[e,a,s])},Oe="undefined"!=typeof window?o.useLayoutEffect:o.useEffect,je="yes"!==optimoleDashboardApp.connection\_status,Fe=({src:e,oldSize:t,newSize:a})=>{const[s,{width:l}]=Me();return(0,o.createElement)("div",{className:"basis-1/4"},(0,o.createElement)("img",{src:e,className:"w-full border border-slate-200 rounded-md border-solid",style:{height:l},ref:s}),(0,o.createElement)("p",{className:"optml\_\_bullet w-full h-4"},(()=>{let e=(100\*(1-a/t)).toFixed(1);return 1>e?"1":100<e?(Math.floor(e/10+10)/10).toFixed(1).toString():e.toString()})(),"% ",optimoleDashboardApp.strings.latest\_images.saved," "))},Be=()=>{const[e,{width:t}]=Me();return(0,o.createElement)("div",{className:"basis-1/4"},(0,o.createElement)("div",{className:"optml\_\_loader w-full rounded-md",style:{height:t},ref:e}),(0,o.createElement)("p",{className:"optml\_\_loader w-full h-4"}))},ze=()=>{const[e,t]=(0,s.useState)(!1),[a,l]=(0,s.useState)(0),[n,r]=(0,s.useState)(0),[i,d]=(0,s.useState)(0);(0,s.useEffect)((()=>{i<=20&&setTimeout((()=>{m()}),1e3)}),[i]);const{images:p}=(0,c.useSelect)((e=>{const{getOptimizedImages:t}=e("optimole");return{images:t()||[]}}));(0,s.useEffect)((()=>{8<=p.length?t(!0):e||je||he((()=>{t(!0)}))}),[]);const m=()=>{d(i+1),i>=20?he((()=>{t(!0),d(0),r(0),l(0),ue()})):(l(Math.floor(i/20\*100)),a>30\*(n+1)&&r(n+1))};return(0,o.createElement)("div",{className:"hidden lg:block pt-5 border-grayish-blue border-0 border-t-2 border-solid"},(0,o.createElement)("h3",{className:"text-base m-0"},optimoleDashboardApp.strings.latest\_images.last," ",optimoleDashboardApp.strings.latest\_images.optimized\_images),je&&!e&&(0,o.createElement)("div",{className:"flex items-center flex-col py-2"},(0,o.createElement)("p",{className:"font-semibold"},optimoleDashboardApp.strings.latest\_images.loading\_latest\_images),(0,o.createElement)(Le,{max:20,value:i})),!je&&!e&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,o.createElement)(Be,null)))),(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map((()=>(0,o.createElement)(Be,null))))),e&&4>p?.length&&(0,o.createElement)("div",{className:"text-center py-12"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.latest\_images.no\_images\_found}})),e&&4<=p?.length&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(0,o.createElement)(Fe,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))),8<=p?.length&&(0,o.createElement)("div",{className:"flex justify-between mt-5 gap-5"},[...Array(4)].map(((e,t)=>(t+=4,(0,o.createElement)(Fe,{src:p[t].url,oldSize:p[t].ex\_size\_raw,newSize:p[t].new\_size\_raw})))))))},He="flex p-6 bg-light-blue border border-blue-300 rounded-md",Re=[{label:optimoleDashboardApp.strings.metrics.metricsTitle1,description:optimoleDashboardApp.strings.metrics.metricsSubtitle1,value:"images\_number",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M42.0235 45.3568L45.0279 46.6928C46.5427 47.3666 48.25 46.2574 48.25 44.5982V10.402C48.25 8.74281 46.5427 7.63364 45.0279 8.30739L42.0235 9.64343C32.8569 13.718 22.3931 13.718 13.2265 9.64343L10.2221 8.30739C8.70729 7.63364 7 8.74281 7 10.402V44.5982C7 46.2574 8.70729 47.3666 10.2221 46.6928L13.2265 45.3568C22.3931 41.2845 32.8569 41.2845 42.0235 45.3568Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M34.5002 35.5209H20.7502C19.4852 35.5209 18.4585 34.4942 18.4585 33.2292V21.7709C18.4585 20.5059 19.4852 19.4792 20.7502 19.4792H34.5002C35.7652 19.4792 36.7918 20.5059 36.7918 21.7709V33.2292C36.7918 34.4942 35.7652 35.5209 34.5002 35.5209Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.9707 25.0939L36.7915 29.8376",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.9711 25.0939L26.0669 30.2043",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M26.0665 30.2043L23.3853 28.4167",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M23.3856 28.4167L18.4585 32.5647",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle2,description:optimoleDashboardApp.strings.metrics.metricsSubtitle2,value:"saved\_size",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"56",height:"55",viewBox:"0 0 56 55",fill:"none"},(0,o.createElement)("path",{d:"M36.681 6.875H13.7643C8.70203 6.875 4.59766 10.9794 4.59766 16.0417C4.59766 21.104 8.70203 25.2083 13.7643 25.2083H36.681C41.7433 25.2083 45.8477 21.104 45.8477 16.0417C45.8477 10.9794 41.7433 6.875 36.681 6.875Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.7643 25.2084C8.70203 25.2084 4.59766 29.3127 4.59766 34.375C4.59766 39.4373 8.70203 43.5417 13.7643 43.5417H29.806",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9307 16.0416H36.6807",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.845 15.9606C13.8898 16.0053 13.8898 16.0779 13.845 16.1226C13.8003 16.1674 13.7277 16.1674 13.683 16.1226C13.6382 16.0779 13.6382 16.0053 13.683 15.9606C13.7277 15.9158 13.8003 15.9158 13.845 15.9606Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9307 34.375H27.7432",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M13.845 34.2938C13.8898 34.3386 13.8898 34.4111 13.845 34.4559C13.8003 34.5006 13.7277 34.5006 13.683 34.4559C13.6382 34.4111 13.6382 34.3386 13.683 34.2938C13.7277 34.2491 13.8003 34.2491 13.845 34.2938Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.9725 48.125C32.6452 48.125 27.5142 42.994 27.5142 36.6667C27.5142 30.3394 32.6452 25.2084 38.9725 25.2084C45.3021 25.2084 50.4308 30.3394 50.4308 36.6667C50.4308 42.994 45.3021 48.125 38.9725 48.125Z",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M40.2465 31.5745L36.4263 35.3924L41.5184 37.9407L37.6981 41.7586",stroke:"#577BF9","stroke-width":"1.875","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle3,description:optimoleDashboardApp.strings.metrics.metricsSubtitle3,value:"compression\_percentage",icon:()=>(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"55",height:"55",viewBox:"0 0 55 55",fill:"none"},(0,o.createElement)("path",{d:"M43.5418 32.0833C41.0095 32.0833 38.9585 30.0323 38.9585 27.5C38.9585 24.9677 41.0095 22.9166 43.5418 22.9166C46.0741 22.9166 48.1252 24.9677 48.1252 27.5C48.1252 30.0323 46.0741 32.0833 43.5418 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M32.0832 43.5417C32.0832 46.074 30.0321 48.1251 27.4998 48.1251C24.9675 48.1251 22.9165 46.074 22.9165 43.5417C22.9165 41.0094 24.9675 38.9584 27.4998 38.9584C30.0321 38.9584 32.0832 41.0094 32.0832 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M43.5418 48.1251C41.0095 48.1251 38.9585 46.074 38.9585 43.5417C38.9585 41.0094 41.0095 38.9584 43.5418 38.9584C46.0741 38.9584 48.1252 41.0094 48.1252 43.5417C48.1252 46.074 46.0741 48.1251 43.5418 48.1251Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M27.4998 16.0417C24.9675 16.0417 22.9165 13.9906 22.9165 11.4583C22.9165 8.92604 24.9675 6.875 27.4998 6.875C30.0321 6.875 32.0832 8.92604 32.0832 11.4583C32.0832 13.9906 30.0321 16.0417 27.4998 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M38.9585 11.4583C38.9585 8.92604 41.0095 6.875 43.5418 6.875C46.0741 6.875 48.1252 8.92604 48.1252 11.4583C48.1252 13.9906 46.0741 16.0417 43.5418 16.0417C41.0095 16.0417 38.9585 13.9906 38.9585 11.4583Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.7314 40.3104L40.3106 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M14.6895 40.3104L24.2686 30.7312",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M30.7314 24.2687L40.3106 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M22.9165 27.5C22.9165 24.9677 24.9675 22.9166 27.4998 22.9166C30.0321 22.9166 32.0832 24.9677 32.0832 27.5C32.0832 30.0323 30.0321 32.0833 27.4998 32.0833C24.9675 32.0833 22.9165 30.0323 22.9165 27.5Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M14.6895 24.2687L24.2686 14.6896",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M11.4583 32.0833C8.92604 32.0833 6.875 30.0323 6.875 27.5C6.875 24.9677 8.92604 22.9166 11.4583 22.9166C13.9906 22.9166 16.0417 24.9677 16.0417 27.5C16.0417 30.0323 13.9906 32.0833 11.4583 32.0833Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M16.0417 43.5417C16.0417 46.074 13.9906 48.1251 11.4583 48.1251C8.92604 48.1251 6.875 46.074 6.875 43.5417C6.875 41.0094 8.92604 38.9584 11.4583 38.9584C13.9906 38.9584 16.0417 41.0094 16.0417 43.5417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{d:"M11.4583 16.0417C8.92604 16.0417 6.875 13.9906 6.875 11.4583C6.875 8.92604 8.92604 6.875 11.4583 6.875C13.9906 6.875 16.0417 8.92604 16.0417 11.4583C16.0417 13.9906 13.9906 16.0417 11.4583 16.0417Z",stroke:"#577BF9","stroke-width":"1.97917","stroke-linecap":"round","stroke-linejoin":"round"}))},{label:optimoleDashboardApp.strings.metrics.metricsTitle4,description:optimoleDashboardApp.strings.metrics.metricsSubtitle4,value:"traffic",icon:()=>(0,o.createElement)("svg",{width:"55",height:"55",viewBox:"0 0 64 64",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false"},(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 28c0 2.947-4.178 5.333-9.333 5.333S5.334 30.944 5.334 28",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M23.997 36c0 2.947-4.178 5.333-9.333 5.333S5.334 38.944 5.334 36",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M50.667 56H40a5.332 5.332 0 01-5.333-5.333V13.333A5.332 5.332 0 0140 8h10.667A5.332 5.332 0 0156 13.333v37.334A5.332 5.332 0 0150.667 56z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667M24 32h10.667",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M24 32h10.667",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48M42.667 16H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 16H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48M42.667 26.667H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 26.667H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48M42.667 37.333H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 37.333H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48M42.667 48H48",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M42.667 48H48",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c0 2.947 4.179 5.333 9.334 5.333C19.82 25.333 24 22.947 24 20",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#EDF0FF","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,o.createElement)("path",{"data-v-767b24d4":"",d:"M5.333 20c.003-2.944 4.182-5.333 9.334-5.333 5.152 0 9.333 2.386 9.33 5.333v24c0 2.947-4.178 5.333-9.333 5.333S5.334 46.944 5.334 44V20v0z",stroke:"#577BF9","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}))}],Pe=()=>(0,o.createElement)("div",{className:"flex gap-2 bg-warning text-danger border border-solid border-danger rounded relative px-6 py-5 mb-5"},(0,o.createElement)(u.Icon,{icon:f}),(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_disabled\_account}})),Ve=()=>(0,o.createElement)("div",{className:"flex gap-2 bg-success text-white rounded relative px-6 py-5 mb-5"},(0,o.createElement)(u.Icon,{icon:"cloud-saved"}),(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.notice\_just\_activated}})),Ze=()=>{const{userData:e,userStatus:t}=(0,c.useSelect)((e=>{const{getUserData:t,getUserStatus:a}=e("optimole");return{userData:t(),userStatus:a()}})),a=(e.visitors/e.visitors\_limit\*100).toFixed(0);return(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},0<optimoleDashboardApp.strings.notice\_just\_activated.length&&"active"===t&&(0,o.createElement)(Ve,null),"inactive"===t&&(0,o.createElement)(Pe,null),(0,o.createElement)("div",{className:p()(He,"gap-8 flex-col sm:flex-row items-start sm:items-center")},(0,o.createElement)(u.Icon,{icon:\_}),(0,o.createElement)("div",{className:"flex w-full flex-col"},(0,o.createElement)("div",{className:"flex w-full justify-between"},(0,o.createElement)("div",{className:"text-gray-800 text-2xl font-bold"},e.visitors\_pretty," / ",e.visitors\_limit\_pretty,(0,o.createElement)("span",{className:"text-gray-600 text-base font-normal ml-2"},optimoleDashboardApp.strings.quota)),70>a&&(0,o.createElement)(u.Button,{variant:"default",className:"optml\_\_button rounded font-bold min-h-40",href:optimoleDashboardApp.optimoleDashBilling,target:"\_blank"},optimoleDashboardApp.strings.upgrade.title)),(0,o.createElement)("div",null,(0,o.createElement)(Le,{className:"mt-2.5 mb-3 mx-0",value:e.visitors,max:e.visitors\_limit}),(0,o.createElement)("div",{className:"optml\_\_tooltip",style:{left:a+"%",marginLeft:15>a?"-15px":"-20px",display:100<a?"none":"block"}},(0,o.createElement)("span",null,a,"%"))))),(0,o.createElement)("div",{className:"flex py-5 gap-5 flex-col md:flex-row"},Re.map((t=>(0,o.createElement)("div",{key:t.value,className:p()(He,"basis-1/4 flex-col items-start")},(0,o.createElement)(u.Icon,{icon:t.icon}),(0,o.createElement)("div",{className:"flex w-full flex-col"},(0,o.createElement)("div",{className:"not-italic font-bold text-xl py-2 text-gray-800"},(t=>{const a=(t=>void 0!==e[t]?e[t]:"saved\_size"===t?Math.floor(2500\*Math.random())+500:Math.floor(40\*Math.random())+10)(t);return"saved\_size"===t?(a/1e3).toFixed(2)+"MB":"compression\_percentage"===t?a.toFixed(2)+"%":"traffic"===t?a.toFixed(2)+"MB":a})(t.value)),(0,o.createElement)("div",{className:"not-italic font-normal text-sm text-gray-800"},t.label),(0,o.createElement)("div",{className:"font-normal text-xs text-gray-600"},t.description)))))),"yes"!==optimoleDashboardApp.remove\_latest\_images&&(0,o.createElement)(ze,null))},qe=({conflict:e})=>{const[t,a]=(0,s.useState)(!1);return(0,o.createElement)("div",{className:p()("flex gap-2 text-white rounded relative px-6 py-5 mb-5",{"bg-danger":"high"===e.severity,"bg-info":"medium"===e.severity,"bg-success":"high"!==e.severity&&"medium"!==e.severity})},(0,o.createElement)("p",{className:"m-0 text-white",dangerouslySetInnerHTML:{\_\_html:e.message}}),(0,o.createElement)(u.Button,{icon:t?g:"no-alt",label:optimoleDashboardApp.strings.conflicts.conflict\_close,disabled:t,className:p()("text-white hover:text-white",{"animate-spin":t}),onClick:()=>{a(!0),((e,t=(()=>{}))=>{M(!0),C()({path:optimoleDashboardApp.routes.dismiss\_conflict,method:"POST",data:{conflictID:e}}).then((e=>{M(!1),"success"===e.code&&P(e.data),t&&t(e)}))})(e.id,(()=>{a(!1)}))}}))},Ge=()=>{const{conflicts:e}=(0,c.useSelect)((e=>{const{getConflicts:t}=e("optimole");return{conflicts:t().conflicts||[]}}));return(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},Boolean(e.length)&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("p",null,optimoleDashboardApp.strings.conflicts.title),e.map((e=>(0,o.createElement)(qe,{key:e.id,conflict:e})))),!Boolean(e.length)&&(0,o.createElement)("div",{className:"text-center py-12"},(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.conflicts.no\_conflicts\_found}})))},$e=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),Ke=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),{strings:Ue}=optimoleDashboardApp,Ye=[{label:Ue.general\_settings\_menu\_item,value:"general"},{label:Ue.advanced\_settings\_menu\_item,value:"compression",children:[{label:Ue.settings\_compression\_menu\_item,value:"compression"},{label:Ue.settings\_resize\_menu\_item,value:"resize"},{label:Ue.lazyload\_settings\_menu\_item,value:"lazyload"},{label:Ue.settings\_exclusions\_menu\_item,value:"exclusions"}]},{label:Ue.cloud\_library,value:"cloud\_library"},{label:Ue.image\_storage,value:"offload\_media"}],Qe=({children:e,tab:t,settings:a,setTab:s})=>(0,o.createElement)("ul",{className:"flex flex-col gap-1 m-0 mt-1"},e.map((e=>{const{value:l,label:n}=e;if("lazyload"===e.value&&"disabled"===a.lazyload)return;const r=p()({"bg-light-blue hover:text-purple-gray":t===l,"bg-transparent hover:text-info":t!==l},"w-full text-left border-0 font-normal text-base text-purple-gray cursor-pointer rounded px-4 py-2 m-0 hover:text-info");return(0,o.createElement)("li",{key:l},(0,o.createElement)("button",{className:r,onClick:()=>s(l)},n))}))),We=({tab:e,settings:t,setTab:a})=>(0,o.createElement)("div",{className:"basis-1/5"},(0,o.createElement)("ul",{className:"grid m-0 gap-1"},Ye.map((s=>{const l=e===s.value||s.children&&s.children.some((t=>t.value===e)),n=p()({"!text-info":l},"w-full bg-transparent border-0 flex items-center appearance-none not-italic font-semibold text-base text-purple-gray cursor-pointer hover:text-info py-2");return(0,o.createElement)("li",{key:s.value,className:"m-0"},(0,o.createElement)("button",{className:n,onClick:()=>a(s.value)},s.label,s.children&&(0,o.createElement)(u.Icon,{icon:l?$e:Ke,className:"inline-block ml-2 fill-current"})),s.children&&l&&(0,o.createElement)(Qe,{children:s.children,tab:e,settings:t,setTab:a}))})))),Je=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,o.createElement)(m.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),Xe=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),et=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),tt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),at=(0,s.forwardRef)((function({icon:e,size:t=24,...a},o){return(0,s.cloneElement)(e,{width:t,height:t,...a,ref:o})})),ot=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}));function st({text:e,title:t,disableIcon:a=!1,type:s="info",className:l="",smallTitle:n=!1,children:r,onDismiss:i}){const c=p()({"bg-yellow-50 text-yellow-700":"warning"===s,"bg-green-50 text-green-700":"success"===s,"bg-red-50 text-red-700":"error"===s,"bg-blue-50 text-blue-700":"info"===s,"bg-info text-white":"primary"===s},`rounded-md my-5 text-sm p-4 om-notice om-notice-${s} relative`),d=p()({"fill-yellow-500":"warning"===s,"fill-green-500":"success"===s,"fill-red-500":"error"===s,"fill-blue-500":"info"===s,"fill-white":"primary"===s,"h-6 w-6":"primary"!==s,"h-12 w-12":"primary"===s}),m=p()({"ml-3 mt-0.5":!a&&!t,"mt-2 mx-1.5":t}),g=p()({"text-yellow-800":"warning"===s,"text-green-800":"success"===s,"text-red-800":"error"===s,"text-blue-800":"info"===s,"font-bold text-base":"primary"!==s,"text-white text-sm":"primary"===s,"text-s":n},"m-0"),u={warning:Je,success:Xe,error:et,info:tt,primary:v};return(0,o.createElement)("div",{className:c},i&&(0,o.createElement)("button",{className:"flex items-center justify-center absolute bg-transparent text-current right-1 top-1 border-0 rounded-full p-0 cursor-pointer hover:bg-white transition-all hover:text-info",onClick:i},(0,o.createElement)(at,{className:"fill-current",icon:ot})),(0,o.createElement)("div",{className:t?"grid":"flex"},(0,o.createElement)("div",{className:p()("flex-shrink-0 flex gap-2",{"items-center":t})},!a&&(0,o.createElement)(at,{icon:u[s]||null,className:d}),t&&(0,o.createElement)("div",{className:g,dangerouslySetInnerHTML:{\_\_html:t}})),r||e&&(0,o.createElement)("div",{className:m},e&&(0,o.createElement)("p",{className:"m-0",dangerouslySetInnerHTML:{\_\_html:e}}),r)))}const lt=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:s}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),l="disabled"!==e.image\_replacer,n="disabled"!==e.lazyload,r="disabled"!==e.report\_script,i="disabled"!==e.cdn,d="disabled"!==e.banner\_frontend,m=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_image\_replace,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.replacer\_desc}}),checked:l,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("image\_replacer",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_lazyload,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.lazyload\_desc}}),checked:n,disabled:!l||s,className:p()({"is-disabled":!l||s}),onChange:e=>m("lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_report\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_report\_desc}}),checked:r,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("report\_script",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_badge\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_badge\_description}}),checked:d,disabled:s,className:p()({"is-disabled":s}),onChange:e=>m("banner\_frontend",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.cache\_title,className:p()({"is-disabled":s||!l})},(0,o.createElement)("p",{className:"components-base-control\_\_help m-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cache\_desc}}),(0,o.createElement)("div",{className:"flex my-4 gap-3"},(0,o.createElement)(u.Button,{variant:"default",isBusy:s,disabled:s||!l,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>\_e()},optimoleDashboardApp.strings.options\_strings.clear\_cache\_images),i&&(0,o.createElement)(u.Button,{variant:"default",isBusy:s,disabled:s||!l,className:"optml\_\_button flex justify-center rounded font-bold min-h-40",onClick:()=>\_e("assets")},optimoleDashboardApp.strings.options\_strings.clear\_cache\_assets))),(0,o.createElement)(st,{type:"warning",text:optimoleDashboardApp.strings.options\_strings.clear\_cache\_notice,disableIcon:!0}))};var nt=a(864),rt=a.n(nt);const it=({settings:e,setSettings:t,setCanSave:a,showSample:s,isSampleLoading:l,setIsSampleLoading:n})=>{const{sampleImages:r,isLoading:i}=(0,c.useSelect)((e=>{const{getSampleRate:t,isLoading:a}=e("optimole");return{sampleImages:t(),isLoading:a()}})),d="disabled"!==e.network\_optimization,m="disabled"!==e.cdn,h="disabled"!==e.img\_to\_video,b="disabled"!==e.avif,\_="disabled"!==e.strip\_metadata,f="disabled"!==e.autoquality,E="disabled"!==e.best\_format,v=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},y=()=>r.optimized\_size>r.original\_size?Math.floor(60\*Math.random())+10:(100\*parseFloat(r.optimized\_size/r.original\_size)).toFixed(0);return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.best\_format\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.best\_format\_desc}}),checked:E,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("best\_format",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_network\_opt\_desc}}),checked:d,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("network\_optimization",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_cdn,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.cdn\_desc}}),checked:m,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("cdn",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_gif\_replace\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.gif\_replacer\_desc}}),checked:h,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("img\_to\_video",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_avif\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_avif\_desc}}),checked:b,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("avif",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.strip\_meta\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.strip\_meta\_desc}}),checked:\_,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("strip\_metadata",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{help:!f&&optimoleDashboardApp.strings.options\_strings.quality\_desc},(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.quality\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.ml\_quality\_desc}}),checked:f,disabled:i,className:p()({"is-disabled":i}),onChange:e=>v("autoquality",e)})),!f&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.RangeControl,{value:(w=e.quality,"number"==typeof w?w:"auto"===w||"high\_c"===w?90:"medium\_c"===w?75:"low\_c"===w?55:90),min:50,max:100,step:1,withInputField:!1,marks:[{value:55,label:optimoleDashboardApp.strings.options\_strings.low\_q\_title},{value:75,label:optimoleDashboardApp.strings.options\_strings.medium\_q\_title},{value:90,label:optimoleDashboardApp.strings.options\_strings.high\_q\_title}],onChange:o=>{a(!0);const s={...e};s.quality=o,t(s)}}),s&&(0,o.createElement)("div",{className:"flex justify-center w-full text-center"},l?(0,o.createElement)("div",{className:"flex items-center gap-5"},(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.sample\_image\_loading),(0,o.createElement)(u.Icon,{icon:g,className:"animate-spin"})):(0,o.createElement)(o.Fragment,null,r.id&&0<r.original\_size&&(0,o.createElement)("div",null,0<y()?(0,o.createElement)("p",{className:"text-base"},100-y(),"% ",optimoleDashboardApp.strings.latest\_images.smaller):(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.latest\_images.same\_size),(0,o.createElement)(Le,{max:100,value:100-y()}),(0,o.createElement)("hr",{className:"my-4 border-grayish-blue"}),(0,o.createElement)(rt(),{leftImageLabel:optimoleDashboardApp.strings.options\_strings.image\_1\_label,rightImageLabel:optimoleDashboardApp.strings.options\_strings.image\_2\_label,leftImage:r.original,rightImage:r.optimized}),(0,o.createElement)(u.Button,{variant:"default",icon:g,className:"mt-2",onClick:()=>{n(!0),fe({quality:e.quality,force:"yes"},(()=>n(!1)))}}),(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.quality\_slider\_desc)),!(r.id&&0<r.original\_size)&&0>r.id&&(0,o.createElement)("div",{className:"flex items-center gap-5 text-center"},(0,o.createElement)("p",{className:"text-base"},optimoleDashboardApp.strings.options\_strings.no\_images\_found))))));var w},ct=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[n,r]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),m="disabled"!==e.resize\_smart,g="disabled"!==e.retina\_images,h="disabled"!==e.limit\_dimensions,b=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},\_=(o,s)=>{a(!0);const l={...e};l[o]=s,t(l)},f=Object.keys(e.defined\_image\_sizes).filter((t=>"object"==typeof e.defined\_image\_sizes[t]));return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_resize\_smart\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("resize\_smart",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),"disabled"!==e.lazyload&&(0,o.createElement)(o.Fragment,null," ",(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_retina\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_retina\_desc}}),checked:g,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("retina\_images",e)})," ",(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"})," "),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_desc}}),checked:h,disabled:l,className:p()({"is-disabled":l}),onChange:e=>b("limit\_dimensions",e)}),h&&(0,o.createElement)(u.BaseControl,null,(0,o.createElement)("div",{className:"flex gap-8"},(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,labelPosition:"side",value:e.limit\_width,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>\_("limit\_width",e)}),(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,labelPosition:"side",value:e.limit\_height,type:"number",min:100,max:1e4,className:"basis-1/2 sm:basis-1/4",onChange:e=>\_("limit\_height",e)})),(0,o.createElement)(st,{disableIcon:!0,type:"warning",text:optimoleDashboardApp.strings.options\_strings.enable\_limit\_dimensions\_notice})),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.add\_image\_size\_desc},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.image\_size\_notice}}),(0,o.createElement)("div",{className:"flex flex-col sm:flex-row p-6 bg-light-blue border border-blue-300 rounded-md items-stretch sm:items-center gap-8"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.options\_strings.width\_field,placeholder:optimoleDashboardApp.strings.options\_strings.width\_field,hideLabelFromVision:!0,type:"number",min:1,value:n,onChange:r,className:"optml\_\_input sm:basis-2/5"}),(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.options\_strings.height\_field,placeholder:optimoleDashboardApp.strings.options\_strings.height\_field,value:i,onChange:d,hideLabelFromVision:!0,type:"number",min:1,className:"optml\_\_input sm:basis-2/5"}),(0,o.createElement)(u.Button,{variant:"primary",isBusy:l,disabled:l,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(!n||!i||isNaN(n)||isNaN(i))return;const o="optimole\_"+n+"\_"+i+"\_crop",s={...e.defined\_image\_sizes,[o]:{width:n,height:i}};a(!0);const l={...e};l.defined\_image\_sizes=s,t(l),r(""),d("")}},optimoleDashboardApp.strings.options\_strings.add\_image\_size\_button))),0<f.length&&(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.image\_sizes\_title,className:"pt-4"},f.map((s=>(0,o.createElement)("div",{key:s,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex flex-wrap items-center gap-2"},(0,o.createElement)("div",null,(0,o.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.name}})," ",s),(0,o.createElement)("p",{className:"m-0"},(0,o.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.width\_field),": ",e.defined\_image\_sizes[s].width),(0,o.createElement)("p",{className:"m-0"},(0,o.createElement)("b",null,optimoleDashboardApp.strings.options\_strings.height\_field),": ",e.defined\_image\_sizes[s].height)),(0,o.createElement)(u.Button,{variant:"default",icon:"trash",disabled:l,onClick:()=>(o=>{const s={...e.defined\_image\_sizes,[o]:"remove"};a(!0);const l={...e};l.defined\_image\_sizes=s,t(l)})(s)}))))))},dt=({settings:e,setSettings:t,setCanSave:a})=>{const{isLoading:l}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),n="disabled"!==e.lazyload\_placeholder,r="disabled"!==e.native\_lazyload,i="disabled"===e.scale,d="disabled"!==e.bg\_replacer,m="disabled"!==e.video\_lazyload,g="disabled"!==e.no\_script,h=e.placeholder\_color,[b,\_]=(0,s.useState)(!1),f=(o,s)=>{a(!0);const l={...e};l[o]=s?"enabled":"disabled",t(l)},E=(o,s)=>{a(!0);const l={...e};l[o]=s,t(l)},v=e=>{E("placeholder\_color",e)};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.BaseControl,null,(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_lazyload\_placeholder\_desc}}),checked:n,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("lazyload\_placeholder",e)}),n&&(0,o.createElement)("div",{className:"relative inline-block"},(0,o.createElement)(u.Button,{disabled:l,className:"gap-3 mt-2 py-3 h-auto rounded text-inherit border-gray-400 border-2 border-solid font-medium",onClick:()=>{\_(!b)}},(0,o.createElement)(u.ColorIndicator,{colorValue:h}),(0,o.createElement)("span",null,optimoleDashboardApp.strings.options\_strings.lazyload\_placeholder\_color)),b&&(0,o.createElement)(u.Popover,{placement:"bottom",position:"middle center",variant:"unstyled",className:"shadow-md border-grayish-blue border border-solid rounded bg-white p-2",onFocusOutside:()=>\_(!1)},(0,o.createElement)(u.ColorPicker,{color:h,onChange:v,enableAlpha:!0,defaultValue:""}),(0,o.createElement)(u.Button,{isDestructive:!0,className:"w-full text-center flex justify-center",variant:"secondary",onClick:()=>{v("")}},optimoleDashboardApp.strings.options\_strings.clear)))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_title},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.exclude\_first\_images\_desc}}),(0,o.createElement)("div",{className:"flex gap-8"},(0,o.createElement)(u.\_\_experimentalNumberControl,{label:optimoleDashboardApp.strings.options\_strings.exclude\_first,labelPosition:"side",value:e.skip\_lazyload\_images,type:"number",min:0,className:"basis-1/2 md:basis-1/3",onChange:e=>E("skip\_lazyload\_images",e)}))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_native,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.native\_desc}}),checked:r,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("native\_lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.toggle\_scale,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.scale\_desc}}),checked:i,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("scale",!e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_video\_lazyload\_desc}}),checked:m,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("video\_lazyload",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_noscript\_desc}}),checked:g,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("no\_script",e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.ToggleControl,{label:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.enable\_bg\_lazyload\_desc}}),checked:d,disabled:l,className:p()({"is-disabled":l}),onChange:e=>f("bg\_replacer",e)}),d&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(u.BaseControl,{label:optimoleDashboardApp.strings.options\_strings.watch\_title\_lazyload,id:"optml-css-watchers"},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.options\_strings.watch\_desc\_lazyload}}),(0,o.createElement)(u.TextareaControl,{id:"optml-css-watchers",placeholder:optimoleDashboardApp.strings.options\_strings.watch\_placeholder\_lazyload,value:e.watchers,onChange:e=>E("watchers",e)}))))},pt="extension",mt="page\_url",gt="page\_url\_match",ut="filename",ht="class",bt=[{label:optimoleDashboardApp.strings.options\_strings.filter\_filename,value:ut},{label:optimoleDashboardApp.strings.options\_strings.filter\_ext,value:pt},{label:optimoleDashboardApp.strings.options\_strings.filter\_url,value:mt},{label:optimoleDashboardApp.strings.options\_strings.filter\_class,value:ht}],\_t=[{label:optimoleDashboardApp.strings.options\_strings.exclude\_filename\_desc,value:ut},{label:optimoleDashboardApp.strings.options\_strings.exclude\_ext\_desc,value:pt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_desc,value:mt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_url\_match\_desc,value:gt},{label:optimoleDashboardApp.strings.options\_strings.exclude\_class\_desc,value:ht}],ft=[{label:".SVG",value:"svg"},{label:".JPG",value:"jpg"},{label:".PNG",value:"png"},{label:".GIF",value:"gif"},{label:".WEBP",value:"webp"}],Et=({label:e,help:t,type:a,settings:l,setSettings:n,setCanSave:r})=>{const{isLoading:i}=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}})),[d,p]=(0,s.useState)(ut),[m,g]=(0,s.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[h,b]=(0,s.useState)(""),[\_,f]=(0,s.useState)(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),[E,v]=(0,s.useState)(!1),y=0<Object.keys(l.filters[a][pt]).length&&Object.values(l.filters[a][pt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][ht]).length&&Object.values(l.filters[a][ht]).some((e=>!1!==e))||0<Object.keys(l.filters[a][mt]).length&&Object.values(l.filters[a][mt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][gt]).length&&Object.values(l.filters[a][gt]).some((e=>!1!==e))||0<Object.keys(l.filters[a][ut]).length&&Object.values(l.filters[a][ut]).some((e=>!1!==e));return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.BaseControl,{label:e,help:d===mt&&optimoleDashboardApp.strings.options\_strings.filter\_helper},(0,o.createElement)("p",{className:"components-base-control\_\_help mt-0",dangerouslySetInnerHTML:{\_\_html:t}}),(0,o.createElement)("div",{className:"flex flex-col md:flex-row p-6 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex justify-start items-center gap-4"},(0,o.createElement)(u.SelectControl,{value:d,options:bt,onChange:e=>{let t="";e===pt&&(t="svg",g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_is)),e===ut&&g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),e===ht&&g(optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains),v(!1),b(t),p(e)},className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}),d===mt?(0,o.createElement)(u.SelectControl,{value:\_,options:[{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_contains},{label:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches,value:optimoleDashboardApp.strings.options\_strings.filter\_operator\_matches}],onChange:f,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,o.createElement)("p",{className:"m-0"},m),d===pt?(0,o.createElement)(u.SelectControl,{value:h,options:ft,onChange:b,className:"optml\_\_select",\_\_nextHasNoMarginBottom:!0}):(0,o.createElement)(u.TextControl,{value:h,placeholder:"matches"===\_?"path":"word",onChange:e=>{b(e),v(!1)},className:"optml\_\_input"})),(0,o.createElement)(u.Button,{variant:"primary",isBusy:i,disabled:i,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:()=>{if(3>h.length)return void v(!0);const e={...l.filters};let t=d;d===mt&&"matches"===\_&&(t=gt),e[a]&&"object"==typeof e[a]||(e[a]={}),e[a][t]&&!Array.isArray(e[a][t])||(e[a][t]={}),e[a][t][h]=!0,n({...l,filters:e}),d!==pt&&b(""),r(!0)}},optimoleDashboardApp.strings.options\_strings.add\_filter)),E&&(0,o.createElement)("p",{className:"text-red-500 bg-red-100 p-2 rounded-md border border-solid border-red-200"},optimoleDashboardApp.strings.options\_strings.filter\_length\_error)),y&&(0,o.createElement)(u.BaseControl,{label:"optimize"===a?optimoleDashboardApp.strings.options\_strings.active\_optimize\_exclusions:optimoleDashboardApp.strings.options\_strings.active\_lazyload\_exclusions,className:"py-4"},\_t.map((e=>Object.keys(l.filters[a][e.value]).filter((t=>!1!==l.filters[a][e.value][t])).map((t=>(0,o.createElement)("div",{key:t,className:"flex p-3 my-3 bg-light-blue border border-blue-300 rounded-md items-center justify-between gap-8"},(0,o.createElement)("div",{className:"flex items-center gap-1"},(0,o.createElement)("p",{className:"m-0 inline-block",dangerouslySetInnerHTML:{\_\_html:e.label}}),(0,o.createElement)("b",null,t)),(0,o.createElement)(u.Button,{variant:"default",icon:"trash",disabled:i,onClick:()=>((e,t)=>{const o={...l.filters};o[a][e][t]=!1,n({...l,filters:o}),r(!0)})(e.value,t)}))))))))},vt=({settings:e,setSettings:t,setCanSave:a})=>{const s="disabled"!==e.lazyload;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(Et,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_optimize,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_optimize,type:"optimize",settings:e,setSettings:t,setCanSave:a}),s&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)(Et,{label:optimoleDashboardApp.strings.options\_strings.exclude\_title\_lazyload,help:optimoleDashboardApp.strings.options\_strings.exclude\_desc\_lazyload,type:"lazyload",settings:e,setSettings:t,setCanSave:a})))};function yt({options:e,value:t,onChange:a,label:s,disabled:l=!1,className:n}){return p()({"opacity-50":l},"transition-all my-6 gap-6 grid opacity-100"),(0,o.createElement)("fieldset",{className:`my-6 gap-6 grid ${n}`,onChange:e=>{a(e.target.value)}},s&&(0,o.createElement)("legend",{className:"uppercase font-semibold text-s text-light-black mb-6"},s),e.map(((e,a)=>{const{title:s,value:n,description:r}=e,i=t===n,c=p()({"outline-info":i,"outline-transparent":!i},"flex gap-6 items-start bg-gray-50 rounded-md p-4 outline -outline-offset-3 outline-3 transition-all");return(0,o.createElement)("label",{htmlFor:n,key:n,className:c},(0,o.createElement)(wt,{isActive:i}),(0,o.createElement)("div",{className:"grid space-y-2"},s&&(0,o.createElement)("div",{className:"text-base font-medium text-gray-700"},s),r&&(0,o.createElement)("div",{className:"text-sm text-gray-500"},r)),(0,o.createElement)("input",{type:"radio",name:"label",value:n,id:n,className:"!opacity-0 !w-0 !h-0 !overflow-hidden !absolute !pointer-events-none",disabled:l}))})))}const wt=({isActive:e})=>{const t=p()({"bg-white outline-info":e,"bg-gray-200 outline-transparent":!e},"w-[24px] h-[24px] rounded-full flex items-center justify-center flex-shrink-0 outline outline-3 -outline-offset-3 transition-all"),a=p()({"bg-info":e},"w-[12px] h-[12px] rounded-full background-info transition-all");return(0,o.createElement)("div",{className:t},e&&(0,o.createElement)("div",{className:a}))};function kt({title:e,progress:t,description:a,onCancel:s,hideCancel:l=!1}){const{strings:n}=optimoleDashboardApp;return(0,o.createElement)("div",{className:"bg-gray-50 rounded-md p-4 space-y-4"},(0,o.createElement)("div",{className:"flex gap-3 items-center"},(0,o.createElement)(at,{icon:E,className:"text-info animate-spin -scale-y-100"}),e&&(0,o.createElement)("p",{className:"uppercase text-s font-semibold text-light-black m-0"},e),!l&&(0,o.createElement)("button",{onClick:s,className:"appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-s hover:border-red-500 hover:bg-red-500 hover:text-white cursor-pointer"},n.cancel)),(0,o.createElement)(Le,{value:t}),a&&(0,o.createElement)("p",{className:"text-xs text-gray-500"},a))}const xt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),Ct=window.wp.compose;function St({icon:e,labels:t={},onRequestClose:a=(()=>{}),onConfirm:s=(()=>{}),variant:l="default"}){const n=(0,Ct.useViewportMatch)("small","<"),r=p()({"bg-stale-yellow":"warning"===l,"bg-light-blue":"default"===l},"p-3 rounded-full"),i=p()({"bg-mango-yellow":"warning"===l},"optml\_\_button flex justify-center px-5 py-3 rounded font-bold min-h-40 basis-1/5");return(0,o.createElement)(u.Modal,{\_\_experimentalHideHeader:!0,className:"max-w-xl antialiased",onRequestClose:a,isFullScreen:n},(0,o.createElement)(u.Button,{icon:xt,onClick:a,label:optimoleDashboardApp.strings.csat.close,className:"fixed right-3 top-3 cursor-pointer"}),(0,o.createElement)("div",{className:"flex flex-col items-center"},(0,o.createElement)(u.Icon,{icon:e,size:24,className:r}),(0,o.createElement)("h2",{className:"mb-0",dangerouslySetInnerHTML:{\_\_html:t.title}}),(0,o.createElement)("p",{className:"text-center mx-0 my-4 text-gray-700",dangerouslySetInnerHTML:{\_\_html:t.description}}),(0,o.createElement)(u.Button,{variant:"primary",className:i,onClick:s},t.action)))}const At=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M12.5 5L10 19h1.9l2.5-14z"})),Dt=({type:e})=>{const{logs:t}=(0,c.useSelect)((e=>{const{getLogs:t}=e("optimole");return{logs:t()}})),[a,l]=(0,s.useState)(!1),n=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const a=setInterval((()=>{n.current&&(n.current.innerHTML=t[e],n.current.scrollTop=n.current.scrollHeight)}),15e3);return()=>clearInterval(a)}),[]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"w-full flex justify-end text-info my-2"},(0,o.createElement)(u.Button,{variant:"tertiary",className:"py-2 px-0",target:"\_blank",href:`${window.ajaxurl}?action=optml\_fetch\_logs&nonce=${optimoleDashboardApp.nonce}&type=${e}`},optimoleDashboardApp.strings.options\_strings.view\_logs),(0,o.createElement)(u.Icon,{icon:At,className:"fill-info py-2"}),(0,o.createElement)(u.Button,{variant:"tertiary",className:"py-2 px-0",onClick:()=>l(!a)},a?optimoleDashboardApp.strings.options\_strings.hide\_logs:optimoleDashboardApp.strings.options\_strings.show\_logs)),a&&(0,o.createElement)("div",{className:"flex flex-col p-6 bg-light-blue border border-blue-300 rounded-md min-h-[200px] max-h-[200px] overflow-y-scroll",ref:n,dangerouslySetInnerHTML:{\_\_html:t[e]}}))},Lt=({settings:e,canSave:t,setSettings:a,setCanSave:l})=>{const{strings:n,cron\_disabled:r}=optimoleDashboardApp,{conflicts:i,options\_strings:d}=n,m="offload",g="rollback",u="stopOffload",h="stopRollback",{offloadConflicts:b,errorMedia:\_,offloadLibraryLink:f,isLoading:v,loadingSync:x,loadingRollback:C,rollbackLibraryLink:S,queryArgs:A,totalNumberOfImages:D,processedImages:L,offloadFinishNotice:N,offloadLimitReached:T,offloadLimit:M}=(0,c.useSelect)((e=>{const{getOffloadConflicts:t,getErrorMedia:a,getLoadingSync:o,getLoadingRollback:s,getOffloadLibraryLink:l,getRollbackLibraryLink:n,getTotalNumberOfImages:r,getProcessedImages:i,getQueryArgs:c,isLoading:d,getSiteSettings:p,getOffloadLimit:m}=e("optimole");return{offloadConflicts:t(),errorMedia:a(),offloadLibraryLink:l(),isLoading:d(),loadingSync:o(),loadingRollback:s(),rollbackLibraryLink:n(),queryArgs:c(),totalNumberOfImages:r(),processedImages:i(),offloadFinishNotice:p("show\_offload\_finish\_notice"),offloadLimitReached:"enabled"===p("offload\_limit\_reached"),offloadLimit:m()}}),[]),{setErrorMedia:I,setCheckedOffloadConflicts:O,setOffloadConflicts:j,setProcessedImages:F,setOffloadLimitReached:B}=(0,c.useDispatch)("optimole"),[z,H]=(0,s.useState)(null),R="disabled"!==e.offloading\_status,P="disabled"!==e.rollback\_status;(0,s.useEffect)((()=>{A?.optimole\_action&&A?.images&&("offload\_images"===A.optimole\_action&&V(A.images),"rollback\_images"===A.optimole\_action&&Z(A.images))}),[]),(0,s.useEffect)((()=>{R&&ve({action:"offload\_images",refresh:!0}),P&&ve({action:"rollback\_images",refresh:!0})}),[]);const V=(t=[])=>{const o={...e};o.show\_offload\_finish\_notice="",o.offloading\_status="enabled",a(o),be(o,!1,!0,(()=>{I(!1),F(0),B(!1),ve({action:"offload\_images",images:t}),l(!1)}))},Z=(t=[])=>{O(!1),j([]),Ee((a=>{if(0===a.data.length){const a={...e};a.show\_offload\_finish\_notice="",a.rollback\_status="enabled",be(a,!1,!0,(()=>{I(!1),F(0),ve({action:"rollback\_images",images:t}),l(!1)}))}}))},q=[{title:d.offload\_radio\_option\_rollback\_title,description:d.offload\_radio\_option\_rollback\_desc,value:"rollback"},{title:d.offload\_radio\_option\_offload\_title,description:d.offload\_radio\_option\_offload\_desc,value:"offload"}],G="enabled"===e.offload\_media?"offload":"rollback",$=x||C;return(0,o.createElement)("div",null,(0,o.createElement)("h1",{className:"text-xl font-bold"},d.enable\_offload\_media\_title),(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:d.enable\_offload\_media\_desc}}),N&&(0,o.createElement)(st,{title:"offload"===N?d.offloading\_success:d.rollback\_success,type:"primary",onDismiss:()=>{be({show\_offload\_finish\_notice:""},!1,!0)}}),r&&(0,o.createElement)(st,{type:"error",text:n.cron\_error}),!$&&(0,o.createElement)(yt,{className:p()({"opacity-50 pointer-events-none":v||r}),label:d.offloading\_radio\_legend,options:q,value:G,onChange:t=>{const o="offload"===t,s={...e};s.offload\_media=o?"enabled":"disabled",a(s),l(!0),H(o?m:g)}}),$&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(kt,{title:x?d.sync\_media\_progress:d.rollback\_media\_progress,progress:Math.round(L/D\*100),onCancel:()=>{x&&H(u),C&&H(h)},description:0===D?d.calculating\_estimated\_time:d.images\_processing}),(0,o.createElement)(Dt,{type:x?"offload":"rollback"})),"offload\_images"===\_&&(0,o.createElement)(st,{type:"error",smallTitle:!0,title:d.sync\_media\_error,text:d.sync\_media\_error\_desc}),"rollback\_images"===\_&&(0,o.createElement)(st,{type:"error",smallTitle:!0,title:d.rollback\_media\_error,text:d.rollback\_media\_error\_desc}),0<b.length&&(0,o.createElement)(st,{type:"warning",title:d.offload\_conflicts\_part\_1},(0,o.createElement)("div",{className:"list-disc grid gap-3 mt-2"},(0,o.createElement)("ul",{className:"grid gap-1"},b.map((e=>(0,o.createElement)("li",{key:e,className:"font-semibold text-base m-0"},e)))),(0,o.createElement)("p",{className:"m-0 text-sm"},d.offload\_conflicts\_part\_2),(0,o.createElement)("button",{disabled:v,className:p()({"opacity-50 pointer-events-none":v},"justify-self-start font-semibold flex items-center appearance-none border border-info text-info bg-white rounded px-4 py-2 text-sm hover:text-white hover:bg-info cursor-pointer"),onClick:()=>j([])},i.conflict\_close))),!$&&(0,o.createElement)("button",{onClick:e=>{e.preventDefault(),"offload"===G&&H(m),"rollback"===G&&H(g)},disabled:v||r,className:p()({"opacity-50 pointer-events-none":v||r},"font-semibold flex items-center gap-2 appearance-none border border-info text-info bg-transparent rounded px-4 py-2 ml-auto text-sm hover:text-white hover:bg-info cursor-pointer")},(0,o.createElement)(at,{icon:E,className:"w-4 h-4"}),(0,o.createElement)("span",null,d.sync\_media)),!$&&T&&(0,o.createElement)(st,{type:"warning",text:d.offload\_limit\_reached.replace("#offload\_limit#",M)}),z&&(0,o.createElement)(St,{...(K=z,{onRequestClose:()=>H(null),...{[m]:{icon:y,onConfirm:()=>{V(),H(null)},labels:{title:d.offloading\_start\_title,description:d.offloading\_start\_description,action:d.offloading\_start\_action}},[g]:{icon:w,onConfirm:()=>{Z(),H(null)},labels:{title:d.rollback\_start\_title,description:d.rollback\_start\_description,action:d.rollback\_start\_action}},[u]:{variant:"warning",icon:k,onConfirm:()=>{H(null);const t=e;t.offloading\_status="disabled",be(t)},labels:{title:d.offloading\_stop\_title,description:d.offloading\_stop\_description,action:d.offloading\_stop\_action}},[h]:{variant:"warning",icon:k,onConfirm:()=>{H(null);const t=e;t.rollback\_status="disabled",be(t)},labels:{title:d.rollback\_stop\_title,description:d.rollback\_stop\_description,action:d.rollback\_stop\_action}}}[K]})}),f&&(0,o.createElement)("p",{className:"m-0"},d.sync\_media\_link," ",(0,o.createElement)("a",{href:A.url},d.here)),S&&(0,o.createElement)("p",{className:"m-0"},d.rollback\_media\_link," ",(0,o.createElement)("a",{href:A.url},optimoleDashboardApp.strings.options\_strings.here)));var K};function Nt(e){const{user\_data:t,strings:a}=optimoleDashboardApp,{options\_strings:s}=a,{settings:l,setSettings:n,setCanSave:r}=e,i=(0,c.useSelect)((e=>{const{isLoading:t}=e("optimole");return{isLoading:t()}}),[]),{isLoading:d}=i,m="disabled"!==l.cloud\_images,g=t.whitelist||[];return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u.ToggleControl,{label:s.enable\_cloud\_images\_title,help:()=>(0,o.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:s.enable\_cloud\_images\_desc}}),checked:m,disabled:d,className:p()({"is-disabled":d}),onChange:e=>((e,t)=>{r(!0);const a={...l};a.cloud\_images=t?"enabled":"disabled",n(a)})(0,e)}),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),m&&(0,o.createElement)(u.BaseControl,{label:s.cloud\_site\_title,help:s.cloud\_site\_desc},(0,o.createElement)("div",{className:"optml\_\_token\_\_base flex p-6 bg-light-blue border border-blue-300 rounded-md items-center gap-8"},(0,o.createElement)(u.FormTokenField,{value:Object.keys(l.cloud\_sites).filter((e=>"all"!==e&&"false"!==l.cloud\_sites[e])).map((e=>e))||[],suggestions:g,onChange:e=>{r(!0);const t={},a={...l};0===e.length?t.all="true":e.forEach((e=>{t[e]="true"})),Object.keys(a.cloud\_sites).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)||(t[e]="false")})),a.cloud\_sites=t,n(a)},\_\_experimentalExpandOnFocus:!0,\_\_experimentalShowHowTo:!1,\_\_experimentalValidateInput:e=>g.includes(e),className:"optml\_\_token"}))))}const Tt=({tab:e,setTab:t,canSave:a,setCanSave:l,settings:n,setSettings:r})=>{const{siteSettings:i,isLoading:d,damEnabled:p}=(0,c.useSelect)((e=>{const{getSiteSettings:t,getQueryArgs:a,isLoading:o}=e("optimole"),s=t();return{siteSettings:s,damEnabled:s.cloud\_images,isLoading:o(),queryArgs:a()}}),[]),[m,g]=(0,s.useState)(!1),[h,b]=(0,s.useState)(!1);(0,s.useEffect)((()=>{((e=!0)=>{const{dam\_url:t,strings:a}=window.optimoleDashboardApp,{cloud\_library:o}=a,s=document.querySelector('a[href\*="page=optimole-dam"]');if(!e&&!s)return;if(!e){if(!s)return;return void(s.style.display="none")}if(s)return void(s.style={});const l=document.createElement("li"),n=document.createElement("a");l.appendChild(n),n.href=t,n.innerHTML=o;const r=document.querySelector("#toplevel\_page\_optimole ul");r&&r.insertBefore(l,r.firstChild)})("enabled"===p)}),[p]),(0,s.useEffect)((()=>{const e=localStorage.getItem("optimole\_settings\_visits");3<e||localStorage.setItem("optimole\_settings\_visits",e?parseInt(e)+1:1)}),[e]);const \_=()=>{be(n,i.banner\_frontend!==n.banner\_frontend),l(!1)};return(0,o.createElement)("div",{className:"optml-settings flex flex-col sm:flex-row bg-white p-8 border-0 rounded-lg shadow-md gap-8"},(0,o.createElement)(We,{tab:e,setTab:t,settings:n}),(0,o.createElement)("div",{className:"basis-4/5"},"general"===e&&(0,o.createElement)(lt,{settings:n,setSettings:r,setCanSave:l}),"compression"===e&&(0,o.createElement)(it,{settings:n,setSettings:r,setCanSave:l,showSample:m,isSampleLoading:h,setIsSampleLoading:b}),"resize"===e&&(0,o.createElement)(ct,{settings:n,setSettings:r,setCanSave:l}),"lazyload"===e&&(0,o.createElement)(dt,{settings:n,setSettings:r,setCanSave:l}),"exclusions"===e&&(0,o.createElement)(vt,{settings:n,setSettings:r,setCanSave:l}),"cloud\_library"===e&&(0,o.createElement)(Nt,{settings:n,canSave:a,setSettings:r,setCanSave:l,onSaveSettings:\_}),"offload\_media"===e&&(0,o.createElement)(Lt,{settings:n,canSave:a,setSettings:r,setCanSave:l,onSaveSettings:\_}),(0,o.createElement)("div",{className:"flex justify-start items-center gap-5 mt-8"},(0,o.createElement)(u.Button,{variant:"primary",isBusy:d,disabled:!a,className:"optml\_\_button flex w-full justify-center rounded font-bold min-h-40 basis-1/5",onClick:\_},optimoleDashboardApp.strings.options\_strings.save\_changes),"disabled"===n.autoquality&&"compression"===e&&(0,o.createElement)(u.Button,{variant:"default",disabled:d,onClick:()=>{m||(b(!0),fe({quality:n.quality},(()=>b(!1)))),g(!m)}},optimoleDashboardApp.strings.options\_strings.view\_sample\_image))))},Mt=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),It=(0,o.createElement)(m.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(m.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M6.68822 16.625L5.5 17.8145L5.5 5.5L18.5 5.5L18.5 16.625L6.68822 16.625ZM7.31 18.125L19 18.125C19.5523 18.125 20 17.6773 20 17.125L20 5C20 4.44772 19.5523 4 19 4H5C4.44772 4 4 4.44772 4 5V19.5247C4 19.8173 4.16123 20.086 4.41935 20.2237C4.72711 20.3878 5.10601 20.3313 5.35252 20.0845L7.31 18.125ZM16 9.99997H8V8.49997H16V9.99997ZM8 14H13V12.5H8V14Z"})),Ot=(0,o.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(m.Path,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),jt=[{title:optimoleDashboardApp.strings.help.get\_support\_title,description:optimoleDashboardApp.strings.help.get\_support\_desc,cta:optimoleDashboardApp.strings.help.get\_support\_cta,link:"https://wordpress.org/support/plugin/optimole-wp/",icon:Mt},{title:optimoleDashboardApp.strings.help.feat\_request\_title,description:optimoleDashboardApp.strings.help.feat\_request\_desc,cta:optimoleDashboardApp.strings.help.feat\_request\_cta,link:"https://github.com/Codeinwp/optimole-wp/discussions",icon:It},{title:optimoleDashboardApp.strings.help.feedback\_title,description:optimoleDashboardApp.strings.help.feedback\_desc,cta:optimoleDashboardApp.strings.help.feedback\_cta,link:"https://wordpress.org/plugins/optimole-wp/#developers",icon:Ot}],Ft=[{title:optimoleDashboardApp.strings.help.account\_title,items:[{label:optimoleDashboardApp.strings.help.account\_item\_one,value:"https://docs.optimole.com/article/1134-how-optimole-counts-the-number-of-visitors"},{label:optimoleDashboardApp.strings.help.account\_item\_two,value:"https://docs.optimole.com/article/1008-what-happens-if-i-exceed-plan-limits"},{label:optimoleDashboardApp.strings.help.account\_item\_three,value:"https://docs.optimole.com/article/1133-visitors-based-plan"}]},{title:optimoleDashboardApp.strings.help.image\_processing\_title,items:[{label:optimoleDashboardApp.strings.help.image\_processing\_item\_one,value:"https://docs.optimole.com/article/1173-how-to-get-started-with-optimole-in-just-3-steps"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_two,value:"https://docs.optimole.com/article/1068-how-optimole-can-serve-webp-images"},{label:optimoleDashboardApp.strings.help.image\_processing\_item\_three,value:"https://docs.optimole.com/article/1475-adding-watermarks-to-your-images"}]},{title:optimoleDashboardApp.strings.help.api\_title,items:[{label:optimoleDashboardApp.strings.help.api\_item\_one,value:"https://docs.optimole.com/article/1323-cloud-library-browsing"},{label:optimoleDashboardApp.strings.help.api\_item\_two,value:"https://docs.optimole.com/article/1191-exclude-from-optimizing-or-lazy-loading"},{label:optimoleDashboardApp.strings.help.api\_item\_three,value:"https://docs.optimole.com/article/1307-custom-integration"}]}],Bt="flex p-6 border-2 border-solid border-grayish-blue rounded-md items-start gap-8 basis-1/3",zt=()=>(0,o.createElement)("div",{className:"bg-white p-8 border-0 rounded-lg shadow-md"},(0,o.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_one\_title),(0,o.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},jt.map(((e,t)=>(0,o.createElement)("div",{key:t,className:Bt},(0,o.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,o.createElement)(u.Icon,{icon:e.icon,className:"fill-info",size:42}),(0,o.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),(0,o.createElement)("div",{className:"not-italic font-normal text-s text-gray-800"},e.description),(0,o.createElement)(u.ExternalLink,{href:e.link},e.cta)))))),(0,o.createElement)("hr",{className:"my-8 border-grayish-blue"}),(0,o.createElement)("div",{className:"flex items-center justify-between"},(0,o.createElement)("p",{className:"font-bold text-base"},optimoleDashboardApp.strings.help.section\_two\_title),(0,o.createElement)(u.ExternalLink,{href:"https://docs.optimole.com/"},optimoleDashboardApp.strings.help.section\_two\_sub)),(0,o.createElement)("div",{className:"flex gap-5 flex-col md:flex-row"},Ft.map(((e,t)=>(0,o.createElement)("div",{key:t,className:Bt},(0,o.createElement)("div",{className:"flex w-full flex-col gap-2"},(0,o.createElement)("div",{className:"font-bold text-base py-2 text-gray-800"},e.title),e.items.map(((e,t)=>(0,o.createElement)("a",{key:t,href:e.value,target:"\_blank"},e.label))))))))),Ht=[optimoleDashboardApp.strings.upgrade.reason\_1,optimoleDashboardApp.strings.upgrade.reason\_2,optimoleDashboardApp.strings.upgrade.reason\_3,optimoleDashboardApp.strings.upgrade.reason\_4],Rt=()=>{const{name:e,domain:t,plan:a}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole"),a=t();let o=a?.cdn\_key+".i.optimole.com";return void 0!==a?.domain&&""!==a?.domain&&(o=a?.domain),{name:a?.display\_name,domain:o,plan:a?.plan}}));return(0,o.createElement)("div",{className:"flex flex-col mt-8 mb-5 p-0 transition-all ease-in-out duration-700 gap-5 basis-3/12"},(0,o.createElement)("div",{className:"bg-white gap-5 flex flex-col text-gray-700 border-0 rounded-lg shadow-md p-8"},(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.logged\_in\_as,value:e,className:"optml\_\_placeholder",disabled:!0}),(0,o.createElement)(u.TextControl,{label:optimoleDashboardApp.strings.private\_cdn\_url,value:t,className:"optml\_\_placeholder",disabled:!0}),(0,o.createElement)("hr",{className:"m-0 border-grayish-blue"}),(0,o.createElement)("p",{className:"font-semibold text-xs text-light-black m-0"},optimoleDashboardApp.strings.looking\_for\_api\_key),(0,o.createElement)("p",{className:"m-0 -mt-3",dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.optml\_dashboard}})),"free"===a?(0,o.createElement)("div",{className:"bg-info flex flex-col text-white border-0 rounded-lg shadow-md p-8 bg-promo bg-no-repeat",style:{backgroundImage:`url( ${optimoleDashboardApp.assets\_url}/img/logo2.png )`}},(0,o.createElement)("h3",{className:"mt-0 text-white text-lg"},optimoleDashboardApp.strings.upgrade.title\_long),(0,o.createElement)("ul",null,Ht.map(((e,t)=>(0,o.createElement)("li",{key:t,className:"flex items-center gap-2"},(0,o.createElement)(u.Icon,{icon:"yes-alt",className:"text-white"}),(0,o.createElement)("span",{className:"text-white font-normal text-base"},e))))),(0,o.createElement)(u.Button,{variant:"link",className:"optml\_\_button flex w-full justify-center font-bold min-h-40 !no-underline !text-white !bg-opaque-black !rounded",href:optimoleDashboardApp.optimoleHome+"pricing",target:"\_blank"},optimoleDashboardApp.strings.upgrade.cta)):(0,o.createElement)(u.Button,{variant:"default",className:"bg-white flex font-bold border-0 rounded-lg shadow-md p-8 text-sm justify-center",href:(0,S.addQueryArgs)(optimoleDashboardApp.optimoleHome+"contact/",{contact\_name:window.optimoleDashboardApp.user\_data.display\_name,contact\_email:optimoleDashboardApp.user\_data.user\_email,contact\_website:optimoleDashboardApp.home\_url}),target:"\_blank"},optimoleDashboardApp.strings.premium\_support))},Pt=({strings:e,onClose:t})=>(0,o.createElement)("div",{className:"flex justify-between px-8 pt-8"},(0,o.createElement)("p",{className:"text-purple-gray text-sm m-0 py-2"},e.title),(0,o.createElement)(u.Button,{label:e.close,icon:ot,onClick:t,className:"text-gray-950"}));window.optimoleCSAT={hasSubmitted:!1,data:{}};const Vt=({id:e,show:t=!1,strings:a={},pages:l=[],onDismiss:n=(()=>{})})=>{const[r,i]=(0,s.useState)(!1),[c,d]=(0,s.useState)(0),[p,m]=(0,s.useState)(!1),[g,h]=(0,s.useState)(!1),[b,\_]=(0,s.useState)({});(0,s.useEffect)((()=>{const t=()=>{!window.optimoleCSAT.hasSubmitted&&window.optimoleCSAT.data?.score&&localStorage.setItem(`optimole\_csat\_data\_${e}`,JSON.stringify(window.optimoleCSAT.data))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,s.useEffect)((()=>{t&&!p&&i(t)}),[t]),(0,s.useEffect)((()=>{window.optimoleCSAT={hasSubmitted:g,data:b}}),[g,b]);const f=(e=!1,t=b)=>{if(n(),g||!t?.score)return m(!0),null;const a={email:optimoleDashboardApp.user\_data.user\_email,product:"Optimole",site:optimoleDashboardApp.home\_url,...t};try{fetch(`https://api.themeisle.com/tracking/csat/${t?.score}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, \*/\*;q=0.1","Cache-Control":"no-cache"},body:JSON.stringify(a)})}catch(e){console.warn(e)}h(!0),d(l.length),e&&(i(!1),m(!0))};if((0,s.useEffect)((()=>{const t=localStorage.getItem(`optimole\_csat\_data\_${e}`);t&&(f(!0,JSON.parse(t)),localStorage.removeItem(`optimole\_csat\_data\_${e}`))}),[]),!r)return null;if(0===l.length)return null;const E=c<l.length,v=l[c]?.content;return(0,o.createElement)("div",{className:"bg-white fixed left-0 w-auto sm:right-0 sm:left-auto sm:w-full bottom-0 m-12 gap-2 max-w-lg flex flex-col text-gray-700 border-0 rounded-lg shadow-lg z-50"},l[c]&&(0,o.createElement)(o.Fragment,null,l[c]?.showHeader&&(0,o.createElement)(Pt,{onClose:()=>{i(!1),m(!0),f()},strings:a}),(0,o.createElement)(v,{data:b,changeData:(e,t=!1)=>{\_({...b,...e}),t&&d(c+1)},onSubmit:f})),!E&&(0,o.createElement)("div",{className:"flex flex-col gap-5 p-8 items-center"},(0,o.createElement)(u.Icon,{icon:Xe,size:40,className:"bg-success rounded-full fill-white p-2"}),(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_three),(0,o.createElement)("div",{className:"text-sm text-center"},optimoleDashboardApp.strings.csat.thank\_you),(0,o.createElement)(u.Button,{variant:"primary",onClick:()=>i(!1),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.close)))},Zt=window.wp.api;var qt=a.n(Zt);const Gt=window.wp.i18n,$t=()=>{const[e,t]=(0,s.useState)(!1),[a,l,n]=(()=>{const[e,t]=(0,s.useState)({}),[a,o]=(0,s.useState)("loading"),l=()=>{qt().loadPromise.then((async()=>{try{const e=new(qt().models.Settings),a=await e.fetch();t(a)}catch(e){o("error")}finally{o("loaded")}}))};return(0,s.useEffect)((()=>{l()}),[]),[t=>e?.[t],(e,t,a=(0,Gt.\_\_)("Settings saved.","textdomain"))=>{o("saving");const s=new(qt().models.Settings)({[e]:t}).save();s.success(((e,t)=>{"success"===t&&o("loaded"),"error"===t&&o("error"),l()})),s.error((e=>{o("error")}))},a]})(),r="loaded"===n&&void 0!==a("optml\_csat")&&JSON.parse(a("optml\_csat")),{hasImages:i,isFirstSite:d}=(0,c.useSelect)((e=>{const{getUserData:t}=e("optimole");return{hasImages:0<t()?.images\_number,isFirstSite:1===t()?.whitelist?.length}})),p=localStorage.getItem("optimole\_settings\_visits");return(0,s.useEffect)((()=>{t(i&&d&&3<=parseInt(p)&&!1!==r&&!0!==r?.firstImpressions)}),[p,r]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(Vt,{id:"first-impressions",show:e,onDismiss:()=>l("optml\_csat",JSON.stringify({...r,firstImpressions:!0})),strings:{title:optimoleDashboardApp.strings.csat.title,close:optimoleDashboardApp.strings.csat.close},pages:[{showHeader:!0,content:e=>(0,o.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_one),(0,o.createElement)("div",{className:"flex gap-5"},[1,2,3,4,5].map((t=>(0,o.createElement)(u.Button,{key:t,onClick:()=>e.changeData({score:t},!0),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},t)))),(0,o.createElement)("div",{className:"flex justify-between"},(0,o.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.low),(0,o.createElement)("span",{className:"text-purple-gray text-sm"},optimoleDashboardApp.strings.csat.high)))},{showHeader:!0,content:e=>(0,o.createElement)("div",{className:"flex flex-col gap-5 px-8 pb-8"},(0,o.createElement)("div",{className:"font-bold text-lg"},optimoleDashboardApp.strings.csat.heading\_two),(0,o.createElement)(u.TextareaControl,{label:optimoleDashboardApp.strings.csat.heading\_two,hideLabelFromVision:!0,value:e.data?.feedback,placeholder:optimoleDashboardApp.strings.csat.feedback\_placeholder,onChange:t=>e.changeData({feedback:t})}),(0,o.createElement)("div",{className:"flex justify-end"},(0,o.createElement)("div",{className:"flex gap-2"},(0,o.createElement)(u.Button,{onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.skip),(0,o.createElement)(u.Button,{variant:"primary",onClick:()=>e.onSubmit(),className:"optml\_\_button basis-full justify-center rounded font-bold min-h-40"},optimoleDashboardApp.strings.csat.submit))))}]}))};async function Kt(e){if(!window.formbricks){const t=await fetch(`${e}/api/packages/app`);if(!t.ok)return{ok:!1,error:new Error("Failed to load Formbricks App SDK")};const a=await t.text(),o=document.createElement("script");o.innerHTML=a,document.head.appendChild(o);const s=async()=>new Promise(((e,t)=>{const a=setInterval((()=>{window.formbricks&&(clearInterval(a),e())}),100);setTimeout((()=>{clearInterval(a),t(new Error("Formbricks App SDK loading timed out"))}),1e4)}));try{return await s(),{ok:!0,data:void 0}}catch(e){return{ok:!1,error:new Error(e.message??"Failed to load Formbricks App SDK")}}}return{ok:!0,data:void 0}}const Ut=new Proxy({},{get:(e,t,a)=>async(...e)=>{if(!window.formbricks){if("init"!==t)return void console.error("🧱 Formbricks - Global error: You need to call formbricks.init before calling any other method");if(!e[0])return void console.error("🧱 Formbricks - Global error: You need to pass the apiHost as the first argument");const{apiHost:o}=e[0],s=await(a=Kt,async(...e)=>{try{return{ok:!0,data:await a(...e)}}catch(e){return{ok:!1,error:e}}})(o);if(!s.ok)return void console.error(`🧱 Formbricks - Global error: ${s.error.message}`)}var a;if(window.formbricks&&"function"!=typeof window.formbricks[t])console.error(`🧱 Formbricks - Global error: Formbricks App SDK does not support method ${String(t)}`);else try{return window.formbricks[t](...e)}catch(e){return void console.error(`Something went wrong: ${e}`)}}});function Yt(e,t=1){const a=Math.round(e/t);return 0===a||1===a?0:1<a&&8>a?7:8<=a&&31>a?30:30<a&&90>a?90:90<a?91:void 0}"undefined"!=typeof window&&optimoleDashboardApp.user\_data.plan&&Ut.init({environmentId:"clo8wxwzj44orpm0gjchurujm",apiHost:"https://app.formbricks.com",userId:"optml\_"+optimoleDashboardApp.user\_data.id,attributes:{plan:optimoleDashboardApp.user\_data.plan,status:optimoleDashboardApp.user\_data.status,language:optimoleDashboardApp.language,cname\_assigned:optimoleDashboardApp.user\_data.is\_cname\_assigned||"no",connected\_websites:optimoleDashboardApp.user\_data.whitelist.length,traffic:Yt(optimoleDashboardApp.user\_data.traffic,500),images\_number:Yt(optimoleDashboardApp.user\_data.images\_number,100),days\_since\_install:Yt(optimoleDashboardApp.days\_since\_install)}});const Qt=({tab:e,setTab:t})=>{const{isConnected:a,hasApplication:l,hasConflicts:n,siteSettings:r,extraVisits:i}=(0,c.useSelect)((e=>{const{isConnected:t,hasApplication:a,getConflicts:o,getSiteSettings:s}=e("optimole"),l=o(),n=s();return{isConnected:t(),hasApplication:a(),hasConflicts:0<l.count||0,siteSettings:n,extraVisits:n.banner\_frontend}})),{setQueryArgs:d}=(0,c.useDispatch)("optimole"),[p,m]=(0,s.useState)(!1),[g,u]=(0,s.useState)("general"),[h,b]=(0,s.useState)(!1),[\_,f]=(0,s.useState)(r);return(0,s.useEffect)((()=>{const e=new URLSearchParams(window.location.search),a=Object.fromEntries(e.entries());let o=[];if(Object.prototype.hasOwnProperty.call(a,"optimole\_action")){for(let e=0;20>e;e++)Object.prototype.hasOwnProperty.call(a,e)&&(isNaN(a[e])||(o[e]=parseInt(a[e],10)));a.images=o,a.url=window.location.href.split("?")[0]+(Object.prototype.hasOwnProperty.call(a,"paged")?"?paged="+a.paged:""),d(a),t("settings"),u("offload\_media")}}),[]),(0,s.useEffect)((()=>{a&&l&&(M(!0),C()({path:optimoleDashboardApp.routes.poll\_conflicts,method:"GET",parse:!1}).then((e=>200<=e.status&&300>e.status?e.json():(console.log(`%c Request failed with status ${e.status}`,"color: #E7602A"),Promise.resolve()))).then((e=>{M(!1),e&&P(e.data)})))}),[]),(0,s.useEffect)((()=>{n&&m(!0)}),[n]),(0,s.useEffect)((()=>{f({...\_,banner\_frontend:i})}),[i]),(0,s.useEffect)((()=>{window.onbeforeunload=h?()=>!0:null}),[h]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"optml-connected max-w-screen-xl flex flex-col lg:flex-row mx-auto gap-5"},(0,o.createElement)("div",{className:"flex flex-col justify-between mt-8 mb-5 p-0 transition-all ease-in-out duration-700 relative text-gray-700 basis-9/12"},"dashboard"===e&&(0,o.createElement)(Ze,null),"conflicts"===e&&p&&(0,o.createElement)(Ge,null),"settings"===e&&(0,o.createElement)(Tt,{tab:g,setTab:u,canSave:h,setCanSave:b,settings:\_,setSettings:f}),"help"===e&&(0,o.createElement)(zt,null)),(0,o.createElement)(Rt,null)),(0,o.createElement)($t,null))},Wt=[{label:optimoleDashboardApp.strings.optimole+" "+optimoleDashboardApp.strings.version,href:optimoleDashboardApp.optimoleHome},{label:optimoleDashboardApp.strings.terms\_menu,href:optimoleDashboardApp.optimoleHome+"terms/"},{label:optimoleDashboardApp.strings.privacy\_menu,href:optimoleDashboardApp.optimoleHome+"privacy-policy/"},{label:optimoleDashboardApp.strings.testdrive\_menu,href:optimoleDashboardApp.optimoleHome+"test-drive?url="+optimoleDashboardApp.home\_url}],Jt=()=>(0,o.createElement)("footer",{className:"max-w-screen-xl gap-3 md:gap-0 mx-auto my-5 flex justify-between text-base flex-col md:flex-row"},(0,o.createElement)("div",{dangerouslySetInnerHTML:{\_\_html:optimoleDashboardApp.strings.account\_needed\_subtitle\_3}}),(0,o.createElement)("nav",{className:"flex gap-0 sm:gap-3 flex-wrap md:flex-nowrap"},Wt.map(((e,t)=>(0,o.createElement)(u.ExternalLink,{key:t,href:e.href,className:"basis-1/2 sm:basis-auto"},e.label))))),Xt=window.lodash;function ea(){const e=(0,c.useSelect)((e=>e(A.store).getNotices()),[]),{removeNotice:t}=(0,c.useDispatch)(A.store),a=(0,Xt.filter)(e,{type:"snackbar"});return(0,o.createElement)(u.SnackbarList,{notices:a,className:"px-2 bottom-4 fixed",onRemove:t})}(0,s.render)((0,o.createElement)((()=>{const e=window.location.hash.replace("#","");let t=["dashboard","settings","help"].includes(e)?e:"dashboard";const[a,l]=(0,s.useState)(t),n=e=>{e.preventDefault(),l("settings")},r=e=>{e.preventDefault(),l("dashboard")},{showDisconnect:i,isConnected:d,hasApplication:p,hasDashboardLoaded:m}=(0,c.useSelect)((e=>{const{showDisconnect:t,isConnected:a,hasApplication:o,hasDashboardLoaded:s}=e("optimole");return{showDisconnect:t(),isConnected:a(),hasApplication:o(),hasDashboardLoaded:s()}}));return(0,s.useEffect)((()=>{d&&(window.location.hash=`#${a}`,D.forEach((e=>{const t=document.querySelector(`a[href="${e.href}"]`);if(!t)return;const a=t.parentNode;if(e.hash&&e.hash===window.location.hash)return t.classList.add("current"),void a.classList.add("current");t.classList.remove("current"),a.classList.remove("current")})))}),[a]),(0,s.useEffect)((()=>{if(!d)return;const e=document.querySelector('a[href\*="page=optimole"]'),t=document.querySelector('a[href\*="page=optimole#settings"]');return e&&t?(e.addEventListener("click",r),t.addEventListener("click",n),()=>{e&&t&&(e.removeEventListener("click",r),t.removeEventListener("click",n))}):void 0}),[]),(0,o.createElement)("div",{className:"antialiased"},(0,o.createElement)(we,{tab:a,setTab:l}),!(d&&p)&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(De,null),(0,o.createElement)(Jt,null)),d&&p&&!m&&(0,o.createElement)(Te,null),d&&i&&(0,o.createElement)(ke,null),d&&p&&m&&(0,o.createElement)(Qt,{tab:a,setTab:l}),(0,o.createElement)(ea,null))}),null),document.getElementById("optimole-app"))},184:(e,t)=>{var a;!function(){"use strict";var o={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var l=typeof a;if("string"===l||"number"===l)e.push(a);else if(Array.isArray(a)){if(a.length){var n=s.apply(null,a);n&&e.push(n)}}else if("object"===l){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){e.push(a.toString());continue}for(var r in a)o.call(a,r)&&a[r]&&e.push(r)}}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(a=function(){return s}.apply(t,[]))||(e.exports=a)}()},864:(e,t,a)=>{(()=>{"use strict";var t={n:e=>{var a=e&&e.\_\_esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},o={};t.r(o),t.d(o,{default:()=>c});const s=a(196);var l=t.n(s);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c=e=>{const{aspectRatio:t="taller",handle:a=null,handleSize:o=40,hover:n=!1,leftImage:i,leftImageAlt:c="",leftImageCss:d={},leftImageLabel:p=null,onSliderPositionChange:m=(()=>{}),rightImage:g,rightImageAlt:u="",rightImageCss:h={},rightImageLabel:b=null,skeleton:\_=null,sliderLineColor:f="#ffffff",sliderLineWidth:E=2,sliderPositionPercentage:v=.5,vertical:y=!1}=e,w=!y,[k,x]=(0,s.useState)(v),[C,S]=(0,s.useState)(0),[A,D]=(0,s.useState)(0),[L,N]=(0,s.useState)(!1),[T,M]=(0,s.useState)(!1),[I,O]=(0,s.useState)(!1),j=(0,s.useRef)(null),F=(0,s.useRef)(null),B=(0,s.useRef)(null);(0,s.useEffect)((()=>{const e=j.current,t=new ResizeObserver((e=>{let[t,...a]=e;const o=t.target.getBoundingClientRect().width;S(o)}));return t.observe(e),()=>t.disconnect()}),[]),(0,s.useEffect)((()=>(B.current.complete&&N(!0),()=>{N(!1)})),[i]),(0,s.useEffect)((()=>(F.current.complete&&M(!0),()=>{M(!1)})),[g]);const z=T&&L;(0,s.useEffect)((()=>{const e=e=>{const t=e||window.event,a=t.touches?t.touches[0].pageX:t.pageX,o=t.touches?t.touches[0].pageY:t.pageY,s=a-window.pageXOffset,l=o-window.pageYOffset,n=F.current.getBoundingClientRect();let r=w?s-n.left:l-n.top;const i=0+E/2,c=w?C-E/2:A-E/2;r<i&&(r=i),r>c&&(r=c),x(w?r/C:r/A),m&&m(w?r/C:r/A)},a=t=>{O(!0),"touches"in t||t.preventDefault(),e(t),window.addEventListener("mousemove",e),window.addEventListener("touchmove",e)},o=()=>{O(!1),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)},s=j.current;if(z){s.addEventListener("touchstart",a),window.addEventListener("touchend",o),n?(s.addEventListener("mousemove",e),s.addEventListener("mouseleave",o)):(s.addEventListener("mousedown",a),window.addEventListener("mouseup",o));const l=B.current.naturalHeight/B.current.naturalWidth,r=F.current.naturalHeight/F.current.naturalWidth,i="taller"===t?Math.max(l,r):Math.min(l,r);D(C\*i)}return()=>{s.removeEventListener("touchstart",a),window.removeEventListener("touchend",o),s.removeEventListener("mousemove",e),s.removeEventListener("mouseleave",o),s.removeEventListener("mousedown",a),window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}}),[z,t,A,C,w,n,E,y]);const H={container:{boxSizing:"border-box",position:"relative",width:"100%",height:`${A}px`,overflow:"hidden"},rightImage:r({clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},h),leftImage:r({clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,display:"block",height:"100%",objectFit:"cover",position:"absolute",width:"100%"},d),slider:{alignItems:"center",cursor:!n&&w?"ew-resize":!n&&!w&&"ns-resize",display:"flex",flexDirection:w?"column":"row",height:w?"100%":`${o}px`,justifyContent:"center",left:w?C\*k-o/2+"px":0,position:"absolute",top:w?0:A\*k-o/2+"px",width:w?`${o}px`:"100%"},line:{background:f,boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",flex:"0 1 auto",height:w?"100%":`${E}px`,width:w?`${E}px`:"100%"},handleCustom:{alignItems:"center",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:"auto",justifyContent:"center",width:"auto"},handleDefault:{alignItems:"center",border:`${E}px solid ${f}`,borderRadius:"100%",boxShadow:"0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)",boxSizing:"border-box",display:"flex",flex:"1 0 auto",height:`${o}px`,justifyContent:"center",width:`${o}px`,transform:w?"none":"rotate(90deg)"},leftArrow:{border:`inset ${.15\*o}px rgba(0,0,0,0)`,borderRight:`${.15\*o}px solid ${f}`,height:"0px",marginLeft:`-${.25\*o}px`,marginRight:.25\*o+"px",width:"0px"},rightArrow:{border:`inset ${.15\*o}px rgba(0,0,0,0)`,borderLeft:`${.15\*o}px solid ${f}`,height:"0px",marginRight:`-${.25\*o}px`,width:"0px"},leftLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",left:w?"5%":"50%",opacity:I?0:1,padding:"10px 20px",position:"absolute",top:w?"50%":"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},rightLabel:{background:"rgba(0, 0, 0, 0.5)",color:"white",opacity:I?0:1,padding:"10px 20px",position:"absolute",left:w?null:"50%",right:w?"5%":null,top:w?"50%":null,bottom:w?null:"3%",transform:w?"translate(0,-50%)":"translate(-50%, 0)",transition:"opacity 0.1s ease-out"},leftLabelContainer:{clip:w?`rect(auto, ${C\*k}px, auto, auto)`:`rect(auto, auto, ${A\*k}px, auto)`,height:"100%",position:"absolute",width:"100%"},rightLabelContainer:{clip:w?`rect(auto, auto, auto, ${C\*k}px)`:`rect(${A\*k}px, auto, auto, auto)`,height:"100%",position:"absolute",width:"100%"}};return l().createElement(l().Fragment,null,\_&&!z&&l().createElement("div",{style:r({},H.container)},\_),l().createElement("div",{style:r(r({},H.container),{},{display:z?"block":"none"}),ref:j,"data-testid":"container"},l().createElement("img",{onLoad:()=>M(!0),alt:u,"data-testid":"right-image",ref:F,src:g,style:H.rightImage}),l().createElement("img",{onLoad:()=>N(!0),alt:c,"data-testid":"left-image",ref:B,src:i,style:H.leftImage}),l().createElement("div",{style:H.slider},l().createElement("div",{style:H.line}),a?l().createElement("div",{style:H.handleCustom},a):l().createElement("div",{style:H.handleDefault},l().createElement("div",{style:H.leftArrow}),l().createElement("div",{style:H.rightArrow})),l().createElement("div",{style:H.line})),p&&l().createElement("div",{style:H.leftLabelContainer},l().createElement("div",{style:H.leftLabel},p)),b&&l().createElement("div",{style:H.rightLabelContainer},l().createElement("div",{style:H.rightLabel},b))))};e.exports=o})()},196:e=>{"use strict";e.exports=window.React}},a={};function o(e){var s=a[e];if(void 0!==s)return s.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,o),l.exports}o.m=t,e=[],o.O=(t,a,s,l)=>{if(!a){var n=1/0;for(d=0;d<e.length;d++){for(var[a,s,l]=e[d],r=!0,i=0;i<a.length;i++)(!1&l||n>=l)&&Object.keys(o.O).every((e=>o.O[e](a[i])))?a.splice(i--,1):(r=!1,l<n&&(n=l));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[a,s,l]},o.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var s,l,[n,r,i]=a,c=0;if(n.some((t=>0!==e[t]))){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(i)var d=i(o)}for(t&&t(a);c<n.length;c++)l=n[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},a=globalThis.webpackChunkoptimole\_wp=globalThis.webpackChunkoptimole\_wp||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var s=o.O(void 0,[431],(()=>o(976)));s=o.O(s)})(); |
* ## [optimole-wp/trunk/inc/admin.php](/changeset/3086306/optimole-wp/trunk/inc/admin.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/admin.php")

  | [r3072872](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L11 "Show revision 3072872 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/admin.php?rev=3086306#L11 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  |  | 13 | use enshrined\svgSanitize\Sanitizer; |
  | 13 | 14 | /\*\* |
  | 14 | 15 | \* Class Optml\_Admin |
  | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L88) | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3086306#L89) |  |
  | 88 | 89 | [ |
  | 89 | 90 | $this, |
  | 90 |  | 'allow\_~~meme\_types~~', |
  |  | 91 | 'allow\_svg', |
  | 91 | 92 | ] |
  | 92 | 93 | ); // phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.upload\_mimes |
  | 93 |  | } |
  | 94 |  | } |
  | 95 |  |  |
  |  | 94 | add\_filter( 'wp\_handle\_upload\_prefilter', [ $this, 'check\_svg\_and\_sanitize' ] ); |
  |  | 95 | } |
  |  | 96 | } |
  |  | 97 | /\*\* |
  |  | 98 | \* Check if the file is an SVG, if so handle appropriately |
  |  | 99 | \* |
  |  | 100 | \* @param array $file An array of data for a single file. |
  |  | 101 | \* |
  |  | 102 | \* @return mixed |
  |  | 103 | \*/ |
  |  | 104 | public function check\_svg\_and\_sanitize( $file ) { |
  |  | 105 | // Ensure we have a proper file path before processing. |
  |  | 106 | if ( ! isset( $file['tmp\_name'] ) ) { |
  |  | 107 | return $file; |
  |  | 108 | } |
  |  | 109 |  |
  |  | 110 | $file\_name   = isset( $file['name'] ) ? $file['name'] : ''; |
  |  | 111 | $wp\_filetype = wp\_check\_filetype\_and\_ext( $file['tmp\_name'], $file\_name ); |
  |  | 112 | $type        = ! empty( $wp\_filetype['type'] ) ? $wp\_filetype['type'] : ''; |
  |  | 113 |  |
  |  | 114 | if ( 'image/svg+xml' === $type ) { |
  |  | 115 | if ( ! current\_user\_can( 'upload\_files' ) ) { |
  |  | 116 | $file['error'] = 'Invalid'; |
  |  | 117 | return $file; |
  |  | 118 | } |
  |  | 119 |  |
  |  | 120 | if ( ! $this->sanitize\_svg( $file['tmp\_name'] ) ) { |
  |  | 121 | $file['error'] = 'Invalid'; |
  |  | 122 | } |
  |  | 123 | } |
  |  | 124 |  |
  |  | 125 | return $file; |
  |  | 126 | } |
  |  | 127 |  |
  |  | 128 | /\*\* |
  |  | 129 | \* Sanitize the SVG |
  |  | 130 | \* |
  |  | 131 | \* @param string $file Temp file path. |
  |  | 132 | \* |
  |  | 133 | \* @return bool|int |
  |  | 134 | \*/ |
  |  | 135 | protected function sanitize\_svg( $file ) { |
  |  | 136 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 137 | $dirty = file\_get\_contents( $file ); // phpcs:ignore |
  |  | 138 |  |
  |  | 139 | // Is the SVG gzipped? If so we try and decode the string. |
  |  | 140 | $is\_zipped = $this->is\_gzipped( $dirty ); |
  |  | 141 | if ( $is\_zipped && ( ! function\_exists( 'gzdecode' ) || ! function\_exists( 'gzencode' ) ) ) { |
  |  | 142 | return false; |
  |  | 143 | } |
  |  | 144 |  |
  |  | 145 | if ( $is\_zipped ) { |
  |  | 146 | $dirty = gzdecode( $dirty ); |
  |  | 147 |  |
  |  | 148 | // If decoding fails, bail as we're not secure. |
  |  | 149 | if ( false === $dirty ) { |
  |  | 150 | return false; |
  |  | 151 | } |
  |  | 152 | } |
  |  | 153 |  |
  |  | 154 | $sanitizer = new Sanitizer(); |
  |  | 155 | $clean     = $sanitizer->sanitize( $dirty ); |
  |  | 156 |  |
  |  | 157 | if ( false === $clean ) { |
  |  | 158 | return false; |
  |  | 159 | } |
  |  | 160 |  |
  |  | 161 | // If we were gzipped, we need to re-zip. |
  |  | 162 | if ( $is\_zipped ) { |
  |  | 163 | $clean = gzencode( $clean ); |
  |  | 164 | } |
  |  | 165 |  |
  |  | 166 | // We can ignore the phpcs warning here as we're reading and writing to the Temp file. |
  |  | 167 | file\_put\_contents( $file, $clean ); // phpcs:ignore |
  |  | 168 |  |
  |  | 169 | return true; |
  |  | 170 | } |
  |  | 171 |  |
  |  | 172 | /\*\* |
  |  | 173 | \* Check if the contents are gzipped |
  |  | 174 | \* |
  |  | 175 | \* @see http://www.gzip.org/zlib/rfc-gzip.html#member-format |
  |  | 176 | \* |
  |  | 177 | \* @param string $contents Content to check. |
  |  | 178 | \* |
  |  | 179 | \* @return bool |
  |  | 180 | \*/ |
  |  | 181 | protected function is\_gzipped( $contents ) { |
  |  | 182 | // phpcs:disable Generic.Strings.UnnecessaryStringConcat.Found |
  |  | 183 | if ( function\_exists( 'mb\_strpos' ) ) { |
  |  | 184 | return 0 === mb\_strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 185 | } else { |
  |  | 186 | return 0 === strpos( $contents, "\x1f" . "\x8b" . "\x08" ); |
  |  | 187 | } |
  |  | 188 | // phpcs:enable |
  |  | 189 | } |
  | 96 | 190 | /\*\* |
  | 97 | 191 | \* Schedules the hourly cron that starts the querying for images alt/title attributes |
  | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3072872#L1825) | […](/browser/optimole-wp/trunk/inc/admin.php?rev=3086306#L1919) |  |
  | 1825 | 1919 | \* @uses filter:upload\_mimes |
  | 1826 | 1920 | \*/ |
  | 1827 |  | public function allow\_~~meme\_types~~( $mimes ) { |
  |  | 1921 | public function allow\_svg( $mimes ) { |
  | 1828 | 1922 | $mimes['svg'] = 'image/svg+xml'; |
  | 1829 | 1923 |  |
* ## [optimole-wp/trunk/inc/app\_replacer.php](/changeset/3086306/optimole-wp/trunk/inc/app_replacer.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/app_replacer.php")

  | [r2999023](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L1 "Show revision 2999023 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L616) | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=3086306#L619) |  |
  | 616 | 619 | \*/ |
  | 617 | 620 | public function get\_media\_optimized\_url( $url, $table\_id, $width = 'auto', $height = 'auto', $resize = [] ) { |
  | 618 |  | $optimized\_url = ( new Optml\_Image( $url, ['width' => $width, 'height' => $height, 'resize' => $resize, 'quality' => $this->settings->get\_numeric\_quality()], $this->settings->get( 'cache\_buster' ) ) )->get\_url(); |
  | 619 |  | $optimized\_url = str\_replace( $url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] . 'media\_cloud' . '/' . Optml\_Media\_Offload::KEYS['uploaded\_flag'] . $table\_id . '/' . $url, $optimized\_url ); |
  | 620 |  | return $optimized\_url; |
  |  | 621 | return str\_replace( $url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] . 'media\_cloud' . '/' . Optml\_Media\_Offload::KEYS['uploaded\_flag'] . $table\_id . '/' . $url, $this->get\_optimized\_image\_url( $url, $width, $height, $resize ) ); |
  | 621 | 622 | } |
  | 622 | 623 |  |
  | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=2999023#L631) | […](/browser/optimole-wp/trunk/inc/app_replacer.php?rev=3086306#L632) |  |
  | 631 | 632 | return strpos( $url, Optml\_Dam::URL\_DAM\_FLAG ) !== false; |
  | 632 | 633 | } |
  |  | 634 |  |
  |  | 635 | /\*\* |
  |  | 636 | \* Get the optimized image url for the image url. |
  |  | 637 | \* |
  |  | 638 | \* @param string $url    The image URL. |
  |  | 639 | \* @param mixed  $width  The image width. |
  |  | 640 | \* @param mixed  $height The image height. |
  |  | 641 | \* @param array  $resize The resize properties. |
  |  | 642 | \* |
  |  | 643 | \* @return string |
  |  | 644 | \*/ |
  |  | 645 | protected function get\_optimized\_image\_url( $url, $width, $height, $resize = [] ) { |
  |  | 646 | $optimized\_image = Optimole::image( $url, $this->settings->get( 'cache\_buster' ) ) |
  |  | 647 | ->width( $width ) |
  |  | 648 | ->height( $height ); |
  |  | 649 |  |
  |  | 650 | if ( is\_array( $resize ) && ! empty( $resize['type'] ) ) { |
  |  | 651 | $optimized\_image->resize( $resize['type'], $resize['gravity'] ?? Position::CENTER, $resize['enlarge'] ?? false ); |
  |  | 652 |  |
  |  | 653 | } |
  |  | 654 |  |
  |  | 655 | $optimized\_image->quality( $this->settings->to\_accepted\_quality( $this->settings->get\_quality() ) ); |
  |  | 656 |  |
  |  | 657 | return $optimized\_image->getUrl(); |
  |  | 658 | } |
  | 633 | 659 | } |
* ## [optimole-wp/trunk/inc/attachment\_cache.php](/changeset/3086306/optimole-wp/trunk/inc/attachment_cache.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/attachment_cache.php")

  | [r2999023](/browser/optimole-wp/trunk/inc/attachment_cache.php?rev=2999023#L12 "Show revision 2999023 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/attachment_cache.php?rev=3086306#L12 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \*/ |
  | 13 | 13 | private static $cache\_map = []; |
  | 14 |  |  |
  |  | 14 | /\*\* |
  |  | 15 | \* Reset the memory cache. |
  |  | 16 | \*/ |
  |  | 17 | public static function reset() { |
  |  | 18 | self::$cache\_map = []; |
  |  | 19 | } |
  | 15 | 20 | /\*\* |
  | 16 | 21 | \* Get the cached attachment ID. |
* ## [optimole-wp/trunk/inc/compatibilities/envira.php](/changeset/3086306/optimole-wp/trunk/inc/compatibilities/envira.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/compatibilities/envira.php")

  | [r2935150](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=2935150#L1 "Show revision 2935150 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=2935150#L57) | […](/browser/optimole-wp/trunk/inc/compatibilities/envira.php?rev=3086306#L60) |  |
  | 57 | 60 | if ( preg\_match( '/(\_c)\.(?:' . implode( '|', array\_keys( Optml\_Config::$image\_extensions ) ) . ')/i', $tag, $match ) ) { |
  | 58 | 61 | return [ |
  | 59 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  | 60 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 62 | 'type'    => ResizeTypeProperty::FILL, |
  |  | 63 | 'gravity' => Position::CENTER, |
  | 61 | 64 | ]; |
  | 62 | 65 | } |
* ## [optimole-wp/trunk/inc/compatibilities/shortcode\_ultimate.php](/changeset/3086306/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php")

  | [r2441517](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=2441517#L1 "Show revision 2441517 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=2441517#L72) | […](/browser/optimole-wp/trunk/inc/compatibilities/shortcode_ultimate.php?rev=3086306#L75) |  |
  | 72 | 75 | public function change\_default\_crop() { |
  | 73 | 76 | return [ |
  | 74 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  | 75 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 77 | 'type'    => ResizeTypeProperty::FILL, |
  |  | 78 | 'gravity' => Position::CENTER, |
  | 76 | 79 | ]; |
  | 77 | 80 | } |
* ## [optimole-wp/trunk/inc/config.php](/changeset/3086306/optimole-wp/trunk/inc/config.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/config.php")

  | [r3013029](/browser/optimole-wp/trunk/inc/config.php?rev=3013029#L1 "Show revision 3013029 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/config.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  | 2 | 4 |  |
  | 3 | 5 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/config.php?rev=3013029#L125) | […](/browser/optimole-wp/trunk/inc/config.php?rev=3086306#L127) |  |
  | 125 | 127 | self::$service\_url = constant( 'OPTML\_CUSTOM\_DOMAIN' ); |
  | 126 | 128 | } |
  |  | 129 |  |
  |  | 130 | Optimole::init( self::$key, [ 'domain' => parse\_url( self::$service\_url, PHP\_URL\_HOST ) ] ); |
  | 127 | 131 | } |
  | 128 | 132 | } |
* ## [optimole-wp/trunk/inc/dam.php](/changeset/3086306/optimole-wp/trunk/inc/dam.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/dam.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/dam.php?rev=3071327#L9 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/dam.php?rev=3086306#L9 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | \* @author     Optimole <friends@optimole.com> |
  | 10 | 10 | \*/ |
  |  | 11 |  |
  |  | 12 | use Optimole\Sdk\Resource\ImageProperty\GravityProperty; |
  |  | 13 | use Optimole\Sdk\ValueObject\Position; |
  | 11 | 14 |  |
  | 12 | 15 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/dam.php?rev=3071327#L745) | […](/browser/optimole-wp/trunk/inc/dam.php?rev=3086306#L748) |  |
  | 745 | 748 | $crop = (bool) $args['crop']; |
  | 746 | 749 |  |
  | 747 |  | $gravity = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 750 | $gravity = Position::CENTER; |
  | 748 | 751 |  |
  | 749 | 752 | if ( $this->settings->get( 'resize\_smart' ) === 'enabled' ) { |
  | 750 |  | $gravity = ~~Optml\_Resize::GRAVITY\_~~SMART; |
  |  | 753 | $gravity = GravityProperty::SMART; |
  | 751 | 754 | } |
  | 752 | 755 |  |
* ## [optimole-wp/trunk/inc/lazyload\_replacer.php](/changeset/3086306/optimole-wp/trunk/inc/lazyload_replacer.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/lazyload_replacer.php")

  | [r3018634](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3018634#L197 "Show revision 3018634 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3086306#L197 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 197 | 197 | } |
  | 198 | 198 |  |
  | 199 |  | ~~add\_filter(~~ |
  | 200 |  | ~~'max\_srcset\_image\_width',~~ |
  | 201 |  | ~~function () {~~ |
  | 202 |  | ~~return 1;~~ |
  | 203 |  | ~~}~~ |
  | 204 |  | ~~);~~ |
  | 205 | 199 | self::$is\_lazyload\_placeholder = self::$instance->settings->get( 'lazyload\_placeholder' ) === 'enabled'; |
  | 206 | 200 |  |
  | […](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3018634#L323) | […](/browser/optimole-wp/trunk/inc/lazyload_replacer.php?rev=3086306#L317) |  |
  | 323 | 317 | 1 |
  | 324 | 318 | ); |
  |  | 319 |  |
  |  | 320 | // We remove srcset and sizes attributes since our lazyload does not need them. |
  |  | 321 | $pattern = '/\s+(?:srcset|sizes)=("[^"]\*"|\'[^\']\*\'|\\\\"[^\\\\"]\*\\\\")/i'; |
  |  | 322 | $new\_tag = preg\_replace( $pattern, '', $new\_tag ); |
  |  | 323 |  |
  |  | 324 | // We keep this for srcset lazyload compatibility that might break our mechanism. |
  | 325 | 325 | $new\_tag = str\_replace( 'srcset=', 'old-srcset=', $new\_tag ); |
  | 326 | 326 |  |
* ## [optimole-wp/trunk/inc/main.php](/changeset/3086306/optimole-wp/trunk/inc/main.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/main.php")

  | [r2996263](/browser/optimole-wp/trunk/inc/main.php?rev=2996263#L86 "Show revision 2996263 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/main.php?rev=3086306#L86 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 86 | 86 | \*/ |
  | 87 | 87 | public static function instance() { |
  |  | 88 | $vendor\_file = OPTML\_PATH . 'vendor/autoload.php'; |
  |  | 89 | if ( is\_readable( $vendor\_file ) ) { |
  |  | 90 | include\_once $vendor\_file; |
  |  | 91 | } |
  |  | 92 |  |
  | 88 | 93 | if ( null === self::$\_instance ) { |
  | 89 | 94 | add\_filter( 'themeisle\_sdk\_products', [ \_\_CLASS\_\_, 'register\_sdk' ] ); |
  | […](/browser/optimole-wp/trunk/inc/main.php?rev=2996263#L104) | […](/browser/optimole-wp/trunk/inc/main.php?rev=3086306#L109) |  |
  | 104 | 109 | } |
  | 105 | 110 | } |
  | 106 |  | ~~$vendor\_file = OPTML\_PATH . 'vendor/autoload.php';~~ |
  | 107 |  | ~~if ( is\_readable( $vendor\_file ) ) {~~ |
  | 108 |  | ~~include\_once $vendor\_file;~~ |
  | 109 |  | ~~}~~ |
  | 110 | 111 |  |
  | 111 | 112 | return self::$\_instance; |
* ## [optimole-wp/trunk/inc/manager.php](/changeset/3086306/optimole-wp/trunk/inc/manager.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/manager.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/manager.php?rev=3071327#L267 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/manager.php?rev=3086306#L267 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 267 | 267 | return false; // @codeCoverageIgnore |
  | 268 | 268 | } |
  | 269 |  | if ( array\_key\_exists( 'preview', $\_GET ) && ! empty( $\_GET['preview'] ) ) { |
  |  | 269 |  |
  |  | 270 | if ( array\_key\_exists( 'preview', $\_GET ) && ! empty( $\_GET['preview'] ) && ! $this->settings->is\_offload\_enabled() ) { |
  | 270 | 271 | return false; // @codeCoverageIgnore |
  | 271 | 272 | } |
* ## [optimole-wp/trunk/inc/media\_offload.php](/changeset/3086306/optimole-wp/trunk/inc/media_offload.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/media_offload.php")

  | [r3073660](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L541 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L541 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 541 | 541 | $size       = 'full'; |
  | 542 | 542 | $found\_size = $this->parse\_dimensions\_from\_filename( $url ); |
  | 543 |  | $strip\_url  = $url; |
  | 544 |  | $scaled\_url = $url; |
  |  | 543 | $url        = $this->add\_schema( $url ); |
  | 545 | 544 | if ( $found\_size[0] !== false && $found\_size[1] !== false ) { |
  | 546 |  | $size       = $found\_size; |
  | 547 |  | $strip\_url  = str\_replace( '-' . $found\_size[0] . 'x' . $found\_size[1], '', $url ); |
  | 548 |  | $scaled\_url = str\_replace( '-' . $found\_size[0] . 'x' . $found\_size[1], '-scaled', $url ); |
  | 549 |  | } |
  | 550 |  | $strip\_url = $this->add\_schema( $strip\_url ); |
  | 551 |  |  |
  | 552 |  | $attachment\_id = attachment\_url\_to\_postid( $strip\_url ); |
  | 553 |  | if ( $attachment\_id === 0 ) { |
  | 554 |  | $scaled\_url    = $this->add\_schema( $scaled\_url ); |
  | 555 |  | $attachment\_id = attachment\_url\_to\_postid( $scaled\_url ); |
  | 556 |  | } |
  |  | 545 | $size = $found\_size; |
  |  | 546 |  |
  |  | 547 | } |
  |  | 548 | $url           = $this->add\_schema( $url ); |
  |  | 549 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $url ); |
  | 557 | 550 |  |
  | 558 | 551 | return [ 'attachment\_id' => $attachment\_id, 'size' => $size ]; |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L814) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L807) |  |
  | 814 | 807 | if ( self::is\_uploaded\_image( wp\_get\_attachment\_metadata( $id )['file'] ) ) { |
  | 815 | 808 | // if this meta flag below failed at the initial update but the file meta above is updated it will cause an infinite query loop |
  | 816 |  | update\_post\_meta( $id, 'optimole\_offload', 'true' ); |
  |  | 809 | update\_post\_meta( $id, self::META\_KEYS['offloaded'], 'true' ); |
  |  | 810 | update\_post\_meta( $id, self::OM\_OFFLOADED\_FLAG, true ); |
  | 817 | 811 | $success\_up ++; |
  | 818 | 812 | continue; |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1174) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L1168) |  |
  | 1174 | 1168 | $file = $meta['file']; |
  | 1175 | 1169 | if ( self::is\_uploaded\_image( $file ) ) { |
  | 1176 |  | $optimized\_url = ( new Optml\_Image( |
  | 1177 |  | $url, |
  | 1178 |  | [ |
  | 1179 |  | 'width'   => 'auto', |
  | 1180 |  | 'height'  => 'auto', |
  | 1181 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1182 |  | ], |
  | 1183 |  | $this->settings->get( 'cache\_buster' ) |
  | 1184 |  | ) )->get\_url(); |
  | 1185 |  |  |
  | 1186 |  | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $attachment\_id . $file, $optimized\_url ); |
  |  | 1170 | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $attachment\_id . $file, $this->get\_optimized\_image\_url( $url, 'auto', 'auto' ) ); |
  | 1187 | 1171 | } else { |
  | 1188 | 1172 | // this is for the users that already offloaded the images before the other fixes |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1195) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L1179) |  |
  | 1195 | 1179 | $duplicated\_meta = wp\_get\_attachment\_metadata( $id ); |
  | 1196 | 1180 | if ( isset( $duplicated\_meta['file'] ) && self::is\_uploaded\_image( $duplicated\_meta['file'] ) ) { |
  | 1197 |  | $optimized\_url = ( new Optml\_Image( |
  | 1198 |  | $url, |
  | 1199 |  | [ |
  | 1200 |  | 'width'   => 'auto', |
  | 1201 |  | 'height'  => 'auto', |
  | 1202 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1203 |  | ], |
  | 1204 |  | $this->settings->get( 'cache\_buster' ) |
  | 1205 |  | ) )->get\_url(); |
  | 1206 |  |  |
  | 1207 |  | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $id . $duplicated\_meta['file'], $optimized\_url ); |
  |  | 1181 | return str\_replace( '/' . $url, '/' . self::KEYS['not\_processed\_flag'] . $id . $duplicated\_meta['file'], $this->get\_optimized\_image\_url( $url, 'auto', 'auto' ) ); |
  | 1208 | 1182 | } |
  | 1209 | 1183 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1212) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L1186) |  |
  | 1212 | 1186 | } |
  | 1213 | 1187 | } |
  | 1214 |  |  |
  | 1215 | 1188 | return $url; |
  | 1216 | 1189 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L1262) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L1235) |  |
  | 1262 | 1235 | } |
  | 1263 | 1236 | $url           = self::get\_original\_url( $attachment\_id ); |
  | 1264 |  | $optimized\_url = ( new Optml\_Image( |
  | 1265 |  | $url, |
  | 1266 |  | [ |
  | 1267 |  | 'width'   => $data['width'], |
  | 1268 |  | 'height'  => $data['height'], |
  | 1269 |  | 'resize'  => $resize, |
  | 1270 |  | 'quality' => $this->settings->get\_numeric\_quality(), |
  | 1271 |  | ], |
  | 1272 |  | $this->settings->get( 'cache\_buster' ) |
  | 1273 |  | ) )->get\_url(); |
  | 1274 |  | $optimized\_url = str\_replace( $url, $id\_filename[1], $optimized\_url ); |
  | 1275 |  | $image         = [ |
  | 1276 |  | $optimized\_url, |
  |  | 1237 |  |
  |  | 1238 | return [ |
  |  | 1239 | str\_replace( $url, $id\_filename[1], $this->get\_optimized\_image\_url( $url, $data['width'], $data['height'], $resize ) ), |
  | 1277 | 1240 | $data['width'], |
  | 1278 | 1241 | $data['height'], |
  | 1279 | 1242 | true, |
  | 1280 | 1243 | ]; |
  | 1281 |  |  |
  | 1282 |  | ~~return $image;~~ |
  | 1283 | 1244 | } |
  | 1284 | 1245 |  |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2467) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2428) |  |
  | 2467 | 2428 | $file = $meta['file']; |
  | 2468 | 2429 | if ( self::is\_uploaded\_image( $file ) ) { |
  | 2469 |  | $optimized\_url = ( new Optml\_Image( |
  | 2470 |  | $url, |
  | 2471 |  | [ |
  | 2472 |  | 'width'         => $args['width'], |
  | 2473 |  | 'height'        => $args['height'], |
  | 2474 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2475 |  | 'resize'        => $args['resize'], |
  | 2476 |  | 'attachment\_id' => $attachment\_id, |
  | 2477 |  | ], |
  | 2478 |  | $this->settings->get( 'cache\_buster' ) |
  | 2479 |  | ) )->get\_url(); |
  | 2480 |  |  |
  | 2481 |  | if ( strpos( $optimized\_url, $process\_flag ) !== false ) { |
  | 2482 |  | return $optimized\_url; |
  | 2483 |  | } |
  | 2484 |  |  |
  | 2485 |  | $process\_flag = $process\_flag . $file; |
  | 2486 |  |  |
  | 2487 |  | return str\_replace( '/' . $url, '/' . $process\_flag, $optimized\_url ); |
  |  | 2430 | $optimized\_url = $this->get\_optimized\_image\_url( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), $args['width'], $args['height'], $args['resize'] ); |
  |  | 2431 |  |
  |  | 2432 | return strpos( $optimized\_url, $process\_flag ) === false ? str\_replace( '/' . ltrim( $file, '/' ), '/' . $process\_flag . $file, $optimized\_url ) : $optimized\_url; |
  | 2488 | 2433 | } else { |
  | 2489 | 2434 | // this is for the users that already offloaded the images before the other fixes |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2496) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2441) |  |
  | 2496 | 2441 | $duplicated\_meta = wp\_get\_attachment\_metadata( $id ); |
  | 2497 | 2442 | if ( isset( $duplicated\_meta['file'] ) && self::is\_uploaded\_image( $duplicated\_meta['file'] ) ) { |
  | 2498 |  | $optimized\_url = ( new Optml\_Image( |
  | 2499 |  | $url, |
  | 2500 |  | [ |
  | 2501 |  | 'width'         => $args['width'], |
  | 2502 |  | 'height'        => $args['height'], |
  | 2503 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2504 |  | 'attachment\_id' => $attachment\_id, |
  | 2505 |  | ], |
  | 2506 |  | $this->settings->get( 'cache\_buster' ) |
  | 2507 |  | ) )->get\_url(); |
  | 2508 |  |  |
  | 2509 |  | return $optimized\_url; |
  |  | 2443 | return $this->get\_optimized\_image\_url( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), $args['width'], $args['height'], $args['resize'] ); |
  | 2510 | 2444 | } |
  | 2511 | 2445 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2514) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2448) |  |
  | 2514 | 2448 | } |
  | 2515 | 2449 | } |
  | 2516 |  |  |
  | 2517 | 2450 | return $url; |
  | 2518 | 2451 | } |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2564) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2497) |  |
  | 2564 | 2497 |  |
  | 2565 | 2498 | // Build the optimized URL. |
  | 2566 |  | $optimized\_url = ( new Optml\_Image( |
  | 2567 |  | $url, |
  | 2568 |  | [ |
  | 2569 |  | 'width'         => $width, |
  | 2570 |  | 'height'        => $height, |
  | 2571 |  | 'quality'       => $this->settings->get\_numeric\_quality(), |
  | 2572 |  | 'resize'        => $resize, |
  | 2573 |  | 'attachment\_id' => $attachment\_id, |
  | 2574 |  | ], |
  | 2575 |  | $this->settings->get( 'cache\_buster' ) |
  | 2576 |  | ) )->get\_url(); |
  |  | 2499 | $optimized\_url = $this->get\_optimized\_image\_url( self::KEYS['not\_processed\_flag'] . $attachment\_id . '/' . ltrim( $this->get\_offloaded\_attachment\_url( $attachment\_id, $url ), '/' ), $width, $height, $resize ); |
  | 2577 | 2500 |  |
  | 2578 | 2501 | // Drop any image size from the URL. |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2783) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2706) |  |
  | 2783 | 2706 | // Filter loaded data in the editors to use local attachments. |
  | 2784 | 2707 | add\_filter( 'content\_edit\_pre', [ self::$instance, 'replace\_urls\_in\_editor\_content' ], 10, 1 ); |
  | 2785 |  | $types = get\_post\_types\_by\_support( 'editor' ); |
  | 2786 |  | foreach ( $types as $type ) { |
  | 2787 |  | $post\_type = get\_post\_type\_object( $type ); |
  | 2788 |  | if ( property\_exists( $post\_type, 'show\_in\_rest' ) && true === $post\_type->show\_in\_rest ) { |
  | 2789 |  | add\_filter( |
  | 2790 |  | 'rest\_prepare\_' . $type, |
  | 2791 |  | [ |
  | 2792 |  | self::$instance, |
  | 2793 |  | 'pre\_filter\_rest\_content', |
  | 2794 |  | ], |
  | 2795 |  | 10, |
  | 2796 |  | 3 |
  | 2797 |  | ); |
  | 2798 |  | } |
  | 2799 |  | } |
  |  | 2708 |  |
  |  | 2709 | add\_action( |
  |  | 2710 | 'init', |
  |  | 2711 | function() { |
  |  | 2712 | $types = get\_post\_types\_by\_support( 'editor' ); |
  |  | 2713 |  |
  |  | 2714 | foreach ( $types as $type ) { |
  |  | 2715 |  |
  |  | 2716 | $post\_type = get\_post\_type\_object( $type ); |
  |  | 2717 |  |
  |  | 2718 | if ( property\_exists( $post\_type, 'show\_in\_rest' ) && true === $post\_type->show\_in\_rest ) { |
  |  | 2719 | add\_filter( 'rest\_prepare\_' . $type, [ self::$instance, 'pre\_filter\_rest\_content' ], 10, 3 ); |
  |  | 2720 | } |
  |  | 2721 | } |
  |  | 2722 | }, |
  |  | 2723 | PHP\_INT\_MAX |
  |  | 2724 | ); |
  | 2800 | 2725 |  |
  | 2801 | 2726 | add\_filter( 'get\_attached\_file', [ $this, 'alter\_attached\_file\_response' ], 10, 2 ); |
  | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3073660#L2861) | […](/browser/optimole-wp/trunk/inc/media_offload.php?rev=3086306#L2786) |  |
  | 2861 | 2786 | return defined( 'OPTML\_PHPUNIT\_TESTING' ) && OPTML\_PHPUNIT\_TESTING === true; |
  | 2862 | 2787 | } |
  |  | 2788 |  |
  |  | 2789 | /\*\* |
  |  | 2790 | \* Get offloaded image attachment URL based on the given attachment ID and URL. |
  |  | 2791 | \* |
  |  | 2792 | \* @param mixed  $attachment\_id The attachment ID. |
  |  | 2793 | \* @param string $url           The attachment URL. |
  |  | 2794 | \* |
  |  | 2795 | \* @return string |
  |  | 2796 | \*/ |
  |  | 2797 | private function get\_offloaded\_attachment\_url( $attachment\_id, $url ) { |
  |  | 2798 | if ( ! $this->settings->is\_offload\_enabled() || ! is\_numeric( $attachment\_id ) ) { |
  |  | 2799 | return $url; |
  |  | 2800 | } elseif ( empty( $attachment\_id ) && strpos( $url, self::KEYS['not\_processed\_flag'] ) !== false ) { |
  |  | 2801 | $attachment\_id = (int) self::get\_attachment\_id\_from\_url( $url ); |
  |  | 2802 | } elseif ( empty( $attachment\_id ) ) { |
  |  | 2803 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $url ); |
  |  | 2804 | } |
  |  | 2805 |  |
  |  | 2806 | if ( $attachment\_id > 0 || ! empty( get\_post\_meta( $attachment\_id, self::OM\_OFFLOADED\_FLAG, true ) ) ) { |
  |  | 2807 | $url = wp\_get\_attachment\_metadata( $attachment\_id )['file']; |
  |  | 2808 | } |
  |  | 2809 |  |
  |  | 2810 | return $url; |
  |  | 2811 | } |
  | 2863 | 2812 | } |
* ## [optimole-wp/trunk/inc/rest.php](/changeset/3086306/optimole-wp/trunk/inc/rest.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/rest.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L7 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/rest.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \* @license     http://opensource.org/licenses/gpl-2.0.php GNU Public License |
  | 8 | 8 | \*/ |
  |  | 9 |  |
  |  | 10 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 11 | use Optimole\Sdk\ValueObject\Position; |
  | 9 | 12 |  |
  | 10 | 13 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L272) | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3086306#L275) |  |
  | 272 | 275 |  |
  | 273 | 276 | if ( $data === false || is\_wp\_error( $data ) ) { |
  | 274 |  | if ( $data->get\_error\_code() === 'domain\_not\_accessible' ) { |
  | 275 |  | return $this->response( $data->get\_error\_message(), 400 ); |
  | 276 |  | } |
  |  | 277 |  |
  | 277 | 278 | $extra = ''; |
  | 278 | 279 | if ( is\_wp\_error( $data ) ) { |
  |  | 280 | if ( $data->get\_error\_code() === 'domain\_not\_accessible' ) { |
  |  | 281 | return $this->response( $data->get\_error\_message(), 400 ); |
  |  | 282 | } |
  | 279 | 283 | /\*\* |
  | 280 | 284 | \* Error from api. |
  | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3071327#L608) | […](/browser/optimole-wp/trunk/inc/rest.php?rev=3086306#L612) |  |
  | 608 | 612 | 140, |
  | 609 | 613 | [ |
  | 610 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 614 | 'type'    => ResizeTypeProperty::FILL, |
  | 611 | 615 | 'enlarge' => false, |
  | 612 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 616 | 'gravity' => Position::CENTER, |
  | 613 | 617 | ] |
  | 614 | 618 | ); |
* ## [optimole-wp/trunk/inc/settings.php](/changeset/3086306/optimole-wp/trunk/inc/settings.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/settings.php")

  | [r3073660](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L1 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/settings.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 4 |  |
  | 3 | 5 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L74) | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3086306#L76) |  |
  | 74 | 76 | 'wm\_id'                      => - 1, |
  | 75 | 77 | 'wm\_opacity'                 => 1, |
  | 76 |  | 'wm\_position'                => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  |  | 78 | 'wm\_position'                => Position::SOUTH\_EAST, |
  | 77 | 79 | 'wm\_x'                       => 0, |
  | 78 | 80 | 'wm\_y'                       => 0, |
  | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3073660#L338) | […](/browser/optimole-wp/trunk/inc/settings.php?rev=3086306#L340) |  |
  | 338 | 340 | $value, |
  | 339 | 341 | [ |
  | 340 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 341 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 342 |  | ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 343 |  | ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  | 344 |  | ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 345 |  | ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 346 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  | 347 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 348 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  |  | 342 | Position::NORTH, |
  |  | 343 | Position::NORTH\_EAST, |
  |  | 344 | Position::NORTH\_WEST, |
  |  | 345 | Position::CENTER, |
  |  | 346 | Position::EAST, |
  |  | 347 | Position::WEST, |
  |  | 348 | Position::SOUTH\_EAST, |
  |  | 349 | Position::SOUTH, |
  |  | 350 | Position::SOUTH\_WEST, |
  | 349 | 351 | ], |
  | 350 |  | ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST |
  |  | 352 | Position::SOUTH\_EAST |
  | 351 | 353 | ); |
  | 352 | 354 | break; |
* ## [optimole-wp/trunk/inc/tag\_replacer.php](/changeset/3086306/optimole-wp/trunk/inc/tag_replacer.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/tag_replacer.php")

  | [r3071327](/browser/optimole-wp/trunk/inc/tag_replacer.php?rev=3071327#L491 "Show revision 3071327 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/tag_replacer.php?rev=3086306#L491 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 491 | 491 | $sizes['height'] = $image\_resized[7]; |
  | 492 | 492 | } |
  | 493 |  |  |
  |  | 493 | // There are cases when the image meta is missing and image size is non existent, see SVG image handling. |
  |  | 494 | if ( ! $sizes['width'] || ! $sizes['height'] ) { |
  |  | 495 | break; |
  |  | 496 | } |
  | 494 | 497 | list( $sizes['width'], $sizes['height'] ) = image\_constrain\_size\_for\_editor( $sizes['width'], $sizes['height'], $size, 'display' ); |
  | 495 | 498 |  |
* ## [optimole-wp/trunk/inc/traits/dam\_offload\_utils.php](/changeset/3086306/optimole-wp/trunk/inc/traits/dam_offload_utils.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/traits/dam_offload_utils.php")

  | [r3005642](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L224 "Show revision 3005642 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3086306#L224 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 224 | 224 | return strpos( $url, '-scaled.' ) !== false; |
  | 225 | 225 | } |
  |  | 226 |  |
  |  | 227 | /\*\* |
  |  | 228 | \* Check if the image has been offloaded completely. |
  |  | 229 | \* |
  |  | 230 | \* @param int $id The attachment ID. |
  |  | 231 | \* |
  |  | 232 | \* @return bool |
  |  | 233 | \*/ |
  |  | 234 | private function is\_completed\_offload( $id ) { |
  |  | 235 | // This is the flag that is used to mark the image as offloaded at the end. |
  |  | 236 | $completed = ! empty( get\_post\_meta( $id, Optml\_Media\_Offload::OM\_OFFLOADED\_FLAG, true ) ); |
  |  | 237 | if ( $completed ) { |
  |  | 238 | return true; |
  |  | 239 | } |
  |  | 240 | // In some rare cases the image is offloaded but the flag is not set so we can alternatively check this using the file path. |
  |  | 241 | $meta = wp\_get\_attachment\_metadata( $id ); |
  |  | 242 | if ( ! isset( $meta['file'] ) ) { |
  |  | 243 | return false; |
  |  | 244 | } |
  |  | 245 | if ( Optml\_Media\_Offload::is\_uploaded\_image( $meta['file'] ) ) { |
  |  | 246 | return true; |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 | return false; |
  |  | 250 | } |
  | 226 | 251 | /\*\* |
  | 227 | 252 | \* Get the attachment ID from URL. |
  | 228 | 253 | \* |
  | 229 |  | \* @param string $url The attachment URL. |
  |  | 254 | \* @param string $input\_url The attachment URL. |
  | 230 | 255 | \* |
  | 231 | 256 | \* @return int |
  | 232 | 257 | \*/ |
  | 233 |  | private function attachment\_url\_to\_post\_id( $url ) { |
  | 234 |  | $cached = Optml\_Attachment\_Cache::get\_cached\_attachment\_id( $url ); |
  |  | 258 | private function attachment\_url\_to\_post\_id( $input\_url ) { |
  |  | 259 | $cached = Optml\_Attachment\_Cache::get\_cached\_attachment\_id( $input\_url ); |
  | 235 | 260 |  |
  | 236 | 261 | if ( $cached !== false ) { |
  | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L238) | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3086306#L263) |  |
  | 238 | 263 | } |
  | 239 | 264 |  |
  | 240 |  | $url = $this->strip\_image\_size( $url ); |
  |  | 265 | $url = $this->strip\_image\_size( $input\_url ); |
  | 241 | 266 |  |
  | 242 | 267 | $attachment\_id = attachment\_url\_to\_postid( $url ); |
  | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3005642#L248) | […](/browser/optimole-wp/trunk/inc/traits/dam_offload_utils.php?rev=3086306#L273) |  |
  | 248 | 273 | } |
  | 249 | 274 |  |
  | 250 |  | Optml\_Attachment\_Cache::set\_cached\_attachment\_id( $url, $attachment\_id ); |
  |  | 275 | /\* |
  |  | 276 | \* TODO: The logic is a mess, we need to refactor at some point. |
  |  | 277 | \* Websites may transition between 'www' subdomains and apex domains, potentially breaking references to hosted images. This can cause issues when attempting to match attachment IDs if images are linked using outdated domains. The logic is checking for alternative domains and consider the use of 'scaled' prefixes in image URLs for large images, which might affect ID matching. |
  |  | 278 | \*/ |
  |  | 279 | if ( $attachment\_id === 0 ) { |
  |  | 280 | if ( strpos( $url, 'www.' ) !== false ) { |
  |  | 281 | $variant\_url   = str\_replace( 'www.', '', $url ); |
  |  | 282 | $attachment\_id = attachment\_url\_to\_postid( $variant\_url ); |
  |  | 283 | } else { |
  |  | 284 | $variant\_url   = str\_replace( '://', '://www.', $url ); |
  |  | 285 | $attachment\_id = attachment\_url\_to\_postid( $variant\_url ); |
  |  | 286 | } |
  |  | 287 | if ( $attachment\_id === 0 && ! $this->is\_scaled\_url( $variant\_url ) ) { |
  |  | 288 | $scaled\_url = $this->get\_scaled\_url( $variant\_url ); |
  |  | 289 |  |
  |  | 290 | $attachment\_id = attachment\_url\_to\_postid( $scaled\_url ); |
  |  | 291 | } |
  |  | 292 | } |
  |  | 293 | Optml\_Attachment\_Cache::set\_cached\_attachment\_id( $input\_url, $attachment\_id ); |
  | 251 | 294 |  |
  | 252 | 295 | return $attachment\_id; |
* ## [optimole-wp/trunk/inc/traits/normalizer.php](/changeset/3086306/optimole-wp/trunk/inc/traits/normalizer.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/traits/normalizer.php")

  | [r2935150](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L1 "Show revision 2935150 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Resource\ImageProperty\ResizeTypeProperty; |
  |  | 4 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 5 |  |
  | 3 | 6 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L168) | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L171) |  |
  | 168 | 171 | if ( $crop\_args === true ) { |
  | 169 | 172 | return [ |
  | 170 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 173 | 'type'    => ResizeTypeProperty::FILL, |
  | 171 | 174 | 'enlarge' => $enlarge, |
  | 172 |  | 'gravity' => ~~Optml\_Resize::GRAVITY\_~~CENTER, |
  |  | 175 | 'gravity' => Position::CENTER, |
  | 173 | 176 | ]; |
  | 174 | 177 | } |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L188) | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L191) |  |
  | 188 | 191 | ]; |
  | 189 | 192 | $allowed\_gravities = [ |
  | 190 |  | 'left'         => ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 191 |  | 'right'        => ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 192 |  | 'top'          => ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 193 |  | 'bottom'       => ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 194 |  | 'lefttop'      => ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 195 |  | 'leftbottom'   => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  | 196 |  | 'righttop'     => ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 197 |  | 'rightbottom'  => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  |  | 193 | 'left'         => Position::WEST, |
  |  | 194 | 'right'        => Position::EAST, |
  |  | 195 | 'top'          => Position::NORTH, |
  |  | 196 | 'bottom'       => Position::SOUTH, |
  |  | 197 | 'lefttop'      => Position::NORTH\_WEST, |
  |  | 198 | 'leftbottom'   => Position::SOUTH\_WEST, |
  |  | 199 | 'righttop'     => Position::NORTH\_EAST, |
  |  | 200 | 'rightbottom'  => Position::SOUTH\_EAST, |
  | 198 | 201 | 'centertop'    => [ 0.5, 0 ], |
  | 199 | 202 | 'centerbottom' => [ 0.5, 1 ], |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L202) | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L205) |  |
  | 202 | 205 | ]; |
  | 203 | 206 |  |
  | 204 |  | $gravity    = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 207 | $gravity    = Position::CENTER; |
  | 205 | 208 | $key\_search = ( $crop\_args[0] === true ? '' : |
  | 206 | 209 | ( isset( $allowed\_x[ $crop\_args[0] ] ) ? $crop\_args[0] : '' ) ) . |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L213) | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L216) |  |
  | 213 | 216 |  |
  | 214 | 217 | return [ |
  | 215 |  | 'type'    => ~~Optml\_Resize::RESIZE\_~~FILL, |
  |  | 218 | 'type'    => ResizeTypeProperty::FILL, |
  | 216 | 219 | 'enlarge' => $enlarge, |
  | 217 | 220 | 'gravity' => $gravity, |
  | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=2935150#L228) | […](/browser/optimole-wp/trunk/inc/traits/normalizer.php?rev=3086306#L231) |  |
  | 228 | 231 | public function to\_optml\_watermark( $watermark\_args = [] ) { |
  | 229 | 232 | $allowed\_gravities = [ |
  | 230 |  | 'left'         => ~~Optml\_Resize::GRAVITY\_~~WEST, |
  | 231 |  | 'right'        => ~~Optml\_Resize::GRAVITY\_~~EAST, |
  | 232 |  | 'top'          => ~~Optml\_Resize::GRAVITY\_~~NORTH, |
  | 233 |  | 'bottom'       => ~~Optml\_Resize::GRAVITY\_~~SOUTH, |
  | 234 |  | 'left\_top'     => ~~Optml\_Resize::GRAVITY\_~~NORTH\_WEST, |
  | 235 |  | 'left\_bottom'  => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_WEST, |
  | 236 |  | 'right\_top'    => ~~Optml\_Resize::GRAVITY\_~~NORTH\_EAST, |
  | 237 |  | 'right\_bottom' => ~~Optml\_Resize::GRAVITY\_~~SOUTH\_EAST, |
  | 238 |  | ]; |
  | 239 |  | $gravity           = ~~Optml\_Resize::GRAVITY\_~~CENTER; |
  |  | 233 | 'left'         => Position::WEST, |
  |  | 234 | 'right'        => Position::EAST, |
  |  | 235 | 'top'          => Position::NORTH, |
  |  | 236 | 'bottom'       => Position::SOUTH, |
  |  | 237 | 'left\_top'     => Position::NORTH\_WEST, |
  |  | 238 | 'left\_bottom'  => Position::SOUTH\_WEST, |
  |  | 239 | 'right\_top'    => Position::NORTH\_EAST, |
  |  | 240 | 'right\_bottom' => Position::SOUTH\_EAST, |
  |  | 241 | ]; |
  |  | 242 | $gravity           = Position::CENTER; |
  | 240 | 243 | if ( isset( $watermark\_args['position'] ) && array\_key\_exists( $watermark\_args['position'], $allowed\_gravities ) ) { |
  | 241 | 244 | $gravity = $allowed\_gravities[ $watermark\_args['position'] ]; |
* ## [optimole-wp/trunk/inc/url\_replacer.php](/changeset/3086306/optimole-wp/trunk/inc/url_replacer.php "Show the changeset 3086306 restricted to optimole-wp/trunk/inc/url_replacer.php")

  | [r3005642](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L1 "Show revision 3005642 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | use Optimole\Sdk\Optimole; |
  |  | 4 | use Optimole\Sdk\Resource\Image; |
  |  | 5 | use Optimole\Sdk\Resource\ImageProperty\GravityProperty; |
  |  | 6 | use Optimole\Sdk\ValueObject\Position; |
  | 2 | 7 |  |
  | 3 | 8 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L38) | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L43) |  |
  | 38 | 43 | } |
  | 39 | 44 |  |
  | 40 |  | ~~/\*\*~~ |
  | 41 |  | ~~\* A filter which turns a local url into an optimized CDN image url or an array of image urls.~~ |
  | 42 |  | ~~\*~~ |
  | 43 |  | ~~\* @param string|array $url The url which should be replaced.~~ |
  | 44 |  | ~~\*~~ |
  | 45 |  | ~~\* @return string|array Replaced url.~~ |
  | 46 |  | ~~\*/~~ |
  | 47 |  | ~~public function replace\_option\_url( $url ) {~~ |
  | 48 |  | ~~if ( empty( $url ) ) {~~ |
  | 49 |  | ~~return $url;~~ |
  | 50 |  | ~~}~~ |
  | 51 |  |  |
  | 52 |  | ~~// $url might be an array or an json encoded array with urls.~~ |
  | 53 |  | ~~if ( is\_array( $url ) || filter\_var( $url, FILTER\_VALIDATE\_URL ) === false ) {~~ |
  | 54 |  | ~~$array   = $url;~~ |
  | 55 |  | ~~$encoded = false;~~ |
  | 56 |  |  |
  | 57 |  | ~~// it might a json encoded array~~ |
  | 58 |  | ~~if ( is\_string( $url ) ) {~~ |
  | 59 |  | ~~$array   = json\_decode( $url, true );~~ |
  | 60 |  | ~~$encoded = true;~~ |
  | 61 |  | ~~}~~ |
  | 62 |  |  |
  | 63 |  | ~~// in case there is an array, apply it recursively.~~ |
  | 64 |  | ~~if ( is\_array( $array ) ) {~~ |
  | 65 |  | ~~foreach ( $array as $index => $value ) {~~ |
  | 66 |  | ~~$array[ $index ] = $this->replace\_option\_url( $value );~~ |
  | 67 |  | ~~}~~ |
  | 68 |  |  |
  | 69 |  | ~~if ( $encoded ) {~~ |
  | 70 |  | ~~return json\_encode( $array );~~ |
  | 71 |  | ~~}~~ |
  | 72 |  |  |
  | 73 |  | ~~return $array;~~ |
  | 74 |  | ~~}~~ |
  | 75 |  |  |
  | 76 |  | ~~if ( filter\_var( $url, FILTER\_VALIDATE\_URL ) === false ) {~~ |
  | 77 |  | ~~return $url;~~ |
  | 78 |  | ~~}~~ |
  | 79 |  | ~~}~~ |
  | 80 |  |  |
  | 81 |  | ~~return apply\_filters( 'optml\_content\_url', $url );~~ |
  | 82 |  | ~~}~~ |
  | 83 | 45 |  |
  | 84 | 46 | /\*\* |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L90) | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L52) |  |
  | 90 | 52 | parent::init(); |
  | 91 | 53 |  |
  | 92 |  | ~~Optml\_Quality::$default\_quality = $this->to\_accepted\_quality( $this->settings->get\_quality() );~~ |
  | 93 |  | ~~Optml\_Image::$watermark         = new Optml\_Watermark( $this->settings->get\_site\_settings()['watermark'] );~~ |
  | 94 |  | ~~Optml\_Resize::$default\_enlarge  = apply\_filters( 'optml\_always\_enlarge', false );~~ |
  | 95 | 54 | add\_filter( 'optml\_content\_url', [ $this, 'build\_url' ], 1, 2 ); |
  | 96 | 55 |  |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L191) | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L150) |  |
  | 191 | 150 | } |
  | 192 | 151 | } else { |
  | 193 |  | $new\_url = ( new Optml\_Asset( $url, $args, $this->active\_cache\_buster\_assets, $this->is\_css\_minify\_on, $this->is\_js\_minify\_on ) )->get\_url(); |
  |  | 152 | $asset = Optimole::asset( $url, $this->active\_cache\_buster\_assets ); |
  |  | 153 |  |
  |  | 154 | if ( stripos( $url, '.css' ) || stripos( $url, '.js' ) ) { |
  |  | 155 | $asset->quality(); |
  |  | 156 | } |
  |  | 157 |  |
  |  | 158 | $asset->minify( ( $this->is\_css\_minify\_on && str\_ends\_with( strtolower( $url ), '.css' ) ) || ( $this->is\_js\_minify\_on && str\_ends\_with( strtolower( $url ), '.js' ) ) ); |
  |  | 159 |  |
  |  | 160 | return $asset->getUrl(); |
  | 194 | 161 | } |
  | 195 | 162 | return $is\_slashed ? addcslashes( $new\_url, '/' ) : $new\_url; |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L253) | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L220) |  |
  | 253 | 220 | } |
  | 254 | 221 |  |
  |  | 222 | if ( empty( $args['quality'] ) ) { |
  |  | 223 | $args['quality'] = $this->to\_accepted\_quality( $this->settings->get\_quality() ); |
  |  | 224 | } |
  |  | 225 |  |
  | 255 | 226 | if ( isset( $args['resize'], $args['resize']['gravity'] ) && $this->settings->is\_smart\_cropping() ) { |
  | 256 |  | $args['resize']['gravity'] = ~~Optml\_Resize::GRAVITY\_~~SMART; |
  |  | 227 | $args['resize']['gravity'] = GravityProperty::SMART; |
  | 257 | 228 | } |
  | 258 | 229 |  |
  | 259 | 230 | $args = apply\_filters( 'optml\_image\_args', $args, $original\_url ); |
  | 260 |  |  |
  | 261 |  | $arguments = [ |
  | 262 |  | 'apply\_watermark' => apply\_filters( 'optml\_apply\_watermark\_for', true, $url ), |
  | 263 |  | ]; |
  | 264 |  |  |
  | 265 |  | if ( isset( $args['format'] ) && ! empty( $args['format'] ) ) { |
  | 266 |  | $arguments['format'] = $args['format']; |
  | 267 |  | } |
  | 268 |  |  |
  | 269 |  | // If format is not already set, we use best format if it's enabled. |
  | 270 |  | if ( ! isset( $arguments['format'] ) && $this->settings->is\_best\_format() ) { |
  | 271 |  | $arguments['format'] = 'best'; |
  |  | 231 | $image = Optimole::image( apply\_filters( 'optml\_processed\_url', $url ), $this->active\_cache\_buster ); |
  |  | 232 |  |
  |  | 233 | $image->width( ! empty( $args['width'] ) ? $args['width'] : 'auto' ); |
  |  | 234 | $image->height( ! empty( $args['height'] ) ? $args['height'] : 'auto' ); |
  |  | 235 |  |
  |  | 236 | $image->quality( $args['quality'] ); |
  |  | 237 |  |
  |  | 238 | if ( ! empty( $args['resize'] ) ) { |
  |  | 239 | $this->apply\_resize( $image, $args['resize'] ); |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | if ( apply\_filters( 'optml\_apply\_watermark\_for', true, $url ) ) { |
  |  | 243 | $this->apply\_watermark( $image ); |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | if ( ! empty( $args['format'] ) ) { |
  |  | 247 | $image->format( (string) $args['format'] ); |
  |  | 248 | } elseif ( $this->settings->is\_best\_format() ) { |
  |  | 249 | // If format is not already set, we use best format if it's enabled. |
  |  | 250 | $image->format( 'best' ); |
  | 272 | 251 | } |
  | 273 | 252 |  |
  | 274 | 253 | if ( $this->settings->get( 'strip\_metadata' ) === 'disabled' ) { |
  | 275 |  | $arguments['strip\_metadata'] = '0'; |
  | 276 |  | } |
  | 277 |  |  |
  | 278 |  | if ( ! apply\_filters( 'optml\_should\_avif\_ext', true, $ext, $original\_url ) ) { |
  | 279 |  | $arguments['ignore\_avif'] = true; |
  | 280 |  | } |
  | 281 |  |  |
  | 282 |  | if ( ! isset( $arguments['ignore\_avif'] ) && $this->settings->get( 'avif' ) === 'disabled' ) { |
  | 283 |  | $arguments['ignore\_avif'] = true; |
  | 284 |  | } |
  | 285 |  |  |
  | 286 |  | return  ( new Optml\_Image( $url, $args, $this->active\_cache\_buster ) )->get\_url( $arguments ); |
  | 287 |  |  |
  |  | 254 | $image->stripMetadata( false ); |
  |  | 255 | } |
  |  | 256 |  |
  |  | 257 | if ( ! apply\_filters( 'optml\_should\_avif\_ext', true, $ext, $original\_url ) || $this->settings->get( 'avif' ) === 'disabled' ) { |
  |  | 258 | $image->ignoreAvif(); |
  |  | 259 | } |
  |  | 260 |  |
  |  | 261 | if ( apply\_filters( 'optml\_keep\_copyright', false ) === true ) { |
  |  | 262 | $image->keepCopyright(); |
  |  | 263 | } |
  |  | 264 |  |
  |  | 265 | if ( $this->is\_dam\_url( $image->getSource() ) ) { |
  |  | 266 | return $this->get\_dam\_url( $image ); |
  |  | 267 | } |
  |  | 268 |  |
  |  | 269 | $offloaded\_id = $this->is\_offloaded\_url( $image->getSource() ); |
  |  | 270 |  |
  |  | 271 | if ( $offloaded\_id !== 0 ) { |
  |  | 272 | return $this->get\_offloaded\_url( $offloaded\_id, $image->getUrl(), $image->getSource() ); |
  |  | 273 | } |
  |  | 274 |  |
  |  | 275 | return $image->getUrl(); |
  | 288 | 276 | } |
  | 289 | 277 |  |
  | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3005642#L316) | […](/browser/optimole-wp/trunk/inc/url_replacer.php?rev=3086306#L304) |  |
  | 316 | 304 | \_doing\_it\_wrong( \_\_FUNCTION\_\_, esc\_html\_\_( 'Cheatin&#8217; huh?', 'optimole-wp' ), '1.0.0' ); |
  | 317 | 305 | } |
  |  | 306 |  |
  |  | 307 | /\*\* |
  |  | 308 | \* Apply resize to image. |
  |  | 309 | \* |
  |  | 310 | \* @param Image $image Image object. |
  |  | 311 | \* @param mixed $resize Resize arguments. |
  |  | 312 | \*/ |
  |  | 313 | private function apply\_resize( Image $image, $resize ) { |
  |  | 314 | if ( ! is\_array( $resize ) || empty( $resize['type'] ) ) { |
  |  | 315 | return; |
  |  | 316 | } |
  |  | 317 |  |
  |  | 318 | $image->resize( $resize['type'], $resize['gravity'] ?? Position::CENTER, $resize['enlarge'] ?? false ); |
  |  | 319 | } |
  |  | 320 |  |
  |  | 321 | /\*\* |
  |  | 322 | \* Apply watermark to image. |
  |  | 323 | \* |
  |  | 324 | \* @param Image $image Image object. |
  |  | 325 | \*/ |
  |  | 326 | private function apply\_watermark( Image $image ) { |
  |  | 327 | $settings = $this->settings->get\_site\_settings(); |
  |  | 328 |  |
  |  | 329 | if ( empty( $settings['watermark'] ) ) { |
  |  | 330 | return; |
  |  | 331 | } |
  |  | 332 |  |
  |  | 333 | $watermark = $settings['watermark']; |
  |  | 334 |  |
  |  | 335 | if ( ! isset( $watermark['id'], $watermark['opacity'], $watermark['position'] ) || $watermark['id'] <= 0 ) { |
  |  | 336 | return; |
  |  | 337 | } |
  |  | 338 |  |
  |  | 339 | $image->watermark( $watermark['id'], $watermark['opacity'], $watermark['position'], $watermark['x\_offset'] ?? 0, $watermark['y\_offset'] ?? 0, $watermark['scale'] ?? 0 ); |
  |  | 340 | } |
  |  | 341 |  |
  |  | 342 | /\*\* |
  |  | 343 | \* Get the DAM image URL. |
  |  | 344 | \* |
  |  | 345 | \* @param Image $image Image object. |
  |  | 346 | \* |
  |  | 347 | \* @return string |
  |  | 348 | \*/ |
  |  | 349 | private function get\_dam\_url( Image $image ) { |
  |  | 350 | // Remove DAM flag. |
  |  | 351 | $url = str\_replace( Optml\_Dam::URL\_DAM\_FLAG, '', $image->getSource() ); |
  |  | 352 |  |
  |  | 353 | foreach ( $image->getProperties() as $property ) { |
  |  | 354 | [ $name, $value ] = explode( ':', $property ); |
  |  | 355 |  |
  |  | 356 | // Check if the property exists in the URL, if so, replace it with the current property value. Otherwise, add it before the /q: param. |
  |  | 357 | $url = strpos( $url, '/' . $name . ':' ) !== false |
  |  | 358 | ? preg\_replace( '/\/' . $name . ':.\*?\//', '/' . $name . ':' . $value . '/', $url ) |
  |  | 359 | : str\_replace( '/q:', '/' . $name . ':' . $value . '/q:', $url ); |
  |  | 360 | } |
  |  | 361 |  |
  |  | 362 | return $url; |
  |  | 363 | } |
  |  | 364 |  |
  |  | 365 | /\*\* |
  |  | 366 | \* Check if this contains the DAM flag. |
  |  | 367 | \* |
  |  | 368 | \* @param string $url The URL to check. |
  |  | 369 | \* |
  |  | 370 | \* @return bool |
  |  | 371 | \*/ |
  |  | 372 | private function is\_dam\_url( $url ) { |
  |  | 373 | return is\_string( $url ) && strpos( $url, Optml\_Dam::URL\_DAM\_FLAG ) !== false; |
  |  | 374 | } |
  |  | 375 |  |
  |  | 376 | /\*\* |
  |  | 377 | \* Check if the URL is offloaded. |
  |  | 378 | \* |
  |  | 379 | \* @param string $source\_url The source image URL. |
  |  | 380 | \* |
  |  | 381 | \* @return int |
  |  | 382 | \*/ |
  |  | 383 | private function is\_offloaded\_url( $source\_url ) { |
  |  | 384 | $attachment\_id = 0; |
  |  | 385 |  |
  |  | 386 | if ( strpos( $source\_url, Optml\_Media\_Offload::KEYS['not\_processed\_flag'] ) !== false ) { |
  |  | 387 | $attachment\_id = (int) Optml\_Media\_Offload::get\_attachment\_id\_from\_url( $source\_url ); |
  |  | 388 | } else { |
  |  | 389 | $attachment\_id = $this->attachment\_url\_to\_post\_id( $source\_url ); |
  |  | 390 | } |
  |  | 391 |  |
  |  | 392 | if ( $attachment\_id === 0 ) { |
  |  | 393 | return 0; |
  |  | 394 | } |
  |  | 395 |  |
  |  | 396 | if ( ! $this->is\_completed\_offload( $attachment\_id ) ) { |
  |  | 397 | return 0; |
  |  | 398 | } |
  |  | 399 |  |
  |  | 400 | return (int) $attachment\_id; |
  |  | 401 | } |
  |  | 402 |  |
  |  | 403 | /\*\* |
  |  | 404 | \* Get the offloaded URL for an image. |
  |  | 405 | \* |
  |  | 406 | \* @param int    $id The attachment ID. |
  |  | 407 | \* @param string $optimized\_url The optimized image URL. |
  |  | 408 | \* @param string $source\_url The source image URL. |
  |  | 409 | \* |
  |  | 410 | \* @return string |
  |  | 411 | \*/ |
  |  | 412 | private function get\_offloaded\_url( $id, $optimized\_url, $source\_url ) { |
  |  | 413 | $suffix   = wp\_get\_attachment\_metadata( $id )['file']; |
  |  | 414 |  |
  |  | 415 | return str\_replace( $source\_url, ltrim( $suffix, '/' ), $optimized\_url ); |
  |  | 416 | } |
  | 318 | 417 | } |
* ## [optimole-wp/trunk/optimole-wp.php](/changeset/3086306/optimole-wp/trunk/optimole-wp.php "Show the changeset 3086306 restricted to optimole-wp/trunk/optimole-wp.php")

  | [r3073660](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L3 "Show revision 3073660 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/optimole-wp.php?rev=3086306#L3 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name:       Image optimization service by Optimole |
  | 4 | 4 | \* Description:       Complete handling of your website images. |
  | 5 |  | \* Version:           3.1~~2.1~~0 |
  |  | 5 | \* Version:           3.13.0 |
  | 6 | 6 | \* Author:            Optimole |
  | 7 | 7 | \* Author URI:        https://optimole.com |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L62) | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3086306#L62) |  |
  | 62 | 62 | \_\_( '%1$s You\'re using a PHP version lower than %2$s! %3$sOptimole%4$s requires at least %5$sPHP %2$s%6$s to function properly. Plugin has been deactivated. %7$sLearn more here%8$s. %9$s', 'optimole-wp' ), |
  | 63 | 63 | '<p>', |
  | 64 |  | '~~5~~.4', |
  |  | 64 | '7.4', |
  | 65 | 65 | '<b>', |
  | 66 | 66 | '</b>', |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L82) | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3086306#L82) |  |
  | 82 | 82 | \*/ |
  | 83 | 83 | function optml() { |
  | 84 |  | if ( version\_compare( PHP\_VERSION, '~~5~~.4.0', '<' ) ) { |
  |  | 84 | if ( version\_compare( PHP\_VERSION, '7.4.0', '<' ) ) { |
  | 85 | 85 | add\_action( 'admin\_notices', 'optml\_php\_notice' ); |
  | 86 | 86 | add\_action( 'admin\_init', 'optml\_deactivate' ); |
  | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3073660#L90) | […](/browser/optimole-wp/trunk/optimole-wp.php?rev=3086306#L90) |  |
  | 90 | 90 | define( 'OPTML\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) ); |
  | 91 | 91 | define( 'OPTML\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
  | 92 |  | define( 'OPTML\_VERSION', '3.1~~2.1~~0' ); |
  |  | 92 | define( 'OPTML\_VERSION', '3.13.0' ); |
  | 93 | 93 | define( 'OPTML\_NAMESPACE', 'optml' ); |
  | 94 | 94 | define( 'OPTML\_BASEFILE', \_\_FILE\_\_ ); |
* ## [optimole-wp/trunk/readme.txt](/changeset/3086306/optimole-wp/trunk/readme.txt "Show the changeset 3086306 restricted to optimole-wp/trunk/readme.txt")

  | [r3086305](/browser/optimole-wp/trunk/readme.txt?rev=3086305#L5 "Show revision 3086305 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/readme.txt?rev=3086306#L5 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 7.4 |
  | 7 |  | Stable tag: 3.1~~2.1~~0 |
  |  | 7 | Stable tag: 3.13.0 |
  | 8 | 8 | License: GPLv3 |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-3.0.en.html |
  | […](/browser/optimole-wp/trunk/readme.txt?rev=3086305#L151) | […](/browser/optimole-wp/trunk/readme.txt?rev=3086306#L151) |  |
  | 151 | 151 | == Changelog == |
  | 152 | 152 |  |
  | 153 |  | ##### [Version 3.12.10](https://github.com/Codeinwp/optimole-wp/compare/v3.12.9...v3.12.10) (2024-04-19) |
  | 154 |  |  |
  | 155 |  | - Addressed an issue with offloading/rollback transfers getting stuck by adding a check for scheduled cron jobs. If no cron is scheduled and a transfer is in progress, the cron will be rescheduled. |
  |  | 153 | #### [Version 3.13.0](https://github.com/Codeinwp/optimole-wp/compare/v3.12.10...v3.13.0) (2024-05-14) |
  |  | 154 |  |
  |  | 155 | - Optimole is now fully translated into German! This update makes our service more convenient for our German-speaking customers and helps you support your German-speaking clients more effectively. |
  |  | 156 | - We now have a PHP SDK available on GitHub: [Optimole PHP SDK](https://github.com/Optimole/optimole-php-sdk). This SDK simplifies the integration of Optimole’s features with any PHP-based website, making the process straightforward and efficient. |
  |  | 157 | - You can now associate a billing email to receive invoices. For more details, check out our [documentation](https://docs.optimole.com/article/1992-setting-a-billing-email-for-invoice-delivery). |
  |  | 158 | - Weve improved Largest Contentful Paint (LCP) by prioritizing the loading of initial images that are not affected by lazy loading. |
  |  | 159 | - Weve also improved LCP by using the srcset attribute for non-lazyloaded images. |
  |  | 160 | - Weve fixed various issues with offload compatibility to ensure all images load properly, making the service more robust. |
  |  | 161 | - Weve resolved an issue where the offloading process was getting stuck on large websites, making the process smoother and more reliable. |
  |  | 162 | - Weve improved the handling and sanitization of SVG files. |
  | 156 | 163 |  |
  | 157 | 164 |  |
* ## [optimole-wp/trunk/vendor/autoload.php](/changeset/3086306/optimole-wp/trunk/vendor/autoload.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/autoload.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/autoload.php?rev=3056805#L23 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/autoload.php?rev=3086306#L23 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 24 | 24 |  |
  | 25 |  | return ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4::getLoader(); |
* ## [optimole-wp/trunk/vendor/composer/autoload\_classmap.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/autoload_classmap.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/autoload_classmap.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_classmap.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/autoload_classmap.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'Attribute' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/Attribute.php', |
  | 9 | 10 | 'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php', |
  |  | 11 | 'Optimole\\Sdk\\Optimole' => $vendorDir . '/codeinwp/optimole-sdk/src/Optimole.php', |
  |  | 12 | 'Optimole\\Sdk\\Resource\\AbstractResource' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AbstractResource.php', |
  |  | 13 | 'Optimole\\Sdk\\Resource\\Asset' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/Asset.php', |
  |  | 14 | 'Optimole\\Sdk\\Resource\\AssetProperty\\MinifyProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php', |
  |  | 15 | 'Optimole\\Sdk\\Resource\\AssetProperty\\TypeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php', |
  |  | 16 | 'Optimole\\Sdk\\Resource\\CacheBusterProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php', |
  |  | 17 | 'Optimole\\Sdk\\Resource\\Image' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/Image.php', |
  |  | 18 | 'Optimole\\Sdk\\Resource\\ImageProperty\\EnlargeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php', |
  |  | 19 | 'Optimole\\Sdk\\Resource\\ImageProperty\\FormatProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php', |
  |  | 20 | 'Optimole\\Sdk\\Resource\\ImageProperty\\GravityProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php', |
  |  | 21 | 'Optimole\\Sdk\\Resource\\ImageProperty\\HeightProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php', |
  |  | 22 | 'Optimole\\Sdk\\Resource\\ImageProperty\\IgnoreAvifProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php', |
  |  | 23 | 'Optimole\\Sdk\\Resource\\ImageProperty\\KeepCopyrightProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php', |
  |  | 24 | 'Optimole\\Sdk\\Resource\\ImageProperty\\QualityProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php', |
  |  | 25 | 'Optimole\\Sdk\\Resource\\ImageProperty\\ResizeTypeProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php', |
  |  | 26 | 'Optimole\\Sdk\\Resource\\ImageProperty\\StripMetadataProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php', |
  |  | 27 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WatermarkProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php', |
  |  | 28 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WidthProperty' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php', |
  |  | 29 | 'Optimole\\Sdk\\Resource\\PropertyInterface' => $vendorDir . '/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php', |
  |  | 30 | 'Optimole\\Sdk\\ValueObject\\Position' => $vendorDir . '/codeinwp/optimole-sdk/src/ValueObject/Position.php', |
  |  | 31 | 'PhpToken' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/PhpToken.php', |
  |  | 32 | 'Stringable' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/Stringable.php', |
  |  | 33 | 'Symfony\\Polyfill\\Php80\\Php80' => $vendorDir . '/symfony/polyfill-php80/Php80.php', |
  |  | 34 | 'Symfony\\Polyfill\\Php80\\PhpToken' => $vendorDir . '/symfony/polyfill-php80/PhpToken.php', |
  |  | 35 | 'UnhandledMatchError' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php', |
  |  | 36 | 'ValueError' => $vendorDir . '/symfony/polyfill-php80/Resources/stubs/ValueError.php', |
  |  | 37 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 38 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 39 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => $vendorDir . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 40 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => $vendorDir . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 41 | 'enshrined\\svgSanitize\\Helper' => $vendorDir . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 42 | 'enshrined\\svgSanitize\\Sanitizer' => $vendorDir . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 43 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 44 | 'enshrined\\svgSanitize\\data\\AllowedTags' => $vendorDir . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 45 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 46 | 'enshrined\\svgSanitize\\data\\TagInterface' => $vendorDir . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 47 | 'enshrined\\svgSanitize\\data\\XPath' => $vendorDir . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 10 | 48 | ); |
* ## [optimole-wp/trunk/vendor/composer/autoload\_files.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/autoload_files.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/autoload_files.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_files.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/autoload_files.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'a4a119a56e50fbb293281d9a48007e0e' => $vendorDir . '/symfony/polyfill-php80/bootstrap.php', |
  | 9 | 10 | '9fef4034ed73e26a337d9856ea126f7f' => $vendorDir . '/codeinwp/themeisle-sdk/load.php', |
  | 10 | 11 | ); |
* ## [optimole-wp/trunk/vendor/composer/autoload\_psr4.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/autoload_psr4.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/autoload_psr4.php")

  | [r2711072](/browser/optimole-wp/trunk/vendor/composer/autoload_psr4.php?rev=2711072#L7 "Show revision 2711072 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/autoload_psr4.php?rev=3086306#L7 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | return array( |
  |  | 9 | 'enshrined\\svgSanitize\\' => array($vendorDir . '/enshrined/svg-sanitize/src'), |
  |  | 10 | 'Symfony\\Polyfill\\Php80\\' => array($vendorDir . '/symfony/polyfill-php80'), |
  |  | 11 | 'Optimole\\Sdk\\' => array($vendorDir . '/codeinwp/optimole-sdk/src'), |
  | 9 | 12 | ); |
* ## [optimole-wp/trunk/vendor/composer/autoload\_real.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/autoload_real.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/autoload_real.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3056805#L3 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3086306#L3 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~ |
  |  | 5 | class ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4 |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3056805#L23) | […](/browser/optimole-wp/trunk/vendor/composer/autoload_real.php?rev=3086306#L23) |  |
  | 23 | 23 | } |
  | 24 | 24 |  |
  | 25 |  | spl\_autoload\_register(array('ComposerAutoloaderInit64430b9934df8fa232784c2a6edefb8c', 'loadClassLoader'), true, true); |
  |  | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  |  | 26 |  |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4', 'loadClassLoader'), true, true); |
  | 26 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 27 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~64430b9934df8fa232784c2a6edefb8c~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInitb09ce80fcc24ec469f3a2a57305119d4', 'loadClassLoader')); |
  | 28 | 30 |  |
  | 29 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 30 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::getInitializer($loader)); |
  | 31 | 33 |  |
  | 32 | 34 | $loader->register(true); |
  | 33 | 35 |  |
  | 34 |  | $filesToLoad = \Composer\Autoload\ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~::$files; |
  |  | 36 | $filesToLoad = \Composer\Autoload\ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$files; |
  | 35 | 37 | $requireFile = \Closure::bind(static function ($fileIdentifier, $file) { |
  | 36 | 38 | if (empty($GLOBALS['\_\_composer\_autoload\_files'][$fileIdentifier])) { |
* ## [optimole-wp/trunk/vendor/composer/autoload\_static.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/autoload_static.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/autoload_static.php")

  | [r3056805](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3056805#L5 "Show revision 3056805 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3086306#L5 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~64430b9934df8fa232784c2a6edefb8c~~ |
  |  | 7 | class ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4 |
  | 8 | 8 | { |
  | 9 | 9 | public static $files = array ( |
  |  | 10 | 'a4a119a56e50fbb293281d9a48007e0e' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/bootstrap.php', |
  | 10 | 11 | '9fef4034ed73e26a337d9856ea126f7f' => \_\_DIR\_\_ . '/..' . '/codeinwp/themeisle-sdk/load.php', |
  | 11 | 12 | ); |
  | 12 | 13 |  |
  |  | 14 | public static $prefixLengthsPsr4 = array ( |
  |  | 15 | 'e' => |
  |  | 16 | array ( |
  |  | 17 | 'enshrined\\svgSanitize\\' => 22, |
  |  | 18 | ), |
  |  | 19 | 'S' => |
  |  | 20 | array ( |
  |  | 21 | 'Symfony\\Polyfill\\Php80\\' => 23, |
  |  | 22 | ), |
  |  | 23 | 'O' => |
  |  | 24 | array ( |
  |  | 25 | 'Optimole\\Sdk\\' => 13, |
  |  | 26 | ), |
  |  | 27 | ); |
  |  | 28 |  |
  |  | 29 | public static $prefixDirsPsr4 = array ( |
  |  | 30 | 'enshrined\\svgSanitize\\' => |
  |  | 31 | array ( |
  |  | 32 | 0 => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src', |
  |  | 33 | ), |
  |  | 34 | 'Symfony\\Polyfill\\Php80\\' => |
  |  | 35 | array ( |
  |  | 36 | 0 => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80', |
  |  | 37 | ), |
  |  | 38 | 'Optimole\\Sdk\\' => |
  |  | 39 | array ( |
  |  | 40 | 0 => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src', |
  |  | 41 | ), |
  |  | 42 | ); |
  |  | 43 |  |
  | 13 | 44 | public static $classMap = array ( |
  |  | 45 | 'Attribute' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/Attribute.php', |
  | 14 | 46 | 'Composer\\InstalledVersions' => \_\_DIR\_\_ . '/..' . '/composer/InstalledVersions.php', |
  |  | 47 | 'Optimole\\Sdk\\Optimole' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Optimole.php', |
  |  | 48 | 'Optimole\\Sdk\\Resource\\AbstractResource' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AbstractResource.php', |
  |  | 49 | 'Optimole\\Sdk\\Resource\\Asset' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/Asset.php', |
  |  | 50 | 'Optimole\\Sdk\\Resource\\AssetProperty\\MinifyProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/MinifyProperty.php', |
  |  | 51 | 'Optimole\\Sdk\\Resource\\AssetProperty\\TypeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/AssetProperty/TypeProperty.php', |
  |  | 52 | 'Optimole\\Sdk\\Resource\\CacheBusterProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/CacheBusterProperty.php', |
  |  | 53 | 'Optimole\\Sdk\\Resource\\Image' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/Image.php', |
  |  | 54 | 'Optimole\\Sdk\\Resource\\ImageProperty\\EnlargeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/EnlargeProperty.php', |
  |  | 55 | 'Optimole\\Sdk\\Resource\\ImageProperty\\FormatProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/FormatProperty.php', |
  |  | 56 | 'Optimole\\Sdk\\Resource\\ImageProperty\\GravityProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/GravityProperty.php', |
  |  | 57 | 'Optimole\\Sdk\\Resource\\ImageProperty\\HeightProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/HeightProperty.php', |
  |  | 58 | 'Optimole\\Sdk\\Resource\\ImageProperty\\IgnoreAvifProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/IgnoreAvifProperty.php', |
  |  | 59 | 'Optimole\\Sdk\\Resource\\ImageProperty\\KeepCopyrightProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/KeepCopyrightProperty.php', |
  |  | 60 | 'Optimole\\Sdk\\Resource\\ImageProperty\\QualityProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/QualityProperty.php', |
  |  | 61 | 'Optimole\\Sdk\\Resource\\ImageProperty\\ResizeTypeProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/ResizeTypeProperty.php', |
  |  | 62 | 'Optimole\\Sdk\\Resource\\ImageProperty\\StripMetadataProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/StripMetadataProperty.php', |
  |  | 63 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WatermarkProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WatermarkProperty.php', |
  |  | 64 | 'Optimole\\Sdk\\Resource\\ImageProperty\\WidthProperty' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/ImageProperty/WidthProperty.php', |
  |  | 65 | 'Optimole\\Sdk\\Resource\\PropertyInterface' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/Resource/PropertyInterface.php', |
  |  | 66 | 'Optimole\\Sdk\\ValueObject\\Position' => \_\_DIR\_\_ . '/..' . '/codeinwp/optimole-sdk/src/ValueObject/Position.php', |
  |  | 67 | 'PhpToken' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/PhpToken.php', |
  |  | 68 | 'Stringable' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/Stringable.php', |
  |  | 69 | 'Symfony\\Polyfill\\Php80\\Php80' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Php80.php', |
  |  | 70 | 'Symfony\\Polyfill\\Php80\\PhpToken' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/PhpToken.php', |
  |  | 71 | 'UnhandledMatchError' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/UnhandledMatchError.php', |
  |  | 72 | 'ValueError' => \_\_DIR\_\_ . '/..' . '/symfony/polyfill-php80/Resources/stubs/ValueError.php', |
  |  | 73 | 'enshrined\\svgSanitize\\ElementReference\\Resolver' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Resolver.php', |
  |  | 74 | 'enshrined\\svgSanitize\\ElementReference\\Subject' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Subject.php', |
  |  | 75 | 'enshrined\\svgSanitize\\ElementReference\\Usage' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/ElementReference/Usage.php', |
  |  | 76 | 'enshrined\\svgSanitize\\Exceptions\\NestingException' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Exceptions/NestingException.php', |
  |  | 77 | 'enshrined\\svgSanitize\\Helper' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Helper.php', |
  |  | 78 | 'enshrined\\svgSanitize\\Sanitizer' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/Sanitizer.php', |
  |  | 79 | 'enshrined\\svgSanitize\\data\\AllowedAttributes' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedAttributes.php', |
  |  | 80 | 'enshrined\\svgSanitize\\data\\AllowedTags' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AllowedTags.php', |
  |  | 81 | 'enshrined\\svgSanitize\\data\\AttributeInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/AttributeInterface.php', |
  |  | 82 | 'enshrined\\svgSanitize\\data\\TagInterface' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/TagInterface.php', |
  |  | 83 | 'enshrined\\svgSanitize\\data\\XPath' => \_\_DIR\_\_ . '/..' . '/enshrined/svg-sanitize/src/data/XPath.php', |
  | 15 | 84 | ); |
  | 16 | 85 |  |
  | […](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3056805#L18) | […](/browser/optimole-wp/trunk/vendor/composer/autoload_static.php?rev=3086306#L87) |  |
  | 18 | 87 | { |
  | 19 | 88 | return \Closure::bind(function () use ($loader) { |
  | 20 |  | $loader->classMap = ComposerStaticInit64430b9934df8fa232784c2a6edefb8c::$classMap; |
  |  | 89 | $loader->prefixLengthsPsr4 = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$prefixLengthsPsr4; |
  |  | 90 | $loader->prefixDirsPsr4 = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$prefixDirsPsr4; |
  |  | 91 | $loader->classMap = ComposerStaticInitb09ce80fcc24ec469f3a2a57305119d4::$classMap; |
  | 21 | 92 |  |
  | 22 | 93 | }, null, ClassLoader::class); |
* ## [optimole-wp/trunk/vendor/composer/installed.json](/changeset/3086306/optimole-wp/trunk/vendor/composer/installed.json "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/installed.json")

  | [r3071598](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3071598#L1 "Show revision 3071598 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3086306#L1 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | { |
  | 2 | 2 | "packages": [ |
  |  | 3 | { |
  |  | 4 | "name": "codeinwp/optimole-sdk", |
  |  | 5 | "version": "v1.0.0", |
  |  | 6 | "version\_normalized": "1.0.0.0", |
  |  | 7 | "source": { |
  |  | 8 | "type": "git", |
  |  | 9 | "url": "https://github.com/Codeinwp/optimole-php-sdk.git", |
  |  | 10 | "reference": "637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee" |
  |  | 11 | }, |
  |  | 12 | "dist": { |
  |  | 13 | "type": "zip", |
  |  | 14 | "url": "https://api.github.com/repos/Codeinwp/optimole-php-sdk/zipball/637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee", |
  |  | 15 | "reference": "637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee", |
  |  | 16 | "shasum": "" |
  |  | 17 | }, |
  |  | 18 | "require": { |
  |  | 19 | "php": ">=7.4", |
  |  | 20 | "symfony/polyfill-php80": "^1.29" |
  |  | 21 | }, |
  |  | 22 | "require-dev": { |
  |  | 23 | "friendsofphp/php-cs-fixer": "^3.0", |
  |  | 24 | "phpstan/phpstan": "^1.0", |
  |  | 25 | "phpunit/phpunit": "^9.6" |
  |  | 26 | }, |
  |  | 27 | "time": "2024-04-07T10:55:45+00:00", |
  |  | 28 | "type": "library", |
  |  | 29 | "installation-source": "dist", |
  |  | 30 | "autoload": { |
  |  | 31 | "psr-4": { |
  |  | 32 | "Optimole\\Sdk\\": "src" |
  |  | 33 | } |
  |  | 34 | }, |
  |  | 35 | "notification-url": "https://packagist.org/downloads/", |
  |  | 36 | "license": [ |
  |  | 37 | "MIT" |
  |  | 38 | ], |
  |  | 39 | "authors": [ |
  |  | 40 | { |
  |  | 41 | "name": "Optimole Team", |
  |  | 42 | "email": "friends@optimole.com", |
  |  | 43 | "homepage": "https://optimole.com" |
  |  | 44 | } |
  |  | 45 | ], |
  |  | 46 | "description": "SDK for Optimole cloud-based image optimization service", |
  |  | 47 | "homepage": "https://optimole.com", |
  |  | 48 | "support": { |
  |  | 49 | "issues": "https://github.com/Codeinwp/codeinwp/optimole-php-sdk/issues", |
  |  | 50 | "source": "https://github.com/Codeinwp/optimole-php-sdk" |
  |  | 51 | }, |
  |  | 52 | "install-path": "../codeinwp/optimole-sdk" |
  |  | 53 | }, |
  | 3 | 54 | { |
  | 4 | 55 | "name": "codeinwp/themeisle-sdk", |
  | […](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3071598#L43) | […](/browser/optimole-wp/trunk/vendor/composer/installed.json?rev=3086306#L94) |  |
  | 43 | 94 | }, |
  | 44 | 95 | "install-path": "../codeinwp/themeisle-sdk" |
  |  | 96 | }, |
  |  | 97 | { |
  |  | 98 | "name": "enshrined/svg-sanitize", |
  |  | 99 | "version": "0.18.0", |
  |  | 100 | "version\_normalized": "0.18.0.0", |
  |  | 101 | "source": { |
  |  | 102 | "type": "git", |
  |  | 103 | "url": "https://github.com/darylldoyle/svg-sanitizer.git", |
  |  | 104 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0" |
  |  | 105 | }, |
  |  | 106 | "dist": { |
  |  | 107 | "type": "zip", |
  |  | 108 | "url": "https://api.github.com/repos/darylldoyle/svg-sanitizer/zipball/6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 109 | "reference": "6a2c069dab3843ca4d887ff09c972fc7033888d0", |
  |  | 110 | "shasum": "" |
  |  | 111 | }, |
  |  | 112 | "require": { |
  |  | 113 | "ext-dom": "\*", |
  |  | 114 | "ext-libxml": "\*", |
  |  | 115 | "php": "^5.6 || ^7.0 || ^8.0" |
  |  | 116 | }, |
  |  | 117 | "require-dev": { |
  |  | 118 | "phpunit/phpunit": "^5.7 || ^6.5 || ^8.5" |
  |  | 119 | }, |
  |  | 120 | "time": "2024-02-22T17:51:05+00:00", |
  |  | 121 | "type": "library", |
  |  | 122 | "installation-source": "dist", |
  |  | 123 | "autoload": { |
  |  | 124 | "psr-4": { |
  |  | 125 | "enshrined\\svgSanitize\\": "src" |
  |  | 126 | } |
  |  | 127 | }, |
  |  | 128 | "notification-url": "https://packagist.org/downloads/", |
  |  | 129 | "license": [ |
  |  | 130 | "GPL-2.0-or-later" |
  |  | 131 | ], |
  |  | 132 | "authors": [ |
  |  | 133 | { |
  |  | 134 | "name": "Daryll Doyle", |
  |  | 135 | "email": "daryll@enshrined.co.uk" |
  |  | 136 | } |
  |  | 137 | ], |
  |  | 138 | "description": "An SVG sanitizer for PHP", |
  |  | 139 | "support": { |
  |  | 140 | "issues": "https://github.com/darylldoyle/svg-sanitizer/issues", |
  |  | 141 | "source": "https://github.com/darylldoyle/svg-sanitizer/tree/0.18.0" |
  |  | 142 | }, |
  |  | 143 | "install-path": "../enshrined/svg-sanitize" |
  |  | 144 | }, |
  |  | 145 | { |
  |  | 146 | "name": "symfony/polyfill-php80", |
  |  | 147 | "version": "v1.29.0", |
  |  | 148 | "version\_normalized": "1.29.0.0", |
  |  | 149 | "source": { |
  |  | 150 | "type": "git", |
  |  | 151 | "url": "https://github.com/symfony/polyfill-php80.git", |
  |  | 152 | "reference": "87b68208d5c1188808dd7839ee1e6c8ec3b02f1b" |
  |  | 153 | }, |
  |  | 154 | "dist": { |
  |  | 155 | "type": "zip", |
  |  | 156 | "url": "https://api.github.com/repos/symfony/polyfill-php80/zipball/87b68208d5c1188808dd7839ee1e6c8ec3b02f1b", |
  |  | 157 | "reference": "87b68208d5c1188808dd7839ee1e6c8ec3b02f1b", |
  |  | 158 | "shasum": "" |
  |  | 159 | }, |
  |  | 160 | "require": { |
  |  | 161 | "php": ">=7.1" |
  |  | 162 | }, |
  |  | 163 | "time": "2024-01-29T20:11:03+00:00", |
  |  | 164 | "type": "library", |
  |  | 165 | "extra": { |
  |  | 166 | "thanks": { |
  |  | 167 | "name": "symfony/polyfill", |
  |  | 168 | "url": "https://github.com/symfony/polyfill" |
  |  | 169 | } |
  |  | 170 | }, |
  |  | 171 | "installation-source": "dist", |
  |  | 172 | "autoload": { |
  |  | 173 | "files": [ |
  |  | 174 | "bootstrap.php" |
  |  | 175 | ], |
  |  | 176 | "psr-4": { |
  |  | 177 | "Symfony\\Polyfill\\Php80\\": "" |
  |  | 178 | }, |
  |  | 179 | "classmap": [ |
  |  | 180 | "Resources/stubs" |
  |  | 181 | ] |
  |  | 182 | }, |
  |  | 183 | "notification-url": "https://packagist.org/downloads/", |
  |  | 184 | "license": [ |
  |  | 185 | "MIT" |
  |  | 186 | ], |
  |  | 187 | "authors": [ |
  |  | 188 | { |
  |  | 189 | "name": "Ion Bazan", |
  |  | 190 | "email": "ion.bazan@gmail.com" |
  |  | 191 | }, |
  |  | 192 | { |
  |  | 193 | "name": "Nicolas Grekas", |
  |  | 194 | "email": "p@tchwork.com" |
  |  | 195 | }, |
  |  | 196 | { |
  |  | 197 | "name": "Symfony Community", |
  |  | 198 | "homepage": "https://symfony.com/contributors" |
  |  | 199 | } |
  |  | 200 | ], |
  |  | 201 | "description": "Symfony polyfill backporting some PHP 8.0+ features to lower PHP versions", |
  |  | 202 | "homepage": "https://symfony.com", |
  |  | 203 | "keywords": [ |
  |  | 204 | "compatibility", |
  |  | 205 | "polyfill", |
  |  | 206 | "portable", |
  |  | 207 | "shim" |
  |  | 208 | ], |
  |  | 209 | "support": { |
  |  | 210 | "source": "https://github.com/symfony/polyfill-php80/tree/v1.29.0" |
  |  | 211 | }, |
  |  | 212 | "funding": [ |
  |  | 213 | { |
  |  | 214 | "url": "https://symfony.com/sponsor", |
  |  | 215 | "type": "custom" |
  |  | 216 | }, |
  |  | 217 | { |
  |  | 218 | "url": "https://github.com/fabpot", |
  |  | 219 | "type": "github" |
  |  | 220 | }, |
  |  | 221 | { |
  |  | 222 | "url": "https://tidelift.com/funding/github/packagist/symfony/symfony", |
  |  | 223 | "type": "tidelift" |
  |  | 224 | } |
  |  | 225 | ], |
  |  | 226 | "install-path": "../symfony/polyfill-php80" |
  | 45 | 227 | } |
  | 46 | 228 | ], |
* ## [optimole-wp/trunk/vendor/composer/installed.php](/changeset/3086306/optimole-wp/trunk/vendor/composer/installed.php "Show the changeset 3086306 restricted to optimole-wp/trunk/vendor/composer/installed.php")

  | [r3071598](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3071598#L11 "Show revision 3071598 of this file in browser") | [r3086306](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3086306#L11 "Show revision 3086306 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | ), |
  | 12 | 12 | 'versions' => array( |
  |  | 13 | 'codeinwp/optimole-sdk' => array( |
  |  | 14 | 'pretty\_version' => 'v1.0.0', |
  |  | 15 | 'version' => '1.0.0.0', |
  |  | 16 | 'reference' => '637260ec52bdc0efb84c5b8ac30ac7dbd4c323ee', |
  |  | 17 | 'type' => 'library', |
  |  | 18 | 'install\_path' => \_\_DIR\_\_ . '/../codeinwp/optimole-sdk', |
  |  | 19 | 'aliases' => array(), |
  |  | 20 | 'dev\_requirement' => false, |
  |  | 21 | ), |
  | 13 | 22 | 'codeinwp/optimole-wp' => array( |
  | 14 | 23 | 'pretty\_version' => '1.1.2', |
  | […](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3071598#L29) | […](/browser/optimole-wp/trunk/vendor/composer/installed.php?rev=3086306#L38) |  |
  | 29 | 38 | 'dev\_requirement' => false, |
  | 30 | 39 | ), |
  |  | 40 | 'enshrined/svg-sanitize' => array( |
  |  | 41 | 'pretty\_version' => '0.18.0', |
  |  | 42 | 'version' => '0.18.0.0', |
  |  | 43 | 'reference' => '6a2c069dab3843ca4d887ff09c972fc7033888d0', |
  |  | 44 | 'type' => 'library', |
  |  | 45 | 'install\_path' => \_\_DIR\_\_ . '/../enshrined/svg-sanitize', |
  |  | 46 | 'aliases' => array(), |
  |  | 47 | 'dev\_requirement' => false, |
  |  | 48 | ), |
  |  | 49 | 'symfony/polyfill-php80' => array( |
  |  | 50 | 'pretty\_version' => 'v1.29.0', |
  |  | 51 | 'version' => '1.29.0.0', |
  |  | 52 | 'reference' => '87b68208d5c1188808dd7839ee1e6c8ec3b02f1b', |
  |  | 53 | 'type' => 'library', |
  |  | 54 | 'install\_path' => \_\_DIR\_\_ . '/../symfony/polyfill-php80', |
  |  | 55 | 'aliases' => array(), |
  |  | 56 | 'dev\_requirement' => false, |
  |  | 57 | ), |
  | 31 | 58 | ), |
  | 32 | 59 | ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3086306)
* [Zip Archive](?format=zip&new=3086306)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


