
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYooooomi%2Fyour_spotify%2Fsecurity%2Fadvisories%2FGHSA-3782-758f-mj85)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYooooomi%2Fyour_spotify%2Fsecurity%2Fadvisories%2FGHSA-3782-758f-mj85)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Yooooomi%2Fyour_spotify)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Yooooomi](/Yooooomi)
/
**[your\_spotify](/Yooooomi/your_spotify)**
Public

* [Notifications](/login?return_to=%2FYooooomi%2Fyour_spotify) You must be signed in to change notification settings
* [Fork
  140](/login?return_to=%2FYooooomi%2Fyour_spotify)
* [Star
   3.3k](/login?return_to=%2FYooooomi%2Fyour_spotify)

* [Code](/Yooooomi/your_spotify)
* [Issues
  97](/Yooooomi/your_spotify/issues)
* [Pull requests
  7](/Yooooomi/your_spotify/pulls)
* [Discussions](/Yooooomi/your_spotify/discussions)
* [Actions](/Yooooomi/your_spotify/actions)
* [Projects
  0](/Yooooomi/your_spotify/projects)
* [Security](/Yooooomi/your_spotify/security)
* [Insights](/Yooooomi/your_spotify/pulse)

Additional navigation options

* [Code](/Yooooomi/your_spotify)
* [Issues](/Yooooomi/your_spotify/issues)
* [Pull requests](/Yooooomi/your_spotify/pulls)
* [Discussions](/Yooooomi/your_spotify/discussions)
* [Actions](/Yooooomi/your_spotify/actions)
* [Projects](/Yooooomi/your_spotify/projects)
* [Security](/Yooooomi/your_spotify/security)
* [Insights](/Yooooomi/your_spotify/pulse)

# Disclosure of Spotify API Access Tokens to Guest Users Using Public Tokens

Moderate

[Yooooomi](/Yooooomi)
published
GHSA-3782-758f-mj85
Mar 13, 2024

## Package

No package listed

## Affected versions

<1.8.0

## Patched versions

1.8.0

## Description

### Summary

YourSpotify version <1.8.0 allows users to create a public token in the settings, which can be used to provide guest-level access to the information of that specific user in YourSpotify. The `/me` API endpoint discloses Spotify API access and refresh tokens to guest users. Attackers with access to a public token for guest access to YourSpotify can therefore obtain access to Spotify API tokens of YourSpotify users.

As a consequence, attackers may extract profile information, information about listening habits, playlists and other information from the corresponding Spotify profile. In addition, the attacker can pause and resume playback in the Spotify app at will.

### Details

YourSpotify allows users to create a public token in the settings, which can be used to provide guest-level access to the information of that specific user in YourSpotify. The public token can be used by appending the `?token=<the-public-token>` parameter to frontend or backend calls. These public tokens are intended to be shared with a wider audience to let anyone with access to the token look at, but not modify, the data in the YourSpotify instance.

Not all backend endpoints are accessible to guest users using public tokens. However, the `/me` endpoint is available using a guest token and no other form of authentication. The response sent by the `/me` endpoint contains Spotify API access tokens and refresh tokens. Details can be found in the proof-of-concept below.

The root cause of this issue is that the implementation of the `/me` endpoint simply returns the full `User` object as it is stored in the MongoDB database without removing any sensitive fields, or better yet, only selectively extracting the required fields for the response. The corresponding code can be found in route `/me` in `server/src/routers/index.ts`:

[your\_spotify/server/src/routes/index.ts](https://github.com/Yooooomi/your_spotify/blob/b205bfb606fbc72f41eb79fb6fcb9a230bf8819d/server/src/routes/index.ts#L82-L88)

Lines 82 to 88
in
[b205bfb](/Yooooomi/your_spotify/commit/b205bfb606fbc72f41eb79fb6fcb9a230bf8819d)

|  | router.get('/me', optionalLoggedOrGuest, async (req, res) => { |
| --- | --- |
|  | const { user } = req as OptionalLoggedRequest; |
|  | if (user) { |
|  | return res.status(200).send({ status: true, user }); |
|  | } |
|  | return res.status(200).send({ status: false }); |
|  | }); |

The available fields in the `User` object can be found in interface `User` in `server/src/database/schemas/user.ts`:

[your\_spotify/server/src/database/schemas/user.ts](https://github.com/Yooooomi/your_spotify/blob/b205bfb606fbc72f41eb79fb6fcb9a230bf8819d/server/src/database/schemas/user.ts#L5-L26)

Lines 5 to 26
in
[b205bfb](/Yooooomi/your_spotify/commit/b205bfb606fbc72f41eb79fb6fcb9a230bf8819d)

|  | export interface User { |
| --- | --- |
|  | \_id: Types.ObjectId; |
|  | username: string; |
|  | admin: boolean; |
|  | spotifyId: string | null; |
|  | expiresIn: number; |
|  | accessToken: string | null; |
|  | refreshToken: string | null; |
|  | lastTimestamp: number; |
|  | tracks: Schema.Types.ObjectId[]; |
|  | settings: { |
|  | historyLine: boolean; |
|  | preferredStatsPeriod: string; |
|  | nbElements: number; |
|  | metricUsed: 'number' | 'duration'; |
|  | darkMode: DarkModeType; |
|  | timezone: string | undefined; |
|  | blacklistedArtists: string[]; |
|  | }; |
|  | lastImport: string | null; |
|  | publicToken: string | null; |
|  | firstListenedAt?: Date; |

### Proof of Concept

The following example `curl` command sends a request with a public token to the `/me` endpoint:

```
curl "http://backend.yourspotify.internal:8080/me?token=6f4f79d6-b957-4487-8d97-23569b6e7935"
```

The (formatted and redacted) JSON response to this command is shown below:

```
{
  "status": true,
  "user": {
    "settings": {
      "historyLine": false,
      "preferredStatsPeriod": "month",
      "nbElements": 10,
      "metricUsed": "number",
      "darkMode": "follow",
      "blacklistedArtists": []
    },
    "_id": "65ce739fca48dd258976a58a",
    "username": "<REDACTED>",
    "admin": true,
    "spotifyId": "<REDACTED>",
    "expiresIn": 1708119315677,
    "accessToken": "<REDACTED>",
    "refreshToken": "<REDACTED>",
    "lastTimestamp": 1708116272907,
    "lastImport": null,
    "publicToken": "6f4f79d6-b957-4487-8d97-23569b6e7935",
    "__v": 0,
    "firstListenedAt": "2024-02-15T15:03:15.946Z",
    "id": "65ce739fca48dd258976a58a"
  }
}
```

The fields `accessToken` and `refreshToken` are particularly interesting to an attacker, as these contain the actual access tokens and refresh tokens for the Spotify API (as in the real Spotify, not YourSpotify). An attacker can then use this access token to access all Spotify API endpoints YourSpotify has access to.

For example, the following `curl` command can be used to pause playback in a currently running Spotify session:

```
curl -X PUT \
     -H "Authorization: Bearer <REDACTED accessToken>" \
     "https://api.spotify.com/v1/me/player/pause"
```

The following command can be used to resume playback:

```
curl -X PUT \
     -H "Authorization: Bearer <REDACTED accessToken>" \
     "https://api.spotify.com/v1/me/player/play"
```

These calls are only intended as proof-of-concept examples. The tokens allow access to all Spotify API endpoints YourSpotify is authorized to access.

### Impact

YourSpotify exposes sensitive data, including Spotify API access and refresh tokens, to guest users that only have access to YourSpotify public tokens. Users do not expect that sharing their YourSpotify public token (which is intended to be shared) provides potential attackers access to actual Spotify API tokens.

As a consequence, attackers may extract profile information, information about listening habits, playlists and other information from the corresponding Spotify profile. In addition, the attacker can pause and resume playback in the Spotify app at will.

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-28193

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@RagingCactus](https://avatars.githubusercontent.com/u/1112236?s=40&v=4)](/RagingCactus)
  [RagingCactus](/RagingCactus)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

