=== Content from bugzilla.mozilla.org_db416853_20250110_202240.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1887332)
* [XML](/show_bug.cgi?ctype=xml&id=1887332)

Closed
[Bug 1887332](/show_bug.cgi?id=1887332)
(CVE-2024-4775)

Opened 10 months ago
Closed 9 months ago

# Null-deref at js::gc::HeaderWord::getAtomic() gc/Cell.h:100:12 with ReadGeckoProfilingStack

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Null-deref at js::gc::HeaderWord::getAtomic() gc/Cell.h:100:12 with ReadGeckoProfilingStack

## Categories

### (Core :: JavaScript: WebAssembly, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20WebAssembly#JavaScript%3A%20WebAssembly)

JavaScript: WebAssembly
▾

Core :: JavaScript: WebAssembly
Implementation of the WebAssembly (wasm) standard, including compilation and runtime support.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20WebAssembly)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: lukas.bernhard, Assigned: jandem)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/709c5feed942bf99f098bb24aa1cc86f?d=mm&size=40)  [jandem](/user_profile?user_id=375297)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/59307c6d3ba87d521f5443530ecf72a9?d=mm&size=40)  [lukas.bernhard](/user_profile?user_id=656084)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8db6b22eadf9c098ae78e6d0d0615e29?d=mm&size=40)  [rhunt](/user_profile?user_id=573202)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1887332&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1887332)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-low, Whiteboard: [adv-main126+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4775

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main126+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2128210_488993 "9 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [crash.js](/attachment.cgi?id=9392899)  [10 months ago](#c0)  [lukas.bernhard](/user_profile?user_id=656084)   981 bytes, text/plain |  | [Details](/attachment.cgi?id=9392899&action=edit) |
| --- | --- | --- |
| [poc-profile.js](/attachment.cgi?id=9393858)  [10 months ago](#c2)  [Ryan Hunt [:rhunt]](/user_profile?user_id=573202)   497 bytes, application/x-javascript |  | [Details](/attachment.cgi?id=9393858&action=edit) |
| [Bug 1887332 - Improve handling of WasmToJSJit frames in JSJitProfilingFrameIterator. r?rhunt!](/attachment.cgi?id=9395721)  [9 months ago](#c6)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9395721&action=edit) | [Review](/attachment.cgi?id=9395721) |
| [advisory.txt](/attachment.cgi?id=9401094)  [8 months ago](#c12)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   299 bytes, text/plain |  | [Details](/attachment.cgi?id=9401094&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1887332#c0)• 10 months ago |
|  | |

Attached file
[crash.js](attachment.cgi?id=9392899)
— [Details](attachment.cgi?id=9392899&action=edit)

Steps to reproduce:

On git commit f63ca2952da98e0817bdae0ddf1314281a497106 the attached sample crashes in the js-shell when accessing NULL, invoked as `obj-x86_64-pc-linux-gnu/dist/bin/js --fast-warmup --fuzzing-safe crash.js`

The issue seems to be related to GC and profiling; flagging as s-s as I'm not sure whether profiling is an actual prerequisite for the bug to manifest.

```
#0 0x5a1cefb4cea5 in js::gc::HeaderWord::getAtomic() const js/src/gc/Cell.h:100:12
#1 0x5a1cefb4cea5 in js::gc::HeaderWord::flags() const js/src/gc/Cell.h:116:36
#2 0x5a1cefb4cea5 in js::gc::HeaderWord::isForwarded() const js/src/gc/Cell.h:117:37
#3 0x5a1cefb4cea5 in js::gc::Cell::isForwarded() const js/src/gc/Cell.h:153:45
#4 0x5a1cefb4cea5 in bool js::gc::IsForwarded<js::Shape>(js::Shape const*) js/src/gc/Marking-inl.h:101:13
#5 0x5a1cefb4cea5 in js::Shape* js::gc::MaybeForwarded<js::Shape*>(js::Shape*) js/src/gc/Marking-inl.h:118:7
#6 0x5a1cefdcfa65 in js::NativeObject::numFixedSlotsMaybeForwarded() const js/src/vm/NativeObject-inl.h:55:10
#7 0x5a1cefdcfa65 in js::NativeObject::slotIsFixed(unsigned int) const js/src/vm/NativeObject.cpp:278:17
#8 0x5a1cef8f73cf in js::NativeObject::getFixedSlot(unsigned int) const js/src/vm/NativeObject.h:1340:5
#9 0x5a1cef8f73cf in JSFunction::flagsAndArgCountRaw() const js/src/vm/JSFunction.h:168:12
#10 0x5a1cef8f73cf in JSFunction::flags() const js/src/vm/JSFunction.h:178:35
#11 0x5a1cef8f73cf in JSFunction::isInterpreted() const js/src/vm/JSFunction.h:188:39
#12 0x5a1cef8f73cf in JSFunction::isIncomplete() const js/src/vm/JSFunction.h:528:12
#13 0x5a1cef8f722d in JSFunction::hasBytecode() const js/src/vm/JSFunction.h:226:5
#14 0x5a1cf0e94cdf in JSFunction::nonLazyScript() const js/src/vm/JSFunction.h:532:5
#15 0x5a1cf0e94cdf in js::jit::ScriptFromCalleeToken(void*) js/src/jit/ScriptFromCalleeToken.h:24:44
#16 0x5a1cf0e94cdf in js::jit::JSJitProfilingFrameIterator::frameScript() const js/src/jit/JSJitFrameIter-inl.h:41:10
#17 0x5a1cf0e945e7 in js::jit::JSJitProfilingFrameIterator::tryInitWithPC(void*) js/src/jit/JSJitFrameIter.cpp:579:22
#18 0x5a1cf0e940ce in js::jit::JSJitProfilingFrameIterator::JSJitProfilingFrameIterator(JSContext*, void*, void*) js/src/jit/JSJitFrameIter.cpp:524:7
#19 0x5a1ceffc1ccc in JS::ProfilingFrameIterator::iteratorConstruct(JS::ProfilingFrameIterator::RegisterState const&) js/src/vm/Stack.cpp:572:19
#20 0x5a1ceffc1b05 in JS::ProfilingFrameIterator::ProfilingFrameIterator(JSContext*, JS::ProfilingFrameIterator::RegisterState const&, mozilla::Maybe<unsigned long> const&) js/src/vm/Stack.cpp:488:3
#21 0x5a1cf016f16c in ReadGeckoProfilingStack(JSContext*, unsigned int, JS::Value*) js/src/builtin/TestingFunctions.cpp:4595:35
#22 0x5a1cef996fe6 in CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::CallReason, JS::CallArgs const&) js/src/vm/Interpreter.cpp:479:13
#23 0x5a1cef996201 in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) js/src/vm/Interpreter.cpp:573:12
#24 0x5a1cef9ac4d0 in js::CallFromStack(JSContext*, JS::CallArgs const&, js::CallReason) js/src/vm/Interpreter.cpp:645:10
#25 0x5a1cef9ac4d0 in js::Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:3060:16
#26 0x5a1cef995449 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:451:13
#27 0x5a1cef99612e in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) js/src/vm/Interpreter.cpp:605:13
#28 0x5a1cef99813d in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) js/src/vm/Interpreter.cpp:672:8
#29 0x5a1cf08fdc37 in js::jit::InvokeFunction(JSContext*, JS::Handle<JSObject*>, bool, bool, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/jit/VMFunctions.cpp:545:10
#30 0x5a1cf08fe7b8 in js::jit::InvokeFromInterpreterStub(JSContext*, js::jit::InterpreterStubExitFrameLayout*) js/src/jit/VMFunctions.cpp:569:8
#31 0x26c3f1d3ff1f  ([anon:js-executable-memory]+0x2f1f)

```

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a33_656084)• 10 months ago |

Blocks: [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")Group: firefox-core-security → core-securityComponent: Untriaged → JavaScript: GCProduct: Firefox → Core

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a2005_75935)• 10 months ago |

Group: core-security → javascript-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a374630_406194)• 10 months ago |

[Attachment #9392899](/attachment.cgi?id=9392899&action=edit "crash.js") -
Attachment mime type: application/x-javascript → text/plain

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1887332#c1)• 10 months ago |
|  | |

The GC stuff is more like it is poking at some GC data structures. The test case involves WebAssembly, so I'll move it over there. I do see frame iter stuff in the stack and a null deref, so maybe it is like that other one?

Component: JavaScript: GC → JavaScript: WebAssembly

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1887332#c2)• 10 months ago |
|  | |

Attached file
[poc-profile.js](attachment.cgi?id=9393858)
— [Details](attachment.cgi?id=9393858&action=edit)

Here's a reduced test case.

`--fast-warmup` is required. Wasm JIT exits are required to be enabled (wasm to JS JIT, aka. GenerateImportJitExit), but Wasm JIT entries are not required to be enabled. There seems to be something going on with the `enableGeckoProfiling` call happening at the bottom of the call stack. If I hoist that out to not be called every iteration that resolves the issue.

The JSJitProfilingFrameIterator is getting a fp\_ from cx->lastProfilingFrame and it seems like it might be garbage, which is causing issues when the callee value is inspected. Reading the descriptor off of it, it looks like FrameType::Ion, with a random argc value, which seems incorrect. I see that `enableGeckoProfiling` is responsible to set lastProfilingFrame, but don't see anything obviously wrong with it.

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1887332#c3)• 10 months ago |
|  | |

Setting this S3 tentatively, as it seems likely this requires some specific invocation of the Gecko profiling code, which is not content exposed.

Severity: -- → S3Priority: -- → P2

|  | [Yury Delendik (:yury)](/user_profile?user_id=382167) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1887332#c4)• 9 months ago |
|  | |

> The JSJitProfilingFrameIterator is getting a fp\_ from cx->lastProfilingFrame and it seems like it might be garbage,

I'm finding that as well. The cx->lastProfilingFrame is not updated between `enableGeckoProfiling();` and `readGeckoProfilingStack();`. If `enableGeckoProfiling();` is done outside the function, the `lastProfilingFrame` is staying null, which is can indicate that it was not updated.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1887332#c5)• 9 months ago |
|  | |

A null deref doesn't sound security sensitive, but a "garbage" frame does! Reducing to "sec-low" because it's so far more of a latent issue for users than one that could be reached.

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Yury Delendik (:yury)](/user_profile?user_id=382167) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a1385446_382167)• 9 months ago |

Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1887332#c6)• 9 months ago |
|  | |

Attached file
[Bug 1887332 - Improve handling of WasmToJSJit frames in JSJitProfilingFrameIterator. r?rhunt!](attachment.cgi?id=9395721)
— [Details](attachment.cgi?id=9395721&action=edit)

The iterator didn't mark itself `done()` when reaching a WasmToJSJit entry frame and

this confused the code in `GetTopProfilingJitFrame`.

We now store the Wasm caller FP separately and mark the iterator as done.

This is less error-prone and is also more consistent with other JS JIT and Wasm

frame iterators.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a1452921_600971)• 9 months ago |

Assignee: nobody → jdemooijStatus: NEW → ASSIGNED

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1887332#c7)• 9 months ago |
|  | |

To trigger this, the profiler has to be enabled when there are Wasm frames on the stack.

Flags: needinfo?(jdemooij)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1887332#c8)• 9 months ago |
|  | |

Pushed by jdemooij@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/098eed68d43b>
Improve handling of WasmToJSJit frames in JSJitProfilingFrameIterator. r=rhunt

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1887332#c9)• 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/098eed68d43b>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 9 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 126 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a1581257_695136)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a2128210_488993)• 9 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1887332#c10)• 9 months ago |
|  | |

:jandem this grafts cleanly to esr115.

Could you please add an esr115 uplift request? Assuming we want to backport there too?

Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1887332#c11)• 9 months ago |
|  | |

(In reply to Donal Meehan [:dmeehan] from [comment #10](/show_bug.cgi?id=1887332#c10 "RESOLVED FIXED - Null-deref at js::gc::HeaderWord::getAtomic() gc/Cell.h:100:12 with ReadGeckoProfilingStack"))

> :jandem this grafts cleanly to esr115.
>
> Could you please add an esr115 uplift request? Assuming we want to backport there too?

This doesn't need to be backported to ESR115.

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Flags: needinfo?(jdemooij)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a2588497_695136)• 9 months ago |

[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B) → ---

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a4085902_486733)• 8 months ago |

Whiteboard: [adv-main126+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1887332#c12)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401094)
— [Details](attachment.cgi?id=9401094&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a4160527_578488)• 8 months ago |

Alias: CVE-2024-4775

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1887332#c13)• 7 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887332#a15511538_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1887332&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [lukas.bernhard](/user_profile?user_id=656084)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0af25c4f_20250110_202241.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-21

## Security Vulnerabilities fixed in Firefox 126

Announced
May 14, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 126

*Updated November 6, 2024 to add CVE-2024-10941 which was fixed in Firefox 126 but not included in the original advisory.*

#### [#CVE-2024-4764: Use-after-free when audio input connected with multiple consumers](#CVE-2024-4764)

Reporter
Jan-Ivar Bruaroey
Impact
high
##### Description

Multiple WebRTC threads could have claimed a newly connected audio input leading to use-after-free.

##### References

* [Bug 1879093](https://bugzilla.mozilla.org/show_bug.cgi?id=1879093)

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4765: Web application manifests could have been overwritten via hash collision](#CVE-2024-4765)

Reporter
Dana Keeler
Impact
moderate
##### Description

Web application manifests were stored by using an insecure MD5 hash which allowed for a hash collision to overwrite another application's manifest. This could have been exploited to run arbitrary code in another application's context.
*This issue only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871109](https://bugzilla.mozilla.org/show_bug.cgi?id=1871109)

#### [#CVE-2024-4766: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2024-4766)

Reporter
Hafiizh
Impact
moderate
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871214](https://bugzilla.mozilla.org/show_bug.cgi?id=1871214)
* [Bug 1871217](https://bugzilla.mozilla.org/show_bug.cgi?id=1871217)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4771: Failed allocation could lead to use-after-free](#CVE-2024-4771)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A memory allocation check was missing which would lead to a use-after-free if the allocation failed. This could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1893891](https://bugzilla.mozilla.org/show_bug.cgi?id=1893891)

#### [#CVE-2024-4772: Use of insecure rand() function to generate nonce](#CVE-2024-4772)

Reporter
Hanno Böck
Impact
low
##### Description

An HTTP digest authentication nonce value was generated using `rand()` which could lead to predictable values.

##### References

* [Bug 1870579](https://bugzilla.mozilla.org/show_bug.cgi?id=1870579)

#### [#CVE-2024-4773: URL bar could be cleared after network error](#CVE-2024-4773)

Reporter
Islam
Impact
low
##### Description

When a network error occurred during page load, the prior content could have remained in view with a blank URL bar. This could have been used to obfuscate a spoofed web site.

##### References

* [Bug 1875248](https://bugzilla.mozilla.org/show_bug.cgi?id=1875248)

#### [#CVE-2024-4774: Undefined behavior in ShmemCharMapHashEntry()](#CVE-2024-4774)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShmemCharMapHashEntry()` code was susceptible to potentially undefined behavior by bypassing the move semantics for one of its data members.

##### References

* [Bug 1886598](https://bugzilla.mozilla.org/show_bug.cgi?id=1886598)

#### [#CVE-2024-4775: Invalid memory access in the built-in profiler](#CVE-2024-4775)

Reporter
Lukas Bernhard
Impact
low
##### Description

An iterator stop condition was missing when handling WASM code in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1887332](https://bugzilla.mozilla.org/show_bug.cgi?id=1887332)

#### [#CVE-2024-4776: Window may remain disabled after file dialog is shown in full-screen](#CVE-2024-4776)

Reporter
Raphael
Impact
low
##### Description

A file dialog shown while in full-screen mode could have resulted in the window remaining disabled.

##### References

* [Bug 1887343](https://bugzilla.mozilla.org/show_bug.cgi?id=1887343)

#### [#CVE-2024-10941: Browser crash from invalid URI](#CVE-2024-10941)

Reporter
Anthony De Los Santos
Impact
low
##### Description

A malicious website could have included an iframe with an malformed URI resulting in a non-exploitable browser crash.

##### References

* [Bug 1880879](https://bugzilla.mozilla.org/show_bug.cgi?id=1880879)
* [Bug 1887614](https://bugzilla.mozilla.org/show_bug.cgi?id=1887614)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

#### [#CVE-2024-4778: Memory safety bugs fixed in Firefox 126](#CVE-2024-4778)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1838834%2C1889291%2C1889595%2C1890204%2C1891545)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


