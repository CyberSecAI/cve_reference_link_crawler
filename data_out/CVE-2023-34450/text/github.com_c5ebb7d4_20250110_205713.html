
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcometbft%2Fcometbft%2Fpull%2F865)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcometbft%2Fcometbft%2Fpull%2F865)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=cometbft%2Fcometbft)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cometbft](/cometbft)
/
**[cometbft](/cometbft/cometbft)**
Public

* [Notifications](/login?return_to=%2Fcometbft%2Fcometbft) You must be signed in to change notification settings
* [Fork
  528](/login?return_to=%2Fcometbft%2Fcometbft)
* [Star
   681](/login?return_to=%2Fcometbft%2Fcometbft)

* [Code](/cometbft/cometbft)
* [Issues
  265](/cometbft/cometbft/issues)
* [Pull requests
  51](/cometbft/cometbft/pulls)
* [Discussions](/cometbft/cometbft/discussions)
* [Actions](/cometbft/cometbft/actions)
* [Projects
  1](/cometbft/cometbft/projects)
* [Wiki](/cometbft/cometbft/wiki)
* [Security](/cometbft/cometbft/security)
* [Insights](/cometbft/cometbft/pulse)

Additional navigation options

* [Code](/cometbft/cometbft)
* [Issues](/cometbft/cometbft/issues)
* [Pull requests](/cometbft/cometbft/pulls)
* [Discussions](/cometbft/cometbft/discussions)
* [Actions](/cometbft/cometbft/actions)
* [Projects](/cometbft/cometbft/projects)
* [Wiki](/cometbft/cometbft/wiki)
* [Security](/cometbft/cometbft/security)
* [Insights](/cometbft/cometbft/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcometbft%2Fcometbft%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcometbft%2Fcometbft%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: avoid recursive call after rename to (\*PeerState).MarshalJSON #865

 Merged

[sergio-mena](/sergio-mena)
merged 18 commits into
[cometbft:main](/cometbft/cometbft/tree/main "cometbft/cometbft:main")
from
[mmsqe:fix\_marshal](/mmsqe/cometbft/tree/fix_marshal "mmsqe/cometbft:fix_marshal")

Jun 14, 2023

 Merged

# [fix: avoid recursive call after rename to (\*PeerState).MarshalJSON](#top) #865

[sergio-mena](/sergio-mena)
merged 18 commits into
[cometbft:main](/cometbft/cometbft/tree/main "cometbft/cometbft:main")
from
[mmsqe:fix\_marshal](/mmsqe/cometbft/tree/fix_marshal "mmsqe/cometbft:fix_marshal")

Jun 14, 2023

[Conversation
17](/cometbft/cometbft/pull/865)
[Commits
18](/cometbft/cometbft/pull/865/commits)
[Checks
0](/cometbft/cometbft/pull/865/checks)
[Files changed](/cometbft/cometbft/pull/865/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mmsqe](https://avatars.githubusercontent.com/u/2867936?s=60&v=4)](/mmsqe)

Copy link

Contributor

### @mmsqe **[mmsqe](/mmsqe)** commented [May 22, 2023](#issue-1718716778) ‚Ä¢ edited Loading

Closes: [#863](https://github.com/cometbft/cometbft/issues/863)

---

#### PR checklist

* Tests written/updated
* Changelog entry added in `.changelog` (we use [unclog](https://github.com/informalsystems/unclog) to manage our changelog)
* Updated relevant documentation (`docs/` or `spec/`) and code comments

Sorry, something went wrong.

All reactions

 [mmsqe](/mmsqe)
added 3 commits
[May 22, 2023 09:10](#commits-pushed-dd6d541)

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[avoid recursive call after rename to (*PeerState).MarshalJSON](/cometbft/cometbft/pull/865/commits/dd6d54159765955681b8f42de65ba0021cf29837 "avoid recursive call after rename to (*PeerState).MarshalJSON")`

`[dd6d541](/cometbft/cometbft/pull/865/commits/dd6d54159765955681b8f42de65ba0021cf29837)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[add test](/cometbft/cometbft/pull/865/commits/07df1d47768109252f5d999de3bedf765db7d860 "add test")`

`[07df1d4](/cometbft/cometbft/pull/865/commits/07df1d47768109252f5d999de3bedf765db7d860)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[add change doc](/cometbft/cometbft/pull/865/commits/dc165582d6afff784ab57dde3013fed2b838bf55 "add change doc")`

`[dc16558](/cometbft/cometbft/pull/865/commits/dc165582d6afff784ab57dde3013fed2b838bf55)`

 [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe)
[mmsqe](/mmsqe)
marked this pull request as ready for review
[May 22, 2023 01:18](#event-9297005350)

 [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe)
[mmsqe](/mmsqe)
requested a review
from a team
as a [code owner](/cometbft/cometbft/blob/40e6611f6b81ee01692c1a0d7f4d40727e1c57c1/.github/CODEOWNERS#L10)
[May 22, 2023 01:18](#event-9297005368)

 [mmsqe](/mmsqe)
added 5 commits
[May 31, 2023 22:31](#commits-pushed-db8f983)

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[explain for nolint](/cometbft/cometbft/pull/865/commits/db8f98348ccf468108e189ea7e71e07f152ce3e4 "explain for nolint")`

`[db8f983](/cometbft/cometbft/pull/865/commits/db8f98348ccf468108e189ea7e71e07f152ce3e4)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Merge remote-tracking branch 'origin/main' into fix_marshal](/cometbft/cometbft/pull/865/commits/5d47b8e4b5903dcde82b1f9520b951583f42e92a "Merge remote-tracking branch 'origin/main' into fix_marshal")`

`[5d47b8e](/cometbft/cometbft/pull/865/commits/5d47b8e4b5903dcde82b1f9520b951583f42e92a)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[fix lint](/cometbft/cometbft/pull/865/commits/29eb7f30a49fee31b08cccbe18e865875c3e3d8b "fix lint")`

`[29eb7f3](/cometbft/cometbft/pull/865/commits/29eb7f30a49fee31b08cccbe18e865875c3e3d8b)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Merge remote-tracking branch 'origin/main' into fix_marshal](/cometbft/cometbft/pull/865/commits/828949d23f8f1b3c6e132dd5fd6f941f08f84269 "Merge remote-tracking branch 'origin/main' into fix_marshal")`

`[828949d](/cometbft/cometbft/pull/865/commits/828949d23f8f1b3c6e132dd5fd6f941f08f84269)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[fix golangci-lint to v1.52.2](/cometbft/cometbft/pull/865/commits/a8aad121e27382813e95b1911b1b560c62e1c7c3 "fix golangci-lint to v1.52.2")`

`[a8aad12](/cometbft/cometbft/pull/865/commits/a8aad121e27382813e95b1911b1b560c62e1c7c3)`

[![mmsqe](https://avatars.githubusercontent.com/u/2867936?s=60&v=4)](/mmsqe)

**[mmsqe](/mmsqe)**
commented
[Jun 3, 2023](#pullrequestreview-1459686338)

 [View reviewed changes](/cometbft/cometbft/pull/865/files/a8aad121e27382813e95b1911b1b560c62e1c7c3)

[Makefile](/cometbft/cometbft/pull/865/files/a8aad121e27382813e95b1911b1b560c62e1c7c3#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52)
Outdated

Show resolved

Hide resolved

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[fix golangci-lint to v1.52.2](/cometbft/cometbft/pull/865/commits/598a9ef4c86fc29cf038251676c33a222217826c "fix golangci-lint to v1.52.2")`

`[598a9ef](/cometbft/cometbft/pull/865/commits/598a9ef4c86fc29cf038251676c33a222217826c)`

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe)
[mmsqe](/mmsqe)
mentioned this pull request
[Jun 4, 2023](#ref-pullrequest-1740473782)

[fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
#908](/cometbft/cometbft/pull/908)
 Merged

3 tasks

 [mmsqe](/mmsqe)
added 3 commits
[June 5, 2023 20:08](#commits-pushed-d14211f)

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Revert "fix golangci-lint to v1.52.2"](/cometbft/cometbft/pull/865/commits/d14211fa995391d84f633ad4054b676ccf7125cc "Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.")`
 ‚Ä¶

`[d14211f](/cometbft/cometbft/pull/865/commits/d14211fa995391d84f633ad4054b676ccf7125cc)`

```
This reverts commit [598a9ef](https://github.com/mmsqe/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).
```

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Revert "fix golangci-lint to v1.52.2"](/cometbft/cometbft/pull/865/commits/e8f68075467387ed7967c0908e33dc6eb5f50510 "Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.")`
 ‚Ä¶

`[e8f6807](/cometbft/cometbft/pull/865/commits/e8f68075467387ed7967c0908e33dc6eb5f50510)`

```
This reverts commit [a8aad12](https://github.com/mmsqe/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).
```

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Merge remote-tracking branch 'origin/main' into fix_marshal](/cometbft/cometbft/pull/865/commits/8aa5ee11a2b809faba10941a1b8123870ba309f4 "Merge remote-tracking branch 'origin/main' into fix_marshal")`

`[8aa5ee1](/cometbft/cometbft/pull/865/commits/8aa5ee11a2b809faba10941a1b8123870ba309f4)`

[![@MechanicalTyler](https://avatars.githubusercontent.com/u/524638?s=40&u=dd07129729044274a3c1671065627a100ae97534&v=4)](/MechanicalTyler)
[MechanicalTyler](/MechanicalTyler)
mentioned this pull request
[Jun 9, 2023](#ref-issue-1694952310)

[[Bug]: Upgrade from v0.47.1 -> v0.47.2 causing issues
cosmos/cosmos-sdk#16027](/cosmos/cosmos-sdk/issues/16027)

Closed

[![@MechanicalTyler](https://avatars.githubusercontent.com/u/524638?s=80&u=dd07129729044274a3c1671065627a100ae97534&v=4)](/MechanicalTyler)

Copy link

### **[MechanicalTyler](/MechanicalTyler)** commented [Jun 9, 2023](#issuecomment-1585059587)

| This issue is preventing us from upgrading to the latest version of cosmos-sdk. Is there any word on when it can be merged? |
| --- |

All reactions

Sorry, something went wrong.

[![@taariq](https://avatars.githubusercontent.com/u/701864?s=80&v=4)](/taariq)

Copy link

### **[taariq](/taariq)** commented [Jun 9, 2023](#issuecomment-1585172862)

| [@sergio-mena](https://github.com/sergio-mena) Are you able to help us here? |
| --- |

All reactions

Sorry, something went wrong.

[![@cason](https://avatars.githubusercontent.com/u/270778?s=40&u=7793aeff6c8e04aef36a626d2f66a2f83179b942&v=4)](/cason)
[cason](/cason)
mentioned this pull request
[Jun 12, 2023](#ref-pullrequest-1622253499)

[consensus: rename (\*PeerState).ToJSON to MarshalJSON
#524](/cometbft/cometbft/pull/524)
 Merged

3 tasks

[![@cason](https://avatars.githubusercontent.com/u/270778?s=80&u=7793aeff6c8e04aef36a626d2f66a2f83179b942&v=4)](/cason)

Copy link

Collaborator

### **[cason](/cason)** commented [Jun 12, 2023](#issuecomment-1586771610)

| Hi, I don't have the background to really understand the problem and the proposed fix.  I was wondering whether this issue (introduced by [#524](https://github.com/cometbft/cometbft/pull/524) apparently) could be solved while still adopting the `cmtjson` package. |
| --- |

All reactions

Sorry, something went wrong.

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=80&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

Copy link

Contributor

### **[sergio-mena](/sergio-mena)** commented [Jun 12, 2023](#issuecomment-1587014145)

| [@taariq](https://github.com/taariq) Yes, I'm working on this. Will update you during this week |
| --- |

 üëç
1
 taariq reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=80&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe)

Copy link

Contributor

Author

### **[mmsqe](/mmsqe)** commented [Jun 12, 2023](#issuecomment-1587560428)

| I was wondering whether this issue (introduced by [#524](https://github.com/cometbft/cometbft/pull/524) apparently) could be solved while still adopting the `cmtjson` package.  [@cason](https://github.com/cason) Not sure what do you mean by `adopting`, but any attempt to json.Marshal PeerState with active lock will trigger this bug. |
| --- |

All reactions

Sorry, something went wrong.

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=80&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

Copy link

Contributor

### **[sergio-mena](/sergio-mena)** commented [Jun 14, 2023](#issuecomment-1590816076)

| This is the key backtrace extracted from a repro of the problem:  ``` goroutine 41 [sync.Mutex.Lock]: runtime.gopark(0x20d7520?, 0x0?, 0x40?, 0x97?, 0x428ed0?)         runtime/proc.go:381 +0xe0 fp=0xc0013d8960 sp=0xc0013d8940 pc=0x45c7d0 runtime.goparkunlock(...)         runtime/proc.go:387 runtime.semacquire1(0xc000278ab4, 0x80?, 0x3, 0x1, 0x98?)         runtime/sema.go:160 +0x20c fp=0xc0013d89c0 sp=0xc0013d8960 pc=0x46f18c sync.runtime_SemacquireMutex(0xc0013d8a18?, 0x9c?, 0xc0013d8a48?)         runtime/sema.go:77 +0x28 fp=0xc0013d8a00 sp=0xc0013d89c0 pc=0x48c7d8 sync.(*Mutex).lockSlow(0xc000278ab0)         sync/mutex.go:171 +0x1e8 fp=0xc0013d8a50 sp=0xc0013d8a00 pc=0x4b4de8 sync.(*Mutex).Lock(0xc000278ab0)         sync/mutex.go:90 +0x60 fp=0xc0013d8a70 sp=0xc0013d8a50 pc=0x4b4b30 github.com/cometbft/cometbft/consensus.(*PeerState).MarshalJSON(0xc000278a90)         github.com/cometbft/cometbft/consensus/reactor.go:1075 +0x48 fp=0xc0013d8b20 sp=0xc0013d8a70 pc=0x11d2798 encoding/json.marshalerEncoder(0xc000282280, {0x1532ce0?, 0xc000278a90?, 0x0?}, {0x1?, 0x0?})         encoding/json/encode.go:477 +0x108 fp=0xc0013d8bc0 sp=0xc0013d8b20 pc=0x57fec8 encoding/json.(*encodeState).reflectValue(0x80?, {0x1532ce0?, 0xc000278a90?, 0xffff960bfdf8?}, {0x8?, 0xe1?})         encoding/json/encode.go:358 +0x78 fp=0xc0013d8c20 sp=0xc0013d8bc0 pc=0x57f348 encoding/json.(*encodeState).marshal(0xc0013d8d28?, {0x1532ce0?, 0xc000278a90}, {0x7c?, 0x8c?})         encoding/json/encode.go:330 +0x1a4 fp=0xc0013d8d00 sp=0xc0013d8c20 pc=0x57eae4 encoding/json.Marshal({0x1532ce0, 0xc000278a90})         encoding/json/encode.go:161 +0xa4 fp=0xc0013d8e00 sp=0xc0013d8d00 pc=0x57dd04 github.com/cometbft/cometbft/libs/json.encodeStdlib({0x1849800, 0xc000ebced0}, {0x1532ce0, 0xc000278a90})         github.com/cometbft/cometbft/libs/json/encoder.go:243 +0x3c fp=0xc0013d8e50 sp=0xc0013d8e00 pc=0x7e052c github.com/cometbft/cometbft/libs/json.encodeReflect({0x1849800, 0xc000ebced0}, {0x1532ce0?, 0xc000278a90?, 0xffff96a1e108?})         github.com/cometbft/cometbft/libs/json/encoder.go:87 +0xa5c fp=0xc0013d9000 sp=0xc0013d8e50 pc=0x7df1cc github.com/cometbft/cometbft/libs/json.encode({0x1849800, 0xc000ebced0}, {0x1532ce0, 0xc000278a90})         github.com/cometbft/cometbft/libs/json/encoder.go:60 +0x1e4 fp=0xc0013d9090 sp=0xc0013d9000 pc=0x7de6c4 github.com/cometbft/cometbft/libs/json.Marshal({0x1532ce0, 0xc000278a90})         github.com/cometbft/cometbft/libs/json/encoder.go:24 +0x50 fp=0xc0013d9100 sp=0xc0013d9090 pc=0x7de250 github.com/cometbft/cometbft/consensus.(*PeerState).MarshalJSON(0xc000278a90)         github.com/cometbft/cometbft/consensus/reactor.go:1078 +0x88 fp=0xc0013d91b0 sp=0xc0013d9100 pc=0x11d27d8 encoding/json.marshalerEncoder(0xc000282200, {0x1532ce0?, 0xc000278a90?, 0x556f18?}, {0x20?, 0xc6?})         encoding/json/encode.go:477 +0x108 fp=0xc0013d9250 sp=0xc0013d91b0 pc=0x57fec8 encoding/json.(*encodeState).reflectValue(0x13d60a0?, {0x1532ce0?, 0xc000278a90?, 0x556f18?}, {0x18?, 0x93?})         encoding/json/encode.go:358 +0x78 fp=0xc0013d92b0 sp=0xc0013d9250 pc=0x57f348 encoding/json.interfaceEncoder(0xc000282200, {0x13d60a0?, 0xc000edc620?, 0xc00010d200?}, {0x88?, 0x93?})         encoding/json/encode.go:714 +0x170 fp=0xc0013d9320 sp=0xc0013d92b0 pc=0x581e80 encoding/json.mapEncoder.encode({0xc0013d95e8?}, 0xc000282200, {0x13f31e0?, 0xc000ebce40?, 0x1864228?}, {0xe0?, 0x31?})         encoding/json/encode.go:812 +0x538 fp=0xc0013d95d0 sp=0xc0013d9320 pc=0x582a38 encoding/json.mapEncoder.encode-fm(0x13f31e0?, {0x13f31e0?, 0xc000ebce40?, 0x0?}, {0x1?, 0x0?})         <autogenerated>:1 +0x70 fp=0xc0013d9640 sp=0xc0013d95d0 pc=0x591f30 encoding/json.(*encodeState).reflectValue(0x80?, {0x13f31e0?, 0xc000ebce40?, 0xffff960bfdf8?}, {0x8?, 0xe1?})         encoding/json/encode.go:358 +0x78 fp=0xc0013d96a0 sp=0xc0013d9640 pc=0x57f348 encoding/json.(*encodeState).marshal(0xc0013d97c8?, {0x13f31e0?, 0xc000ebce40}, {0x70?, 0x97?})         encoding/json/encode.go:330 +0x1a4 fp=0xc0013d9780 sp=0xc0013d96a0 pc=0x57eae4 encoding/json.(*Encoder).Encode(0xc0013d9978, {0x13f31e0, 0xc000ebce40})         encoding/json/stream.go:209 +0xd0 fp=0xc0013d98f0 sp=0xc0013d9780 pc=0x58e5e0 github.com/go-kit/log.(*jsonLogger).Log(0xc00020c790, {0xc000ee4000, 0xe, 0xc000ebaf00?})         github.com/go-kit/log@v0.2.1/json_logger.go:36 +0x1d0 fp=0xc0013d99d0 sp=0xc0013d98f0 pc=0xeb5f60 github.com/go-kit/log.(*context).Log(0xc000ea90e0, {0xc000ebaf00, 0x4, 0x2?})         github.com/go-kit/log@v0.2.1/log.go:168 +0x444 fp=0xc0013d9a50 sp=0xc0013d99d0 pc=0xeb77c4 github.com/cometbft/cometbft/libs/log.(*tmLogger).Debug(0xc00020c610, {0x1571633, 0x14}, {0xc000ebaf00, 0x4, 0x4})         github.com/cometbft/cometbft/libs/log/tm_logger.go:66 +0x170 fp=0xc0013d9b40 sp=0xc0013d9a50 pc=0xebcb90 github.com/cometbft/cometbft/libs/log.(*filter).Debug(0xc000030120, {0x1571633, 0x14}, {0xc000ebaf00, 0x4, 0x4})         github.com/cometbft/cometbft/libs/log/filter.go:54 +0x84 fp=0xc0013d9b80 sp=0xc0013d9b40 pc=0xebb764 github.com/cometbft/cometbft/consensus.(*PeerState).PickSendVote(0xc000278a90, {0x1859da0, 0xc0002b2d80})         github.com/cometbft/cometbft/consensus/reactor.go:1144 +0x1c0 fp=0xc0013d9cb0 sp=0xc0013d9b80 pc=0x11d34b0 github.com/cometbft/cometbft/consensus.(*Reactor).gossipVotesForHeight(0xc0000314e0?, {0x1855098, 0xc000ebe520}, 0xc000ee3d40, 0xc000ec63c0, 0xc?)         github.com/cometbft/cometbft/consensus/reactor.go:808 +0x264 fp=0xc0013d9d50 sp=0xc0013d9cb0 pc=0x11d0784 github.com/cometbft/cometbft/consensus.(*Reactor).gossipVotesRoutine(0xc0003bc510, {0x18636d8?, 0xc0002789c0}, 0xc000278a90?)         github.com/cometbft/cometbft/consensus/reactor.go:726 +0x2d0 fp=0xc0013d9f80 sp=0xc0013d9d50 pc=0x11cf6d0 github.com/cometbft/cometbft/consensus.(*Reactor).AddPeer.func2()         github.com/cometbft/cometbft/consensus/reactor.go:202 +0x5c fp=0xc0013d9fd0 sp=0xc0013d9f80 pc=0x11c982c runtime.goexit()         runtime/asm_arm64.s:1172 +0x4 fp=0xc0013d9fd0 sp=0xc0013d9fd0 pc=0x490cc4 created by github.com/cometbft/cometbft/consensus.(*Reactor).AddPeer         github.com/cometbft/cometbft/consensus/reactor.go:202 +0x244  ```  So [@mmsqe](https://github.com/mmsqe) and [@cason](https://github.com/cason) are right in that the *real* problem is not the lock, but the fact that the `MarshalJSON` is effectively an infinite (recursive) loop, as its implementation calls itself via refection.  Working on a fix |
| --- |

All reactions

Sorry, something went wrong.

[![sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=60&v=4)](/sergio-mena)

**[sergio-mena](/sergio-mena)**
reviewed
[Jun 14, 2023](#pullrequestreview-1478963441)

 [View reviewed changes](/cometbft/cometbft/pull/865/files/8aa5ee11a2b809faba10941a1b8123870ba309f4)

[consensus/reactor.go](/cometbft/cometbft/pull/865/files/8aa5ee11a2b809faba10941a1b8123870ba309f4#diff-cad174abde54d8d3dd10e6d0b6c6b7d4205a50d86646ef94aa538943ea692882)
Outdated

|  |  | @@ -1074,8 +1075,8 @@ func (ps \*PeerState) GetRoundState() \*cstypes.PeerRoundState { | |
| --- | --- | --- | --- |
|  |  | func (ps \*PeerState) MarshalJSON() ([]byte, error) { |
|  |  | ps.mtx.Lock() |
|  |  | defer ps.mtx.Unlock() |
|  |  |  |
|  |  | return cmtjson.Marshal(ps) |
|  |  | type aPeerState PeerState |

Copy link

Contributor

### @sergio-mena **[sergio-mena](/sergio-mena)** [Jun 14, 2023](#discussion_r1229313952)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I believe you are following the strategy similar to the one described [here](https://jhall.io/posts/go-json-self-referencing-marshaler/).

If that trick breaks the infinite loop, can we still use `cmtjson`? (to avoid further unknown/unintended side-effects)

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mmsqe **[mmsqe](/mmsqe)** [Jun 14, 2023](#discussion_r1229357615) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

yes, other types are different like [toAllRoundVotes](https://github.com/cometbft/cometbft/blob/main/consensus/types/height_vote_set.go#L260) or [VoteSetJSON](https://github.com/cometbft/cometbft/blob/main/types/vote_set.go#L538)

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @sergio-mena **[sergio-mena](/sergio-mena)** [Jun 14, 2023](#discussion_r1229369340)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Cool, I think I have something. The problems I see there:

* Let's not move away from `cmtjson`
* Let's not copy already-initialized mutexes

I've fixed that on a branch (using this PR as starting point).

Please cherry-pick `8aa5ee11a..eac18b3a9` if you agree with those changes.

With those changes, the PR would be ready for approval (AFAIAC)

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mmsqe **[mmsqe](/mmsqe)** [Jun 14, 2023](#discussion_r1229372006)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Got it thanks, implements MarshalJSON need to be careful, even without lock might be recursive

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @sergio-mena **[sergio-mena](/sergio-mena)** [Jun 14, 2023](#discussion_r1229374321) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

My concern is that, if you copy the `PeerState` struct, rather than a pointer to it, you are effectively copying its internal Mutex. Documentation of `sync.Mutex` says that is *wrong* (bear in mind `sync.Mutex` is a struct, not an interface)

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mmsqe **[mmsqe](/mmsqe)** [Jun 14, 2023](#discussion_r1229378563) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I didn't see your change, type cast to type alias pointer is better

Sorry, something went wrong.

 üëç
1
 sergio-mena reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 [sergio-mena](/sergio-mena)
added 4 commits
[June 14, 2023 18:56](#commits-pushed-a001bc0)

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Reintroduced cmtjson](/cometbft/cometbft/pull/865/commits/a001bc04e476d30e2e4bfac8fd982c74cdbd0ede "Reintroduced `cmtjson`")`

`[a001bc0](/cometbft/cometbft/pull/865/commits/a001bc04e476d30e2e4bfac8fd982c74cdbd0ede)`

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Avoid copying Mutex](/cometbft/cometbft/pull/865/commits/991054a3035ff091e145ce53a1799aba02798322 "Avoid copying Mutex")`

`[991054a](/cometbft/cometbft/pull/865/commits/991054a3035ff091e145ce53a1799aba02798322)`

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&v=4)](/mmsqe)

`[Avoid copying Mutex -- 2nd try, more succint](/cometbft/cometbft/pull/865/commits/d5afa02db4b9af24a74fb82b6ec0b56e24675e4c "Avoid copying Mutex -- 2nd try, more succint")`

`[d5afa02](/cometbft/cometbft/pull/865/commits/d5afa02db4b9af24a74fb82b6ec0b56e24675e4c)`

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena)

`[Merge branch 'main' into fix_marshal](/cometbft/cometbft/pull/865/commits/1c5f87804bcd34d4f33821757ad163d49ef63bb4 "Merge branch 'main' into fix_marshal")`

`[1c5f878](/cometbft/cometbft/pull/865/commits/1c5f87804bcd34d4f33821757ad163d49ef63bb4)`

[![sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=60&v=4)](/sergio-mena)

**[sergio-mena](/sergio-mena)**
approved these changes
[Jun 14, 2023](#pullrequestreview-1479167292)

 [View reviewed changes](/cometbft/cometbft/pull/865/files/1c5f87804bcd34d4f33821757ad163d49ef63bb4)

Copy link

Contributor

### @sergio-mena **[sergio-mena](/sergio-mena)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for this [@mmsqe](https://github.com/mmsqe)

Sorry, something went wrong.

All reactions

18 hidden items

Load more‚Ä¶

[sergio-mena](/sergio-mena)
added a commit
that referenced
this pull request
[Jun 14, 2023](#ref-commit-8bc9678)
[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

`[Revert "fix: avoid recursive call after rename to (*PeerState).Marsha‚Ä¶](/cometbft/cometbft/commit/8bc9678fa58d06b2c9eecf99d5d32c5832b2b100 "Revert \"fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)\"")`
‚Ä¶

`[8bc9678](/cometbft/cometbft/commit/8bc9678fa58d06b2c9eecf99d5d32c5832b2b100)`

```
‚Ä¶lJSON ([#865](https://github.com/cometbft/cometbft/pull/865))"
```

[sergio-mena](/sergio-mena)
added a commit
that referenced
this pull request
[Jun 14, 2023](#ref-commit-0e78f7e)
[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

`[fix: avoid recursive call after rename to (*PeerState).MarshalJSON (](/cometbft/cometbft/commit/0e78f7e4137506d12038fc5a14a0b43684971985 "fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>")[#865](https://github.com/cometbft/cometbft/pull/865)`
‚Ä¶

`[0e78f7e](/cometbft/cometbft/commit/0e78f7e4137506d12038fc5a14a0b43684971985)`

```
)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/cometbft/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/cometbft/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
```

[sergio-mena](/sergio-mena)
added a commit
that referenced
this pull request
[Jun 14, 2023](#ref-commit-c377cb8)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

`[fix: avoid recursive call after rename to (*PeerState).MarshalJSON (b‚Ä¶](/cometbft/cometbft/commit/c377cb8c4c764344be878b0a3bc73894413c7aa0 "fix: avoid recursive call after rename to (*PeerState).MarshalJSON (backport #865) (#968)

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit f6ea09171a2bf9f695f59b65f5c51e4a8c168015)

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Revert \"Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md\"

This reverts commit 2b961183034f90b091eee0401f73ce967ee06851.

---------

Co-authored-by: mmsqe <mavis@crypto.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>")`
‚Ä¶

`[c377cb8](/cometbft/cometbft/commit/c377cb8c4c764344be878b0a3bc73894413c7aa0)`

```
‚Ä¶ackport [#865](https://github.com/cometbft/cometbft/pull/865)) ([#968](https://github.com/cometbft/cometbft/pull/968))

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON ([#865](https://github.com/cometbft/cometbft/pull/865))

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/cometbft/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/cometbft/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit [f6ea091](https://github.com/cometbft/cometbft/commit/f6ea09171a2bf9f695f59b65f5c51e4a8c168015))

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Revert "Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md"

This reverts commit [2b96118](https://github.com/cometbft/cometbft/commit/2b961183034f90b091eee0401f73ce967ee06851).

---------

Co-authored-by: mmsqe <mavis@crypto.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
```

[sergio-mena](/sergio-mena)
added a commit
that referenced
this pull request
[Jun 14, 2023](#ref-commit-2a526ca)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena)

`[fix: avoid recursive call after rename to (*PeerState).MarshalJSON (b‚Ä¶](/cometbft/cometbft/commit/2a526cae86181699e4ed50ec409268341538f374 "fix: avoid recursive call after rename to (*PeerState).MarshalJSON (backport #865) (#970)

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit f6ea09171a2bf9f695f59b65f5c51e4a8c168015)

# Conflicts:
#	consensus/reactor_test.go

* Revert \"fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)\"

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>

---------

Co-authored-by: mmsqe <mavis@crypto.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>")`
‚Ä¶

`[2a526ca](/cometbft/cometbft/commit/2a526cae86181699e4ed50ec409268341538f374)`

```
‚Ä¶ackport [#865](https://github.com/cometbft/cometbft/pull/865)) ([#970](https://github.com/cometbft/cometbft/pull/970))

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON ([#865](https://github.com/cometbft/cometbft/pull/865))

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/cometbft/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/cometbft/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit [f6ea091](https://github.com/cometbft/cometbft/commit/f6ea09171a2bf9f695f59b65f5c51e4a8c168015))

# Conflicts:
#	consensus/reactor_test.go

* Revert "fix: avoid recursive call after rename to (*PeerState).MarshalJSON ([#865](https://github.com/cometbft/cometbft/pull/865))"

* fix: avoid recursive call after rename to (*PeerState).MarshalJSON ([#865](https://github.com/cometbft/cometbft/pull/865))

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/cometbft/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/cometbft/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>

---------

Co-authored-by: mmsqe <mavis@crypto.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
```

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Jul 3, 2023](#ref-issue-1786605093)

[x/vulndb: potential Go vuln in github.com/cometbft/cometbft: CVE-2023-34450
golang/vulndb#1882](/golang/vulndb/issues/1882)

Closed

[luckychess](/luckychess)
added a commit
to luckychess/cometbft
that referenced
this pull request
[Oct 18, 2023](#ref-commit-449a434)
[![@luckychess](https://avatars.githubusercontent.com/u/3829208?s=40&v=4)](/luckychess)

`[Backport of](/luckychess/cometbft/commit/449a4341c7557f109fd3f1bb5db18d612436eca3 "Backport of https://github.com/cometbft/cometbft/pull/865") [cometbft#865](https://github.com/cometbft/cometbft/pull/865)`

`[449a434](/luckychess/cometbft/commit/449a4341c7557f109fd3f1bb5db18d612436eca3)`

[luckychess](/luckychess)
pushed a commit
to sagaxyz/cometbft
that referenced
this pull request
[Oct 20, 2023](#ref-commit-148c276)
[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena) [![@luckychess](https://avatars.githubusercontent.com/u/3829208?s=40&v=4)](/luckychess)

`[fix: avoid recursive call after rename to (*PeerState).MarshalJSON (](/sagaxyz/cometbft/commit/148c27689e418f2ccbe11e14da0eac45b7a8add2 "fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>")[c‚Ä¶](https://github.com/cometbft/cometbft/pull/865)`
‚Ä¶

`[148c276](/sagaxyz/cometbft/commit/148c27689e418f2ccbe11e14da0eac45b7a8add2)`

```
[‚Ä¶ometbft#865](https://github.com/cometbft/cometbft/pull/865))

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/sagaxyz/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/sagaxyz/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
```

[![@faddat](https://avatars.githubusercontent.com/u/7142025?s=40&v=4)](/faddat)
[faddat](/faddat)
mentioned this pull request
[Jan 5, 2024](#ref-pullrequest-2067625438)

[faddat/reversions for fixed length
ComposableFi/cometbft#2](/ComposableFi/cometbft/pull/2)
 Closed

3 tasks

[![@lasarojc](https://avatars.githubusercontent.com/u/2686194?s=40&v=4)](/lasarojc)
[lasarojc](/lasarojc)
mentioned this pull request
[Mar 12, 2024](#ref-pullrequest-2181517654)

[chore(spec): merge main into `spec/consensus-gossip`
#2594](/cometbft/cometbft/pull/2594)
 Merged

[lasarojc](/lasarojc)
added a commit
that referenced
this pull request
[Mar 12, 2024](#ref-commit-e7dd0ab)
[![@lasarojc](https://avatars.githubusercontent.com/u/2686194?s=40&v=4)](/lasarojc) [![@thanethomson](https://avatars.githubusercontent.com/u/212999?s=40&u=8cdc0098f3eba5a9eb3e565b419fe22b80641307&v=4)](/thanethomson)
[![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot) [![@melekes](https://avatars.githubusercontent.com/u/1282182?s=40&u=4cbacd31a79dc8ada3988c674668cd3023f1ee40&v=4)](/melekes) [![@mzabaluev](https://avatars.githubusercontent.com/u/1198919?s=40&v=4)](/mzabaluev) [![@troykessler](https://avatars.githubusercontent.com/u/43882936?s=40&u=60184a020309cbf84c673d89a4ebb09025e1e2f1&v=4)](/troykessler) [![@lllleven](https://avatars.githubusercontent.com/u/112051166?s=40&u=9110425690cc87630031273a2e0e14432e736f17&v=4)](/lllleven) [![@werty144](https://avatars.githubusercontent.com/u/29121165?s=40&v=4)](/werty144) [![@adizere](https://avatars.githubusercontent.com/u/1757002?s=40&v=4)](/adizere) [![@sukey2008](https://avatars.githubusercontent.com/u/35202440?s=40&u=8a0a89f1249edb1840680c0486ca86ea115b7910&v=4)](/sukey2008) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&u=79f695ba12339038e7ba9e9e1172c964e722f876&v=4)](/sergio-mena) [![@jmalicevic](https://avatars.githubusercontent.com/u/7517419?s=40&u=5d76c2b674d046d00b7020427ad9718e1b1bb2ca&v=4)](/jmalicevic) [![@wieso-itzi](https://avatars.githubusercontent.com/u/85185077?s=40&u=8f04a2bcf391c62a770167b2a2d080c458d2e81c&v=4)](/wieso-itzi) [![@hoangdv2429](https://avatars.githubusercontent.com/u/63839106?s=40&u=dd379b05ccf7fc0cc194029dcb4d77bb6bdd84bc&v=4)](/hoangdv2429) [![@bodhi-crypo](https://avatars.githubusercontent.com/u/152680487?s=40&u=554351a76e53f5298967368f001249a9180c41e4&v=4)](/bodhi-crypo) [![@hvanz](https://avatars.githubusercontent.com/u/15466498?s=40&u=14e39ce969a7381b8934c945daa72dcf88beb3db&v=4)](/hvanz) [![@cason](https://avatars.githubusercontent.com/u/270778?s=40&u=7793aeff6c8e04aef36a626d2f66a2f83179b942&v=4)](/cason) [![@andynog](https://avatars.githubusercontent.com/u/45477427?s=40&u=919edadcde3c9922d5c5481ba86b6d394d46e6e0&v=4)](/andynog) [![@nenadmilosevic95](https://avatars.githubusercontent.com/u/50905385?s=40&v=4)](/nenadmilosevic95) [![@faddat](https://avatars.githubusercontent.com/u/7142025?s=40&u=a94b1572dddcc995b9174ac70cee81196a2913f0&v=4)](/faddat) [![@greg-szabo](https://avatars.githubusercontent.com/u/16846635?s=40&u=9c18b22b3b0f6447ec98f070fa9821949f1f91cb&v=4)](/greg-szabo) [![@odeke-em](https://avatars.githubusercontent.com/u/4898263?s=40&u=71396c0dd79a0f55328aa0781c13ca5d940e6af3&v=4)](/odeke-em) [![@jchappelow](https://avatars.githubusercontent.com/u/140431406?s=40&v=4)](/jchappelow) [![@shuoer86](https://avatars.githubusercontent.com/u/129674997?s=40&v=4)](/shuoer86) [![@levisyin](https://avatars.githubusercontent.com/u/150114626?s=40&u=9ba0e018a112073c88ffab5ab37e3141739c0f9e&v=4)](/levisyin) [![@vuittont60](https://avatars.githubusercontent.com/u/81072379?s=40&u=052f8a9dcadce5d8915528e8ccf229f3538e0ee1&v=4)](/vuittont60) [![@Halimao](https://avatars.githubusercontent.com/u/25278203?s=40&u=7f6c26f8b0b4d64640cbbac9eb793cc1a02c3301&v=4)](/Halimao) [![@josef-widder](https://avatars.githubusercontent.com/u/44643235?s=40&u=ad032c021c999f39977fb0ee289904e95e79a08f&v=4)](/josef-widder) [![@williambanfield](https://avatars.githubusercontent.com/u/4561443?s=40&u=3038707f9c16359425bda84f89c854e9b98af483&v=4)](/williambanfield) [![@Kukovec](https://avatars.githubusercontent.com/u/23355223?s=40&v=4)](/Kukovec) [![@hattizai](https://avatars.githubusercontent.com/u/150505746?s=40&u=328e33fdace8113542e5d806a850ee89f2a5b9fd&v=4)](/hattizai) [![@IssouChancla](https://avatars.githubusercontent.com/u/35667132?s=40&u=13a8484d30cc6549490a2288fbee660ebe16c86c&v=4)](/IssouChancla) [![@cratelyn](https://avatars.githubusercontent.com/u/57912822?s=40&u=9d269b0bb2eae0768a18db38c9ca6bc0beb69f92&v=4)](/cratelyn) [![@gibson042](https://avatars.githubusercontent.com/u/1199584?s=40&v=4)](/gibson042) [![@deruelle](https://avatars.githubusercontent.com/u/54279?s=40&u=700a9c71cba97de27f782118eca74fc334a13dd9&v=4)](/deruelle) [![@glnro](https://avatars.githubusercontent.com/u/8335464?s=40&u=452d92f0eb544fd9453b2b731460f675d654321a&v=4)](/glnro) [![@k0marov](https://avatars.githubusercontent.com/u/95040709?s=40&u=203465a6843221c5a7f762c85eb904448dbd3acb&v=4)](/k0marov) [![@Pan-chao](https://avatars.githubusercontent.com/u/152830401?s=40&u=73d55d8b39612d96bebc642ea699dbc9d73a6903&v=4)](/Pan-chao) [![@hoanguyenkh](https://avatars.githubusercontent.com/u/49144992?s=40&u=296bfe609996c543b6a7d4cd8b4ba250b1682690&v=4)](/hoanguyenkh) [![@xyztoni](https://avatars.githubusercontent.com/u/143221387?s=40&u=351f01b11c9a44783b2c2c916cb67444cd2705cf&v=4)](/xyztoni) [![@dragonkid](https://avatars.githubusercontent.com/u/4601569?s=40&u=3297f3d0d53b3d5f72c2aae12b63660297d45760&v=4)](/dragonkid) [![@MattKetmo](https://avatars.githubusercontent.com/u/334996?s=40&u=2b06b452771518c77550e819cb6991bbe8866078&v=4)](/MattKetmo) [![@cosinlink](https://avatars.githubusercontent.com/u/15066232?s=40&u=b18d448683757cacf457c4d539225714f6f77023&v=4)](/cosinlink) [![@JekaMas](https://avatars.githubusercontent.com/u/3192700?s=40&v=4)](/JekaMas) [![@minhngoc274](https://avatars.githubusercontent.com/u/153509244?s=40&u=ffa0911d494df55262b4b57f3ca4d4d393e9a52b&v=4)](/minhngoc274) [![@keroro520](https://avatars.githubusercontent.com/u/1870648?s=40&u=586062441ea47a75253226370d0588e39879218f&v=4)](/keroro520)

`[chore(spec): merge main into](/cometbft/cometbft/commit/e7dd0ab89fc3783d3de30f2c5fb892f9ca072ba2 "chore(spec): merge main into `spec/consensus-gossip` (#2594)

- **Versioned protobuf files (#495)**
- **Restore rpc/grpc/v1/types.pb.go**
- **proto: restore deprecation notice on BroadcastAPI**
- **Struct `Client` exposes sensitive data (#784)**
- **Unsafe int cast in `kill` command (#783)**
- **ADR-100: Data Companion Push API (#73)**
- **rfc: incoming txs while catching up (#735)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.17.0 to 1.18.0
(#804)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.8 to 1.4.9
(#806)**
- **build(deps): Bump golang.org/x/sync from 0.1.0 to 0.2.0 (#807)**
- **build(deps): Bump google.golang.org/grpc from 1.54.0 to 1.55.0
(#813)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.0 to
1.15.1 (#810)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/prometheus/client_model from 0.3.0 to
0.4.0 (#812)**
- **build(deps): Bump github.com/prometheus/common from 0.42.0 to 0.43.0
(#811)**
- **ADR-103: Protobuf definition versioning (#772)**
- **spec/p2p: Specify the operation of a Reactor (#714)**
- **build(deps): Bump github.com/docker/distribution (#827)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.1 to 1.3.3
(#828)**
- **ADR-103: Protobuf definition versioning (#772) (#817)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.9 to 1.4.10
(#830)**
- **build(deps): Bump golang.org/x/net from 0.9.0 to 0.10.0 (#831)**
- **build(deps): Bump golang.org/x/crypto from 0.8.0 to 0.9.0 (#832)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.26.1 to 2.27.1
(#833)**
- **rpc: Remove response data from response failure logs (#829)**
- **pubsub/kvindexer:support for big numbers - v2 (#797)**
- **Extend the infrastructure provider with `StartNodes` and
`StopTestnet` (#796)**
- **grpc: Add base gRPC server with version service (#818)**
- **Digital Ocean implementation of `StartNodes` and `StopTestnet`
(#846)**
- **RFC 102: Improve forward compatibility of proto-generated Rust
(#724)**
- **mempool: Add metric to measure how many times a tx was received
(#637)**
- **`e2e` provider is extended with `Disconnect`, `Reconnect` and
`CheckUpgraded` (#852)**
- **Sort `loadtime` tool's report (#854)**
- **feat: make handshake cancelable (#857)**
- **proto: Restore snake_case JSON for `ExecTxResult` (#856)**
- **qa: 200-nodes test on v0.38 (#877)**
- **qa: rotating node test on `v0.38.x` (#883)**
- **Changes to QA related files (e.g., `method.md`) (#878)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.18.0 to 1.19.0
(#868)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.2 to 1.8.3
(#873)**
- **build(deps): Bump github.com/bufbuild/buf from 1.18.0 to 1.19.0
(#872)**
- **Adds `vote_extension_size` to manifests (#858)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.27.1 to 2.28.1
(#893)**
- **build(deps): Bump github.com/prometheus/common from 0.43.0 to 0.44.0
(#892)**
- **build(deps): Bump slackapi/slack-github-action from 1.23.0 to 1.24.0
(#869)**
- **ADR 104: State sync from local application snapshot (#801)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0
(#891)**
- **mempool: slight refactor for improving readability (#894)**
- **Add Vote Extension varying size testnet (#888)**
- **fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
(#908)**
- **build(deps): Bump github.com/bufbuild/buf from 1.19.0 to 1.20.0
(#912)**
- **build(deps): Bump github.com/golangci/golangci-lint (#917)**
- **build(deps): Bump github.com/spf13/viper from 1.15.0 to 1.16.0
(#913)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.19.0 to 1.20.0
(#910)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.1 to 2.28.2
(#914)**
- **Minor fixes to `RELEASES.md` (#923)**
- **Prevent a transaction to appear twice in the mempool (#890)**
- **New metrics to track duplicate votes and block parts (#896) (#905)**
- **e2e tests are being skipped; `INFRASTRUCTURE-*` bug; portGen
inconsistency bug (#933)**
- **build(deps): Bump github.com/bufbuild/buf from 1.20.0 to 1.21.0
(#948)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.20.0 to 1.21.0
(#946)**
- **spec/p2p: document the p2p API used by Reactors (#851)**
- **build(deps): Bump docker/login-action from 2.1.0 to 2.2.0 (#944)**
- **e2e: Generate prometheus.yaml on setup (#954)**
- **Update the type annotations in the light client spec (#955)**
- **build(deps): Bump docker/build-push-action from 4.0.0 to 4.1.0
(#947)**
- **build(deps): Bump docker/setup-buildx-action from 2.5.0 to 2.7.0
(#962)**
- **Add requirement for `CheckTx` in ABCI spec (#928)**
- **fix: avoid recursive call after rename to (*PeerState).MarshalJSON
(#865)**
- **Port upstream proto changes to cometbft package**
- **changelog: Import entries for v0.34.28, v0.34.29, v0.37.1 and
v0.37.2 to `main` (#974)**
- **test/e2e: Fix Docker image build (#984)**
- **build(deps): Bump github.com/BurntSushi/toml from 1.3.0 to 1.3.2
(#952)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.2 to 2.29.0
(#953)**
- **Remove duplicate function `deterministicExecTxResult` (#986)**
- **mempool: Fix the benchmarks (#934)**
- **Add `CMT_HOME` (or remove it?) (#983)**
- **Remove buf.yaml at the root of the source tree (#979)**
- **build(deps): Bump docker/build-push-action from 4.1.0 to 4.1.1
(#989)**
- **build(deps): Bump golang.org/x/net from 0.10.0 to 0.11.0 (#994)**
- **build(deps): Bump golang.org/x/sync from 0.2.0 to 0.3.0 (#990)**
- **build(deps): Bump google.golang.org/grpc from 1.55.0 to 1.56.0
(#992)**
- **build(deps): Bump github.com/golangci/golangci-lint from 1.53.2 to
1.53.3 (#996)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.1 to
1.16.0 (#991)**
- **spec/p2p: new structure for the p2p specification (#966)**
- **consensus: optimize vote and block part gossip with
HasProposalBlockPartMessage and random sleeps (#904)**
- **Extend ABCI `max_block_size` parameter to give extended control to
the app (#1003)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.21.0 to 1.22.0
(#1026)**
- **Bump logs on non-fatal vote validation failures to Info level
(#1022)**
- **Update codeowners to include DevRel team (#1023)**
- **deps: Manually bump github.com/vektra/mockery/v2 from 2.29.0 to
2.30.1 (#1009)**
- **Update releasing.md to sign tags (#1034)**
- **build(deps): Bump github.com/bufbuild/buf from 1.21.0 to 1.22.0
(#1027)**
- **Rename ABCI enums and values to satisfy buf guidelines (#975)**
- **build(deps): Bump google.golang.org/grpc from 1.56.0 to 1.56.1
(#1028)**
- **docs: Added double quotes to /abci_query path param (#1015)**
- **Update Docs with Finalize Block (#760)**
- **Clarifies that processProposal may be called for set of transactions
different from the one returned in the preceding prepareProposal
(#1033)**
- **Update the annotation of part_set.go (#1056)**
- **build(deps): Bump docker/setup-buildx-action from 2.7.0 to 2.8.0
(#1071)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.1 to
2.30.16 (#1064)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.22.0 to 1.23.1
(#1072)**
- **build(deps): Bump github.com/bufbuild/buf from 1.22.0 to 1.23.1
(#1066)**
- **build(deps): Bump google.golang.org/protobuf from 1.30.0 to 1.31.0
(#1065)**
- **build(deps): Bump google.golang.org/grpc from 1.56.1 to 1.56.2
(#1101)**
- **build(deps): Bump golang.org/x/crypto from 0.10.0 to 0.11.0
(#1103)**
- **build(deps): Bump docker/setup-buildx-action from 2.8.0 to 2.9.0
(#1105)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.16 to
2.31.1 (#1100)**
- **build(deps): Bump golang.org/x/net from 0.11.0 to 0.12.0 (#1102)**
- **ci: Trigger workflows on merge group (#1118)**
- **Revert \"config: add bootstrap peers (#9680)\" (#1109)**
- **node: Revert removal of public reactor accessors (#1120)**
- **ci: Disable CodeQL check in merge queues (#1123)**
- **p2p: Remove UPnP functionality (#1114)**
- **ADR 107: Rename proto versions to pre-v1 betas (#1110)**
- **RFC 104: Internal messaging using the actor model (#1092)**
- **build(deps): Bump github.com/bufbuild/buf from 1.23.1 to 1.24.0
(#1131)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.31.1 to 2.32.0
(#1132)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.0 to 2.9.1
(#1133)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.23.1 to 1.24.0
(#1134)**
- **spec: Add mempool specification in English and Quint (#997)**
- **mempool: ADR for refactoring list of senders  (#1032)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.24.0 to 1.25.0
(#1157)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.7.0 to 5.8.0
(#1159)**
- **build(deps): Bump github.com/bufbuild/buf from 1.24.0 to 1.25.0
(#1160)**
- **proxy: Rename \"unsynchronized\" to \"connection-synchronized\" local
client creator (#1145)**
- **mempool: Keep track of senders in reactor instead of implementation
(#1010)**
- **cmd: Remove `replay` and `replay-console` subcommands (#1170)**
- **build(deps): Bump google.golang.org/grpc from 1.56.2 to 1.57.0
(#1181)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.0 to 5.8.1
(#1180)**
- **ci: Remove Mergify automerge (#1182)**
- **Add gRPC block service (#1142)**
- **blocksync: export errors (#1186)**
- **Porting changes related to creating a lean docker image from
`pierre/fast-prototyping-1059` branch. (#1192)**
- **chore: Format repo (#1193)**
- **Add BlockResults gRPC service (#1168)**
- **consensus: remove logic to unlock block on +2/3 prevote for nil
(#1175)**
- **ADR 101: Add GetLatest method to block service (#1209)**
- **ADR 101: Implement pruning mechanism (#1150)**
- **config: export errors (#1190)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.0 to 2.32.3
(#1218)**
- **Add check for non-`nil` in `enterCommit` (#1208)**
- **Log proposer's address when correctly accepting a proposal (#1079)**
- **Close evidence.db OnStop (#1210)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.0 to 1.25.1
(#1213)**
- **build(deps): Bump golang.org/x/crypto from 0.11.0 to 0.12.0
(#1215)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.0 to 1.25.1
(#1216)**
- **build(deps): Bump golang.org/x/net from 0.12.0 to 0.14.0 (#1217)**
- **Forward-port: update state to prevote `nil` when proposal block does
not match locked block (#1203)**
- **mempool: Store peer ids as p2p.ID instead of uint16 (remove
mempoolIDs) (#1191)**
- **ADR-101: implement gRPC `PruningService` (#1154)**
- **consensus: Avoid process proposal when we know correct nodes
validated it (#1231)**
- **ADR-101: Metrics to monitor the pruning  (#1234)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.1 to 1.26.0
(#1241)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.1 to 1.26.1
(#1239)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1240)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.3 to 2.32.4
(#1242)**
- **abci: export errors  (#1185)**
- **consensus: export errors (#1211)**
- **ADR-101: Pruning mechanism minor fixes (#1246)**
- **chore: Bump minimum Go version on `main` to v1.21 (#1244)**
- **ADR 101: Add `Close` method to gRPC client (#1251)**
- **ADR 108: ADR for extending E2E infrastructure so that we can check
CometBFT's behaviour with respect to ABCI++ grammar. (#902)**
- **docs: Add logging guide to contributing guidelines (#1250)**
- **chore: log `app_hash` as hex (#1264)**
- **update language (#1263)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.0 to 1.26.1
(#1272)**
- **build(deps): Bump gonum.org/v1/gonum from 0.13.0 to 0.14.0 (#1275)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.10 to 1.4.11
(#1276)**
- **ADR 101: Refactor height check-related logic and tests (#1271)**
- **Fixed linter**
- **Revert \"Fixed linter\"**
- **Fixed mem aliasing in for loop (#1280)**
- **Remove genesis persistence in state db (#1017)**
- **Revert \"Remove genesis persistence in state db (#1017)\" (#1294)**
- **evidence: export errors (#1284)**
- **Re-implement removal of genesis persistence in state db (#1295)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.1 to 2.10.0
(#1298)**
- **node: verify genesis doc hash against the file contents rather than
remarshalled JSON (#1293)**
- **indexer: Implement pruning mechanism (#1176)**
- **Provide relevant block data in `ExtendVote` (#1270)**
- **node/state:bootstrap state api (#1057)**
- **build(deps): Bump actions/checkout from 3 to 4 (#1319)**
- **build(deps): Bump docker/build-push-action from 4.1.1 to 4.2.1
(#1318)**
- **Fix (#1323)**
- **state: remove genesis file from database  (#1297)**
- **Added changelog for pruning metrics (#1335)**
- **Removed begin_block_events and end_block_events from rpc doc
(#1338)**
- **consensus: test for precommit/locking corner case (#1257)**
- **TxIndexer and BlockIndexer pruning metrics (#1334)**
- **Forward port changes to changelog and `UPGRADING.md` for release
`v0.38.0` (#1341)**
- **Update Go version specified in root README on main for v0.34.x
(#1352)**
- **Add test/e2e/data to gitignore (#1349)**
- **docs: gRPC services and data companion pruning services (#1307)**
- **Add genesis_hash flag check on node startup (#1324)**
- **gRPC for Tx and Block indexer pruning (#1327)**
- **build(deps): Bump docker/build-push-action from 4.2.1 to 5.0.0
(#1371)**
- **build(deps): Bump docker/setup-buildx-action from 2.10.0 to 3.0.0
(#1370)**
- **build(deps): Bump docker/login-action from 2.2.0 to 3.0.0 (#1368)**
- **build(deps): Bump goreleaser/goreleaser-action from 4 to 5 (#1369)**
- **ADR101: Moved changelog entries (#1377)**
- **Max byte check (#1384)**
- **Update to string (#1385)**
- **mempool: Remove unused peerID constants (#1379)**
- **build(deps): Bump github.com/google/uuid from 1.3.0 to 1.3.1
(#1392)**
- **build(deps): Bump github.com/rs/cors from 1.9.0 to 1.10.0 (#1393)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.1 to 5.9.0
(#1396)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.4 to 2.34.0
(#1400)**
- **build(deps): Bump github.com/go-kit/kit from 0.12.0 to 0.13.0
(#1397)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1398)**
- **build(deps): Bump google.golang.org/grpc from 1.57.0 to 1.58.2
(#1399)**
- **doc: improve documentation of BlockParams.MaxBytes (#1405)**
- **rpc: Improve abci_query parameter documentation (#1184)**
- **Bump p2p version following introduction of
`HasProposalBlockPartMessage` (#1411)**
- **RFC: Allowing Non-Determinism in `ProcessProposal` (#1391)**
- **ADR-101: Data Companion Pull API (#82)**
- **build(deps): Bump github.com/rs/cors from 1.10.0 to 1.10.1 (#1418)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.0 to 2.34.2
(#1416)**
- **build(deps): Bump github.com/prometheus/client_golang (#1417)**
- **fix typos (#1413)**
- **Renames Tendermint to CometBFT in the RPC related test code
(#1428)**
- **Renames Tendermint to CometBFT in the RPC related test code. This
file was missing and it was not caught in the branch testing. (#1433)**
- **Reject incoming txs while node is catching up (#1119)**
- **build(deps): Bump golang.org/x/crypto from 0.13.0 to 0.14.0
(#1458)**
- **build(deps): Bump golang.org/x/sync from 0.3.0 to 0.4.0 (#1454)**
- **build(deps): Bump golang.org/x/net from 0.15.0 to 0.16.0 (#1453)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.1 to 1.27.0
(#1449)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.11.0 to
0.12.0 (#1450)**
- **build(deps): Bump github.com/prometheus/client_model (#1455)**
- **build(deps): Bump github.com/bufbuild/buf from 1.26.1 to 1.27.0
(#1459)**
- **build(deps): Bump github.com/spf13/viper from 1.16.0 to 1.17.0
(#1456)**
- **test: respect P2PConfig fuzzing configuration in MultiplexTransport
(#1414)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.2 to 2.35.3
(#1462)**
- **crypto: export errors (#1463)**
- **Do not race with pruning to validate headers and validators
(#1467)**
- **fix typos (#1487)**
- **Call observer only when retain height changes (#1490)**
- **build(deps): Bump pillow from 9.3.0 to 10.0.1 in
/scripts/qa/reporting (#1493)**
- **abci: Add relaxed local client synchronization models (#1141)**
- **docs: fix typos (#1500)**
- **Post-merge fixes for feature/proto-upgrade**
- **Make BuildLastCommitInfo and BuildExtendedCommitInfo public
(#1502)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.3 to 2.35.4
(#1497)**
- **build(deps): Bump google.golang.org/grpc from 1.58.2 to 1.58.3
(#1498)**
- **build(deps): Bump golang.org/x/net from 0.16.0 to 0.17.0 (#1499)**
- **tiny change: reorder expected and actual values (#1506)**
- **Fixed docker port alias (#1507)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.0 to 1.27.1
(#1527)**
- **Implement ADR-107: rename proto package version suffixes to v1beta*
pattern (#1510)**
- **e2e: Fix flakiness in grpc tests due to pruning (#1492)**
- **fix spelling of bandwidth (#1534)**
- **Fix linting on `main` (#1531)**
- **build(deps): Bump github.com/prometheus/common from 0.44.0 to 0.45.0
(#1524)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.0 to 1.27.1
(#1522)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1540)**
- **fix some typos (#1541)**
- **indexer-respect-height-params-on-query (#1529)**
- **Correct go_package paths in service proto files (#1538)**
- **build(deps): Bump google.golang.org/grpc from 1.58.3 to 1.59.0
(#1521)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.4 to 2.36.0
(#1523)**
- **feat(mempool): export error (#1427)**
- **Rename proto messages and services to satisfy default buf lints
(#1533)**
- **RFC 106: non-idempotent methods in data companion (#1545)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.0
(#1550)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.1 to 1.27.2
(#1551)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1552)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.1 to 1.27.2
(#1553)**
- **use assert.Greater instead of Equal for better error reporting
(#1547)**
- **rpc: Version the RPC APIs (#1412)**
- **mempool: Add metric size of pool in bytes (#1512)**
- **build(deps): Bump github.com/docker/docker (#1570)**
- **build(deps): Bump github.com/spf13/cobra from 1.7.0 to 1.8.0
(#1572)**
- **build(deps): Bump golang.org/x/sync from 0.4.0 to 0.5.0 (#1574)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.0 to 2.36.1
(#1576)**
- **build(deps): Bump github.com/gorilla/websocket from 1.5.0 to 1.5.1
(#1575)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1573)**
- **chore: consolidate changelog improvements section (#1578)**
- **Implementation of ADR-108 (#930)**
- **Reduce the default MaxBytes to 4mb and increase MaxGas to 10 million
(#1518)**
- **e2e: Allow disabling the PEX reactor on all nodes in the testnet
(#1580)**
- **Experimental - Reduce # of connections effectively used to gossip
transactions out (#1558)**
- **Update proto file references to follow renaming/versioning (#1555)**
- **Make `LoadBlock` also return block metadata (#1557)**
- **mempool: Limit gossip connections to persistent and non-persistent
peers (experimental) (#1584)**
- **fix: docs: default db provider moved from node to config (#1588)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.2 to 1.28.0
(#1598)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.2 to 1.28.0
(#1602)**
- **build(deps): Bump golang.org/x/crypto from 0.14.0 to 0.15.0
(#1599)**
- **build(deps): Bump golang.org/x/net from 0.17.0 to 0.18.0 (#1597)**
- **RFC 107: Internal signalling using event observers (#1164)**
- **ADR 110: Remote mempool (#1565)**
- **chore: aligns function descriptions with godoc standards in the
types package (#1593)**
- **docs: various improvements (#1603)**
- **chore: Merge branch main into feature/proto-upgrade (#1612)**
- **Removes wrong assertion and decreases likelyhood of block from the
future has actually been already created (#1619)**
- **Split /api off to separate go.mod (#1608)**
- **feature: Reduce Go API surface area (ADR 109) (#1605)**
- **refactor: Export func MakeHTTPDialer (#1594)**
- **First draft (#1483)**
- **pruning:do not attempt to prune state if no blocks are pruned
(#1616)**
- **Update SECURITY.md (#1626)**
- **Update changelog on `main` with new releases (#1644)**
- **proto: Update README (#1648)**
- **ADR 111: `nop` Mempool (#1585)**
- **ADR-111: Addressed Ethan's comment (#1667)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.1 to 2.37.1
(#1662)**
- **build(deps): Bump docker/build-push-action from 5.0.0 to 5.1.0
(#1664)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.0 to 1.28.1
(#1665)**
- **ci: Fix v0.34 nightly build (#1655)**
- **build(deps): Bump github.com/bufbuild/buf from 1.28.0 to 1.28.1
(#1663)**
- **feature/proto-upgrade: Fix generated mock code (#1673)**
- **Update link in README.md (#1674)**
- **Renames the semantic versioning variable to CMT (#1621)**
- **mempool: add `nop` mempool (#1643)**
- **e2e:fix-digital-ocean-ports (#1678)**
- **Revert modularization of the test infra (#1488) (#1676)**
- **docs: various small improvements (part 2) (#1683)**
- **Do not block indefinitely on the semaphore (#1654)**
- **Adds tests that check for FIFO ordering being broken by gossip
(#1628)**
- **loadtime: Add parameter for displaying results in one line (#1511)**
- **Promote latest versions of Protobuf definitions to v1 packages
(#1677)**
- **chore: Update CHANGELOG.md (#1701)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1696)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.37.1 to 2.38.0
(#1697)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.1
(#1702)**
- **proto: document the `cometbft.*` versioned protos (#1694)**
- **Clean up changelog entries and README files for versioned proto
changes (#1707)**
- **chore(proto): add missing docs (#1703)**
- **feature/proto-upgrade: Last-minute fixes (#1709)**
- **e2e: Support emulated latencies between docker images (#1560)**
- **build(deps): Bump golang.org/x/net from 0.14.0 to 0.17.0 in /api
(#1713)**
- **Prepare `main` for `v1.x` backport branch (#1714)**
- **build(deps): Bump golang.org/x/crypto from 0.15.0 to 0.16.0
(#1720)**
- **build(deps): Bump golang.org/x/net from 0.18.0 to 0.19.0 (#1719)**
- **types: validate Validator#Address field (#1715)**
- **Enable Mergify backports for `v1.x` branch (#1724)**
- **deps: Bump cometbft-db to v0.9.0 (#1725)**
- **buf improvements prior to publishing on BSR (#1726)**
- **proto: give our buf module a name (#1734)**
- **deps: Bump cometbft-db to v0.9.1 (#1737)**
- **chore: Update root docs (#1740)**
- **fix: increase abci socket message size limit to 2GB (#1730)**
- **proto: make comment in README more Markdowny (#1743)**
- **fix: Txs Validate (#1687)**
- **Add test missing in #1687 (#1712)**
- **perf(state): batch save `State` (#1735)**
- **Update CODE_OF_CONDUCT.md (#1708)**
- **[e2e] Fixes prepareProposal not to return oversized set of
transactions (#1756)**
- **perf(store): Batch save `Block` (#1755)**
- **Fix: Fix minor typos (#1780)**
- **`VerifyCommitLight` and `VerifyCommitLightTrusting` _never_ check
all signatures (#1750)**
- **Fix typo in encoding.md (#1801)**
- **chore(docs): small improvements (#1781)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.10.1 to 5.11.0
(#1797)**
- **build(deps): Bump actions/setup-go from 4 to 5 (#1794)**
- **build(deps): Bump actions/stale from 8 to 9 (#1795)**
- **build(deps): Bump github.com/spf13/viper from 1.17.0 to 1.18.1
(#1796)**
- **Chore/fix other typos (#1809)**
- **chore(spec): specify which fields must be deterministic (#1804)**
- **Small improvements in #1806 not present in #1750 (#1808)**
- **Add changelog for #1749 (#1807)**
- **e2e: Implement latency emulation for DigitalOcean (#1587)**
- **add GH workflow for linting code using codespell (#1824)**
- **chore(docs): explain the effect of `timeout_propose` (#1798)**
- **build(deps): Bump actions/upload-artifact from 3 to 4 (#1845)**
- **build(deps): Bump actions/setup-python from 2 to 5 (#1843)**
- **build(deps): Bump github/codeql-action from 2 to 3 (#1847)**
- **build(deps): Bump actions/checkout from 2 to 4 (#1846)**
- **build(deps): Bump github.com/google/uuid from 1.4.0 to 1.5.0
(#1850)**
- **build(deps): Bump google.golang.org/grpc from 1.59.0 to 1.60.0
(#1851)**
- **golangci-lint: enable all the linters by default (#1838)**
- **Updates go crypto package to v0.17.0 (#1859)**
- **Adds checks for nil keys and signatures (#1855)**
- **The store DB and the companion `BlockStore` struct are sometimes out
of sync (#1856)**
- **Allow blocksync to not verify all signatures (#1858)**
- **Fixing the ABCI grammar and updating the code for e2e tests to
account for the new grammar. (#1829)**
- **docs: Fix Discord links in README (#1874)**
- **build(deps): Bump github.com/prometheus/client_golang (#1909)**
- **build(deps): Bump github.com/btcsuite/btcd/btcutil from 1.1.3 to
1.1.5 (#1908)**
- **build(deps): Bump google.golang.org/protobuf (#1885)**
- **build(deps): Bump github.com/spf13/viper from 1.18.1 to 1.18.2
(#1884)**
- **build(deps): Bump google.golang.org/grpc from 1.60.0 to 1.60.1
(#1883)**
- **remove unused linters that produced a warning and ensure that
unparam is enabled (#1905)**
- **Fix HTTP response body not being closed after reading (#1945)**
- **Disable undesired linting code (#1959)**
- **Extend kvstore example add with with key types (#1876)**
- **Extra check in `VerifyExtension` (#1877)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.38.0 to 2.39.1
(#1882)**
- **perf(crypto/merkle, crypto/tmhash): simplify+optimize SHA256 hashing
of multiple byteslices (#1921)**
- **Update localnet-start Makefile (#1975)**
- **blocksync: wait for poolRoutine to stop in (*Reactor).OnStop
(#1879)**
- **fix TestListenerTimeoutReadWrite (#1947)**
- **docs: fix typos (#1988)**
- **this is the kindest commit I can think of. Take it that way and read
the code. (#1987)**
- **there's really no need for this anymore (#1986)**
- **feat: DefaultHttpClient support setting proxy from env (#1900)**
- **feat: lint tests (#1906)**
- **chore: fix typos (#1991)**
- **build(deps): Bump golang.org/x/sync from 0.5.0 to 0.6.0 (#1992)**
- **feat(proxy): export errors (#1899)**
- **doc:fix broken link in DOCKER/README.md (#1996)**
- **feat: custom dependencies order (#1994)**
- **PBTS: migrating to `main` the new version of the specification
(#1973)**
- **Fix paths to scripts/metricsgen in go:generate commands (#1998)**
- **chore: fix some typos (#2002)**
- **docs(light): fix broken link to spec (#2007)**
- **chore(test/loadtime): replace tm-load-test w/ cometbft-load-test
(#2009)**
- **ci: Remove unused `tests` target when compiling e2e (#2022)**
- **spec: fix typo in `encoding.md` (#2024)**
- **mempool: Fix data races in CListMempool's height and
notifiedTxsAvailable (#2021)**
- **chore(test/loadtime): cleanup go.sum and golangci.yml (#2025)**
- **build(deps): Bump github.com/prometheus/common from 0.45.0 to 0.46.0
(#2040)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.39.1 to 2.40.1
(#2038)**
- **feat(rpc): Use default port for HTTP(S) URLs when there is no
explicit port (#1903)**
- **misc(go.mod): remove unused peg dependency (#2044)**
- **config: Remove unused `max_batch_bytes` (#2050)**
- **Merge pull request from GHSA-qr8r-m495-7hc4**
- **misc(tools)!: remove `tools` package (#2046)**
- **docs(guides): add missing import (#2070)**
- **deps(localnode): bump alpine version (#2077)**
- **misc(Makefile): add `help` target to display the help msg (#2074)**
- **`e2e`: test vote extension activation via `InitChain` and
`FinalizeBlock` (#2066)**
- **scripts: metricsgen parses '// metrics:' pattern (#2090)**
- **e2e: Add `load_max_txs` option to manifest (#2094)**
- **consensus: Add `chain_size_bytes` metric (#2093)**
- **feat: conventional commits (#1995)**
- **Forward port of tendermint/tendermint#7605, tendermint/spec#393, and
tendermint/tendermint#8142 (#2018)**
- **ci: fix permissions for \"Conventional PR Title\" (#2099)**
- **PBTS: additions and fixes on migrated spec (#2013)**
- **PBTS: forward port of tendermint/tendermint#7709 (#2089)**
- **feat: use go workspace (#1924)**
- **fix: `ValidateUpdate`: allow no-change updates regardless of current
height (#2112)**
- **test(localnet): Add monitoring tools for localnet (#2108)**
- **feat: add gofumpt (#2049)**
- **feat(consensus): increase log level for corner case when prevoting a
proposal (#2042)**
- **docs: v1 - diataxis framework (#2105)**
- **feat(consensus): additional sanity checks for the size of proposed
blocks (#1408)**
- **perf(internal/blocksync): avoid double-calling
`types.BlockFromProto` (#2016)**
- **build(deps): Bump google.golang.org/grpc from 1.60.1 to 1.61.0
(#2178)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.1 to 1.29.0
(#2161)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.12.0 to
0.12.1 (#2160)**
- **build(deps): Bump slackapi/slack-github-action from 1.24.0 to 1.25.0
(#2162)**
- **build(deps): Bump github.com/google/uuid from 1.5.0 to 1.6.0
(#2176)**
- **refactor(privval): reverse conditional + more idiomatic Go code with
early returns (#2156)**
- **fix(e2e): path to latency script files in DO (#2148)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.9.1 to
0.10.0 (#2175)**
- **chore(Makefile): add `setup-pre-commit` target to init git hook
(#2123)**
- **feat: add pebbledb (https://github.com/cockroachdb/pebble) (#2132)**
- **perf(internal/blocksync): do not `ValidateBlock` twice (#2026)**
- **feat(e2e): Add new targets `fast` and `clean` to Makefile (#2192)**
- **ci: add `spec` type in conventional-pr-title (#2191)**
- **fix(privval): retry accepting a connection on errors (#2047)**
- **fix(.github/workflows): correct parameters to lint_pr_title
(#2199)**
- **docs: update QA method steps for qa-infra changes (#2198)**
- **feat!(pbts): forward port of tendermint/tendermint#7711 (#2149)**
- **docs(pbts): forward port of PBTS documentation and fixes (#2124)**
- **fix: if-return and early-return (#2215)**
- **chore: remove amazon linux Dockerfile and update
test/docker/Dockerfile (#2135)**
- **feat(ci): pre-commit framework (#2214)**
- **ci: add `merge` type for conventional-pr-title (#2219)**
- **spec(consensus/pbts): update description for introduced parameters.
(#2206)**
- **perf: optimize psql indexer (#2142)**
- **fix(go.mod): do not use `replace` for api (#2236)**
- **fix(Makefile): gofumpt no longer needed (#2235)**
- **fix(p2p/pex): gracefully shutdown `Reactor` (#2010)**
- **test(mempool): fix
TestMempoolUpdateDoesNotPanicWhenApplicationMissedTx (#2242)**
- **fix(flowrate): fix non-determinism in flowrate tests (#2147)**
- **refactor!: Implement RFC 106: remove `GetLatestBlock*` methods from
data companion API (#2240)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.3 to 1.3.7
(#2253)**
- **chore(config): update DB section in toml.go (#2249)**
- **fix(consensus): do not precommit nil if proposal block is received
(#2221)**
- **build(deps): Bump github.com/opencontainers/runc from 1.1.5 to
1.1.12 (#2261)**
- **fix(mempool/tests): Reduce tests duration (#2263)**
- **ci: run golangci-lint linters for all files (not only ones which
were modified) (#2250)**
- **refactor(examples): small changes to kvstore app (#2267)**
- **refactor(mempool): simplify parameters of resCbFirstTime and
resCbRecheck (#2272)**
- **perf(mempool/cache): clear map in Reset (#2259)**
- **test(abci): update e2e tests to check against ABCI 2.0 grammar
(#2201)**
- **docs: symbolic references to steps in the qa-infra README (#2280)**
- **chore: updated doc link (#2296)**
- **fix(consensus): prevote nil upon timeout when Proposal is missing
(#2218)**
- **build(deps): Bump pre-commit/action from 3.0.0 to 3.0.1 (#2307)**
- **build(deps): Bump golang.org/x/net from 0.20.0 to 0.21.0 (#2300)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.10.0 to
0.11.0 (#2299)**
- **docs: ADR-112 Proposer-Based Timestamps (#2223)**
- **refactor(internal/statesync): replace ticker with `time.After(X)`
(#2294)**
- **fix: simultaneous rpc test failures (#2150)**
- **chore(docs): alter the section about the effects of `timeout_commit`
(#1892)**
- **refactor(p2p)!: Refactor PeerSet to eliminate data races & improve
performance (#2246)**
- **feat(pbts): Update consensus params to include pbts enabled
(#2231)**
- **feat(storage/metrics): Metrics to measure storage (#1974)**
- **feat(e2e): Log number of sent txs (success and failed) (#2328)**
- **chore: enable gomoddirectives, unparam (#2290)**
- **docs: images not rendering properly in docs (#2331)**
- **docs: Fix references about DeliverTx (#2330)**
- **docs(qa): Add table of contents to existing QA reports (#2343)**
- **chore: enable perfsprint linter (#2291)**
- **feat(pruning): trigger explicitly compaction upon pruning (#1972)**
- **docs: explain how to skip pre-commit hook (#2358)**
- **build(deps): Bump github.com/prometheus/common from 0.46.0 to 0.47.0
(#2373)**
- **build(deps): Bump google.golang.org/grpc from 1.61.0 to 1.61.1
(#2372)**
- **feat(e2e): Option to set max block size in bytes at genesis
(#2362)**
- **build(deps): Bump github.com/prometheus/client_model from 0.5.0 to
0.6.0 (#2371)**
- **revert(pbts): revert removal of BFT Time related functions (#2205)**
- **fix(e2e): Reduce flakiness of TestGRPC_GetBlockResults (#2367)**
- **spec(consensus): update Block Time documentation in spec (#2316)**
- **spec: adaptive MSGDELAY parameter included in PBTS spec (#2318)**
- **feat(pbts): Moving VoteExtensionsEnableHeight from ABCIParams to
FeatureParams. (#2335)**
- **fix: remove TestMempoolFIFOWithParallelCheckTx (#2364)**
- **fix(docker-compose): fix subnet (#2383)**
- **feat(pbts): enable `e2e` manifest config to set `PbtsEnableHeight`
(#2284)**
- **perf(internal/state): avoid double-saving FinalizeBlockResponse
(#2017)**
- **build(deps): Bump fonttools from 4.37.4 to 4.43.0 in
/scripts/qa/reporting (#2407)**
- **build(deps): Bump pillow from 10.0.1 to 10.2.0 in
/scripts/qa/reporting (#2408)**
- **fix(node): Forward compaction config params to blockstore
constructor (#2418)**
- **refactor!: moved `MedianTime` out of `internal` folder (#2397)**
- **chore: typo fixes (#2403)**
- **chore(pbts): Removes useless code (#2420)**
- **build(deps): Bump github.com/prometheus/common from 0.47.0 to 0.48.0
(#2430)**
- **build(deps): Bump google.golang.org/grpc from 1.61.1 to 1.62.0
(#2429)**
- **test(consensus): PBTS should be enabled by default in test units
(#2329)**
- **test(consensus): test enabling PBTS at a given height (#2404)**
- **refactor(protobuf): switch from gogofaster to gocosmos generator
(#2425)**
- **docs(tutorials/install): add `From Go package` (#2414)**
- **docs(pbts): documentation for PBTS-related consensus parameters
(#2376)**
- **refactor(consensus): print err from SignAndCheckVote (#2346)**
- **feat(e2e): add parameter to set a custom output directory for
testnet files (#2433)**
- **spec(consensus): update description of consensus parameters for PBTS
(#2415)**
- **fix(localnet): Grafana dashboards for storage tests - removed
experimental metrics (#2448)**
- **fix(jsonrpc): enable HTTP basic auth in WS client (#2434)**
- **feat(pbts): Adds timestamp to the `msgInfo` written into the WAL
(#2388)**
- **fix: `Rollback`: wrong modification of
`state.LastHeightValidatorsChanged` while rollback at a special height
(#2136)**
- **docs(changelog): add missing entry for #2136 (#2459)**
- **fix(pbts): legacy `ABCIParams` values are properly translated to
`FeatureParams` values (#2462)**
- **fix(e2e): Fixing the bug in ABCI e2e tests (#2468)**
- **feat(localnet): Grafana PNG rendering for easier graph exports
(#2472)**
- **docs(README): remove Terra (#2469)**
- **docs: document PBTS adaptive delays mechanism (#2452)**
- **fix(config): Moved compact variables to the right section (#2477)**
- **feat(metrics): more buckets for ProposalTimestampDifference
(#2479)**
- **fix(metrics): more buckets for ProposalTimestampDifference (#2481)**
- **feat(pbts): Make synchrony params adaptive (#2431)**
- **ci: check metrics generation in CI checks (#2483)**
- **feat(consensus): improve logging for timely and untimely messages
(#2321)**
- **feat(types): improve Proposal and SynchronyParams validation tests
(#2489)**
- **test(consensus): refactor TestStateLock_POLSafety tests (#2492)**
- **feat(types): refactor types.AdaptiveSynchronyParams method (#2490)**
- **fix: lint errors introduced with the latest merge (#2495)**
- **build(deps): Bump docker/setup-buildx-action from 3.0.0 to 3.1.0
(#2500)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.18.0 to
1.19.0 (#2508)**
- **build(deps): Bump golang.org/x/crypto from 0.19.0 to 0.20.0
(#2507)**
- **build(deps): Bump github.com/prometheus/common from 0.48.0 to 0.49.0
(#2506)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.4 to 1.9.0
(#2505)**
- **fix(docs): include `timesync` daemon instructions (#2491)**
- **feat(privval)!: DO NOT require extension signature (#2496)**
- **refactor(privval): rename sign_extension to skip_sign_extension
(#2519)**
- **spec(abci): fixes the spec to inform about the presence of invalid
extensions in `last_commit` (#2423)**
- **fix(pbts): block Time must be Canonical (#2493)**
- **feat(e2e): Add manifest option `clock_skew` and corresponding
backend functionality (#2454)**
- **fix(mempool): converting to uint64 before additions to avoid
overflows (#2498)**
- **refactor!: Rename `skip_sign_extension` to `skip_extension_signing`
(#2522)**
- **docs(ADR): ADR-108 updated to account for the new changes in the
grammar and code. (#2528)**
- **feat(e2e): add generator support for clock skew + env variable
rename (#2488)**
- **spec(proto): add `cometbft.privval.v1beta2` proto package (#2529)**
- **chore: improving error handling in the PendingEvidence (#2550)**
- **feat(blocksync)!: set the max number of (concurrently) downloaded
blocks to {peersCount * 20} (#2467)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.29.0 to 1.30.0
(#2557)**
- **build(deps): Bump google.golang.org/protobuf from 1.32.0 to 1.33.0
(#2560)**
- **build(deps): Bump golang.org/x/net from 0.21.0 to 0.22.0 (#2562)**
- **fix(cmd/cometbft/commands/version): update the output for v1
(#2546)**
- **build(deps): Bump docker/build-push-action from 5.1.0 to 5.2.0
(#2558)**
- **build(deps): Bump github.com/prometheus/common from 0.49.0 to 0.50.0
(#2559)**
- **build(deps): Bump google.golang.org/grpc from 1.62.0 to 1.62.1
(#2563)**
- **build(deps): Bump golang.org/x/crypto from 0.20.0 to 0.21.0
(#2561)**
- **feat(blocksync): sort peers by download rate & multiple requests for
closer blocks (#2475)**
- **feat(pbts): Adjusts PBTS metrics buckets (#2578)**
- **fix(blocksync): use timer instead of time.After (#2584)**
- **fix: temporary fix for `api` dependency (#2589)**

---------

Signed-off-by: Thane Thomson <connect@thanethomson.com>
Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Thane Thomson <connect@thanethomson.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Anton Kaliaev <anton.kalyaev@gmail.com>
Co-authored-by: Mikhail Zabaluev <mikhail@informal.systems>
Co-authored-by: Troy Kessler <43882936+troykessler@users.noreply.github.com>
Co-authored-by: leven <112051166+lx-xiang@users.noreply.github.com>
Co-authored-by: werty144 <anton-paramonov2000@yandex.ru>
Co-authored-by: Adi Seredinschi <adizere@gmail.com>
Co-authored-by: Sukey <35202440+sukey2008@users.noreply.github.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
Co-authored-by: Jasmina Malicevic <jasmina.dustinac@gmail.com>
Co-authored-by: moriluka <85185077+moriluka@users.noreply.github.com>
Co-authored-by: ƒê·ªó Vi·ªát Ho√†ng <hoangdv2429@gmail.com>
Co-authored-by: alex <152680487+azukiboy@users.noreply.github.com>
Co-authored-by: Hern√°n Vanzetto <15466498+hvanz@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@informal.systems>
Co-authored-by: Andy Nogueira <me@andynogueira.dev>
Co-authored-by: nenadmilosevic95 <50905385+nenadmilosevic95@users.noreply.github.com>
Co-authored-by: nenadmilosevic95 <nenad@informal.systems>
Co-authored-by: Jacob Gadikian <jacobgadikian@gmail.com>
Co-authored-by: Greg Szabo <16846635+greg-szabo@users.noreply.github.com>
Co-authored-by: Emmanuel T Odeke <emm.odeke@gmail.com>
Co-authored-by: jchappelow <140431406+jchappelow@users.noreply.github.com>
Co-authored-by: shuoer86 <129674997+shuoer86@users.noreply.github.com>
Co-authored-by: levisyin <150114626+levisyin@users.noreply.github.com>
Co-authored-by: vuittont60 <81072379+vuittont60@users.noreply.github.com>
Co-authored-by: Halimao <1065621723@qq.com>
Co-authored-by: alex <152680487+bodhi-crypo@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@usi.ch>
Co-authored-by: Josef Widder <44643235+josef-widder@users.noreply.github.com>
Co-authored-by: William Banfield <4561443+williambanfield@users.noreply.github.com>
Co-authored-by: Kukovec <jure.kukovec@gmail.com>
Co-authored-by: Daniel Cason <cason@gandria>
Co-authored-by: M. J. Fromberger <fromberger@interchain.io>
Co-authored-by: hattizai <150505746+hattizai@users.noreply.github.com>
Co-authored-by: Huulu <35667132+IssouChancla@users.noreply.github.com>
Co-authored-by: katelyn martin <me+cratelyn@katelyn.world>
Co-authored-by: Richard Gibson <richard.gibson@gmail.com>
Co-authored-by: Jean Deruelle <jean.deruelle@gmail.com>
Co-authored-by: glnro <8335464+glnro@users.noreply.github.com>
Co-authored-by: Greg Szabo <greg@philosobear.com>
Co-authored-by: Emmanuel T Odeke <emmanuel@orijtech.com>
Co-authored-by: levisyin <lilassherl@gmail.com>
Co-authored-by: k0marov <95040709+k0marov@users.noreply.github.com>
Co-authored-by: Adi Seredinschi <a@seredinschi.net>
Co-authored-by: Pan chao <152830401+Pan-chao@users.noreply.github.com>
Co-authored-by: Khanh Hoa <49144992+hoanguyenkh@users.noreply.github.com>
Co-authored-by: glnro <lauren@informal.systems>
Co-authored-by: toni <143221387+xyztoni@users.noreply.github.com>
Co-authored-by: DragonKid <idragonkid@gmail.com>
Co-authored-by: Matt Ketmo <matthieu@moquet.net>
Co-authored-by: Ethan <cosinlinker@gmail.com>
Co-authored-by: Evgeny Danilenko <6655321@bk.ru>
Co-authored-by: Duong Minh Ngoc <153509244+minhngoc274@users.noreply.github.com>
Co-authored-by: Kero <keroroxx520@gmail.com>") [spec/consensus-gossip](/cometbft/cometbft/commit/e7dd0ab89fc3783d3de30f2c5fb892f9ca072ba2 "chore(spec): merge main into `spec/consensus-gossip` (#2594)

- **Versioned protobuf files (#495)**
- **Restore rpc/grpc/v1/types.pb.go**
- **proto: restore deprecation notice on BroadcastAPI**
- **Struct `Client` exposes sensitive data (#784)**
- **Unsafe int cast in `kill` command (#783)**
- **ADR-100: Data Companion Push API (#73)**
- **rfc: incoming txs while catching up (#735)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.17.0 to 1.18.0
(#804)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.8 to 1.4.9
(#806)**
- **build(deps): Bump golang.org/x/sync from 0.1.0 to 0.2.0 (#807)**
- **build(deps): Bump google.golang.org/grpc from 1.54.0 to 1.55.0
(#813)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.0 to
1.15.1 (#810)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/prometheus/client_model from 0.3.0 to
0.4.0 (#812)**
- **build(deps): Bump github.com/prometheus/common from 0.42.0 to 0.43.0
(#811)**
- **ADR-103: Protobuf definition versioning (#772)**
- **spec/p2p: Specify the operation of a Reactor (#714)**
- **build(deps): Bump github.com/docker/distribution (#827)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.1 to 1.3.3
(#828)**
- **ADR-103: Protobuf definition versioning (#772) (#817)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.9 to 1.4.10
(#830)**
- **build(deps): Bump golang.org/x/net from 0.9.0 to 0.10.0 (#831)**
- **build(deps): Bump golang.org/x/crypto from 0.8.0 to 0.9.0 (#832)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.26.1 to 2.27.1
(#833)**
- **rpc: Remove response data from response failure logs (#829)**
- **pubsub/kvindexer:support for big numbers - v2 (#797)**
- **Extend the infrastructure provider with `StartNodes` and
`StopTestnet` (#796)**
- **grpc: Add base gRPC server with version service (#818)**
- **Digital Ocean implementation of `StartNodes` and `StopTestnet`
(#846)**
- **RFC 102: Improve forward compatibility of proto-generated Rust
(#724)**
- **mempool: Add metric to measure how many times a tx was received
(#637)**
- **`e2e` provider is extended with `Disconnect`, `Reconnect` and
`CheckUpgraded` (#852)**
- **Sort `loadtime` tool's report (#854)**
- **feat: make handshake cancelable (#857)**
- **proto: Restore snake_case JSON for `ExecTxResult` (#856)**
- **qa: 200-nodes test on v0.38 (#877)**
- **qa: rotating node test on `v0.38.x` (#883)**
- **Changes to QA related files (e.g., `method.md`) (#878)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.18.0 to 1.19.0
(#868)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.2 to 1.8.3
(#873)**
- **build(deps): Bump github.com/bufbuild/buf from 1.18.0 to 1.19.0
(#872)**
- **Adds `vote_extension_size` to manifests (#858)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.27.1 to 2.28.1
(#893)**
- **build(deps): Bump github.com/prometheus/common from 0.43.0 to 0.44.0
(#892)**
- **build(deps): Bump slackapi/slack-github-action from 1.23.0 to 1.24.0
(#869)**
- **ADR 104: State sync from local application snapshot (#801)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0
(#891)**
- **mempool: slight refactor for improving readability (#894)**
- **Add Vote Extension varying size testnet (#888)**
- **fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
(#908)**
- **build(deps): Bump github.com/bufbuild/buf from 1.19.0 to 1.20.0
(#912)**
- **build(deps): Bump github.com/golangci/golangci-lint (#917)**
- **build(deps): Bump github.com/spf13/viper from 1.15.0 to 1.16.0
(#913)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.19.0 to 1.20.0
(#910)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.1 to 2.28.2
(#914)**
- **Minor fixes to `RELEASES.md` (#923)**
- **Prevent a transaction to appear twice in the mempool (#890)**
- **New metrics to track duplicate votes and block parts (#896) (#905)**
- **e2e tests are being skipped; `INFRASTRUCTURE-*` bug; portGen
inconsistency bug (#933)**
- **build(deps): Bump github.com/bufbuild/buf from 1.20.0 to 1.21.0
(#948)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.20.0 to 1.21.0
(#946)**
- **spec/p2p: document the p2p API used by Reactors (#851)**
- **build(deps): Bump docker/login-action from 2.1.0 to 2.2.0 (#944)**
- **e2e: Generate prometheus.yaml on setup (#954)**
- **Update the type annotations in the light client spec (#955)**
- **build(deps): Bump docker/build-push-action from 4.0.0 to 4.1.0
(#947)**
- **build(deps): Bump docker/setup-buildx-action from 2.5.0 to 2.7.0
(#962)**
- **Add requirement for `CheckTx` in ABCI spec (#928)**
- **fix: avoid recursive call after rename to (*PeerState).MarshalJSON
(#865)**
- **Port upstream proto changes to cometbft package**
- **changelog: Import entries for v0.34.28, v0.34.29, v0.37.1 and
v0.37.2 to `main` (#974)**
- **test/e2e: Fix Docker image build (#984)**
- **build(deps): Bump github.com/BurntSushi/toml from 1.3.0 to 1.3.2
(#952)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.2 to 2.29.0
(#953)**
- **Remove duplicate function `deterministicExecTxResult` (#986)**
- **mempool: Fix the benchmarks (#934)**
- **Add `CMT_HOME` (or remove it?) (#983)**
- **Remove buf.yaml at the root of the source tree (#979)**
- **build(deps): Bump docker/build-push-action from 4.1.0 to 4.1.1
(#989)**
- **build(deps): Bump golang.org/x/net from 0.10.0 to 0.11.0 (#994)**
- **build(deps): Bump golang.org/x/sync from 0.2.0 to 0.3.0 (#990)**
- **build(deps): Bump google.golang.org/grpc from 1.55.0 to 1.56.0
(#992)**
- **build(deps): Bump github.com/golangci/golangci-lint from 1.53.2 to
1.53.3 (#996)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.1 to
1.16.0 (#991)**
- **spec/p2p: new structure for the p2p specification (#966)**
- **consensus: optimize vote and block part gossip with
HasProposalBlockPartMessage and random sleeps (#904)**
- **Extend ABCI `max_block_size` parameter to give extended control to
the app (#1003)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.21.0 to 1.22.0
(#1026)**
- **Bump logs on non-fatal vote validation failures to Info level
(#1022)**
- **Update codeowners to include DevRel team (#1023)**
- **deps: Manually bump github.com/vektra/mockery/v2 from 2.29.0 to
2.30.1 (#1009)**
- **Update releasing.md to sign tags (#1034)**
- **build(deps): Bump github.com/bufbuild/buf from 1.21.0 to 1.22.0
(#1027)**
- **Rename ABCI enums and values to satisfy buf guidelines (#975)**
- **build(deps): Bump google.golang.org/grpc from 1.56.0 to 1.56.1
(#1028)**
- **docs: Added double quotes to /abci_query path param (#1015)**
- **Update Docs with Finalize Block (#760)**
- **Clarifies that processProposal may be called for set of transactions
different from the one returned in the preceding prepareProposal
(#1033)**
- **Update the annotation of part_set.go (#1056)**
- **build(deps): Bump docker/setup-buildx-action from 2.7.0 to 2.8.0
(#1071)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.1 to
2.30.16 (#1064)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.22.0 to 1.23.1
(#1072)**
- **build(deps): Bump github.com/bufbuild/buf from 1.22.0 to 1.23.1
(#1066)**
- **build(deps): Bump google.golang.org/protobuf from 1.30.0 to 1.31.0
(#1065)**
- **build(deps): Bump google.golang.org/grpc from 1.56.1 to 1.56.2
(#1101)**
- **build(deps): Bump golang.org/x/crypto from 0.10.0 to 0.11.0
(#1103)**
- **build(deps): Bump docker/setup-buildx-action from 2.8.0 to 2.9.0
(#1105)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.16 to
2.31.1 (#1100)**
- **build(deps): Bump golang.org/x/net from 0.11.0 to 0.12.0 (#1102)**
- **ci: Trigger workflows on merge group (#1118)**
- **Revert \"config: add bootstrap peers (#9680)\" (#1109)**
- **node: Revert removal of public reactor accessors (#1120)**
- **ci: Disable CodeQL check in merge queues (#1123)**
- **p2p: Remove UPnP functionality (#1114)**
- **ADR 107: Rename proto versions to pre-v1 betas (#1110)**
- **RFC 104: Internal messaging using the actor model (#1092)**
- **build(deps): Bump github.com/bufbuild/buf from 1.23.1 to 1.24.0
(#1131)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.31.1 to 2.32.0
(#1132)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.0 to 2.9.1
(#1133)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.23.1 to 1.24.0
(#1134)**
- **spec: Add mempool specification in English and Quint (#997)**
- **mempool: ADR for refactoring list of senders  (#1032)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.24.0 to 1.25.0
(#1157)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.7.0 to 5.8.0
(#1159)**
- **build(deps): Bump github.com/bufbuild/buf from 1.24.0 to 1.25.0
(#1160)**
- **proxy: Rename \"unsynchronized\" to \"connection-synchronized\" local
client creator (#1145)**
- **mempool: Keep track of senders in reactor instead of implementation
(#1010)**
- **cmd: Remove `replay` and `replay-console` subcommands (#1170)**
- **build(deps): Bump google.golang.org/grpc from 1.56.2 to 1.57.0
(#1181)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.0 to 5.8.1
(#1180)**
- **ci: Remove Mergify automerge (#1182)**
- **Add gRPC block service (#1142)**
- **blocksync: export errors (#1186)**
- **Porting changes related to creating a lean docker image from
`pierre/fast-prototyping-1059` branch. (#1192)**
- **chore: Format repo (#1193)**
- **Add BlockResults gRPC service (#1168)**
- **consensus: remove logic to unlock block on +2/3 prevote for nil
(#1175)**
- **ADR 101: Add GetLatest method to block service (#1209)**
- **ADR 101: Implement pruning mechanism (#1150)**
- **config: export errors (#1190)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.0 to 2.32.3
(#1218)**
- **Add check for non-`nil` in `enterCommit` (#1208)**
- **Log proposer's address when correctly accepting a proposal (#1079)**
- **Close evidence.db OnStop (#1210)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.0 to 1.25.1
(#1213)**
- **build(deps): Bump golang.org/x/crypto from 0.11.0 to 0.12.0
(#1215)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.0 to 1.25.1
(#1216)**
- **build(deps): Bump golang.org/x/net from 0.12.0 to 0.14.0 (#1217)**
- **Forward-port: update state to prevote `nil` when proposal block does
not match locked block (#1203)**
- **mempool: Store peer ids as p2p.ID instead of uint16 (remove
mempoolIDs) (#1191)**
- **ADR-101: implement gRPC `PruningService` (#1154)**
- **consensus: Avoid process proposal when we know correct nodes
validated it (#1231)**
- **ADR-101: Metrics to monitor the pruning  (#1234)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.1 to 1.26.0
(#1241)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.1 to 1.26.1
(#1239)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1240)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.3 to 2.32.4
(#1242)**
- **abci: export errors  (#1185)**
- **consensus: export errors (#1211)**
- **ADR-101: Pruning mechanism minor fixes (#1246)**
- **chore: Bump minimum Go version on `main` to v1.21 (#1244)**
- **ADR 101: Add `Close` method to gRPC client (#1251)**
- **ADR 108: ADR for extending E2E infrastructure so that we can check
CometBFT's behaviour with respect to ABCI++ grammar. (#902)**
- **docs: Add logging guide to contributing guidelines (#1250)**
- **chore: log `app_hash` as hex (#1264)**
- **update language (#1263)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.0 to 1.26.1
(#1272)**
- **build(deps): Bump gonum.org/v1/gonum from 0.13.0 to 0.14.0 (#1275)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.10 to 1.4.11
(#1276)**
- **ADR 101: Refactor height check-related logic and tests (#1271)**
- **Fixed linter**
- **Revert \"Fixed linter\"**
- **Fixed mem aliasing in for loop (#1280)**
- **Remove genesis persistence in state db (#1017)**
- **Revert \"Remove genesis persistence in state db (#1017)\" (#1294)**
- **evidence: export errors (#1284)**
- **Re-implement removal of genesis persistence in state db (#1295)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.1 to 2.10.0
(#1298)**
- **node: verify genesis doc hash against the file contents rather than
remarshalled JSON (#1293)**
- **indexer: Implement pruning mechanism (#1176)**
- **Provide relevant block data in `ExtendVote` (#1270)**
- **node/state:bootstrap state api (#1057)**
- **build(deps): Bump actions/checkout from 3 to 4 (#1319)**
- **build(deps): Bump docker/build-push-action from 4.1.1 to 4.2.1
(#1318)**
- **Fix (#1323)**
- **state: remove genesis file from database  (#1297)**
- **Added changelog for pruning metrics (#1335)**
- **Removed begin_block_events and end_block_events from rpc doc
(#1338)**
- **consensus: test for precommit/locking corner case (#1257)**
- **TxIndexer and BlockIndexer pruning metrics (#1334)**
- **Forward port changes to changelog and `UPGRADING.md` for release
`v0.38.0` (#1341)**
- **Update Go version specified in root README on main for v0.34.x
(#1352)**
- **Add test/e2e/data to gitignore (#1349)**
- **docs: gRPC services and data companion pruning services (#1307)**
- **Add genesis_hash flag check on node startup (#1324)**
- **gRPC for Tx and Block indexer pruning (#1327)**
- **build(deps): Bump docker/build-push-action from 4.2.1 to 5.0.0
(#1371)**
- **build(deps): Bump docker/setup-buildx-action from 2.10.0 to 3.0.0
(#1370)**
- **build(deps): Bump docker/login-action from 2.2.0 to 3.0.0 (#1368)**
- **build(deps): Bump goreleaser/goreleaser-action from 4 to 5 (#1369)**
- **ADR101: Moved changelog entries (#1377)**
- **Max byte check (#1384)**
- **Update to string (#1385)**
- **mempool: Remove unused peerID constants (#1379)**
- **build(deps): Bump github.com/google/uuid from 1.3.0 to 1.3.1
(#1392)**
- **build(deps): Bump github.com/rs/cors from 1.9.0 to 1.10.0 (#1393)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.1 to 5.9.0
(#1396)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.4 to 2.34.0
(#1400)**
- **build(deps): Bump github.com/go-kit/kit from 0.12.0 to 0.13.0
(#1397)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1398)**
- **build(deps): Bump google.golang.org/grpc from 1.57.0 to 1.58.2
(#1399)**
- **doc: improve documentation of BlockParams.MaxBytes (#1405)**
- **rpc: Improve abci_query parameter documentation (#1184)**
- **Bump p2p version following introduction of
`HasProposalBlockPartMessage` (#1411)**
- **RFC: Allowing Non-Determinism in `ProcessProposal` (#1391)**
- **ADR-101: Data Companion Pull API (#82)**
- **build(deps): Bump github.com/rs/cors from 1.10.0 to 1.10.1 (#1418)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.0 to 2.34.2
(#1416)**
- **build(deps): Bump github.com/prometheus/client_golang (#1417)**
- **fix typos (#1413)**
- **Renames Tendermint to CometBFT in the RPC related test code
(#1428)**
- **Renames Tendermint to CometBFT in the RPC related test code. This
file was missing and it was not caught in the branch testing. (#1433)**
- **Reject incoming txs while node is catching up (#1119)**
- **build(deps): Bump golang.org/x/crypto from 0.13.0 to 0.14.0
(#1458)**
- **build(deps): Bump golang.org/x/sync from 0.3.0 to 0.4.0 (#1454)**
- **build(deps): Bump golang.org/x/net from 0.15.0 to 0.16.0 (#1453)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.1 to 1.27.0
(#1449)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.11.0 to
0.12.0 (#1450)**
- **build(deps): Bump github.com/prometheus/client_model (#1455)**
- **build(deps): Bump github.com/bufbuild/buf from 1.26.1 to 1.27.0
(#1459)**
- **build(deps): Bump github.com/spf13/viper from 1.16.0 to 1.17.0
(#1456)**
- **test: respect P2PConfig fuzzing configuration in MultiplexTransport
(#1414)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.2 to 2.35.3
(#1462)**
- **crypto: export errors (#1463)**
- **Do not race with pruning to validate headers and validators
(#1467)**
- **fix typos (#1487)**
- **Call observer only when retain height changes (#1490)**
- **build(deps): Bump pillow from 9.3.0 to 10.0.1 in
/scripts/qa/reporting (#1493)**
- **abci: Add relaxed local client synchronization models (#1141)**
- **docs: fix typos (#1500)**
- **Post-merge fixes for feature/proto-upgrade**
- **Make BuildLastCommitInfo and BuildExtendedCommitInfo public
(#1502)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.3 to 2.35.4
(#1497)**
- **build(deps): Bump google.golang.org/grpc from 1.58.2 to 1.58.3
(#1498)**
- **build(deps): Bump golang.org/x/net from 0.16.0 to 0.17.0 (#1499)**
- **tiny change: reorder expected and actual values (#1506)**
- **Fixed docker port alias (#1507)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.0 to 1.27.1
(#1527)**
- **Implement ADR-107: rename proto package version suffixes to v1beta*
pattern (#1510)**
- **e2e: Fix flakiness in grpc tests due to pruning (#1492)**
- **fix spelling of bandwidth (#1534)**
- **Fix linting on `main` (#1531)**
- **build(deps): Bump github.com/prometheus/common from 0.44.0 to 0.45.0
(#1524)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.0 to 1.27.1
(#1522)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1540)**
- **fix some typos (#1541)**
- **indexer-respect-height-params-on-query (#1529)**
- **Correct go_package paths in service proto files (#1538)**
- **build(deps): Bump google.golang.org/grpc from 1.58.3 to 1.59.0
(#1521)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.4 to 2.36.0
(#1523)**
- **feat(mempool): export error (#1427)**
- **Rename proto messages and services to satisfy default buf lints
(#1533)**
- **RFC 106: non-idempotent methods in data companion (#1545)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.0
(#1550)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.1 to 1.27.2
(#1551)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1552)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.1 to 1.27.2
(#1553)**
- **use assert.Greater instead of Equal for better error reporting
(#1547)**
- **rpc: Version the RPC APIs (#1412)**
- **mempool: Add metric size of pool in bytes (#1512)**
- **build(deps): Bump github.com/docker/docker (#1570)**
- **build(deps): Bump github.com/spf13/cobra from 1.7.0 to 1.8.0
(#1572)**
- **build(deps): Bump golang.org/x/sync from 0.4.0 to 0.5.0 (#1574)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.0 to 2.36.1
(#1576)**
- **build(deps): Bump github.com/gorilla/websocket from 1.5.0 to 1.5.1
(#1575)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1573)**
- **chore: consolidate changelog improvements section (#1578)**
- **Implementation of ADR-108 (#930)**
- **Reduce the default MaxBytes to 4mb and increase MaxGas to 10 million
(#1518)**
- **e2e: Allow disabling the PEX reactor on all nodes in the testnet
(#1580)**
- **Experimental - Reduce # of connections effectively used to gossip
transactions out (#1558)**
- **Update proto file references to follow renaming/versioning (#1555)**
- **Make `LoadBlock` also return block metadata (#1557)**
- **mempool: Limit gossip connections to persistent and non-persistent
peers (experimental) (#1584)**
- **fix: docs: default db provider moved from node to config (#1588)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.2 to 1.28.0
(#1598)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.2 to 1.28.0
(#1602)**
- **build(deps): Bump golang.org/x/crypto from 0.14.0 to 0.15.0
(#1599)**
- **build(deps): Bump golang.org/x/net from 0.17.0 to 0.18.0 (#1597)**
- **RFC 107: Internal signalling using event observers (#1164)**
- **ADR 110: Remote mempool (#1565)**
- **chore: aligns function descriptions with godoc standards in the
types package (#1593)**
- **docs: various improvements (#1603)**
- **chore: Merge branch main into feature/proto-upgrade (#1612)**
- **Removes wrong assertion and decreases likelyhood of block from the
future has actually been already created (#1619)**
- **Split /api off to separate go.mod (#1608)**
- **feature: Reduce Go API surface area (ADR 109) (#1605)**
- **refactor: Export func MakeHTTPDialer (#1594)**
- **First draft (#1483)**
- **pruning:do not attempt to prune state if no blocks are pruned
(#1616)**
- **Update SECURITY.md (#1626)**
- **Update changelog on `main` with new releases (#1644)**
- **proto: Update README (#1648)**
- **ADR 111: `nop` Mempool (#1585)**
- **ADR-111: Addressed Ethan's comment (#1667)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.1 to 2.37.1
(#1662)**
- **build(deps): Bump docker/build-push-action from 5.0.0 to 5.1.0
(#1664)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.0 to 1.28.1
(#1665)**
- **ci: Fix v0.34 nightly build (#1655)**
- **build(deps): Bump github.com/bufbuild/buf from 1.28.0 to 1.28.1
(#1663)**
- **feature/proto-upgrade: Fix generated mock code (#1673)**
- **Update link in README.md (#1674)**
- **Renames the semantic versioning variable to CMT (#1621)**
- **mempool: add `nop` mempool (#1643)**
- **e2e:fix-digital-ocean-ports (#1678)**
- **Revert modularization of the test infra (#1488) (#1676)**
- **docs: various small improvements (part 2) (#1683)**
- **Do not block indefinitely on the semaphore (#1654)**
- **Adds tests that check for FIFO ordering being broken by gossip
(#1628)**
- **loadtime: Add parameter for displaying results in one line (#1511)**
- **Promote latest versions of Protobuf definitions to v1 packages
(#1677)**
- **chore: Update CHANGELOG.md (#1701)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1696)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.37.1 to 2.38.0
(#1697)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.1
(#1702)**
- **proto: document the `cometbft.*` versioned protos (#1694)**
- **Clean up changelog entries and README files for versioned proto
changes (#1707)**
- **chore(proto): add missing docs (#1703)**
- **feature/proto-upgrade: Last-minute fixes (#1709)**
- **e2e: Support emulated latencies between docker images (#1560)**
- **build(deps): Bump golang.org/x/net from 0.14.0 to 0.17.0 in /api
(#1713)**
- **Prepare `main` for `v1.x` backport branch (#1714)**
- **build(deps): Bump golang.org/x/crypto from 0.15.0 to 0.16.0
(#1720)**
- **build(deps): Bump golang.org/x/net from 0.18.0 to 0.19.0 (#1719)**
- **types: validate Validator#Address field (#1715)**
- **Enable Mergify backports for `v1.x` branch (#1724)**
- **deps: Bump cometbft-db to v0.9.0 (#1725)**
- **buf improvements prior to publishing on BSR (#1726)**
- **proto: give our buf module a name (#1734)**
- **deps: Bump cometbft-db to v0.9.1 (#1737)**
- **chore: Update root docs (#1740)**
- **fix: increase abci socket message size limit to 2GB (#1730)**
- **proto: make comment in README more Markdowny (#1743)**
- **fix: Txs Validate (#1687)**
- **Add test missing in #1687 (#1712)**
- **perf(state): batch save `State` (#1735)**
- **Update CODE_OF_CONDUCT.md (#1708)**
- **[e2e] Fixes prepareProposal not to return oversized set of
transactions (#1756)**
- **perf(store): Batch save `Block` (#1755)**
- **Fix: Fix minor typos (#1780)**
- **`VerifyCommitLight` and `VerifyCommitLightTrusting` _never_ check
all signatures (#1750)**
- **Fix typo in encoding.md (#1801)**
- **chore(docs): small improvements (#1781)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.10.1 to 5.11.0
(#1797)**
- **build(deps): Bump actions/setup-go from 4 to 5 (#1794)**
- **build(deps): Bump actions/stale from 8 to 9 (#1795)**
- **build(deps): Bump github.com/spf13/viper from 1.17.0 to 1.18.1
(#1796)**
- **Chore/fix other typos (#1809)**
- **chore(spec): specify which fields must be deterministic (#1804)**
- **Small improvements in #1806 not present in #1750 (#1808)**
- **Add changelog for #1749 (#1807)**
- **e2e: Implement latency emulation for DigitalOcean (#1587)**
- **add GH workflow for linting code using codespell (#1824)**
- **chore(docs): explain the effect of `timeout_propose` (#1798)**
- **build(deps): Bump actions/upload-artifact from 3 to 4 (#1845)**
- **build(deps): Bump actions/setup-python from 2 to 5 (#1843)**
- **build(deps): Bump github/codeql-action from 2 to 3 (#1847)**
- **build(deps): Bump actions/checkout from 2 to 4 (#1846)**
- **build(deps): Bump github.com/google/uuid from 1.4.0 to 1.5.0
(#1850)**
- **build(deps): Bump google.golang.org/grpc from 1.59.0 to 1.60.0
(#1851)**
- **golangci-lint: enable all the linters by default (#1838)**
- **Updates go crypto package to v0.17.0 (#1859)**
- **Adds checks for nil keys and signatures (#1855)**
- **The store DB and the companion `BlockStore` struct are sometimes out
of sync (#1856)**
- **Allow blocksync to not verify all signatures (#1858)**
- **Fixing the ABCI grammar and updating the code for e2e tests to
account for the new grammar. (#1829)**
- **docs: Fix Discord links in README (#1874)**
- **build(deps): Bump github.com/prometheus/client_golang (#1909)**
- **build(deps): Bump github.com/btcsuite/btcd/btcutil from 1.1.3 to
1.1.5 (#1908)**
- **build(deps): Bump google.golang.org/protobuf (#1885)**
- **build(deps): Bump github.com/spf13/viper from 1.18.1 to 1.18.2
(#1884)**
- **build(deps): Bump google.golang.org/grpc from 1.60.0 to 1.60.1
(#1883)**
- **remove unused linters that produced a warning and ensure that
unparam is enabled (#1905)**
- **Fix HTTP response body not being closed after reading (#1945)**
- **Disable undesired linting code (#1959)**
- **Extend kvstore example add with with key types (#1876)**
- **Extra check in `VerifyExtension` (#1877)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.38.0 to 2.39.1
(#1882)**
- **perf(crypto/merkle, crypto/tmhash): simplify+optimize SHA256 hashing
of multiple byteslices (#1921)**
- **Update localnet-start Makefile (#1975)**
- **blocksync: wait for poolRoutine to stop in (*Reactor).OnStop
(#1879)**
- **fix TestListenerTimeoutReadWrite (#1947)**
- **docs: fix typos (#1988)**
- **this is the kindest commit I can think of. Take it that way and read
the code. (#1987)**
- **there's really no need for this anymore (#1986)**
- **feat: DefaultHttpClient support setting proxy from env (#1900)**
- **feat: lint tests (#1906)**
- **chore: fix typos (#1991)**
- **build(deps): Bump golang.org/x/sync from 0.5.0 to 0.6.0 (#1992)**
- **feat(proxy): export errors (#1899)**
- **doc:fix broken link in DOCKER/README.md (#1996)**
- **feat: custom dependencies order (#1994)**
- **PBTS: migrating to `main` the new version of the specification
(#1973)**
- **Fix paths to scripts/metricsgen in go:generate commands (#1998)**
- **chore: fix some typos (#2002)**
- **docs(light): fix broken link to spec (#2007)**
- **chore(test/loadtime): replace tm-load-test w/ cometbft-load-test
(#2009)**
- **ci: Remove unused `tests` target when compiling e2e (#2022)**
- **spec: fix typo in `encoding.md` (#2024)**
- **mempool: Fix data races in CListMempool's height and
notifiedTxsAvailable (#2021)**
- **chore(test/loadtime): cleanup go.sum and golangci.yml (#2025)**
- **build(deps): Bump github.com/prometheus/common from 0.45.0 to 0.46.0
(#2040)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.39.1 to 2.40.1
(#2038)**
- **feat(rpc): Use default port for HTTP(S) URLs when there is no
explicit port (#1903)**
- **misc(go.mod): remove unused peg dependency (#2044)**
- **config: Remove unused `max_batch_bytes` (#2050)**
- **Merge pull request from GHSA-qr8r-m495-7hc4**
- **misc(tools)!: remove `tools` package (#2046)**
- **docs(guides): add missing import (#2070)**
- **deps(localnode): bump alpine version (#2077)**
- **misc(Makefile): add `help` target to display the help msg (#2074)**
- **`e2e`: test vote extension activation via `InitChain` and
`FinalizeBlock` (#2066)**
- **scripts: metricsgen parses '// metrics:' pattern (#2090)**
- **e2e: Add `load_max_txs` option to manifest (#2094)**
- **consensus: Add `chain_size_bytes` metric (#2093)**
- **feat: conventional commits (#1995)**
- **Forward port of tendermint/tendermint#7605, tendermint/spec#393, and
tendermint/tendermint#8142 (#2018)**
- **ci: fix permissions for \"Conventional PR Title\" (#2099)**
- **PBTS: additions and fixes on migrated spec (#2013)**
- **PBTS: forward port of tendermint/tendermint#7709 (#2089)**
- **feat: use go workspace (#1924)**
- **fix: `ValidateUpdate`: allow no-change updates regardless of current
height (#2112)**
- **test(localnet): Add monitoring tools for localnet (#2108)**
- **feat: add gofumpt (#2049)**
- **feat(consensus): increase log level for corner case when prevoting a
proposal (#2042)**
- **docs: v1 - diataxis framework (#2105)**
- **feat(consensus): additional sanity checks for the size of proposed
blocks (#1408)**
- **perf(internal/blocksync): avoid double-calling
`types.BlockFromProto` (#2016)**
- **build(deps): Bump google.golang.org/grpc from 1.60.1 to 1.61.0
(#2178)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.1 to 1.29.0
(#2161)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.12.0 to
0.12.1 (#2160)**
- **build(deps): Bump slackapi/slack-github-action from 1.24.0 to 1.25.0
(#2162)**
- **build(deps): Bump github.com/google/uuid from 1.5.0 to 1.6.0
(#2176)**
- **refactor(privval): reverse conditional + more idiomatic Go code with
early returns (#2156)**
- **fix(e2e): path to latency script files in DO (#2148)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.9.1 to
0.10.0 (#2175)**
- **chore(Makefile): add `setup-pre-commit` target to init git hook
(#2123)**
- **feat: add pebbledb (https://github.com/cockroachdb/pebble) (#2132)**
- **perf(internal/blocksync): do not `ValidateBlock` twice (#2026)**
- **feat(e2e): Add new targets `fast` and `clean` to Makefile (#2192)**
- **ci: add `spec` type in conventional-pr-title (#2191)**
- **fix(privval): retry accepting a connection on errors (#2047)**
- **fix(.github/workflows): correct parameters to lint_pr_title
(#2199)**
- **docs: update QA method steps for qa-infra changes (#2198)**
- **feat!(pbts): forward port of tendermint/tendermint#7711 (#2149)**
- **docs(pbts): forward port of PBTS documentation and fixes (#2124)**
- **fix: if-return and early-return (#2215)**
- **chore: remove amazon linux Dockerfile and update
test/docker/Dockerfile (#2135)**
- **feat(ci): pre-commit framework (#2214)**
- **ci: add `merge` type for conventional-pr-title (#2219)**
- **spec(consensus/pbts): update description for introduced parameters.
(#2206)**
- **perf: optimize psql indexer (#2142)**
- **fix(go.mod): do not use `replace` for api (#2236)**
- **fix(Makefile): gofumpt no longer needed (#2235)**
- **fix(p2p/pex): gracefully shutdown `Reactor` (#2010)**
- **test(mempool): fix
TestMempoolUpdateDoesNotPanicWhenApplicationMissedTx (#2242)**
- **fix(flowrate): fix non-determinism in flowrate tests (#2147)**
- **refactor!: Implement RFC 106: remove `GetLatestBlock*` methods from
data companion API (#2240)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.3 to 1.3.7
(#2253)**
- **chore(config): update DB section in toml.go (#2249)**
- **fix(consensus): do not precommit nil if proposal block is received
(#2221)**
- **build(deps): Bump github.com/opencontainers/runc from 1.1.5 to
1.1.12 (#2261)**
- **fix(mempool/tests): Reduce tests duration (#2263)**
- **ci: run golangci-lint linters for all files (not only ones which
were modified) (#2250)**
- **refactor(examples): small changes to kvstore app (#2267)**
- **refactor(mempool): simplify parameters of resCbFirstTime and
resCbRecheck (#2272)**
- **perf(mempool/cache): clear map in Reset (#2259)**
- **test(abci): update e2e tests to check against ABCI 2.0 grammar
(#2201)**
- **docs: symbolic references to steps in the qa-infra README (#2280)**
- **chore: updated doc link (#2296)**
- **fix(consensus): prevote nil upon timeout when Proposal is missing
(#2218)**
- **build(deps): Bump pre-commit/action from 3.0.0 to 3.0.1 (#2307)**
- **build(deps): Bump golang.org/x/net from 0.20.0 to 0.21.0 (#2300)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.10.0 to
0.11.0 (#2299)**
- **docs: ADR-112 Proposer-Based Timestamps (#2223)**
- **refactor(internal/statesync): replace ticker with `time.After(X)`
(#2294)**
- **fix: simultaneous rpc test failures (#2150)**
- **chore(docs): alter the section about the effects of `timeout_commit`
(#1892)**
- **refactor(p2p)!: Refactor PeerSet to eliminate data races & improve
performance (#2246)**
- **feat(pbts): Update consensus params to include pbts enabled
(#2231)**
- **feat(storage/metrics): Metrics to measure storage (#1974)**
- **feat(e2e): Log number of sent txs (success and failed) (#2328)**
- **chore: enable gomoddirectives, unparam (#2290)**
- **docs: images not rendering properly in docs (#2331)**
- **docs: Fix references about DeliverTx (#2330)**
- **docs(qa): Add table of contents to existing QA reports (#2343)**
- **chore: enable perfsprint linter (#2291)**
- **feat(pruning): trigger explicitly compaction upon pruning (#1972)**
- **docs: explain how to skip pre-commit hook (#2358)**
- **build(deps): Bump github.com/prometheus/common from 0.46.0 to 0.47.0
(#2373)**
- **build(deps): Bump google.golang.org/grpc from 1.61.0 to 1.61.1
(#2372)**
- **feat(e2e): Option to set max block size in bytes at genesis
(#2362)**
- **build(deps): Bump github.com/prometheus/client_model from 0.5.0 to
0.6.0 (#2371)**
- **revert(pbts): revert removal of BFT Time related functions (#2205)**
- **fix(e2e): Reduce flakiness of TestGRPC_GetBlockResults (#2367)**
- **spec(consensus): update Block Time documentation in spec (#2316)**
- **spec: adaptive MSGDELAY parameter included in PBTS spec (#2318)**
- **feat(pbts): Moving VoteExtensionsEnableHeight from ABCIParams to
FeatureParams. (#2335)**
- **fix: remove TestMempoolFIFOWithParallelCheckTx (#2364)**
- **fix(docker-compose): fix subnet (#2383)**
- **feat(pbts): enable `e2e` manifest config to set `PbtsEnableHeight`
(#2284)**
- **perf(internal/state): avoid double-saving FinalizeBlockResponse
(#2017)**
- **build(deps): Bump fonttools from 4.37.4 to 4.43.0 in
/scripts/qa/reporting (#2407)**
- **build(deps): Bump pillow from 10.0.1 to 10.2.0 in
/scripts/qa/reporting (#2408)**
- **fix(node): Forward compaction config params to blockstore
constructor (#2418)**
- **refactor!: moved `MedianTime` out of `internal` folder (#2397)**
- **chore: typo fixes (#2403)**
- **chore(pbts): Removes useless code (#2420)**
- **build(deps): Bump github.com/prometheus/common from 0.47.0 to 0.48.0
(#2430)**
- **build(deps): Bump google.golang.org/grpc from 1.61.1 to 1.62.0
(#2429)**
- **test(consensus): PBTS should be enabled by default in test units
(#2329)**
- **test(consensus): test enabling PBTS at a given height (#2404)**
- **refactor(protobuf): switch from gogofaster to gocosmos generator
(#2425)**
- **docs(tutorials/install): add `From Go package` (#2414)**
- **docs(pbts): documentation for PBTS-related consensus parameters
(#2376)**
- **refactor(consensus): print err from SignAndCheckVote (#2346)**
- **feat(e2e): add parameter to set a custom output directory for
testnet files (#2433)**
- **spec(consensus): update description of consensus parameters for PBTS
(#2415)**
- **fix(localnet): Grafana dashboards for storage tests - removed
experimental metrics (#2448)**
- **fix(jsonrpc): enable HTTP basic auth in WS client (#2434)**
- **feat(pbts): Adds timestamp to the `msgInfo` written into the WAL
(#2388)**
- **fix: `Rollback`: wrong modification of
`state.LastHeightValidatorsChanged` while rollback at a special height
(#2136)**
- **docs(changelog): add missing entry for #2136 (#2459)**
- **fix(pbts): legacy `ABCIParams` values are properly translated to
`FeatureParams` values (#2462)**
- **fix(e2e): Fixing the bug in ABCI e2e tests (#2468)**
- **feat(localnet): Grafana PNG rendering for easier graph exports
(#2472)**
- **docs(README): remove Terra (#2469)**
- **docs: document PBTS adaptive delays mechanism (#2452)**
- **fix(config): Moved compact variables to the right section (#2477)**
- **feat(metrics): more buckets for ProposalTimestampDifference
(#2479)**
- **fix(metrics): more buckets for ProposalTimestampDifference (#2481)**
- **feat(pbts): Make synchrony params adaptive (#2431)**
- **ci: check metrics generation in CI checks (#2483)**
- **feat(consensus): improve logging for timely and untimely messages
(#2321)**
- **feat(types): improve Proposal and SynchronyParams validation tests
(#2489)**
- **test(consensus): refactor TestStateLock_POLSafety tests (#2492)**
- **feat(types): refactor types.AdaptiveSynchronyParams method (#2490)**
- **fix: lint errors introduced with the latest merge (#2495)**
- **build(deps): Bump docker/setup-buildx-action from 3.0.0 to 3.1.0
(#2500)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.18.0 to
1.19.0 (#2508)**
- **build(deps): Bump golang.org/x/crypto from 0.19.0 to 0.20.0
(#2507)**
- **build(deps): Bump github.com/prometheus/common from 0.48.0 to 0.49.0
(#2506)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.4 to 1.9.0
(#2505)**
- **fix(docs): include `timesync` daemon instructions (#2491)**
- **feat(privval)!: DO NOT require extension signature (#2496)**
- **refactor(privval): rename sign_extension to skip_sign_extension
(#2519)**
- **spec(abci): fixes the spec to inform about the presence of invalid
extensions in `last_commit` (#2423)**
- **fix(pbts): block Time must be Canonical (#2493)**
- **feat(e2e): Add manifest option `clock_skew` and corresponding
backend functionality (#2454)**
- **fix(mempool): converting to uint64 before additions to avoid
overflows (#2498)**
- **refactor!: Rename `skip_sign_extension` to `skip_extension_signing`
(#2522)**
- **docs(ADR): ADR-108 updated to account for the new changes in the
grammar and code. (#2528)**
- **feat(e2e): add generator support for clock skew + env variable
rename (#2488)**
- **spec(proto): add `cometbft.privval.v1beta2` proto package (#2529)**
- **chore: improving error handling in the PendingEvidence (#2550)**
- **feat(blocksync)!: set the max number of (concurrently) downloaded
blocks to {peersCount * 20} (#2467)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.29.0 to 1.30.0
(#2557)**
- **build(deps): Bump google.golang.org/protobuf from 1.32.0 to 1.33.0
(#2560)**
- **build(deps): Bump golang.org/x/net from 0.21.0 to 0.22.0 (#2562)**
- **fix(cmd/cometbft/commands/version): update the output for v1
(#2546)**
- **build(deps): Bump docker/build-push-action from 5.1.0 to 5.2.0
(#2558)**
- **build(deps): Bump github.com/prometheus/common from 0.49.0 to 0.50.0
(#2559)**
- **build(deps): Bump google.golang.org/grpc from 1.62.0 to 1.62.1
(#2563)**
- **build(deps): Bump golang.org/x/crypto from 0.20.0 to 0.21.0
(#2561)**
- **feat(blocksync): sort peers by download rate & multiple requests for
closer blocks (#2475)**
- **feat(pbts): Adjusts PBTS metrics buckets (#2578)**
- **fix(blocksync): use timer instead of time.After (#2584)**
- **fix: temporary fix for `api` dependency (#2589)**

---------

Signed-off-by: Thane Thomson <connect@thanethomson.com>
Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Thane Thomson <connect@thanethomson.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Anton Kaliaev <anton.kalyaev@gmail.com>
Co-authored-by: Mikhail Zabaluev <mikhail@informal.systems>
Co-authored-by: Troy Kessler <43882936+troykessler@users.noreply.github.com>
Co-authored-by: leven <112051166+lx-xiang@users.noreply.github.com>
Co-authored-by: werty144 <anton-paramonov2000@yandex.ru>
Co-authored-by: Adi Seredinschi <adizere@gmail.com>
Co-authored-by: Sukey <35202440+sukey2008@users.noreply.github.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
Co-authored-by: Jasmina Malicevic <jasmina.dustinac@gmail.com>
Co-authored-by: moriluka <85185077+moriluka@users.noreply.github.com>
Co-authored-by: ƒê·ªó Vi·ªát Ho√†ng <hoangdv2429@gmail.com>
Co-authored-by: alex <152680487+azukiboy@users.noreply.github.com>
Co-authored-by: Hern√°n Vanzetto <15466498+hvanz@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@informal.systems>
Co-authored-by: Andy Nogueira <me@andynogueira.dev>
Co-authored-by: nenadmilosevic95 <50905385+nenadmilosevic95@users.noreply.github.com>
Co-authored-by: nenadmilosevic95 <nenad@informal.systems>
Co-authored-by: Jacob Gadikian <jacobgadikian@gmail.com>
Co-authored-by: Greg Szabo <16846635+greg-szabo@users.noreply.github.com>
Co-authored-by: Emmanuel T Odeke <emm.odeke@gmail.com>
Co-authored-by: jchappelow <140431406+jchappelow@users.noreply.github.com>
Co-authored-by: shuoer86 <129674997+shuoer86@users.noreply.github.com>
Co-authored-by: levisyin <150114626+levisyin@users.noreply.github.com>
Co-authored-by: vuittont60 <81072379+vuittont60@users.noreply.github.com>
Co-authored-by: Halimao <1065621723@qq.com>
Co-authored-by: alex <152680487+bodhi-crypo@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@usi.ch>
Co-authored-by: Josef Widder <44643235+josef-widder@users.noreply.github.com>
Co-authored-by: William Banfield <4561443+williambanfield@users.noreply.github.com>
Co-authored-by: Kukovec <jure.kukovec@gmail.com>
Co-authored-by: Daniel Cason <cason@gandria>
Co-authored-by: M. J. Fromberger <fromberger@interchain.io>
Co-authored-by: hattizai <150505746+hattizai@users.noreply.github.com>
Co-authored-by: Huulu <35667132+IssouChancla@users.noreply.github.com>
Co-authored-by: katelyn martin <me+cratelyn@katelyn.world>
Co-authored-by: Richard Gibson <richard.gibson@gmail.com>
Co-authored-by: Jean Deruelle <jean.deruelle@gmail.com>
Co-authored-by: glnro <8335464+glnro@users.noreply.github.com>
Co-authored-by: Greg Szabo <greg@philosobear.com>
Co-authored-by: Emmanuel T Odeke <emmanuel@orijtech.com>
Co-authored-by: levisyin <lilassherl@gmail.com>
Co-authored-by: k0marov <95040709+k0marov@users.noreply.github.com>
Co-authored-by: Adi Seredinschi <a@seredinschi.net>
Co-authored-by: Pan chao <152830401+Pan-chao@users.noreply.github.com>
Co-authored-by: Khanh Hoa <49144992+hoanguyenkh@users.noreply.github.com>
Co-authored-by: glnro <lauren@informal.systems>
Co-authored-by: toni <143221387+xyztoni@users.noreply.github.com>
Co-authored-by: DragonKid <idragonkid@gmail.com>
Co-authored-by: Matt Ketmo <matthieu@moquet.net>
Co-authored-by: Ethan <cosinlinker@gmail.com>
Co-authored-by: Evgeny Danilenko <6655321@bk.ru>
Co-authored-by: Duong Minh Ngoc <153509244+minhngoc274@users.noreply.github.com>
Co-authored-by: Kero <keroroxx520@gmail.com>") [(](/cometbft/cometbft/commit/e7dd0ab89fc3783d3de30f2c5fb892f9ca072ba2 "chore(spec): merge main into `spec/consensus-gossip` (#2594)

- **Versioned protobuf files (#495)**
- **Restore rpc/grpc/v1/types.pb.go**
- **proto: restore deprecation notice on BroadcastAPI**
- **Struct `Client` exposes sensitive data (#784)**
- **Unsafe int cast in `kill` command (#783)**
- **ADR-100: Data Companion Push API (#73)**
- **rfc: incoming txs while catching up (#735)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.17.0 to 1.18.0
(#804)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.8 to 1.4.9
(#806)**
- **build(deps): Bump golang.org/x/sync from 0.1.0 to 0.2.0 (#807)**
- **build(deps): Bump google.golang.org/grpc from 1.54.0 to 1.55.0
(#813)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.0 to
1.15.1 (#810)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/prometheus/client_model from 0.3.0 to
0.4.0 (#812)**
- **build(deps): Bump github.com/prometheus/common from 0.42.0 to 0.43.0
(#811)**
- **ADR-103: Protobuf definition versioning (#772)**
- **spec/p2p: Specify the operation of a Reactor (#714)**
- **build(deps): Bump github.com/docker/distribution (#827)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.1 to 1.3.3
(#828)**
- **ADR-103: Protobuf definition versioning (#772) (#817)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.9 to 1.4.10
(#830)**
- **build(deps): Bump golang.org/x/net from 0.9.0 to 0.10.0 (#831)**
- **build(deps): Bump golang.org/x/crypto from 0.8.0 to 0.9.0 (#832)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.26.1 to 2.27.1
(#833)**
- **rpc: Remove response data from response failure logs (#829)**
- **pubsub/kvindexer:support for big numbers - v2 (#797)**
- **Extend the infrastructure provider with `StartNodes` and
`StopTestnet` (#796)**
- **grpc: Add base gRPC server with version service (#818)**
- **Digital Ocean implementation of `StartNodes` and `StopTestnet`
(#846)**
- **RFC 102: Improve forward compatibility of proto-generated Rust
(#724)**
- **mempool: Add metric to measure how many times a tx was received
(#637)**
- **`e2e` provider is extended with `Disconnect`, `Reconnect` and
`CheckUpgraded` (#852)**
- **Sort `loadtime` tool's report (#854)**
- **feat: make handshake cancelable (#857)**
- **proto: Restore snake_case JSON for `ExecTxResult` (#856)**
- **qa: 200-nodes test on v0.38 (#877)**
- **qa: rotating node test on `v0.38.x` (#883)**
- **Changes to QA related files (e.g., `method.md`) (#878)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.18.0 to 1.19.0
(#868)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.2 to 1.8.3
(#873)**
- **build(deps): Bump github.com/bufbuild/buf from 1.18.0 to 1.19.0
(#872)**
- **Adds `vote_extension_size` to manifests (#858)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.27.1 to 2.28.1
(#893)**
- **build(deps): Bump github.com/prometheus/common from 0.43.0 to 0.44.0
(#892)**
- **build(deps): Bump slackapi/slack-github-action from 1.23.0 to 1.24.0
(#869)**
- **ADR 104: State sync from local application snapshot (#801)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0
(#891)**
- **mempool: slight refactor for improving readability (#894)**
- **Add Vote Extension varying size testnet (#888)**
- **fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
(#908)**
- **build(deps): Bump github.com/bufbuild/buf from 1.19.0 to 1.20.0
(#912)**
- **build(deps): Bump github.com/golangci/golangci-lint (#917)**
- **build(deps): Bump github.com/spf13/viper from 1.15.0 to 1.16.0
(#913)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.19.0 to 1.20.0
(#910)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.1 to 2.28.2
(#914)**
- **Minor fixes to `RELEASES.md` (#923)**
- **Prevent a transaction to appear twice in the mempool (#890)**
- **New metrics to track duplicate votes and block parts (#896) (#905)**
- **e2e tests are being skipped; `INFRASTRUCTURE-*` bug; portGen
inconsistency bug (#933)**
- **build(deps): Bump github.com/bufbuild/buf from 1.20.0 to 1.21.0
(#948)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.20.0 to 1.21.0
(#946)**
- **spec/p2p: document the p2p API used by Reactors (#851)**
- **build(deps): Bump docker/login-action from 2.1.0 to 2.2.0 (#944)**
- **e2e: Generate prometheus.yaml on setup (#954)**
- **Update the type annotations in the light client spec (#955)**
- **build(deps): Bump docker/build-push-action from 4.0.0 to 4.1.0
(#947)**
- **build(deps): Bump docker/setup-buildx-action from 2.5.0 to 2.7.0
(#962)**
- **Add requirement for `CheckTx` in ABCI spec (#928)**
- **fix: avoid recursive call after rename to (*PeerState).MarshalJSON
(#865)**
- **Port upstream proto changes to cometbft package**
- **changelog: Import entries for v0.34.28, v0.34.29, v0.37.1 and
v0.37.2 to `main` (#974)**
- **test/e2e: Fix Docker image build (#984)**
- **build(deps): Bump github.com/BurntSushi/toml from 1.3.0 to 1.3.2
(#952)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.2 to 2.29.0
(#953)**
- **Remove duplicate function `deterministicExecTxResult` (#986)**
- **mempool: Fix the benchmarks (#934)**
- **Add `CMT_HOME` (or remove it?) (#983)**
- **Remove buf.yaml at the root of the source tree (#979)**
- **build(deps): Bump docker/build-push-action from 4.1.0 to 4.1.1
(#989)**
- **build(deps): Bump golang.org/x/net from 0.10.0 to 0.11.0 (#994)**
- **build(deps): Bump golang.org/x/sync from 0.2.0 to 0.3.0 (#990)**
- **build(deps): Bump google.golang.org/grpc from 1.55.0 to 1.56.0
(#992)**
- **build(deps): Bump github.com/golangci/golangci-lint from 1.53.2 to
1.53.3 (#996)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.1 to
1.16.0 (#991)**
- **spec/p2p: new structure for the p2p specification (#966)**
- **consensus: optimize vote and block part gossip with
HasProposalBlockPartMessage and random sleeps (#904)**
- **Extend ABCI `max_block_size` parameter to give extended control to
the app (#1003)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.21.0 to 1.22.0
(#1026)**
- **Bump logs on non-fatal vote validation failures to Info level
(#1022)**
- **Update codeowners to include DevRel team (#1023)**
- **deps: Manually bump github.com/vektra/mockery/v2 from 2.29.0 to
2.30.1 (#1009)**
- **Update releasing.md to sign tags (#1034)**
- **build(deps): Bump github.com/bufbuild/buf from 1.21.0 to 1.22.0
(#1027)**
- **Rename ABCI enums and values to satisfy buf guidelines (#975)**
- **build(deps): Bump google.golang.org/grpc from 1.56.0 to 1.56.1
(#1028)**
- **docs: Added double quotes to /abci_query path param (#1015)**
- **Update Docs with Finalize Block (#760)**
- **Clarifies that processProposal may be called for set of transactions
different from the one returned in the preceding prepareProposal
(#1033)**
- **Update the annotation of part_set.go (#1056)**
- **build(deps): Bump docker/setup-buildx-action from 2.7.0 to 2.8.0
(#1071)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.1 to
2.30.16 (#1064)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.22.0 to 1.23.1
(#1072)**
- **build(deps): Bump github.com/bufbuild/buf from 1.22.0 to 1.23.1
(#1066)**
- **build(deps): Bump google.golang.org/protobuf from 1.30.0 to 1.31.0
(#1065)**
- **build(deps): Bump google.golang.org/grpc from 1.56.1 to 1.56.2
(#1101)**
- **build(deps): Bump golang.org/x/crypto from 0.10.0 to 0.11.0
(#1103)**
- **build(deps): Bump docker/setup-buildx-action from 2.8.0 to 2.9.0
(#1105)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.16 to
2.31.1 (#1100)**
- **build(deps): Bump golang.org/x/net from 0.11.0 to 0.12.0 (#1102)**
- **ci: Trigger workflows on merge group (#1118)**
- **Revert \"config: add bootstrap peers (#9680)\" (#1109)**
- **node: Revert removal of public reactor accessors (#1120)**
- **ci: Disable CodeQL check in merge queues (#1123)**
- **p2p: Remove UPnP functionality (#1114)**
- **ADR 107: Rename proto versions to pre-v1 betas (#1110)**
- **RFC 104: Internal messaging using the actor model (#1092)**
- **build(deps): Bump github.com/bufbuild/buf from 1.23.1 to 1.24.0
(#1131)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.31.1 to 2.32.0
(#1132)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.0 to 2.9.1
(#1133)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.23.1 to 1.24.0
(#1134)**
- **spec: Add mempool specification in English and Quint (#997)**
- **mempool: ADR for refactoring list of senders  (#1032)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.24.0 to 1.25.0
(#1157)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.7.0 to 5.8.0
(#1159)**
- **build(deps): Bump github.com/bufbuild/buf from 1.24.0 to 1.25.0
(#1160)**
- **proxy: Rename \"unsynchronized\" to \"connection-synchronized\" local
client creator (#1145)**
- **mempool: Keep track of senders in reactor instead of implementation
(#1010)**
- **cmd: Remove `replay` and `replay-console` subcommands (#1170)**
- **build(deps): Bump google.golang.org/grpc from 1.56.2 to 1.57.0
(#1181)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.0 to 5.8.1
(#1180)**
- **ci: Remove Mergify automerge (#1182)**
- **Add gRPC block service (#1142)**
- **blocksync: export errors (#1186)**
- **Porting changes related to creating a lean docker image from
`pierre/fast-prototyping-1059` branch. (#1192)**
- **chore: Format repo (#1193)**
- **Add BlockResults gRPC service (#1168)**
- **consensus: remove logic to unlock block on +2/3 prevote for nil
(#1175)**
- **ADR 101: Add GetLatest method to block service (#1209)**
- **ADR 101: Implement pruning mechanism (#1150)**
- **config: export errors (#1190)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.0 to 2.32.3
(#1218)**
- **Add check for non-`nil` in `enterCommit` (#1208)**
- **Log proposer's address when correctly accepting a proposal (#1079)**
- **Close evidence.db OnStop (#1210)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.0 to 1.25.1
(#1213)**
- **build(deps): Bump golang.org/x/crypto from 0.11.0 to 0.12.0
(#1215)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.0 to 1.25.1
(#1216)**
- **build(deps): Bump golang.org/x/net from 0.12.0 to 0.14.0 (#1217)**
- **Forward-port: update state to prevote `nil` when proposal block does
not match locked block (#1203)**
- **mempool: Store peer ids as p2p.ID instead of uint16 (remove
mempoolIDs) (#1191)**
- **ADR-101: implement gRPC `PruningService` (#1154)**
- **consensus: Avoid process proposal when we know correct nodes
validated it (#1231)**
- **ADR-101: Metrics to monitor the pruning  (#1234)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.1 to 1.26.0
(#1241)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.1 to 1.26.1
(#1239)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1240)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.3 to 2.32.4
(#1242)**
- **abci: export errors  (#1185)**
- **consensus: export errors (#1211)**
- **ADR-101: Pruning mechanism minor fixes (#1246)**
- **chore: Bump minimum Go version on `main` to v1.21 (#1244)**
- **ADR 101: Add `Close` method to gRPC client (#1251)**
- **ADR 108: ADR for extending E2E infrastructure so that we can check
CometBFT's behaviour with respect to ABCI++ grammar. (#902)**
- **docs: Add logging guide to contributing guidelines (#1250)**
- **chore: log `app_hash` as hex (#1264)**
- **update language (#1263)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.0 to 1.26.1
(#1272)**
- **build(deps): Bump gonum.org/v1/gonum from 0.13.0 to 0.14.0 (#1275)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.10 to 1.4.11
(#1276)**
- **ADR 101: Refactor height check-related logic and tests (#1271)**
- **Fixed linter**
- **Revert \"Fixed linter\"**
- **Fixed mem aliasing in for loop (#1280)**
- **Remove genesis persistence in state db (#1017)**
- **Revert \"Remove genesis persistence in state db (#1017)\" (#1294)**
- **evidence: export errors (#1284)**
- **Re-implement removal of genesis persistence in state db (#1295)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.1 to 2.10.0
(#1298)**
- **node: verify genesis doc hash against the file contents rather than
remarshalled JSON (#1293)**
- **indexer: Implement pruning mechanism (#1176)**
- **Provide relevant block data in `ExtendVote` (#1270)**
- **node/state:bootstrap state api (#1057)**
- **build(deps): Bump actions/checkout from 3 to 4 (#1319)**
- **build(deps): Bump docker/build-push-action from 4.1.1 to 4.2.1
(#1318)**
- **Fix (#1323)**
- **state: remove genesis file from database  (#1297)**
- **Added changelog for pruning metrics (#1335)**
- **Removed begin_block_events and end_block_events from rpc doc
(#1338)**
- **consensus: test for precommit/locking corner case (#1257)**
- **TxIndexer and BlockIndexer pruning metrics (#1334)**
- **Forward port changes to changelog and `UPGRADING.md` for release
`v0.38.0` (#1341)**
- **Update Go version specified in root README on main for v0.34.x
(#1352)**
- **Add test/e2e/data to gitignore (#1349)**
- **docs: gRPC services and data companion pruning services (#1307)**
- **Add genesis_hash flag check on node startup (#1324)**
- **gRPC for Tx and Block indexer pruning (#1327)**
- **build(deps): Bump docker/build-push-action from 4.2.1 to 5.0.0
(#1371)**
- **build(deps): Bump docker/setup-buildx-action from 2.10.0 to 3.0.0
(#1370)**
- **build(deps): Bump docker/login-action from 2.2.0 to 3.0.0 (#1368)**
- **build(deps): Bump goreleaser/goreleaser-action from 4 to 5 (#1369)**
- **ADR101: Moved changelog entries (#1377)**
- **Max byte check (#1384)**
- **Update to string (#1385)**
- **mempool: Remove unused peerID constants (#1379)**
- **build(deps): Bump github.com/google/uuid from 1.3.0 to 1.3.1
(#1392)**
- **build(deps): Bump github.com/rs/cors from 1.9.0 to 1.10.0 (#1393)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.1 to 5.9.0
(#1396)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.4 to 2.34.0
(#1400)**
- **build(deps): Bump github.com/go-kit/kit from 0.12.0 to 0.13.0
(#1397)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1398)**
- **build(deps): Bump google.golang.org/grpc from 1.57.0 to 1.58.2
(#1399)**
- **doc: improve documentation of BlockParams.MaxBytes (#1405)**
- **rpc: Improve abci_query parameter documentation (#1184)**
- **Bump p2p version following introduction of
`HasProposalBlockPartMessage` (#1411)**
- **RFC: Allowing Non-Determinism in `ProcessProposal` (#1391)**
- **ADR-101: Data Companion Pull API (#82)**
- **build(deps): Bump github.com/rs/cors from 1.10.0 to 1.10.1 (#1418)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.0 to 2.34.2
(#1416)**
- **build(deps): Bump github.com/prometheus/client_golang (#1417)**
- **fix typos (#1413)**
- **Renames Tendermint to CometBFT in the RPC related test code
(#1428)**
- **Renames Tendermint to CometBFT in the RPC related test code. This
file was missing and it was not caught in the branch testing. (#1433)**
- **Reject incoming txs while node is catching up (#1119)**
- **build(deps): Bump golang.org/x/crypto from 0.13.0 to 0.14.0
(#1458)**
- **build(deps): Bump golang.org/x/sync from 0.3.0 to 0.4.0 (#1454)**
- **build(deps): Bump golang.org/x/net from 0.15.0 to 0.16.0 (#1453)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.1 to 1.27.0
(#1449)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.11.0 to
0.12.0 (#1450)**
- **build(deps): Bump github.com/prometheus/client_model (#1455)**
- **build(deps): Bump github.com/bufbuild/buf from 1.26.1 to 1.27.0
(#1459)**
- **build(deps): Bump github.com/spf13/viper from 1.16.0 to 1.17.0
(#1456)**
- **test: respect P2PConfig fuzzing configuration in MultiplexTransport
(#1414)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.2 to 2.35.3
(#1462)**
- **crypto: export errors (#1463)**
- **Do not race with pruning to validate headers and validators
(#1467)**
- **fix typos (#1487)**
- **Call observer only when retain height changes (#1490)**
- **build(deps): Bump pillow from 9.3.0 to 10.0.1 in
/scripts/qa/reporting (#1493)**
- **abci: Add relaxed local client synchronization models (#1141)**
- **docs: fix typos (#1500)**
- **Post-merge fixes for feature/proto-upgrade**
- **Make BuildLastCommitInfo and BuildExtendedCommitInfo public
(#1502)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.3 to 2.35.4
(#1497)**
- **build(deps): Bump google.golang.org/grpc from 1.58.2 to 1.58.3
(#1498)**
- **build(deps): Bump golang.org/x/net from 0.16.0 to 0.17.0 (#1499)**
- **tiny change: reorder expected and actual values (#1506)**
- **Fixed docker port alias (#1507)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.0 to 1.27.1
(#1527)**
- **Implement ADR-107: rename proto package version suffixes to v1beta*
pattern (#1510)**
- **e2e: Fix flakiness in grpc tests due to pruning (#1492)**
- **fix spelling of bandwidth (#1534)**
- **Fix linting on `main` (#1531)**
- **build(deps): Bump github.com/prometheus/common from 0.44.0 to 0.45.0
(#1524)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.0 to 1.27.1
(#1522)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1540)**
- **fix some typos (#1541)**
- **indexer-respect-height-params-on-query (#1529)**
- **Correct go_package paths in service proto files (#1538)**
- **build(deps): Bump google.golang.org/grpc from 1.58.3 to 1.59.0
(#1521)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.4 to 2.36.0
(#1523)**
- **feat(mempool): export error (#1427)**
- **Rename proto messages and services to satisfy default buf lints
(#1533)**
- **RFC 106: non-idempotent methods in data companion (#1545)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.0
(#1550)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.1 to 1.27.2
(#1551)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1552)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.1 to 1.27.2
(#1553)**
- **use assert.Greater instead of Equal for better error reporting
(#1547)**
- **rpc: Version the RPC APIs (#1412)**
- **mempool: Add metric size of pool in bytes (#1512)**
- **build(deps): Bump github.com/docker/docker (#1570)**
- **build(deps): Bump github.com/spf13/cobra from 1.7.0 to 1.8.0
(#1572)**
- **build(deps): Bump golang.org/x/sync from 0.4.0 to 0.5.0 (#1574)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.0 to 2.36.1
(#1576)**
- **build(deps): Bump github.com/gorilla/websocket from 1.5.0 to 1.5.1
(#1575)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1573)**
- **chore: consolidate changelog improvements section (#1578)**
- **Implementation of ADR-108 (#930)**
- **Reduce the default MaxBytes to 4mb and increase MaxGas to 10 million
(#1518)**
- **e2e: Allow disabling the PEX reactor on all nodes in the testnet
(#1580)**
- **Experimental - Reduce # of connections effectively used to gossip
transactions out (#1558)**
- **Update proto file references to follow renaming/versioning (#1555)**
- **Make `LoadBlock` also return block metadata (#1557)**
- **mempool: Limit gossip connections to persistent and non-persistent
peers (experimental) (#1584)**
- **fix: docs: default db provider moved from node to config (#1588)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.2 to 1.28.0
(#1598)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.2 to 1.28.0
(#1602)**
- **build(deps): Bump golang.org/x/crypto from 0.14.0 to 0.15.0
(#1599)**
- **build(deps): Bump golang.org/x/net from 0.17.0 to 0.18.0 (#1597)**
- **RFC 107: Internal signalling using event observers (#1164)**
- **ADR 110: Remote mempool (#1565)**
- **chore: aligns function descriptions with godoc standards in the
types package (#1593)**
- **docs: various improvements (#1603)**
- **chore: Merge branch main into feature/proto-upgrade (#1612)**
- **Removes wrong assertion and decreases likelyhood of block from the
future has actually been already created (#1619)**
- **Split /api off to separate go.mod (#1608)**
- **feature: Reduce Go API surface area (ADR 109) (#1605)**
- **refactor: Export func MakeHTTPDialer (#1594)**
- **First draft (#1483)**
- **pruning:do not attempt to prune state if no blocks are pruned
(#1616)**
- **Update SECURITY.md (#1626)**
- **Update changelog on `main` with new releases (#1644)**
- **proto: Update README (#1648)**
- **ADR 111: `nop` Mempool (#1585)**
- **ADR-111: Addressed Ethan's comment (#1667)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.1 to 2.37.1
(#1662)**
- **build(deps): Bump docker/build-push-action from 5.0.0 to 5.1.0
(#1664)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.0 to 1.28.1
(#1665)**
- **ci: Fix v0.34 nightly build (#1655)**
- **build(deps): Bump github.com/bufbuild/buf from 1.28.0 to 1.28.1
(#1663)**
- **feature/proto-upgrade: Fix generated mock code (#1673)**
- **Update link in README.md (#1674)**
- **Renames the semantic versioning variable to CMT (#1621)**
- **mempool: add `nop` mempool (#1643)**
- **e2e:fix-digital-ocean-ports (#1678)**
- **Revert modularization of the test infra (#1488) (#1676)**
- **docs: various small improvements (part 2) (#1683)**
- **Do not block indefinitely on the semaphore (#1654)**
- **Adds tests that check for FIFO ordering being broken by gossip
(#1628)**
- **loadtime: Add parameter for displaying results in one line (#1511)**
- **Promote latest versions of Protobuf definitions to v1 packages
(#1677)**
- **chore: Update CHANGELOG.md (#1701)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1696)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.37.1 to 2.38.0
(#1697)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.1
(#1702)**
- **proto: document the `cometbft.*` versioned protos (#1694)**
- **Clean up changelog entries and README files for versioned proto
changes (#1707)**
- **chore(proto): add missing docs (#1703)**
- **feature/proto-upgrade: Last-minute fixes (#1709)**
- **e2e: Support emulated latencies between docker images (#1560)**
- **build(deps): Bump golang.org/x/net from 0.14.0 to 0.17.0 in /api
(#1713)**
- **Prepare `main` for `v1.x` backport branch (#1714)**
- **build(deps): Bump golang.org/x/crypto from 0.15.0 to 0.16.0
(#1720)**
- **build(deps): Bump golang.org/x/net from 0.18.0 to 0.19.0 (#1719)**
- **types: validate Validator#Address field (#1715)**
- **Enable Mergify backports for `v1.x` branch (#1724)**
- **deps: Bump cometbft-db to v0.9.0 (#1725)**
- **buf improvements prior to publishing on BSR (#1726)**
- **proto: give our buf module a name (#1734)**
- **deps: Bump cometbft-db to v0.9.1 (#1737)**
- **chore: Update root docs (#1740)**
- **fix: increase abci socket message size limit to 2GB (#1730)**
- **proto: make comment in README more Markdowny (#1743)**
- **fix: Txs Validate (#1687)**
- **Add test missing in #1687 (#1712)**
- **perf(state): batch save `State` (#1735)**
- **Update CODE_OF_CONDUCT.md (#1708)**
- **[e2e] Fixes prepareProposal not to return oversized set of
transactions (#1756)**
- **perf(store): Batch save `Block` (#1755)**
- **Fix: Fix minor typos (#1780)**
- **`VerifyCommitLight` and `VerifyCommitLightTrusting` _never_ check
all signatures (#1750)**
- **Fix typo in encoding.md (#1801)**
- **chore(docs): small improvements (#1781)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.10.1 to 5.11.0
(#1797)**
- **build(deps): Bump actions/setup-go from 4 to 5 (#1794)**
- **build(deps): Bump actions/stale from 8 to 9 (#1795)**
- **build(deps): Bump github.com/spf13/viper from 1.17.0 to 1.18.1
(#1796)**
- **Chore/fix other typos (#1809)**
- **chore(spec): specify which fields must be deterministic (#1804)**
- **Small improvements in #1806 not present in #1750 (#1808)**
- **Add changelog for #1749 (#1807)**
- **e2e: Implement latency emulation for DigitalOcean (#1587)**
- **add GH workflow for linting code using codespell (#1824)**
- **chore(docs): explain the effect of `timeout_propose` (#1798)**
- **build(deps): Bump actions/upload-artifact from 3 to 4 (#1845)**
- **build(deps): Bump actions/setup-python from 2 to 5 (#1843)**
- **build(deps): Bump github/codeql-action from 2 to 3 (#1847)**
- **build(deps): Bump actions/checkout from 2 to 4 (#1846)**
- **build(deps): Bump github.com/google/uuid from 1.4.0 to 1.5.0
(#1850)**
- **build(deps): Bump google.golang.org/grpc from 1.59.0 to 1.60.0
(#1851)**
- **golangci-lint: enable all the linters by default (#1838)**
- **Updates go crypto package to v0.17.0 (#1859)**
- **Adds checks for nil keys and signatures (#1855)**
- **The store DB and the companion `BlockStore` struct are sometimes out
of sync (#1856)**
- **Allow blocksync to not verify all signatures (#1858)**
- **Fixing the ABCI grammar and updating the code for e2e tests to
account for the new grammar. (#1829)**
- **docs: Fix Discord links in README (#1874)**
- **build(deps): Bump github.com/prometheus/client_golang (#1909)**
- **build(deps): Bump github.com/btcsuite/btcd/btcutil from 1.1.3 to
1.1.5 (#1908)**
- **build(deps): Bump google.golang.org/protobuf (#1885)**
- **build(deps): Bump github.com/spf13/viper from 1.18.1 to 1.18.2
(#1884)**
- **build(deps): Bump google.golang.org/grpc from 1.60.0 to 1.60.1
(#1883)**
- **remove unused linters that produced a warning and ensure that
unparam is enabled (#1905)**
- **Fix HTTP response body not being closed after reading (#1945)**
- **Disable undesired linting code (#1959)**
- **Extend kvstore example add with with key types (#1876)**
- **Extra check in `VerifyExtension` (#1877)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.38.0 to 2.39.1
(#1882)**
- **perf(crypto/merkle, crypto/tmhash): simplify+optimize SHA256 hashing
of multiple byteslices (#1921)**
- **Update localnet-start Makefile (#1975)**
- **blocksync: wait for poolRoutine to stop in (*Reactor).OnStop
(#1879)**
- **fix TestListenerTimeoutReadWrite (#1947)**
- **docs: fix typos (#1988)**
- **this is the kindest commit I can think of. Take it that way and read
the code. (#1987)**
- **there's really no need for this anymore (#1986)**
- **feat: DefaultHttpClient support setting proxy from env (#1900)**
- **feat: lint tests (#1906)**
- **chore: fix typos (#1991)**
- **build(deps): Bump golang.org/x/sync from 0.5.0 to 0.6.0 (#1992)**
- **feat(proxy): export errors (#1899)**
- **doc:fix broken link in DOCKER/README.md (#1996)**
- **feat: custom dependencies order (#1994)**
- **PBTS: migrating to `main` the new version of the specification
(#1973)**
- **Fix paths to scripts/metricsgen in go:generate commands (#1998)**
- **chore: fix some typos (#2002)**
- **docs(light): fix broken link to spec (#2007)**
- **chore(test/loadtime): replace tm-load-test w/ cometbft-load-test
(#2009)**
- **ci: Remove unused `tests` target when compiling e2e (#2022)**
- **spec: fix typo in `encoding.md` (#2024)**
- **mempool: Fix data races in CListMempool's height and
notifiedTxsAvailable (#2021)**
- **chore(test/loadtime): cleanup go.sum and golangci.yml (#2025)**
- **build(deps): Bump github.com/prometheus/common from 0.45.0 to 0.46.0
(#2040)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.39.1 to 2.40.1
(#2038)**
- **feat(rpc): Use default port for HTTP(S) URLs when there is no
explicit port (#1903)**
- **misc(go.mod): remove unused peg dependency (#2044)**
- **config: Remove unused `max_batch_bytes` (#2050)**
- **Merge pull request from GHSA-qr8r-m495-7hc4**
- **misc(tools)!: remove `tools` package (#2046)**
- **docs(guides): add missing import (#2070)**
- **deps(localnode): bump alpine version (#2077)**
- **misc(Makefile): add `help` target to display the help msg (#2074)**
- **`e2e`: test vote extension activation via `InitChain` and
`FinalizeBlock` (#2066)**
- **scripts: metricsgen parses '// metrics:' pattern (#2090)**
- **e2e: Add `load_max_txs` option to manifest (#2094)**
- **consensus: Add `chain_size_bytes` metric (#2093)**
- **feat: conventional commits (#1995)**
- **Forward port of tendermint/tendermint#7605, tendermint/spec#393, and
tendermint/tendermint#8142 (#2018)**
- **ci: fix permissions for \"Conventional PR Title\" (#2099)**
- **PBTS: additions and fixes on migrated spec (#2013)**
- **PBTS: forward port of tendermint/tendermint#7709 (#2089)**
- **feat: use go workspace (#1924)**
- **fix: `ValidateUpdate`: allow no-change updates regardless of current
height (#2112)**
- **test(localnet): Add monitoring tools for localnet (#2108)**
- **feat: add gofumpt (#2049)**
- **feat(consensus): increase log level for corner case when prevoting a
proposal (#2042)**
- **docs: v1 - diataxis framework (#2105)**
- **feat(consensus): additional sanity checks for the size of proposed
blocks (#1408)**
- **perf(internal/blocksync): avoid double-calling
`types.BlockFromProto` (#2016)**
- **build(deps): Bump google.golang.org/grpc from 1.60.1 to 1.61.0
(#2178)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.1 to 1.29.0
(#2161)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.12.0 to
0.12.1 (#2160)**
- **build(deps): Bump slackapi/slack-github-action from 1.24.0 to 1.25.0
(#2162)**
- **build(deps): Bump github.com/google/uuid from 1.5.0 to 1.6.0
(#2176)**
- **refactor(privval): reverse conditional + more idiomatic Go code with
early returns (#2156)**
- **fix(e2e): path to latency script files in DO (#2148)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.9.1 to
0.10.0 (#2175)**
- **chore(Makefile): add `setup-pre-commit` target to init git hook
(#2123)**
- **feat: add pebbledb (https://github.com/cockroachdb/pebble) (#2132)**
- **perf(internal/blocksync): do not `ValidateBlock` twice (#2026)**
- **feat(e2e): Add new targets `fast` and `clean` to Makefile (#2192)**
- **ci: add `spec` type in conventional-pr-title (#2191)**
- **fix(privval): retry accepting a connection on errors (#2047)**
- **fix(.github/workflows): correct parameters to lint_pr_title
(#2199)**
- **docs: update QA method steps for qa-infra changes (#2198)**
- **feat!(pbts): forward port of tendermint/tendermint#7711 (#2149)**
- **docs(pbts): forward port of PBTS documentation and fixes (#2124)**
- **fix: if-return and early-return (#2215)**
- **chore: remove amazon linux Dockerfile and update
test/docker/Dockerfile (#2135)**
- **feat(ci): pre-commit framework (#2214)**
- **ci: add `merge` type for conventional-pr-title (#2219)**
- **spec(consensus/pbts): update description for introduced parameters.
(#2206)**
- **perf: optimize psql indexer (#2142)**
- **fix(go.mod): do not use `replace` for api (#2236)**
- **fix(Makefile): gofumpt no longer needed (#2235)**
- **fix(p2p/pex): gracefully shutdown `Reactor` (#2010)**
- **test(mempool): fix
TestMempoolUpdateDoesNotPanicWhenApplicationMissedTx (#2242)**
- **fix(flowrate): fix non-determinism in flowrate tests (#2147)**
- **refactor!: Implement RFC 106: remove `GetLatestBlock*` methods from
data companion API (#2240)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.3 to 1.3.7
(#2253)**
- **chore(config): update DB section in toml.go (#2249)**
- **fix(consensus): do not precommit nil if proposal block is received
(#2221)**
- **build(deps): Bump github.com/opencontainers/runc from 1.1.5 to
1.1.12 (#2261)**
- **fix(mempool/tests): Reduce tests duration (#2263)**
- **ci: run golangci-lint linters for all files (not only ones which
were modified) (#2250)**
- **refactor(examples): small changes to kvstore app (#2267)**
- **refactor(mempool): simplify parameters of resCbFirstTime and
resCbRecheck (#2272)**
- **perf(mempool/cache): clear map in Reset (#2259)**
- **test(abci): update e2e tests to check against ABCI 2.0 grammar
(#2201)**
- **docs: symbolic references to steps in the qa-infra README (#2280)**
- **chore: updated doc link (#2296)**
- **fix(consensus): prevote nil upon timeout when Proposal is missing
(#2218)**
- **build(deps): Bump pre-commit/action from 3.0.0 to 3.0.1 (#2307)**
- **build(deps): Bump golang.org/x/net from 0.20.0 to 0.21.0 (#2300)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.10.0 to
0.11.0 (#2299)**
- **docs: ADR-112 Proposer-Based Timestamps (#2223)**
- **refactor(internal/statesync): replace ticker with `time.After(X)`
(#2294)**
- **fix: simultaneous rpc test failures (#2150)**
- **chore(docs): alter the section about the effects of `timeout_commit`
(#1892)**
- **refactor(p2p)!: Refactor PeerSet to eliminate data races & improve
performance (#2246)**
- **feat(pbts): Update consensus params to include pbts enabled
(#2231)**
- **feat(storage/metrics): Metrics to measure storage (#1974)**
- **feat(e2e): Log number of sent txs (success and failed) (#2328)**
- **chore: enable gomoddirectives, unparam (#2290)**
- **docs: images not rendering properly in docs (#2331)**
- **docs: Fix references about DeliverTx (#2330)**
- **docs(qa): Add table of contents to existing QA reports (#2343)**
- **chore: enable perfsprint linter (#2291)**
- **feat(pruning): trigger explicitly compaction upon pruning (#1972)**
- **docs: explain how to skip pre-commit hook (#2358)**
- **build(deps): Bump github.com/prometheus/common from 0.46.0 to 0.47.0
(#2373)**
- **build(deps): Bump google.golang.org/grpc from 1.61.0 to 1.61.1
(#2372)**
- **feat(e2e): Option to set max block size in bytes at genesis
(#2362)**
- **build(deps): Bump github.com/prometheus/client_model from 0.5.0 to
0.6.0 (#2371)**
- **revert(pbts): revert removal of BFT Time related functions (#2205)**
- **fix(e2e): Reduce flakiness of TestGRPC_GetBlockResults (#2367)**
- **spec(consensus): update Block Time documentation in spec (#2316)**
- **spec: adaptive MSGDELAY parameter included in PBTS spec (#2318)**
- **feat(pbts): Moving VoteExtensionsEnableHeight from ABCIParams to
FeatureParams. (#2335)**
- **fix: remove TestMempoolFIFOWithParallelCheckTx (#2364)**
- **fix(docker-compose): fix subnet (#2383)**
- **feat(pbts): enable `e2e` manifest config to set `PbtsEnableHeight`
(#2284)**
- **perf(internal/state): avoid double-saving FinalizeBlockResponse
(#2017)**
- **build(deps): Bump fonttools from 4.37.4 to 4.43.0 in
/scripts/qa/reporting (#2407)**
- **build(deps): Bump pillow from 10.0.1 to 10.2.0 in
/scripts/qa/reporting (#2408)**
- **fix(node): Forward compaction config params to blockstore
constructor (#2418)**
- **refactor!: moved `MedianTime` out of `internal` folder (#2397)**
- **chore: typo fixes (#2403)**
- **chore(pbts): Removes useless code (#2420)**
- **build(deps): Bump github.com/prometheus/common from 0.47.0 to 0.48.0
(#2430)**
- **build(deps): Bump google.golang.org/grpc from 1.61.1 to 1.62.0
(#2429)**
- **test(consensus): PBTS should be enabled by default in test units
(#2329)**
- **test(consensus): test enabling PBTS at a given height (#2404)**
- **refactor(protobuf): switch from gogofaster to gocosmos generator
(#2425)**
- **docs(tutorials/install): add `From Go package` (#2414)**
- **docs(pbts): documentation for PBTS-related consensus parameters
(#2376)**
- **refactor(consensus): print err from SignAndCheckVote (#2346)**
- **feat(e2e): add parameter to set a custom output directory for
testnet files (#2433)**
- **spec(consensus): update description of consensus parameters for PBTS
(#2415)**
- **fix(localnet): Grafana dashboards for storage tests - removed
experimental metrics (#2448)**
- **fix(jsonrpc): enable HTTP basic auth in WS client (#2434)**
- **feat(pbts): Adds timestamp to the `msgInfo` written into the WAL
(#2388)**
- **fix: `Rollback`: wrong modification of
`state.LastHeightValidatorsChanged` while rollback at a special height
(#2136)**
- **docs(changelog): add missing entry for #2136 (#2459)**
- **fix(pbts): legacy `ABCIParams` values are properly translated to
`FeatureParams` values (#2462)**
- **fix(e2e): Fixing the bug in ABCI e2e tests (#2468)**
- **feat(localnet): Grafana PNG rendering for easier graph exports
(#2472)**
- **docs(README): remove Terra (#2469)**
- **docs: document PBTS adaptive delays mechanism (#2452)**
- **fix(config): Moved compact variables to the right section (#2477)**
- **feat(metrics): more buckets for ProposalTimestampDifference
(#2479)**
- **fix(metrics): more buckets for ProposalTimestampDifference (#2481)**
- **feat(pbts): Make synchrony params adaptive (#2431)**
- **ci: check metrics generation in CI checks (#2483)**
- **feat(consensus): improve logging for timely and untimely messages
(#2321)**
- **feat(types): improve Proposal and SynchronyParams validation tests
(#2489)**
- **test(consensus): refactor TestStateLock_POLSafety tests (#2492)**
- **feat(types): refactor types.AdaptiveSynchronyParams method (#2490)**
- **fix: lint errors introduced with the latest merge (#2495)**
- **build(deps): Bump docker/setup-buildx-action from 3.0.0 to 3.1.0
(#2500)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.18.0 to
1.19.0 (#2508)**
- **build(deps): Bump golang.org/x/crypto from 0.19.0 to 0.20.0
(#2507)**
- **build(deps): Bump github.com/prometheus/common from 0.48.0 to 0.49.0
(#2506)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.4 to 1.9.0
(#2505)**
- **fix(docs): include `timesync` daemon instructions (#2491)**
- **feat(privval)!: DO NOT require extension signature (#2496)**
- **refactor(privval): rename sign_extension to skip_sign_extension
(#2519)**
- **spec(abci): fixes the spec to inform about the presence of invalid
extensions in `last_commit` (#2423)**
- **fix(pbts): block Time must be Canonical (#2493)**
- **feat(e2e): Add manifest option `clock_skew` and corresponding
backend functionality (#2454)**
- **fix(mempool): converting to uint64 before additions to avoid
overflows (#2498)**
- **refactor!: Rename `skip_sign_extension` to `skip_extension_signing`
(#2522)**
- **docs(ADR): ADR-108 updated to account for the new changes in the
grammar and code. (#2528)**
- **feat(e2e): add generator support for clock skew + env variable
rename (#2488)**
- **spec(proto): add `cometbft.privval.v1beta2` proto package (#2529)**
- **chore: improving error handling in the PendingEvidence (#2550)**
- **feat(blocksync)!: set the max number of (concurrently) downloaded
blocks to {peersCount * 20} (#2467)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.29.0 to 1.30.0
(#2557)**
- **build(deps): Bump google.golang.org/protobuf from 1.32.0 to 1.33.0
(#2560)**
- **build(deps): Bump golang.org/x/net from 0.21.0 to 0.22.0 (#2562)**
- **fix(cmd/cometbft/commands/version): update the output for v1
(#2546)**
- **build(deps): Bump docker/build-push-action from 5.1.0 to 5.2.0
(#2558)**
- **build(deps): Bump github.com/prometheus/common from 0.49.0 to 0.50.0
(#2559)**
- **build(deps): Bump google.golang.org/grpc from 1.62.0 to 1.62.1
(#2563)**
- **build(deps): Bump golang.org/x/crypto from 0.20.0 to 0.21.0
(#2561)**
- **feat(blocksync): sort peers by download rate & multiple requests for
closer blocks (#2475)**
- **feat(pbts): Adjusts PBTS metrics buckets (#2578)**
- **fix(blocksync): use timer instead of time.After (#2584)**
- **fix: temporary fix for `api` dependency (#2589)**

---------

Signed-off-by: Thane Thomson <connect@thanethomson.com>
Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Thane Thomson <connect@thanethomson.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Anton Kaliaev <anton.kalyaev@gmail.com>
Co-authored-by: Mikhail Zabaluev <mikhail@informal.systems>
Co-authored-by: Troy Kessler <43882936+troykessler@users.noreply.github.com>
Co-authored-by: leven <112051166+lx-xiang@users.noreply.github.com>
Co-authored-by: werty144 <anton-paramonov2000@yandex.ru>
Co-authored-by: Adi Seredinschi <adizere@gmail.com>
Co-authored-by: Sukey <35202440+sukey2008@users.noreply.github.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
Co-authored-by: Jasmina Malicevic <jasmina.dustinac@gmail.com>
Co-authored-by: moriluka <85185077+moriluka@users.noreply.github.com>
Co-authored-by: ƒê·ªó Vi·ªát Ho√†ng <hoangdv2429@gmail.com>
Co-authored-by: alex <152680487+azukiboy@users.noreply.github.com>
Co-authored-by: Hern√°n Vanzetto <15466498+hvanz@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@informal.systems>
Co-authored-by: Andy Nogueira <me@andynogueira.dev>
Co-authored-by: nenadmilosevic95 <50905385+nenadmilosevic95@users.noreply.github.com>
Co-authored-by: nenadmilosevic95 <nenad@informal.systems>
Co-authored-by: Jacob Gadikian <jacobgadikian@gmail.com>
Co-authored-by: Greg Szabo <16846635+greg-szabo@users.noreply.github.com>
Co-authored-by: Emmanuel T Odeke <emm.odeke@gmail.com>
Co-authored-by: jchappelow <140431406+jchappelow@users.noreply.github.com>
Co-authored-by: shuoer86 <129674997+shuoer86@users.noreply.github.com>
Co-authored-by: levisyin <150114626+levisyin@users.noreply.github.com>
Co-authored-by: vuittont60 <81072379+vuittont60@users.noreply.github.com>
Co-authored-by: Halimao <1065621723@qq.com>
Co-authored-by: alex <152680487+bodhi-crypo@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@usi.ch>
Co-authored-by: Josef Widder <44643235+josef-widder@users.noreply.github.com>
Co-authored-by: William Banfield <4561443+williambanfield@users.noreply.github.com>
Co-authored-by: Kukovec <jure.kukovec@gmail.com>
Co-authored-by: Daniel Cason <cason@gandria>
Co-authored-by: M. J. Fromberger <fromberger@interchain.io>
Co-authored-by: hattizai <150505746+hattizai@users.noreply.github.com>
Co-authored-by: Huulu <35667132+IssouChancla@users.noreply.github.com>
Co-authored-by: katelyn martin <me+cratelyn@katelyn.world>
Co-authored-by: Richard Gibson <richard.gibson@gmail.com>
Co-authored-by: Jean Deruelle <jean.deruelle@gmail.com>
Co-authored-by: glnro <8335464+glnro@users.noreply.github.com>
Co-authored-by: Greg Szabo <greg@philosobear.com>
Co-authored-by: Emmanuel T Odeke <emmanuel@orijtech.com>
Co-authored-by: levisyin <lilassherl@gmail.com>
Co-authored-by: k0marov <95040709+k0marov@users.noreply.github.com>
Co-authored-by: Adi Seredinschi <a@seredinschi.net>
Co-authored-by: Pan chao <152830401+Pan-chao@users.noreply.github.com>
Co-authored-by: Khanh Hoa <49144992+hoanguyenkh@users.noreply.github.com>
Co-authored-by: glnro <lauren@informal.systems>
Co-authored-by: toni <143221387+xyztoni@users.noreply.github.com>
Co-authored-by: DragonKid <idragonkid@gmail.com>
Co-authored-by: Matt Ketmo <matthieu@moquet.net>
Co-authored-by: Ethan <cosinlinker@gmail.com>
Co-authored-by: Evgeny Danilenko <6655321@bk.ru>
Co-authored-by: Duong Minh Ngoc <153509244+minhngoc274@users.noreply.github.com>
Co-authored-by: Kero <keroroxx520@gmail.com>")[#2594](https://github.com/cometbft/cometbft/pull/2594)[)](/cometbft/cometbft/commit/e7dd0ab89fc3783d3de30f2c5fb892f9ca072ba2 "chore(spec): merge main into `spec/consensus-gossip` (#2594)

- **Versioned protobuf files (#495)**
- **Restore rpc/grpc/v1/types.pb.go**
- **proto: restore deprecation notice on BroadcastAPI**
- **Struct `Client` exposes sensitive data (#784)**
- **Unsafe int cast in `kill` command (#783)**
- **ADR-100: Data Companion Push API (#73)**
- **rfc: incoming txs while catching up (#735)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.17.0 to 1.18.0
(#804)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.8 to 1.4.9
(#806)**
- **build(deps): Bump golang.org/x/sync from 0.1.0 to 0.2.0 (#807)**
- **build(deps): Bump google.golang.org/grpc from 1.54.0 to 1.55.0
(#813)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.0 to
1.15.1 (#810)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
(#809)**
- **build(deps): Bump github.com/prometheus/client_model from 0.3.0 to
0.4.0 (#812)**
- **build(deps): Bump github.com/prometheus/common from 0.42.0 to 0.43.0
(#811)**
- **ADR-103: Protobuf definition versioning (#772)**
- **spec/p2p: Specify the operation of a Reactor (#714)**
- **build(deps): Bump github.com/docker/distribution (#827)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.1 to 1.3.3
(#828)**
- **ADR-103: Protobuf definition versioning (#772) (#817)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.9 to 1.4.10
(#830)**
- **build(deps): Bump golang.org/x/net from 0.9.0 to 0.10.0 (#831)**
- **build(deps): Bump golang.org/x/crypto from 0.8.0 to 0.9.0 (#832)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.26.1 to 2.27.1
(#833)**
- **rpc: Remove response data from response failure logs (#829)**
- **pubsub/kvindexer:support for big numbers - v2 (#797)**
- **Extend the infrastructure provider with `StartNodes` and
`StopTestnet` (#796)**
- **grpc: Add base gRPC server with version service (#818)**
- **Digital Ocean implementation of `StartNodes` and `StopTestnet`
(#846)**
- **RFC 102: Improve forward compatibility of proto-generated Rust
(#724)**
- **mempool: Add metric to measure how many times a tx was received
(#637)**
- **`e2e` provider is extended with `Disconnect`, `Reconnect` and
`CheckUpgraded` (#852)**
- **Sort `loadtime` tool's report (#854)**
- **feat: make handshake cancelable (#857)**
- **proto: Restore snake_case JSON for `ExecTxResult` (#856)**
- **qa: 200-nodes test on v0.38 (#877)**
- **qa: rotating node test on `v0.38.x` (#883)**
- **Changes to QA related files (e.g., `method.md`) (#878)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.18.0 to 1.19.0
(#868)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.2 to 1.8.3
(#873)**
- **build(deps): Bump github.com/bufbuild/buf from 1.18.0 to 1.19.0
(#872)**
- **Adds `vote_extension_size` to manifests (#858)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.27.1 to 2.28.1
(#893)**
- **build(deps): Bump github.com/prometheus/common from 0.43.0 to 0.44.0
(#892)**
- **build(deps): Bump slackapi/slack-github-action from 1.23.0 to 1.24.0
(#869)**
- **ADR 104: State sync from local application snapshot (#801)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0
(#891)**
- **mempool: slight refactor for improving readability (#894)**
- **Add Vote Extension varying size testnet (#888)**
- **fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
(#908)**
- **build(deps): Bump github.com/bufbuild/buf from 1.19.0 to 1.20.0
(#912)**
- **build(deps): Bump github.com/golangci/golangci-lint (#917)**
- **build(deps): Bump github.com/spf13/viper from 1.15.0 to 1.16.0
(#913)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.19.0 to 1.20.0
(#910)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.1 to 2.28.2
(#914)**
- **Minor fixes to `RELEASES.md` (#923)**
- **Prevent a transaction to appear twice in the mempool (#890)**
- **New metrics to track duplicate votes and block parts (#896) (#905)**
- **e2e tests are being skipped; `INFRASTRUCTURE-*` bug; portGen
inconsistency bug (#933)**
- **build(deps): Bump github.com/bufbuild/buf from 1.20.0 to 1.21.0
(#948)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.20.0 to 1.21.0
(#946)**
- **spec/p2p: document the p2p API used by Reactors (#851)**
- **build(deps): Bump docker/login-action from 2.1.0 to 2.2.0 (#944)**
- **e2e: Generate prometheus.yaml on setup (#954)**
- **Update the type annotations in the light client spec (#955)**
- **build(deps): Bump docker/build-push-action from 4.0.0 to 4.1.0
(#947)**
- **build(deps): Bump docker/setup-buildx-action from 2.5.0 to 2.7.0
(#962)**
- **Add requirement for `CheckTx` in ABCI spec (#928)**
- **fix: avoid recursive call after rename to (*PeerState).MarshalJSON
(#865)**
- **Port upstream proto changes to cometbft package**
- **changelog: Import entries for v0.34.28, v0.34.29, v0.37.1 and
v0.37.2 to `main` (#974)**
- **test/e2e: Fix Docker image build (#984)**
- **build(deps): Bump github.com/BurntSushi/toml from 1.3.0 to 1.3.2
(#952)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.2 to 2.29.0
(#953)**
- **Remove duplicate function `deterministicExecTxResult` (#986)**
- **mempool: Fix the benchmarks (#934)**
- **Add `CMT_HOME` (or remove it?) (#983)**
- **Remove buf.yaml at the root of the source tree (#979)**
- **build(deps): Bump docker/build-push-action from 4.1.0 to 4.1.1
(#989)**
- **build(deps): Bump golang.org/x/net from 0.10.0 to 0.11.0 (#994)**
- **build(deps): Bump golang.org/x/sync from 0.2.0 to 0.3.0 (#990)**
- **build(deps): Bump google.golang.org/grpc from 1.55.0 to 1.56.0
(#992)**
- **build(deps): Bump github.com/golangci/golangci-lint from 1.53.2 to
1.53.3 (#996)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.1 to
1.16.0 (#991)**
- **spec/p2p: new structure for the p2p specification (#966)**
- **consensus: optimize vote and block part gossip with
HasProposalBlockPartMessage and random sleeps (#904)**
- **Extend ABCI `max_block_size` parameter to give extended control to
the app (#1003)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.21.0 to 1.22.0
(#1026)**
- **Bump logs on non-fatal vote validation failures to Info level
(#1022)**
- **Update codeowners to include DevRel team (#1023)**
- **deps: Manually bump github.com/vektra/mockery/v2 from 2.29.0 to
2.30.1 (#1009)**
- **Update releasing.md to sign tags (#1034)**
- **build(deps): Bump github.com/bufbuild/buf from 1.21.0 to 1.22.0
(#1027)**
- **Rename ABCI enums and values to satisfy buf guidelines (#975)**
- **build(deps): Bump google.golang.org/grpc from 1.56.0 to 1.56.1
(#1028)**
- **docs: Added double quotes to /abci_query path param (#1015)**
- **Update Docs with Finalize Block (#760)**
- **Clarifies that processProposal may be called for set of transactions
different from the one returned in the preceding prepareProposal
(#1033)**
- **Update the annotation of part_set.go (#1056)**
- **build(deps): Bump docker/setup-buildx-action from 2.7.0 to 2.8.0
(#1071)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.1 to
2.30.16 (#1064)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.22.0 to 1.23.1
(#1072)**
- **build(deps): Bump github.com/bufbuild/buf from 1.22.0 to 1.23.1
(#1066)**
- **build(deps): Bump google.golang.org/protobuf from 1.30.0 to 1.31.0
(#1065)**
- **build(deps): Bump google.golang.org/grpc from 1.56.1 to 1.56.2
(#1101)**
- **build(deps): Bump golang.org/x/crypto from 0.10.0 to 0.11.0
(#1103)**
- **build(deps): Bump docker/setup-buildx-action from 2.8.0 to 2.9.0
(#1105)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.16 to
2.31.1 (#1100)**
- **build(deps): Bump golang.org/x/net from 0.11.0 to 0.12.0 (#1102)**
- **ci: Trigger workflows on merge group (#1118)**
- **Revert \"config: add bootstrap peers (#9680)\" (#1109)**
- **node: Revert removal of public reactor accessors (#1120)**
- **ci: Disable CodeQL check in merge queues (#1123)**
- **p2p: Remove UPnP functionality (#1114)**
- **ADR 107: Rename proto versions to pre-v1 betas (#1110)**
- **RFC 104: Internal messaging using the actor model (#1092)**
- **build(deps): Bump github.com/bufbuild/buf from 1.23.1 to 1.24.0
(#1131)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.31.1 to 2.32.0
(#1132)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.0 to 2.9.1
(#1133)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.23.1 to 1.24.0
(#1134)**
- **spec: Add mempool specification in English and Quint (#997)**
- **mempool: ADR for refactoring list of senders  (#1032)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.24.0 to 1.25.0
(#1157)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.7.0 to 5.8.0
(#1159)**
- **build(deps): Bump github.com/bufbuild/buf from 1.24.0 to 1.25.0
(#1160)**
- **proxy: Rename \"unsynchronized\" to \"connection-synchronized\" local
client creator (#1145)**
- **mempool: Keep track of senders in reactor instead of implementation
(#1010)**
- **cmd: Remove `replay` and `replay-console` subcommands (#1170)**
- **build(deps): Bump google.golang.org/grpc from 1.56.2 to 1.57.0
(#1181)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.0 to 5.8.1
(#1180)**
- **ci: Remove Mergify automerge (#1182)**
- **Add gRPC block service (#1142)**
- **blocksync: export errors (#1186)**
- **Porting changes related to creating a lean docker image from
`pierre/fast-prototyping-1059` branch. (#1192)**
- **chore: Format repo (#1193)**
- **Add BlockResults gRPC service (#1168)**
- **consensus: remove logic to unlock block on +2/3 prevote for nil
(#1175)**
- **ADR 101: Add GetLatest method to block service (#1209)**
- **ADR 101: Implement pruning mechanism (#1150)**
- **config: export errors (#1190)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.0 to 2.32.3
(#1218)**
- **Add check for non-`nil` in `enterCommit` (#1208)**
- **Log proposer's address when correctly accepting a proposal (#1079)**
- **Close evidence.db OnStop (#1210)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.0 to 1.25.1
(#1213)**
- **build(deps): Bump golang.org/x/crypto from 0.11.0 to 0.12.0
(#1215)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.0 to 1.25.1
(#1216)**
- **build(deps): Bump golang.org/x/net from 0.12.0 to 0.14.0 (#1217)**
- **Forward-port: update state to prevote `nil` when proposal block does
not match locked block (#1203)**
- **mempool: Store peer ids as p2p.ID instead of uint16 (remove
mempoolIDs) (#1191)**
- **ADR-101: implement gRPC `PruningService` (#1154)**
- **consensus: Avoid process proposal when we know correct nodes
validated it (#1231)**
- **ADR-101: Metrics to monitor the pruning  (#1234)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.1 to 1.26.0
(#1241)**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.1 to 1.26.1
(#1239)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1240)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.3 to 2.32.4
(#1242)**
- **abci: export errors  (#1185)**
- **consensus: export errors (#1211)**
- **ADR-101: Pruning mechanism minor fixes (#1246)**
- **chore: Bump minimum Go version on `main` to v1.21 (#1244)**
- **ADR 101: Add `Close` method to gRPC client (#1251)**
- **ADR 108: ADR for extending E2E infrastructure so that we can check
CometBFT's behaviour with respect to ABCI++ grammar. (#902)**
- **docs: Add logging guide to contributing guidelines (#1250)**
- **chore: log `app_hash` as hex (#1264)**
- **update language (#1263)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.0 to 1.26.1
(#1272)**
- **build(deps): Bump gonum.org/v1/gonum from 0.13.0 to 0.14.0 (#1275)**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.10 to 1.4.11
(#1276)**
- **ADR 101: Refactor height check-related logic and tests (#1271)**
- **Fixed linter**
- **Revert \"Fixed linter\"**
- **Fixed mem aliasing in for loop (#1280)**
- **Remove genesis persistence in state db (#1017)**
- **Revert \"Remove genesis persistence in state db (#1017)\" (#1294)**
- **evidence: export errors (#1284)**
- **Re-implement removal of genesis persistence in state db (#1295)**
- **build(deps): Bump docker/setup-buildx-action from 2.9.1 to 2.10.0
(#1298)**
- **node: verify genesis doc hash against the file contents rather than
remarshalled JSON (#1293)**
- **indexer: Implement pruning mechanism (#1176)**
- **Provide relevant block data in `ExtendVote` (#1270)**
- **node/state:bootstrap state api (#1057)**
- **build(deps): Bump actions/checkout from 3 to 4 (#1319)**
- **build(deps): Bump docker/build-push-action from 4.1.1 to 4.2.1
(#1318)**
- **Fix (#1323)**
- **state: remove genesis file from database  (#1297)**
- **Added changelog for pruning metrics (#1335)**
- **Removed begin_block_events and end_block_events from rpc doc
(#1338)**
- **consensus: test for precommit/locking corner case (#1257)**
- **TxIndexer and BlockIndexer pruning metrics (#1334)**
- **Forward port changes to changelog and `UPGRADING.md` for release
`v0.38.0` (#1341)**
- **Update Go version specified in root README on main for v0.34.x
(#1352)**
- **Add test/e2e/data to gitignore (#1349)**
- **docs: gRPC services and data companion pruning services (#1307)**
- **Add genesis_hash flag check on node startup (#1324)**
- **gRPC for Tx and Block indexer pruning (#1327)**
- **build(deps): Bump docker/build-push-action from 4.2.1 to 5.0.0
(#1371)**
- **build(deps): Bump docker/setup-buildx-action from 2.10.0 to 3.0.0
(#1370)**
- **build(deps): Bump docker/login-action from 2.2.0 to 3.0.0 (#1368)**
- **build(deps): Bump goreleaser/goreleaser-action from 4 to 5 (#1369)**
- **ADR101: Moved changelog entries (#1377)**
- **Max byte check (#1384)**
- **Update to string (#1385)**
- **mempool: Remove unused peerID constants (#1379)**
- **build(deps): Bump github.com/google/uuid from 1.3.0 to 1.3.1
(#1392)**
- **build(deps): Bump github.com/rs/cors from 1.9.0 to 1.10.0 (#1393)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.1 to 5.9.0
(#1396)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.4 to 2.34.0
(#1400)**
- **build(deps): Bump github.com/go-kit/kit from 0.12.0 to 0.13.0
(#1397)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1398)**
- **build(deps): Bump google.golang.org/grpc from 1.57.0 to 1.58.2
(#1399)**
- **doc: improve documentation of BlockParams.MaxBytes (#1405)**
- **rpc: Improve abci_query parameter documentation (#1184)**
- **Bump p2p version following introduction of
`HasProposalBlockPartMessage` (#1411)**
- **RFC: Allowing Non-Determinism in `ProcessProposal` (#1391)**
- **ADR-101: Data Companion Pull API (#82)**
- **build(deps): Bump github.com/rs/cors from 1.10.0 to 1.10.1 (#1418)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.0 to 2.34.2
(#1416)**
- **build(deps): Bump github.com/prometheus/client_golang (#1417)**
- **fix typos (#1413)**
- **Renames Tendermint to CometBFT in the RPC related test code
(#1428)**
- **Renames Tendermint to CometBFT in the RPC related test code. This
file was missing and it was not caught in the branch testing. (#1433)**
- **Reject incoming txs while node is catching up (#1119)**
- **build(deps): Bump golang.org/x/crypto from 0.13.0 to 0.14.0
(#1458)**
- **build(deps): Bump golang.org/x/sync from 0.3.0 to 0.4.0 (#1454)**
- **build(deps): Bump golang.org/x/net from 0.15.0 to 0.16.0 (#1453)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.1 to 1.27.0
(#1449)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.11.0 to
0.12.0 (#1450)**
- **build(deps): Bump github.com/prometheus/client_model (#1455)**
- **build(deps): Bump github.com/bufbuild/buf from 1.26.1 to 1.27.0
(#1459)**
- **build(deps): Bump github.com/spf13/viper from 1.16.0 to 1.17.0
(#1456)**
- **test: respect P2PConfig fuzzing configuration in MultiplexTransport
(#1414)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.2 to 2.35.3
(#1462)**
- **crypto: export errors (#1463)**
- **Do not race with pruning to validate headers and validators
(#1467)**
- **fix typos (#1487)**
- **Call observer only when retain height changes (#1490)**
- **build(deps): Bump pillow from 9.3.0 to 10.0.1 in
/scripts/qa/reporting (#1493)**
- **abci: Add relaxed local client synchronization models (#1141)**
- **docs: fix typos (#1500)**
- **Post-merge fixes for feature/proto-upgrade**
- **Make BuildLastCommitInfo and BuildExtendedCommitInfo public
(#1502)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.3 to 2.35.4
(#1497)**
- **build(deps): Bump google.golang.org/grpc from 1.58.2 to 1.58.3
(#1498)**
- **build(deps): Bump golang.org/x/net from 0.16.0 to 0.17.0 (#1499)**
- **tiny change: reorder expected and actual values (#1506)**
- **Fixed docker port alias (#1507)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.0 to 1.27.1
(#1527)**
- **Implement ADR-107: rename proto package version suffixes to v1beta*
pattern (#1510)**
- **e2e: Fix flakiness in grpc tests due to pruning (#1492)**
- **fix spelling of bandwidth (#1534)**
- **Fix linting on `main` (#1531)**
- **build(deps): Bump github.com/prometheus/common from 0.44.0 to 0.45.0
(#1524)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.0 to 1.27.1
(#1522)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1540)**
- **fix some typos (#1541)**
- **indexer-respect-height-params-on-query (#1529)**
- **Correct go_package paths in service proto files (#1538)**
- **build(deps): Bump google.golang.org/grpc from 1.58.3 to 1.59.0
(#1521)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.4 to 2.36.0
(#1523)**
- **feat(mempool): export error (#1427)**
- **Rename proto messages and services to satisfy default buf lints
(#1533)**
- **RFC 106: non-idempotent methods in data companion (#1545)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.0
(#1550)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.1 to 1.27.2
(#1551)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1552)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.1 to 1.27.2
(#1553)**
- **use assert.Greater instead of Equal for better error reporting
(#1547)**
- **rpc: Version the RPC APIs (#1412)**
- **mempool: Add metric size of pool in bytes (#1512)**
- **build(deps): Bump github.com/docker/docker (#1570)**
- **build(deps): Bump github.com/spf13/cobra from 1.7.0 to 1.8.0
(#1572)**
- **build(deps): Bump golang.org/x/sync from 0.4.0 to 0.5.0 (#1574)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.0 to 2.36.1
(#1576)**
- **build(deps): Bump github.com/gorilla/websocket from 1.5.0 to 1.5.1
(#1575)**
- **build(deps): Bump github.com/golangci/golangci-lint (#1573)**
- **chore: consolidate changelog improvements section (#1578)**
- **Implementation of ADR-108 (#930)**
- **Reduce the default MaxBytes to 4mb and increase MaxGas to 10 million
(#1518)**
- **e2e: Allow disabling the PEX reactor on all nodes in the testnet
(#1580)**
- **Experimental - Reduce # of connections effectively used to gossip
transactions out (#1558)**
- **Update proto file references to follow renaming/versioning (#1555)**
- **Make `LoadBlock` also return block metadata (#1557)**
- **mempool: Limit gossip connections to persistent and non-persistent
peers (experimental) (#1584)**
- **fix: docs: default db provider moved from node to config (#1588)**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.2 to 1.28.0
(#1598)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.2 to 1.28.0
(#1602)**
- **build(deps): Bump golang.org/x/crypto from 0.14.0 to 0.15.0
(#1599)**
- **build(deps): Bump golang.org/x/net from 0.17.0 to 0.18.0 (#1597)**
- **RFC 107: Internal signalling using event observers (#1164)**
- **ADR 110: Remote mempool (#1565)**
- **chore: aligns function descriptions with godoc standards in the
types package (#1593)**
- **docs: various improvements (#1603)**
- **chore: Merge branch main into feature/proto-upgrade (#1612)**
- **Removes wrong assertion and decreases likelyhood of block from the
future has actually been already created (#1619)**
- **Split /api off to separate go.mod (#1608)**
- **feature: Reduce Go API surface area (ADR 109) (#1605)**
- **refactor: Export func MakeHTTPDialer (#1594)**
- **First draft (#1483)**
- **pruning:do not attempt to prune state if no blocks are pruned
(#1616)**
- **Update SECURITY.md (#1626)**
- **Update changelog on `main` with new releases (#1644)**
- **proto: Update README (#1648)**
- **ADR 111: `nop` Mempool (#1585)**
- **ADR-111: Addressed Ethan's comment (#1667)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.1 to 2.37.1
(#1662)**
- **build(deps): Bump docker/build-push-action from 5.0.0 to 5.1.0
(#1664)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.0 to 1.28.1
(#1665)**
- **ci: Fix v0.34 nightly build (#1655)**
- **build(deps): Bump github.com/bufbuild/buf from 1.28.0 to 1.28.1
(#1663)**
- **feature/proto-upgrade: Fix generated mock code (#1673)**
- **Update link in README.md (#1674)**
- **Renames the semantic versioning variable to CMT (#1621)**
- **mempool: add `nop` mempool (#1643)**
- **e2e:fix-digital-ocean-ports (#1678)**
- **Revert modularization of the test infra (#1488) (#1676)**
- **docs: various small improvements (part 2) (#1683)**
- **Do not block indefinitely on the semaphore (#1654)**
- **Adds tests that check for FIFO ordering being broken by gossip
(#1628)**
- **loadtime: Add parameter for displaying results in one line (#1511)**
- **Promote latest versions of Protobuf definitions to v1 packages
(#1677)**
- **chore: Update CHANGELOG.md (#1701)**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
(#1696)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.37.1 to 2.38.0
(#1697)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.1
(#1702)**
- **proto: document the `cometbft.*` versioned protos (#1694)**
- **Clean up changelog entries and README files for versioned proto
changes (#1707)**
- **chore(proto): add missing docs (#1703)**
- **feature/proto-upgrade: Last-minute fixes (#1709)**
- **e2e: Support emulated latencies between docker images (#1560)**
- **build(deps): Bump golang.org/x/net from 0.14.0 to 0.17.0 in /api
(#1713)**
- **Prepare `main` for `v1.x` backport branch (#1714)**
- **build(deps): Bump golang.org/x/crypto from 0.15.0 to 0.16.0
(#1720)**
- **build(deps): Bump golang.org/x/net from 0.18.0 to 0.19.0 (#1719)**
- **types: validate Validator#Address field (#1715)**
- **Enable Mergify backports for `v1.x` branch (#1724)**
- **deps: Bump cometbft-db to v0.9.0 (#1725)**
- **buf improvements prior to publishing on BSR (#1726)**
- **proto: give our buf module a name (#1734)**
- **deps: Bump cometbft-db to v0.9.1 (#1737)**
- **chore: Update root docs (#1740)**
- **fix: increase abci socket message size limit to 2GB (#1730)**
- **proto: make comment in README more Markdowny (#1743)**
- **fix: Txs Validate (#1687)**
- **Add test missing in #1687 (#1712)**
- **perf(state): batch save `State` (#1735)**
- **Update CODE_OF_CONDUCT.md (#1708)**
- **[e2e] Fixes prepareProposal not to return oversized set of
transactions (#1756)**
- **perf(store): Batch save `Block` (#1755)**
- **Fix: Fix minor typos (#1780)**
- **`VerifyCommitLight` and `VerifyCommitLightTrusting` _never_ check
all signatures (#1750)**
- **Fix typo in encoding.md (#1801)**
- **chore(docs): small improvements (#1781)**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.10.1 to 5.11.0
(#1797)**
- **build(deps): Bump actions/setup-go from 4 to 5 (#1794)**
- **build(deps): Bump actions/stale from 8 to 9 (#1795)**
- **build(deps): Bump github.com/spf13/viper from 1.17.0 to 1.18.1
(#1796)**
- **Chore/fix other typos (#1809)**
- **chore(spec): specify which fields must be deterministic (#1804)**
- **Small improvements in #1806 not present in #1750 (#1808)**
- **Add changelog for #1749 (#1807)**
- **e2e: Implement latency emulation for DigitalOcean (#1587)**
- **add GH workflow for linting code using codespell (#1824)**
- **chore(docs): explain the effect of `timeout_propose` (#1798)**
- **build(deps): Bump actions/upload-artifact from 3 to 4 (#1845)**
- **build(deps): Bump actions/setup-python from 2 to 5 (#1843)**
- **build(deps): Bump github/codeql-action from 2 to 3 (#1847)**
- **build(deps): Bump actions/checkout from 2 to 4 (#1846)**
- **build(deps): Bump github.com/google/uuid from 1.4.0 to 1.5.0
(#1850)**
- **build(deps): Bump google.golang.org/grpc from 1.59.0 to 1.60.0
(#1851)**
- **golangci-lint: enable all the linters by default (#1838)**
- **Updates go crypto package to v0.17.0 (#1859)**
- **Adds checks for nil keys and signatures (#1855)**
- **The store DB and the companion `BlockStore` struct are sometimes out
of sync (#1856)**
- **Allow blocksync to not verify all signatures (#1858)**
- **Fixing the ABCI grammar and updating the code for e2e tests to
account for the new grammar. (#1829)**
- **docs: Fix Discord links in README (#1874)**
- **build(deps): Bump github.com/prometheus/client_golang (#1909)**
- **build(deps): Bump github.com/btcsuite/btcd/btcutil from 1.1.3 to
1.1.5 (#1908)**
- **build(deps): Bump google.golang.org/protobuf (#1885)**
- **build(deps): Bump github.com/spf13/viper from 1.18.1 to 1.18.2
(#1884)**
- **build(deps): Bump google.golang.org/grpc from 1.60.0 to 1.60.1
(#1883)**
- **remove unused linters that produced a warning and ensure that
unparam is enabled (#1905)**
- **Fix HTTP response body not being closed after reading (#1945)**
- **Disable undesired linting code (#1959)**
- **Extend kvstore example add with with key types (#1876)**
- **Extra check in `VerifyExtension` (#1877)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.38.0 to 2.39.1
(#1882)**
- **perf(crypto/merkle, crypto/tmhash): simplify+optimize SHA256 hashing
of multiple byteslices (#1921)**
- **Update localnet-start Makefile (#1975)**
- **blocksync: wait for poolRoutine to stop in (*Reactor).OnStop
(#1879)**
- **fix TestListenerTimeoutReadWrite (#1947)**
- **docs: fix typos (#1988)**
- **this is the kindest commit I can think of. Take it that way and read
the code. (#1987)**
- **there's really no need for this anymore (#1986)**
- **feat: DefaultHttpClient support setting proxy from env (#1900)**
- **feat: lint tests (#1906)**
- **chore: fix typos (#1991)**
- **build(deps): Bump golang.org/x/sync from 0.5.0 to 0.6.0 (#1992)**
- **feat(proxy): export errors (#1899)**
- **doc:fix broken link in DOCKER/README.md (#1996)**
- **feat: custom dependencies order (#1994)**
- **PBTS: migrating to `main` the new version of the specification
(#1973)**
- **Fix paths to scripts/metricsgen in go:generate commands (#1998)**
- **chore: fix some typos (#2002)**
- **docs(light): fix broken link to spec (#2007)**
- **chore(test/loadtime): replace tm-load-test w/ cometbft-load-test
(#2009)**
- **ci: Remove unused `tests` target when compiling e2e (#2022)**
- **spec: fix typo in `encoding.md` (#2024)**
- **mempool: Fix data races in CListMempool's height and
notifiedTxsAvailable (#2021)**
- **chore(test/loadtime): cleanup go.sum and golangci.yml (#2025)**
- **build(deps): Bump github.com/prometheus/common from 0.45.0 to 0.46.0
(#2040)**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.39.1 to 2.40.1
(#2038)**
- **feat(rpc): Use default port for HTTP(S) URLs when there is no
explicit port (#1903)**
- **misc(go.mod): remove unused peg dependency (#2044)**
- **config: Remove unused `max_batch_bytes` (#2050)**
- **Merge pull request from GHSA-qr8r-m495-7hc4**
- **misc(tools)!: remove `tools` package (#2046)**
- **docs(guides): add missing import (#2070)**
- **deps(localnode): bump alpine version (#2077)**
- **misc(Makefile): add `help` target to display the help msg (#2074)**
- **`e2e`: test vote extension activation via `InitChain` and
`FinalizeBlock` (#2066)**
- **scripts: metricsgen parses '// metrics:' pattern (#2090)**
- **e2e: Add `load_max_txs` option to manifest (#2094)**
- **consensus: Add `chain_size_bytes` metric (#2093)**
- **feat: conventional commits (#1995)**
- **Forward port of tendermint/tendermint#7605, tendermint/spec#393, and
tendermint/tendermint#8142 (#2018)**
- **ci: fix permissions for \"Conventional PR Title\" (#2099)**
- **PBTS: additions and fixes on migrated spec (#2013)**
- **PBTS: forward port of tendermint/tendermint#7709 (#2089)**
- **feat: use go workspace (#1924)**
- **fix: `ValidateUpdate`: allow no-change updates regardless of current
height (#2112)**
- **test(localnet): Add monitoring tools for localnet (#2108)**
- **feat: add gofumpt (#2049)**
- **feat(consensus): increase log level for corner case when prevoting a
proposal (#2042)**
- **docs: v1 - diataxis framework (#2105)**
- **feat(consensus): additional sanity checks for the size of proposed
blocks (#1408)**
- **perf(internal/blocksync): avoid double-calling
`types.BlockFromProto` (#2016)**
- **build(deps): Bump google.golang.org/grpc from 1.60.1 to 1.61.0
(#2178)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.1 to 1.29.0
(#2161)**
- **build(deps): Bump styfle/cancel-workflow-action from 0.12.0 to
0.12.1 (#2160)**
- **build(deps): Bump slackapi/slack-github-action from 1.24.0 to 1.25.0
(#2162)**
- **build(deps): Bump github.com/google/uuid from 1.5.0 to 1.6.0
(#2176)**
- **refactor(privval): reverse conditional + more idiomatic Go code with
early returns (#2156)**
- **fix(e2e): path to latency script files in DO (#2148)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.9.1 to
0.10.0 (#2175)**
- **chore(Makefile): add `setup-pre-commit` target to init git hook
(#2123)**
- **feat: add pebbledb (https://github.com/cockroachdb/pebble) (#2132)**
- **perf(internal/blocksync): do not `ValidateBlock` twice (#2026)**
- **feat(e2e): Add new targets `fast` and `clean` to Makefile (#2192)**
- **ci: add `spec` type in conventional-pr-title (#2191)**
- **fix(privval): retry accepting a connection on errors (#2047)**
- **fix(.github/workflows): correct parameters to lint_pr_title
(#2199)**
- **docs: update QA method steps for qa-infra changes (#2198)**
- **feat!(pbts): forward port of tendermint/tendermint#7711 (#2149)**
- **docs(pbts): forward port of PBTS documentation and fixes (#2124)**
- **fix: if-return and early-return (#2215)**
- **chore: remove amazon linux Dockerfile and update
test/docker/Dockerfile (#2135)**
- **feat(ci): pre-commit framework (#2214)**
- **ci: add `merge` type for conventional-pr-title (#2219)**
- **spec(consensus/pbts): update description for introduced parameters.
(#2206)**
- **perf: optimize psql indexer (#2142)**
- **fix(go.mod): do not use `replace` for api (#2236)**
- **fix(Makefile): gofumpt no longer needed (#2235)**
- **fix(p2p/pex): gracefully shutdown `Reactor` (#2010)**
- **test(mempool): fix
TestMempoolUpdateDoesNotPanicWhenApplicationMissedTx (#2242)**
- **fix(flowrate): fix non-determinism in flowrate tests (#2147)**
- **refactor!: Implement RFC 106: remove `GetLatestBlock*` methods from
data companion API (#2240)**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.3 to 1.3.7
(#2253)**
- **chore(config): update DB section in toml.go (#2249)**
- **fix(consensus): do not precommit nil if proposal block is received
(#2221)**
- **build(deps): Bump github.com/opencontainers/runc from 1.1.5 to
1.1.12 (#2261)**
- **fix(mempool/tests): Reduce tests duration (#2263)**
- **ci: run golangci-lint linters for all files (not only ones which
were modified) (#2250)**
- **refactor(examples): small changes to kvstore app (#2267)**
- **refactor(mempool): simplify parameters of resCbFirstTime and
resCbRecheck (#2272)**
- **perf(mempool/cache): clear map in Reset (#2259)**
- **test(abci): update e2e tests to check against ABCI 2.0 grammar
(#2201)**
- **docs: symbolic references to steps in the qa-infra README (#2280)**
- **chore: updated doc link (#2296)**
- **fix(consensus): prevote nil upon timeout when Proposal is missing
(#2218)**
- **build(deps): Bump pre-commit/action from 3.0.0 to 3.0.1 (#2307)**
- **build(deps): Bump golang.org/x/net from 0.20.0 to 0.21.0 (#2300)**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.10.0 to
0.11.0 (#2299)**
- **docs: ADR-112 Proposer-Based Timestamps (#2223)**
- **refactor(internal/statesync): replace ticker with `time.After(X)`
(#2294)**
- **fix: simultaneous rpc test failures (#2150)**
- **chore(docs): alter the section about the effects of `timeout_commit`
(#1892)**
- **refactor(p2p)!: Refactor PeerSet to eliminate data races & improve
performance (#2246)**
- **feat(pbts): Update consensus params to include pbts enabled
(#2231)**
- **feat(storage/metrics): Metrics to measure storage (#1974)**
- **feat(e2e): Log number of sent txs (success and failed) (#2328)**
- **chore: enable gomoddirectives, unparam (#2290)**
- **docs: images not rendering properly in docs (#2331)**
- **docs: Fix references about DeliverTx (#2330)**
- **docs(qa): Add table of contents to existing QA reports (#2343)**
- **chore: enable perfsprint linter (#2291)**
- **feat(pruning): trigger explicitly compaction upon pruning (#1972)**
- **docs: explain how to skip pre-commit hook (#2358)**
- **build(deps): Bump github.com/prometheus/common from 0.46.0 to 0.47.0
(#2373)**
- **build(deps): Bump google.golang.org/grpc from 1.61.0 to 1.61.1
(#2372)**
- **feat(e2e): Option to set max block size in bytes at genesis
(#2362)**
- **build(deps): Bump github.com/prometheus/client_model from 0.5.0 to
0.6.0 (#2371)**
- **revert(pbts): revert removal of BFT Time related functions (#2205)**
- **fix(e2e): Reduce flakiness of TestGRPC_GetBlockResults (#2367)**
- **spec(consensus): update Block Time documentation in spec (#2316)**
- **spec: adaptive MSGDELAY parameter included in PBTS spec (#2318)**
- **feat(pbts): Moving VoteExtensionsEnableHeight from ABCIParams to
FeatureParams. (#2335)**
- **fix: remove TestMempoolFIFOWithParallelCheckTx (#2364)**
- **fix(docker-compose): fix subnet (#2383)**
- **feat(pbts): enable `e2e` manifest config to set `PbtsEnableHeight`
(#2284)**
- **perf(internal/state): avoid double-saving FinalizeBlockResponse
(#2017)**
- **build(deps): Bump fonttools from 4.37.4 to 4.43.0 in
/scripts/qa/reporting (#2407)**
- **build(deps): Bump pillow from 10.0.1 to 10.2.0 in
/scripts/qa/reporting (#2408)**
- **fix(node): Forward compaction config params to blockstore
constructor (#2418)**
- **refactor!: moved `MedianTime` out of `internal` folder (#2397)**
- **chore: typo fixes (#2403)**
- **chore(pbts): Removes useless code (#2420)**
- **build(deps): Bump github.com/prometheus/common from 0.47.0 to 0.48.0
(#2430)**
- **build(deps): Bump google.golang.org/grpc from 1.61.1 to 1.62.0
(#2429)**
- **test(consensus): PBTS should be enabled by default in test units
(#2329)**
- **test(consensus): test enabling PBTS at a given height (#2404)**
- **refactor(protobuf): switch from gogofaster to gocosmos generator
(#2425)**
- **docs(tutorials/install): add `From Go package` (#2414)**
- **docs(pbts): documentation for PBTS-related consensus parameters
(#2376)**
- **refactor(consensus): print err from SignAndCheckVote (#2346)**
- **feat(e2e): add parameter to set a custom output directory for
testnet files (#2433)**
- **spec(consensus): update description of consensus parameters for PBTS
(#2415)**
- **fix(localnet): Grafana dashboards for storage tests - removed
experimental metrics (#2448)**
- **fix(jsonrpc): enable HTTP basic auth in WS client (#2434)**
- **feat(pbts): Adds timestamp to the `msgInfo` written into the WAL
(#2388)**
- **fix: `Rollback`: wrong modification of
`state.LastHeightValidatorsChanged` while rollback at a special height
(#2136)**
- **docs(changelog): add missing entry for #2136 (#2459)**
- **fix(pbts): legacy `ABCIParams` values are properly translated to
`FeatureParams` values (#2462)**
- **fix(e2e): Fixing the bug in ABCI e2e tests (#2468)**
- **feat(localnet): Grafana PNG rendering for easier graph exports
(#2472)**
- **docs(README): remove Terra (#2469)**
- **docs: document PBTS adaptive delays mechanism (#2452)**
- **fix(config): Moved compact variables to the right section (#2477)**
- **feat(metrics): more buckets for ProposalTimestampDifference
(#2479)**
- **fix(metrics): more buckets for ProposalTimestampDifference (#2481)**
- **feat(pbts): Make synchrony params adaptive (#2431)**
- **ci: check metrics generation in CI checks (#2483)**
- **feat(consensus): improve logging for timely and untimely messages
(#2321)**
- **feat(types): improve Proposal and SynchronyParams validation tests
(#2489)**
- **test(consensus): refactor TestStateLock_POLSafety tests (#2492)**
- **feat(types): refactor types.AdaptiveSynchronyParams method (#2490)**
- **fix: lint errors introduced with the latest merge (#2495)**
- **build(deps): Bump docker/setup-buildx-action from 3.0.0 to 3.1.0
(#2500)**
- **build(deps): Bump github.com/prometheus/client_golang from 1.18.0 to
1.19.0 (#2508)**
- **build(deps): Bump golang.org/x/crypto from 0.19.0 to 0.20.0
(#2507)**
- **build(deps): Bump github.com/prometheus/common from 0.48.0 to 0.49.0
(#2506)**
- **build(deps): Bump github.com/stretchr/testify from 1.8.4 to 1.9.0
(#2505)**
- **fix(docs): include `timesync` daemon instructions (#2491)**
- **feat(privval)!: DO NOT require extension signature (#2496)**
- **refactor(privval): rename sign_extension to skip_sign_extension
(#2519)**
- **spec(abci): fixes the spec to inform about the presence of invalid
extensions in `last_commit` (#2423)**
- **fix(pbts): block Time must be Canonical (#2493)**
- **feat(e2e): Add manifest option `clock_skew` and corresponding
backend functionality (#2454)**
- **fix(mempool): converting to uint64 before additions to avoid
overflows (#2498)**
- **refactor!: Rename `skip_sign_extension` to `skip_extension_signing`
(#2522)**
- **docs(ADR): ADR-108 updated to account for the new changes in the
grammar and code. (#2528)**
- **feat(e2e): add generator support for clock skew + env variable
rename (#2488)**
- **spec(proto): add `cometbft.privval.v1beta2` proto package (#2529)**
- **chore: improving error handling in the PendingEvidence (#2550)**
- **feat(blocksync)!: set the max number of (concurrently) downloaded
blocks to {peersCount * 20} (#2467)**
- **build(deps): Bump bufbuild/buf-setup-action from 1.29.0 to 1.30.0
(#2557)**
- **build(deps): Bump google.golang.org/protobuf from 1.32.0 to 1.33.0
(#2560)**
- **build(deps): Bump golang.org/x/net from 0.21.0 to 0.22.0 (#2562)**
- **fix(cmd/cometbft/commands/version): update the output for v1
(#2546)**
- **build(deps): Bump docker/build-push-action from 5.1.0 to 5.2.0
(#2558)**
- **build(deps): Bump github.com/prometheus/common from 0.49.0 to 0.50.0
(#2559)**
- **build(deps): Bump google.golang.org/grpc from 1.62.0 to 1.62.1
(#2563)**
- **build(deps): Bump golang.org/x/crypto from 0.20.0 to 0.21.0
(#2561)**
- **feat(blocksync): sort peers by download rate & multiple requests for
closer blocks (#2475)**
- **feat(pbts): Adjusts PBTS metrics buckets (#2578)**
- **fix(blocksync): use timer instead of time.After (#2584)**
- **fix: temporary fix for `api` dependency (#2589)**

---------

Signed-off-by: Thane Thomson <connect@thanethomson.com>
Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Thane Thomson <connect@thanethomson.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Anton Kaliaev <anton.kalyaev@gmail.com>
Co-authored-by: Mikhail Zabaluev <mikhail@informal.systems>
Co-authored-by: Troy Kessler <43882936+troykessler@users.noreply.github.com>
Co-authored-by: leven <112051166+lx-xiang@users.noreply.github.com>
Co-authored-by: werty144 <anton-paramonov2000@yandex.ru>
Co-authored-by: Adi Seredinschi <adizere@gmail.com>
Co-authored-by: Sukey <35202440+sukey2008@users.noreply.github.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
Co-authored-by: Jasmina Malicevic <jasmina.dustinac@gmail.com>
Co-authored-by: moriluka <85185077+moriluka@users.noreply.github.com>
Co-authored-by: ƒê·ªó Vi·ªát Ho√†ng <hoangdv2429@gmail.com>
Co-authored-by: alex <152680487+azukiboy@users.noreply.github.com>
Co-authored-by: Hern√°n Vanzetto <15466498+hvanz@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@informal.systems>
Co-authored-by: Andy Nogueira <me@andynogueira.dev>
Co-authored-by: nenadmilosevic95 <50905385+nenadmilosevic95@users.noreply.github.com>
Co-authored-by: nenadmilosevic95 <nenad@informal.systems>
Co-authored-by: Jacob Gadikian <jacobgadikian@gmail.com>
Co-authored-by: Greg Szabo <16846635+greg-szabo@users.noreply.github.com>
Co-authored-by: Emmanuel T Odeke <emm.odeke@gmail.com>
Co-authored-by: jchappelow <140431406+jchappelow@users.noreply.github.com>
Co-authored-by: shuoer86 <129674997+shuoer86@users.noreply.github.com>
Co-authored-by: levisyin <150114626+levisyin@users.noreply.github.com>
Co-authored-by: vuittont60 <81072379+vuittont60@users.noreply.github.com>
Co-authored-by: Halimao <1065621723@qq.com>
Co-authored-by: alex <152680487+bodhi-crypo@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@usi.ch>
Co-authored-by: Josef Widder <44643235+josef-widder@users.noreply.github.com>
Co-authored-by: William Banfield <4561443+williambanfield@users.noreply.github.com>
Co-authored-by: Kukovec <jure.kukovec@gmail.com>
Co-authored-by: Daniel Cason <cason@gandria>
Co-authored-by: M. J. Fromberger <fromberger@interchain.io>
Co-authored-by: hattizai <150505746+hattizai@users.noreply.github.com>
Co-authored-by: Huulu <35667132+IssouChancla@users.noreply.github.com>
Co-authored-by: katelyn martin <me+cratelyn@katelyn.world>
Co-authored-by: Richard Gibson <richard.gibson@gmail.com>
Co-authored-by: Jean Deruelle <jean.deruelle@gmail.com>
Co-authored-by: glnro <8335464+glnro@users.noreply.github.com>
Co-authored-by: Greg Szabo <greg@philosobear.com>
Co-authored-by: Emmanuel T Odeke <emmanuel@orijtech.com>
Co-authored-by: levisyin <lilassherl@gmail.com>
Co-authored-by: k0marov <95040709+k0marov@users.noreply.github.com>
Co-authored-by: Adi Seredinschi <a@seredinschi.net>
Co-authored-by: Pan chao <152830401+Pan-chao@users.noreply.github.com>
Co-authored-by: Khanh Hoa <49144992+hoanguyenkh@users.noreply.github.com>
Co-authored-by: glnro <lauren@informal.systems>
Co-authored-by: toni <143221387+xyztoni@users.noreply.github.com>
Co-authored-by: DragonKid <idragonkid@gmail.com>
Co-authored-by: Matt Ketmo <matthieu@moquet.net>
Co-authored-by: Ethan <cosinlinker@gmail.com>
Co-authored-by: Evgeny Danilenko <6655321@bk.ru>
Co-authored-by: Duong Minh Ngoc <153509244+minhngoc274@users.noreply.github.com>
Co-authored-by: Kero <keroroxx520@gmail.com>")`
‚Ä¶

`[e7dd0ab](/cometbft/cometbft/commit/e7dd0ab89fc3783d3de30f2c5fb892f9ca072ba2)`

```
- **Versioned protobuf files ([#495](https://github.com/cometbft/cometbft/pull/495))**
- **Restore rpc/grpc/v1/types.pb.go**
- **proto: restore deprecation notice on BroadcastAPI**
- **Struct `Client` exposes sensitive data ([#784](https://github.com/cometbft/cometbft/pull/784))**
- **Unsafe int cast in `kill` command ([#783](https://github.com/cometbft/cometbft/pull/783))**
- **ADR-100: Data Companion Push API ([#73](https://github.com/cometbft/cometbft/pull/73))**
- **rfc: incoming txs while catching up ([#735](https://github.com/cometbft/cometbft/pull/735))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.17.0 to 1.18.0
([#804](https://github.com/cometbft/cometbft/pull/804))**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.8 to 1.4.9
([#806](https://github.com/cometbft/cometbft/pull/806))**
- **build(deps): Bump golang.org/x/sync from 0.1.0 to 0.2.0 ([#807](https://github.com/cometbft/cometbft/pull/807))**
- **build(deps): Bump google.golang.org/grpc from 1.54.0 to 1.55.0
([#813](https://github.com/cometbft/cometbft/pull/813))**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.0 to
1.15.1 ([#810](https://github.com/cometbft/cometbft/pull/810))**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
([#809](https://github.com/cometbft/cometbft/pull/809))**
- **build(deps): Bump github.com/bufbuild/buf from 1.17.0 to 1.18.0
([#809](https://github.com/cometbft/cometbft/pull/809))**
- **build(deps): Bump github.com/prometheus/client_model from 0.3.0 to
0.4.0 ([#812](https://github.com/cometbft/cometbft/pull/812))**
- **build(deps): Bump github.com/prometheus/common from 0.42.0 to 0.43.0
([#811](https://github.com/cometbft/cometbft/pull/811))**
- **ADR-103: Protobuf definition versioning ([#772](https://github.com/cometbft/cometbft/pull/772))**
- **spec/p2p: Specify the operation of a Reactor ([#714](https://github.com/cometbft/cometbft/pull/714))**
- **build(deps): Bump github.com/docker/distribution ([#827](https://github.com/cometbft/cometbft/pull/827))**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.1 to 1.3.3
([#828](https://github.com/cometbft/cometbft/pull/828))**
- **ADR-103: Protobuf definition versioning ([#772](https://github.com/cometbft/cometbft/pull/772)) ([#817](https://github.com/cometbft/cometbft/pull/817))**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.9 to 1.4.10
([#830](https://github.com/cometbft/cometbft/pull/830))**
- **build(deps): Bump golang.org/x/net from 0.9.0 to 0.10.0 ([#831](https://github.com/cometbft/cometbft/pull/831))**
- **build(deps): Bump golang.org/x/crypto from 0.8.0 to 0.9.0 ([#832](https://github.com/cometbft/cometbft/pull/832))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.26.1 to 2.27.1
([#833](https://github.com/cometbft/cometbft/pull/833))**
- **rpc: Remove response data from response failure logs ([#829](https://github.com/cometbft/cometbft/pull/829))**
- **pubsub/kvindexer:support for big numbers - v2 ([#797](https://github.com/cometbft/cometbft/pull/797))**
- **Extend the infrastructure provider with `StartNodes` and
`StopTestnet` ([#796](https://github.com/cometbft/cometbft/pull/796))**
- **grpc: Add base gRPC server with version service ([#818](https://github.com/cometbft/cometbft/pull/818))**
- **Digital Ocean implementation of `StartNodes` and `StopTestnet`
([#846](https://github.com/cometbft/cometbft/pull/846))**
- **RFC 102: Improve forward compatibility of proto-generated Rust
([#724](https://github.com/cometbft/cometbft/pull/724))**
- **mempool: Add metric to measure how many times a tx was received
([#637](https://github.com/cometbft/cometbft/pull/637))**
- **`e2e` provider is extended with `Disconnect`, `Reconnect` and
`CheckUpgraded` ([#852](https://github.com/cometbft/cometbft/pull/852))**
- **Sort `loadtime` tool's report ([#854](https://github.com/cometbft/cometbft/pull/854))**
- **feat: make handshake cancelable ([#857](https://github.com/cometbft/cometbft/pull/857))**
- **proto: Restore snake_case JSON for `ExecTxResult` ([#856](https://github.com/cometbft/cometbft/pull/856))**
- **qa: 200-nodes test on v0.38 ([#877](https://github.com/cometbft/cometbft/pull/877))**
- **qa: rotating node test on `v0.38.x` ([#883](https://github.com/cometbft/cometbft/pull/883))**
- **Changes to QA related files (e.g., `method.md`) ([#878](https://github.com/cometbft/cometbft/pull/878))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.18.0 to 1.19.0
([#868](https://github.com/cometbft/cometbft/pull/868))**
- **build(deps): Bump github.com/stretchr/testify from 1.8.2 to 1.8.3
([#873](https://github.com/cometbft/cometbft/pull/873))**
- **build(deps): Bump github.com/bufbuild/buf from 1.18.0 to 1.19.0
([#872](https://github.com/cometbft/cometbft/pull/872))**
- **Adds `vote_extension_size` to manifests ([#858](https://github.com/cometbft/cometbft/pull/858))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.27.1 to 2.28.1
([#893](https://github.com/cometbft/cometbft/pull/893))**
- **build(deps): Bump github.com/prometheus/common from 0.43.0 to 0.44.0
([#892](https://github.com/cometbft/cometbft/pull/892))**
- **build(deps): Bump slackapi/slack-github-action from 1.23.0 to 1.24.0
([#869](https://github.com/cometbft/cometbft/pull/869))**
- **ADR 104: State sync from local application snapshot ([#801](https://github.com/cometbft/cometbft/pull/801))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0
([#891](https://github.com/cometbft/cometbft/pull/891))**
- **mempool: slight refactor for improving readability ([#894](https://github.com/cometbft/cometbft/pull/894))**
- **Add Vote Extension varying size testnet ([#888](https://github.com/cometbft/cometbft/pull/888))**
- **fix: lint fail when golangci-lint bump from v1.52.2 to v1.53.x
([#908](https://github.com/cometbft/cometbft/pull/908))**
- **build(deps): Bump github.com/bufbuild/buf from 1.19.0 to 1.20.0
([#912](https://github.com/cometbft/cometbft/pull/912))**
- **build(deps): Bump github.com/golangci/golangci-lint ([#917](https://github.com/cometbft/cometbft/pull/917))**
- **build(deps): Bump github.com/spf13/viper from 1.15.0 to 1.16.0
([#913](https://github.com/cometbft/cometbft/pull/913))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.19.0 to 1.20.0
([#910](https://github.com/cometbft/cometbft/pull/910))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.1 to 2.28.2
([#914](https://github.com/cometbft/cometbft/pull/914))**
- **Minor fixes to `RELEASES.md` ([#923](https://github.com/cometbft/cometbft/pull/923))**
- **Prevent a transaction to appear twice in the mempool ([#890](https://github.com/cometbft/cometbft/pull/890))**
- **New metrics to track duplicate votes and block parts ([#896](https://github.com/cometbft/cometbft/pull/896)) ([#905](https://github.com/cometbft/cometbft/pull/905))**
- **e2e tests are being skipped; `INFRASTRUCTURE-*` bug; portGen
inconsistency bug ([#933](https://github.com/cometbft/cometbft/pull/933))**
- **build(deps): Bump github.com/bufbuild/buf from 1.20.0 to 1.21.0
([#948](https://github.com/cometbft/cometbft/pull/948))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.20.0 to 1.21.0
([#946](https://github.com/cometbft/cometbft/pull/946))**
- **spec/p2p: document the p2p API used by Reactors ([#851](https://github.com/cometbft/cometbft/pull/851))**
- **build(deps): Bump docker/login-action from 2.1.0 to 2.2.0 ([#944](https://github.com/cometbft/cometbft/pull/944))**
- **e2e: Generate prometheus.yaml on setup ([#954](https://github.com/cometbft/cometbft/pull/954))**
- **Update the type annotations in the light client spec ([#955](https://github.com/cometbft/cometbft/pull/955))**
- **build(deps): Bump docker/build-push-action from 4.0.0 to 4.1.0
([#947](https://github.com/cometbft/cometbft/pull/947))**
- **build(deps): Bump docker/setup-buildx-action from 2.5.0 to 2.7.0
([#962](https://github.com/cometbft/cometbft/pull/962))**
- **Add requirement for `CheckTx` in ABCI spec ([#928](https://github.com/cometbft/cometbft/pull/928))**
- **fix: avoid recursive call after rename to (*PeerState).MarshalJSON
([#865](https://github.com/cometbft/cometbft/pull/865))**
- **Port upstream proto changes to cometbft package**
- **changelog: Import entries for v0.34.28, v0.34.29, v0.37.1 and
v0.37.2 to `main` ([#974](https://github.com/cometbft/cometbft/pull/974))**
- **test/e2e: Fix Docker image build ([#984](https://github.com/cometbft/cometbft/pull/984))**
- **build(deps): Bump github.com/BurntSushi/toml from 1.3.0 to 1.3.2
([#952](https://github.com/cometbft/cometbft/pull/952))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.28.2 to 2.29.0
([#953](https://github.com/cometbft/cometbft/pull/953))**
- **Remove duplicate function `deterministicExecTxResult` ([#986](https://github.com/cometbft/cometbft/pull/986))**
- **mempool: Fix the benchmarks ([#934](https://github.com/cometbft/cometbft/pull/934))**
- **Add `CMT_HOME` (or remove it?) ([#983](https://github.com/cometbft/cometbft/pull/983))**
- **Remove buf.yaml at the root of the source tree ([#979](https://github.com/cometbft/cometbft/pull/979))**
- **build(deps): Bump docker/build-push-action from 4.1.0 to 4.1.1
([#989](https://github.com/cometbft/cometbft/pull/989))**
- **build(deps): Bump golang.org/x/net from 0.10.0 to 0.11.0 ([#994](https://github.com/cometbft/cometbft/pull/994))**
- **build(deps): Bump golang.org/x/sync from 0.2.0 to 0.3.0 ([#990](https://github.com/cometbft/cometbft/pull/990))**
- **build(deps): Bump google.golang.org/grpc from 1.55.0 to 1.56.0
([#992](https://github.com/cometbft/cometbft/pull/992))**
- **build(deps): Bump github.com/golangci/golangci-lint from 1.53.2 to
1.53.3 ([#996](https://github.com/cometbft/cometbft/pull/996))**
- **build(deps): Bump github.com/prometheus/client_golang from 1.15.1 to
1.16.0 ([#991](https://github.com/cometbft/cometbft/pull/991))**
- **spec/p2p: new structure for the p2p specification ([#966](https://github.com/cometbft/cometbft/pull/966))**
- **consensus: optimize vote and block part gossip with
HasProposalBlockPartMessage and random sleeps ([#904](https://github.com/cometbft/cometbft/pull/904))**
- **Extend ABCI `max_block_size` parameter to give extended control to
the app ([#1003](https://github.com/cometbft/cometbft/pull/1003))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.21.0 to 1.22.0
([#1026](https://github.com/cometbft/cometbft/pull/1026))**
- **Bump logs on non-fatal vote validation failures to Info level
([#1022](https://github.com/cometbft/cometbft/pull/1022))**
- **Update codeowners to include DevRel team ([#1023](https://github.com/cometbft/cometbft/pull/1023))**
- **deps: Manually bump github.com/vektra/mockery/v2 from 2.29.0 to
2.30.1 ([#1009](https://github.com/cometbft/cometbft/pull/1009))**
- **Update releasing.md to sign tags ([#1034](https://github.com/cometbft/cometbft/pull/1034))**
- **build(deps): Bump github.com/bufbuild/buf from 1.21.0 to 1.22.0
([#1027](https://github.com/cometbft/cometbft/pull/1027))**
- **Rename ABCI enums and values to satisfy buf guidelines ([#975](https://github.com/cometbft/cometbft/pull/975))**
- **build(deps): Bump google.golang.org/grpc from 1.56.0 to 1.56.1
([#1028](https://github.com/cometbft/cometbft/pull/1028))**
- **docs: Added double quotes to /abci_query path param ([#1015](https://github.com/cometbft/cometbft/pull/1015))**
- **Update Docs with Finalize Block ([#760](https://github.com/cometbft/cometbft/pull/760))**
- **Clarifies that processProposal may be called for set of transactions
different from the one returned in the preceding prepareProposal
([#1033](https://github.com/cometbft/cometbft/pull/1033))**
- **Update the annotation of part_set.go ([#1056](https://github.com/cometbft/cometbft/pull/1056))**
- **build(deps): Bump docker/setup-buildx-action from 2.7.0 to 2.8.0
([#1071](https://github.com/cometbft/cometbft/pull/1071))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.1 to
2.30.16 ([#1064](https://github.com/cometbft/cometbft/pull/1064))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.22.0 to 1.23.1
([#1072](https://github.com/cometbft/cometbft/pull/1072))**
- **build(deps): Bump github.com/bufbuild/buf from 1.22.0 to 1.23.1
([#1066](https://github.com/cometbft/cometbft/pull/1066))**
- **build(deps): Bump google.golang.org/protobuf from 1.30.0 to 1.31.0
([#1065](https://github.com/cometbft/cometbft/pull/1065))**
- **build(deps): Bump google.golang.org/grpc from 1.56.1 to 1.56.2
([#1101](https://github.com/cometbft/cometbft/pull/1101))**
- **build(deps): Bump golang.org/x/crypto from 0.10.0 to 0.11.0
([#1103](https://github.com/cometbft/cometbft/pull/1103))**
- **build(deps): Bump docker/setup-buildx-action from 2.8.0 to 2.9.0
([#1105](https://github.com/cometbft/cometbft/pull/1105))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.30.16 to
2.31.1 ([#1100](https://github.com/cometbft/cometbft/pull/1100))**
- **build(deps): Bump golang.org/x/net from 0.11.0 to 0.12.0 ([#1102](https://github.com/cometbft/cometbft/pull/1102))**
- **ci: Trigger workflows on merge group ([#1118](https://github.com/cometbft/cometbft/pull/1118))**
- **Revert "config: add bootstrap peers (#9680)" ([#1109](https://github.com/cometbft/cometbft/pull/1109))**
- **node: Revert removal of public reactor accessors ([#1120](https://github.com/cometbft/cometbft/pull/1120))**
- **ci: Disable CodeQL check in merge queues ([#1123](https://github.com/cometbft/cometbft/pull/1123))**
- **p2p: Remove UPnP functionality ([#1114](https://github.com/cometbft/cometbft/pull/1114))**
- **ADR 107: Rename proto versions to pre-v1 betas ([#1110](https://github.com/cometbft/cometbft/pull/1110))**
- **RFC 104: Internal messaging using the actor model ([#1092](https://github.com/cometbft/cometbft/pull/1092))**
- **build(deps): Bump github.com/bufbuild/buf from 1.23.1 to 1.24.0
([#1131](https://github.com/cometbft/cometbft/pull/1131))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.31.1 to 2.32.0
([#1132](https://github.com/cometbft/cometbft/pull/1132))**
- **build(deps): Bump docker/setup-buildx-action from 2.9.0 to 2.9.1
([#1133](https://github.com/cometbft/cometbft/pull/1133))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.23.1 to 1.24.0
([#1134](https://github.com/cometbft/cometbft/pull/1134))**
- **spec: Add mempool specification in English and Quint ([#997](https://github.com/cometbft/cometbft/pull/997))**
- **mempool: ADR for refactoring list of senders  ([#1032](https://github.com/cometbft/cometbft/pull/1032))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.24.0 to 1.25.0
([#1157](https://github.com/cometbft/cometbft/pull/1157))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.7.0 to 5.8.0
([#1159](https://github.com/cometbft/cometbft/pull/1159))**
- **build(deps): Bump github.com/bufbuild/buf from 1.24.0 to 1.25.0
([#1160](https://github.com/cometbft/cometbft/pull/1160))**
- **proxy: Rename "unsynchronized" to "connection-synchronized" local
client creator ([#1145](https://github.com/cometbft/cometbft/pull/1145))**
- **mempool: Keep track of senders in reactor instead of implementation
([#1010](https://github.com/cometbft/cometbft/pull/1010))**
- **cmd: Remove `replay` and `replay-console` subcommands ([#1170](https://github.com/cometbft/cometbft/pull/1170))**
- **build(deps): Bump google.golang.org/grpc from 1.56.2 to 1.57.0
([#1181](https://github.com/cometbft/cometbft/pull/1181))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.0 to 5.8.1
([#1180](https://github.com/cometbft/cometbft/pull/1180))**
- **ci: Remove Mergify automerge ([#1182](https://github.com/cometbft/cometbft/pull/1182))**
- **Add gRPC block service ([#1142](https://github.com/cometbft/cometbft/pull/1142))**
- **blocksync: export errors ([#1186](https://github.com/cometbft/cometbft/pull/1186))**
- **Porting changes related to creating a lean docker image from
`pierre/fast-prototyping-1059` branch. ([#1192](https://github.com/cometbft/cometbft/pull/1192))**
- **chore: Format repo ([#1193](https://github.com/cometbft/cometbft/pull/1193))**
- **Add BlockResults gRPC service ([#1168](https://github.com/cometbft/cometbft/pull/1168))**
- **consensus: remove logic to unlock block on +2/3 prevote for nil
([#1175](https://github.com/cometbft/cometbft/pull/1175))**
- **ADR 101: Add GetLatest method to block service ([#1209](https://github.com/cometbft/cometbft/pull/1209))**
- **ADR 101: Implement pruning mechanism ([#1150](https://github.com/cometbft/cometbft/pull/1150))**
- **config: export errors ([#1190](https://github.com/cometbft/cometbft/pull/1190))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.0 to 2.32.3
([#1218](https://github.com/cometbft/cometbft/pull/1218))**
- **Add check for non-`nil` in `enterCommit` ([#1208](https://github.com/cometbft/cometbft/pull/1208))**
- **Log proposer's address when correctly accepting a proposal ([#1079](https://github.com/cometbft/cometbft/pull/1079))**
- **Close evidence.db OnStop ([#1210](https://github.com/cometbft/cometbft/pull/1210))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.0 to 1.25.1
([#1213](https://github.com/cometbft/cometbft/pull/1213))**
- **build(deps): Bump golang.org/x/crypto from 0.11.0 to 0.12.0
([#1215](https://github.com/cometbft/cometbft/pull/1215))**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.0 to 1.25.1
([#1216](https://github.com/cometbft/cometbft/pull/1216))**
- **build(deps): Bump golang.org/x/net from 0.12.0 to 0.14.0 ([#1217](https://github.com/cometbft/cometbft/pull/1217))**
- **Forward-port: update state to prevote `nil` when proposal block does
not match locked block ([#1203](https://github.com/cometbft/cometbft/pull/1203))**
- **mempool: Store peer ids as p2p.ID instead of uint16 (remove
mempoolIDs) ([#1191](https://github.com/cometbft/cometbft/pull/1191))**
- **ADR-101: implement gRPC `PruningService` ([#1154](https://github.com/cometbft/cometbft/pull/1154))**
- **consensus: Avoid process proposal when we know correct nodes
validated it ([#1231](https://github.com/cometbft/cometbft/pull/1231))**
- **ADR-101: Metrics to monitor the pruning  ([#1234](https://github.com/cometbft/cometbft/pull/1234))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.25.1 to 1.26.0
([#1241](https://github.com/cometbft/cometbft/pull/1241))**
- **build(deps): Bump github.com/bufbuild/buf from 1.25.1 to 1.26.1
([#1239](https://github.com/cometbft/cometbft/pull/1239))**
- **build(deps): Bump github.com/golangci/golangci-lint ([#1240](https://github.com/cometbft/cometbft/pull/1240))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.3 to 2.32.4
([#1242](https://github.com/cometbft/cometbft/pull/1242))**
- **abci: export errors  ([#1185](https://github.com/cometbft/cometbft/pull/1185))**
- **consensus: export errors ([#1211](https://github.com/cometbft/cometbft/pull/1211))**
- **ADR-101: Pruning mechanism minor fixes ([#1246](https://github.com/cometbft/cometbft/pull/1246))**
- **chore: Bump minimum Go version on `main` to v1.21 ([#1244](https://github.com/cometbft/cometbft/pull/1244))**
- **ADR 101: Add `Close` method to gRPC client ([#1251](https://github.com/cometbft/cometbft/pull/1251))**
- **ADR 108: ADR for extending E2E infrastructure so that we can check
CometBFT's behaviour with respect to ABCI++ grammar. ([#902](https://github.com/cometbft/cometbft/pull/902))**
- **docs: Add logging guide to contributing guidelines ([#1250](https://github.com/cometbft/cometbft/pull/1250))**
- **chore: log `app_hash` as hex ([#1264](https://github.com/cometbft/cometbft/pull/1264))**
- **update language ([#1263](https://github.com/cometbft/cometbft/pull/1263))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.0 to 1.26.1
([#1272](https://github.com/cometbft/cometbft/pull/1272))**
- **build(deps): Bump gonum.org/v1/gonum from 0.13.0 to 0.14.0 ([#1275](https://github.com/cometbft/cometbft/pull/1275))**
- **build(deps): Bump github.com/cosmos/gogoproto from 1.4.10 to 1.4.11
([#1276](https://github.com/cometbft/cometbft/pull/1276))**
- **ADR 101: Refactor height check-related logic and tests ([#1271](https://github.com/cometbft/cometbft/pull/1271))**
- **Fixed linter**
- **Revert "Fixed linter"**
- **Fixed mem aliasing in for loop ([#1280](https://github.com/cometbft/cometbft/pull/1280))**
- **Remove genesis persistence in state db ([#1017](https://github.com/cometbft/cometbft/pull/1017))**
- **Revert "Remove genesis persistence in state db ([#1017](https://github.com/cometbft/cometbft/pull/1017))" ([#1294](https://github.com/cometbft/cometbft/pull/1294))**
- **evidence: export errors ([#1284](https://github.com/cometbft/cometbft/pull/1284))**
- **Re-implement removal of genesis persistence in state db ([#1295](https://github.com/cometbft/cometbft/pull/1295))**
- **build(deps): Bump docker/setup-buildx-action from 2.9.1 to 2.10.0
([#1298](https://github.com/cometbft/cometbft/pull/1298))**
- **node: verify genesis doc hash against the file contents rather than
remarshalled JSON ([#1293](https://github.com/cometbft/cometbft/pull/1293))**
- **indexer: Implement pruning mechanism ([#1176](https://github.com/cometbft/cometbft/pull/1176))**
- **Provide relevant block data in `ExtendVote` ([#1270](https://github.com/cometbft/cometbft/pull/1270))**
- **node/state:bootstrap state api ([#1057](https://github.com/cometbft/cometbft/pull/1057))**
- **build(deps): Bump actions/checkout from 3 to 4 ([#1319](https://github.com/cometbft/cometbft/pull/1319))**
- **build(deps): Bump docker/build-push-action from 4.1.1 to 4.2.1
([#1318](https://github.com/cometbft/cometbft/pull/1318))**
- **Fix ([#1323](https://github.com/cometbft/cometbft/pull/1323))**
- **state: remove genesis file from database  ([#1297](https://github.com/cometbft/cometbft/pull/1297))**
- **Added changelog for pruning metrics ([#1335](https://github.com/cometbft/cometbft/pull/1335))**
- **Removed begin_block_events and end_block_events from rpc doc
([#1338](https://github.com/cometbft/cometbft/pull/1338))**
- **consensus: test for precommit/locking corner case ([#1257](https://github.com/cometbft/cometbft/pull/1257))**
- **TxIndexer and BlockIndexer pruning metrics ([#1334](https://github.com/cometbft/cometbft/pull/1334))**
- **Forward port changes to changelog and `UPGRADING.md` for release
`v0.38.0` ([#1341](https://github.com/cometbft/cometbft/pull/1341))**
- **Update Go version specified in root README on main for v0.34.x
([#1352](https://github.com/cometbft/cometbft/pull/1352))**
- **Add test/e2e/data to gitignore ([#1349](https://github.com/cometbft/cometbft/pull/1349))**
- **docs: gRPC services and data companion pruning services ([#1307](https://github.com/cometbft/cometbft/pull/1307))**
- **Add genesis_hash flag check on node startup ([#1324](https://github.com/cometbft/cometbft/pull/1324))**
- **gRPC for Tx and Block indexer pruning ([#1327](https://github.com/cometbft/cometbft/pull/1327))**
- **build(deps): Bump docker/build-push-action from 4.2.1 to 5.0.0
([#1371](https://github.com/cometbft/cometbft/pull/1371))**
- **build(deps): Bump docker/setup-buildx-action from 2.10.0 to 3.0.0
([#1370](https://github.com/cometbft/cometbft/pull/1370))**
- **build(deps): Bump docker/login-action from 2.2.0 to 3.0.0 ([#1368](https://github.com/cometbft/cometbft/pull/1368))**
- **build(deps): Bump goreleaser/goreleaser-action from 4 to 5 ([#1369](https://github.com/cometbft/cometbft/pull/1369))**
- **ADR101: Moved changelog entries ([#1377](https://github.com/cometbft/cometbft/pull/1377))**
- **Max byte check ([#1384](https://github.com/cometbft/cometbft/pull/1384))**
- **Update to string ([#1385](https://github.com/cometbft/cometbft/pull/1385))**
- **mempool: Remove unused peerID constants ([#1379](https://github.com/cometbft/cometbft/pull/1379))**
- **build(deps): Bump github.com/google/uuid from 1.3.0 to 1.3.1
([#1392](https://github.com/cometbft/cometbft/pull/1392))**
- **build(deps): Bump github.com/rs/cors from 1.9.0 to 1.10.0 ([#1393](https://github.com/cometbft/cometbft/pull/1393))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.8.1 to 5.9.0
([#1396](https://github.com/cometbft/cometbft/pull/1396))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.32.4 to 2.34.0
([#1400](https://github.com/cometbft/cometbft/pull/1400))**
- **build(deps): Bump github.com/go-kit/kit from 0.12.0 to 0.13.0
([#1397](https://github.com/cometbft/cometbft/pull/1397))**
- **build(deps): Bump github.com/golangci/golangci-lint ([#1398](https://github.com/cometbft/cometbft/pull/1398))**
- **build(deps): Bump google.golang.org/grpc from 1.57.0 to 1.58.2
([#1399](https://github.com/cometbft/cometbft/pull/1399))**
- **doc: improve documentation of BlockParams.MaxBytes ([#1405](https://github.com/cometbft/cometbft/pull/1405))**
- **rpc: Improve abci_query parameter documentation ([#1184](https://github.com/cometbft/cometbft/pull/1184))**
- **Bump p2p version following introduction of
`HasProposalBlockPartMessage` ([#1411](https://github.com/cometbft/cometbft/pull/1411))**
- **RFC: Allowing Non-Determinism in `ProcessProposal` ([#1391](https://github.com/cometbft/cometbft/pull/1391))**
- **ADR-101: Data Companion Pull API ([#82](https://github.com/cometbft/cometbft/pull/82))**
- **build(deps): Bump github.com/rs/cors from 1.10.0 to 1.10.1 ([#1418](https://github.com/cometbft/cometbft/pull/1418))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.0 to 2.34.2
([#1416](https://github.com/cometbft/cometbft/pull/1416))**
- **build(deps): Bump github.com/prometheus/client_golang ([#1417](https://github.com/cometbft/cometbft/pull/1417))**
- **fix typos ([#1413](https://github.com/cometbft/cometbft/pull/1413))**
- **Renames Tendermint to CometBFT in the RPC related test code
([#1428](https://github.com/cometbft/cometbft/pull/1428))**
- **Renames Tendermint to CometBFT in the RPC related test code. This
file was missing and it was not caught in the branch testing. ([#1433](https://github.com/cometbft/cometbft/pull/1433))**
- **Reject incoming txs while node is catching up ([#1119](https://github.com/cometbft/cometbft/pull/1119))**
- **build(deps): Bump golang.org/x/crypto from 0.13.0 to 0.14.0
([#1458](https://github.com/cometbft/cometbft/pull/1458))**
- **build(deps): Bump golang.org/x/sync from 0.3.0 to 0.4.0 ([#1454](https://github.com/cometbft/cometbft/pull/1454))**
- **build(deps): Bump golang.org/x/net from 0.15.0 to 0.16.0 ([#1453](https://github.com/cometbft/cometbft/pull/1453))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.26.1 to 1.27.0
([#1449](https://github.com/cometbft/cometbft/pull/1449))**
- **build(deps): Bump styfle/cancel-workflow-action from 0.11.0 to
0.12.0 ([#1450](https://github.com/cometbft/cometbft/pull/1450))**
- **build(deps): Bump github.com/prometheus/client_model ([#1455](https://github.com/cometbft/cometbft/pull/1455))**
- **build(deps): Bump github.com/bufbuild/buf from 1.26.1 to 1.27.0
([#1459](https://github.com/cometbft/cometbft/pull/1459))**
- **build(deps): Bump github.com/spf13/viper from 1.16.0 to 1.17.0
([#1456](https://github.com/cometbft/cometbft/pull/1456))**
- **test: respect P2PConfig fuzzing configuration in MultiplexTransport
([#1414](https://github.com/cometbft/cometbft/pull/1414))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.34.2 to 2.35.3
([#1462](https://github.com/cometbft/cometbft/pull/1462))**
- **crypto: export errors ([#1463](https://github.com/cometbft/cometbft/pull/1463))**
- **Do not race with pruning to validate headers and validators
([#1467](https://github.com/cometbft/cometbft/pull/1467))**
- **fix typos ([#1487](https://github.com/cometbft/cometbft/pull/1487))**
- **Call observer only when retain height changes ([#1490](https://github.com/cometbft/cometbft/pull/1490))**
- **build(deps): Bump pillow from 9.3.0 to 10.0.1 in
/scripts/qa/reporting ([#1493](https://github.com/cometbft/cometbft/pull/1493))**
- **abci: Add relaxed local client synchronization models ([#1141](https://github.com/cometbft/cometbft/pull/1141))**
- **docs: fix typos ([#1500](https://github.com/cometbft/cometbft/pull/1500))**
- **Post-merge fixes for feature/proto-upgrade**
- **Make BuildLastCommitInfo and BuildExtendedCommitInfo public
([#1502](https://github.com/cometbft/cometbft/pull/1502))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.3 to 2.35.4
([#1497](https://github.com/cometbft/cometbft/pull/1497))**
- **build(deps): Bump google.golang.org/grpc from 1.58.2 to 1.58.3
([#1498](https://github.com/cometbft/cometbft/pull/1498))**
- **build(deps): Bump golang.org/x/net from 0.16.0 to 0.17.0 ([#1499](https://github.com/cometbft/cometbft/pull/1499))**
- **tiny change: reorder expected and actual values ([#1506](https://github.com/cometbft/cometbft/pull/1506))**
- **Fixed docker port alias ([#1507](https://github.com/cometbft/cometbft/pull/1507))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.0 to 1.27.1
([#1527](https://github.com/cometbft/cometbft/pull/1527))**
- **Implement ADR-107: rename proto package version suffixes to v1beta*
pattern ([#1510](https://github.com/cometbft/cometbft/pull/1510))**
- **e2e: Fix flakiness in grpc tests due to pruning ([#1492](https://github.com/cometbft/cometbft/pull/1492))**
- **fix spelling of bandwidth ([#1534](https://github.com/cometbft/cometbft/pull/1534))**
- **Fix linting on `main` ([#1531](https://github.com/cometbft/cometbft/pull/1531))**
- **build(deps): Bump github.com/prometheus/common from 0.44.0 to 0.45.0
([#1524](https://github.com/cometbft/cometbft/pull/1524))**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.0 to 1.27.1
([#1522](https://github.com/cometbft/cometbft/pull/1522))**
- **build(deps): Bump github.com/golangci/golangci-lint ([#1540](https://github.com/cometbft/cometbft/pull/1540))**
- **fix some typos ([#1541](https://github.com/cometbft/cometbft/pull/1541))**
- **indexer-respect-height-params-on-query ([#1529](https://github.com/cometbft/cometbft/pull/1529))**
- **Correct go_package paths in service proto files ([#1538](https://github.com/cometbft/cometbft/pull/1538))**
- **build(deps): Bump google.golang.org/grpc from 1.58.3 to 1.59.0
([#1521](https://github.com/cometbft/cometbft/pull/1521))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.35.4 to 2.36.0
([#1523](https://github.com/cometbft/cometbft/pull/1523))**
- **feat(mempool): export error ([#1427](https://github.com/cometbft/cometbft/pull/1427))**
- **Rename proto messages and services to satisfy default buf lints
([#1533](https://github.com/cometbft/cometbft/pull/1533))**
- **RFC 106: non-idempotent methods in data companion ([#1545](https://github.com/cometbft/cometbft/pull/1545))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.0
([#1550](https://github.com/cometbft/cometbft/pull/1550))**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.1 to 1.27.2
([#1551](https://github.com/cometbft/cometbft/pull/1551))**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
([#1552](https://github.com/cometbft/cometbft/pull/1552))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.1 to 1.27.2
([#1553](https://github.com/cometbft/cometbft/pull/1553))**
- **use assert.Greater instead of Equal for better error reporting
([#1547](https://github.com/cometbft/cometbft/pull/1547))**
- **rpc: Version the RPC APIs ([#1412](https://github.com/cometbft/cometbft/pull/1412))**
- **mempool: Add metric size of pool in bytes ([#1512](https://github.com/cometbft/cometbft/pull/1512))**
- **build(deps): Bump github.com/docker/docker ([#1570](https://github.com/cometbft/cometbft/pull/1570))**
- **build(deps): Bump github.com/spf13/cobra from 1.7.0 to 1.8.0
([#1572](https://github.com/cometbft/cometbft/pull/1572))**
- **build(deps): Bump golang.org/x/sync from 0.4.0 to 0.5.0 ([#1574](https://github.com/cometbft/cometbft/pull/1574))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.0 to 2.36.1
([#1576](https://github.com/cometbft/cometbft/pull/1576))**
- **build(deps): Bump github.com/gorilla/websocket from 1.5.0 to 1.5.1
([#1575](https://github.com/cometbft/cometbft/pull/1575))**
- **build(deps): Bump github.com/golangci/golangci-lint ([#1573](https://github.com/cometbft/cometbft/pull/1573))**
- **chore: consolidate changelog improvements section ([#1578](https://github.com/cometbft/cometbft/pull/1578))**
- **Implementation of ADR-108 ([#930](https://github.com/cometbft/cometbft/pull/930))**
- **Reduce the default MaxBytes to 4mb and increase MaxGas to 10 million
([#1518](https://github.com/cometbft/cometbft/pull/1518))**
- **e2e: Allow disabling the PEX reactor on all nodes in the testnet
([#1580](https://github.com/cometbft/cometbft/pull/1580))**
- **Experimental - Reduce # of connections effectively used to gossip
transactions out ([#1558](https://github.com/cometbft/cometbft/pull/1558))**
- **Update proto file references to follow renaming/versioning ([#1555](https://github.com/cometbft/cometbft/pull/1555))**
- **Make `LoadBlock` also return block metadata ([#1557](https://github.com/cometbft/cometbft/pull/1557))**
- **mempool: Limit gossip connections to persistent and non-persistent
peers (experimental) ([#1584](https://github.com/cometbft/cometbft/pull/1584))**
- **fix: docs: default db provider moved from node to config ([#1588](https://github.com/cometbft/cometbft/pull/1588))**
- **build(deps): Bump github.com/bufbuild/buf from 1.27.2 to 1.28.0
([#1598](https://github.com/cometbft/cometbft/pull/1598))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.27.2 to 1.28.0
([#1602](https://github.com/cometbft/cometbft/pull/1602))**
- **build(deps): Bump golang.org/x/crypto from 0.14.0 to 0.15.0
([#1599](https://github.com/cometbft/cometbft/pull/1599))**
- **build(deps): Bump golang.org/x/net from 0.17.0 to 0.18.0 ([#1597](https://github.com/cometbft/cometbft/pull/1597))**
- **RFC 107: Internal signalling using event observers ([#1164](https://github.com/cometbft/cometbft/pull/1164))**
- **ADR 110: Remote mempool ([#1565](https://github.com/cometbft/cometbft/pull/1565))**
- **chore: aligns function descriptions with godoc standards in the
types package ([#1593](https://github.com/cometbft/cometbft/pull/1593))**
- **docs: various improvements ([#1603](https://github.com/cometbft/cometbft/pull/1603))**
- **chore: Merge branch main into feature/proto-upgrade ([#1612](https://github.com/cometbft/cometbft/pull/1612))**
- **Removes wrong assertion and decreases likelyhood of block from the
future has actually been already created ([#1619](https://github.com/cometbft/cometbft/pull/1619))**
- **Split /api off to separate go.mod ([#1608](https://github.com/cometbft/cometbft/pull/1608))**
- **feature: Reduce Go API surface area (ADR 109) ([#1605](https://github.com/cometbft/cometbft/pull/1605))**
- **refactor: Export func MakeHTTPDialer ([#1594](https://github.com/cometbft/cometbft/pull/1594))**
- **First draft ([#1483](https://github.com/cometbft/cometbft/pull/1483))**
- **pruning:do not attempt to prune state if no blocks are pruned
([#1616](https://github.com/cometbft/cometbft/pull/1616))**
- **Update SECURITY.md ([#1626](https://github.com/cometbft/cometbft/pull/1626))**
- **Update changelog on `main` with new releases ([#1644](https://github.com/cometbft/cometbft/pull/1644))**
- **proto: Update README ([#1648](https://github.com/cometbft/cometbft/pull/1648))**
- **ADR 111: `nop` Mempool ([#1585](https://github.com/cometbft/cometbft/pull/1585))**
- **ADR-111: Addressed Ethan's comment ([#1667](https://github.com/cometbft/cometbft/pull/1667))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.36.1 to 2.37.1
([#1662](https://github.com/cometbft/cometbft/pull/1662))**
- **build(deps): Bump docker/build-push-action from 5.0.0 to 5.1.0
([#1664](https://github.com/cometbft/cometbft/pull/1664))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.0 to 1.28.1
([#1665](https://github.com/cometbft/cometbft/pull/1665))**
- **ci: Fix v0.34 nightly build ([#1655](https://github.com/cometbft/cometbft/pull/1655))**
- **build(deps): Bump github.com/bufbuild/buf from 1.28.0 to 1.28.1
([#1663](https://github.com/cometbft/cometbft/pull/1663))**
- **feature/proto-upgrade: Fix generated mock code ([#1673](https://github.com/cometbft/cometbft/pull/1673))**
- **Update link in README.md ([#1674](https://github.com/cometbft/cometbft/pull/1674))**
- **Renames the semantic versioning variable to CMT ([#1621](https://github.com/cometbft/cometbft/pull/1621))**
- **mempool: add `nop` mempool ([#1643](https://github.com/cometbft/cometbft/pull/1643))**
- **e2e:fix-digital-ocean-ports ([#1678](https://github.com/cometbft/cometbft/pull/1678))**
- **Revert modularization of the test infra ([#1488](https://github.com/cometbft/cometbft/pull/1488)) ([#1676](https://github.com/cometbft/cometbft/pull/1676))**
- **docs: various small improvements (part 2) ([#1683](https://github.com/cometbft/cometbft/pull/1683))**
- **Do not block indefinitely on the semaphore ([#1654](https://github.com/cometbft/cometbft/pull/1654))**
- **Adds tests that check for FIFO ordering being broken by gossip
([#1628](https://github.com/cometbft/cometbft/pull/1628))**
- **loadtime: Add parameter for displaying results in one line ([#1511](https://github.com/cometbft/cometbft/pull/1511))**
- **Promote latest versions of Protobuf definitions to v1 packages
([#1677](https://github.com/cometbft/cometbft/pull/1677))**
- **chore: Update CHANGELOG.md ([#1701](https://github.com/cometbft/cometbft/pull/1701))**
- **build(deps): Bump github.com/google/uuid from 1.3.1 to 1.4.0
([#1696](https://github.com/cometbft/cometbft/pull/1696))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.37.1 to 2.38.0
([#1697](https://github.com/cometbft/cometbft/pull/1697))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.9.0 to 5.10.1
([#1702](https://github.com/cometbft/cometbft/pull/1702))**
- **proto: document the `cometbft.*` versioned protos ([#1694](https://github.com/cometbft/cometbft/pull/1694))**
- **Clean up changelog entries and README files for versioned proto
changes ([#1707](https://github.com/cometbft/cometbft/pull/1707))**
- **chore(proto): add missing docs ([#1703](https://github.com/cometbft/cometbft/pull/1703))**
- **feature/proto-upgrade: Last-minute fixes ([#1709](https://github.com/cometbft/cometbft/pull/1709))**
- **e2e: Support emulated latencies between docker images ([#1560](https://github.com/cometbft/cometbft/pull/1560))**
- **build(deps): Bump golang.org/x/net from 0.14.0 to 0.17.0 in /api
([#1713](https://github.com/cometbft/cometbft/pull/1713))**
- **Prepare `main` for `v1.x` backport branch ([#1714](https://github.com/cometbft/cometbft/pull/1714))**
- **build(deps): Bump golang.org/x/crypto from 0.15.0 to 0.16.0
([#1720](https://github.com/cometbft/cometbft/pull/1720))**
- **build(deps): Bump golang.org/x/net from 0.18.0 to 0.19.0 ([#1719](https://github.com/cometbft/cometbft/pull/1719))**
- **types: validate Validator#Address field ([#1715](https://github.com/cometbft/cometbft/pull/1715))**
- **Enable Mergify backports for `v1.x` branch ([#1724](https://github.com/cometbft/cometbft/pull/1724))**
- **deps: Bump cometbft-db to v0.9.0 ([#1725](https://github.com/cometbft/cometbft/pull/1725))**
- **buf improvements prior to publishing on BSR ([#1726](https://github.com/cometbft/cometbft/pull/1726))**
- **proto: give our buf module a name ([#1734](https://github.com/cometbft/cometbft/pull/1734))**
- **deps: Bump cometbft-db to v0.9.1 ([#1737](https://github.com/cometbft/cometbft/pull/1737))**
- **chore: Update root docs ([#1740](https://github.com/cometbft/cometbft/pull/1740))**
- **fix: increase abci socket message size limit to 2GB ([#1730](https://github.com/cometbft/cometbft/pull/1730))**
- **proto: make comment in README more Markdowny ([#1743](https://github.com/cometbft/cometbft/pull/1743))**
- **fix: Txs Validate ([#1687](https://github.com/cometbft/cometbft/pull/1687))**
- **Add test missing in [#1687](https://github.com/cometbft/cometbft/pull/1687) ([#1712](https://github.com/cometbft/cometbft/pull/1712))**
- **perf(state): batch save `State` ([#1735](https://github.com/cometbft/cometbft/pull/1735))**
- **Update CODE_OF_CONDUCT.md ([#1708](https://github.com/cometbft/cometbft/pull/1708))**
- **[e2e] Fixes prepareProposal not to return oversized set of
transactions ([#1756](https://github.com/cometbft/cometbft/pull/1756))**
- **perf(store): Batch save `Block` ([#1755](https://github.com/cometbft/cometbft/pull/1755))**
- **Fix: Fix minor typos ([#1780](https://github.com/cometbft/cometbft/pull/1780))**
- **`VerifyCommitLight` and `VerifyCommitLightTrusting` _never_ check
all signatures ([#1750](https://github.com/cometbft/cometbft/pull/1750))**
- **Fix typo in encoding.md ([#1801](https://github.com/cometbft/cometbft/pull/1801))**
- **chore(docs): small improvements ([#1781](https://github.com/cometbft/cometbft/pull/1781))**
- **build(deps): Bump github.com/go-git/go-git/v5 from 5.10.1 to 5.11.0
([#1797](https://github.com/cometbft/cometbft/pull/1797))**
- **build(deps): Bump actions/setup-go from 4 to 5 ([#1794](https://github.com/cometbft/cometbft/pull/1794))**
- **build(deps): Bump actions/stale from 8 to 9 ([#1795](https://github.com/cometbft/cometbft/pull/1795))**
- **build(deps): Bump github.com/spf13/viper from 1.17.0 to 1.18.1
([#1796](https://github.com/cometbft/cometbft/pull/1796))**
- **Chore/fix other typos ([#1809](https://github.com/cometbft/cometbft/pull/1809))**
- **chore(spec): specify which fields must be deterministic ([#1804](https://github.com/cometbft/cometbft/pull/1804))**
- **Small improvements in [#1806](https://github.com/cometbft/cometbft/pull/1806) not present in [#1750](https://github.com/cometbft/cometbft/pull/1750) ([#1808](https://github.com/cometbft/cometbft/pull/1808))**
- **Add changelog for [#1749](https://github.com/cometbft/cometbft/issues/1749) ([#1807](https://github.com/cometbft/cometbft/pull/1807))**
- **e2e: Implement latency emulation for DigitalOcean ([#1587](https://github.com/cometbft/cometbft/pull/1587))**
- **add GH workflow for linting code using codespell ([#1824](https://github.com/cometbft/cometbft/pull/1824))**
- **chore(docs): explain the effect of `timeout_propose` ([#1798](https://github.com/cometbft/cometbft/pull/1798))**
- **build(deps): Bump actions/upload-artifact from 3 to 4 ([#1845](https://github.com/cometbft/cometbft/pull/1845))**
- **build(deps): Bump actions/setup-python from 2 to 5 ([#1843](https://github.com/cometbft/cometbft/pull/1843))**
- **build(deps): Bump github/codeql-action from 2 to 3 ([#1847](https://github.com/cometbft/cometbft/pull/1847))**
- **build(deps): Bump actions/checkout from 2 to 4 ([#1846](https://github.com/cometbft/cometbft/pull/1846))**
- **build(deps): Bump github.com/google/uuid from 1.4.0 to 1.5.0
([#1850](https://github.com/cometbft/cometbft/pull/1850))**
- **build(deps): Bump google.golang.org/grpc from 1.59.0 to 1.60.0
([#1851](https://github.com/cometbft/cometbft/pull/1851))**
- **golangci-lint: enable all the linters by default ([#1838](https://github.com/cometbft/cometbft/pull/1838))**
- **Updates go crypto package to v0.17.0 ([#1859](https://github.com/cometbft/cometbft/pull/1859))**
- **Adds checks for nil keys and signatures ([#1855](https://github.com/cometbft/cometbft/pull/1855))**
- **The store DB and the companion `BlockStore` struct are sometimes out
of sync ([#1856](https://github.com/cometbft/cometbft/pull/1856))**
- **Allow blocksync to not verify all signatures ([#1858](https://github.com/cometbft/cometbft/pull/1858))**
- **Fixing the ABCI grammar and updating the code for e2e tests to
account for the new grammar. ([#1829](https://github.com/cometbft/cometbft/pull/1829))**
- **docs: Fix Discord links in README ([#1874](https://github.com/cometbft/cometbft/pull/1874))**
- **build(deps): Bump github.com/prometheus/client_golang ([#1909](https://github.com/cometbft/cometbft/pull/1909))**
- **build(deps): Bump github.com/btcsuite/btcd/btcutil from 1.1.3 to
1.1.5 ([#1908](https://github.com/cometbft/cometbft/pull/1908))**
- **build(deps): Bump google.golang.org/protobuf ([#1885](https://github.com/cometbft/cometbft/pull/1885))**
- **build(deps): Bump github.com/spf13/viper from 1.18.1 to 1.18.2
([#1884](https://github.com/cometbft/cometbft/pull/1884))**
- **build(deps): Bump google.golang.org/grpc from 1.60.0 to 1.60.1
([#1883](https://github.com/cometbft/cometbft/pull/1883))**
- **remove unused linters that produced a warning and ensure that
unparam is enabled ([#1905](https://github.com/cometbft/cometbft/pull/1905))**
- **Fix HTTP response body not being closed after reading ([#1945](https://github.com/cometbft/cometbft/pull/1945))**
- **Disable undesired linting code ([#1959](https://github.com/cometbft/cometbft/pull/1959))**
- **Extend kvstore example add with with key types ([#1876](https://github.com/cometbft/cometbft/pull/1876))**
- **Extra check in `VerifyExtension` ([#1877](https://github.com/cometbft/cometbft/pull/1877))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.38.0 to 2.39.1
([#1882](https://github.com/cometbft/cometbft/pull/1882))**
- **perf(crypto/merkle, crypto/tmhash): simplify+optimize SHA256 hashing
of multiple byteslices ([#1921](https://github.com/cometbft/cometbft/pull/1921))**
- **Update localnet-start Makefile ([#1975](https://github.com/cometbft/cometbft/pull/1975))**
- **blocksync: wait for poolRoutine to stop in (*Reactor).OnStop
([#1879](https://github.com/cometbft/cometbft/pull/1879))**
- **fix TestListenerTimeoutReadWrite ([#1947](https://github.com/cometbft/cometbft/pull/1947))**
- **docs: fix typos ([#1988](https://github.com/cometbft/cometbft/pull/1988))**
- **this is the kindest commit I can think of. Take it that way and read
the code. ([#1987](https://github.com/cometbft/cometbft/pull/1987))**
- **there's really no need for this anymore ([#1986](https://github.com/cometbft/cometbft/pull/1986))**
- **feat: DefaultHttpClient support setting proxy from env ([#1900](https://github.com/cometbft/cometbft/pull/1900))**
- **feat: lint tests ([#1906](https://github.com/cometbft/cometbft/pull/1906))**
- **chore: fix typos ([#1991](https://github.com/cometbft/cometbft/pull/1991))**
- **build(deps): Bump golang.org/x/sync from 0.5.0 to 0.6.0 ([#1992](https://github.com/cometbft/cometbft/pull/1992))**
- **feat(proxy): export errors ([#1899](https://github.com/cometbft/cometbft/pull/1899))**
- **doc:fix broken link in DOCKER/README.md ([#1996](https://github.com/cometbft/cometbft/pull/1996))**
- **feat: custom dependencies order ([#1994](https://github.com/cometbft/cometbft/pull/1994))**
- **PBTS: migrating to `main` the new version of the specification
([#1973](https://github.com/cometbft/cometbft/pull/1973))**
- **Fix paths to scripts/metricsgen in go:generate commands ([#1998](https://github.com/cometbft/cometbft/pull/1998))**
- **chore: fix some typos ([#2002](https://github.com/cometbft/cometbft/pull/2002))**
- **docs(light): fix broken link to spec ([#2007](https://github.com/cometbft/cometbft/pull/2007))**
- **chore(test/loadtime): replace tm-load-test w/ cometbft-load-test
([#2009](https://github.com/cometbft/cometbft/pull/2009))**
- **ci: Remove unused `tests` target when compiling e2e ([#2022](https://github.com/cometbft/cometbft/pull/2022))**
- **spec: fix typo in `encoding.md` ([#2024](https://github.com/cometbft/cometbft/pull/2024))**
- **mempool: Fix data races in CListMempool's height and
notifiedTxsAvailable ([#2021](https://github.com/cometbft/cometbft/pull/2021))**
- **chore(test/loadtime): cleanup go.sum and golangci.yml ([#2025](https://github.com/cometbft/cometbft/pull/2025))**
- **build(deps): Bump github.com/prometheus/common from 0.45.0 to 0.46.0
([#2040](https://github.com/cometbft/cometbft/pull/2040))**
- **build(deps): Bump github.com/vektra/mockery/v2 from 2.39.1 to 2.40.1
([#2038](https://github.com/cometbft/cometbft/pull/2038))**
- **feat(rpc): Use default port for HTTP(S) URLs when there is no
explicit port ([#1903](https://github.com/cometbft/cometbft/pull/1903))**
- **misc(go.mod): remove unused peg dependency ([#2044](https://github.com/cometbft/cometbft/pull/2044))**
- **config: Remove unused `max_batch_bytes` ([#2050](https://github.com/cometbft/cometbft/pull/2050))**
- **Merge pull request from [GHSA-qr8r-m495-7hc4](https://github.com/advisories/GHSA-qr8r-m495-7hc4 "GHSA-qr8r-m495-7hc4")**
- **misc(tools)!: remove `tools` package ([#2046](https://github.com/cometbft/cometbft/pull/2046))**
- **docs(guides): add missing import ([#2070](https://github.com/cometbft/cometbft/pull/2070))**
- **deps(localnode): bump alpine version ([#2077](https://github.com/cometbft/cometbft/pull/2077))**
- **misc(Makefile): add `help` target to display the help msg ([#2074](https://github.com/cometbft/cometbft/pull/2074))**
- **`e2e`: test vote extension activation via `InitChain` and
`FinalizeBlock` ([#2066](https://github.com/cometbft/cometbft/pull/2066))**
- **scripts: metricsgen parses '// metrics:' pattern ([#2090](https://github.com/cometbft/cometbft/pull/2090))**
- **e2e: Add `load_max_txs` option to manifest ([#2094](https://github.com/cometbft/cometbft/pull/2094))**
- **consensus: Add `chain_size_bytes` metric ([#2093](https://github.com/cometbft/cometbft/pull/2093))**
- **feat: conventional commits ([#1995](https://github.com/cometbft/cometbft/pull/1995))**
- **Forward port of [tendermint/tendermint#7605](https://github.com/tendermint/tendermint/pull/7605), [tendermint/spec#393](https://github.com/tendermint/spec/pull/393), and
[tendermint/tendermint#8142](https://github.com/tendermint/tendermint/pull/8142) ([#2018](https://github.com/cometbft/cometbft/pull/2018))**
- **ci: fix permissions for "Conventional PR Title" ([#2099](https://github.com/cometbft/cometbft/pull/2099))**
- **PBTS: additions and fixes on migrated spec ([#2013](https://github.com/cometbft/cometbft/pull/2013))**
- **PBTS: forward port of [tendermint/tendermint#7709](https://github.com/tendermint/tendermint/pull/7709) ([#2089](https://github.com/cometbft/cometbft/pull/2089))**
- **feat: use go workspace ([#1924](https://github.com/cometbft/cometbft/pull/1924))**
- **fix: `ValidateUpdate`: allow no-change updates regardless of current
height ([#2112](https://github.com/cometbft/cometbft/pull/2112))**
- **test(localnet): Add monitoring tools for localnet ([#2108](https://github.com/cometbft/cometbft/pull/2108))**
- **feat: add gofumpt ([#2049](https://github.com/cometbft/cometbft/pull/2049))**
- **feat(consensus): increase log level for corner case when prevoting a
proposal ([#2042](https://github.com/cometbft/cometbft/pull/2042))**
- **docs: v1 - diataxis framework ([#2105](https://github.com/cometbft/cometbft/pull/2105))**
- **feat(consensus): additional sanity checks for the size of proposed
blocks ([#1408](https://github.com/cometbft/cometbft/pull/1408))**
- **perf(internal/blocksync): avoid double-calling
`types.BlockFromProto` ([#2016](https://github.com/cometbft/cometbft/pull/2016))**
- **build(deps): Bump google.golang.org/grpc from 1.60.1 to 1.61.0
([#2178](https://github.com/cometbft/cometbft/pull/2178))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.28.1 to 1.29.0
([#2161](https://github.com/cometbft/cometbft/pull/2161))**
- **build(deps): Bump styfle/cancel-workflow-action from 0.12.0 to
0.12.1 ([#2160](https://github.com/cometbft/cometbft/pull/2160))**
- **build(deps): Bump slackapi/slack-github-action from 1.24.0 to 1.25.0
([#2162](https://github.com/cometbft/cometbft/pull/2162))**
- **build(deps): Bump github.com/google/uuid from 1.5.0 to 1.6.0
([#2176](https://github.com/cometbft/cometbft/pull/2176))**
- **refactor(privval): reverse conditional + more idiomatic Go code with
early returns ([#2156](https://github.com/cometbft/cometbft/pull/2156))**
- **fix(e2e): path to latency script files in DO ([#2148](https://github.com/cometbft/cometbft/pull/2148))**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.9.1 to
0.10.0 ([#2175](https://github.com/cometbft/cometbft/pull/2175))**
- **chore(Makefile): add `setup-pre-commit` target to init git hook
([#2123](https://github.com/cometbft/cometbft/pull/2123))**
- **feat: add pebbledb (<https://github.com/cockroachdb/pebble>) ([#2132](https://github.com/cometbft/cometbft/pull/2132))**
- **perf(internal/blocksync): do not `ValidateBlock` twice ([#2026](https://github.com/cometbft/cometbft/pull/2026))**
- **feat(e2e): Add new targets `fast` and `clean` to Makefile ([#2192](https://github.com/cometbft/cometbft/pull/2192))**
- **ci: add `spec` type in conventional-pr-title ([#2191](https://github.com/cometbft/cometbft/pull/2191))**
- **fix(privval): retry accepting a connection on errors ([#2047](https://github.com/cometbft/cometbft/pull/2047))**
- **fix(.github/workflows): correct parameters to lint_pr_title
([#2199](https://github.com/cometbft/cometbft/pull/2199))**
- **docs: update QA method steps for qa-infra changes ([#2198](https://github.com/cometbft/cometbft/pull/2198))**
- **feat!(pbts): forward port of [tendermint/tendermint#7711](https://github.com/tendermint/tendermint/pull/7711) ([#2149](https://github.com/cometbft/cometbft/pull/2149))**
- **docs(pbts): forward port of PBTS documentation and fixes ([#2124](https://github.com/cometbft/cometbft/pull/2124))**
- **fix: if-return and early-return ([#2215](https://github.com/cometbft/cometbft/pull/2215))**
- **chore: remove amazon linux Dockerfile and update
test/docker/Dockerfile ([#2135](https://github.com/cometbft/cometbft/pull/2135))**
- **feat(ci): pre-commit framework ([#2214](https://github.com/cometbft/cometbft/pull/2214))**
- **ci: add `merge` type for conventional-pr-title ([#2219](https://github.com/cometbft/cometbft/pull/2219))**
- **spec(consensus/pbts): update description for introduced parameters.
([#2206](https://github.com/cometbft/cometbft/pull/2206))**
- **perf: optimize psql indexer ([#2142](https://github.com/cometbft/cometbft/pull/2142))**
- **fix(go.mod): do not use `replace` for api ([#2236](https://github.com/cometbft/cometbft/pull/2236))**
- **fix(Makefile): gofumpt no longer needed ([#2235](https://github.com/cometbft/cometbft/pull/2235))**
- **fix(p2p/pex): gracefully shutdown `Reactor` ([#2010](https://github.com/cometbft/cometbft/pull/2010))**
- **test(mempool): fix
TestMempoolUpdateDoesNotPanicWhenApplicationMissedTx ([#2242](https://github.com/cometbft/cometbft/pull/2242))**
- **fix(flowrate): fix non-determinism in flowrate tests ([#2147](https://github.com/cometbft/cometbft/pull/2147))**
- **refactor!: Implement RFC 106: remove `GetLatestBlock*` methods from
data companion API ([#2240](https://github.com/cometbft/cometbft/pull/2240))**
- **build(deps): Bump github.com/cloudflare/circl from 1.3.3 to 1.3.7
([#2253](https://github.com/cometbft/cometbft/pull/2253))**
- **chore(config): update DB section in toml.go ([#2249](https://github.com/cometbft/cometbft/pull/2249))**
- **fix(consensus): do not precommit nil if proposal block is received
([#2221](https://github.com/cometbft/cometbft/pull/2221))**
- **build(deps): Bump github.com/opencontainers/runc from 1.1.5 to
1.1.12 ([#2261](https://github.com/cometbft/cometbft/pull/2261))**
- **fix(mempool/tests): Reduce tests duration ([#2263](https://github.com/cometbft/cometbft/pull/2263))**
- **ci: run golangci-lint linters for all files (not only ones which
were modified) ([#2250](https://github.com/cometbft/cometbft/pull/2250))**
- **refactor(examples): small changes to kvstore app ([#2267](https://github.com/cometbft/cometbft/pull/2267))**
- **refactor(mempool): simplify parameters of resCbFirstTime and
resCbRecheck ([#2272](https://github.com/cometbft/cometbft/pull/2272))**
- **perf(mempool/cache): clear map in Reset ([#2259](https://github.com/cometbft/cometbft/pull/2259))**
- **test(abci): update e2e tests to check against ABCI 2.0 grammar
([#2201](https://github.com/cometbft/cometbft/pull/2201))**
- **docs: symbolic references to steps in the qa-infra README ([#2280](https://github.com/cometbft/cometbft/pull/2280))**
- **chore: updated doc link ([#2296](https://github.com/cometbft/cometbft/pull/2296))**
- **fix(consensus): prevote nil upon timeout when Proposal is missing
([#2218](https://github.com/cometbft/cometbft/pull/2218))**
- **build(deps): Bump pre-commit/action from 3.0.0 to 3.0.1 ([#2307](https://github.com/cometbft/cometbft/pull/2307))**
- **build(deps): Bump golang.org/x/net from 0.20.0 to 0.21.0 ([#2300](https://github.com/cometbft/cometbft/pull/2300))**
- **build(deps): Bump github.com/cometbft/cometbft-db from 0.10.0 to
0.11.0 ([#2299](https://github.com/cometbft/cometbft/pull/2299))**
- **docs: ADR-112 Proposer-Based Timestamps ([#2223](https://github.com/cometbft/cometbft/pull/2223))**
- **refactor(internal/statesync): replace ticker with `time.After(X)`
([#2294](https://github.com/cometbft/cometbft/pull/2294))**
- **fix: simultaneous rpc test failures ([#2150](https://github.com/cometbft/cometbft/pull/2150))**
- **chore(docs): alter the section about the effects of `timeout_commit`
([#1892](https://github.com/cometbft/cometbft/pull/1892))**
- **refactor(p2p)!: Refactor PeerSet to eliminate data races & improve
performance ([#2246](https://github.com/cometbft/cometbft/pull/2246))**
- **feat(pbts): Update consensus params to include pbts enabled
([#2231](https://github.com/cometbft/cometbft/pull/2231))**
- **feat(storage/metrics): Metrics to measure storage ([#1974](https://github.com/cometbft/cometbft/pull/1974))**
- **feat(e2e): Log number of sent txs (success and failed) ([#2328](https://github.com/cometbft/cometbft/pull/2328))**
- **chore: enable gomoddirectives, unparam ([#2290](https://github.com/cometbft/cometbft/pull/2290))**
- **docs: images not rendering properly in docs ([#2331](https://github.com/cometbft/cometbft/pull/2331))**
- **docs: Fix references about DeliverTx ([#2330](https://github.com/cometbft/cometbft/pull/2330))**
- **docs(qa): Add table of contents to existing QA reports ([#2343](https://github.com/cometbft/cometbft/pull/2343))**
- **chore: enable perfsprint linter ([#2291](https://github.com/cometbft/cometbft/pull/2291))**
- **feat(pruning): trigger explicitly compaction upon pruning ([#1972](https://github.com/cometbft/cometbft/pull/1972))**
- **docs: explain how to skip pre-commit hook ([#2358](https://github.com/cometbft/cometbft/pull/2358))**
- **build(deps): Bump github.com/prometheus/common from 0.46.0 to 0.47.0
([#2373](https://github.com/cometbft/cometbft/pull/2373))**
- **build(deps): Bump google.golang.org/grpc from 1.61.0 to 1.61.1
([#2372](https://github.com/cometbft/cometbft/pull/2372))**
- **feat(e2e): Option to set max block size in bytes at genesis
([#2362](https://github.com/cometbft/cometbft/pull/2362))**
- **build(deps): Bump github.com/prometheus/client_model from 0.5.0 to
0.6.0 ([#2371](https://github.com/cometbft/cometbft/pull/2371))**
- **revert(pbts): revert removal of BFT Time related functions ([#2205](https://github.com/cometbft/cometbft/pull/2205))**
- **fix(e2e): Reduce flakiness of TestGRPC_GetBlockResults ([#2367](https://github.com/cometbft/cometbft/pull/2367))**
- **spec(consensus): update Block Time documentation in spec ([#2316](https://github.com/cometbft/cometbft/pull/2316))**
- **spec: adaptive MSGDELAY parameter included in PBTS spec ([#2318](https://github.com/cometbft/cometbft/pull/2318))**
- **feat(pbts): Moving VoteExtensionsEnableHeight from ABCIParams to
FeatureParams. ([#2335](https://github.com/cometbft/cometbft/pull/2335))**
- **fix: remove TestMempoolFIFOWithParallelCheckTx ([#2364](https://github.com/cometbft/cometbft/pull/2364))**
- **fix(docker-compose): fix subnet ([#2383](https://github.com/cometbft/cometbft/pull/2383))**
- **feat(pbts): enable `e2e` manifest config to set `PbtsEnableHeight`
([#2284](https://github.com/cometbft/cometbft/pull/2284))**
- **perf(internal/state): avoid double-saving FinalizeBlockResponse
([#2017](https://github.com/cometbft/cometbft/pull/2017))**
- **build(deps): Bump fonttools from 4.37.4 to 4.43.0 in
/scripts/qa/reporting ([#2407](https://github.com/cometbft/cometbft/pull/2407))**
- **build(deps): Bump pillow from 10.0.1 to 10.2.0 in
/scripts/qa/reporting ([#2408](https://github.com/cometbft/cometbft/pull/2408))**
- **fix(node): Forward compaction config params to blockstore
constructor ([#2418](https://github.com/cometbft/cometbft/pull/2418))**
- **refactor!: moved `MedianTime` out of `internal` folder ([#2397](https://github.com/cometbft/cometbft/pull/2397))**
- **chore: typo fixes ([#2403](https://github.com/cometbft/cometbft/pull/2403))**
- **chore(pbts): Removes useless code ([#2420](https://github.com/cometbft/cometbft/pull/2420))**
- **build(deps): Bump github.com/prometheus/common from 0.47.0 to 0.48.0
([#2430](https://github.com/cometbft/cometbft/pull/2430))**
- **build(deps): Bump google.golang.org/grpc from 1.61.1 to 1.62.0
([#2429](https://github.com/cometbft/cometbft/pull/2429))**
- **test(consensus): PBTS should be enabled by default in test units
([#2329](https://github.com/cometbft/cometbft/pull/2329))**
- **test(consensus): test enabling PBTS at a given height ([#2404](https://github.com/cometbft/cometbft/pull/2404))**
- **refactor(protobuf): switch from gogofaster to gocosmos generator
([#2425](https://github.com/cometbft/cometbft/pull/2425))**
- **docs(tutorials/install): add `From Go package` ([#2414](https://github.com/cometbft/cometbft/pull/2414))**
- **docs(pbts): documentation for PBTS-related consensus parameters
([#2376](https://github.com/cometbft/cometbft/pull/2376))**
- **refactor(consensus): print err from SignAndCheckVote ([#2346](https://github.com/cometbft/cometbft/pull/2346))**
- **feat(e2e): add parameter to set a custom output directory for
testnet files ([#2433](https://github.com/cometbft/cometbft/pull/2433))**
- **spec(consensus): update description of consensus parameters for PBTS
([#2415](https://github.com/cometbft/cometbft/pull/2415))**
- **fix(localnet): Grafana dashboards for storage tests - removed
experimental metrics ([#2448](https://github.com/cometbft/cometbft/pull/2448))**
- **fix(jsonrpc): enable HTTP basic auth in WS client ([#2434](https://github.com/cometbft/cometbft/pull/2434))**
- **feat(pbts): Adds timestamp to the `msgInfo` written into the WAL
([#2388](https://github.com/cometbft/cometbft/pull/2388))**
- **fix: `Rollback`: wrong modification of
`state.LastHeightValidatorsChanged` while rollback at a special height
([#2136](https://github.com/cometbft/cometbft/pull/2136))**
- **docs(changelog): add missing entry for [#2136](https://github.com/cometbft/cometbft/pull/2136) ([#2459](https://github.com/cometbft/cometbft/pull/2459))**
- **fix(pbts): legacy `ABCIParams` values are properly translated to
`FeatureParams` values ([#2462](https://github.com/cometbft/cometbft/pull/2462))**
- **fix(e2e): Fixing the bug in ABCI e2e tests ([#2468](https://github.com/cometbft/cometbft/pull/2468))**
- **feat(localnet): Grafana PNG rendering for easier graph exports
([#2472](https://github.com/cometbft/cometbft/pull/2472))**
- **docs(README): remove Terra ([#2469](https://github.com/cometbft/cometbft/pull/2469))**
- **docs: document PBTS adaptive delays mechanism ([#2452](https://github.com/cometbft/cometbft/pull/2452))**
- **fix(config): Moved compact variables to the right section ([#2477](https://github.com/cometbft/cometbft/pull/2477))**
- **feat(metrics): more buckets for ProposalTimestampDifference
([#2479](https://github.com/cometbft/cometbft/pull/2479))**
- **fix(metrics): more buckets for ProposalTimestampDifference ([#2481](https://github.com/cometbft/cometbft/pull/2481))**
- **feat(pbts): Make synchrony params adaptive ([#2431](https://github.com/cometbft/cometbft/pull/2431))**
- **ci: check metrics generation in CI checks ([#2483](https://github.com/cometbft/cometbft/pull/2483))**
- **feat(consensus): improve logging for timely and untimely messages
([#2321](https://github.com/cometbft/cometbft/pull/2321))**
- **feat(types): improve Proposal and SynchronyParams validation tests
([#2489](https://github.com/cometbft/cometbft/pull/2489))**
- **test(consensus): refactor TestStateLock_POLSafety tests ([#2492](https://github.com/cometbft/cometbft/pull/2492))**
- **feat(types): refactor types.AdaptiveSynchronyParams method ([#2490](https://github.com/cometbft/cometbft/pull/2490))**
- **fix: lint errors introduced with the latest merge ([#2495](https://github.com/cometbft/cometbft/pull/2495))**
- **build(deps): Bump docker/setup-buildx-action from 3.0.0 to 3.1.0
([#2500](https://github.com/cometbft/cometbft/pull/2500))**
- **build(deps): Bump github.com/prometheus/client_golang from 1.18.0 to
1.19.0 ([#2508](https://github.com/cometbft/cometbft/pull/2508))**
- **build(deps): Bump golang.org/x/crypto from 0.19.0 to 0.20.0
([#2507](https://github.com/cometbft/cometbft/pull/2507))**
- **build(deps): Bump github.com/prometheus/common from 0.48.0 to 0.49.0
([#2506](https://github.com/cometbft/cometbft/pull/2506))**
- **build(deps): Bump github.com/stretchr/testify from 1.8.4 to 1.9.0
([#2505](https://github.com/cometbft/cometbft/pull/2505))**
- **fix(docs): include `timesync` daemon instructions ([#2491](https://github.com/cometbft/cometbft/pull/2491))**
- **feat(privval)!: DO NOT require extension signature ([#2496](https://github.com/cometbft/cometbft/pull/2496))**
- **refactor(privval): rename sign_extension to skip_sign_extension
([#2519](https://github.com/cometbft/cometbft/pull/2519))**
- **spec(abci): fixes the spec to inform about the presence of invalid
extensions in `last_commit` ([#2423](https://github.com/cometbft/cometbft/pull/2423))**
- **fix(pbts): block Time must be Canonical ([#2493](https://github.com/cometbft/cometbft/pull/2493))**
- **feat(e2e): Add manifest option `clock_skew` and corresponding
backend functionality ([#2454](https://github.com/cometbft/cometbft/pull/2454))**
- **fix(mempool): converting to uint64 before additions to avoid
overflows ([#2498](https://github.com/cometbft/cometbft/pull/2498))**
- **refactor!: Rename `skip_sign_extension` to `skip_extension_signing`
([#2522](https://github.com/cometbft/cometbft/pull/2522))**
- **docs(ADR): ADR-108 updated to account for the new changes in the
grammar and code. ([#2528](https://github.com/cometbft/cometbft/pull/2528))**
- **feat(e2e): add generator support for clock skew + env variable
rename ([#2488](https://github.com/cometbft/cometbft/pull/2488))**
- **spec(proto): add `cometbft.privval.v1beta2` proto package ([#2529](https://github.com/cometbft/cometbft/pull/2529))**
- **chore: improving error handling in the PendingEvidence ([#2550](https://github.com/cometbft/cometbft/pull/2550))**
- **feat(blocksync)!: set the max number of (concurrently) downloaded
blocks to {peersCount * 20} ([#2467](https://github.com/cometbft/cometbft/pull/2467))**
- **build(deps): Bump bufbuild/buf-setup-action from 1.29.0 to 1.30.0
([#2557](https://github.com/cometbft/cometbft/pull/2557))**
- **build(deps): Bump google.golang.org/protobuf from 1.32.0 to 1.33.0
([#2560](https://github.com/cometbft/cometbft/pull/2560))**
- **build(deps): Bump golang.org/x/net from 0.21.0 to 0.22.0 ([#2562](https://github.com/cometbft/cometbft/pull/2562))**
- **fix(cmd/cometbft/commands/version): update the output for v1
([#2546](https://github.com/cometbft/cometbft/pull/2546))**
- **build(deps): Bump docker/build-push-action from 5.1.0 to 5.2.0
([#2558](https://github.com/cometbft/cometbft/pull/2558))**
- **build(deps): Bump github.com/prometheus/common from 0.49.0 to 0.50.0
([#2559](https://github.com/cometbft/cometbft/pull/2559))**
- **build(deps): Bump google.golang.org/grpc from 1.62.0 to 1.62.1
([#2563](https://github.com/cometbft/cometbft/pull/2563))**
- **build(deps): Bump golang.org/x/crypto from 0.20.0 to 0.21.0
([#2561](https://github.com/cometbft/cometbft/pull/2561))**
- **feat(blocksync): sort peers by download rate & multiple requests for
closer blocks ([#2475](https://github.com/cometbft/cometbft/pull/2475))**
- **feat(pbts): Adjusts PBTS metrics buckets ([#2578](https://github.com/cometbft/cometbft/pull/2578))**
- **fix(blocksync): use timer instead of time.After ([#2584](https://github.com/cometbft/cometbft/pull/2584))**
- **fix: temporary fix for `api` dependency ([#2589](https://github.com/cometbft/cometbft/pull/2589))**

---------

Signed-off-by: Thane Thomson <connect@thanethomson.com>
Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Thane Thomson <connect@thanethomson.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Anton Kaliaev <anton.kalyaev@gmail.com>
Co-authored-by: Mikhail Zabaluev <mikhail@informal.systems>
Co-authored-by: Troy Kessler <43882936+troykessler@users.noreply.github.com>
Co-authored-by: leven <112051166+lx-xiang@users.noreply.github.com>
Co-authored-by: werty144 <anton-paramonov2000@yandex.ru>
Co-authored-by: Adi Seredinschi <adizere@gmail.com>
Co-authored-by: Sukey <35202440+sukey2008@users.noreply.github.com>
Co-authored-by: Sergio Mena <sergio@informal.systems>
Co-authored-by: Jasmina Malicevic <jasmina.dustinac@gmail.com>
Co-authored-by: moriluka <85185077+moriluka@users.noreply.github.com>
Co-authored-by: ƒê·ªó Vi·ªát Ho√†ng <hoangdv2429@gmail.com>
Co-authored-by: alex <152680487+azukiboy@users.noreply.github.com>
Co-authored-by: Hern√°n Vanzetto <15466498+hvanz@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@informal.systems>
Co-authored-by: Andy Nogueira <me@andynogueira.dev>
Co-authored-by: nenadmilosevic95 <50905385+nenadmilosevic95@users.noreply.github.com>
Co-authored-by: nenadmilosevic95 <nenad@informal.systems>
Co-authored-by: Jacob Gadikian <jacobgadikian@gmail.com>
Co-authored-by: Greg Szabo <16846635+greg-szabo@users.noreply.github.com>
Co-authored-by: Emmanuel T Odeke <emm.odeke@gmail.com>
Co-authored-by: jchappelow <140431406+jchappelow@users.noreply.github.com>
Co-authored-by: shuoer86 <129674997+shuoer86@users.noreply.github.com>
Co-authored-by: levisyin <150114626+levisyin@users.noreply.github.com>
Co-authored-by: vuittont60 <81072379+vuittont60@users.noreply.github.com>
Co-authored-by: Halimao <1065621723@qq.com>
Co-authored-by: alex <152680487+bodhi-crypo@users.noreply.github.com>
Co-authored-by: Daniel <daniel.cason@usi.ch>
Co-authored-by: Josef Widder <44643235+josef-widder@users.noreply.github.com>
Co-authored-by: William Banfield <4561443+williambanfield@users.noreply.github.com>
Co-authored-by: Kukovec <jure.kukovec@gmail.com>
Co-authored-by: Daniel Cason <cason@gandria>
Co-authored-by: M. J. Fromberger <fromberger@interchain.io>
Co-authored-by: hattizai <150505746+hattizai@users.noreply.github.com>
Co-authored-by: Huulu <35667132+IssouChancla@users.noreply.github.com>
Co-authored-by: katelyn martin <me+cratelyn@katelyn.world>
Co-authored-by: Richard Gibson <richard.gibson@gmail.com>
Co-authored-by: Jean Deruelle <jean.deruelle@gmail.com>
Co-authored-by: glnro <8335464+glnro@users.noreply.github.com>
Co-authored-by: Greg Szabo <greg@philosobear.com>
Co-authored-by: Emmanuel T Odeke <emmanuel@orijtech.com>
Co-authored-by: levisyin <lilassherl@gmail.com>
Co-authored-by: k0marov <95040709+k0marov@users.noreply.github.com>
Co-authored-by: Adi Seredinschi <a@seredinschi.net>
Co-authored-by: Pan chao <152830401+Pan-chao@users.noreply.github.com>
Co-authored-by: Khanh Hoa <49144992+hoanguyenkh@users.noreply.github.com>
Co-authored-by: glnro <lauren@informal.systems>
Co-authored-by: toni <143221387+xyztoni@users.noreply.github.com>
Co-authored-by: DragonKid <idragonkid@gmail.com>
Co-authored-by: Matt Ketmo <matthieu@moquet.net>
Co-authored-by: Ethan <cosinlinker@gmail.com>
Co-authored-by: Evgeny Danilenko <6655321@bk.ru>
Co-authored-by: Duong Minh Ngoc <153509244+minhngoc274@users.noreply.github.com>
Co-authored-by: Kero <keroroxx520@gmail.com>
```

[DongLieu](/DongLieu)
pushed a commit
to DongCoNY/cometbft
that referenced
this pull request
[May 13, 2024](#ref-commit-3a2169a)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=40&u=c87429c8ce39be75fc58792cfe56a0bfed748ac6&v=4)](/mmsqe) [![@DongLieu](https://avatars.githubusercontent.com/u/93205232?s=40&v=4)](/DongLieu)

`[fix: avoid recursive call after rename to (*PeerState).MarshalJSON (](/DongCoNY/cometbft/commit/3a2169a3839f034a424a9b81d11f9b6dc26e1a10 "fix: avoid recursive call after rename to (*PeerState).MarshalJSON (#865) (#969)

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit 598a9ef4c86fc29cf038251676c33a222217826c.

* Revert \"fix golangci-lint to v1.52.2\"

This reverts commit a8aad121e27382813e95b1911b1b560c62e1c7c3.

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit f6ea09171a2bf9f695f59b65f5c51e4a8c168015)

Co-authored-by: mmsqe <mavis@crypto.com>")[c‚Ä¶](https://github.com/cometbft/cometbft/pull/865)`
‚Ä¶

`[3a2169a](/DongCoNY/cometbft/commit/3a2169a3839f034a424a9b81d11f9b6dc26e1a10)`

```
[‚Ä¶ometbft#865](https://github.com/cometbft/cometbft/pull/865)) ([cometbft#969](https://github.com/cometbft/cometbft/pull/969))

* avoid recursive call after rename to (*PeerState).MarshalJSON

* add test

* add change doc

* explain for nolint

* fix lint

* fix golangci-lint to v1.52.2

* fix golangci-lint to v1.52.2

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [598a9ef](https://github.com/DongCoNY/cometbft/commit/598a9ef4c86fc29cf038251676c33a222217826c).

* Revert "fix golangci-lint to v1.52.2"

This reverts commit [a8aad12](https://github.com/DongCoNY/cometbft/commit/a8aad121e27382813e95b1911b1b560c62e1c7c3).

* Reintroduced `cmtjson`

* Avoid copying Mutex

* Avoid copying Mutex -- 2nd try, more succint

* Update .changelog/unreleased/bug-fixes/865-fix-peerstate-marshaljson.md

* Update consensus/reactor_test.go

---------

Co-authored-by: Sergio Mena <sergio@informal.systems>
(cherry picked from commit [f6ea091](https://github.com/DongCoNY/cometbft/commit/f6ea09171a2bf9f695f59b65f5c51e4a8c168015))

Co-authored-by: mmsqe <mavis@crypto.com>
```

[![@faddat](https://avatars.githubusercontent.com/u/7142025?s=40&v=4)](/faddat)
[faddat](/faddat)
mentioned this pull request
[Oct 15, 2024](#ref-pullrequest-2587916584)

[chore: use latest cometbft-db in v0.38.x
#4296](/cometbft/cometbft/pull/4296)
 Closed

3 tasks

This was referenced Oct 18, 2024

[Missing validation of priorities in validateset in Header and Many Other Known Security Issues are Unsolved
sei-protocol/sei-tendermint#246](/sei-protocol/sei-tendermint/issues/246)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Issues are Unsolved
polynetwork/poly#136](/polynetwork/poly/issues/136)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Issues are Unsolved
pokt-network/tendermint#79](/pokt-network/tendermint/issues/79)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
bnb-chain/greenfield-cometbft#78](/bnb-chain/greenfield-cometbft/issues/78)

Closed

[Missing Validation of Priorities in Validateset in Header and Many Other Known Issues in Cometbft are Unsolved
gnolang/gno#2977](/gnolang/gno/issues/2977)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Issues in Cometbft are Unsolved
DeAI-Artist/Linkis#1](/DeAI-Artist/Linkis/issues/1)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Issues in Cometbft are Unsolved
okx/okbchain#219](/okx/okbchain/issues/219)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
kardiachain/go-kardia#259](/kardiachain/go-kardia/issues/259)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
okx/exchain#3330](/okx/exchain/issues/3330)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
Finschia/ostracon#777](/Finschia/ostracon/issues/777)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
maticnetwork/heimdall#1197](/maticnetwork/heimdall/issues/1197)

Closed

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
bttcprotocol/delivery#100](/bttcprotocol/delivery/issues/100)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
dydxprotocol/cometbft#35](/dydxprotocol/cometbft/issues/35)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
zkMeLabs/mechain-cometbft#21](/zkMeLabs/mechain-cometbft/issues/21)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
reapchain/reapchain-core#31](/reapchain/reapchain-core/issues/31)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
arcology-network/consensus-engine#130](/arcology-network/consensus-engine/issues/130)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
MetisProtocol/themis#1](/MetisProtocol/themis/issues/1)

Open

[Missing Validation of Priorities in Validateset in Header and Many Other Known Security Issues in Cometbft are Unsolved
FiboChain/fbc#1](/FiboChain/fbc/issues/1)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcometbft%2Fcometbft%2Fpull%2F865)

Reviewers

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena) [sergio-mena](/sergio-mena)

sergio-mena approved these changes

[![@cason](https://avatars.githubusercontent.com/u/270778?s=40&v=4)](/cason) [cason](/cason)

cason approved these changes

Assignees

[![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=40&v=4)](/sergio-mena) [sergio-mena](/sergio-mena)

Labels

[backport-to-v0.34.x](/cometbft/cometbft/labels/backport-to-v0.34.x)
Tell Mergify to backport the PR to v0.34.x
[backport-to-v0.37.x](/cometbft/cometbft/labels/backport-to-v0.37.x)
Tell Mergify to backport the PR to v0.37.x
[backport-to-v0.38.x](/cometbft/cometbft/labels/backport-to-v0.38.x)
Tell Mergify to backport the PR to v0.38.x
[bug](/cometbft/cometbft/labels/bug)
Something isn't working

Projects

No open projects
1 closed project

[CometBFT 2023](/orgs/cometbft/projects/1)

Status: Done

 +8 more

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Recursive call after rename to (\*PeerState).MarshalJSON](https://github.com/cometbft/cometbft/issues/863)

5 participants

[![@mmsqe](https://avatars.githubusercontent.com/u/2867936?s=52&v=4)](/mmsqe) [![@MechanicalTyler](https://avatars.githubusercontent.com/u/524638?s=52&v=4)](/MechanicalTyler) [![@taariq](https://avatars.githubusercontent.com/u/701864?s=52&v=4)](/taariq) [![@cason](https://avatars.githubusercontent.com/u/270778?s=52&v=4)](/cason) [![@sergio-mena](https://avatars.githubusercontent.com/u/15381133?s=52&v=4)](/sergio-mena)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

