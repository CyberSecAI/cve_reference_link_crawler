

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1875925)
* [XML](/show_bug.cgi?ctype=xml&id=1875925)

Closed
[Bug 1875925](/show_bug.cgi?id=1875925)
(CVE-2024-31392)

Opened 1 year ago
Closed 11 months ago

# Firefox on iOS incorrectly shows pages with Mixed Content as secure

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox on iOS incorrectly shows pages with Mixed Content as secure

## Categories

### (Firefox for iOS :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [124](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=124) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 124 |  |

## People

### (Reporter: chaykin.artem, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/09d045867c71d02015f025e41dd6fbc9?d=mm&size=40)  [chaykin.artem](/user_profile?user_id=715250)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

3 people

## References

### ( [URL](https://stoletheminerals.github.io/mixedynamic.html "https://stoletheminerals.github.io/mixedynamic.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[stoletheminerals.github.io/mixedynami...](https://stoletheminerals.github.io/mixedynamic.html "https://stoletheminerals.github.io/mixedynamic.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/18382 "https://github.com/mozilla-mobile/firefox-ios/pull/18382")

## Details

### (Keywords: reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-31392

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1287582_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [Simulator Screenshot - iPhone 15 Pro - 2024-01-22 at 21.40.05.png](/attachment.cgi?id=9375871)  [1 year ago](#c0)  [chaykin.artem](/user_profile?user_id=715250)   1.59 MB, image/png |  | [Details](/attachment.cgi?id=9375871&action=edit) |
| --- | --- | --- |
| [Safari debugger](/attachment.cgi?id=9376358)  [1 year ago](#c2)  [chaykin.artem](/user_profile?user_id=715250)   775.48 KB, image/png |  | [Details](/attachment.cgi?id=9376358&action=edit) |
| [Safari debugger fixed](/attachment.cgi?id=9376360)  [1 year ago](#c4)  [chaykin.artem](/user_profile?user_id=715250)   861.73 KB, image/png |  | [Details](/attachment.cgi?id=9376360&action=edit) |
| [advisory.txt](/attachment.cgi?id=9394319)  [9 months ago](#c12)  [mreagan](/user_profile?user_id=734598)   71 bytes, text/plain |  | [Details](/attachment.cgi?id=9394319&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1875925#c0)• 1 year ago |
|  | |

Attached image
[Simulator Screenshot - iPhone 15 Pro - 2024-01-22 at 21.40.05.png](attachment.cgi?id=9375871)
— [Details](attachment.cgi?id=9375871&action=edit)

Firefox on iOS shows that the connection is not secure if a page has mixed content. For example HTTPS page that loads HTTP images or has an HTTP form. This is achieved by checking `webView.hasOnlySecureContent` flag.

Both examples can be observed on <https://stoletheminerals.github.io/mixedcontent.html> and <https://stoletheminerals.github.io/mixedform.html>

However, if the page dynamically add this content with a delay (I found that 1 second is enough to reproduce it), either an image or a form, or both, the URL bar icon will not update correctly and will show the page as secure, even though it isn't.

The PoC is here: <https://stoletheminerals.github.io/mixedynamic.html>

```
<body>
<script>
  setTimeout(function() {
      var image = document.createElement("img");
          image.setAttribute("src", "http://very.badssl.com/image.jpg");
          document.body.appendChild(image);
      const form = `
        <form action="http://stoletheminerals.github.io/mixedform.html" method="post">
          <label for="message">Message:</label><br>
          <textarea id="message" name="message"></textarea><br>
          <input type="submit" value="Submit">
        </form>
      `;
      document.body.innerHTML += form;
    }, 1000);
</script>
</body>
</html>

```

If you click on the lock icon in the URL bar the pop up will show that the page is insecure, but the main icon still shows this as secure (see screenshot attached).

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a8870_406194)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1875925#c1)• 1 year ago |
|  | |

It's possible the underlying webkit is implementing the newer version of the mixed-content spec and upgrading the display content rather than loading it insecurely (Firefox nightly on desktop is doing this, as has Chrome for a long while).

Or it could be an insecure load and we're not listening to some event from webkit that indicates the security state changed? Do you know, Laurie? I don't have a set up where I could debug this on iOS.

Not a terrible security problem or we wouldn't let the content load in the first place, but it's wrong not to inform users if some of the images are potentially tampered with.

Flags: needinfo?(lmarceau)Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1875925#c2)• 1 year ago |
|  | |

Attached image
[Safari debugger](attachment.cgi?id=9376358)
— [Details](attachment.cgi?id=9376358&action=edit)

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1875925#c3)• 1 year ago |
|  | |

Hi Daniel. It 100% loads it insecurely, you can check it in Safari's debugger (please check the new screenshot attached, that one was from Firefox that I built from GitHub sources). I don't think WebKit by default upgrades http media content. In Brave (<https://github.com/brave/brave-ios/pull/8680>) we achieve this by using a content blocker (<https://developer.apple.com/documentation/safariservices/creating_a_content_blocker/>), Chrome on iOS is using the same approach afaik.

Also the content blocker won't block/auto-upgrade HTTP forms.

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1875925#c4)• 1 year ago |
|  | |

Attached image
[Safari debugger fixed](attachment.cgi?id=9376360)
— [Details](attachment.cgi?id=9376360&action=edit)

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1875925#c5)• 1 year ago |
|  | |

Sorry, the previous screenshot didn't show the headers for some reason. Uploaded the new one. You can see that the request was sent to http:// first and badssl.com redirected it to https

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a251662_694570)• 1 year ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1875925#c6)• 1 year ago |
|  | |

Hello thank you for opening this issue. This is great timing as there's currently undergoing work in this area. I tagged the related developer so he can have a look and confirm if this is already solved by an opened PR.

Flags: needinfo?(rlitianu)

|  | [Razvan Litianu](/user_profile?user_id=702765) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1875925#c7)• 1 year ago |
|  | |

hello @chaykin.artem I'm curious what is the expected behaviour. My understanding is for all test websites Firefox for iOS should show the lock icon crossed and the website should be marked as not secure?

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1875925#c8)• 1 year ago |
|  | |

Hi Razvan. Yes, pretty much, all the test pages should show the `Not secure` icon. If you can check <https://stoletheminerals.github.io/mixedynamic.html> in Chrome iOS it will update the url bar icon once the untrusted content is loaded after the delay. I think the correct approach would be to monitor `hasOnlySecureContent` state and change the url bar icon once it starts to return `false`

|  | [Razvan Litianu](/user_profile?user_id=702765) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1875925#c9)• 1 year ago |
|  | |

Cool. I have a [PR](https://github.com/mozilla-mobile/firefox-ios/pull/18382) open with a fix for the tracking protection lock icon. From my testing it seems to work now.

Flags: needinfo?(rlitianu)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a595674_694570)• 1 year ago |

See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/18382>

|  | [chaykin.artem](/user_profile?user_id=715250)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1875925#c10)• 1 year ago |
|  | |

I tested your branch and can confirm it works correctly now

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a837736_694570)• 11 months ago |

Group: mobile-core-security → core-security-releaseStatus: UNCONFIRMED → RESOLVEDClosed: 11 months ago
[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [124](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=124)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a1287582_1689)• 11 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1875925#c11)• 11 months ago |
|  | |

Verified as fixed on v124 (39092) with iPhone 15 Pro (17.1.2).

Status: RESOLVED → VERIFIED

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1875925#c12)• 9 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9394319)
— [Details](attachment.cgi?id=9394319&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a6119341_578488)• 9 months ago |

Alias: CVE-2024-31392

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a11133210_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875925#a27202321_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1875925&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [chaykin.artem](/user_profile?user_id=715250)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

