=== Content from security.netapp.com_e93888f5_20250111_040217.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-2312 Grub2 Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240426-0003)

## CVE-2024-2312 Grub2 Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240426-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240426-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240426-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240426-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240426-0003
**Version:**
4.0

**Last updated:**
05/24/2024

**Status:**
Interim.

**CVEs:** CVE-2024-2312

Overview
#### Summary

Multiple NetApp products incorporate Grub2. Certain versions of Grub2 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-2312](https://nvd.nist.gov/vuln/detail/CVE-2024-2312) | 6.7 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* [https://bugs.launchpad.net/ubuntu/+source/grub2-unsigned/+bug/2054127](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127)

Affected Products
#### Affected Products

None.

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240426-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240426 | Initial Public Release |
| 2.0 | 20240501 | Cloud Volumes ONTAP Mediator moved to Products Not Affected |
| 3.0 | 20240508 | ONTAP tools for VMware vSphere 9 moved to Products Not Affected |
| 4.0 | 20240524 | SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from bugs.launchpad.net_16dc0d6a_20250111_040217.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[grub2-unsigned package](https://launchpad.net/ubuntu/%2Bsource/grub2-unsigned)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/grub2-unsigned)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/grub2-unsigned)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/grub2-unsigned)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/grub2-unsigned)

# grub-efi crashes upon `exit`

Bug #2054127 reported by
[Mate Kukri](https://launchpad.net/~mkukri)
on 2024-02-16

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [grub2 (Debian)](https://bugs.launchpad.net/debian/%2Bsource/grub2 "Latest release: 2.12-5, uploaded to main on 2024-07-15 22:37:41.214833+00:00 by GRUB Maintainers (pkg-grub-devel-b), maintained by GRUB Maintainers (pkg-grub-devel-b)") | New | Undecided | Unassigned |  |
|  | [grub2-unsigned (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned "Latest release: 2.12-1ubuntu7.1, uploaded to main on 2024-09-11 13:18:21.206100+00:00 by Mate Kukri (mkukri), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Medium | [Mate Kukri](https://launchpad.net/~mkukri) |  |
|  | [Mantic](https://bugs.launchpad.net/ubuntu/mantic/%2Bsource/grub2-unsigned) | Fix Released | Undecided | Unassigned |  |
|  | [Noble](https://bugs.launchpad.net/ubuntu/noble/%2Bsource/grub2-unsigned) | Fix Released | Medium | [Mate Kukri](https://launchpad.net/~mkukri) |  |

### Bug Description

[Impact]

Signed grub2 binaries in Ubuntu Mantic are affected by CVE-2024-2312. Please see details below.

[Test Plan]

Make sure Ubuntu Mantic still boots with the new GRUB.

[Where problems could occur]

Not very likely, Ubuntu Mantic fix is a simple git revert of the faulty change.

================================================================================

This was the original issue description, which is kept for reference.

grub> exit

!!!! X64 Exception Type - 06(#UD - Invalid Opcode) CPU Apic ID - 00000000 !!!!

RIP - 000000005AE781A6, CS - 0000000000000038, RFLAGS - 0000000000210202

RAX - 000000005C903E90, RCX - 000000005D93B918, RDX - 000000E8DB694800

RBX - 8000000000000001, RSP - 000000007EEF4AE8, RBP - 000000007EEF04A0

RSI - 000000007EF09440, RDI - 000000007F703B48

R8 - 0000000000000000, R9 - 0000000000000000, R10 - 000000005C8F147C

R11 - 000000005ABB1340, R12 - 0000000000000000, R13 - 000000005ADA7C13

R14 - 000000005C8F15AB, R15 - 000000005C9040A0

DS - 0000000000000030, ES - 0000000000000030, FS - 0000000000000030

GS - 0000000000000030, SS - 0000000000000030

CR0 - 0000000080010033, CR2 - 0000000000000000, CR3 - 000000005EC01000

CR4 - 0000000000000668, CR8 - 0000000000000000

DR0 - 0000000000000000, DR1 - 0000000000000000, DR2 - 0000000000000000

DR3 - 0000000000000000, DR6 - 00000000FFFF0FF0, DR7 - 0000000000000400

GDTR - 000000005E9E0000 0000000000000047, LDTR - 0000000000000000

IDTR - 000000005E39F018 0000000000000FFF, TR - 0000000000000000

FXSAVE\_STATE - 000000007EEF4740

!!!! Find image based on IP(0x5AE781A6) (No PDB) (ImageBase=0000000054CDB000, EntryPoint=0000000055A70304) !!!!

Exiting grub-efi causes my OVMF virtual machine to crash with the above error.

The #UD likely comes from some global hook not being uninstalled.

See [original description](comments/0)

Tags:

[patch](/ubuntu/%2Bsource/grub2-unsigned/%2Bbugs?field.tag=patch)
[verification-done](/ubuntu/%2Bsource/grub2-unsigned/%2Bbugs?field.tag=verification-done)
[verification-done-mantic](/ubuntu/%2Bsource/grub2-unsigned/%2Bbugs?field.tag=verification-done-mantic)

## Related branches

[~ubuntu-uefi-team/grub/+git/ubuntu:ubuntu](https://code.launchpad.net/~ubuntu-uefi-team/grub/%2Bgit/ubuntu/%2Bref/ubuntu)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~ubuntu-uefi-team/grub/%2Bgit/ubuntu/%2Bmerge/461796)
into
[~ubuntu-core-dev/grub/+git/ubuntu:ubuntu](https://code.launchpad.net/~ubuntu-core-dev/grub/%2Bgit/ubuntu/%2Bref/ubuntu)
at
[revision f1625e10dda448f9592c1f2b3142a43cf9b5d46b](https://git.launchpad.net/~ubuntu-core-dev/grub/%2Bgit/ubuntu/commit/?id=f1625e10dda448f9592c1f2b3142a43cf9b5d46b)

[Julian Andres Klode](https://launchpad.net/~juliank):
Pending
requested
2024-03-05

Diff: [2339 lines (+1674/-237)](https://code.launchpad.net/~ubuntu-uefi-team/grub/%2Bgit/ubuntu/%2Bmerge/461796/%2Bpreview-diff/1058177/%2Bfiles/preview.diff)24 files modifieddebian/build-efi-images (+6/-0)
debian/changelog (+26/-0)
debian/control (+2/-0)
debian/grub-sort-version (+2/-2)
debian/patches/grub-sort-version.patch (+16/-1)
debian/patches/kern-efi-mm-Change-grub\_efi\_allocate\_pages\_real-to-call-s.patch (+36/-0)
debian/patches/kern-efi-mm-Change-grub\_efi\_mm\_add\_regions-to-keep-track-.patch (+69/-0)
debian/patches/kern-efi-mm-Detect-calls-to-grub\_efi\_drop\_alloc-with-wron.patch (+34/-0)
debian/patches/nx/efi-Disallow-fallback-to-legacy-Linux-loader-when-shim-sa.patch (+116/-0)
debian/patches/nx/modules-Don-t-allocate-space-for-non-allocable-sections.patch (+37/-0)
debian/patches/nx/modules-load-module-sections-at-page-aligned-addresses.patch (+390/-0)
debian/patches/nx/modules-strip-.llvm\_addrsig-sections-and-similar.patch (+41/-0)
debian/patches/nx/nx-add-memory-attribute-get-set-API.patch (+252/-0)
debian/patches/nx/nx-set-page-permissions-for-loaded-modules.patch (+222/-0)
debian/patches/nx/nx-set-the-nx-compatible-flag-in-EFI-grub-images.patch (+49/-0)
debian/patches/nx/peimage-Add-memory-attribute-support.patch (+132/-0)
debian/patches/secure-boot/efi-use-peimage-shim.patch (+151/-227)
debian/patches/series (+11/-0)
debian/patches/suse-grub.texi-add-net\_bootp6-document.patch (+3/-3)
debian/patches/ubuntu-fix-lzma-decompressor-objcopy.patch (+1/-1)
debian/patches/ubuntu-support-initrd-less-boot.patch (+1/-1)
debian/rules (+3/-0)
debian/sbat.ubuntu.csv.in (+2/-2)
debian/test\_grub\_sort\_version.py (+72/-0)
[api](/~ubuntu-uefi-team/grub/%2Bgit/ubuntu/%2Bmerge/461796/%2Bpreview-diff/1058177)

## CVE References

* [2024-2312](/bugs/cve/2024-2312 "GRUB2 does not call the module fini f...")

[Mate Kukri (mkukri)](https://launchpad.net/~mkukri)
on 2024-02-16

| Changed in grub2-unsigned (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → Mate Kukri (mkukri) |
| **importance**: | Undecided → Medium |
| **tags**: | added: foundations-todo |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-03: |  |  | [#1](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/1) |
| --- | --- | --- | --- |

I am setting this to "Private Security" as I believe this potentially is exploitable to gain unsigned code execution and bypass UEFI Secure Boot.

I am setting this to "Private Security" as I believe this potentially is exploitable to gain unsigned code execution and bypass UEFI Secure Boot.

| **information type**: | Public → Private Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-04: |  |  | [#2](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/2) |
| --- | --- | --- | --- |

Marking Debian as affected to as this issue was introduced there.

Marking Debian as affected to as this issue was introduced there.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-04: |  |  | [#3](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/3) |
| --- | --- | --- | --- |

* [0001-peimage-Move-systab-hook-un-installation-to-be-right.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Battachment/5752367/%2Bfiles/0001-peimage-Move-systab-hook-un-installation-to-be-right.patch)
  [Edit](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Battachment/5752367)
  (4.0 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2024-03-05: |  |  | [#4](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/4) |
| --- | --- | --- | --- |

In the teardown version, when the original functions are put back, do we run the risk of putting back functions from another module that have also been unloaded?

eg:

load A

load B

unload A

unload B

The Unload B operation may be putting back hooks that were installed by A when it was loaded first.

Unloading modules is often very challenging to get correct. Does grub actually \*need\* this functionality? It might be better to just pave over the functionality and prevent dangling pointers to functions by just never allowing the functions to be unmapped.

Thanks

In the teardown version, when the original functions are put back, do we run the risk of putting back functions from another module that have also been unloaded?
eg:
load A
load B
unload A
unload B
The Unload B operation may be putting back hooks that were installed by A when it was loaded first.
Unloading modules is often very challenging to get correct. Does grub actually \*need\* this functionality? It might be better to just pave over the functionality and prevent dangling pointers to functions by just never allowing the functions to be unmapped.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-05 (last edit on 2024-03-05): |  |  | [#5](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/5) |
| --- | --- | --- | --- |

Do you mean by "teardown version" the original one in peimage code? I don't think there is that specific problem because the only signed grub module that hooks these functions is peimage. And if you chainload multiple copies of GRUB itself (by extension the peimage module contained within) they always load-unload in a stack like manner because we only support chainloading applications.

We can and should get rid of unloading modules at least in secure boot mode, but that wouldnt help with this specific bug sadly. the problem here is that when grub itself exits, the module fini functions are \*not called\*, apparently by design.

But the systab pointers hooked are system global to UEFI, so we have to re-install them if we want to allow exiting grub itself without resetting the system.

I think moving the hook install/removal to before/after EFI image entry and exit is the right approach here, because with that the hooks arent installed by the time anything can interact with the copy of grub that installed the hooks, and child images running via peimage cannot unload their parent without first exiting themselves. (because there are stackframes pointing to the parent grub anyhow)

Do you mean by "teardown version" the original one in peimage code? I don't think there is that specific problem because the only signed grub module that hooks these functions is peimage. And if you chainload multiple copies of GRUB itself (by extension the peimage module contained within) they always load-unload in a stack like manner because we only support chainloading applications.
We can and should get rid of unloading modules at least in secure boot mode, but that wouldnt help with this specific bug sadly. the problem here is that when grub itself exits, the module fini functions are \*not called\*, apparently by design.
But the systab pointers hooked are system global to UEFI, so we have to re-install them if we want to allow exiting grub itself without resetting the system.
I think moving the hook install/removal to before/after EFI image entry and exit is the right approach here, because with that the hooks arent installed by the time anything can interact with the copy of grub that installed the hooks, and child images running via peimage cannot unload their parent without first exiting themselves. (because there are stackframes pointing to the parent grub anyhow)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-06 (last edit on 2024-03-06): |  |  | [#6](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/6) |
| --- | --- | --- | --- |

Current proposed plan is:

1. Assign CVE ourselves

2. Prepare package updates for noble and sid and set the "CRD" as to whenever we are ready to upload

3. Bump SbatLevel to "grub.peimage,2" in the July update for everyone

+1 Spend some time auditing peimage.c to make sure this is all

Current proposed plan is:
1. Assign CVE ourselves
2. Prepare package updates for noble and sid and set the "CRD" as to whenever we are ready to upload
3. Bump SbatLevel to "grub.peimage,2" in the July update for everyone
+1 Spend some time auditing peimage.c to make sure this is all

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2024-03-06: |  |  | [#7](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/7) |
| --- | --- | --- | --- |

Disabling unloading in secure boot mode sounds like a good idea to me.

Your comment about "allow exiting grub without resetting the system" makes me wonder if we strictly need that feature, too. I can see some sense to "once you're in grub you either have to boot the next operating system or you have to reboot". Anything else would allow whatever functionality is in grub to change UEFI context that might mess with some other operating system, right?

Thanks

Disabling unloading in secure boot mode sounds like a good idea to me.
Your comment about "allow exiting grub without resetting the system" makes me wonder if we strictly need that feature, too. I can see some sense to "once you're in grub you either have to boot the next operating system or you have to reboot". Anything else would allow whatever functionality is in grub to change UEFI context that might mess with some other operating system, right?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-03-06: |  |  | [#8](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/8) |
| --- | --- | --- | --- |

Currently MAAS relies on exiting GRUB when booting a 3rd party operating system that isn't currently bootable via the Canonical shim. We do plan on fixing this by allowing shim chainloading, but currently exit is required for MAAS.

After that it would be possible to get rid of exit, and from a security engineering perspective it would be nice as it would avoid all the resource deallocation paths, but as a user it would annoy me a little bit, so I am not entirely sure what is the right choice.

Currently MAAS relies on exiting GRUB when booting a 3rd party operating system that isn't currently bootable via the Canonical shim. We do plan on fixing this by allowing shim chainloading, but currently exit is required for MAAS.
After that it would be possible to get rid of exit, and from a security engineering perspective it would be nice as it would avoid all the resource deallocation paths, but as a user it would annoy me a little bit, so I am not entirely sure what is the right choice.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-03-09: |  |  | [#9](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/9) |
| --- | --- | --- | --- |

Please refer to this issue as CVE-2024-2312.

Máté will implement Debian fix, so extra coordination is not needed.

Please refer to this issue as CVE-2024-2312.
Máté will implement Debian fix, so extra coordination is not needed.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-03-14: |  |  | [#10](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/10) |
| --- | --- | --- | --- |

The public Coordinated Release Date for CVE-2024-2312 has been set to March 20th at 2PM UTC.

The public Coordinated Release Date for CVE-2024-2312 has been set to March 20th at 2PM UTC.

[Mate Kukri (mkukri)](https://launchpad.net/~mkukri)
on 2024-04-04

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-04-05: |  |  | [#11](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/11) |
| --- | --- | --- | --- |

A fix has been released to Noble proposed and the CVE has been published.

[https://launchpad.net/ubuntu/+source/grub2/2.12-1ubuntu7](https://launchpad.net/ubuntu/%2Bsource/grub2/2.12-1ubuntu7)

A fix has been released to Noble proposed and the CVE has been published.
https://launchpad.net/ubuntu/+source/grub2/2.12-1ubuntu7

| **information type**: | Private Security → Public Security |
| --- | --- |

[Julian Andres Klode (juliank)](https://launchpad.net/~juliank)
on 2024-04-05

| Changed in grub2-unsigned (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton) wrote on 2024-04-05: |  |  | [#12](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/12) |
| --- | --- | --- | --- |

The attachment "0001-peimage-Move-systab-hook-un-installation-to-be-right.patch" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

The attachment "0001-peimage-Move-systab-hook-un-installation-to-be-right.patch" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.
[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-04-07: |  |  | [#13](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/13) |
| --- | --- | --- | --- |

This bug was fixed in the package grub2-unsigned - 2.12-1ubuntu7

---------------

grub2-unsigned (2.12-1ubuntu7) noble; urgency=medium

\* d/p/grub-sort-version.patch: Also patch grub-mkconfig to export GRUB\_FLAVOUR\_ORDER

  \* d/grub-sort-version: Update regex to correctly match kernel flavour

  \* d/grub-sort-version: Append `-0` to abi strings before passing to python-apt (Fixes LP: [#2041827](/bugs/2041827))

  \* debian/: Add tests for grub-sort-version

  \* Revert peimage to re-use GRUB's image handle (LP: [#2057679](/bugs/2057679)) (LP: [#2054127](/bugs/2054127))

  \* Increase SBAT level to "grub.ubuntu,2" and "grub.peimage,2"

  \* d/build-efi-images: Make sure downstream didn't remove peimage SBAT entry

  \* SECURITY UPDATE: Use-after-free in peimage module [LP: [#2054127](/bugs/2054127)]

    - CVE-2024-2312

  \* Source package generated from src:grub2 using make -f ./debian/rules

    generate-grub2-unsigned

-- Mate Kukri <email address hidden> Thu, 04 Apr 2024 11:12:35 +0100

This bug was fixed in the package grub2-unsigned - 2.12-1ubuntu7
---------------
grub2-unsigned (2.12-1ubuntu7) noble; urgency=medium
\* d/p/grub-sort-version.patch: Also patch grub-mkconfig to export GRUB\_FLAVOUR\_ORDER
\* d/grub-sort-version: Update regex to correctly match kernel flavour
\* d/grub-sort-version: Append `-0` to abi strings before passing to python-apt (Fixes LP: #2041827)
\* debian/: Add tests for grub-sort-version
\* Revert peimage to re-use GRUB's image handle (LP: #2057679) (LP: #2054127)
\* Increase SBAT level to "grub.ubuntu,2" and "grub.peimage,2"
\* d/build-efi-images: Make sure downstream didn't remove peimage SBAT entry
\* SECURITY UPDATE: Use-after-free in peimage module [LP: #2054127]
- CVE-2024-2312
\* Source package generated from src:grub2 using make -f ./debian/rules
generate-grub2-unsigned
-- Mate Kukri <mate.kukri@canonical.com> Thu, 04 Apr 2024 11:12:35 +0100

| Changed in grub2-unsigned (Ubuntu Noble): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2024-04-11: |  |  | [#14](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/14) |
| --- | --- | --- | --- |

This bug needs verification for mantic, added tags.

This bug needs verification for mantic, added tags.

| **tags**: | added: verification-needed verification-needed-manticremoved: foundations-todo |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mate Kukri (mkukri)](https://launchpad.net/~mkukri) wrote on 2024-04-12: |  |  | [#15](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/15) |
| --- | --- | --- | --- |

Verification OK, mantic remains bootable after upgrading to proposed package.

Verification OK, mantic remains bootable after upgrading to proposed package.

| **tags**: | added: verification-done verification-done-manticremoved: verification-needed verification-needed-mantic |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-07-01: |  |  | [#16](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/16) |
| --- | --- | --- | --- |

This bug was fixed in the package grub2-unsigned - 2.12~rc1-10ubuntu4.2

---------------

grub2-unsigned (2.12~rc1-10ubuntu4.2) mantic; urgency=medium

\* Revert "efi: Eliminate globals from the `peimage.c` chainloader"

    (LP: [#2057679](/bugs/2057679)) (LP: [#2054127](/bugs/2054127))

  \* Increase SBAT level to "grub.ubuntu,2" and "grub.peimage,2"

  \* SECURITY UPDATE: Use-after-free in peimage module [LP: [#2054127](/bugs/2054127)]

    - CVE-2024-2312

  \* Source package generated from src:grub2 using make -f ./debian/rules

    generate-grub2-unsigned

-- Mate Kukri <email address hidden> Thu, 21 Mar 2024 09:16:17 +0000

This bug was fixed in the package grub2-unsigned - 2.12~rc1-10ubuntu4.2
---------------
grub2-unsigned (2.12~rc1-10ubuntu4.2) mantic; urgency=medium
\* Revert "efi: Eliminate globals from the `peimage.c` chainloader"
(LP: #2057679) (LP: #2054127)
\* Increase SBAT level to "grub.ubuntu,2" and "grub.peimage,2"
\* SECURITY UPDATE: Use-after-free in peimage module [LP: #2054127]
- CVE-2024-2312
\* Source package generated from src:grub2 using make -f ./debian/rules
generate-grub2-unsigned
-- Mate Kukri <mate.kukri@canonical.com> Thu, 21 Mar 2024 09:16:17 +0000

| Changed in grub2-unsigned (Ubuntu Mantic): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Łukasz Zemczak (sil2100)](https://launchpad.net/~sil2100) wrote on 2024-07-01:  [**Update Released**](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/17) |  |  | [#17](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/comments/17) |
| --- | --- | --- | --- |

The verification of the Stable Release Update for grub2-unsigned has completed successfully and the package is now being released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regressions.

The verification of the Stable Release Update for grub2-unsigned has completed successfully and the package is now being released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regressions.

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/grub2-unsigned/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-peimage-Move-systab-hook-un-installation-to-be-right.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Battachment/5752367/%2Bfiles/0001-peimage-Move-systab-hook-un-installation-to-be-right.patch)
  [Edit](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Battachment/5752367 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/grub2-unsigned/%2Bbug/2054127/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


