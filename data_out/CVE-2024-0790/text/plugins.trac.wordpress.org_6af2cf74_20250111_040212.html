

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbulk-editor%2Ftrunk%2Findex.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/bulk-editor/trunk/index.php?rev=3182148 "Revision 3182148")
* Next Revision →
* [Blame](/browser/bulk-editor/trunk/index.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/bulk-editor/trunk/index.php)

---

# [source:](/browser?order=name "Go to repository root") [bulk-editor](/browser/bulk-editor?order=name "View bulk-editor")/[trunk](/browser/bulk-editor/trunk?order=name "View trunk")/[index.php](/browser/bulk-editor/trunk/index.php?order=name "View index.php")

View diff against:

View revision:

| [Last change](/changeset/3199354/bulk-editor/trunk/index.php "View differences") on this file was [3199354](/changeset/3199354/ "View changeset 3199354"), checked in by RealMag777, [6 weeks ago](/timeline?from=2024-11-29T10%3A23%3A12Z&precision=second "See timeline at 11/29/2024 10:23:12 AM") |
| --- |
| security fix - thanks to Trương Hữu Phúc (truonghuuphuc) and [patchstack.com]([​https://patchstack.com/](https://patchstack.com/)) |
| **File size:** 60.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: WOLF - WordPress Posts Bulk Editor and Manager Professional |
| [4](#L4) | Plugin URI: https://bulk-editor.pro/ |
| [5](#L5) | Description: Tools for managing and bulk edit posts, pages and all custom types data in the reliable and flexible way! Be professionals with managing data of your site! |
| [6](#L6) | Requires at least: WP 4.9 |
| [7](#L7) | Tested up to: WP 6.7 |
| [8](#L8) | Author: realmag777 |
| [9](#L9) | Author URI: https://pluginus.net/ |
| [10](#L10) | Version: 1.0.8.6 |
| [11](#L11) | Requires PHP: 5.6 |
| [12](#L12) | Tags: bulk,bulk edit,bulk editor,posts editor,bulk delete,real estate,posts manager,meta bulk edit |
| [13](#L13) | Text Domain: bulk-editor |
| [14](#L14) | Domain Path: /languages |
| [15](#L15) | Forum URI: https://pluginus.net/support/forum/wpbe-wordpress-posts-bulk-editor-professional/ |
| [16](#L16) | \*/ |
| [17](#L17) |  |
| [18](#L18) | //update\_option('wpbe\_options\_' . get\_current\_user\_id(), ''); //reset of the plugin settings - be care |
| [19](#L19) | if (!defined('ABSPATH')) { |
| [20](#L20) | exit; // Exit if accessed directly |
| [21](#L21) | } |
| [22](#L22) |  |
| [23](#L23) | if (defined('WPBE\_PATH')) { |
| [24](#L24) | add\_action('admin\_notices', function () { |
| [25](#L25) | ?> |
| [26](#L26) | <div class="notice notice-error"> |
| [27](#L27) | <p><?php esc\_html\_e("Hello, looks like you bought and installed premium version of WOLF - WordPress Posts Bulk Editor and Manager Professional, please deactivate free version before, then uninstall it. 2 versions of the same plugin cannot be activated on the same time!", 'bulk-editor'); ?></p> |
| [28](#L28) | </div> |
| [29](#L29) | <?php |
| [30](#L30) | }); |
| [31](#L31) | return; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | //\*\*\* |
| [35](#L35) |  |
| [36](#L36) | define('WPBE\_PATH', plugin\_dir\_path(\_\_FILE\_\_)); |
| [37](#L37) | define('WPBE\_LINK', plugin\_dir\_url(\_\_FILE\_\_)); |
| [38](#L38) | define('WPBE\_ASSETS\_LINK', WPBE\_LINK . 'assets/'); |
| [39](#L39) | define('WPBE\_DATA\_PATH', WPBE\_PATH . 'data/'); |
| [40](#L40) | define('WPBE\_PLUGIN\_NAME', plugin\_basename(\_\_FILE\_\_)); |
| [41](#L41) | define('WPBE\_VERSION', '1.0.8.6'); |
| [42](#L42) | //define('WPBE\_VERSION', uniqid('wpbe-')); //dev |
| [43](#L43) | define('WPBE\_MIN\_WP\_VERSION', '4.9'); |
| [44](#L44) |  |
| [45](#L45) | //libs |
| [46](#L46) | include WPBE\_PATH . 'lib/storage.php'; |
| [47](#L47) |  |
| [48](#L48) | //data |
| [49](#L49) | include\_once WPBE\_DATA\_PATH . 'fields.php'; |
| [50](#L50) | include\_once WPBE\_DATA\_PATH . 'settings.php'; |
| [51](#L51) |  |
| [52](#L52) | //classes |
| [53](#L53) | include WPBE\_PATH . 'classes/helper.php'; |
| [54](#L54) | include WPBE\_PATH . 'classes/models/profiles.php'; |
| [55](#L55) | include WPBE\_PATH . 'classes/models/settings.php'; |
| [56](#L56) | include WPBE\_PATH . 'classes/models/posts.php'; |
| [57](#L57) | include WPBE\_PATH . 'classes/ext.php'; |
| [58](#L58) |  |
| [59](#L59) | //29-11-2024 |
| [60](#L60) | final class WPBE { |
| [61](#L61) |  |
| [62](#L62) | public $storage = NULL; |
| [63](#L63) | public $settings = NULL; |
| [64](#L64) | public $posts = NULL; |
| [65](#L65) | public $profiles = NULL; |
| [66](#L66) | private $ext = array('filters', 'bulk', 'export', 'meta', 'history', 'calculator', 'info', 'fprofiles', 'author\_area'); |
| [67](#L67) | public $show\_notes = true; |
| [68](#L68) | //extensions |
| [69](#L69) | public $filters = null; |
| [70](#L70) | public $bulk = null; |
| [71](#L71) | public $export = null; |
| [72](#L72) | public $meta = null; |
| [73](#L73) | public $history = null; |
| [74](#L74) | public $calculator = null; |
| [75](#L75) | public $info = null; |
| [76](#L76) | public $fprofiles = null; |
| [77](#L77) | public $author\_area = null; |
| [78](#L78) |  |
| [79](#L79) | public function \_\_construct() { |
| [80](#L80) | add\_action('admin\_enqueue\_scripts', array($this, 'admin\_enqueue\_scripts')); |
| [81](#L81) | add\_filter('wpbe\_post\_statuses', array($this, 'add\_statuses')); |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | public function init() { |
| [85](#L85) |  |
| [86](#L86) | if (!is\_admin()) { |
| [87](#L87) | return; |
| [88](#L88) | } |
| [89](#L89) | //wp editor |
| [90](#L90) | add\_action('admin\_footer', array($this, 'wp\_editor\_compatibility')); |
| [91](#L91) |  |
| [92](#L92) | //no one operation is possible if user is not a posts administrator!! |
| [93](#L93) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [94](#L94) | return; |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | $this->ask\_favour(); |
| [98](#L98) |  |
| [99](#L99) | //\*\*\* |
| [100](#L100) |  |
| [101](#L101) | add\_filter('plugin\_action\_links\_' . WPBE\_PLUGIN\_NAME, array($this, 'plugin\_action\_links'), 50); |
| [102](#L102) |  |
| [103](#L103) | if (class\_exists('SitePress')) { |
| [104](#L104) | add\_filter('wpbe\_current\_language', function () { |
| [105](#L105) | //WPML compatibility |
| [106](#L106) | //because if it will be selected 'all' language - will be shown default one |
| [107](#L107) | return ICL\_LANGUAGE\_CODE; |
| [108](#L108) | }); |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | //\*\*\* |
| [112](#L112) |  |
| [113](#L113) | if (isset($\_GET['page']) AND $\_GET['page'] == 'wpbe') { |
| [114](#L114) |  |
| [115](#L115) | add\_action('admin\_notices', function () { |
| [116](#L116) | $user\_id = get\_current\_user\_id(); |
| [117](#L117) | if (!get\_user\_meta($user\_id, 'wpbe\_notice\_dismissed')) { |
| [118](#L118) | ?> |
| [119](#L119) | <div class="notice notice-warning"> |
| [120](#L120) | <p> |
| [121](#L121) | <?php esc\_html\_e('If you not familiar with the plugin, firstly', 'bulk-editor') ?> |
| [122](#L122) | <?php |
| [123](#L123) | WPBE\_HELPER::draw\_link\_e(array( |
| [124](#L124) | 'title' => esc\_html\_\_('visit this page', 'bulk-editor'), |
| [125](#L125) | 'href' => 'https://bulk-editor.pro/document/posts-editor/', |
| [126](#L126) | 'target' => '\_blank', |
| [127](#L127) | )); |
| [128](#L128) | ?> |
| [129](#L129) | <?php esc\_html\_e('please', 'bulk-editor') ?> |
| [130](#L130) | </p> |
| [131](#L131) | <a href="admin.php?page=wpbe&wpbe-notice-dismissed=1&notice\_nonce=<?php echo esc\_attr(wp\_create\_nonce('wpbe\_notice\_nonce')) ?>" class="notice-dismiss"></a> |
| [132](#L132) | </div> |
| [133](#L133) | <?php |
| [134](#L134) | } |
| [135](#L135) | }); |
| [136](#L136) | add\_action('admin\_init', function () { |
| [137](#L137) | $user\_id = get\_current\_user\_id(); |
| [138](#L138) | if (isset($\_GET['wpbe-notice-dismissed']) && isset($\_GET['notice\_nonce']) && wp\_verify\_nonce($\_GET['notice\_nonce'], 'wpbe\_notice\_nonce')) { |
| [139](#L139) | add\_user\_meta($user\_id, 'wpbe\_notice\_dismissed', 'true', true); |
| [140](#L140) | } |
| [141](#L141) | }); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | //side bar menu |
| [145](#L145) | if (WPBE\_HELPER::can\_manage\_data()) { |
| [146](#L146) | add\_action('admin\_menu', function () { |
| [147](#L147) | add\_menu\_page(esc\_html\_\_('WOLF Bulk Editor', 'bulk-editor'), esc\_html\_\_('WOLF Bulk Editor', 'bulk-editor'), 'publish\_posts', 'wpbe', function () { |
| [148](#L148) | $this->print\_plugin\_options(); |
| [149](#L149) | }, 'dashicons-hammer', 90); |
| [150](#L150) | }, 99); |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) | add\_action('admin\_bar\_menu', function ($wp\_admin\_bar) { |
| [154](#L154) | $opt = get\_option('wpbe\_options\_' . get\_current\_user\_id()); //not beauty but we need it here |
| [155](#L155) |  |
| [156](#L156) | if (isset($opt['options']['show\_admin\_bar\_menu\_btn']) AND intval($opt['options']['show\_admin\_bar\_menu\_btn']) === 1) { |
| [157](#L157) | $args = array( |
| [158](#L158) | 'id' => 'wpbe-btn', |
| [159](#L159) | 'title' => esc\_html\_\_('WOLF Bulk Editor', 'bulk-editor'), |
| [160](#L160) | 'href' => admin\_url('admin.php?page=wpbe'), |
| [161](#L161) | 'meta' => array( |
| [162](#L162) | 'class' => 'wp-admin-bar-wpbe-btn', |
| [163](#L163) | 'title' => 'WOLF - Posts Bulk Editor Professional' |
| [164](#L164) | ) |
| [165](#L165) | ); |
| [166](#L166) | $wp\_admin\_bar->add\_node($args); |
| [167](#L167) | } |
| [168](#L168) | unset($opt); |
| [169](#L169) | }, 250); |
| [170](#L170) |  |
| [171](#L171) | //do not init hooks and all other parts of the plugins as we not need it on all site pages |
| [172](#L172) | if (!$this->is\_should\_init()) { |
| [173](#L173) | return; |
| [174](#L174) | } |
| [175](#L175) |  |
| [176](#L176) | //\*\*\* |
| [177](#L177) | //include extensions and their hooks |
| [178](#L178) | if (!empty($this->ext)) { |
| [179](#L179) | foreach ($this->ext as $ext\_slug) { |
| [180](#L180) | include WPBE\_PATH . 'ext' . DIRECTORY\_SEPARATOR . $ext\_slug . DIRECTORY\_SEPARATOR . $ext\_slug . '.php'; |
| [181](#L181) | $class\_name = 'WPBE\_' . strtoupper($ext\_slug); |
| [182](#L182) | $this->$ext\_slug = new $class\_name(); |
| [183](#L183) | } |
| [184](#L184) | } |
| [185](#L185) |  |
| [186](#L186) | //wpbe\_ext - include extensions from wp-content folder |
| [187](#L187) | $wpbe\_more\_ext\_path = WP\_CONTENT\_DIR . DIRECTORY\_SEPARATOR . 'wpbe\_ext'; |
| [188](#L188) | if (file\_exists($wpbe\_more\_ext\_path)) { |
| [189](#L189) | $dir = new DirectoryIterator($wpbe\_more\_ext\_path); |
| [190](#L190) | foreach ($dir as $fileinfo) { |
| [191](#L191) | if ($fileinfo->isDir() AND !$fileinfo->isDot()) { |
| [192](#L192) | $ext\_slug = trim($fileinfo->getFilename()); |
| [193](#L193) | include $wpbe\_more\_ext\_path . DIRECTORY\_SEPARATOR . $ext\_slug . DIRECTORY\_SEPARATOR . $ext\_slug . '.php'; |
| [194](#L194) | $class\_name = 'WPBE\_' . strtoupper($ext\_slug); |
| [195](#L195) | $this->$ext\_slug = new $class\_name(); |
| [196](#L196) | $this->ext[] = $ext\_slug; |
| [197](#L197) | } |
| [198](#L198) | } |
| [199](#L199) | } |
| [200](#L200) |  |
| [201](#L201) |  |
| [202](#L202) | //\*\*\* |
| [203](#L203) | //init variables and hooks of the extensions will be applied, for example hook wpbe\_extend\_fields |
| [204](#L204) | $this->storage = new WPBE\_STORAGE(); |
| [205](#L205) | $this->settings = new WPBE\_SETTINGS(); //must be reinit because hooks from exts applied!! |
| [206](#L206) | $this->profiles = new WPBE\_PROFILES($this->settings); |
| [207](#L207) | $this->posts = new WPBE\_POSTS($this->settings, $this->storage); |
| [208](#L208) |  |
| [209](#L209) | if (!empty($this->ext)) { |
| [210](#L210) | foreach ($this->ext as $ext\_slug) { |
| [211](#L211) | //we do it to allow ext hooks works everywhere (in the application and all its extensions) |
| [212](#L212) | $this->$ext\_slug->init\_vars($this->storage, $this->profiles, $this->settings, $this->posts); |
| [213](#L213) | } |
| [214](#L214) | } |
| [215](#L215) |  |
| [216](#L216) |  |
| [217](#L217) | //\*\*\* |
| [218](#L218) |  |
| [219](#L219) | load\_plugin\_textdomain('bulk-editor', false, 'bulk-editor/languages'); |
| [220](#L220) |  |
| [221](#L221) | //ajax |
| [222](#L222) | add\_action('wp\_ajax\_wpbe\_get\_posts', array($this, 'wpbe\_get\_posts'), 1); |
| [223](#L223) | add\_action('wp\_ajax\_wpbe\_update\_page\_field', array($this, 'wpbe\_update\_page\_field'), 1); |
| [224](#L224) | add\_action('wp\_ajax\_wpbe\_redraw\_table\_row', array($this, 'wpbe\_redraw\_table\_row'), 1); |
| [225](#L225) | add\_action('wp\_ajax\_wpbe\_get\_post\_field', array($this, 'get\_post\_field'), 1); |
| [226](#L226) | add\_action('wp\_ajax\_wpbe\_get\_gallery', array($this, 'wpbe\_get\_gallery'), 1); |
| [227](#L227) | add\_action('wp\_ajax\_wpbe\_get\_upsells', array($this, 'wpbe\_get\_upsells'), 1); |
| [228](#L228) |  |
| [229](#L229) | add\_action('wp\_ajax\_wpbe\_create\_new\_post', array($this, 'wpbe\_create\_new\_post'), 1); |
| [230](#L230) | add\_action('wp\_ajax\_wpbe\_duplicate\_posts', array($this, 'wpbe\_duplicate\_posts'), 1); |
| [231](#L231) | add\_action('wp\_ajax\_wpbe\_delete\_posts', array($this, 'wpbe\_delete\_posts'), 1); |
| [232](#L232) |  |
| [233](#L233) | add\_action('wp\_ajax\_wpbe\_create\_new\_term', array($this, 'wpbe\_create\_new\_term'), 1); |
| [234](#L234) | add\_action('wp\_ajax\_wpbe\_update\_tax\_term', array($this, 'wpbe\_update\_tax\_term'), 1); |
| [235](#L235) | add\_action('wp\_ajax\_wpbe\_delete\_tax\_term', array($this, 'wpbe\_delete\_tax\_term'), 1); |
| [236](#L236) |  |
| [237](#L237) | add\_action('wp\_ajax\_wpbe\_set\_active\_post\_type', function () { |
| [238](#L238) | if (!empty($\_REQUEST['post\_type']) AND post\_type\_exists($\_REQUEST['post\_type'])) { |
| [239](#L239) | $this->storage->set\_val('wpbe\_current\_post\_type\_' . get\_current\_user\_id(), $\_REQUEST['post\_type']); |
| [240](#L240) | } |
| [241](#L241) | exit; |
| [242](#L242) | }, 1); |
| [243](#L243) |  |
| [244](#L244) | //\*\*\* |
| [245](#L245) | add\_action('wp\_ajax\_wpbe\_title\_autocomplete', array($this, 'wpbe\_title\_autocomplete')); |
| [246](#L246) | add\_action('wp\_ajax\_wpbe\_save\_options', array($this, 'wpbe\_save\_options'), 1); |
| [247](#L247) |  |
| [248](#L248) | //\*\*\* |
| [249](#L249) | add\_post\_type\_support($this->settings->current\_post\_type, 'author'); |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | /\*\* |
| [253](#L253) | \* Show action links on the plugins page screen |
| [254](#L254) | \*/ |
| [255](#L255) | public function plugin\_action\_links($links) { |
| [256](#L256) |  |
| [257](#L257) | $wpbe\_links = array( |
| [258](#L258) | '<a href="' . admin\_url('admin.php?page=wpbe') . '">' . esc\_html\_\_('Posts Editor', 'bulk-editor') . '</a>', |
| [259](#L259) | '<a target="\_blank" href="' . esc\_url('https://bulk-editor.pro/') . '"><span class="icon-book"></span>&nbsp;' . esc\_html\_\_('Documentation', 'bulk-editor') . '</a>' |
| [260](#L260) | ); |
| [261](#L261) |  |
| [262](#L262) | if ($this->show\_notes) { |
| [263](#L263) | $wpbe\_links[] = '<a target="\_blank" href="https://pluginus.net/affiliate/wordpress-posts-bulk-editor"><span style="color: red; font-weight: bold;">&nbsp;Go Pro!</span></a>'; |
| [264](#L264) | } |
| [265](#L265) |  |
| [266](#L266) | return array\_merge($wpbe\_links, $links); |
| [267](#L267) | } |
| [268](#L268) |  |
| [269](#L269) | public function admin\_enqueue\_scripts() { |
| [270](#L270) | if (isset($\_GET['page']) AND $\_GET['page'] == 'wpbe') { |
| [271](#L271) | ?> |
| [272](#L272) | <script> |
| [273](#L273) | var lang = { |
| [274](#L274) | move: "<?php esc\_html\_e('move', 'bulk-editor') ?>", |
| [275](#L275) | search: "<?php esc\_html\_e('Search', 'bulk-editor') ?>", |
| [276](#L276) | rest\_failed: "<?php esc\_html\_e('Failed', 'bulk-editor') ?>", |
| [277](#L277) | error: "<?php esc\_html\_e('Error', 'bulk-editor') ?>", |
| [278](#L278) | delete: "<?php esc\_html\_e('delete', 'bulk-editor') ?>", |
| [279](#L279) | ignore: "<?php esc\_html\_e('ignore', 'bulk-editor') ?>", |
| [280](#L280) | no\_deletable: "<?php esc\_html\_e('This is not deletable!', 'bulk-editor') ?>", |
| [281](#L281) | no\_items: "<?php esc\_html\_e('no items', 'bulk-editor') ?>", |
| [282](#L282) | none: "<?php esc\_html\_e('none', 'bulk-editor') ?>", |
| [283](#L283) | no\_data: "<?php esc\_html\_e('no data', 'bulk-editor') ?>", |
| [284](#L284) | loading: "<?php esc\_html\_e('Loading', 'bulk-editor') ?> ...", |
| [285](#L285) | loaded: "<?php esc\_html\_e('Loaded', 'bulk-editor') ?>.", |
| [286](#L286) | saved: "<?php esc\_html\_e('Saved', 'bulk-editor') ?>.", |
| [287](#L287) | saving: "<?php esc\_html\_e('Saving', 'bulk-editor') ?> ...", |
| [288](#L288) | apply: "<?php esc\_html\_e('Apply', 'bulk-editor') ?>", |
| [289](#L289) | cancel: "<?php esc\_html\_e('Cancel', 'bulk-editor') ?>", |
| [290](#L290) | canceled: "<?php esc\_html\_e('Canceled', 'bulk-editor') ?>", |
| [291](#L291) | sure: "<?php esc\_html\_e('Sure?', 'bulk-editor') ?>", |
| [292](#L292) | creating: "<?php esc\_html\_e('Creating', 'bulk-editor') ?> ...", |
| [293](#L293) | created: "<?php esc\_html\_e('Created!', 'bulk-editor') ?>", |
| [294](#L294) | duplicating: "<?php esc\_html\_e('Duplicating', 'bulk-editor') ?> ...", |
| [295](#L295) | duplicated: "<?php esc\_html\_e('Duplicated!', 'bulk-editor') ?>", |
| [296](#L296) | deleting: "<?php esc\_html\_e('Deleting', 'bulk-editor') ?> ...", |
| [297](#L297) | deleted: "<?php esc\_html\_e('Deleted!', 'bulk-editor') ?>", |
| [298](#L298) | reseting: "<?php esc\_html\_e('Reseting', 'bulk-editor') ?> ...", |
| [299](#L299) | reseted: "<?php esc\_html\_e('Reseted!', 'bulk-editor') ?>", |
| [300](#L300) | upload\_image: "<?php esc\_html\_e('Upload image', 'bulk-editor') ?>", |
| [301](#L301) | upload\_images: "<?php esc\_html\_e('Upload images', 'bulk-editor') ?>", |
| [302](#L302) | upload\_file: "<?php esc\_html\_e('Upload file', 'bulk-editor') ?>", |
| [303](#L303) | fill\_up\_data: "<?php esc\_html\_e('Fill up the data please!', 'bulk-editor') ?>", |
| [304](#L304) | enter\_duplicate\_count: "<?php printf(esc\_html\_\_('Enter how many time duplicate selected [%s](s)!', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [305](#L305) | enter\_new\_count: "<?php printf(esc\_html\_\_('Enter how many new [%s](s) to create!', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [306](#L306) | search\_input\_placeholder: "<?php esc\_html\_e('Text search by title or SKU', 'bulk-editor') ?>", |
| [307](#L307) | show\_panel: "<?php esc\_html\_e('Show: Filters/Bulk Edit/Export', 'bulk-editor') ?>", |
| [308](#L308) | close\_panel: "<?php esc\_html\_e('Hide: Filters/Bulk Edit/Export', 'bulk-editor') ?>", |
| [309](#L309) | per\_page: "<?php esc\_html\_e('Per page', 'bulk-editor') ?>", |
| [310](#L310) | color\_picker\_col: "<?php esc\_html\_e('Select background color', 'bulk-editor') ?>", |
| [311](#L311) | color\_picker\_txt: "<?php esc\_html\_e('Select text color', 'bulk-editor') ?>", |
| [312](#L312) | sEmptyTable: "<?php esc\_html\_e('No data available in the table', 'bulk-editor') ?>", |
| [313](#L313) | sInfo: "<?php esc\_html\_e('Showing \_START\_ to \_END\_ of \_TOTAL\_ entries', 'bulk-editor') ?>", |
| [314](#L314) | sInfoEmpty: "<?php esc\_html\_e('Showing 0 to 0 of 0 entries', 'bulk-editor') ?>", |
| [315](#L315) | sInfoFiltered: "<?php esc\_html\_e('(filtered from \_MAX\_ total entries)', 'bulk-editor') ?>", |
| [316](#L316) | sLoadingRecords: "<?php esc\_html\_e('Loading...', 'bulk-editor') ?>", |
| [317](#L317) | sProcessing: "<?php esc\_html\_e('Processing...', 'bulk-editor') ?>", |
| [318](#L318) | sZeroRecords: "<?php esc\_html\_e('No matching records found', 'bulk-editor') ?>", |
| [319](#L319) | sFirst: "<?php esc\_html\_e('First', 'bulk-editor') ?>", |
| [320](#L320) | sLast: "<?php esc\_html\_e('Last', 'bulk-editor') ?>", |
| [321](#L321) | sNext: "<?php esc\_html\_e('Next', 'bulk-editor') ?>", |
| [322](#L322) | sPrevious: "<?php esc\_html\_e('Previous', 'bulk-editor') ?>", |
| [323](#L323) | action\_state\_1: "<?php printf(esc\_html\_\_('all the [%s] on the site', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [324](#L324) | action\_state\_2: "<?php printf(esc\_html\_\_('the filtered [%s]. To remove filtering press reset button on the tools panel below', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [325](#L325) | action\_state\_31: "<?php printf(esc\_html\_\_('the selected [%s](s)', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [326](#L326) | action\_state\_32: "<?php printf(esc\_html\_\_('You can reset selection of the [%s](s) by its reset button on the panel of the editor OR uncheck them manually!', 'bulk-editor'), esc\_html($this->settings->current\_post\_type)) ?>", |
| [327](#L327) | term\_maybe\_exist: "<?php esc\_html\_e('Maybe term(s) with such name(s) already exists!', 'bulk-editor') ?>", |
| [328](#L328) | free\_ver\_profiles: "<?php esc\_html\_e('In FREE version of the plugin you can create one profile only!', 'bulk-editor') ?>", |
| [329](#L329) | append\_sub\_item: "<?php esc\_html\_e('append sub item', 'bulk-editor') ?>", |
| [330](#L330) | is\_deactivated\_in\_free: "<?php esc\_html\_e('This field is deactivated in FREE version for bulk edit!', 'bulk-editor') ?>", |
| [331](#L331) | checked\_post: "<?php esc\_html\_e('Posts checked', 'bulk-editor') ?>", |
| [332](#L332) | }; |
| [333](#L333) |  |
| [334](#L334) | var wpbe\_settings = { |
| [335](#L335) | show\_thumbnail\_preview: <?php echo intval($this->settings->show\_thumbnail\_preview) ?>, |
| [336](#L336) | load\_switchers: <?php echo intval($this->settings->load\_switchers) ?>, |
| [337](#L337) | autocomplete\_max\_elem\_count: <?php echo intval($this->settings->autocomplete\_max\_elem\_count) ?> |
| [338](#L338) | }; |
| [339](#L339) | var wpbe\_field\_update\_nonce = "<?php echo esc\_attr(wp\_create\_nonce('wpbe\_field\_update')) ?>"; |
| [340](#L340) | var wpbe\_assets\_link = "<?php echo esc\_attr(WPBE\_ASSETS\_LINK) ?>"; |
| [341](#L341) | var spinner = wpbe\_assets\_link + "/images/spinner.gif"; |
| [342](#L342) | var start\_page = <?php echo (isset($\_GET['start\_page']) ? intval($\_GET['start\_page']) : 0) ?>; |
| [343](#L343) |  |
| [344](#L344) | //\*\*\* |
| [345](#L345) |  |
| [346](#L346) | var wpbe\_lang = '<?php echo esc\_attr(apply\_filters('wpbe\_current\_language', '')) ?>';//for translating compatibilities |
| [347](#L347) |  |
| [348](#L348) |  |
| [349](#L349) | </script> |
| [350](#L350) |  |
| [351](#L351) | <?php |
| [352](#L352) | wp\_enqueue\_style('wpbe\_open\_sans\_font', '//fonts.googleapis.com/css?family=Open+Sans'); |
| [353](#L353) | wp\_enqueue\_style('wpbe-bootstrap-grid', WPBE\_ASSETS\_LINK . 'css/bootstrap-grid.css', [], WPBE\_VERSION); |
| [354](#L354) | wp\_enqueue\_style('wpbe', WPBE\_ASSETS\_LINK . 'css/wpbe.css', [], WPBE\_VERSION); |
| [355](#L355) | wp\_enqueue\_style('wpbe\_scrollbar', WPBE\_ASSETS\_LINK . 'css/jquery.scrollbar.css', [], WPBE\_VERSION); |
| [356](#L356) | wp\_enqueue\_style('wpbe\_fontello', WPBE\_ASSETS\_LINK . 'css/fontello.css', [], WPBE\_VERSION); |
| [357](#L357) |  |
| [358](#L358) | //\*\*\* |
| [359](#L359) |  |
| [360](#L360) | wp\_enqueue\_media(); |
| [361](#L361) | wp\_enqueue\_script('media-upload'); |
| [362](#L362) | wp\_enqueue\_style('thickbox'); |
| [363](#L363) | wp\_enqueue\_script('thickbox'); |
| [364](#L364) |  |
| [365](#L365) | wp\_enqueue\_style('wp-color-picker'); |
| [366](#L366) | wp\_enqueue\_script('wp-color-picker'); |
| [367](#L367) |  |
| [368](#L368) | wp\_enqueue\_script('wpbe\_modernizr', WPBE\_ASSETS\_LINK . 'js/modernizr.js', [], WPBE\_VERSION); |
| [369](#L369) |  |
| [370](#L370) | wp\_enqueue\_style('wpbe\_datatables', WPBE\_ASSETS\_LINK . 'css/tables.css', [], WPBE\_VERSION); |
| [371](#L371) | wp\_enqueue\_script('wpbe\_datatables\_net', WPBE\_ASSETS\_LINK . 'js/jquery.dataTables.js', array('jquery'), WPBE\_VERSION); |
| [372](#L372) | wp\_enqueue\_script('wpbe\_data\_tables', WPBE\_ASSETS\_LINK . 'js/data-tables.js', array('wpbe\_datatables\_net'), WPBE\_VERSION); |
| [373](#L373) | wp\_enqueue\_script('wpbe\_jquery\_growl', WPBE\_ASSETS\_LINK . 'js/jquery.growl.js', array('jquery'), WPBE\_VERSION); |
| [374](#L374) |  |
| [375](#L375) | wp\_enqueue\_style('wpbe\_switchery', WPBE\_ASSETS\_LINK . 'js/switchery/switchery.min.css', [], WPBE\_VERSION); |
| [376](#L376) | wp\_enqueue\_script('wpbe\_switchery', WPBE\_ASSETS\_LINK . 'js/switchery/switchery.min.js', array('jquery'), WPBE\_VERSION); |
| [377](#L377) |  |
| [378](#L378) | wp\_enqueue\_style('wpbe\_chosen', WPBE\_ASSETS\_LINK . 'js/chosen/chosen.min.css', [], WPBE\_VERSION); |
| [379](#L379) | wp\_enqueue\_script('wpbe\_chosen', WPBE\_ASSETS\_LINK . 'js/chosen/chosen.jquery.min.js', array('jquery'), WPBE\_VERSION); |
| [380](#L380) |  |
| [381](#L381) | wp\_enqueue\_style('wpbe\_autocomplete', WPBE\_ASSETS\_LINK . 'js/easy-autocomplete/easy-autocomplete.min.css', [], WPBE\_VERSION); |
| [382](#L382) | wp\_enqueue\_style('wpbe\_autocomplete\_theme', WPBE\_ASSETS\_LINK . 'js/easy-autocomplete/easy-autocomplete.themes.min.css', [], WPBE\_VERSION); |
| [383](#L383) | wp\_enqueue\_script('wpbe\_autocomplete', WPBE\_ASSETS\_LINK . 'js/easy-autocomplete/jquery.easy-autocomplete.min.js', array('jquery'), WPBE\_VERSION); |
| [384](#L384) |  |
| [385](#L385) | wp\_enqueue\_style('wpbe\_datetimepicker', WPBE\_ASSETS\_LINK . 'js/bootstrap-material-datetimepicker/css/bootstrap-material-datetimepicker.css', [], WPBE\_VERSION); |
| [386](#L386) | wp\_enqueue\_script('wpbe\_datetimepicker\_moment', WPBE\_ASSETS\_LINK . 'js/datepicker/moment-with-locales.min.js', array('jquery'), WPBE\_VERSION); |
| [387](#L387) | wp\_enqueue\_script('wpbe\_datetimepicker', WPBE\_ASSETS\_LINK . 'js/bootstrap-material-datetimepicker/bootstrap-material-datetimepicker.js', array('jquery'), WPBE\_VERSION); |
| [388](#L388) |  |
| [389](#L389) | wp\_enqueue\_script('wpbe\_placeholder\_label', WPBE\_ASSETS\_LINK . 'js/jquery.placeholder.label.min.js', array('jquery'), WPBE\_VERSION); |
| [390](#L390) | wp\_enqueue\_script('wpbe\_tooltip', WPBE\_ASSETS\_LINK . 'js/tooltip.js', array('jquery'), WPBE\_VERSION); |
| [391](#L391) |  |
| [392](#L392) | wp\_enqueue\_script('wpbe\_tabs', WPBE\_ASSETS\_LINK . 'js/tabs.js', [], WPBE\_VERSION); |
| [393](#L393) | wp\_enqueue\_script('wpbe\_scrollbar', WPBE\_ASSETS\_LINK . 'js/jquery.scrollbar.min.js', [], WPBE\_VERSION); |
| [394](#L394) |  |
| [395](#L395) | //\*\*\* |
| [396](#L396) |  |
| [397](#L397) | wp\_enqueue\_script('wpbe', WPBE\_ASSETS\_LINK . 'js/wpbe.js', array('jquery', 'jquery-ui-core', 'jquery-ui-sortable', 'wpbe\_tabs'), WPBE\_VERSION); |
| [398](#L398) | do\_action('wpbe\_ext\_scripts'); //including extensions scripts |
| [399](#L399) | } |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | public function print\_plugin\_options() { |
| [403](#L403) | $args = array(); |
| [404](#L404) | $args['options'] = $this->settings->get\_options(); |
| [405](#L405) | $args['total\_settings'] = $this->settings->get\_total\_settings(); |
| [406](#L406) | $args['tax\_keys'] = array(); |
| [407](#L407) |  |
| [408](#L408) | $args['meta\_popup\_editor'] = FALSE; |
| [409](#L409) |  |
| [410](#L410) | //to generate terms in popup taxonomies data |
| [411](#L411) | if (!empty($this->settings->active\_fields)) { |
| [412](#L412) | foreach ($this->settings->active\_fields as $k => $f) { |
| [413](#L413) | if ($f['field\_type'] == 'taxonomy' AND $f['edit\_view'] == 'popup') { |
| [414](#L414) | $args['tax\_keys'][] = $f['taxonomy']; |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) |  |
| [418](#L418) | //\*\*\* |
| [419](#L419) |  |
| [420](#L420) | if ($f['edit\_view'] == 'popupeditor') { |
| [421](#L421) | $args['is\_popupeditor'] = TRUE; |
| [422](#L422) | } |
| [423](#L423) |  |
| [424](#L424) |  |
| [425](#L425) | if ($f['edit\_view'] == 'gallery\_popup\_editor') { |
| [426](#L426) | $args['is\_gallery'] = TRUE; |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | if ($f['edit\_view'] == 'meta\_popup\_editor') { |
| [430](#L430) | $args['meta\_popup\_editor'] = TRUE; |
| [431](#L431) | } |
| [432](#L432) | } |
| [433](#L433) | } |
| [434](#L434) |  |
| [435](#L435) | //\*\*\* |
| [436](#L436) |  |
| [437](#L437) | $args['active\_fields'] = $this->settings->active\_fields; |
| [438](#L438) | $args['settings\_fields'] = $this->settings->get\_fields(); |
| [439](#L439) | $args['settings\_fields\_full'] = $this->settings->get\_fields(false); |
| [440](#L440) | $args['settings\_fields\_keys'] = $this->settings->get\_fields\_keys(); |
| [441](#L441) | $args['editable'] = $this->settings->editable; |
| [442](#L442) | $args['default\_sortby\_col\_num'] = $this->settings->get\_default\_sortby\_col\_num(); |
| [443](#L443) | $args['default\_sort'] = $this->settings->default\_sort; |
| [444](#L444) | $args['no\_order'] = $this->settings->no\_order; |
| [445](#L445) | $args['per\_page'] = $this->settings->per\_page; |
| [446](#L446) | $args['extend\_per\_page'] = $this->settings->add\_more\_per\_page; |
| [447](#L447) | $args['show\_notes'] = $this->show\_notes; |
| [448](#L448) | $args['current\_user\_role'] = $this->settings->current\_user\_role; |
| [449](#L449) | $args['profiles'] = $this->profiles->get(); |
| [450](#L450) |  |
| [451](#L451) | //\*\*\* |
| [452](#L452) |  |
| [453](#L453) | WPBE\_HELPER::render\_html\_e(WPBE\_PATH . 'views/wpbe.php', apply\_filters('wpbe\_print\_plugin\_options', $args)); |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ |
| [457](#L457) | //ajax |
| [458](#L458) | public function wpbe\_get\_posts($args = array(), $return = false) { |
| [459](#L459) |  |
| [460](#L460) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [461](#L461) | return; |
| [462](#L462) | } |
| [463](#L463) |  |
| [464](#L464) | //\*\*\* |
| [465](#L465) |  |
| [466](#L466) | $res = array(); |
| [467](#L467) | $res['draw'] = isset($\_REQUEST['draw']) ? intval($\_REQUEST['draw']) : 0; |
| [468](#L468) | $res['data'] = array(); |
| [469](#L469) | $fileds\_keys = $this->settings->get\_fields\_keys(); |
| [470](#L470) |  |
| [471](#L471) | if (empty($args)) { |
| [472](#L472) | //for ajax only |
| [473](#L473) | $args = array( |
| [474](#L474) | 'lang' => apply\_filters('wpbe\_current\_language', ''), |
| [475](#L475) | 'per\_page' => intval($\_REQUEST['length']), |
| [476](#L476) | 'offset' => intval($\_REQUEST['start']), |
| [477](#L477) | 'order\_by' => $fileds\_keys[intval($\_REQUEST['order'][0]['column'])], |
| [478](#L478) | 'order' => sanitize\_key($\_REQUEST['order'][0]['dir']), |
| [479](#L479) | 'search' => $\_REQUEST['search']['value'] |
| [480](#L480) | ); |
| [481](#L481) | } |
| [482](#L482) |  |
| [483](#L483) | $posts = $this->posts->gets($args); |
| [484](#L484) |  |
| [485](#L485) | $res['recordsFiltered'] = $res['recordsTotal'] = $posts->found\_posts; |
| [486](#L486) | if ($posts->found\_posts > 0) { |
| [487](#L487) | $posts\_types = array(); |
| [488](#L488) | $posts\_titles = array(); |
| [489](#L489) | foreach ($posts->posts as $p) { |
| [490](#L490) | $post\_type = 'simple'; |
| [491](#L491) | $res['data'][] = $this->\_\_pack\_row($p); |
| [492](#L492) | $posts\_types[$p->ID] = $post\_type; |
| [493](#L493) | $posts\_titles[$p->ID] = str\_replace('"', "", str\_replace("'", "", $p->post\_title)); |
| [494](#L494) |  |
| [495](#L495) | //get variations if exists and requested |
| [496](#L496) | if ($post\_type == 'variable' AND ( isset($\_REQUEST['wpbe\_show\_variations']) AND intval($\_REQUEST['wpbe\_show\_variations']) > 0)) { |
| [497](#L497) | //removed, but for todo ideas |
| [498](#L498) | } |
| [499](#L499) |  |
| [500](#L500) | //\*\*\* |
| [501](#L501) | //data for javascript functionality on the front |
| [502](#L502) | $res['posts\_types'] = $posts\_types; |
| [503](#L503) | $res['posts\_titles'] = $posts\_titles; |
| [504](#L504) | } |
| [505](#L505) | } |
| [506](#L506) |  |
| [507](#L507) | //\*\*\* |
| [508](#L508) |  |
| [509](#L509) | if (!$return) { |
| [510](#L510) | //if requested by ajax |
| [511](#L511) | wp\_die(json\_encode($res)); |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | return $res; |
| [515](#L515) | } |
| [516](#L516) |  |
| [517](#L517) | //service |
| [518](#L518) | private function \_\_pack\_row($p) { |
| [519](#L519) | $row = array(); |
| [520](#L520) | $p = (array) $p; |
| [521](#L521) |  |
| [522](#L522) | foreach ($this->settings->get\_fields\_keys() as $key) { |
| [523](#L523) | $row[] = $this->wrap\_field\_val($p, $key); |
| [524](#L524) | } |
| [525](#L525) |  |
| [526](#L526) | $row[] = WPBE\_HELPER::draw\_link(array( |
| [527](#L527) | 'title' => '&#xea0b;', |
| [528](#L528) | 'href' => get\_permalink($p['ID']), |
| [529](#L529) | 'target' => '\_blank', |
| [530](#L530) | 'class' => 'button button-primary button-small', |
| [531](#L531) | 'title\_attr' => esc\_html\_\_('View the post on the site front', 'bulk-editor') |
| [532](#L532) | )) . '&nbsp;' . WPBE\_HELPER::draw\_link(array( |
| [533](#L533) | 'title' => '&#xea25;', |
| [534](#L534) | 'href' => get\_admin\_url() . 'post.php?post=' . $p['ID'] . '&action=edit', |
| [535](#L535) | 'target' => '\_blank', |
| [536](#L536) | 'class' => 'button button-primary button-small', |
| [537](#L537) | 'title\_attr' => esc\_html\_\_('Editing of the post on its page', 'bulk-editor') |
| [538](#L538) | )); |
| [539](#L539) |  |
| [540](#L540) | return $row; |
| [541](#L541) | } |
| [542](#L542) |  |
| [543](#L543) | //ajax |
| [544](#L544) | public function wpbe\_update\_page\_field($post\_id = 0, $field\_key = '', $value = '') { |
| [545](#L545) |  |
| [546](#L546) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_field\_update')) { |
| [547](#L547) | die('Forbidden!'); |
| [548](#L548) | } |
| [549](#L549) |  |
| [550](#L550) | if (!$post\_id) { |
| [551](#L551) | $post\_id = intval($\_REQUEST['post\_id']); |
| [552](#L552) | } |
| [553](#L553) | if (!isset($\_REQUEST['value']) || $\_REQUEST['value'] == null) { |
| [554](#L554) | $\_REQUEST['value'] = array(); |
| [555](#L555) | } |
| [556](#L556) | $field\_type = ''; |
| [557](#L557) | if (isset($\_REQUEST['field\_type'])) { |
| [558](#L558) | $field\_type = sanitize\_text\_field($\_REQUEST['field\_type']); |
| [559](#L559) | } |
| [560](#L560) | //leaved as attention info |
| [561](#L561) | //$field\_key = sanitize\_key($\_REQUEST['field']);//if sanitize not all meta keys works normally!! |
| [562](#L562) |  |
| [563](#L563) | if (empty($field\_key)) { |
| [564](#L564) | $field\_key = sanitize\_text\_field(trim($\_REQUEST['field'])); //if sanitize by sanitize\_key not all meta keys works normally!! |
| [565](#L565) | } |
| [566](#L566) |  |
| [567](#L567) | if ($post\_id > 0 AND isset($\_REQUEST['value'])) { |
| [568](#L568) |  |
| [569](#L569) | if (empty($value)) { |
| [570](#L570) | if (is\_array($\_REQUEST['value'])) { |
| [571](#L571) | //$value = (array) $\_REQUEST['value']; |
| [572](#L572) | $value = WPBE\_HELPER::sanitize\_array((array) $\_REQUEST['value']); |
| [573](#L573) | } else { |
| [574](#L574) |  |
| [575](#L575) | $allowedpost = wp\_kses\_allowed\_html('post'); |
| [576](#L576) | if ('post\_content' == $field\_key OR 'post\_excerpt' == $field\_key OR $this->settings->active\_fields[$field\_key]['edit\_view'] === 'popupeditor') { |
| [577](#L577) | $is\_encoded = false; |
| [578](#L578) | $allowedpost['iframe'] = array( |
| [579](#L579) | 'align' => true, |
| [580](#L580) | 'frameborder' => true, |
| [581](#L581) | 'height' => true, |
| [582](#L582) | 'width' => true, |
| [583](#L583) | 'sandbox' => true, |
| [584](#L584) | 'seamless' => true, |
| [585](#L585) | 'scrolling' => true, |
| [586](#L586) | 'srcdoc' => true, |
| [587](#L587) | 'src' => true, |
| [588](#L588) | 'class' => true, |
| [589](#L589) | 'id' => true, |
| [590](#L590) | 'style' => true, |
| [591](#L591) | 'border' => true, |
| [592](#L592) | ); |
| [593](#L593) | } |
| [594](#L594) | //\*\*\* |
| [595](#L595) |  |
| [596](#L596) | if (is\_string($\_REQUEST['value'])) { |
| [597](#L597) | $is\_encoded = preg\_match('~%[0-9A-F]{2}~i', $\_REQUEST['value']); |
| [598](#L598) | if ($is\_encoded) { |
| [599](#L599) | //for example gallery |
| [600](#L600) | $data\_array = []; |
| [601](#L601) |  |
| [602](#L602) | parse\_str($\_REQUEST['value'], $data\_array); |
| [603](#L603) | $data\_array = WPBE\_HELPER::sanitize\_array($data\_array); |
| [604](#L604) | if (isset($data\_array[$field\_key])) { |
| [605](#L605) | $data\_array = $data\_array[$field\_key]; |
| [606](#L606) | } |
| [607](#L607) |  |
| [608](#L608) | switch ($field\_type) { |
| [609](#L609) | case 'gallery\_popup\_editor': |
| [610](#L610) | $value = implode(',', $data\_array); //images ids |
| [611](#L611) |  |
| [612](#L612) | break; |
| [613](#L613) | } |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) | if (empty($value)) { |
| [617](#L617) |  |
| [618](#L618) | if (apply\_filters('wpbe\_use\_kses\_for\_page\_field', true)) { |
| [619](#L619) | $value = wp\_kses($\_REQUEST['value'], $allowedpost); |
| [620](#L620) | } else { |
| [621](#L621) | $value = sanitize\_text\_field($\_REQUEST['value']); |
| [622](#L622) | } |
| [623](#L623) |  |
| [624](#L624) |  |
| [625](#L625) | if ($this->settings->active\_fields[$field\_key]['edit\_view'] === 'meta\_popup\_editor') { |
| [626](#L626) | $value = htmlspecialchars\_decode($value); |
| [627](#L627) | } |
| [628](#L628) | } |
| [629](#L629) | } else { |
| [630](#L630) | $value = sanitize\_text\_field(trim($\_REQUEST['value'])); |
| [631](#L631) | } |
| [632](#L632) | } |
| [633](#L633) | } |
| [634](#L634) |  |
| [635](#L635) |  |
| [636](#L636) |  |
| [637](#L637) |  |
| [638](#L638) |  |
| [639](#L639) | //\*\*\* |
| [640](#L640) | //normalize calendar date |
| [641](#L641) | if ($this->settings->active\_fields[$field\_key]['edit\_view'] === 'calendar') { |
| [642](#L642) | $value = $this->posts->normalize\_calendar\_date($value, $field\_key); |
| [643](#L643) | } |
| [644](#L644) |  |
| [645](#L645) |  |
| [646](#L646) |  |
| [647](#L647) |  |
| [648](#L648) | $value = $this->posts->\_\_string\_replacer($value, $post\_id); |
| [649](#L649) | $response = $this->posts->update\_page\_field($post\_id, $field\_key, $value, $field\_type); |
| [650](#L650) |  |
| [651](#L651) | echo $response; |
| [652](#L652) | } |
| [653](#L653) |  |
| [654](#L654) | if (isset($\_REQUEST['post\_id'])) { |
| [655](#L655) | exit; //ajax |
| [656](#L656) | } |
| [657](#L657) | } |
| [658](#L658) |  |
| [659](#L659) | //ajax |
| [660](#L660) | public function wpbe\_redraw\_table\_row() { |
| [661](#L661) | if (is\_array($\_REQUEST['value'])) { |
| [662](#L662) | $value = (array) $\_REQUEST['value']; |
| [663](#L663) | } else { |
| [664](#L664) | $value = trim($\_REQUEST['value']); |
| [665](#L665) | } |
| [666](#L666) |  |
| [667](#L667) | //\*\*\* |
| [668](#L668) |  |
| [669](#L669) | $post\_id = intval($\_REQUEST['post\_id']); |
| [670](#L670) |  |
| [671](#L671) | if (isset($\_REQUEST['field']) AND !empty($\_REQUEST['field'])) { |
| [672](#L672) | $field\_key = sanitize\_key($\_REQUEST['field']); |
| [673](#L673) | $this->posts->update\_page\_field($post\_id, $field\_key, $value); |
| [674](#L674) | } |
| [675](#L675) |  |
| [676](#L676) |  |
| [677](#L677) | //generate table row by $post\_id |
| [678](#L678) | $res = $this->wpbe\_get\_posts(array( |
| [679](#L679) | 'p' => $post\_id, |
| [680](#L680) | 'post\_type' => array($this->settings->current\_post\_type) |
| [681](#L681) | ), true); |
| [682](#L682) |  |
| [683](#L683) | if (!empty($res['data'])) { |
| [684](#L684) | echo(json\_encode($res['data'][0])); |
| [685](#L685) | } |
| [686](#L686) |  |
| [687](#L687) | exit; |
| [688](#L688) | } |
| [689](#L689) |  |
| [690](#L690) | //ajax |
| [691](#L691) | public function get\_post\_field() { |
| [692](#L692) | $response = $this->posts->get\_post\_field(intval($\_REQUEST['post\_id']), sanitize\_key($\_REQUEST['field']), (isset($\_REQUEST['post\_parent']) ? $\_REQUEST['post\_parent'] : 0)); |
| [693](#L693) | echo $response; |
| [694](#L694) | exit; |
| [695](#L695) | } |
| [696](#L696) |  |
| [697](#L697) | //ajax |
| [698](#L698) | public function wpbe\_get\_gallery() { |
| [699](#L699) |  |
| [700](#L700) | $post\_id = intval($\_REQUEST['post\_id']); |
| [701](#L701) |  |
| [702](#L702) | if (!$post\_id) { |
| [703](#L703) | exit; |
| [704](#L704) | } |
| [705](#L705) |  |
| [706](#L706) | $post = $this->posts->get\_post($post\_id); |
| [707](#L707) |  |
| [708](#L708) | WPBE\_HELPER::render\_html\_e(WPBE\_PATH . 'views/parts/post-gallery.php', array( |
| [709](#L709) | 'images' => $post->get\_gallery\_image\_ids('edit') |
| [710](#L710) | )); |
| [711](#L711) |  |
| [712](#L712) | exit; |
| [713](#L713) | } |
| [714](#L714) |  |
| [715](#L715) | //ajax |
| [716](#L716) | public function wpbe\_get\_upsells() { |
| [717](#L717) |  |
| [718](#L718) | $post\_id = intval($\_REQUEST['post\_id']); |
| [719](#L719) |  |
| [720](#L720) | if (!$post\_id) { |
| [721](#L721) | exit; |
| [722](#L722) | } |
| [723](#L723) |  |
| [724](#L724) | $post = $this->posts->get\_post($post\_id); |
| [725](#L725) |  |
| [726](#L726) | WPBE\_HELPER::render\_html\_e(WPBE\_PATH . 'views/parts/post-upsells.php', array( |
| [727](#L727) | 'posts' => $post->get\_upsell\_ids('edit') |
| [728](#L728) | )); |
| [729](#L729) |  |
| [730](#L730) | exit; |
| [731](#L731) | } |
| [732](#L732) |  |
| [733](#L733) | //ajax |
| [734](#L734) | public function wpbe\_save\_options() { |
| [735](#L735) |  |
| [736](#L736) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [737](#L737) | wp\_die('0'); |
| [738](#L738) | } |
| [739](#L739) | if (!isset($\_REQUEST['save\_nonce']) || !wp\_verify\_nonce($\_REQUEST['save\_nonce'], 'wpbe\_settings\_nonce')) { |
| [740](#L740) | die('0'); |
| [741](#L741) | } |
| [742](#L742) | $data = array(); |
| [743](#L743) | parse\_str($\_REQUEST['formdata'], $data); |
| [744](#L744) |  |
| [745](#L745) | if (isset($data['wpbe\_options'])) { |
| [746](#L746) | if (is\_array($data['wpbe\_options'])) { |
| [747](#L747) | $this->settings->update\_options($data['wpbe\_options']); |
| [748](#L748) | } |
| [749](#L749) |  |
| [750](#L750) | //\*\*\* |
| [751](#L751) | //save site editor fields visibility |
| [752](#L752) | if (in\_array($this->settings->current\_user\_role, apply\_filters('wpbe\_permit\_special\_roles', ['administrator']))) { |
| [753](#L753) | $visibility = array(); |
| [754](#L754) |  |
| [755](#L755) | foreach ($data['wpbe\_options']['fields'] as $key => $v) { |
| [756](#L756) | if (isset($v['site\_editor\_visibility'])) { |
| [757](#L757) | $visibility[$key] = intval($v['site\_editor\_visibility']); |
| [758](#L758) | } |
| [759](#L759) | } |
| [760](#L760) |  |
| [761](#L761) | update\_option('wpbe\_site\_editor\_visibility', $visibility); |
| [762](#L762) |  |
| [763](#L763) | //\*\*\* |
| [764](#L764) | update\_option('wpbe\_site\_editors\_post\_types', $data['wpbe\_site\_editors\_post\_types']); |
| [765](#L765) |  |
| [766](#L766) | if (isset($data['wpbe\_site\_separate\_settings'])) { |
| [767](#L767) | update\_option('wpbe\_site\_separate\_settings', $data['wpbe\_site\_separate\_settings']); |
| [768](#L768) | update\_option('wpbe\_show\_text\_editor', $data['wpbe\_show\_text\_editor']); |
| [769](#L769) | } |
| [770](#L770) | } |
| [771](#L771) | } |
| [772](#L772) |  |
| [773](#L773) | exit; |
| [774](#L774) | } |
| [775](#L775) |  |
| [776](#L776) | //ajax |
| [777](#L777) | public function wpbe\_title\_autocomplete() { |
| [778](#L778) | $results = array(); |
| [779](#L779) | $results[] = array( |
| [780](#L780) | "name" => esc\_html\_\_("Posts not found!", 'bulk-editor'), |
| [781](#L781) | "id" => 0, |
| [782](#L782) | "type" => "", |
| [783](#L783) | "link" => "#", |
| [784](#L784) | "icon" => WPBE\_ASSETS\_LINK . 'images/not-found.jpg' |
| [785](#L785) | ); |
| [786](#L786) |  |
| [787](#L787) | //\*\*\* |
| [788](#L788) |  |
| [789](#L789) | if (!empty($\_REQUEST['wpbe\_txt\_search'])) { |
| [790](#L790) | $args = array( |
| [791](#L791) | 'nopaging' => true, |
| [792](#L792) | 'post\_type' => array($this->settings->current\_post\_type), |
| [793](#L793) | 'post\_status' => array\_keys(get\_post\_statuses()), |
| [794](#L794) | 'order\_by' => 'title', |
| [795](#L795) | 'order' => 'ASC', |
| [796](#L796) | 'per\_page' => intval($\_REQUEST['auto\_res\_count']) > 0 ? intval($\_REQUEST['auto\_res\_count']) : 10, |
| [797](#L797) | 'max\_num\_pages' => intval($\_REQUEST['auto\_res\_count']) > 0 ? intval($\_REQUEST['auto\_res\_count']) : 10 |
| [798](#L798) | ); |
| [799](#L799) |  |
| [800](#L800) | //\*\*\* |
| [801](#L801) |  |
| [802](#L802) | if (!empty($\_REQUEST['exept\_ids'])) { |
| [803](#L803) | $exept\_ids = array(); //which posts exclude as they are on the list already |
| [804](#L804) | parse\_str($\_REQUEST['exept\_ids'], $exept\_ids); |
| [805](#L805) | $args['post\_\_not\_in'] = $exept\_ids['wpbe\_prod\_ids']; |
| [806](#L806) | } |
| [807](#L807) |  |
| [808](#L808) | //\*\*\* |
| [809](#L809) | $st = $\_REQUEST['wpbe\_txt\_search']; |
| [810](#L810) | $\_REQUEST['wpbe\_txt\_search'] = array(); |
| [811](#L811) | $\_REQUEST['wpbe\_txt\_search\_behavior'] = array(); |
| [812](#L812) | $\_REQUEST['wpbe\_txt\_search']['post\_title'] = $st; |
| [813](#L813) | $\_REQUEST['wpbe\_txt\_search\_behavior']['post\_title'] = 'like'; |
| [814](#L814) | $this->posts->suppress\_filters = true; |
| [815](#L815) | add\_filter('posts\_where', array($this->filters, 'posts\_txt\_where'), 101); |
| [816](#L816) | $query = $this->posts->gets($args); |
| [817](#L817) |  |
| [818](#L818) | //+++ |
| [819](#L819) | //http://easyautocomplete.com/guide |
| [820](#L820) | if ($query->have\_posts()) { |
| [821](#L821) | $results = array(); |
| [822](#L822) | foreach ($query->posts as $p) { |
| [823](#L823) | $data = array( |
| [824](#L824) | "name" => $p->post\_title . ' (#' . $p->ID . ')', |
| [825](#L825) | "id" => $p->ID, |
| [826](#L826) | "type" => "post" |
| [827](#L827) | ); |
| [828](#L828) | if (has\_post\_thumbnail($p->ID)) { |
| [829](#L829) | $img\_src = wp\_get\_attachment\_image\_src(get\_post\_thumbnail\_id($p->ID), 'thumbnail'); |
| [830](#L830) | $data['icon'] = $img\_src[0]; |
| [831](#L831) | } else { |
| [832](#L832) | $data['icon'] = WPBE\_ASSETS\_LINK . 'images/not-found.jpg'; |
| [833](#L833) | } |
| [834](#L834) | $data['link'] = get\_post\_permalink($p->ID); |
| [835](#L835) | $results[] = $data; |
| [836](#L836) | } |
| [837](#L837) | } |
| [838](#L838) | } |
| [839](#L839) |  |
| [840](#L840) |  |
| [841](#L841) | wp\_die(json\_encode($results)); |
| [842](#L842) | } |
| [843](#L843) |  |
| [844](#L844) | //ajax |
| [845](#L845) | public function wpbe\_create\_new\_post() { |
| [846](#L846) |  |
| [847](#L847) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [848](#L848) | wp\_die('0'); |
| [849](#L849) | } |
| [850](#L850) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_tools\_panel\_nonce')) { |
| [851](#L851) | wp\_die('0'); |
| [852](#L852) | } |
| [853](#L853) | $to\_create = intval($\_REQUEST['to\_create']); |
| [854](#L854) | while ($to\_create) { |
| [855](#L855) | wp\_insert\_post(array( |
| [856](#L856) | 'post\_type' => $this->settings->current\_post\_type, |
| [857](#L857) | 'post\_title' => sprintf(esc\_html\_\_('New %s', 'bulk-editor'), $this->settings->current\_post\_type), |
| [858](#L858) | 'post\_status' => apply\_filters('wpbe\_new\_post\_status', 'draft', $this->settings->current\_post\_type) |
| [859](#L859) | )); |
| [860](#L860) |  |
| [861](#L861) | $to\_create--; |
| [862](#L862) | } |
| [863](#L863) |  |
| [864](#L864) | exit; |
| [865](#L865) | } |
| [866](#L866) |  |
| [867](#L867) | //ajax |
| [868](#L868) | public function wpbe\_duplicate\_posts() { |
| [869](#L869) |  |
| [870](#L870) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [871](#L871) | wp\_die('0'); |
| [872](#L872) | } |
| [873](#L873) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_tools\_panel\_nonce')) { |
| [874](#L874) | wp\_die('0'); |
| [875](#L875) | } |
| [876](#L876) | if (!empty($\_REQUEST['posts\_ids'])) { |
| [877](#L877) |  |
| [878](#L878) | global $wpdb; |
| [879](#L879) |  |
| [880](#L880) | foreach ($\_REQUEST['posts\_ids'] as $post\_id) { |
| [881](#L881) | $post = get\_post($post\_id); |
| [882](#L882) | if (isset($post) && $post != null) { |
| [883](#L883) |  |
| [884](#L884) | $args = array( |
| [885](#L885) | 'comment\_status' => $post->comment\_status, |
| [886](#L886) | 'ping\_status' => $post->ping\_status, |
| [887](#L887) | 'post\_author' => get\_current\_user\_id(), |
| [888](#L888) | 'post\_content' => $post->post\_content, |
| [889](#L889) | 'post\_excerpt' => $post->post\_excerpt, |
| [890](#L890) | 'post\_name' => '', |
| [891](#L891) | 'post\_parent' => $post->post\_parent, |
| [892](#L892) | 'post\_password' => $post->post\_password, |
| [893](#L893) | 'post\_status' => 'publish', |
| [894](#L894) | 'post\_title' => $post->post\_title . ' (' . esc\_html\_\_('copy') . ')', |
| [895](#L895) | 'post\_type' => $post->post\_type, |
| [896](#L896) | 'to\_ping' => $post->to\_ping, |
| [897](#L897) | 'menu\_order' => $post->menu\_order |
| [898](#L898) | ); |
| [899](#L899) |  |
| [900](#L900) | $new\_post\_id = wp\_insert\_post($args); |
| [901](#L901) | $taxonomies = get\_object\_taxonomies($post->post\_type); //returns array of taxonomy names for post type, ex array("category", "post\_tag"); |
| [902](#L902) |  |
| [903](#L903) | if (!empty($taxonomies)) { |
| [904](#L904) | foreach ($taxonomies as $taxonomy) { |
| [905](#L905) | $post\_terms = wp\_get\_object\_terms($post\_id, $taxonomy, array('fields' => 'slugs')); |
| [906](#L906) | wp\_set\_object\_terms($new\_post\_id, $post\_terms, $taxonomy, false); |
| [907](#L907) | } |
| [908](#L908) | } |
| [909](#L909) |  |
| [910](#L910) | //\*\*\* |
| [911](#L911) |  |
| [912](#L912) | $post\_meta\_infos = $wpdb->get\_results("SELECT meta\_key, meta\_value FROM {$wpdb->postmeta} WHERE post\_id={$post\_id}"); |
| [913](#L913) |  |
| [914](#L914) | if (count($post\_meta\_infos) !== 0) { |
| [915](#L915) | $sql\_query = "INSERT INTO $wpdb->postmeta (post\_id, meta\_key, meta\_value)"; |
| [916](#L916) | foreach ($post\_meta\_infos as $meta\_info) { |
| [917](#L917) | $meta\_key = $meta\_info->meta\_key; |
| [918](#L918) | if ($meta\_key == '\_wp\_old\_slug') { |
| [919](#L919) | continue; |
| [920](#L920) | } |
| [921](#L921) | $meta\_value = addslashes($meta\_info->meta\_value); |
| [922](#L922) | $sql\_query\_sel[] = "SELECT $new\_post\_id, '$meta\_key', '$meta\_value'"; |
| [923](#L923) | } |
| [924](#L924) | $sql\_query .= implode(" UNION ALL ", $sql\_query\_sel); |
| [925](#L925) | $wpdb->query($sql\_query); |
| [926](#L926) | } |
| [927](#L927) |  |
| [928](#L928) | //\*\*\* |
| [929](#L929) |  |
| [930](#L930) | $this->posts->update\_page\_field($new\_post\_id, 'post\_status', 'draft'); |
| [931](#L931) | } |
| [932](#L932) | } |
| [933](#L933) |  |
| [934](#L934) | //wp\_cache\_flush(); |
| [935](#L935) | } |
| [936](#L936) |  |
| [937](#L937) | wp\_die('done'); |
| [938](#L938) | } |
| [939](#L939) |  |
| [940](#L940) | //ajax |
| [941](#L941) | public function wpbe\_delete\_posts() { |
| [942](#L942) |  |
| [943](#L943) | if (!WPBE\_HELPER::can\_manage\_data()) { |
| [944](#L944) | wp\_die('0'); |
| [945](#L945) | } |
| [946](#L946) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_tools\_panel\_nonce')) { |
| [947](#L947) | wp\_die('0'); |
| [948](#L948) | } |
| [949](#L949) | if (!empty($\_REQUEST['posts\_ids'])) { |
| [950](#L950) | foreach ($\_REQUEST['posts\_ids'] as $post\_id) { |
| [951](#L951) | //wp\_delete\_post($post\_id, false); |
| [952](#L952) | wp\_trash\_post($post\_id); |
| [953](#L953) | } |
| [954](#L954) |  |
| [955](#L955) | //wp\_cache\_flush(); |
| [956](#L956) | } |
| [957](#L957) |  |
| [958](#L958) | wp\_die('done'); |
| [959](#L959) | } |
| [960](#L960) |  |
| [961](#L961) | public function wrap\_field\_val($post, $field\_key) { |
| [962](#L962) |  |
| [963](#L963) | $res = NULL; |
| [964](#L964) |  |
| [965](#L965) | $post = $this->posts->get\_post($post['ID']); |
| [966](#L966) | $post\_id = $post['ID']; |
| [967](#L967) |  |
| [968](#L968) | if (isset($this->settings->active\_fields[$field\_key]['allow\_post\_types'])) { |
| [969](#L969) | try { |
| [970](#L970) | if (!in\_array($this->settings->current\_post\_type, $this->settings->active\_fields[$field\_key]['allow\_post\_types'])) { |
| [971](#L971) | return WPBE\_HELPER::draw\_restricked(); |
| [972](#L972) | } |
| [973](#L973) | } catch (Exception $e) { |
| [974](#L974) | //\*\*\* |
| [975](#L975) | } |
| [976](#L976) | } |
| [977](#L977) |  |
| [978](#L978) | if (isset($this->settings->active\_fields[$field\_key]['prohibit\_post\_types'])) { |
| [979](#L979) | try { |
| [980](#L980) | if (in\_array($this->settings->current\_post\_type, $this->settings->active\_fields[$field\_key]['prohibit\_post\_types'])) { |
| [981](#L981) | return WPBE\_HELPER::draw\_restricked(); |
| [982](#L982) | } |
| [983](#L983) | } catch (Exception $e) { |
| [984](#L984) | //\*\*\* |
| [985](#L985) | } |
| [986](#L986) | } |
| [987](#L987) |  |
| [988](#L988) | //\*\*\* |
| [989](#L989) | $val = ''; |
| [990](#L990) | switch ($this->settings->active\_fields[$field\_key]['field\_type']) { |
| [991](#L991) | case 'meta': |
| [992](#L992) | $val = $this->posts->get\_post\_field($post\_id, $field\_key); |
| [993](#L993) | break; |
| [994](#L994) |  |
| [995](#L995) | case 'taxonomy': |
| [996](#L996) | $terms = $this->posts->get\_post\_field($post\_id, $field\_key); |
| [997](#L997) |  |
| [998](#L998) | $ids = array(); |
| [999](#L999) | $titles = array(); |
| [1000](#L1000) |  |
| [1001](#L1001) | //\*\*\* |
| [1002](#L1002) |  |
| [1003](#L1003) | if (!empty($terms)) { |
| [1004](#L1004) | foreach ($terms as $t) { |
| [1005](#L1005) | $ids[] = $t->term\_id; |
| [1006](#L1006) | $titles[] = $t->name; |
| [1007](#L1007) | } |
| [1008](#L1008) | } |
| [1009](#L1009) |  |
| [1010](#L1010) | if (!empty($ids)) { |
| [1011](#L1011) | $ids = array\_map(function ($v) { |
| [1012](#L1012) | return intval($v); |
| [1013](#L1013) | }, $ids); |
| [1014](#L1014) | } |
| [1015](#L1015) |  |
| [1016](#L1016) | //\*\*\* |
| [1017](#L1017) |  |
| [1018](#L1018) | if ($this->settings->active\_fields[$field\_key]['type'] === 'array') { |
| [1019](#L1019) | $val = array( |
| [1020](#L1020) | 'terms\_ids' => $ids, |
| [1021](#L1021) | 'terms\_titles' => $titles |
| [1022](#L1022) | ); |
| [1023](#L1023) |  |
| [1024](#L1024) | //for drop-down view |
| [1025](#L1025) | if ($this->settings->active\_fields[$field\_key]['edit\_view'] == 'select') { |
| [1026](#L1026) | $val['selected'] = $val['terms\_ids']; |
| [1027](#L1027) | } |
| [1028](#L1028) | } else { |
| [1029](#L1029) | //string, for example: post\_type |
| [1030](#L1030) | $val = $titles[0]; |
| [1031](#L1031) | } |
| [1032](#L1032) |  |
| [1033](#L1033) | break; |
| [1034](#L1034) |  |
| [1035](#L1035) | default: |
| [1036](#L1036) | if (isset($post[$field\_key])) { |
| [1037](#L1037) | $val = $post[$field\_key]; |
| [1038](#L1038) | } |
| [1039](#L1039) | break; |
| [1040](#L1040) | } |
| [1041](#L1041) |  |
| [1042](#L1042) | //\*\*\* |
| [1043](#L1043) |  |
| [1044](#L1044) | switch ($this->settings->active\_fields[$field\_key]['edit\_view']) { |
| [1045](#L1045) | case 'select': |
| [1046](#L1046) |  |
| [1047](#L1047) | $select\_options = $this->settings->active\_fields[$field\_key]['select\_options']; |
| [1048](#L1048) |  |
| [1049](#L1049) | //as example |
| [1050](#L1050) | if ($field\_key === 'post\_status') { |
| [1051](#L1051) | //\*\*\* |
| [1052](#L1052) | } |
| [1053](#L1053) |  |
| [1054](#L1054) | //\*\*\* |
| [1055](#L1055) |  |
| [1056](#L1056) | $res = WPBE\_HELPER::draw\_select(array( |
| [1057](#L1057) | 'field' => $field\_key, |
| [1058](#L1058) | 'post\_id' => $post\_id, |
| [1059](#L1059) | 'class' => 'wpbe\_data\_select', |
| [1060](#L1060) | 'options' => $select\_options, |
| [1061](#L1061) | 'selected' => (isset($val['selected']) ? $val['selected'] : $val), |
| [1062](#L1062) | 'disabled' => (isset($this->settings->active\_fields[$field\_key]['disabled']) ? $this->settings->active\_fields[$field\_key]['disabled'] : FALSE), |
| [1063](#L1063) | 'onchange' => 'wpbe\_act\_select(this)' |
| [1064](#L1064) | )); |
| [1065](#L1065) | break; |
| [1066](#L1066) |  |
| [1067](#L1067) | case 'multi\_select': |
| [1068](#L1068) |  |
| [1069](#L1069) | $res = WPBE\_HELPER::render\_html(WPBE\_PATH . 'views/elements/multi\_select.php', array( |
| [1070](#L1070) | 'field\_key' => $field\_key, |
| [1071](#L1071) | 'post\_id' => $post\_id, |
| [1072](#L1072) | 'val' => $val, |
| [1073](#L1073) | 'active\_fields' => $this->settings->active\_fields, |
| [1074](#L1074) | 'post' => $post, |
| [1075](#L1075) | )); |
| [1076](#L1076) | break; |
| [1077](#L1077) |  |
| [1078](#L1078) | case 'popup': |
| [1079](#L1079) | $res = WPBE\_HELPER::draw\_taxonomy\_popup\_btn($val, $field\_key, $post); |
| [1080](#L1080) | break; |
| [1081](#L1081) |  |
| [1082](#L1082) | case 'popupeditor': |
| [1083](#L1083) | $res = WPBE\_HELPER::draw\_popup\_editor\_btn($val, $field\_key, $post); |
| [1084](#L1084) | break; |
| [1085](#L1085) |  |
| [1086](#L1086) | case 'meta\_popup\_editor': |
| [1087](#L1087) | $res = WPBE\_HELPER::draw\_meta\_popup\_editor\_btn($field\_key, $post\_id); |
| [1088](#L1088) | break; |
| [1089](#L1089) |  |
| [1090](#L1090) | case 'thumbnail': |
| [1091](#L1091) | $thumbnail = wp\_get\_attachment\_image\_src($val, 'thumbnail'); |
| [1092](#L1092) | $full = wp\_get\_attachment\_image\_src($val, 'full'); |
| [1093](#L1093) |  |
| [1094](#L1094) | if (!empty($thumbnail)) { |
| [1095](#L1095) | $thumbnail = $thumbnail[0]; |
| [1096](#L1096) | $full = $full[0]; |
| [1097](#L1097) | } else { |
| [1098](#L1098) | $thumbnail = WPBE\_ASSETS\_LINK . 'images/not-found.jpg'; |
| [1099](#L1099) | $full = WPBE\_ASSETS\_LINK . 'images/not-found.jpg'; |
| [1100](#L1100) | } |
| [1101](#L1101) |  |
| [1102](#L1102) | $onmouseover = ''; |
| [1103](#L1103) | if ($this->settings->show\_thumbnail\_preview) { |
| [1104](#L1104) | $onmouseover = 'onmouseover="wpbe\_init\_image\_preview(this)"'; |
| [1105](#L1105) | } |
| [1106](#L1106) |  |
| [1107](#L1107) | $res = '<a href="' . $full . '" onclick="return wpbe\_act\_thumbnail(this)" ' . $onmouseover . ' title="' . $post['post\_title'] . '"><img src="' . $thumbnail . '" class="attachment-thumbnail size-thumbnail" alt="" /></a>'; |
| [1108](#L1108) | break; |
| [1109](#L1109) |  |
| [1110](#L1110) | case 'switcher': |
| [1111](#L1111) | $labels = array\_values($this->settings->active\_fields[$field\_key]['select\_options']); |
| [1112](#L1112) | $values = array\_keys($this->settings->active\_fields[$field\_key]['select\_options']); |
| [1113](#L1113) | if ($val) {//do switcher |
| [1114](#L1114) | $val = WPBE\_HELPER::over\_switcher\_val\_to\_swicher($val, $field\_key); |
| [1115](#L1115) | } |
| [1116](#L1116) | $res = WPBE\_HELPER::draw\_advanced\_switcher(($val == $values[0] ? TRUE : FALSE), $post\_id . '\_' . $field\_key, $field\_key, array('true' => $labels[0], 'false' => $labels[1]), array('true' => $values[0], 'false' => $values[1]), 'yes'); |
| [1117](#L1117) | break; |
| [1118](#L1118) |  |
| [1119](#L1119) | case 'calendar': |
| [1120](#L1120) | if ($this->settings->active\_fields[$field\_key]['type'] === 'timestamp') { |
| [1121](#L1121) | $val = strtotime($val); |
| [1122](#L1122) | } |
| [1123](#L1123) |  |
| [1124](#L1124) | $post\_title = $post['post\_title']; |
| [1125](#L1125) |  |
| [1126](#L1126) | if ($post['post\_type'] === 'post\_variation') { |
| [1127](#L1127) | //removed |
| [1128](#L1128) | } |
| [1129](#L1129) |  |
| [1130](#L1130) | $res = WPBE\_HELPER::draw\_calendar($post\_id, $post\_title . ' (' . $this->settings->active\_fields[$field\_key]['title'] . ')', $field\_key, $val); |
| [1131](#L1131) | break; |
| [1132](#L1132) |  |
| [1133](#L1133) | case 'checkbox': |
| [1134](#L1134) | //using for posts selection |
| [1135](#L1135) | $res = WPBE\_HELPER::draw\_checkbox(array( |
| [1136](#L1136) | 'class' => 'wpbe\_post\_check', |
| [1137](#L1137) | 'data-post-id' => $post\_id |
| [1138](#L1138) | )); |
| [1139](#L1139) | break; |
| [1140](#L1140) |  |
| [1141](#L1141) | case 'gallery\_popup\_editor': |
| [1142](#L1142) |  |
| [1143](#L1143) | $images = $this->posts->get\_post\_field($post\_id, $field\_key); |
| [1144](#L1144) |  |
| [1145](#L1145) | if ($images) { |
| [1146](#L1146) | $images = explode(',', $images); |
| [1147](#L1147) | } else { |
| [1148](#L1148) | $images = []; |
| [1149](#L1149) | } |
| [1150](#L1150) |  |
| [1151](#L1151) | return WPBE\_HELPER::render\_html(WPBE\_PATH . 'views/elements/draw\_gallery\_popup\_editor\_btn.php', array( |
| [1152](#L1152) | 'field\_key' => $field\_key, |
| [1153](#L1153) | 'post\_id' => $post\_id, |
| [1154](#L1154) | 'images' => $images |
| [1155](#L1155) | )); |
| [1156](#L1156) |  |
| [1157](#L1157) | break; |
| [1158](#L1158) |  |
| [1159](#L1159) | default: |
| [1160](#L1160) | //textinput |
| [1161](#L1161) | $sanitize = ''; |
| [1162](#L1162) | if (isset($this->settings->active\_fields[$field\_key]['sanitize'])) { |
| [1163](#L1163) | $sanitize = $this->settings->active\_fields[$field\_key]['sanitize']; |
| [1164](#L1164) | } |
| [1165](#L1165) |  |
| [1166](#L1166) | $res = $this->posts->\_\_sanitize\_answer\_value($field\_key, $sanitize, $val); |
| [1167](#L1167) |  |
| [1168](#L1168) | break; |
| [1169](#L1169) | } |
| [1170](#L1170) |  |
| [1171](#L1171) | //\*\*\* |
| [1172](#L1172) | //lets show post ID as LINK to the post |
| [1173](#L1173) | if ($field\_key === 'ID') { |
| [1174](#L1174) | $class = 'wpbe-id-permalink'; |
| [1175](#L1175) | $title = esc\_html\_\_('see the post on the site', 'bulk-editor'); |
| [1176](#L1176) | $res = '<a href="' . get\_permalink($res) . '" class="' . $class . '" title="' . $title . '" target="\_blank">' . $res . '</a>'; |
| [1177](#L1177) | } |
| [1178](#L1178) |  |
| [1179](#L1179) | //\*\*\* |
| [1180](#L1180) |  |
| [1181](#L1181) | return apply\_filters('wpbe\_wrap\_field\_val', $res, $post, $field\_key); |
| [1182](#L1182) | } |
| [1183](#L1183) |  |
| [1184](#L1184) | //ajax |
| [1185](#L1185) | public function wpbe\_create\_new\_term() { |
| [1186](#L1186) |  |
| [1187](#L1187) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_field\_update')) { |
| [1188](#L1188) | die('Forbidden!'); |
| [1189](#L1189) | } |
| [1190](#L1190) | $titles = $\_REQUEST['titles']; |
| [1191](#L1191) | $slugs = $\_REQUEST['slugs']; |
| [1192](#L1192) | $taxonomy = $\_REQUEST['tax\_key']; |
| [1193](#L1193) |  |
| [1194](#L1194) | //\*\*\* |
| [1195](#L1195) |  |
| [1196](#L1196) | if (!empty($titles)) { |
| [1197](#L1197) |  |
| [1198](#L1198) | if (substr\_count($titles, ',') > 0) { |
| [1199](#L1199) | $titles = explode(',', $titles); |
| [1200](#L1200) | } else { |
| [1201](#L1201) | $titles = array($titles); |
| [1202](#L1202) | } |
| [1203](#L1203) |  |
| [1204](#L1204) |  |
| [1205](#L1205) | if (substr\_count($slugs, ',') > 0) { |
| [1206](#L1206) | $slugs = explode(',', $slugs); |
| [1207](#L1207) | } else { |
| [1208](#L1208) | $slugs = array($slugs); |
| [1209](#L1209) | } |
| [1210](#L1210) |  |
| [1211](#L1211) | //\*\*\* |
| [1212](#L1212) |  |
| [1213](#L1213) | $terms\_ids = array(); |
| [1214](#L1214) | foreach ($titles as $k => $t) { |
| [1215](#L1215) | $t = trim($t); |
| [1216](#L1216) | if (!term\_exists($t, $taxonomy)) { |
| [1217](#L1217) | if (!empty($t)) { |
| [1218](#L1218) | $res = wp\_insert\_term($t, $taxonomy, array( |
| [1219](#L1219) | 'parent' => intval($\_REQUEST['parent']), |
| [1220](#L1220) | 'slug' => (isset($slugs[$k]) ? trim($slugs[$k]) : '') |
| [1221](#L1221) | )); |
| [1222](#L1222) | $terms\_ids[] = $res['term\_id']; |
| [1223](#L1223) | } else { |
| [1224](#L1224) | unset($titles[$k]); |
| [1225](#L1225) | } |
| [1226](#L1226) | } |
| [1227](#L1227) | } |
| [1228](#L1228) |  |
| [1229](#L1229) | //\*\*\* |
| [1230](#L1230) |  |
| [1231](#L1231) | echo json\_encode(array( |
| [1232](#L1232) | 'titles' => array\_reverse($titles), |
| [1233](#L1233) | 'terms\_ids' => array\_reverse($terms\_ids), |
| [1234](#L1234) | 'terms' => WPBE\_HELPER::get\_taxonomies\_terms\_hierarchy($taxonomy) |
| [1235](#L1235) | )); |
| [1236](#L1236) | } |
| [1237](#L1237) | exit; |
| [1238](#L1238) | } |
| [1239](#L1239) |  |
| [1240](#L1240) | //do not init functionality on all site pages as it not nessesary |
| [1241](#L1241) | private function is\_should\_init() { |
| [1242](#L1242) | //do not onit it exept of one wpbe page and its ajax requests |
| [1243](#L1243) | $init = isset($\_GET['page']) AND $\_GET['page'] === 'wpbe'; |
| [1244](#L1244) |  |
| [1245](#L1245) | if (defined('DOING\_AJAX')) { |
| [1246](#L1246) | if (strpos($\_REQUEST['action'], 'wpbe\_') !== FALSE) { |
| [1247](#L1247) | $init = true; |
| [1248](#L1248) | } |
| [1249](#L1249) | } |
| [1250](#L1250) |  |
| [1251](#L1251) | return $init; |
| [1252](#L1252) | } |
| [1253](#L1253) |  |
| [1254](#L1254) | public function add\_statuses($statuses) { |
| [1255](#L1255) |  |
| [1256](#L1256) | $statuses['future'] = esc\_html\_\_('Scheduled', 'bulk-editor'); |
| [1257](#L1257) |  |
| [1258](#L1258) | return $statuses; |
| [1259](#L1259) | } |
| [1260](#L1260) |  |
| [1261](#L1261) | public function wpbe\_delete\_tax\_term() { |
| [1262](#L1262) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_field\_update')) { |
| [1263](#L1263) | die('Forbidden!'); |
| [1264](#L1264) | } |
| [1265](#L1265) | $term\_id = (int) $\_REQUEST['term\_id']; |
| [1266](#L1266) | $taxonomy = sanitize\_text\_field(trim($\_REQUEST['tax\_key'])); |
| [1267](#L1267) | if (!taxonomy\_exists($taxonomy)) { |
| [1268](#L1268) | die('Wrong taxonomy name.'); |
| [1269](#L1269) | } |
| [1270](#L1270) | $result = wp\_delete\_term($term\_id, $taxonomy); |
| [1271](#L1271) | // check the result |
| [1272](#L1272) | if (is\_wp\_error($result)) { |
| [1273](#L1273) |  |
| [1274](#L1274) | die('error wp\_update\_term'); |
| [1275](#L1275) | } else { |
| [1276](#L1276) |  |
| [1277](#L1277) | echo json\_encode(WPBE\_HELPER::get\_taxonomies\_terms\_hierarchy($taxonomy)); |
| [1278](#L1278) | } |
| [1279](#L1279) | exit; |
| [1280](#L1280) | } |
| [1281](#L1281) |  |
| [1282](#L1282) | public function wpbe\_update\_tax\_term() { |
| [1283](#L1283) | if (!isset($\_REQUEST['wpbe\_nonce']) || !wp\_verify\_nonce($\_REQUEST['wpbe\_nonce'], 'wpbe\_field\_update')) { |
| [1284](#L1284) | die('Forbidden!'); |
| [1285](#L1285) | } |
| [1286](#L1286) |  |
| [1287](#L1287) | $term\_id = (int) $\_REQUEST['term\_id']; |
| [1288](#L1288) | $title = sanitize\_textarea\_field($\_REQUEST['title']); |
| [1289](#L1289) | $slug = sanitize\_textarea\_field($\_REQUEST['slug']); |
| [1290](#L1290) | $description = sanitize\_textarea\_field($\_REQUEST['description'] ?? ''); |
| [1291](#L1291) | $parent = (int) $\_REQUEST['parent']; |
| [1292](#L1292) | $taxonomy = sanitize\_text\_field(trim($\_REQUEST['tax\_key'])); |
| [1293](#L1293) | if (!taxonomy\_exists($taxonomy)) { |
| [1294](#L1294) | die('Wrong taxonomy name.'); |
| [1295](#L1295) | } |
| [1296](#L1296) |  |
| [1297](#L1297) | $result = wp\_update\_term($term\_id, $taxonomy, [ |
| [1298](#L1298) | 'name' => $title, |
| [1299](#L1299) | 'slug' => $slug, |
| [1300](#L1300) | 'description' => $description, |
| [1301](#L1301) | 'parent' => $parent |
| [1302](#L1302) | ]); |
| [1303](#L1303) |  |
| [1304](#L1304) | // check the result |
| [1305](#L1305) | if (is\_wp\_error($result)) { |
| [1306](#L1306) |  |
| [1307](#L1307) | die('error wp\_update\_term'); |
| [1308](#L1308) | } else { |
| [1309](#L1309) |  |
| [1310](#L1310) | echo json\_encode(WPBE\_HELPER::get\_taxonomies\_terms\_hierarchy($taxonomy)); |
| [1311](#L1311) | } |
| [1312](#L1312) | exit; |
| [1313](#L1313) | } |
| [1314](#L1314) |  |
| [1315](#L1315) | public function wp\_editor\_compatibility() { |
| [1316](#L1316) | if (!isset($\_GET['wpbe\_popup\_editor']) || $\_GET['wpbe\_popup\_editor'] != 1) { |
| [1317](#L1317) | return; |
| [1318](#L1318) | } |
| [1319](#L1319) | ?> |
| [1320](#L1320) | <style> |
| [1321](#L1321) | .edit-post-header\_\_settings .editor-post-switch-to-draft{ |
| [1322](#L1322) | display: none; |
| [1323](#L1323) | } |
| [1324](#L1324) | .edit-post-header\_\_settings .block-editor-post-preview\_\_dropdown{ |
| [1325](#L1325) | display: none; |
| [1326](#L1326) | } |
| [1327](#L1327) | .edit-post-header\_\_settings .editor-post-publish-button{ |
| [1328](#L1328) | display: none; |
| [1329](#L1329) | } |
| [1330](#L1330) | .edit-post-sidebar .components-panel .components-panel\_\_body { |
| [1331](#L1331) | display: none; |
| [1332](#L1332) | } |
| [1333](#L1333) | .edit-post-header .edit-post-fullscreen-mode-close{ |
| [1334](#L1334) | display: none; |
| [1335](#L1335) | } |
| [1336](#L1336) | .edit-post-header\_\_settings .interface-more-menu-dropdown { |
| [1337](#L1337) | display: block; |
| [1338](#L1338) | } |
| [1339](#L1339) | </style> |
| [1340](#L1340) | <script> |
| [1341](#L1341) |  |
| [1342](#L1342) | function wpbe\_popup\_editor\_get\_content() { |
| [1343](#L1343) | return wp.data.select("core/editor").getEditedPostContent(); |
| [1344](#L1344) | } |
| [1345](#L1345) | </script> |
| [1346](#L1346) | <?php |
| [1347](#L1347) | } |
| [1348](#L1348) |  |
| [1349](#L1349) | public function ask\_favour() { |
| [1350](#L1350) | if (get\_option('wpbe\_rate\_alert', 0)) { |
| [1351](#L1351) | //old rate system mark for already set review users |
| [1352](#L1352) | return; |
| [1353](#L1353) | } |
| [1354](#L1354) |  |
| [1355](#L1355) | $slug = strtolower(get\_class($this)); |
| [1356](#L1356) |  |
| [1357](#L1357) | add\_action("wp\_ajax\_{$slug}\_dismiss\_rate\_alert", function () use ($slug) { |
| [1358](#L1358) | update\_option("{$slug}\_dismiss\_rate\_alert", 2); |
| [1359](#L1359) | }); |
| [1360](#L1360) |  |
| [1361](#L1361) | add\_action("wp\_ajax\_{$slug}\_later\_rate\_alert", function () use ($slug) { |
| [1362](#L1362) | update\_option("{$slug}\_later\_rate\_alert", time() + 4 \* 7 \* 24 \* 60 \* 60); //4 weeks |
| [1363](#L1363) | }); |
| [1364](#L1364) |  |
| [1365](#L1365) | //+++ |
| [1366](#L1366) |  |
| [1367](#L1367) | add\_action('admin\_notices', function () use ($slug) { |
| [1368](#L1368) |  |
| [1369](#L1369) | if (!current\_user\_can('manage\_options')) { |
| [1370](#L1370) | return; //show to admin only |
| [1371](#L1371) | } |
| [1372](#L1372) |  |
| [1373](#L1373) | if (intval(get\_option("{$slug}\_dismiss\_rate\_alert", 0)) === 2) { |
| [1374](#L1374) | return; |
| [1375](#L1375) | } |
| [1376](#L1376) |  |
| [1377](#L1377) | if (intval(get\_option("{$slug}\_later\_rate\_alert", 0)) === 0) { |
| [1378](#L1378) | update\_option("{$slug}\_later\_rate\_alert", time() + 1 \* 3 \* 24 \* 60 \* 60); //3 days after install |
| [1379](#L1379) | return; |
| [1380](#L1380) | } |
| [1381](#L1381) |  |
| [1382](#L1382) | if (intval(get\_option("{$slug}\_later\_rate\_alert", 0)) > time()) { |
| [1383](#L1383) | return; |
| [1384](#L1384) | } |
| [1385](#L1385) |  |
| [1386](#L1386) | $link = 'https://codecanyon.net/downloads#item-24376112'; |
| [1387](#L1387) | $on = 'CodeCanyon'; |
| [1388](#L1388) | if ($this->show\_notes) { |
| [1389](#L1389) | $link = 'https://wordpress.org/support/plugin/bulk-editor/reviews/?filter=5#new-post'; |
| [1390](#L1390) | $on = 'WordPress'; |
| [1391](#L1391) | } |
| [1392](#L1392) | ?> |
| [1393](#L1393) | <div class="notice notice-info" id="pn\_<?php echo esc\_attr($slug) ?>\_ask\_favour" style="position: relative;"> |
| [1394](#L1394) | <button onclick="javascript: pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(1); |
| [1395](#L1395) | void(0);" title="<?php esc\_html\_e('Later', 'bulk-editor'); ?>" class="notice-dismiss"></button> |
| [1396](#L1396) | <div id="pn\_<?php echo esc\_attr($slug) ?>\_review\_suggestion"> |
| [1397](#L1397) | <p><?php esc\_html\_e('Hi! Are you enjoying using WOLF – WordPress Posts Bulk Editor Professional?', 'bulk-editor'); ?></p> |
| [1398](#L1398) | <p><a href="javascript: pn\_<?php echo esc\_attr($slug) ?>\_set\_review(1); void(0);"><?php esc\_html\_e('Yes, I love it', 'bulk-editor'); ?></a> 🙂 | <a href="javascript: pn\_<?php echo esc\_attr($slug) ?>\_set\_review(0); void(0);"><?php esc\_html\_e('Not really...', 'bulk-editor'); ?></a></p> |
| [1399](#L1399) | </div> |
| [1400](#L1400) |  |
| [1401](#L1401) | <div id="pn\_<?php echo esc\_attr($slug) ?>\_review\_yes" style="display: none;"> |
| [1402](#L1402) | <p><?php printf(esc\_html\_\_('That\'s awesome! Could you please do us a BIG favor and give it a 5-star rating on %s to help us spread the word and boost our motivation?', 'bulk-editor'), esc\_html($on)) ?></p> |
| [1403](#L1403) | <p style="font-weight: bold;">~ PluginUs.NET developers team</p> |
| [1404](#L1404) | <p> |
| [1405](#L1405) | <a href="<?php echo esc\_attr($link) ?>" style="display: inline-block; margin-right: 10px;" onclick="pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(2)" target="\_blank"><?php esc\_html\_e('Okay, you deserve it', 'bulk-editor'); ?></a> |
| [1406](#L1406) | <a href="javascript: pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(1); void(0);" style="display: inline-block; margin-right: 10px;"><?php esc\_html\_e('Nope, maybe later', 'bulk-editor'); ?></a> |
| [1407](#L1407) | <a href="javascript: pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(2); void(0);"><?php esc\_html\_e('I already did', 'bulk-editor'); ?></a> |
| [1408](#L1408) | </p> |
| [1409](#L1409) | </div> |
| [1410](#L1410) |  |
| [1411](#L1411) | <div id="pn\_<?php echo esc\_attr($slug) ?>\_review\_no" style="display: none;"> |
| [1412](#L1412) | <p><?php esc\_html\_e('We are sorry to hear you aren\'t enjoying WOLF. We would love a chance to improve it. Could you take a minute and let us know what we can do better?', 'bulk-editor'); ?></p> |
| [1413](#L1413) | <p> |
| [1414](#L1414) | <a href="https://pluginus.net/contact-us/" onclick="pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(2)" target="\_blank"><?php esc\_html\_e('Give Feedback', 'bulk-editor'); ?></a>&nbsp; |
| [1415](#L1415) | |&nbsp;<a href="javascript: pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(2); void(0);"><?php esc\_html\_e('No thanks', 'bulk-editor'); ?></a> |
| [1416](#L1416) | </p> |
| [1417](#L1417) | </div> |
| [1418](#L1418) |  |
| [1419](#L1419) |  |
| [1420](#L1420) | <script> |
| [1421](#L1421) | function pn\_<?php echo esc\_attr($slug) ?>\_set\_review(yes) { |
| [1422](#L1422) | document.getElementById('pn\_<?php echo esc\_attr($slug) ?>\_review\_suggestion').style.display = 'none'; |
| [1423](#L1423) | if (yes) { |
| [1424](#L1424) | document.getElementById('pn\_<?php echo esc\_attr($slug) ?>\_review\_yes').style.display = 'block'; |
| [1425](#L1425) | } else { |
| [1426](#L1426) | document.getElementById('pn\_<?php echo esc\_attr($slug) ?>\_review\_no').style.display = 'block'; |
| [1427](#L1427) | } |
| [1428](#L1428) | } |
| [1429](#L1429) |  |
| [1430](#L1430) | function pn\_<?php echo esc\_attr($slug) ?>\_dismiss\_review(what = 1) { |
| [1431](#L1431) | //1 maybe later, 2 do not ask more |
| [1432](#L1432) | jQuery('#pn\_<?php echo esc\_attr($slug) ?>\_ask\_favour').fadeOut(); |
| [1433](#L1433) |  |
| [1434](#L1434) | if (what === 1) { |
| [1435](#L1435) | jQuery.post(ajaxurl, { |
| [1436](#L1436) | action: '<?php echo esc\_attr($slug) ?>\_later\_rate\_alert' |
| [1437](#L1437) | }); |
| [1438](#L1438) | } else { |
| [1439](#L1439) | jQuery.post(ajaxurl, { |
| [1440](#L1440) | action: '<?php echo esc\_attr($slug) ?>\_dismiss\_rate\_alert' |
| [1441](#L1441) | }); |
| [1442](#L1442) | } |
| [1443](#L1443) |  |
| [1444](#L1444) | return true; |
| [1445](#L1445) | } |
| [1446](#L1446) | </script> |
| [1447](#L1447) | </div> |
| [1448](#L1448) | <?php |
| [1449](#L1449) | }); |
| [1450](#L1450) | } |
| [1451](#L1451) | } |
| [1452](#L1452) |  |
| [1453](#L1453) | //\*\*\* |
| [1454](#L1454) |  |
| [1455](#L1455) | $WPBE = new WPBE(); |
| [1456](#L1456) | $GLOBALS['WPBE'] = $WPBE; |
| [1457](#L1457) | add\_action('init', array($WPBE, 'init'), 9999); |
| [1458](#L1458) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/bulk-editor/trunk/index.php?format=txt)
* [Original Format](/export/3220520/bulk-editor/trunk/index.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

