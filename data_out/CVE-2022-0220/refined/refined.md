- **Root cause of vulnerability:** The `check_privacy_settings` AJAX action in the WordPress GDPR & CCPA plugin responds with JSON data without the correct "application/json" content-type. Additionally, HTML payload is not properly escaped. This allows a web browser to interpret the response as HTML and execute JavaScript code, leading to XSS.
- **Weaknesses/vulnerabilities present:** Reflected Cross-Site Scripting (XSS) vulnerability due to improper handling of user-controlled input and missing content-type header.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of a victim's browser. This can lead to session hijacking, defacement, data theft, or other malicious activities.
- **Attack vectors:**
    - An attacker crafts a malicious HTML payload containing JavaScript code within the settings parameter of a POST request to `/wp-admin/admin-ajax.php` with `action=check_privacy_settings`.
    - The server responds with the crafted payload without proper escaping or content type.
    - When the user's browser processes the response, it executes the JavaScript code.
- **Required attacker capabilities/position:** The attacker can be unauthenticated since the vulnerability is present for both types of users. They must be able to make an HTTP POST request to the `/wp-admin/admin-ajax.php` endpoint with the crafted payload. Due to a CSRF check introduced in version 1.9.26, the XSS vulnerability is only exploitable against unauthenticated users (because they share the same nonce).