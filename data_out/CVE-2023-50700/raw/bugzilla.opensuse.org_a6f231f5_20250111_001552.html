<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>1134132 &ndash; AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">





    
    <link href="skins/standard/global.css?1730816923"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1730816923" rel="stylesheet"
            type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1730816923" rel="stylesheet"
            type="text/css" ><link href="skins/standard/global.css?1730816923" rel="stylesheet"
            type="text/css" ><link href="skins/standard/bug.css?1730816923" rel="stylesheet"
            type="text/css" ><link href="extensions/Voting/web/style.css?1730816923" rel="stylesheet"
            type="text/css" >

    <link href="skins/contrib/openSUSE/global.css?1730816923" rel="stylesheet"
            type="text/css" 
          title="SUSE">

    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1730816923"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1730816923"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1730816923"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1730816923"></script><script type="text/javascript" src="js/yui/json/json-min.js?1730816923"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1730816923"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1730816923"></script><script type="text/javascript" src="js/global.js?1730816923"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "1134132 – AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager",
                             "show_bug.cgi?id=1134132" );
        document.title = "1134132 – AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "1134132 – AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1730816923"></script><script type="text/javascript" src="js/field.js?1730816923"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="bugzilla-opensuse-org bz_bug bz_status_REOPENED bz_product_openSUSE_Tumbleweed bz_component_Security bz_bug_1134132 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<!--div id="tmp_warning_wnd" style="
    position:fixed; 
    color:red; 
    font-size:20px; 
    top:50px; 
    left:10%; 
    right:10%; 
    padding:1em;
    background-color:#ffffff;
    border:3px solid red;
    z-index:9999;
    text-align:center;">
  This Bugzilla is for TESTING ONLY. All new bugs and comments WILL BE LOST. Use <a href="https://bugzilla.suse.com">bugzilla.suse.com</a> instead.
  <button style="
      background:none;
      border:0;
      box-shadow:none;
      color:red;
      text-shadow:none;
      position:absolute;
      right:0;
      top:0;" onclick="document.getElementById('tmp_warning_wnd').style.display='none';">[X]</button>
</div-->

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;1134132</p>
    </td>

    <td id="subtitle">
      <p class="subheader">AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2024-07-27 07:39:25 UTC</p>
    </td>
</tr>
</table>

<table id="lang_links_container" cellpadding="0" cellspacing="0"
       class="bz_default_hidden"><tr><td>
</td></tr></table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?classification=openSUSE">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>

  
    

    <li id="mini_login_containeropenSUSE_IDP">
  <span class="separator">| </span>
  <a id="login_linkopenSUSE_IDP" href="/saml2_login.cgi?idp=openSUSE_IDP&amp;target=show_bug.cgi%3Fid%3D1134132">openSUSE_IDP Log In</a>
</li>



  <li id="forgot_container_top">
    <span class="separator">| </span>
     <a id="forgot_link_top" href="https://idp-portal.suse.com/univention/self-service/#page=passwordreset">Forgot Password</a>
  </li>
</ul>
</div> 

<div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2024-07-27 07:39:25">
  <input type="hidden" name="id" value="1134132">
  <input type="hidden" name="token" value="1736554552-xp8PK4fFRpta2bdQlMSM-4odO2xIl5Gd3wS68JcjI3Q">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=1134132"><b>Bug&nbsp;1134132</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=glossary.html#short_desc"
  >Summary:</a>

</span>AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'AUDIT-STALE: deepin-file-manager: new dbus of deepin-file-manager' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=status_resolution_matrix.html">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">REOPENED
      </span>
    </td>
  </tr>
<tr>
    <th class="field_label">
      <label>Duplicates (1)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - VUL-0: CVE-2023-50700: deepin-file-manager: privileged operations can be called by unprivileged users via the D-Bus method"
   href="show_bug.cgi?id=1228364">CVE-2023-50700</a> 
      </span>
      (<a href="buglist.cgi?bug_id=1228364">view as bug list</a>)
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >openSUSE Tumbleweed

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=glossary.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >openSUSE

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=openSUSE Tumbleweed"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Security

  (<a href="buglist.cgi?component=Security&amp;product=openSUSE%20Tumbleweed&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=glossary.html#version"
  >Version:</a>

</th>
<td>Current
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=glossary.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        All
      </td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=glossary.html#priority">Priority</a></label>:
      </th>
      <td>P4 - Low
       <label for="severity"><b>Severity</b></label>:
       Normal<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=1134132#vote_1134132">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=glossary.html#target_milestone"
  >Target Milestone:</a>

</th><td>---
  </td>
      </tr>

          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=glossary.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard"><span class="fn">E-mail List</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'security-team\x40suse.de',
        'qa-bugs\x40suse.de');
    </script>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=glossary.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=glossary.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#dependson"
  >Depends on:</a>

</th>

  <td>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#blocked"
  >Blocks:</a>

</th>

  <td>

  </td>
  </tr>

        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2019-05-05 08:22 UTC by <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2024-07-27 07:39 UTC
      (<a href="show_activity.cgi?id=1134132">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>4 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="felixonmars">felixonmars</option>
                <option value="justforlxz">justforlxz</option>
                <option value="matthias.gerstner">matthias.gerstner</option>
                <option value="smash_bz">smash_bz</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=glossary.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_foundby">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_foundby"
  >Found By:</a>

</th>
  <td class="field_value "
      id="field_container_cf_foundby" >---

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_nts_priority">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_nts_priority"
  >Services Priority:</a>

</th>
  <td class="field_value "
      id="field_container_cf_nts_priority" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_biz_priority">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_biz_priority"
  >Business Priority:</a>

</th>
  <td class="field_value "
      id="field_container_cf_biz_priority" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_blocker">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_blocker"
  >Blocker:</a>

</th>
  <td class="field_value "
      id="field_container_cf_blocker" >---

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_marketing_qa_status">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_marketing_qa_status"
  >Marketing QA Status:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_marketing_qa_status" >---

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_it_deployment">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_it_deployment"
  >IT Deployment:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_it_deployment" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<ul>
  <li><a href="enter_bug.cgi?cloned_bug_id=1134132">Clone This Bug</a></li>
</ul>


        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_x-xz">
        <td>
            <a href="attachment.cgi?id=804190"
               title="View the content of the attachment">
          <b>dbus-1 profiles of deepin-file-manager</b></a>

          <span class="bz_attach_extra_info">
              (2.07 KB,
                application/x-xz)

            <br>
            <a href="#attach_804190"
               title="Go to the comment associated with the attachment">2019-05-05 08:22 UTC</a>,

            <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=804190&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=1134132&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=1134132&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=1134132&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1730816923" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2019-05-05 08:22:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=804190" name="attach_804190" title="dbus-1 profiles of deepin-file-manager">attachment 804190</a> <a href="attachment.cgi?id=804190&amp;action=edit" title="dbus-1 profiles of deepin-file-manager">[details]</a></span>
dbus-1 profiles of deepin-file-manager

Please check them, thanks! This project is at <a href="https://build.opensuse.org/package/show/X11:Deepin:Factory/deepin-file-manager">https://build.opensuse.org/package/show/X11:Deepin:Factory/deepin-file-manager</a>

[  556s] deepin-file-manager.x86_64: E: suse-dbus-unauthorized-service (Badness: 10) /etc/dbus-1/system.d/com.deepin.filemanager.daemon.conf
[  556s] deepin-file-manager.x86_64: E: suse-dbus-unauthorized-service (Badness: 10) /usr/share/dbus-1/system-services/com.deepin.filemanager.daemon.service
[  556s] The package installs a DBUS system service file. If the package is intended
[  556s] for inclusion in any SUSE product please open a bug report to request review
[  556s] of the service by the security team. Please refer to
[  556s] <a href="https://en.opensuse.org/openSUSE:Package_security_guidelines#audit_bugs">https://en.opensuse.org/openSUSE:Package_security_guidelines#audit_bugs</a> for
[  556s] more information.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2019-05-06 08:53:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Thank you for opening the bug. We will schedule the review.

This review is related to <a class="bz_bug_link 
          bz_status_REOPENED "
   title="REOPENED - AUDIT-0: deepin-file-manager: new polkit actions of deepin-file-manager"
   href="show_bug.cgi?id=1134131">bug 1134131</a> (polkit actions).</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2019-05-10 11:45:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This dde-file-manager-daemon is a security nightmare! None of the D-Bus
methods it exports are protected by polkit so just any user can call them.
While this is not generally a problem it *is* a problem here, because the
exported methods allow a bunch of privileged operations to everybody.

Findings about the daemon in general:

- in the D-Bus configuration file com.deepin.filemanager.daemon.conf we find
  the following:

  ```
  &lt;!-- Only root can own the service --&gt;
  &lt;policy user=&quot;root&quot;&gt;
    &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
  &lt;/policy&gt;

  &lt;!-- Allow anyone to invoke methods on the interfaces --&gt;
  &lt;policy context=&quot;default&quot;&gt;
    &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
  ```

  There are two &quot;own=&quot; lines one for root and one for everybody else. This
  allows any user to register this daemon (or actually: any program) on the
  D-Bus system bus. It allows to hijack other users' D-Bus connections. This
  is especially bad since for example in the method `setUserSharePassword`
  cleartext passwords are passed.

- the daemon creates a log file in `/var/cache/deepin/dde-file-manager-daemon`.
  First of all this is not the right place for a log file. Log files belong to
  /var/log or /var/lib at best. Furthermore the log file is world readable
  which should be avoided for logs originating from privileged programs.

- the checkAuthorization() call (which is unused actually at the moment) uses
  the deprecated polkit UnixProcessSubject with PIDs again. Like in the other
  Deepin programs this needs to be changed to use the D-Bus SystemBusName
  subject.

Findings in the UserShareManager interface:

- setUserSharePassword: allows to set arbitrary users' smd password. Changes
  the database in /var/lib/samba/private. If at all then this must only be
  allowed for the caller's username.
- addGroup: calls `groupadd` so regular users can create arbitrary groups. Not
  acceptable. Not acceptable interface without admin protection.
- addUserToGroup: allows arbitrary users to add arbitrary other users to
  arbitrary other groups. Luckily doesn't work on SUSE, because
  `/usr/sbin/adduser` is called but we have `useradd`. Not acceptable
  interface without admin-protection.
- restartSambaService calls `smbd restart`, shouldn't this go out to systemd
  instead? Must also be authenticated.

Findings in the TagManagerDaemon:

- disposeClientData: manages some tags for files that are stored in a per
  filesystem SQLite database. Doesn't look trustworthy. Why should everybody
  be able to fiddle with tags?

Findings in UsbFormatter:

- mkfs: create jfs, ext2/3/4, btrfs, swap, hfs, dosfs, xfs, reiserfs on
  arbitrary paths. This can overwrite arbitrary regular files, too, if they
  are large enough. Not acceptable interface without admin-authentication.

Findings in DeviceInfoManager:

The methods in this interface are somehwat okay but they still allow to call
lsblk and various low level file system information tools on arbitrary block
devices or other paths.

Summary
-------

In its current state the dde-file-manager-daemon cannot be accepted into
openSUSE. It needs major security overhaul.</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2019-12-16 12:39:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >There has been no response from the package or from upstream for a long time.
Closing this and related deepin bugs.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2021-04-23 11:46:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The uptream will deal with this bug.</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2021-08-26 14:26:56 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Assign to <a href="mailto:justforlxz&#64;gmail.com">justforlxz&#64;gmail.com</a></pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">zhang dingyuan</span>
</span>
        </span>

        <span class="bz_comment_time">
          2021-09-12 08:13:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >fixed in c1c5628611f80de32cac931c8189dadbc48d5bee and eb405edf5379f07a7cf102ba56f30db3c9ba8254. In addition to the first problem, we need to further confirm the solution. The developers have different opinions.</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2021-09-17 09:55:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="mailto:justforlxz&#64;gmail.com">justforlxz&#64;gmail.com</a> from <a href="show_bug.cgi?id=1134132#c6">comment #6</a>)
<span class="quote">&gt; fixed in c1c5628611f80de32cac931c8189dadbc48d5bee and eb405edf5379f07a7cf102ba56f30db3c9ba8254. In addition to the first problem, we need to further confirm the solution. The developers have different opinions.</span >

Which of the findings do the fixes relate to?

In what regard does upstream have different opinions?</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2022-10-18 12:26:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Matthias Gerstner from <a href="show_bug.cgi?id=1134132#c7">comment #7</a>)
<span class="quote">&gt; (In reply to <a href="mailto:justforlxz&#64;gmail.com">justforlxz&#64;gmail.com</a> from <a href="show_bug.cgi?id=1134132#c6">comment #6</a>)
&gt; &gt; fixed in c1c5628611f80de32cac931c8189dadbc48d5bee and eb405edf5379f07a7cf102ba56f30db3c9ba8254. In addition to the first problem, we need to further confirm the solution. The developers have different opinions.
&gt; 
&gt; Which of the findings do the fixes relate to?
&gt; 
&gt; In what regard does upstream have different opinions?</span >

Upstream provided some fixes, please review them here: <a href="https://github.com/linuxdeepin/developer-center/issues/2273">https://github.com/linuxdeepin/developer-center/issues/2273</a></pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2022-10-19 08:58:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It seems most of the interfaces have been dropped by upstream, some changed,
some unclear. Please simply package a new release with the changes and I will
look at the integration in openSUSE then.</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2022-10-19 13:25:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Here is the new release: <a href="https://build.opensuse.org/package/show/home:hillwood:branches:X11:Deepin:Factory/deepin-file-manager">https://build.opensuse.org/package/show/home:hillwood:branches:X11:Deepin:Factory/deepin-file-manager</a>

[  377s] deepin-file-manager.x86_64: E: dbus-file-unauthorized (Badness: 10) /etc/dbus-1/system.d/com.deepin.filemanager.daemon.conf (sha256 file digest default filter:34de0697f14e2688d9e141e1fe16e9447ceb0814d7164248e8dbcd5c0f213548 shell filter:0bb0f0985ca766598cb10ff1a7723f8277306469e9de1acbe54cec0c789e9086 xml filter:4a648526129d2cb68d95794eb30d446575f39b0a83d18e610e82cd48abb57ad1)
[  377s] deepin-file-manager.x86_64: E: dbus-file-unauthorized (Badness: 10) /usr/share/dbus-1/system-services/com.deepin.filemanager.daemon.service (sha256 file digest default filter:994c671bc05c1b66bb5b183a22e0b5ddd3e266f404e29ef054d78c99aa25b451 shell filter:d941111988e96f70ad0c17a92cfb2768373c29c494a5e4cd9334937a440de277 xml filter:&lt;failed-to-calculate&gt;)</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2022-10-20 12:55:36 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Basically we can merge this bug here with the other <a class="bz_bug_link 
          bz_status_REOPENED "
   title="REOPENED - AUDIT-0: deepin-file-manager: new polkit actions of deepin-file-manager"
   href="show_bug.cgi?id=1134131">bug 1134131</a>. It is about
the same basic software and mechanisms.

So the D-Bus interface in this package changed quite a bit. There is also
*some* authentication in there for some D-Bus methods now. However the
authentication is buggy:

1) PolicyKitHelper::checkAuthorization uses the UnixProcessSubject which is
   racy. PIDs can change at any time. The SytemBusName polkit subject needs to
   be used to make this proper.

2) Similarly in AccessControlManager the methods SetAccessPolicy and
   SetVaultAccessPolicy uses the callers PID to check against a whitelist of
   process names. This is also racy, the caller can replace its own process by a
   different one that matches the expectations of this check.

RevocationManager: it is unclear what this is used for, but anybody can call
pushEvent, popEvent without authentication. This can DoS memory but also cause
something else, whatever popEvent() means for the deepin environment.

TagManagerDaemon::disposeClientData: this method changes a sqlite database and
is unauthenticated. Doesn't look trustworthy.

VaultManager interface:

- sysUserChanged is unauthenticated, causes a heap allocation.
- checkAuthentication method has an unclear use (why expose an authentication
  method on D-Bus?) but it also uses the UnixProcessSubject, so it's racy
- all other methods are also unauthenticated

VaultManager2 interface:

- VaultBruteForcePrevention::isValidInvoker() always returns true, thus
  all methods are unauthenticated

UserShareManager interface:

- UnmountSambaShare tries to determine whether the target path is controlled
  by the caller's UID. This method allows to accesses arbitrary paths, also
  symlinks, which is racy. For example passing ../../../../home/myusername
  allows to escape the destined directory. Also the share name can contain
  '--' as prefix and would thus in theory allow to pass arbitrary arguments to
  the smbcontrol invocation:

  ```
  QString cmd = QString(&quot;smbcontrol smbd close-share %1&quot;).arg(sharename);
    qDebug() &lt;&lt; &quot;cmd==========&quot; &lt;&lt; cmd;
    p.start(cmd);
  ```

  I'm not completely sure how QProcess::start() behaves here, but it could
  even be possible to inject multiple parameters or shell syntax here.

So all in all things have not really improved a lot here. This still cannot be
accepted.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2023-11-22 06:13:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi. The updtream told me they had fixed them on V6. deepin-file-manager was updated to 6.0.35 in X11:Deepin:Factory. There should not be these security issue in the new package. As well as <a href="http://bugzilla.opensuse.org/show_bug.cgi?id=1134131">boo#1134131</a>.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2023-11-28 11:01:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="mailto:matthias.gerstner&#64;suse.com">matthias.gerstner&#64;suse.com</a> from <a href="show_bug.cgi?id=1134132#c2">comment #2</a>)
<span class="quote">&gt; Findings about the daemon in general:
&gt; 
&gt; - in the D-Bus configuration file com.deepin.filemanager.daemon.conf we find
&gt;   the following:
&gt; 
&gt;   ```
&gt;   &lt;!-- Only root can own the service --&gt;
&gt;   &lt;policy user=&quot;root&quot;&gt;
&gt;     &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
&gt;   &lt;/policy&gt;
&gt; 
&gt;   &lt;!-- Allow anyone to invoke methods on the interfaces --&gt;
&gt;   &lt;policy context=&quot;default&quot;&gt;
&gt;     &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
&gt;   ```
&gt; 
&gt;   There are two &quot;own=&quot; lines one for root and one for everybody else. This
&gt;   allows any user to register this daemon (or actually: any program) on the
&gt;   D-Bus system bus. It allows to hijack other users' D-Bus connections. This
&gt;   is especially bad since for example in the method `setUserSharePassword`
&gt;   cleartext passwords are passed.</span >

this is still the case, why should unprivileged users be able to run this
daemon on the system bus?

<span class="quote">&gt; - the daemon creates a log file in `/var/cache/deepin/dde-file-manager-daemon`.
&gt;   First of all this is not the right place for a log file. Log files belong to
&gt;   /var/log or /var/lib at best. Furthermore the log file is world readable
&gt;   which should be avoided for logs originating from privileged programs.</span >

this now seems to have been changed to ~/.cache/...

At least it is no longer public, but it is still not clean. Log files do not
belong in a cache, and log files for system services do not belong in root's
home directory.

<span class="quote">&gt; - the checkAuthorization() call (which is unused actually at the moment) uses
&gt;   the deprecated polkit UnixProcessSubject with PIDs again. Like in the other
&gt;   Deepin programs this needs to be changed to use the D-Bus SystemBusName
&gt;   subject.</span >

Something seems to have changed here, but the UnixProcessSubject is still used
here:

    src/plugins/filemanager/dfmplugin-vault/views/vaultremovepages.cpp: UnixProcessSubject(getpid()),
    src/plugins/filemanager/dfmplugin-vault/views/createvaultview/vaultactivefinishedview.cpp: UnixProcessSubject(getpid()),
    src/plugins/filemanager/dfmplugin-vault/views/unlockview/retrievepasswordview.cpp: UnixProcessSubject(getpid()),

In these locations the code asks Polkit whether the process itself
(`getpid()`) is authorized to perform an action. What kind of sense is that
supposed to make? Either the process runs as root, i.e. it will always be
authenticated. Or the process runs in the user's context, then it doesn't
matter what Polkit says, the action can always be carried out.

<span class="quote">&gt; Findings in the UserShareManager interface:
&gt; 
&gt; - setUserSharePassword: allows to set arbitrary users' smd password. Changes
&gt;   the database in /var/lib/samba/private. If at all then this must only be
&gt;   allowed for the caller's username.
&gt; - addGroup: calls `groupadd` so regular users can create arbitrary groups. Not
&gt;   acceptable. Not acceptable interface without admin protection.
&gt; - addUserToGroup: allows arbitrary users to add arbitrary other users to
&gt;   arbitrary other groups. Luckily doesn't work on SUSE, because
&gt;   `/usr/sbin/adduser` is called but we have `useradd`. Not acceptable
&gt;   interface without admin-protection.
&gt; - restartSambaService calls `smbd restart`, shouldn't this go out to systemd
&gt;   instead? Must also be authenticated.</span >

This interface or at least the invocation of groupad and adduser as well as
smbd restart seem to have vanished from the package.

<span class="quote">&gt; Findings in the TagManagerDaemon:
&gt; 
&gt; - disposeClientData: manages some tags for files that are stored in a per
&gt;   filesystem SQLite database. Doesn't look trustworthy. Why should everybody
&gt;   be able to fiddle with tags?</span >

also vanished

<span class="quote">&gt; Findings in UsbFormatter:
&gt; 
&gt; - mkfs: create jfs, ext2/3/4, btrfs, swap, hfs, dosfs, xfs, reiserfs on
&gt;   arbitrary paths. This can overwrite arbitrary regular files, too, if they
&gt;   are large enough. Not acceptable interface without admin-authentication.</span >

also vanished

<span class="quote">&gt; Findings in DeviceInfoManager:
&gt; 
&gt; The methods in this interface are somehwat okay but they still allow to call
&gt; lsblk and various low level file system information tools on arbitrary block
&gt; devices or other paths.</span >

also vanished</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2023-11-28 11:13:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="mailto:matthias.gerstner&#64;suse.com">matthias.gerstner&#64;suse.com</a> from <a href="show_bug.cgi?id=1134132#c11">comment #11</a>)
<span class="quote">&gt; 2) Similarly in AccessControlManager the methods SetAccessPolicy and
&gt;    SetVaultAccessPolicy uses the callers PID to check against a whitelist of
&gt;    process names. This is also racy, the caller can replace its own process by a
&gt;    different one that matches the expectations of this check.</span >

This still uses util::isValidInvoker() which is based on a whitelist of
processes. This is not safe.

<span class="quote">&gt; RevocationManager: it is unclear what this is used for, but anybody can call
&gt; pushEvent, popEvent without authentication. This can DoS memory but also cause
&gt; something else, whatever popEvent() means for the deepin environment.</span >

Seems to be gone.

<span class="quote">&gt; TagManagerDaemon::disposeClientData: this method changes a sqlite database and
&gt; is unauthenticated. Doesn't look trustworthy.</span >

Seems to be gone.

<span class="quote">&gt; VaultManager interface:
&gt; 
&gt; - sysUserChanged is unauthenticated, causes a heap allocation.
&gt; - checkAuthentication method has an unclear use (why expose an authentication
&gt;   method on D-Bus?) but it also uses the UnixProcessSubject, so it's racy
&gt; - all other methods are also unauthenticated</span >

the SysUserChanged is still there and still unauthenticated.

<span class="quote">&gt; VaultManager2 interface:
&gt; 
&gt; - VaultBruteForcePrevention::isValidInvoker() always returns true, thus
&gt;   all methods are unauthenticated</span >

Seems to be gone.

<span class="quote">&gt; UserShareManager interface:
&gt; 
&gt; - UnmountSambaShare tries to determine whether the target path is controlled
&gt;   by the caller's UID. This method allows to accesses arbitrary paths, also
&gt;   symlinks, which is racy. For example passing ../../../../home/myusername
&gt;   allows to escape the destined directory. Also the share name can contain
&gt;   '--' as prefix and would thus in theory allow to pass arbitrary arguments to
&gt;   the smbcontrol invocation:
&gt; 
&gt;   ```
&gt;   QString cmd = QString(&quot;smbcontrol smbd close-share %1&quot;).arg(sharename);
&gt;     qDebug() &lt;&lt; &quot;cmd==========&quot; &lt;&lt; cmd;
&gt;     p.start(cmd);
&gt;   ```
&gt; 
&gt;   I'm not completely sure how QProcess::start() behaves here, but it could
&gt;   even be possible to inject multiple parameters or shell syntax here.</span >

This still seems to be the same.</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2023-11-28 11:16:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This code is still not clean and it seems to be shifting around a lot without
actually fixing things. See my previous two comments. I did not look into any
possible new D-Bus methods and Polkit actions, because the known problems
haven't even been all addressed.</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2024-04-24 01:46:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >
(In reply to Matthias Gerstner from <a href="show_bug.cgi?id=1134132#c15">comment #15</a>)
<span class="quote">&gt; This code is still not clean and it seems to be shifting around a lot without
&gt; actually fixing things. See my previous two comments. I did not look into any
&gt; possible new D-Bus methods and Polkit actions, because the known problems
&gt; haven't even been all addressed.</span >

Hi, Uptream said to me that the latest version have merged fixes for dbus security issuse. Please check the latest code.</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2024-04-24 09:21:26 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="mailto:hillwoodroc&#64;gmail.com">hillwoodroc&#64;gmail.com</a> from <a href="show_bug.cgi?id=1134132#c16">comment #16</a>)
<span class="quote">&gt; Hi, Uptream said to me that the latest version have merged fixes for dbus security issuse. Please check the latest code.</span >

Should we work on this or rather first on deepin-app-services in <a class="bz_bug_link 
          bz_status_IN_PROGRESS "
   title="IN_PROGRESS - AUDIT-TRACKER: deepin-app-services: new dbus services of deepin-app-services"
   href="show_bug.cgi?id=1211374">bug 1211374</a>?
Deepin-app-services would be ready for whitelisting now already, if you want
to package and submit it to Factory.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matthias Gerstner</span>
</span>
        </span>

        <span class="bz_comment_time">
          2024-05-02 12:39:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="mailto:matthias.gerstner&#64;suse.com">matthias.gerstner&#64;suse.com</a> from <a href="show_bug.cgi?id=1134132#c2">comment #2</a>)
<span class="quote">&gt; This dde-file-manager-daemon is a security nightmare! None of the D-Bus
&gt; methods it exports are protected by polkit so just any user can call them.
&gt; While this is not generally a problem it *is* a problem here, because the
&gt; exported methods allow a bunch of privileged operations to everybody.
&gt; 
&gt; Findings about the daemon in general:
&gt; 
&gt; - in the D-Bus configuration file com.deepin.filemanager.daemon.conf we find
&gt;   the following:
&gt; 
&gt;   ```
&gt;   &lt;!-- Only root can own the service --&gt;
&gt;   &lt;policy user=&quot;root&quot;&gt;
&gt;     &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
&gt;   &lt;/policy&gt;
&gt; 
&gt;   &lt;!-- Allow anyone to invoke methods on the interfaces --&gt;
&gt;   &lt;policy context=&quot;default&quot;&gt;
&gt;     &lt;allow own=&quot;com.deepin.filemanager.daemon&quot;/&gt;
&gt;   ```
&gt; 
&gt;   There are two &quot;own=&quot; lines one for root and one for everybody else. This
&gt;   allows any user to register this daemon (or actually: any program) on the
&gt;   D-Bus system bus. It allows to hijack other users' D-Bus connections. This
&gt;   is especially bad since for example in the method `setUserSharePassword`
&gt;   cleartext passwords are passed.</span >

This is still the same in the current package. This needs to be fixed.

<span class="quote">&gt; - the daemon creates a log file in `/var/cache/deepin/dde-file-manager-daemon`.
&gt;   First of all this is not the right place for a log file. Log files belong to
&gt;   /var/log or /var/lib at best. Furthermore the log file is world readable
&gt;   which should be avoided for logs originating from privileged programs.</span >

The file seems not to be created any more, but I don't know what is used
instead. Probably into the systemd journal?

<span class="quote">&gt; - the checkAuthorization() call (which is unused actually at the moment) uses
&gt;   the deprecated polkit UnixProcessSubject with PIDs again. Like in the other
&gt;   Deepin programs this needs to be changed to use the D-Bus SystemBusName
&gt;   subject.</span >

This is now used and also uses the system bus name. Looks okay.

<span class="quote">&gt; Findings in the UserShareManager interface:
&gt; 
&gt; - setUserSharePassword: allows to set arbitrary users' smd password. Changes
&gt;   the database in /var/lib/samba/private. If at all then this must only be
&gt;   allowed for the caller's username.</span >

This is now Polkit authenticated. The name is still passed unfiltered to
`smbpasswd`, though. It could be a command line parameter &quot;--evil&quot;. This
should be filtered.

<span class="quote">&gt; - addGroup: calls `groupadd` so regular users can create arbitrary groups. Not
&gt;   acceptable. Not acceptable interface without admin protection.
&gt; - addUserToGroup: allows arbitrary users to add arbitrary other users to
&gt;   arbitrary other groups. Luckily doesn't work on SUSE, because
&gt;   `/usr/sbin/adduser` is called but we have `useradd`. Not acceptable
&gt;   interface without admin-protection.
&gt; - restartSambaService calls `smbd restart`, shouldn't this go out to systemd
&gt;   instead? Must also be authenticated.</span >

These methods no longer exist.

<span class="quote">&gt; Findings in the TagManagerDaemon:
&gt; 
&gt; - disposeClientData: manages some tags for files that are stored in a per
&gt;   filesystem SQLite database. Doesn't look trustworthy. Why should everybody
&gt;   be able to fiddle with tags?</span >

This no longer seems to exist.

<span class="quote">&gt; Findings in UsbFormatter:
&gt; 
&gt; - mkfs: create jfs, ext2/3/4, btrfs, swap, hfs, dosfs, xfs, reiserfs on
&gt;   arbitrary paths. This can overwrite arbitrary regular files, too, if they
&gt;   are large enough. Not acceptable interface without admin-authentication.</span >

This no longer seems to exist.

<span class="quote">&gt; Findings in DeviceInfoManager:
&gt; 
&gt; The methods in this interface are somehwat okay but they still allow to call
&gt; lsblk and various low level file system information tools on arbitrary block
&gt; devices or other paths.</span >

This no longer seems to exist.

Newly added D-Bus methods:

- com.deepin.filemanager.daemon.MountControl.Mount: allows to mount file
  systems, not Polkit authenticated. There is support for &quot;common&quot; file
  systems, which is not implemented though. Then there's &quot;cifs&quot; which allows
  pretty much freedom about passing strings to &quot;mkdir()&quot; and to &quot;mount()&quot;,
  creates directories with user controlled data in /media/&lt;username&gt;/samba. In
  principle allows &quot;../&quot; elements in paths, only the `mkdir()` luckily fails
  to follow them. Then there's a &quot;dlnfs&quot; file system plugin which looks for a
  &quot;dlnfs&quot; program before continuing. I couldn't find out what program this is
  supposed to be. It's not packaged on openSUSE anyway. A user controlled path
  is passed as command line argument to this program, which might allow
  privilege escalation, but I cannot say for sure, since I don't know the program.

- com.deepin.filemanager.daemon.MountControl.Unmount: allows to unmount some
  file systems. The plugins that deal with this use libmount mtab for finding
  out about already existing mounts. This could be tricked by users that are
  allowed to mount FUSE based file systems. They can choose arbitrary strings
  as &quot;source device&quot; that might confuse the logic in the plugins.

- com.deepin.filemanager.daemon.UserShareManager.CloseSmbShareByShareName:
  this tries to unmount a share via &quot;smbcontrol smbd close-share %1&quot;, where %1
  is a user controlled string. There is no Polkit authentication. There are
  some checks that the resulting path is not a symlink or an escape out of
  /var/lib/samba/usershares. If somebody managed to mount a samba share under
  a weird name like &quot;myshare --extra-parameter=this&quot;, then the
  resulting QProcess execution of smbcontrol might result in side effects.

- com.deepin.filemanager.daemon.UserShareManager.EnableSmbServices:
  allow to enable smbd and nmbd without authentication. This must be
  authenticated.

- com.deepin.filemanager.daemon.AccessControlManager:

  + SetAccessPolicy(): uses an unsafe utils::isValidInvoker() helper function
    that checks the callers /proc/%1/exe. This is a racy check that can we
    circumvented by unprivileged callers by replacing their process with one
    of the whitelisted ones.
  + SetVaultAccessPolicy(): use the same unsafe check
  + Chmod(): Allows to change the mode of arbitrary paths. Luckily Polkit
    authenticated. But there is a file existence check issue in there. If the
    file doesn't exist, then the call exists early without authenticating.
    Thus a caller can determine whether certain files exist or not, by
    observing whether Polkit authentication requests are sent out or not.

Overall this service still isn't fit for inclusion for a lot of reasons.

Most if not all of the D-Bus methods need to Polkit authenticated (they can
have a 'yes' setting for active users, if the methods don't allow highly
privileged things. But nobody &amp; friends should not be allowed to call all
these methods.

Other shaky authentication tests should be dropped like this
utils::isValidInvoker().

The D-Bus configuration &quot;own&quot; line still needs to be fixed.</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1134132#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hillwood Yang</span>
</span>
        </span>

        <span class="bz_comment_time">
          2024-07-27 07:39:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - VUL-0: CVE-2023-50700: deepin-file-manager: privileged operations can be called by unprivileged users via the D-Bus method"
   href="show_bug.cgi?id=1228364">Bug 1228364</a> has been marked as a duplicate of this bug. ***</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1134132">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=1134132">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=1134132">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?classification=openSUSE">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>

  
    

    <li id="mini_login_containeropenSUSE_IDP">
  <span class="separator">| </span>
  <a id="login_linkopenSUSE_IDP" href="/saml2_login.cgi?idp=openSUSE_IDP&amp;target=show_bug.cgi%3Fid%3D1134132">openSUSE_IDP Log In</a>
</li>



  <li id="forgot_container_bottom">
    <span class="separator">| </span>
     <a id="forgot_link_bottom" href="https://idp-portal.suse.com/univention/self-service/#page=passwordreset">Forgot Password</a>
  </li>
</ul>
  </li>

  




  <ul class="links">
    <li>Legal: </li>
    <li><a href="http://en.opensuse.org/Terms_of_site">openSUSE</a></li>
    <li><a href="https://www.suse.com/company/legal/">SUSE</a></li>
  </ul>
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>