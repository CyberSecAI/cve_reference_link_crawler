=== Content from github.com_8497f14a_20250110_213841.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=opengeos%2Fstreamlit-geospatial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opengeos](/opengeos)
/
**[streamlit-geospatial](/opengeos/streamlit-geospatial)**
Public

* [Notifications](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)
* [Star
   894](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)

* [Code](/opengeos/streamlit-geospatial)
* [Issues
  3](/opengeos/streamlit-geospatial/issues)
* [Pull requests
  1](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects
  0](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

Additional navigation options

* [Code](/opengeos/streamlit-geospatial)
* [Issues](/opengeos/streamlit-geospatial/issues)
* [Pull requests](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

## Files

 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Copy path Blame  Blame
## Latest commit

## History

[History](/opengeos/streamlit-geospatial/commits/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1528 lines (1365 loc) · 64.4 KB 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Top
## File metadata and controls

* Code
* Blame

1528 lines (1365 loc) · 64.4 KB[Raw](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000import eeimport osimport warningsimport datetimeimport fionaimport geopandas as gpdimport foliumimport streamlit as stimport geemap.colormaps as cmimport geemap.foliumap as geemapfrom datetime import datefrom shapely.geometry import Polygon
st.set\_page\_config(layout="wide")warnings.filterwarnings("ignore")
@st.cache\_datadef ee\_authenticate(token\_name="EARTHENGINE\_TOKEN"): geemap.ee\_initialize(token\_name=token\_name)
st.sidebar.info( """ - Web App URL: <https://streamlit.geemap.org> - GitHub repository: <https://github.com/giswqs/streamlit-geospatial> """)
st.sidebar.title("Contact")st.sidebar.info( """ Qiusheng Wu: <https://wetlands.io> [GitHub](https://github.com/giswqs) | [Twitter](https://twitter.com/giswqs) | [YouTube](https://www.youtube.com/c/QiushengWu) | [LinkedIn](https://www.linkedin.com/in/qiushengwu) """)
goes\_rois = { "Creek Fire, CA (2020-09-05)": { "region": Polygon( [ [-121.003418, 36.848857], [-121.003418, 39.049052], [-117.905273, 39.049052], [-117.905273, 36.848857], [-121.003418, 36.848857], ] ), "start\_time": "2020-09-05T15:00:00", "end\_time": "2020-09-06T02:00:00", }, "Bomb Cyclone (2021-10-24)": { "region": Polygon( [ [-159.5954, 60.4088], [-159.5954, 24.5178], [-114.2438, 24.5178], [-114.2438, 60.4088], ] ), "start\_time": "2021-10-24T14:00:00", "end\_time": "2021-10-25T01:00:00", }, "Hunga Tonga Volcanic Eruption (2022-01-15)": { "region": Polygon( [ [-192.480469, -32.546813], [-192.480469, -8.754795], [-157.587891, -8.754795], [-157.587891, -32.546813], [-192.480469, -32.546813], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", }, "Hunga Tonga Volcanic Eruption Closer Look (2022-01-15)": { "region": Polygon( [ [-178.901367, -22.958393], [-178.901367, -17.85329], [-171.452637, -17.85329], [-171.452637, -22.958393], [-178.901367, -22.958393], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", },}
landsat\_rois = { "Aral Sea": Polygon( [ [57.667236, 43.834527], [57.667236, 45.996962], [61.12793, 45.996962], [61.12793, 43.834527], [57.667236, 43.834527], ] ), "Dubai": Polygon( [ [54.541626, 24.763044], [54.541626, 25.427152], [55.632019, 25.427152], [55.632019, 24.763044], [54.541626, 24.763044], ] ), "Hong Kong International Airport": Polygon( [ [113.825226, 22.198849], [113.825226, 22.349758], [114.085121, 22.349758], [114.085121, 22.198849], [113.825226, 22.198849], ] ), "Las Vegas, NV": Polygon( [ [-115.554199, 35.804449], [-115.554199, 36.558188], [-113.903503, 36.558188], [-113.903503, 35.804449], [-115.554199, 35.804449], ] ), "Pucallpa, Peru": Polygon( [ [-74.672699, -8.600032], [-74.672699, -8.254983], [-74.279938, -8.254983], [-74.279938, -8.600032], ] ), "Sierra Gorda, Chile": Polygon( [ [-69.315491, -22.837104], [-69.315491, -22.751488], [-69.190006, -22.751488], [-69.190006, -22.837104], [-69.315491, -22.837104], ] ),}
modis\_rois = { "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ), "Africa": Polygon( [ [-18.6983, 38.1446], [-18.6983, -36.1630], [52.2293, -36.1630], [52.2293, 38.1446], ] ), "USA": Polygon( [ [-127.177734, 23.725012], [-127.177734, 50.792047], [-66.269531, 50.792047], [-66.269531, 23.725012], [-127.177734, 23.725012], ] ),}
ocean\_rois = { "Gulf of Mexico": Polygon( [ [-101.206055, 15.496032], [-101.206055, 32.361403], [-75.673828, 32.361403], [-75.673828, 15.496032], [-101.206055, 15.496032], ] ), "North Atlantic Ocean": Polygon( [ [-85.341797, 24.046464], [-85.341797, 45.02695], [-55.810547, 45.02695], [-55.810547, 24.046464], [-85.341797, 24.046464], ] ), "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ),}
@st.cache\_datadef uploaded\_file\_to\_gdf(data): import tempfile import os import uuid
 \_, file\_extension = os.path.splitext(data.name) file\_id = str(uuid.uuid4()) file\_path = os.path.join(tempfile.gettempdir(), f"{file\_id}{file\_extension}")
 with open(file\_path, "wb") as file: file.write(data.getbuffer())
 if file\_path.lower().endswith(".kml"): fiona.drvsupport.supported\_drivers["KML"] = "rw" gdf = gpd.read\_file(file\_path, driver="KML") else: gdf = gpd.read\_file(file\_path)
 return gdf
def app():
 today = date.today()
 st.title("Create Satellite Timelapse")
 st.markdown( """ An interactive web app for creating [Landsat](https://developers.google.com/earth-engine/datasets/catalog/landsat)/[GOES](https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16) timelapse for any location around the globe.  The app was built using [streamlit](https://streamlit.io), [geemap](https://geemap.org), and [Google Earth Engine](https://earthengine.google.com). For more info, check out my streamlit [blog post](https://blog.streamlit.io/creating-satellite-timelapse-with-streamlit-and-earth-engine).  """ )
 row1\_col1, row1\_col2 = st.columns([2, 1])
 if st.session\_state.get("zoom\_level") is None: st.session\_state["zoom\_level"] = 4
 st.session\_state["ee\_asset\_id"] = None st.session\_state["bands"] = None st.session\_state["palette"] = None st.session\_state["vis\_params"] = None
 with row1\_col1: ee\_authenticate(token\_name="EARTHENGINE\_TOKEN") m = geemap.Map( basemap="HYBRID", plugin\_Draw=True, Draw\_export=True, locate\_control=True, plugin\_LatLngPopup=False, ) m.add\_basemap("ROADMAP")
 with row1\_col2:
 keyword = st.text\_input("Search for a location:", "") if keyword: locations = geemap.geocode(keyword) if locations is not None and len(locations) > 0: str\_locations = [str(g)[1:-1] for g in locations] location = st.selectbox("Select a location:", str\_locations) loc\_index = str\_locations.index(location) selected\_loc = locations[loc\_index] lat, lng = selected\_loc.lat, selected\_loc.lng folium.Marker(location=[lat, lng], popup=location).add\_to(m) m.set\_center(lng, lat, 12) st.session\_state["zoom\_level"] = 12
 collection = st.selectbox( "Select a satellite image collection: ", [ "Any Earth Engine ImageCollection", "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", "Geostationary Operational Environmental Satellites (GOES)", "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", "MODIS Ocean Color SMI", "USDA National Agriculture Imagery Program (NAIP)", ], index=1, )
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: roi\_options = ["Uploaded GeoJSON"] + list(landsat\_rois.keys())
 elif collection == "Geostationary Operational Environmental Satellites (GOES)": roi\_options = ["Uploaded GeoJSON"] + list(goes\_rois.keys())
 elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: roi\_options = ["Uploaded GeoJSON"] + list(modis\_rois.keys()) elif collection == "MODIS Ocean Color SMI": roi\_options = ["Uploaded GeoJSON"] + list(ocean\_rois.keys()) else: roi\_options = ["Uploaded GeoJSON"]
 if collection == "Any Earth Engine ImageCollection": keyword = st.text\_input("Enter a keyword to search (e.g., MODIS):", "") if keyword:
 assets = geemap.search\_ee\_data(keyword) ee\_assets = [] for asset in assets: if asset["ee\_id\_snippet"].startswith("ee.ImageCollection"): ee\_assets.append(asset)
 asset\_titles = [x["title"] for x in ee\_assets] dataset = st.selectbox("Select a dataset:", asset\_titles) if len(ee\_assets) > 0: st.session\_state["ee\_assets"] = ee\_assets st.session\_state["asset\_titles"] = asset\_titles index = asset\_titles.index(dataset) ee\_id = ee\_assets[index]["id"] else: ee\_id = ""
 if dataset is not None: with st.expander("Show dataset details", False): index = asset\_titles.index(dataset) html = geemap.ee\_data\_html(st.session\_state["ee\_assets"][index]) st.markdown(html, True) # elif collection == "MODIS Gap filled Land Surface Temperature Daily": # ee\_id = "" else: ee\_id = ""
 asset\_id = st.text\_input("Enter an ee.ImageCollection asset ID:", ee\_id)
 if asset\_id: with st.expander("Customize band combination and color palette", True): try: col = ee.ImageCollection.load(asset\_id) st.session\_state["ee\_asset\_id"] = asset\_id except: st.error("Invalid Earth Engine asset ID.") st.session\_state["ee\_asset\_id"] = None return
 img\_bands = col.first().bandNames().getInfo() if len(img\_bands) >= 3: default\_bands = img\_bands[:3][::-1] else: default\_bands = img\_bands[:] bands = st.multiselect( "Select one or three bands (RGB):", img\_bands, default\_bands ) st.session\_state["bands"] = bands
 if len(bands) == 1: palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=2, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write( cm.plot\_colormap(cmap=palette\_options, return\_fig=True) ) st.session\_state["palette"] = eval(palette)
 if bands: vis\_params = st.text\_area( "Enter visualization parameters", "{'bands': [" + ", ".join([f"'{band}'" for band in bands]) + "]}", ) else: vis\_params = st.text\_area( "Enter visualization parameters", "{}", ) try: st.session\_state["vis\_params"] = eval(vis\_params) st.session\_state["vis\_params"]["palette"] = st.session\_state[ "palette" ] except Exception as e: st.session\_state["vis\_params"] = None st.error( f"Invalid visualization parameters. It must be a dictionary." )
 elif collection == "MODIS Gap filled Land Surface Temperature Daily": with st.expander("Show dataset details", False): st.markdown( """ See the [Awesome GEE Community Datasets](https://samapriya.github.io/awesome-gee-community-datasets/projects/daily\_lst/). """ )
 MODIS\_options = ["Daytime (1:30 pm)", "Nighttime (1:30 am)"] MODIS\_option = st.selectbox("Select a MODIS dataset:", MODIS\_options) if MODIS\_option == "Daytime (1:30 pm)": st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" else: st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=90, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette) elif collection == "MODIS Ocean Color SMI": with st.expander("Show dataset details", False): st.markdown( """ See the [Earth Engine Data Catalog](https://developers.google.com/earth-engine/datasets/catalog/NASA\_OCEANDATA\_MODIS-Aqua\_L3SMI). """ )
 MODIS\_options = ["Aqua", "Terra"] MODIS\_option = st.selectbox("Select a satellite:", MODIS\_options) st.session\_state["ee\_asset\_id"] = MODIS\_option # if MODIS\_option == "Daytime (1:30 pm)": # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" # else: # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 band\_dict = { "Chlorophyll a concentration": "chlor\_a", "Normalized fluorescence line height": "nflh", "Particulate organic carbon": "poc", "Sea surface temperature": "sst", "Remote sensing reflectance at band 412nm": "Rrs\_412", "Remote sensing reflectance at band 443nm": "Rrs\_443", "Remote sensing reflectance at band 469nm": "Rrs\_469", "Remote sensing reflectance at band 488nm": "Rrs\_488", "Remote sensing reflectance at band 531nm": "Rrs\_531", "Remote sensing reflectance at band 547nm": "Rrs\_547", "Remote sensing reflectance at band 555nm": "Rrs\_555", "Remote sensing reflectance at band 645nm": "Rrs\_645", "Remote sensing reflectance at band 667nm": "Rrs\_667", "Remote sensing reflectance at band 678nm": "Rrs\_678", }
 band\_options = list(band\_dict.keys()) band = st.selectbox( "Select a band", band\_options, band\_options.index("Sea surface temperature"), ) st.session\_state["band"] = band\_dict[band]
 colors = cm.list\_colormaps() palette\_options = st.selectbox( "Color palette", colors, index=colors.index("coolwarm"), ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette)
 sample\_roi = st.selectbox( "Select a sample ROI or upload a GeoJSON file:", roi\_options, index=0, )
 add\_outline = st.checkbox( "Overlay an administrative boundary on timelapse", False )
 if add\_outline:
 with st.expander("Customize administrative boundary", True):
 overlay\_options = { "User-defined": None, "Continents": "continents", "Countries": "countries", "US States": "us\_states", "China": "china", }
 overlay = st.selectbox( "Select an administrative boundary:", list(overlay\_options.keys()), index=2, )
 overlay\_data = overlay\_options[overlay]
 if overlay\_data is None: overlay\_data = st.text\_input( "Enter an HTTP URL to a GeoJSON file or an ee.FeatureCollection asset id:", "https://raw.githubusercontent.com/giswqs/geemap/master/examples/data/countries.geojson", )
 overlay\_color = st.color\_picker( "Select a color for the administrative boundary:", "#000000" ) overlay\_width = st.slider( "Select a line width for the administrative boundary:", 1, 20, 1 ) overlay\_opacity = st.slider( "Select an opacity for the administrative boundary:", 0.0, 1.0, 1.0, 0.05, ) else: overlay\_data = None overlay\_color = "black" overlay\_width = 1 overlay\_opacity = 1
 with row1\_col1:
 with st.expander( "Steps: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Expand this tab to see a demo 👉" ): video\_empty = st.empty()
 data = st.file\_uploader( "Upload a GeoJSON file to use as an ROI. Customize timelapse parameters and then click the Submit button 😇👇", type=["geojson", "kml", "zip"], )
 crs = "epsg:4326" if sample\_roi == "Uploaded GeoJSON": if data is None: # st.info( # "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click Submit button" # ) if collection in [ "Geostationary Operational Environmental Satellites (GOES)", "USDA National Agriculture Imagery Program (NAIP)", ] and (not keyword): m.set\_center(-100, 40, 3) # else: # m.set\_center(4.20, 18.63, zoom=2) else: if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection == "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] )
 if sample\_roi != "Uploaded GeoJSON":
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] ) elif collection == "MODIS Ocean Color SMI": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[ocean\_rois[sample\_roi]] ) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return m.add\_gdf(gdf, "ROI")
 elif data: gdf = uploaded\_file\_to\_gdf(data) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) m.add\_gdf(gdf, "ROI") except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return
 m.to\_streamlit(height=600)
 with row1\_col2:
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]:
 if collection == "Landsat TM-ETM-OLI Surface Reflectance": sensor\_start\_year = 1984 timelapse\_title = "Landsat Timelapse" timelapse\_speed = 5 elif collection == "Sentinel-2 MSI Surface Reflectance": sensor\_start\_year = 2015 timelapse\_title = "Sentinel-2 Timelapse" timelapse\_speed = 5 video\_empty.video("https://youtu.be/VVRK\_-dEjR4")
 with st.form("submit\_landsat\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 title = st.text\_input( "Enter a title to show on the timelapse: ", timelapse\_title ) RGB = st.selectbox( "Select an RGB band combination:", [ "Red/Green/Blue", "NIR/Red/Green", "SWIR2/SWIR1/NIR", "NIR/SWIR1/Red", "SWIR2/NIR/Red", "SWIR2/SWIR1/Red", "SWIR1/NIR/Blue", "NIR/SWIR1/Blue", "SWIR2/NIR/Green", "SWIR1/NIR/Red", "SWIR2/NIR/SWIR1", "SWIR1/NIR/SWIR2", ], index=9, )
 frequency = st.selectbox( "Select a temporal frequency:", ["year", "quarter", "month"], index=0, )
 with st.expander("Customize timelapse"):
 speed = st.slider("Frames per second:", 1, 30, timelapse\_speed) dimensions = st.slider( "Maximum dimensions (Width\*Height) in pixels", 768, 2000, 768 ) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) years = st.slider( "Start and end year:", sensor\_start\_year, today.year, (sensor\_start\_year, today.year), ) months = st.slider("Start and end month:", 1, 12, (1, 12)) font\_size = st.slider("Font size:", 10, 50, 30) font\_color = st.color\_picker("Font color:", "#ffffff") apply\_fmask = st.checkbox( "Apply fmask (remove clouds, shadows, snow)", True ) font\_type = st.selectbox( "Select the font type for the title:", ["arial.ttf", "alibaba.otf"], index=0, ) fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_fire\_image = st.empty() empty\_video = st.container() submitted = st.form\_submit\_button("Submit") if submitted:
 if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else:
 empty\_text.text("Computing... Please wait...")
 start\_year = years[0] end\_year = years[1] start\_date = str(months[0]).zfill(2) + "-01" end\_date = str(months[1]).zfill(2) + "-30" bands = RGB.split("/")
 try: if collection == "Landsat TM-ETM-OLI Surface Reflectance": out\_gif = geemap.landsat\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, # dimensions=dimensions, dimensions=768, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) elif collection == "Sentinel-2 MSI Surface Reflectance": out\_gif = geemap.sentinel2\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, dimensions=768, # dimensions=dimensions, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) except: empty\_text.error( "An error occurred while computing the timelapse. Your probably requested too much data. Try reducing the ROI or timespan." ) st.stop()
 if out\_gif is not None and os.path.exists(out\_gif):
 empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 else: empty\_text.error( "Something went wrong. You probably requested too much data. Try reducing the ROI or timespan." )
 elif collection == "Geostationary Operational Environmental Satellites (GOES)":
 video\_empty.video("https://youtu.be/16fA2QORG4A")
 with st.form("submit\_goes\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 satellite = st.selectbox("Select a satellite:", ["GOES-17", "GOES-16"]) earliest\_date = datetime.date(2017, 7, 10) latest\_date = datetime.date.today()
 if sample\_roi == "Uploaded GeoJSON": roi\_start\_date = today - datetime.timedelta(days=2) roi\_end\_date = today - datetime.timedelta(days=1) roi\_start\_time = datetime.time(14, 00) roi\_end\_time = datetime.time(1, 00) else: roi\_start = goes\_rois[sample\_roi]["start\_time"] roi\_end = goes\_rois[sample\_roi]["end\_time"] roi\_start\_date = datetime.datetime.strptime( roi\_start[:10], "%Y-%m-%d" ) roi\_end\_date = datetime.datetime.strptime(roi\_end[:10], "%Y-%m-%d") roi\_start\_time = datetime.time( int(roi\_start[11:13]), int(roi\_start[14:16]) ) roi\_end\_time = datetime.time( int(roi\_end[11:13]), int(roi\_end[14:16]) )
 start\_date = st.date\_input("Select the start date:", roi\_start\_date) end\_date = st.date\_input("Select the end date:", roi\_end\_date)
 with st.expander("Customize timelapse"):
 add\_fire = st.checkbox("Add Fire/Hotspot Characterization", False)
 scan\_type = st.selectbox( "Select a scan type:", ["Full Disk", "CONUS", "Mesoscale"] )
 start\_time = st.time\_input( "Select the start time of the start date:", roi\_start\_time )
 end\_time = st.time\_input( "Select the end time of the end date:", roi\_end\_time )
 start = ( start\_date.strftime("%Y-%m-%d") + "T" + start\_time.strftime("%H:%M:%S") ) end = ( end\_date.strftime("%Y-%m-%d") + "T" + end\_time.strftime("%H:%M:%S") )
 speed = st.slider("Frames per second:", 1, 30, 5) add\_progress\_bar = st.checkbox("Add a progress bar", True) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) font\_size = st.slider("Font size:", 10, 50, 20) font\_color = st.color\_picker("Font color:", "#ffffff") fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_video = st.container() empty\_fire\_text = st.empty() empty\_fire\_image = st.empty()
 submitted = st.form\_submit\_button("Submit") if submitted: if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else: empty\_text.text("Computing... Please wait...")
 geemap.goes\_timelapse( roi, out\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, mp4=mp4, fading=fading, )
 if out\_gif is not None and os.path.exists(out\_gif): empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 if add\_fire: out\_fire\_gif = geemap.temp\_file\_path(".gif") empty\_fire\_text.text( "Delineating Fire Hotspot... Please wait..." ) geemap.goes\_fire\_timelapse( out\_fire\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), region=roi, dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, ) if os.path.exists(out\_fire\_gif): empty\_fire\_image.image(out\_fire\_gif) else:[View remainder of file in raw view](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6724fdc4_20250110_213843.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fcommit%2Fc4f81d9616d40c60584e36abb15300853a66e489)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fcommit%2Fc4f81d9616d40c60584e36abb15300853a66e489)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=opengeos%2Fstreamlit-geospatial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opengeos](/opengeos)
/
**[streamlit-geospatial](/opengeos/streamlit-geospatial)**
Public

* [Notifications](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)
* [Star
   894](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)

* [Code](/opengeos/streamlit-geospatial)
* [Issues
  3](/opengeos/streamlit-geospatial/issues)
* [Pull requests
  1](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects
  0](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

Additional navigation options

* [Code](/opengeos/streamlit-geospatial)
* [Issues](/opengeos/streamlit-geospatial/issues)
* [Pull requests](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

## Commit

[Permalink](/opengeos/streamlit-geospatial/commit/c4f81d9616d40c60584e36abb15300853a66e489)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix GitHub Vulnerability ([#136](https://github.com/opengeos/streamlit-geospatial/pull/136))

[Browse files](/opengeos/streamlit-geospatial/tree/c4f81d9616d40c60584e36abb15300853a66e489)
Browse the repository at this point in the history

* Loading branch information

[![@giswqs](https://avatars.githubusercontent.com/u/5016453?s=40&v=4)](/giswqs)

[giswqs](/opengeos/streamlit-geospatial/commits?author=giswqs "View all commits by giswqs")
authored
Jul 19, 2024

1 parent
[3f9b00a](/opengeos/streamlit-geospatial/commit/3f9b00add5af011621fdf0f647c5174a72f2b486)

commit c4f81d9

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**68 additions**
and
**12 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* pages

  + pages/10\_🌍\_Earth\_Engine\_Datasets.py
    [10\_🌍\_Earth\_Engine\_Datasets.py](#diff-21c3cb63a03067cd7dc0150852abdac8d1d6893238fec42ec816fe0a4fce3a91)
  + pages/1\_📷\_Timelapse.py
    [1\_📷\_Timelapse.py](#diff-edd2f0b4b99a65493795a1420e3efb542dff011a477d4e2760a34bb8eaccdedd)
  + pages/7\_📦\_Web\_Map\_Service.py
    [7\_📦\_Web\_Map\_Service.py](#diff-28b848d0395754168396b5757ee64a905cf5188a12d5f0bcbd74f05f603993c8)
  + pages/8\_🏜️\_Raster\_Data\_Visualization.py
    [8\_🏜️\_Raster\_Data\_Visualization.py](#diff-a79996f6b735220af495dd23edce2e4f47a929893f754eac948256e2cdcea19c)
  + pages/9\_🔲\_Vector\_Data\_Visualization.py
    [9\_🔲\_Vector\_Data\_Visualization.py](#diff-775a8abec841d3c38ef90d445f1607d26a66a1d5d910b3e7ff4aebc512208a6e)

## There are no files selected for viewing

13 changes: 11 additions & 2 deletions

13
[pages/10\_🌍\_Earth\_Engine\_Datasets.py](#diff-21c3cb63a03067cd7dc0150852abdac8d1d6893238fec42ec816fe0a4fce3a91 "pages/10_🌍_Earth_Engine_Datasets.py")

Show comments

[View file](/opengeos/streamlit-geospatial/blob/c4f81d9616d40c60584e36abb15300853a66e489/pages/10_%F0%9F%8C%8D_Earth_Engine_Datasets.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import ee |
|  |  | import json |
|  |  | import streamlit as st |
|  |  | import geemap.foliumap as geemap |
|  |  |  |
| Expand Down  Expand Up | | @@ -110,6 +111,14 @@ def search\_data(): |
|  |  | uid = ee\_assets[index]["uid"] |
|  |  | st.markdown(f"""\*\*Earth Engine Snippet:\*\* `{ee\_id}`""") |
|  |  | ee\_asset = f"{translate[asset\_types[index]]}{ee\_id}')" |
|  |  |  |
|  |  | if ee\_asset.startswith("ee.ImageCollection"): |
|  |  | ee\_asset = ee.ImageCollection(ee\_id) |
|  |  | elif ee\_asset.startswith("ee.Image"): |
|  |  | ee\_asset = ee.Image(ee\_id) |
|  |  | elif ee\_asset.startswith("ee.FeatureCollection"): |
|  |  | ee\_asset = ee.FeatureCollection(ee\_id) |
|  |  |  |
|  |  | vis\_params = st.text\_input( |
|  |  | "Enter visualization parameters as a dictionary", {} |
|  |  | ) |
| Expand All | | @@ -121,11 +130,11 @@ def search\_data(): |
|  |  | if vis\_params.strip() == "": |
|  |  | # st.error("Please enter visualization parameters") |
|  |  | vis\_params = "{}" |
|  |  | vis = eval(vis\_params) |
|  |  | vis = json.loads(vis\_params.replace("'", '"')) |
|  |  | if not isinstance(vis, dict): |
|  |  | st.error("Visualization parameters must be a dictionary") |
|  |  | try: |
|  |  | Map.addLayer(eval(ee\_asset), vis, layer\_name) |
|  |  | Map.addLayer(ee\_asset, vis, layer\_name) |
|  |  | except Exception as e: |
|  |  | st.error(f"Error adding layer: {e}") |
|  |  | except Exception as e: |
| Expand Down | |  |

17 changes: 12 additions & 5 deletions

17
[pages/1\_📷\_Timelapse.py](#diff-edd2f0b4b99a65493795a1420e3efb542dff011a477d4e2760a34bb8eaccdedd "pages/1_📷_Timelapse.py")

Show comments

[View file](/opengeos/streamlit-geospatial/blob/c4f81d9616d40c60584e36abb15300853a66e489/pages/1_%F0%9F%93%B7_Timelapse.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import ee |
|  |  | import json |
|  |  | import os |
|  |  | import warnings |
|  |  | import datetime |
| Expand Down  Expand Up | | @@ -377,7 +378,9 @@ def app(): |
|  |  | st.write( |
|  |  | cm.plot\_colormap(cmap=palette\_options, return\_fig=True) |
|  |  | ) |
|  |  | st.session\_state["palette"] = eval(palette) |
|  |  | st.session\_state["palette"] = json.loads( |
|  |  | palette.replace("'", '"') |
|  |  | ) |
|  |  |  |
|  |  | if bands: |
|  |  | vis\_params = st.text\_area( |
| Expand All | | @@ -392,7 +395,9 @@ def app(): |
|  |  | "{}", |
|  |  | ) |
|  |  | try: |
|  |  | st.session\_state["vis\_params"] = eval(vis\_params) |
|  |  | st.session\_state["vis\_params"] = json.loads( |
|  |  | vis\_params.replace("'", '"') |
|  |  | ) |
|  |  | st.session\_state["vis\_params"]["palette"] = st.session\_state[ |
|  |  | "palette" |
|  |  | ] |
| Expand Down  Expand Up | | @@ -432,7 +437,7 @@ def app(): |
|  |  | palette\_values, |
|  |  | ) |
|  |  | st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) |
|  |  | st.session\_state["palette"] = eval(palette) |
|  |  | st.session\_state["palette"] = json.loads(palette.replace("'", '"')) |
|  |  | elif collection == "MODIS Ocean Color SMI": |
|  |  | with st.expander("Show dataset details", False): |
|  |  | st.markdown( |
| Expand Down  Expand Up | | @@ -490,7 +495,7 @@ def app(): |
|  |  | palette\_values, |
|  |  | ) |
|  |  | st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) |
|  |  | st.session\_state["palette"] = eval(palette) |
|  |  | st.session\_state["palette"] = json.loads(palette.replace("'", '"')) |
|  |  |  |
|  |  | sample\_roi = st.selectbox( |
|  |  | "Select a sample ROI or upload a GeoJSON file:", |
| Expand Down  Expand Up | | @@ -1342,7 +1347,9 @@ def app(): |
|  |  | if vis\_params.startswith("{") and vis\_params.endswith( |
|  |  | "}" |
|  |  | ): |
|  |  | vis\_params = eval(vis\_params) |
|  |  | vis\_params = json.loads( |
|  |  | vis\_params.replace("'", '"') |
|  |  | ) |
|  |  | else: |
|  |  | vis\_params = None |
|  |  | out\_gif = geemap.modis\_ocean\_color\_timelapse( |
| Expand Down | |  |

22 changes: 20 additions & 2 deletions

22
[pages/7\_📦\_Web\_Map\_Service.py](#diff-28b848d0395754168396b5757ee64a905cf5188a12d5f0bcbd74f05f603993c8 "pages/7_📦_Web_Map_Service.py")

Show comments

[View file](/opengeos/streamlit-geospatial/blob/c4f81d9616d40c60584e36abb15300853a66e489/pages/7_%F0%9F%93%A6_Web_Map_Service.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import ast |
|  |  | import json |
|  |  | import streamlit as st |
|  |  | import leafmap.foliumap as leafmap |
|  |  |  |
| Expand All | | @@ -19,13 +20,23 @@ |
|  |  | """ |
|  |  | ) |
|  |  |  |
|  |  | # Define a whitelist of trusted URLs |
|  |  | trusted\_urls = [ |
|  |  | "https://services.terrascope.be/wms/v2", |
|  |  | # Add more trusted URLs here |
|  |  | ] |
|  |  |  |
|  |  |  |
|  |  | @st.cache\_data |
|  |  | def get\_layers(url): |
|  |  | options = leafmap.get\_wms\_layers(url) |
|  |  | return options |
|  |  |  |
|  |  |  |
|  |  | def is\_trusted\_url(url): |
|  |  | return url in trusted\_urls |
|  |  |  |
|  |  |  |
|  |  | def app(): |
|  |  | st.title("Web Map Service (WMS)") |
|  |  | st.markdown( |
| Expand All | | @@ -50,7 +61,14 @@ def app(): |
|  |  | empty = st.empty() |
|  |  |  |
|  |  | if url: |
|  |  | options = get\_layers(url) |
|  |  |  |
|  |  | if is\_trusted\_url(url): |
|  |  | options = get\_layers(url) |
|  |  | # Process options as needed |
|  |  | else: |
|  |  | st.error( |
|  |  | "The entered URL is not trusted. Please enter a valid WMS URL." |
|  |  | ) |
|  |  |  |
|  |  | default = None |
|  |  | if url == esa\_landcover: |
| Expand Down  Expand Up | | @@ -79,7 +97,7 @@ def app(): |
|  |  | url, layers=layer, name=layer, attribution=" ", transparent=True |
|  |  | ) |
|  |  | if add\_legend and legend\_text: |
|  |  | legend\_dict = ast.literal\_eval(legend\_text) |
|  |  | legend\_dict = json.loads(legend\_text.replace("'", '"')) |
|  |  | m.add\_legend(legend\_dict=legend\_dict) |
|  |  |  |
|  |  | m.to\_streamlit(height=height) |
| Expand Down | |  |

15 changes: 13 additions & 2 deletions

15
[pages/8\_🏜️\_Raster\_Data\_Visualization.py](#diff-a79996f6b735220af495dd23edce2e4f47a929893f754eac948256e2cdcea19c "pages/8_🏜️_Raster_Data_Visualization.py")

Show comments

[View file](/opengeos/streamlit-geospatial/blob/c4f81d9616d40c60584e36abb15300853a66e489/pages/8_%F0%9F%8F%9C%EF%B8%8F_Raster_Data_Visualization.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,4 @@ |
|  |  | import json |
|  |  | import os |
|  |  | import leafmap.foliumap as leafmap |
|  |  | import leafmap.colormaps as cm |
| Expand Down  Expand Up | | @@ -45,6 +46,14 @@ def get\_palettes(): |
|  |  | """ |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def is\_trusted\_url(url): |
|  |  | if url.startswith("https://opendata.digitalglobe.com/events/california-fire-2020/"): |
|  |  | return True |
|  |  | else: |
|  |  | return False |
|  |  |  |
|  |  |  |
|  |  | row1\_col1, row1\_col2 = st.columns([2, 1]) |
|  |  |  |
|  |  | with row1\_col1: |
| Expand All | | @@ -59,7 +68,7 @@ def get\_palettes(): |
|  |  | cog, |
|  |  | ) |
|  |  |  |
|  |  | if url: |
|  |  | if is\_trusted\_url(url): |
|  |  | try: |
|  |  | options = leafmap.cog\_bands(url) |
|  |  | except Exception as e: |
| Expand All | | @@ -74,6 +83,8 @@ def get\_palettes(): |
|  |  | pass |
|  |  | else: |
|  |  | st.error("Please select one or three bands") |
|  |  | else: |
|  |  | st.error("Please enter a trusted URL") |
|  |  |  |
|  |  | add\_params = st.checkbox("Add visualization parameters") |
|  |  | if add\_params: |
| Expand All | | @@ -83,7 +94,7 @@ def get\_palettes(): |
|  |  |  |
|  |  | if len(vis\_params) > 0: |
|  |  | try: |
|  |  | vis\_params = eval(vis\_params) |
|  |  | vis\_params = json.loads(vis\_params.replace("'", '"')) |
|  |  | except Exception as e: |
|  |  | st.error( |
|  |  | f"Invalid visualization parameters. It should be a dictionary. Error: {e}" |
| Expand Down | |  |

13 changes: 12 additions & 1 deletion

13
[pages/9\_🔲\_Vector\_Data\_Visualization.py](#diff-775a8abec841d3c38ef90d445f1607d26a66a1d5d910b3e7ff4aebc512208a6e "pages/9_🔲_Vector_Data_Visualization.py")

Show comments

[View file](/opengeos/streamlit-geospatial/blob/c4f81d9616d40c60584e36abb15300853a66e489/pages/9_%F0%9F%94%B2_Vector_Data_Visualization.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,6 +21,17 @@ |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | # Define a whitelist of trusted URLs |
|  |  | trusted\_urls = [ |
|  |  | "https://github.com/giswqs/streamlit-geospatial/raw/master/data/us\_states.geojson", |
|  |  | # Add more trusted URLs here |
|  |  | ] |
|  |  |  |
|  |  |  |
|  |  | def is\_trusted\_url(url): |
|  |  | return url in trusted\_urls |
|  |  |  |
|  |  |  |
|  |  | def save\_uploaded\_file(file\_content, file\_name): |
|  |  | """ |
|  |  | Save the uploaded file to a temporary directory |
| Expand Down  Expand Up | | @@ -71,7 +82,7 @@ def app(): |
|  |  |  |
|  |  | container = st.container() |
|  |  |  |
|  |  | if data or url: |
|  |  | if data or is\_trusted\_url(url): |
|  |  | if data: |
|  |  | file\_path = save\_uploaded\_file(data, data.name) |
|  |  | layer\_name = os.path.splitext(data.name)[0] |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c4f81d9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fcommit%2Fc4f81d9616d40c60584e36abb15300853a66e489) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_682dd2ea_20250110_213839.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=opengeos%2Fstreamlit-geospatial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opengeos](/opengeos)
/
**[streamlit-geospatial](/opengeos/streamlit-geospatial)**
Public

* [Notifications](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)
* [Star
   894](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)

* [Code](/opengeos/streamlit-geospatial)
* [Issues
  3](/opengeos/streamlit-geospatial/issues)
* [Pull requests
  1](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects
  0](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

Additional navigation options

* [Code](/opengeos/streamlit-geospatial)
* [Issues](/opengeos/streamlit-geospatial/issues)
* [Pull requests](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

## Files

 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Copy path Blame  Blame
## Latest commit

## History

[History](/opengeos/streamlit-geospatial/commits/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1528 lines (1365 loc) · 64.4 KB 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Top
## File metadata and controls

* Code
* Blame

1528 lines (1365 loc) · 64.4 KB[Raw](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000import eeimport osimport warningsimport datetimeimport fionaimport geopandas as gpdimport foliumimport streamlit as stimport geemap.colormaps as cmimport geemap.foliumap as geemapfrom datetime import datefrom shapely.geometry import Polygon
st.set\_page\_config(layout="wide")warnings.filterwarnings("ignore")
@st.cache\_datadef ee\_authenticate(token\_name="EARTHENGINE\_TOKEN"): geemap.ee\_initialize(token\_name=token\_name)
st.sidebar.info( """ - Web App URL: <https://streamlit.geemap.org> - GitHub repository: <https://github.com/giswqs/streamlit-geospatial> """)
st.sidebar.title("Contact")st.sidebar.info( """ Qiusheng Wu: <https://wetlands.io> [GitHub](https://github.com/giswqs) | [Twitter](https://twitter.com/giswqs) | [YouTube](https://www.youtube.com/c/QiushengWu) | [LinkedIn](https://www.linkedin.com/in/qiushengwu) """)
goes\_rois = { "Creek Fire, CA (2020-09-05)": { "region": Polygon( [ [-121.003418, 36.848857], [-121.003418, 39.049052], [-117.905273, 39.049052], [-117.905273, 36.848857], [-121.003418, 36.848857], ] ), "start\_time": "2020-09-05T15:00:00", "end\_time": "2020-09-06T02:00:00", }, "Bomb Cyclone (2021-10-24)": { "region": Polygon( [ [-159.5954, 60.4088], [-159.5954, 24.5178], [-114.2438, 24.5178], [-114.2438, 60.4088], ] ), "start\_time": "2021-10-24T14:00:00", "end\_time": "2021-10-25T01:00:00", }, "Hunga Tonga Volcanic Eruption (2022-01-15)": { "region": Polygon( [ [-192.480469, -32.546813], [-192.480469, -8.754795], [-157.587891, -8.754795], [-157.587891, -32.546813], [-192.480469, -32.546813], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", }, "Hunga Tonga Volcanic Eruption Closer Look (2022-01-15)": { "region": Polygon( [ [-178.901367, -22.958393], [-178.901367, -17.85329], [-171.452637, -17.85329], [-171.452637, -22.958393], [-178.901367, -22.958393], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", },}
landsat\_rois = { "Aral Sea": Polygon( [ [57.667236, 43.834527], [57.667236, 45.996962], [61.12793, 45.996962], [61.12793, 43.834527], [57.667236, 43.834527], ] ), "Dubai": Polygon( [ [54.541626, 24.763044], [54.541626, 25.427152], [55.632019, 25.427152], [55.632019, 24.763044], [54.541626, 24.763044], ] ), "Hong Kong International Airport": Polygon( [ [113.825226, 22.198849], [113.825226, 22.349758], [114.085121, 22.349758], [114.085121, 22.198849], [113.825226, 22.198849], ] ), "Las Vegas, NV": Polygon( [ [-115.554199, 35.804449], [-115.554199, 36.558188], [-113.903503, 36.558188], [-113.903503, 35.804449], [-115.554199, 35.804449], ] ), "Pucallpa, Peru": Polygon( [ [-74.672699, -8.600032], [-74.672699, -8.254983], [-74.279938, -8.254983], [-74.279938, -8.600032], ] ), "Sierra Gorda, Chile": Polygon( [ [-69.315491, -22.837104], [-69.315491, -22.751488], [-69.190006, -22.751488], [-69.190006, -22.837104], [-69.315491, -22.837104], ] ),}
modis\_rois = { "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ), "Africa": Polygon( [ [-18.6983, 38.1446], [-18.6983, -36.1630], [52.2293, -36.1630], [52.2293, 38.1446], ] ), "USA": Polygon( [ [-127.177734, 23.725012], [-127.177734, 50.792047], [-66.269531, 50.792047], [-66.269531, 23.725012], [-127.177734, 23.725012], ] ),}
ocean\_rois = { "Gulf of Mexico": Polygon( [ [-101.206055, 15.496032], [-101.206055, 32.361403], [-75.673828, 32.361403], [-75.673828, 15.496032], [-101.206055, 15.496032], ] ), "North Atlantic Ocean": Polygon( [ [-85.341797, 24.046464], [-85.341797, 45.02695], [-55.810547, 45.02695], [-55.810547, 24.046464], [-85.341797, 24.046464], ] ), "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ),}
@st.cache\_datadef uploaded\_file\_to\_gdf(data): import tempfile import os import uuid
 \_, file\_extension = os.path.splitext(data.name) file\_id = str(uuid.uuid4()) file\_path = os.path.join(tempfile.gettempdir(), f"{file\_id}{file\_extension}")
 with open(file\_path, "wb") as file: file.write(data.getbuffer())
 if file\_path.lower().endswith(".kml"): fiona.drvsupport.supported\_drivers["KML"] = "rw" gdf = gpd.read\_file(file\_path, driver="KML") else: gdf = gpd.read\_file(file\_path)
 return gdf
def app():
 today = date.today()
 st.title("Create Satellite Timelapse")
 st.markdown( """ An interactive web app for creating [Landsat](https://developers.google.com/earth-engine/datasets/catalog/landsat)/[GOES](https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16) timelapse for any location around the globe.  The app was built using [streamlit](https://streamlit.io), [geemap](https://geemap.org), and [Google Earth Engine](https://earthengine.google.com). For more info, check out my streamlit [blog post](https://blog.streamlit.io/creating-satellite-timelapse-with-streamlit-and-earth-engine).  """ )
 row1\_col1, row1\_col2 = st.columns([2, 1])
 if st.session\_state.get("zoom\_level") is None: st.session\_state["zoom\_level"] = 4
 st.session\_state["ee\_asset\_id"] = None st.session\_state["bands"] = None st.session\_state["palette"] = None st.session\_state["vis\_params"] = None
 with row1\_col1: ee\_authenticate(token\_name="EARTHENGINE\_TOKEN") m = geemap.Map( basemap="HYBRID", plugin\_Draw=True, Draw\_export=True, locate\_control=True, plugin\_LatLngPopup=False, ) m.add\_basemap("ROADMAP")
 with row1\_col2:
 keyword = st.text\_input("Search for a location:", "") if keyword: locations = geemap.geocode(keyword) if locations is not None and len(locations) > 0: str\_locations = [str(g)[1:-1] for g in locations] location = st.selectbox("Select a location:", str\_locations) loc\_index = str\_locations.index(location) selected\_loc = locations[loc\_index] lat, lng = selected\_loc.lat, selected\_loc.lng folium.Marker(location=[lat, lng], popup=location).add\_to(m) m.set\_center(lng, lat, 12) st.session\_state["zoom\_level"] = 12
 collection = st.selectbox( "Select a satellite image collection: ", [ "Any Earth Engine ImageCollection", "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", "Geostationary Operational Environmental Satellites (GOES)", "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", "MODIS Ocean Color SMI", "USDA National Agriculture Imagery Program (NAIP)", ], index=1, )
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: roi\_options = ["Uploaded GeoJSON"] + list(landsat\_rois.keys())
 elif collection == "Geostationary Operational Environmental Satellites (GOES)": roi\_options = ["Uploaded GeoJSON"] + list(goes\_rois.keys())
 elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: roi\_options = ["Uploaded GeoJSON"] + list(modis\_rois.keys()) elif collection == "MODIS Ocean Color SMI": roi\_options = ["Uploaded GeoJSON"] + list(ocean\_rois.keys()) else: roi\_options = ["Uploaded GeoJSON"]
 if collection == "Any Earth Engine ImageCollection": keyword = st.text\_input("Enter a keyword to search (e.g., MODIS):", "") if keyword:
 assets = geemap.search\_ee\_data(keyword) ee\_assets = [] for asset in assets: if asset["ee\_id\_snippet"].startswith("ee.ImageCollection"): ee\_assets.append(asset)
 asset\_titles = [x["title"] for x in ee\_assets] dataset = st.selectbox("Select a dataset:", asset\_titles) if len(ee\_assets) > 0: st.session\_state["ee\_assets"] = ee\_assets st.session\_state["asset\_titles"] = asset\_titles index = asset\_titles.index(dataset) ee\_id = ee\_assets[index]["id"] else: ee\_id = ""
 if dataset is not None: with st.expander("Show dataset details", False): index = asset\_titles.index(dataset) html = geemap.ee\_data\_html(st.session\_state["ee\_assets"][index]) st.markdown(html, True) # elif collection == "MODIS Gap filled Land Surface Temperature Daily": # ee\_id = "" else: ee\_id = ""
 asset\_id = st.text\_input("Enter an ee.ImageCollection asset ID:", ee\_id)
 if asset\_id: with st.expander("Customize band combination and color palette", True): try: col = ee.ImageCollection.load(asset\_id) st.session\_state["ee\_asset\_id"] = asset\_id except: st.error("Invalid Earth Engine asset ID.") st.session\_state["ee\_asset\_id"] = None return
 img\_bands = col.first().bandNames().getInfo() if len(img\_bands) >= 3: default\_bands = img\_bands[:3][::-1] else: default\_bands = img\_bands[:] bands = st.multiselect( "Select one or three bands (RGB):", img\_bands, default\_bands ) st.session\_state["bands"] = bands
 if len(bands) == 1: palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=2, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write( cm.plot\_colormap(cmap=palette\_options, return\_fig=True) ) st.session\_state["palette"] = eval(palette)
 if bands: vis\_params = st.text\_area( "Enter visualization parameters", "{'bands': [" + ", ".join([f"'{band}'" for band in bands]) + "]}", ) else: vis\_params = st.text\_area( "Enter visualization parameters", "{}", ) try: st.session\_state["vis\_params"] = eval(vis\_params) st.session\_state["vis\_params"]["palette"] = st.session\_state[ "palette" ] except Exception as e: st.session\_state["vis\_params"] = None st.error( f"Invalid visualization parameters. It must be a dictionary." )
 elif collection == "MODIS Gap filled Land Surface Temperature Daily": with st.expander("Show dataset details", False): st.markdown( """ See the [Awesome GEE Community Datasets](https://samapriya.github.io/awesome-gee-community-datasets/projects/daily\_lst/). """ )
 MODIS\_options = ["Daytime (1:30 pm)", "Nighttime (1:30 am)"] MODIS\_option = st.selectbox("Select a MODIS dataset:", MODIS\_options) if MODIS\_option == "Daytime (1:30 pm)": st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" else: st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=90, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette) elif collection == "MODIS Ocean Color SMI": with st.expander("Show dataset details", False): st.markdown( """ See the [Earth Engine Data Catalog](https://developers.google.com/earth-engine/datasets/catalog/NASA\_OCEANDATA\_MODIS-Aqua\_L3SMI). """ )
 MODIS\_options = ["Aqua", "Terra"] MODIS\_option = st.selectbox("Select a satellite:", MODIS\_options) st.session\_state["ee\_asset\_id"] = MODIS\_option # if MODIS\_option == "Daytime (1:30 pm)": # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" # else: # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 band\_dict = { "Chlorophyll a concentration": "chlor\_a", "Normalized fluorescence line height": "nflh", "Particulate organic carbon": "poc", "Sea surface temperature": "sst", "Remote sensing reflectance at band 412nm": "Rrs\_412", "Remote sensing reflectance at band 443nm": "Rrs\_443", "Remote sensing reflectance at band 469nm": "Rrs\_469", "Remote sensing reflectance at band 488nm": "Rrs\_488", "Remote sensing reflectance at band 531nm": "Rrs\_531", "Remote sensing reflectance at band 547nm": "Rrs\_547", "Remote sensing reflectance at band 555nm": "Rrs\_555", "Remote sensing reflectance at band 645nm": "Rrs\_645", "Remote sensing reflectance at band 667nm": "Rrs\_667", "Remote sensing reflectance at band 678nm": "Rrs\_678", }
 band\_options = list(band\_dict.keys()) band = st.selectbox( "Select a band", band\_options, band\_options.index("Sea surface temperature"), ) st.session\_state["band"] = band\_dict[band]
 colors = cm.list\_colormaps() palette\_options = st.selectbox( "Color palette", colors, index=colors.index("coolwarm"), ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette)
 sample\_roi = st.selectbox( "Select a sample ROI or upload a GeoJSON file:", roi\_options, index=0, )
 add\_outline = st.checkbox( "Overlay an administrative boundary on timelapse", False )
 if add\_outline:
 with st.expander("Customize administrative boundary", True):
 overlay\_options = { "User-defined": None, "Continents": "continents", "Countries": "countries", "US States": "us\_states", "China": "china", }
 overlay = st.selectbox( "Select an administrative boundary:", list(overlay\_options.keys()), index=2, )
 overlay\_data = overlay\_options[overlay]
 if overlay\_data is None: overlay\_data = st.text\_input( "Enter an HTTP URL to a GeoJSON file or an ee.FeatureCollection asset id:", "https://raw.githubusercontent.com/giswqs/geemap/master/examples/data/countries.geojson", )
 overlay\_color = st.color\_picker( "Select a color for the administrative boundary:", "#000000" ) overlay\_width = st.slider( "Select a line width for the administrative boundary:", 1, 20, 1 ) overlay\_opacity = st.slider( "Select an opacity for the administrative boundary:", 0.0, 1.0, 1.0, 0.05, ) else: overlay\_data = None overlay\_color = "black" overlay\_width = 1 overlay\_opacity = 1
 with row1\_col1:
 with st.expander( "Steps: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Expand this tab to see a demo 👉" ): video\_empty = st.empty()
 data = st.file\_uploader( "Upload a GeoJSON file to use as an ROI. Customize timelapse parameters and then click the Submit button 😇👇", type=["geojson", "kml", "zip"], )
 crs = "epsg:4326" if sample\_roi == "Uploaded GeoJSON": if data is None: # st.info( # "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click Submit button" # ) if collection in [ "Geostationary Operational Environmental Satellites (GOES)", "USDA National Agriculture Imagery Program (NAIP)", ] and (not keyword): m.set\_center(-100, 40, 3) # else: # m.set\_center(4.20, 18.63, zoom=2) else: if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection == "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] )
 if sample\_roi != "Uploaded GeoJSON":
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] ) elif collection == "MODIS Ocean Color SMI": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[ocean\_rois[sample\_roi]] ) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return m.add\_gdf(gdf, "ROI")
 elif data: gdf = uploaded\_file\_to\_gdf(data) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) m.add\_gdf(gdf, "ROI") except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return
 m.to\_streamlit(height=600)
 with row1\_col2:
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]:
 if collection == "Landsat TM-ETM-OLI Surface Reflectance": sensor\_start\_year = 1984 timelapse\_title = "Landsat Timelapse" timelapse\_speed = 5 elif collection == "Sentinel-2 MSI Surface Reflectance": sensor\_start\_year = 2015 timelapse\_title = "Sentinel-2 Timelapse" timelapse\_speed = 5 video\_empty.video("https://youtu.be/VVRK\_-dEjR4")
 with st.form("submit\_landsat\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 title = st.text\_input( "Enter a title to show on the timelapse: ", timelapse\_title ) RGB = st.selectbox( "Select an RGB band combination:", [ "Red/Green/Blue", "NIR/Red/Green", "SWIR2/SWIR1/NIR", "NIR/SWIR1/Red", "SWIR2/NIR/Red", "SWIR2/SWIR1/Red", "SWIR1/NIR/Blue", "NIR/SWIR1/Blue", "SWIR2/NIR/Green", "SWIR1/NIR/Red", "SWIR2/NIR/SWIR1", "SWIR1/NIR/SWIR2", ], index=9, )
 frequency = st.selectbox( "Select a temporal frequency:", ["year", "quarter", "month"], index=0, )
 with st.expander("Customize timelapse"):
 speed = st.slider("Frames per second:", 1, 30, timelapse\_speed) dimensions = st.slider( "Maximum dimensions (Width\*Height) in pixels", 768, 2000, 768 ) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) years = st.slider( "Start and end year:", sensor\_start\_year, today.year, (sensor\_start\_year, today.year), ) months = st.slider("Start and end month:", 1, 12, (1, 12)) font\_size = st.slider("Font size:", 10, 50, 30) font\_color = st.color\_picker("Font color:", "#ffffff") apply\_fmask = st.checkbox( "Apply fmask (remove clouds, shadows, snow)", True ) font\_type = st.selectbox( "Select the font type for the title:", ["arial.ttf", "alibaba.otf"], index=0, ) fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_fire\_image = st.empty() empty\_video = st.container() submitted = st.form\_submit\_button("Submit") if submitted:
 if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else:
 empty\_text.text("Computing... Please wait...")
 start\_year = years[0] end\_year = years[1] start\_date = str(months[0]).zfill(2) + "-01" end\_date = str(months[1]).zfill(2) + "-30" bands = RGB.split("/")
 try: if collection == "Landsat TM-ETM-OLI Surface Reflectance": out\_gif = geemap.landsat\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, # dimensions=dimensions, dimensions=768, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) elif collection == "Sentinel-2 MSI Surface Reflectance": out\_gif = geemap.sentinel2\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, dimensions=768, # dimensions=dimensions, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) except: empty\_text.error( "An error occurred while computing the timelapse. Your probably requested too much data. Try reducing the ROI or timespan." ) st.stop()
 if out\_gif is not None and os.path.exists(out\_gif):
 empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 else: empty\_text.error( "Something went wrong. You probably requested too much data. Try reducing the ROI or timespan." )
 elif collection == "Geostationary Operational Environmental Satellites (GOES)":
 video\_empty.video("https://youtu.be/16fA2QORG4A")
 with st.form("submit\_goes\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 satellite = st.selectbox("Select a satellite:", ["GOES-17", "GOES-16"]) earliest\_date = datetime.date(2017, 7, 10) latest\_date = datetime.date.today()
 if sample\_roi == "Uploaded GeoJSON": roi\_start\_date = today - datetime.timedelta(days=2) roi\_end\_date = today - datetime.timedelta(days=1) roi\_start\_time = datetime.time(14, 00) roi\_end\_time = datetime.time(1, 00) else: roi\_start = goes\_rois[sample\_roi]["start\_time"] roi\_end = goes\_rois[sample\_roi]["end\_time"] roi\_start\_date = datetime.datetime.strptime( roi\_start[:10], "%Y-%m-%d" ) roi\_end\_date = datetime.datetime.strptime(roi\_end[:10], "%Y-%m-%d") roi\_start\_time = datetime.time( int(roi\_start[11:13]), int(roi\_start[14:16]) ) roi\_end\_time = datetime.time( int(roi\_end[11:13]), int(roi\_end[14:16]) )
 start\_date = st.date\_input("Select the start date:", roi\_start\_date) end\_date = st.date\_input("Select the end date:", roi\_end\_date)
 with st.expander("Customize timelapse"):
 add\_fire = st.checkbox("Add Fire/Hotspot Characterization", False)
 scan\_type = st.selectbox( "Select a scan type:", ["Full Disk", "CONUS", "Mesoscale"] )
 start\_time = st.time\_input( "Select the start time of the start date:", roi\_start\_time )
 end\_time = st.time\_input( "Select the end time of the end date:", roi\_end\_time )
 start = ( start\_date.strftime("%Y-%m-%d") + "T" + start\_time.strftime("%H:%M:%S") ) end = ( end\_date.strftime("%Y-%m-%d") + "T" + end\_time.strftime("%H:%M:%S") )
 speed = st.slider("Frames per second:", 1, 30, 5) add\_progress\_bar = st.checkbox("Add a progress bar", True) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) font\_size = st.slider("Font size:", 10, 50, 20) font\_color = st.color\_picker("Font color:", "#ffffff") fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_video = st.container() empty\_fire\_text = st.empty() empty\_fire\_image = st.empty()
 submitted = st.form\_submit\_button("Submit") if submitted: if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else: empty\_text.text("Computing... Please wait...")
 geemap.goes\_timelapse( roi, out\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, mp4=mp4, fading=fading, )
 if out\_gif is not None and os.path.exists(out\_gif): empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 if add\_fire: out\_fire\_gif = geemap.temp\_file\_path(".gif") empty\_fire\_text.text( "Delineating Fire Hotspot... Please wait..." ) geemap.goes\_fire\_timelapse( out\_fire\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), region=roi, dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, ) if os.path.exists(out\_fire\_gif): empty\_fire\_image.image(out\_fire\_gif) else:[View remainder of file in raw view](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securitylab.github.com_6f98c703_20250110_213843.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

July 25, 2024
# GHSL-2024-100\_GHSL-2024-108: RCE and blind SSRF in Streamlit-geospatial - CVE-2024-41112, CVE-2024-41113, CVE-2024-41114, CVE-2024-41115, CVE-2024-41116, CVE-2024-41117, CVE-2024-41118, CVE-2024-41119, CVE-2024-41120

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2024-06-17: Sent the report to the maintainer’s email.
* 2024-07-19: Sent a follow up email asking for an update. Received an answer with the fix and was asked to request the CVEs for the issues.
* 2024-07-19: GitHub Security Lab assigns CVEs to the vulnerabilities.

## Summary

Streamlit-geospatial project contains several remote code execution and blind server-side request forgery vulnerabilities.

## Project

streamlit-geospatial

## Tested Version

latest

## Details

### Issue 1: Remote code execution in `pages/1_📷_Timelapse.py` `Any Earth Engine ImageCollection` option `palette` (`GHSL-2024-100`)

The [`palette` variable](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L373-L376) in `pages/1_📷_Timelapse.py` takes user input, which is later used in [the `eval()` function on line 380](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L380), leading to remote code execution.

```
  palette = st.text_area(
      "Enter a custom palette:",
      palette_values,
  )
  st.write(
      cm.plot_colormap(cmap=palette_options, return_fig=True)
  )
  st.session_state["palette"] = eval(palette)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 📷 Timelapse tab and:
   * in `Select a satellite image collection:` choose `Any Earth Engine Image Collection`
   * in `Enter an ee.ImageCollection asset ID:` type `ECMWF/CAMS/NRT`
3. Open `Customize band combination and color palette` and paste into `Enter a custom palette`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 2: Remote code execution in `pages/1_📷_Timelapse.py` `Any Earth Engine ImageCollection` option `vis_params` (`GHSL-2024-101`)

The `vis_params` variable on [line 383](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L383-L388) or [line 390](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L390-L393) in `pages/1_📷_Timelapse.py` takes user input, which is later used in the [`eval()` function on line 395](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L395), leading to remote code execution.

```
 if bands:
    vis_params = st.text_area(
        "Enter visualization parameters",
        "{'bands': ["
        + ", ".join([f"'{band}'" for band in bands])
        + "]}",
    )
else:
    vis_params = st.text_area(
        "Enter visualization parameters",
        "{}",
    )
try:
    st.session_state["vis_params"] = eval(vis_params)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 📷 Timelapse tab and:
   * in `Select a satellite image collection:` choose `Any Earth Engine Image Collection`
   * in `Enter an ee.ImageCollection asset ID:` type `ECMWF/CAMS/NRT`
3. Open `Customize band combination and color palette` and paste into `Enter visualization parameters`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 3: Remote code execution in `pages/1_📷_Timelapse.py` `MODIS Gap filled Land Surface Temperature Daily` option (`GHSL-2024-102`)

The `palette` variable on [line 430](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L430) in `pages/1_📷_Timelapse.py` takes user input, which is later used in the `eval()` function on [line 435](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L435), leading to remote code execution.

```
palette = st.text_area(
    "Enter a custom palette:",
    palette_values,
)
st.write(cm.plot_colormap(cmap=palette_options, return_fig=True))
st.session_state["palette"] = eval(palette)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 📷 Timelapse tab and in `Select a satellite image collection:` choose `MODIS Gap filled Land Surface Temperature Daily`
3. Paste into `Enter a custom palette`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 4: Remote code execution in `pages/1_📷_Timelapse.py` `MODIS Ocean Color SMI` option `palette` (`GHSL-2024-103`)

The `palette` variable on [line 488](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L488) in `pages/1_📷_Timelapse.py` takes user input, which is later used in the `eval()` function on [line 493](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L493), leading to remote code execution.

```
palette = st.text_area(
    "Enter a custom palette:",
    palette_values,
)
st.write(cm.plot_colormap(cmap=palette_options, return_fig=True))
st.session_state["palette"] = eval(palette)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 📷 Timelapse tab and in `Select a satellite image collection:` choose `MODIS Ocean Color SMI`
3. Paste into `Enter a custom palette`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 5: Remote code execution in `pages/1_📷_Timelapse.py` `MODIS Ocean Color SMI` option `vis_params` (`GHSL-2024-104`)

The `vis_params` variable on [line 1254](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L1254) in `pages/1_📷_Timelapse.py` takes user input, which is later used in the `eval()` function on [line 1345](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py#L1345), leading to remote code execution.

```
vis_params = st.text_area(
    "Enter visualization parameters",
    "",
    help="Enter a string in the format of a dictionary, such as '{'min': 23, 'max': 32}'",
)

--- snip

        elif collection == "MODIS Ocean Color SMI":
            if vis_params.startswith("{") and vis_params.endswith(
                "}"
            ):
                vis_params = eval(vis_params)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 📷 Timelapse tab and:
   * in `Select a satellite image collection:` choose `MODIS Ocean Color SMI`
   * in `Select a sample ROI or upload a GeoJSON file` choose `World`
3. Open `Customize timelapse` and paste into `Enter visualization parameters`:
   ```
   {__import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')}

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 6: Remote code execution in `pages/10_🌍_Earth_Engine_Datasets.py` (`GHSL-2024-105`)

The `vis_params` variable on [line 115](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/10_%F0%9F%8C%8D_Earth_Engine_Datasets.py#L115) in `pages/10_🌍_Earth_Engine_Datasets.py` takes user input, which is later used in the `eval()` function on [line 126](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/10_%F0%9F%8C%8D_Earth_Engine_Datasets.py#L126), leading to remote code execution.

```
vis_params = st.text_input(
    "Enter visualization parameters as a dictionary", {}
)
layer_name = st.text_input("Enter a layer name", uid)
button = st.button("Add dataset to map")
if button:
    vis = {}
    try:
        if vis_params.strip() == "":
            # st.error("Please enter visualization parameters")
            vis_params = "{}"
        vis = eval(vis_params)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 🌍 Earth Engine Datasets tab and in `Enter a keyword to search (e.g., elevation)` type `elevation`
3. Paste into `Enter visualization parameters as a dictionary`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 7: Remote code execution in `pages/8_🏜️_Raster_Data_Visualization.py` (`GHSL-2024-107`)

The `vis_params` variable on [line 80](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/8_%F0%9F%8F%9C%EF%B8%8F_Raster_Data_Visualization.py#L80) in `8_🏜️_Raster_Data_Visualization.py` takes user input, which is later used in the `eval()` function on [line 86](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/8_%F0%9F%8F%9C%EF%B8%8F_Raster_Data_Visualization.py#L86), leading to remote code execution.

```
add_params = st.checkbox("Add visualization parameters")
if add_params:
    vis_params = st.text_area("Enter visualization parameters", "{}")
else:
    vis_params = {}

if len(vis_params) > 0:
    try:
        vis_params = eval(vis_params)

```
#### Impact

This issue may lead to `remote code execution`.

#### PoC

1. Start streamlit-geospatial
2. Go to 🏜️ Raster Data Visualization tab and select `Add visualization parameters`.
3. Paste into `Enter visualization parameters`:
   ```
   __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')

   ```
4. Observe in the server, that a file foobar.txt has been created, and contains the output of the command `uname -a`.

### Issue 8: Blind SSRF in `pages/7_📦_Web_Map_Service.py` (`GHSL-2024-106`)

The `url` variable on [line 47](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/7_%F0%9F%93%A6_Web_Map_Service.py#L47) takes user  input, which is passed to [get\_layers](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/7_%F0%9F%93%A6_Web_Map_Service.py#L53) function, in which `url` is used with [get\_wms\_layer](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/7_%F0%9F%93%A6_Web_Map_Service.py#L25) method. [get\_wms\_layer](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/7_%F0%9F%93%A6_Web_Map_Service.py#L25) method creates a request to arbitrary destinations, leading to blind server-side request forgery.

```
@st.cache_data
def get_layers(url):
    options = leafmap.get_wms_layers(url)
    return options

--- snip

        url = st.text_input(
            "Enter a WMS URL:", value="https://services.terrascope.be/wms/v2"
        )
        empty = st.empty()

        if url:
            options = get_layers(url)

```
#### Impact

This issue allows for sending requests on behalf of the streamlit-geospatial server and can be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems on the internal network, that the streamlit-geospatial server can reach.

See also: https://portswigger.net/web-security/ssrf/blind

#### PoC

1. Start streamlit-geospatial.
2. Create a new folder with a file `file.txt`. Start a simple HTTP server in the folder by executing `python -m http.server`. It will start a server on 127.0.0.1:8000.
3. Go to 📦 Web Map Service tab and in `Enter a WMS URL:` type `http://127.0.0.1:8000/file.txt`
4. Observe that a request to the file was logged in the python server.

### Issue 9: Blind SSRF in `pages/9_🔲_Vector_Data_Visualization.py` (`GHSL-2024-108`)

The `url` variable on [line 63](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/9_%F0%9F%94%B2_Vector_Data_Visualization.py#L63) takes user input, which is later passed to the [`gpd.read_file` method](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/9_%F0%9F%94%B2_Vector_Data_Visualization.py#L87). `gpd.read_file` method creates a request to arbitrary destinations, leading to blind server-side request forgery.

```
    url = empty.text_input(
        "Enter a HTTP URL to a Cloud Optimized GeoTIFF (COG)",
        cog,
    )

    if url:
        try:
            options = leafmap.cog_bands(url)

```
#### Impact

This issue allows for sending requests on behalf of the streamlit-geospatial server and can be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems on the internal network, that the streamlit-geospatial server can reach.

See also: https://portswigger.net/web-security/ssrf/blind

#### PoC

1. Start streamlit-geospatial.
2. Create a new folder with a file `file.txt`. Start a simple HTTP server in the folder by executing `python -m http.server`. It will start a server on 127.0.0.1:8000.
3. Go to 🔲 Vector Data Visualization tab and in `Enter a URL to a vector dataset` type `http://127.0.0.1:8000/file.txt`
4. Observe that a request to the file was logged in the python server.

## CVE

* GHSL-2024-100 - CVE-2024-41112
* GHSL-2024-101 - CVE-2024-41113
* GHSL-2024-102 - CVE-2024-41114
* GHSL-2024-103 - CVE-2024-41115
* GHSL-2024-104 - CVE-2024-41116
* GHSL-2024-105 - CVE-2024-41117
* GHSL-2024-106 - CVE-2024-41118
* GHSL-2024-107 - CVE-2024-41119
* GHSL-2024-108 - CVE-2024-41120

## Credit

These issues were discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-100`, `GHSL-2024-101`, `GHSL-2024-102`, `GHSL-2024-103`, `GHSL-2024-104`, `GHSL-2024-105`, `GHSL-2024-106`, `GHSL-2024-107`, or `GHSL-2024-108` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_0a997333_20250110_213840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=opengeos%2Fstreamlit-geospatial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opengeos](/opengeos)
/
**[streamlit-geospatial](/opengeos/streamlit-geospatial)**
Public

* [Notifications](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)
* [Star
   894](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)

* [Code](/opengeos/streamlit-geospatial)
* [Issues
  3](/opengeos/streamlit-geospatial/issues)
* [Pull requests
  1](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects
  0](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

Additional navigation options

* [Code](/opengeos/streamlit-geospatial)
* [Issues](/opengeos/streamlit-geospatial/issues)
* [Pull requests](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

## Files

 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Copy path Blame  Blame
## Latest commit

## History

[History](/opengeos/streamlit-geospatial/commits/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1528 lines (1365 loc) · 64.4 KB 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_📷\_Timelapse.py

Top
## File metadata and controls

* Code
* Blame

1528 lines (1365 loc) · 64.4 KB[Raw](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000import eeimport osimport warningsimport datetimeimport fionaimport geopandas as gpdimport foliumimport streamlit as stimport geemap.colormaps as cmimport geemap.foliumap as geemapfrom datetime import datefrom shapely.geometry import Polygon
st.set\_page\_config(layout="wide")warnings.filterwarnings("ignore")
@st.cache\_datadef ee\_authenticate(token\_name="EARTHENGINE\_TOKEN"): geemap.ee\_initialize(token\_name=token\_name)
st.sidebar.info( """ - Web App URL: <https://streamlit.geemap.org> - GitHub repository: <https://github.com/giswqs/streamlit-geospatial> """)
st.sidebar.title("Contact")st.sidebar.info( """ Qiusheng Wu: <https://wetlands.io> [GitHub](https://github.com/giswqs) | [Twitter](https://twitter.com/giswqs) | [YouTube](https://www.youtube.com/c/QiushengWu) | [LinkedIn](https://www.linkedin.com/in/qiushengwu) """)
goes\_rois = { "Creek Fire, CA (2020-09-05)": { "region": Polygon( [ [-121.003418, 36.848857], [-121.003418, 39.049052], [-117.905273, 39.049052], [-117.905273, 36.848857], [-121.003418, 36.848857], ] ), "start\_time": "2020-09-05T15:00:00", "end\_time": "2020-09-06T02:00:00", }, "Bomb Cyclone (2021-10-24)": { "region": Polygon( [ [-159.5954, 60.4088], [-159.5954, 24.5178], [-114.2438, 24.5178], [-114.2438, 60.4088], ] ), "start\_time": "2021-10-24T14:00:00", "end\_time": "2021-10-25T01:00:00", }, "Hunga Tonga Volcanic Eruption (2022-01-15)": { "region": Polygon( [ [-192.480469, -32.546813], [-192.480469, -8.754795], [-157.587891, -8.754795], [-157.587891, -32.546813], [-192.480469, -32.546813], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", }, "Hunga Tonga Volcanic Eruption Closer Look (2022-01-15)": { "region": Polygon( [ [-178.901367, -22.958393], [-178.901367, -17.85329], [-171.452637, -17.85329], [-171.452637, -22.958393], [-178.901367, -22.958393], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", },}
landsat\_rois = { "Aral Sea": Polygon( [ [57.667236, 43.834527], [57.667236, 45.996962], [61.12793, 45.996962], [61.12793, 43.834527], [57.667236, 43.834527], ] ), "Dubai": Polygon( [ [54.541626, 24.763044], [54.541626, 25.427152], [55.632019, 25.427152], [55.632019, 24.763044], [54.541626, 24.763044], ] ), "Hong Kong International Airport": Polygon( [ [113.825226, 22.198849], [113.825226, 22.349758], [114.085121, 22.349758], [114.085121, 22.198849], [113.825226, 22.198849], ] ), "Las Vegas, NV": Polygon( [ [-115.554199, 35.804449], [-115.554199, 36.558188], [-113.903503, 36.558188], [-113.903503, 35.804449], [-115.554199, 35.804449], ] ), "Pucallpa, Peru": Polygon( [ [-74.672699, -8.600032], [-74.672699, -8.254983], [-74.279938, -8.254983], [-74.279938, -8.600032], ] ), "Sierra Gorda, Chile": Polygon( [ [-69.315491, -22.837104], [-69.315491, -22.751488], [-69.190006, -22.751488], [-69.190006, -22.837104], [-69.315491, -22.837104], ] ),}
modis\_rois = { "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ), "Africa": Polygon( [ [-18.6983, 38.1446], [-18.6983, -36.1630], [52.2293, -36.1630], [52.2293, 38.1446], ] ), "USA": Polygon( [ [-127.177734, 23.725012], [-127.177734, 50.792047], [-66.269531, 50.792047], [-66.269531, 23.725012], [-127.177734, 23.725012], ] ),}
ocean\_rois = { "Gulf of Mexico": Polygon( [ [-101.206055, 15.496032], [-101.206055, 32.361403], [-75.673828, 32.361403], [-75.673828, 15.496032], [-101.206055, 15.496032], ] ), "North Atlantic Ocean": Polygon( [ [-85.341797, 24.046464], [-85.341797, 45.02695], [-55.810547, 45.02695], [-55.810547, 24.046464], [-85.341797, 24.046464], ] ), "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ),}
@st.cache\_datadef uploaded\_file\_to\_gdf(data): import tempfile import os import uuid
 \_, file\_extension = os.path.splitext(data.name) file\_id = str(uuid.uuid4()) file\_path = os.path.join(tempfile.gettempdir(), f"{file\_id}{file\_extension}")
 with open(file\_path, "wb") as file: file.write(data.getbuffer())
 if file\_path.lower().endswith(".kml"): fiona.drvsupport.supported\_drivers["KML"] = "rw" gdf = gpd.read\_file(file\_path, driver="KML") else: gdf = gpd.read\_file(file\_path)
 return gdf
def app():
 today = date.today()
 st.title("Create Satellite Timelapse")
 st.markdown( """ An interactive web app for creating [Landsat](https://developers.google.com/earth-engine/datasets/catalog/landsat)/[GOES](https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16) timelapse for any location around the globe.  The app was built using [streamlit](https://streamlit.io), [geemap](https://geemap.org), and [Google Earth Engine](https://earthengine.google.com). For more info, check out my streamlit [blog post](https://blog.streamlit.io/creating-satellite-timelapse-with-streamlit-and-earth-engine).  """ )
 row1\_col1, row1\_col2 = st.columns([2, 1])
 if st.session\_state.get("zoom\_level") is None: st.session\_state["zoom\_level"] = 4
 st.session\_state["ee\_asset\_id"] = None st.session\_state["bands"] = None st.session\_state["palette"] = None st.session\_state["vis\_params"] = None
 with row1\_col1: ee\_authenticate(token\_name="EARTHENGINE\_TOKEN") m = geemap.Map( basemap="HYBRID", plugin\_Draw=True, Draw\_export=True, locate\_control=True, plugin\_LatLngPopup=False, ) m.add\_basemap("ROADMAP")
 with row1\_col2:
 keyword = st.text\_input("Search for a location:", "") if keyword: locations = geemap.geocode(keyword) if locations is not None and len(locations) > 0: str\_locations = [str(g)[1:-1] for g in locations] location = st.selectbox("Select a location:", str\_locations) loc\_index = str\_locations.index(location) selected\_loc = locations[loc\_index] lat, lng = selected\_loc.lat, selected\_loc.lng folium.Marker(location=[lat, lng], popup=location).add\_to(m) m.set\_center(lng, lat, 12) st.session\_state["zoom\_level"] = 12
 collection = st.selectbox( "Select a satellite image collection: ", [ "Any Earth Engine ImageCollection", "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", "Geostationary Operational Environmental Satellites (GOES)", "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", "MODIS Ocean Color SMI", "USDA National Agriculture Imagery Program (NAIP)", ], index=1, )
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: roi\_options = ["Uploaded GeoJSON"] + list(landsat\_rois.keys())
 elif collection == "Geostationary Operational Environmental Satellites (GOES)": roi\_options = ["Uploaded GeoJSON"] + list(goes\_rois.keys())
 elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: roi\_options = ["Uploaded GeoJSON"] + list(modis\_rois.keys()) elif collection == "MODIS Ocean Color SMI": roi\_options = ["Uploaded GeoJSON"] + list(ocean\_rois.keys()) else: roi\_options = ["Uploaded GeoJSON"]
 if collection == "Any Earth Engine ImageCollection": keyword = st.text\_input("Enter a keyword to search (e.g., MODIS):", "") if keyword:
 assets = geemap.search\_ee\_data(keyword) ee\_assets = [] for asset in assets: if asset["ee\_id\_snippet"].startswith("ee.ImageCollection"): ee\_assets.append(asset)
 asset\_titles = [x["title"] for x in ee\_assets] dataset = st.selectbox("Select a dataset:", asset\_titles) if len(ee\_assets) > 0: st.session\_state["ee\_assets"] = ee\_assets st.session\_state["asset\_titles"] = asset\_titles index = asset\_titles.index(dataset) ee\_id = ee\_assets[index]["id"] else: ee\_id = ""
 if dataset is not None: with st.expander("Show dataset details", False): index = asset\_titles.index(dataset) html = geemap.ee\_data\_html(st.session\_state["ee\_assets"][index]) st.markdown(html, True) # elif collection == "MODIS Gap filled Land Surface Temperature Daily": # ee\_id = "" else: ee\_id = ""
 asset\_id = st.text\_input("Enter an ee.ImageCollection asset ID:", ee\_id)
 if asset\_id: with st.expander("Customize band combination and color palette", True): try: col = ee.ImageCollection.load(asset\_id) st.session\_state["ee\_asset\_id"] = asset\_id except: st.error("Invalid Earth Engine asset ID.") st.session\_state["ee\_asset\_id"] = None return
 img\_bands = col.first().bandNames().getInfo() if len(img\_bands) >= 3: default\_bands = img\_bands[:3][::-1] else: default\_bands = img\_bands[:] bands = st.multiselect( "Select one or three bands (RGB):", img\_bands, default\_bands ) st.session\_state["bands"] = bands
 if len(bands) == 1: palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=2, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write( cm.plot\_colormap(cmap=palette\_options, return\_fig=True) ) st.session\_state["palette"] = eval(palette)
 if bands: vis\_params = st.text\_area( "Enter visualization parameters", "{'bands': [" + ", ".join([f"'{band}'" for band in bands]) + "]}", ) else: vis\_params = st.text\_area( "Enter visualization parameters", "{}", ) try: st.session\_state["vis\_params"] = eval(vis\_params) st.session\_state["vis\_params"]["palette"] = st.session\_state[ "palette" ] except Exception as e: st.session\_state["vis\_params"] = None st.error( f"Invalid visualization parameters. It must be a dictionary." )
 elif collection == "MODIS Gap filled Land Surface Temperature Daily": with st.expander("Show dataset details", False): st.markdown( """ See the [Awesome GEE Community Datasets](https://samapriya.github.io/awesome-gee-community-datasets/projects/daily\_lst/). """ )
 MODIS\_options = ["Daytime (1:30 pm)", "Nighttime (1:30 am)"] MODIS\_option = st.selectbox("Select a MODIS dataset:", MODIS\_options) if MODIS\_option == "Daytime (1:30 pm)": st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" else: st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=90, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette) elif collection == "MODIS Ocean Color SMI": with st.expander("Show dataset details", False): st.markdown( """ See the [Earth Engine Data Catalog](https://developers.google.com/earth-engine/datasets/catalog/NASA\_OCEANDATA\_MODIS-Aqua\_L3SMI). """ )
 MODIS\_options = ["Aqua", "Terra"] MODIS\_option = st.selectbox("Select a satellite:", MODIS\_options) st.session\_state["ee\_asset\_id"] = MODIS\_option # if MODIS\_option == "Daytime (1:30 pm)": # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" # else: # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 band\_dict = { "Chlorophyll a concentration": "chlor\_a", "Normalized fluorescence line height": "nflh", "Particulate organic carbon": "poc", "Sea surface temperature": "sst", "Remote sensing reflectance at band 412nm": "Rrs\_412", "Remote sensing reflectance at band 443nm": "Rrs\_443", "Remote sensing reflectance at band 469nm": "Rrs\_469", "Remote sensing reflectance at band 488nm": "Rrs\_488", "Remote sensing reflectance at band 531nm": "Rrs\_531", "Remote sensing reflectance at band 547nm": "Rrs\_547", "Remote sensing reflectance at band 555nm": "Rrs\_555", "Remote sensing reflectance at band 645nm": "Rrs\_645", "Remote sensing reflectance at band 667nm": "Rrs\_667", "Remote sensing reflectance at band 678nm": "Rrs\_678", }
 band\_options = list(band\_dict.keys()) band = st.selectbox( "Select a band", band\_options, band\_options.index("Sea surface temperature"), ) st.session\_state["band"] = band\_dict[band]
 colors = cm.list\_colormaps() palette\_options = st.selectbox( "Color palette", colors, index=colors.index("coolwarm"), ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette)
 sample\_roi = st.selectbox( "Select a sample ROI or upload a GeoJSON file:", roi\_options, index=0, )
 add\_outline = st.checkbox( "Overlay an administrative boundary on timelapse", False )
 if add\_outline:
 with st.expander("Customize administrative boundary", True):
 overlay\_options = { "User-defined": None, "Continents": "continents", "Countries": "countries", "US States": "us\_states", "China": "china", }
 overlay = st.selectbox( "Select an administrative boundary:", list(overlay\_options.keys()), index=2, )
 overlay\_data = overlay\_options[overlay]
 if overlay\_data is None: overlay\_data = st.text\_input( "Enter an HTTP URL to a GeoJSON file or an ee.FeatureCollection asset id:", "https://raw.githubusercontent.com/giswqs/geemap/master/examples/data/countries.geojson", )
 overlay\_color = st.color\_picker( "Select a color for the administrative boundary:", "#000000" ) overlay\_width = st.slider( "Select a line width for the administrative boundary:", 1, 20, 1 ) overlay\_opacity = st.slider( "Select an opacity for the administrative boundary:", 0.0, 1.0, 1.0, 0.05, ) else: overlay\_data = None overlay\_color = "black" overlay\_width = 1 overlay\_opacity = 1
 with row1\_col1:
 with st.expander( "Steps: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Expand this tab to see a demo 👉" ): video\_empty = st.empty()
 data = st.file\_uploader( "Upload a GeoJSON file to use as an ROI. Customize timelapse parameters and then click the Submit button 😇👇", type=["geojson", "kml", "zip"], )
 crs = "epsg:4326" if sample\_roi == "Uploaded GeoJSON": if data is None: # st.info( # "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click Submit button" # ) if collection in [ "Geostationary Operational Environmental Satellites (GOES)", "USDA National Agriculture Imagery Program (NAIP)", ] and (not keyword): m.set\_center(-100, 40, 3) # else: # m.set\_center(4.20, 18.63, zoom=2) else: if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection == "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] )
 if sample\_roi != "Uploaded GeoJSON":
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] ) elif collection == "MODIS Ocean Color SMI": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[ocean\_rois[sample\_roi]] ) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return m.add\_gdf(gdf, "ROI")
 elif data: gdf = uploaded\_file\_to\_gdf(data) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) m.add\_gdf(gdf, "ROI") except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return
 m.to\_streamlit(height=600)
 with row1\_col2:
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]:
 if collection == "Landsat TM-ETM-OLI Surface Reflectance": sensor\_start\_year = 1984 timelapse\_title = "Landsat Timelapse" timelapse\_speed = 5 elif collection == "Sentinel-2 MSI Surface Reflectance": sensor\_start\_year = 2015 timelapse\_title = "Sentinel-2 Timelapse" timelapse\_speed = 5 video\_empty.video("https://youtu.be/VVRK\_-dEjR4")
 with st.form("submit\_landsat\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 title = st.text\_input( "Enter a title to show on the timelapse: ", timelapse\_title ) RGB = st.selectbox( "Select an RGB band combination:", [ "Red/Green/Blue", "NIR/Red/Green", "SWIR2/SWIR1/NIR", "NIR/SWIR1/Red", "SWIR2/NIR/Red", "SWIR2/SWIR1/Red", "SWIR1/NIR/Blue", "NIR/SWIR1/Blue", "SWIR2/NIR/Green", "SWIR1/NIR/Red", "SWIR2/NIR/SWIR1", "SWIR1/NIR/SWIR2", ], index=9, )
 frequency = st.selectbox( "Select a temporal frequency:", ["year", "quarter", "month"], index=0, )
 with st.expander("Customize timelapse"):
 speed = st.slider("Frames per second:", 1, 30, timelapse\_speed) dimensions = st.slider( "Maximum dimensions (Width\*Height) in pixels", 768, 2000, 768 ) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) years = st.slider( "Start and end year:", sensor\_start\_year, today.year, (sensor\_start\_year, today.year), ) months = st.slider("Start and end month:", 1, 12, (1, 12)) font\_size = st.slider("Font size:", 10, 50, 30) font\_color = st.color\_picker("Font color:", "#ffffff") apply\_fmask = st.checkbox( "Apply fmask (remove clouds, shadows, snow)", True ) font\_type = st.selectbox( "Select the font type for the title:", ["arial.ttf", "alibaba.otf"], index=0, ) fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_fire\_image = st.empty() empty\_video = st.container() submitted = st.form\_submit\_button("Submit") if submitted:
 if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else:
 empty\_text.text("Computing... Please wait...")
 start\_year = years[0] end\_year = years[1] start\_date = str(months[0]).zfill(2) + "-01" end\_date = str(months[1]).zfill(2) + "-30" bands = RGB.split("/")
 try: if collection == "Landsat TM-ETM-OLI Surface Reflectance": out\_gif = geemap.landsat\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, # dimensions=dimensions, dimensions=768, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) elif collection == "Sentinel-2 MSI Surface Reflectance": out\_gif = geemap.sentinel2\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, dimensions=768, # dimensions=dimensions, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) except: empty\_text.error( "An error occurred while computing the timelapse. Your probably requested too much data. Try reducing the ROI or timespan." ) st.stop()
 if out\_gif is not None and os.path.exists(out\_gif):
 empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 else: empty\_text.error( "Something went wrong. You probably requested too much data. Try reducing the ROI or timespan." )
 elif collection == "Geostationary Operational Environmental Satellites (GOES)":
 video\_empty.video("https://youtu.be/16fA2QORG4A")
 with st.form("submit\_goes\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 satellite = st.selectbox("Select a satellite:", ["GOES-17", "GOES-16"]) earliest\_date = datetime.date(2017, 7, 10) latest\_date = datetime.date.today()
 if sample\_roi == "Uploaded GeoJSON": roi\_start\_date = today - datetime.timedelta(days=2) roi\_end\_date = today - datetime.timedelta(days=1) roi\_start\_time = datetime.time(14, 00) roi\_end\_time = datetime.time(1, 00) else: roi\_start = goes\_rois[sample\_roi]["start\_time"] roi\_end = goes\_rois[sample\_roi]["end\_time"] roi\_start\_date = datetime.datetime.strptime( roi\_start[:10], "%Y-%m-%d" ) roi\_end\_date = datetime.datetime.strptime(roi\_end[:10], "%Y-%m-%d") roi\_start\_time = datetime.time( int(roi\_start[11:13]), int(roi\_start[14:16]) ) roi\_end\_time = datetime.time( int(roi\_end[11:13]), int(roi\_end[14:16]) )
 start\_date = st.date\_input("Select the start date:", roi\_start\_date) end\_date = st.date\_input("Select the end date:", roi\_end\_date)
 with st.expander("Customize timelapse"):
 add\_fire = st.checkbox("Add Fire/Hotspot Characterization", False)
 scan\_type = st.selectbox( "Select a scan type:", ["Full Disk", "CONUS", "Mesoscale"] )
 start\_time = st.time\_input( "Select the start time of the start date:", roi\_start\_time )
 end\_time = st.time\_input( "Select the end time of the end date:", roi\_end\_time )
 start = ( start\_date.strftime("%Y-%m-%d") + "T" + start\_time.strftime("%H:%M:%S") ) end = ( end\_date.strftime("%Y-%m-%d") + "T" + end\_time.strftime("%H:%M:%S") )
 speed = st.slider("Frames per second:", 1, 30, 5) add\_progress\_bar = st.checkbox("Add a progress bar", True) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) font\_size = st.slider("Font size:", 10, 50, 20) font\_color = st.color\_picker("Font color:", "#ffffff") fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_video = st.container() empty\_fire\_text = st.empty() empty\_fire\_image = st.empty()
 submitted = st.form\_submit\_button("Submit") if submitted: if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else: empty\_text.text("Computing... Please wait...")
 geemap.goes\_timelapse( roi, out\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, mp4=mp4, fading=fading, )
 if out\_gif is not None and os.path.exists(out\_gif): empty\_text.text( "Right click the GIF to save it to your computer👇" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computer👇" ) st.video(out\_gif.replace(".gif", ".mp4"))
 if add\_fire: out\_fire\_gif = geemap.temp\_file\_path(".gif") empty\_fire\_text.text( "Delineating Fire Hotspot... Please wait..." ) geemap.goes\_fire\_timelapse( out\_fire\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), region=roi, dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, ) if os.path.exists(out\_fire\_gif): empty\_fire\_image.image(out\_fire\_gif) else:[View remainder of file in raw view](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


