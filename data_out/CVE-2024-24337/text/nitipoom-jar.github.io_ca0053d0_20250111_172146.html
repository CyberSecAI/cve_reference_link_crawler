
Quantiano

# CVE-2024-24337

2024-02-06

Nitipoom Jaroonchaipipat

---

## Product detail ⌗

Affected product: Koha

Affected version: 23.05.05.00 (This vulnerability was discovered on November 2023)

Affected components: '/members/moremember.pl' and 'admin/aqbudgets.pl'

A multiple CSV Injection vulnerability in the '/members/moremember.pl' and '/admin/aqbudgets.pl' endpoints within Koha Library Management System version <= 23.05.05 allows malicious staff users to inject DDE commands into input fields via the 'Budget' and 'Patrons Member' components. When a victim exports this data as a CSV file and opens the file containing the un-sanitized DDE command, the code executes, potentially launching programs on the victim's endpoint if macro security is disabled.

---

## Prerequisite [⌗](#proof-of-concept)

Install Koha from official Koha Github repository
[GitHub page](https://github.com/Koha-Community/Koha)

![](https://nitipoom-jar.github.io/CVE-2024-24337/0.png)

Installed Koha version 23.05.05

---

## Exploitation [⌗](#proof-of-concept)

1. Insert DDE command below into affected field

![](https://nitipoom-jar.github.io/CVE-2024-24337/1.png)

`DDE ("cmd";"/C cmd";"!A0")A0
DDE ("cmd";"/C notepad";"!A0")A0`

2. Export data as CSV

![](https://nitipoom-jar.github.io/CVE-2024-24337/2.png)
![](https://nitipoom-jar.github.io/CVE-2024-24337/3.png)

3. Victim open CSV with a macro setting disabled

![](https://nitipoom-jar.github.io/CVE-2024-24337/4.png)
![](https://nitipoom-jar.github.io/CVE-2024-24337/5.png)

DDE command was un-sanitized

![](https://nitipoom-jar.github.io/CVE-2024-24337/6.png)

© 2023 Powered by
[Hugo](https://gohugo.io)

::
[Theme](https://github.com/panr/hugo-theme-terminal)
made by
[panr](https://github.com/panr)

