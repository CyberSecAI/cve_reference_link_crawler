- **Root cause of vulnerability:** The Authd PAM module, up to version 0.3.4, allows changing the user in the PAM stack even when it has already been set. This enables a broker-managed user to impersonate any other user managed by the same broker.
- **Weaknesses/vulnerabilities present:** Improper user handling in the PAM module, specifically not validating if PAM_USER has changed, allowing user impersonation.
- **Impact of exploitation:** An attacker can authenticate as a different user using their own credentials. This allows them to perform actions with the impersonated user's privileges, including accessing their data, modifying their files, and potentially gaining elevated privileges.
- **Attack vectors:** Tools such as `su`, `sudo`, and `ssh` are affected. These tools do not check if the PAM user has changed during the authentication process.
- **Required attacker capabilities/position:** The attacker needs to be a broker-managed user and have valid credentials. They also require the ability to use affected tools like `su`, `sudo`, or `ssh`. The attacker can be on the same network as the target system.