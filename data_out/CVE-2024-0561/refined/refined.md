- **Root cause of vulnerability:** The WordPress plugin "Ultimate Posts Widget" fails to properly validate and escape widget options (specifically Title, URL, and CSS Classes) before outputting them in HTML attributes.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker with admin-level privileges can inject malicious JavaScript code into the widget options. This code is then executed when a user interacts with the widget, potentially leading to session hijacking, data theft, or other malicious activities.
- **Attack vectors:**
    - By creating/editing an Ultimate Post widget and inserting the malicious payload within the Title, URL or CSS Classes fields.
- **Required attacker capabilities/position:**
    - The attacker must have administrative privileges to create or edit widgets. The XSS payload is stored in the widget settings.
    - The vulnerability can be exploited even when the `unfiltered_html` capability is disallowed, such as in a multisite setup.