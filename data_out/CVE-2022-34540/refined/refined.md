This document does not relate to CVE-2022-34540, but it describes multiple vulnerabilities found in Digital Watchdog products.

**Vulnerabilities:**

*   **Information Disclosure (DW Spectrum server):**
    *   **Root Cause:**  The `/api/moduleInformation` endpoint exposes internal paths, IPs, OS version, and architecture.
    *   **Weakness:**  Information disclosure.
    *   **Impact:**  Exposed sensitive system information, which could be used in further attacks.
    *   **Attack Vector:** Sending a request to the `/api/moduleInformation` endpoint.
    *   **Required Capabilities:** None, the endpoint appears to be unauthenticated.

*   **Information Disclosure (MegaPix IP Camera):**
    *   **Root Cause:** Web files (`plugin_info_list.xml`, `plugin/plugin_web.conf`, `plugin/port.conf`) expose internal paths, scripts and software versions.
    *  **Weakness**: Information disclosure (CWE-201)
    *   **Impact:**  Exposure of internal information and potentially sensitive details about the camera and its plugins.
    *   **Attack Vector:** Accessing the mentioned web files through HTTP requests
    *  **Required Capabilities**: None, the URLs are unauthenticated

*  **Information Disclosure and Session Hijacking (MegaPix IP Camera):**
    *   **Root Cause:** Core logs contain session token information
    *   **Weakness**: Information disclosure (CWE-201)
    *   **Impact:** Allows session hijacking using token from the core file
    *   **Attack Vector:** 1. Trigger a 500 error by accessing  `192.168.1.80/cgi-bin/result?msubmenu=event&action`. 2. Access `/cgi-bin/core` to get the core log. 3. Extract session token from the error event in the core log.
    *   **Required Capabilities:** The attacker needs to trigger a 500 error to get the core log.

*   **Command Injection (MegaPix IP Camera - curltest.cgi):**
    *   **Root Cause:**  The `curltest.cgi` script is vulnerable to command injection in the `test[]` parameters.
    *   **Weakness:** Command injection (CWE-78).
    *   **Impact:** Arbitrary command execution on the camera.
    *   **Attack Vector:** Sending a crafted POST request to `/cgi-bin/admin/curltest.cgi` with malicious code in `test[]` parameters.
    *   **Required Capabilities:** Attacker needs to be authenticated.

*   **Command Injection (MegaPix IP Camera - addacph.cgi):**
    *   **Root Cause:** The `addacph.cgi` script is vulnerable to command injection through the `event`, `id`, `pluginname`, `name` and `evt_id` parameters.
    *   **Weakness:** Command injection (CWE-94).
    *   **Impact:** Arbitrary command execution on the camera.
    *   **Attack Vector:** Sending a crafted GET request to `/cgi-bin/admin/vca/bia/addacph.cgi` with malicious code in the parameters.
    *  **Required Capabilities:** Attacker needs to be authenticated.

*   **Command Injection (MegaPix IP Camera - license\_tok.cgi):**
    *   **Root Cause:** The `license_tok.cgi` script is vulnerable to command injection through POST parameters `guid`, `license_value`, and `plugin_info`.
    *   **Weakness:** Command injection (CWE-94).
    *   **Impact:** Arbitrary command execution on the camera.
    *   **Attack Vector:** Sending a crafted POST request to `/cgi-bin/admin/vca/license/license_tok.cgi` with malicious code in the parameters.
    *  **Required Capabilities:** Attacker needs to be authenticated.

*   **XSS Vulnerability (MegaPix IP Camera - bia\_oneshot.cgi):**
    *   **Root Cause:** The `bia_oneshot.cgi` script is vulnerable to cross-site scripting (XSS) through the `blob` parameter.
    *   **Weakness:** Cross-site scripting (CWE-79).
    *   **Impact:**  Persistent XSS, allowing the execution of arbitrary JavaScript in the context of a user's session.
    *   **Attack Vector:** Sending a GET request to `/cgi-bin/admin/vca/bia/bia_oneshot.cgi` with malicious HTML/JavaScript in the `blob` parameter.
    *   **Required Capabilities:**  Attacker needs to be authenticated.