Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3670

**Root Cause:** Insufficient input sanitization and output escaping of user-supplied attributes within the `mapsmarker` shortcode. Specifically, the `mapwidthunit` attribute was not properly sanitized.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The vulnerability allows an attacker to inject arbitrary web scripts into pages using the `mapsmarker` shortcode.

**Impact of Exploitation:**
*   Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a victim's browser when they visit a page containing the malicious shortcode. This can lead to:
    *   Session hijacking
    *   Redirection to malicious sites
    *   Defacement of the website
    *   Other malicious actions.

**Attack Vectors:**
*   The vulnerability is triggered via the `mapsmarker` shortcode in the Leaflet Maps Marker plugin.
*   Attackers inject malicious JavaScript code into the `mapwidthunit` attribute of the shortcode.

**Required Attacker Capabilities/Position:**
*   **Authenticated Contributor or higher:** Attackers need to have at least contributor-level access to the WordPress site to create/edit posts/pages.

**Additional Details:**
*   The vulnerable code exists within the `inc/showmap.php` file of the Leaflet Maps Marker plugin.
*   The fix involves sanitizing the `mapwidthunit` attribute to only allow `px` or `%` values.
*   The vulnerability affects versions up to and including 3.12.8.
*   Version 3.12.9 contains the fix.

The provided content offers more detail than a typical CVE description, including the specific vulnerable parameter, the affected code file, and the fix implemented by the vendor.