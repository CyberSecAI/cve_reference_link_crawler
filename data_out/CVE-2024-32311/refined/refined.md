- **Root cause of vulnerability:** Stack buffer overflow in the `decodePwd` function, which is called within the `formWanParameterSetting` function when handling specific parameters.
- **Weaknesses/vulnerabilities present:** The `decodePwd` function copies data from a user-controlled input (`adslPwd`) into a fixed-size buffer without proper bounds checking. Specifically, the code iterates through `*v3` until a null terminator is encountered, and writes each character into `*v4++`. The size of `v4` isn't checked, leading to a buffer overflow if the input size exceeds the buffer capacity.
- **Impact of exploitation:** A successful exploit can lead to arbitrary code execution. This is a stack-based buffer overflow, which is known to be used for overwriting the return address, among other stack variables. This can result in the device being compromised.
- **Attack vectors:** An attacker sends a crafted POST request to the `/goform/WanParameterSetting` endpoint with a large `adslPwd` parameter.
- **Required attacker capabilities/position:** The attacker must be able to send HTTP POST requests to the device. This typically involves network access to the router's web interface (LAN access and, if the interface is exposed, WAN access). The attacker must also be aware of the specific vulnerable function.