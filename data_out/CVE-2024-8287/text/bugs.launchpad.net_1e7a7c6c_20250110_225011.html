
[Log in / Register](https://bugs.launchpad.net/anbox-cloud/%2Bbug/2077570/%2Blogin)

[![](/@@/product-logo)](https://launchpad.net/anbox-cloud)

## [Anbox Cloud](https://launchpad.net/anbox-cloud)

* [Overview](https://launchpad.net/anbox-cloud)
* [Code](https://code.launchpad.net/anbox-cloud)
* [Bugs](https://bugs.launchpad.net/anbox-cloud)
* [Blueprints](https://blueprints.launchpad.net/anbox-cloud)
* [Translations](https://translations.launchpad.net/anbox-cloud)
* [Answers](https://answers.launchpad.net/anbox-cloud)

# Anbox does not verify TLS certificate provided by stream agent

Bug #2077570 reported by
[Simon Fels](https://launchpad.net/~morphis)
on 2024-08-21

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Anbox Cloud](https://bugs.launchpad.net/anbox-cloud) | Fix Released | High | [Simon Fels](https://launchpad.net/~morphis) | [Anbox Cloud 1.23.1](https://launchpad.net/anbox-cloud/%2Bmilestone/1.23.1) |

### Bug Description

The issue has been found with Anbox Cloud 1.23.0 but exists in previous versions back to 1.17.0.

The Anbox Stream Agent provides configuration to the Anbox instance including information on how to connect to the API endpoint it provides. This includes a fingerprint of the TLS certificate the agent uses for its API endpoint to allow Anbox to verify and establish trust. The configuration is provided by the stream agent through the AMS API which it has a mutual TLS authenticated connection for API access with. When the stream agent triggers the launch of a new instance via the AMS API it hands the configuration as a JSON document to AMS. AMS then uses the LXD API over a mutual TLS authenticated connection to LXD which puts it into the /var/lib/anbox/userdata path within the instance. When AMS starts the instance via the LXD API the Anbox instance reads the configuration from /var/lib/anbox/userdata on startup and connects to the API endpoints the agent provided. There are two endpoints Anbox connects to: one for WebRTC signaling and one for receiving control information. Only the signaling endpoint is affected by this issue. The control API endpoint is correctly verified with the provided fingerprint.

The found issue is causing Anbox to not validate the certificate the agent presents against the fingerprint it got configured within /var/lib/anbox/userdata but instead it blindly accepts the certificate.

Exploiting the found issue requires access to internal components and configuration. The stream agent is running within the internal network and provides the exact API endpoint address via the /var/lib/anbox/userdata configuration file via AMS to the instance without an attacker being able to tamper the endpoint address. Anbox will not make use of the signaling endpoint unless being instructed to do so via the control API endpoint so an attacker would need to be able to have access to the internal network and hijack outgoing connections from the Anbox instance and redirect to a malicious service component. This seems unlikely and only possible after an attacker already gain access to the internal network. In case that this is being exploited Anbox will share WebRTC signaling information with the attackers endpoint allowing him to access and interact with the Anbox/Android instance.

## CVE References

* [2024-8287](/bugs/cve/2024-8287 "This CVE was automatically created fr...")

[Simon Fels (morphis)](https://launchpad.net/~morphis)
on 2024-08-21

| Changed in anbox-cloud: | |
| --- | --- |
| **status**: | New → In Progress |
| **importance**: | Undecided → High |
| **assignee**: | nobody → Simon Fels (morphis) |

[Simon Fels (morphis)](https://launchpad.net/~morphis)
on 2024-08-22

| Changed in anbox-cloud: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-08-28: |  |  | [#1](/anbox-cloud/%2Bbug/2077570/comments/1) |
| --- | --- | --- | --- |

Please refer to this issue as CVE-2024-8287.

Please refer to this issue as CVE-2024-8287.

[Simon Fels (morphis)](https://launchpad.net/~morphis)
on 2024-09-18

| Changed in anbox-cloud: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[Simon Fels (morphis)](https://launchpad.net/~morphis)
on 2024-09-18

| **information type**: | Private Security → Public Security |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/anbox-cloud/%2Bbug/2077570/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/anbox-cloud/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/anbox-cloud/%2Bbug/2077570/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/anbox-cloud/%2Bbug/2077570/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/anbox-cloud/%2Bbug/2077570/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))

