=== Content from github.com_ef85f6c6_20250111_023217.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrapi%2Fstrapi%2Fissues%2F20189)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrapi%2Fstrapi%2Fissues%2F20189)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=strapi%2Fstrapi)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[strapi](/strapi)
/
**[strapi](/strapi/strapi)**
Public

* [Notifications](/login?return_to=%2Fstrapi%2Fstrapi) You must be signed in to change notification settings
* [Fork
  8.3k](/login?return_to=%2Fstrapi%2Fstrapi)
* [Star
   64.6k](/login?return_to=%2Fstrapi%2Fstrapi)

* [Code](/strapi/strapi)
* [Issues
  822](/strapi/strapi/issues)
* [Pull requests
  80](/strapi/strapi/pulls)
* [Actions](/strapi/strapi/actions)
* [Projects
  6](/strapi/strapi/projects)
* [Security](/strapi/strapi/security)
* [Insights](/strapi/strapi/pulse)

Additional navigation options

* [Code](/strapi/strapi)
* [Issues](/strapi/strapi/issues)
* [Pull requests](/strapi/strapi/pulls)
* [Actions](/strapi/strapi/actions)
* [Projects](/strapi/strapi/projects)
* [Security](/strapi/strapi/security)
* [Insights](/strapi/strapi/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fstrapi%2Fstrapi%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fstrapi%2Fstrapi%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# NOTICE: Formidable Vulnerability is NOT valid #20189

Closed

[derrickmehaffy](/derrickmehaffy) opened this issue
Apr 23, 2024
· 1 comment

Closed

# [NOTICE: Formidable Vulnerability is NOT valid](#top) #20189

[derrickmehaffy](/derrickmehaffy) opened this issue
Apr 23, 2024
· 1 comment

Assignees
[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&v=4)](/derrickmehaffy)

Labels
[flag: notice](/strapi/strapi/labels/flag%3A%20notice)
This flag is used for announcement issues

## Comments

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=80&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)

Copy link

Member

### **[derrickmehaffy](/derrickmehaffy)** commented [Apr 23, 2024](#issue-2259885049) • edited Loading

| Since we have seen an uptick in users submitting vulnerability reports and improperly reporting the issue (in violation of our [Security Policy](https://github.com/strapi/strapi/blob/develop/SECURITY.md)) via GitHub issues I am creating this notice to add some clarification.  Several points related to this:   * Strapi is not vulnerable to this as it was always intended by Formidable that applications are responsible to properly handle file names as Formidable is a very low level library -> We do our own sanitation as it was intended * This vulnerability should have never been considered valid to begin with and was requested to removed from the MITRE/NVD databases * Snyk has already removed it as an invalid vulnerability   References:   * NVD: <https://nvd.nist.gov/vuln/detail/CVE-2022-29622> * Original issue from Formidable GH back in June 2022: [Vulnerability CVE-2022-29622 is reported by Whitesource node-formidable/formidable#856](https://github.com/node-formidable/formidable/issues/856) * Second issue from Formidable GH back in July 2022: [Filename filtering is inappropriate node-formidable/formidable#862](https://github.com/node-formidable/formidable/issues/862) * Snyk database: <https://security.snyk.io/vuln/SNYK-JS-FORMIDABLE-2838956> * Related reference from another project discussing this: [Formidable CVE jhuckaby/pixl-server-web#4](https://github.com/jhuckaby/pixl-server-web/issues/4) * Another reference from another project discussing this: [CVE-2022-29622 (High) detected in formidable-2.0.1.tgz - autoclosed opensearch-project/OpenSearch-Dashboards#1593](https://github.com/opensearch-project/OpenSearch-Dashboards/issues/1593) * Detailed breakdown of this "false" vulnerability report: <https://gitlab.com/keymandll/blog/-/blob/master/posts/03062022-Invulnerability_Analysis-CVE-2022%E2%80%9329622/index.md>  ---   At this time, we Strapi, have no plans to modify dependencies to "resolve" this vulnerability as it should be removed from the various vulnerabilities databases in due time for being invalid.  Any issues or vulnerability reports opened with regards to this package will be immediately closed and locked. If you have questions or concerns about this decision you can comment below or reach out to the Strapi Security Team via security@strapi.io. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
6
 MattieBelt, Rowan-Paul, PaulCorbeau, gacek1123, Kocal, and KiranRambha reacted with thumbs up emoji
 😕
2
 TomWebbio and briankandersen reacted with confused emoji

All reactions

* 👍
  6 reactions
* 😕
  2 reactions

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
added
the
[flag: notice](/strapi/strapi/labels/flag%3A%20notice)
This flag is used for announcement issues
label
[Apr 23, 2024](#event-12582463566)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
self-assigned this
[Apr 23, 2024](#event-12582463614)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
pinned this issue
[Apr 23, 2024](#event-12582464080)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
changed the title
~~Notice: Formidable Vulnerability is NOT valid~~
NOTICE: Formidable Vulnerability is NOT valid
[Apr 23, 2024](#event-12582470159)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
mentioned this issue
[Apr 23, 2024](#ref-issue-2258870791)

[Snip
#20181](/strapi/strapi/issues/20181)

Closed

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=80&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)

Copy link

Member

Author

### **[derrickmehaffy](/derrickmehaffy)** commented [Apr 25, 2024](#issuecomment-2078162495)

| As an update to this the GitHub advisory was revoked today as well: [GHSA-8cp3-66vr-3r4c](https://github.com/advisories/GHSA-8cp3-66vr-3r4c "GHSA-8cp3-66vr-3r4c") |
| --- |

All reactions

Sorry, something went wrong.

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
closed this as [completed](/strapi/strapi/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 23, 2024](#event-12910679825)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&u=fe2be9969e9bde73a3ce6633fb17282ec22e089a&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
unpinned this issue
[May 23, 2024](#event-12910680639)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrapi%2Fstrapi%2Fissues%2F20189)

Assignees

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&v=4)](/derrickmehaffy) [derrickmehaffy](/derrickmehaffy)

Labels

[flag: notice](/strapi/strapi/labels/flag%3A%20notice)
This flag is used for announcement issues

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=52&v=4)](/derrickmehaffy)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c3251869_20250111_023216.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F856)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F856)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=node-formidable%2Fformidable)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-formidable](/node-formidable)
/
**[formidable](/node-formidable/formidable)**
Public

* [Notifications](/login?return_to=%2Fnode-formidable%2Fformidable) You must be signed in to change notification settings
* [Fork
  681](/login?return_to=%2Fnode-formidable%2Fformidable)
* [Star
   7.1k](/login?return_to=%2Fnode-formidable%2Fformidable)

* [Code](/node-formidable/formidable)
* [Issues
  34](/node-formidable/formidable/issues)
* [Pull requests
  15](/node-formidable/formidable/pulls)
* [Discussions](/node-formidable/formidable/discussions)
* [Actions](/node-formidable/formidable/actions)
* [Security](/node-formidable/formidable/security)
* [Insights](/node-formidable/formidable/pulse)

Additional navigation options

* [Code](/node-formidable/formidable)
* [Issues](/node-formidable/formidable/issues)
* [Pull requests](/node-formidable/formidable/pulls)
* [Discussions](/node-formidable/formidable/discussions)
* [Actions](/node-formidable/formidable/actions)
* [Security](/node-formidable/formidable/security)
* [Insights](/node-formidable/formidable/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnode-formidable%2Fformidable%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnode-formidable%2Fformidable%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Vulnerability CVE-2022-29622 is reported by Whitesource #856

Closed

[johnchen05](/johnchen05) opened this issue
May 19, 2022
· 40 comments
 · Fixed by [#857](https://github.com/node-formidable/formidable/pull/857)

Closed

# [Vulnerability CVE-2022-29622 is reported by Whitesource](#top) #856

[johnchen05](/johnchen05) opened this issue
May 19, 2022
· 40 comments
 · Fixed by [#857](https://github.com/node-formidable/formidable/pull/857)

Labels
[bug](/node-formidable/formidable/labels/bug)

## Comments

[![@johnchen05](https://avatars.githubusercontent.com/u/43673963?s=80&v=4)](/johnchen05)

Copy link

### **[johnchen05](/johnchen05)** commented [May 19, 2022](#issue-1241251025)

| <https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-29622> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@johnchen05](https://avatars.githubusercontent.com/u/43673963?s=40&v=4)](/johnchen05)
[johnchen05](/johnchen05)
added
the
[bug](/node-formidable/formidable/labels/bug)
label
[May 19, 2022](#event-6639329248)

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=40&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)
[GrosSacASac](/GrosSacASac)
mentioned this issue
[May 19, 2022](#ref-pullrequest-1241546036)

[Improve keep extension
#857](/node-formidable/formidable/pull/857)
 Merged

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=40&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)
[GrosSacASac](/GrosSacASac)
closed this as [completed](/node-formidable/formidable/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#857](/node-formidable/formidable/pull/857)
[May 19, 2022](#event-6641201613)

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [May 19, 2022](#issuecomment-1131513282) • edited Loading

| Conditions to be vulnerable   * eval (user input) file name as code (for example unescaped in html) * use the keepextension option * use linux or ios (where `<>` are valid file chars) * not using the filename option , or using it without validating user input * use version 3.2.3 or earlier   Please install version 3.2.4 to have safer defaults |
| --- |

All reactions

Sorry, something went wrong.

[![@andyedwardsibm](https://avatars.githubusercontent.com/u/3276852?s=80&u=19a1f73413a7efa9fb09ee8546c96794889114fb&v=4)](/andyedwardsibm)

Copy link

### **[andyedwardsibm](/andyedwardsibm)** commented [May 19, 2022](#issuecomment-1131564601) • edited Loading

| Is there an official view of whether the v2 stream is also affected? The latest on <https://www.npmjs.com/package/formidable> right now is 2.0.1 and the advisory at [GHSA-8cp3-66vr-3r4c](https://github.com/advisories/GHSA-8cp3-66vr-3r4c "GHSA-8cp3-66vr-3r4c") has no information on the version ranges affected. Looking at [#857](https://github.com/node-formidable/formidable/pull/857) and   [formidable/src/Formidable.js](https://github.com/node-formidable/formidable/blob/48521d7c82e6c5ce4dab4014de30f1c7fd8dee91/src/Formidable.js#L527)  Line 527 in [48521d7](/node-formidable/formidable/commit/48521d7c82e6c5ce4dab4014de30f1c7fd8dee91)   |  | \_getExtension(str) { | | --- | --- |    it looks like it is |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [May 19, 2022](#issuecomment-1131949969)

| v2 has other vulnerabilities as well, thank you for reminding me to tag v3 as latest, I will do it soon |
| --- |

 👍
1
 Dipenduroy reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@krsubbar](https://avatars.githubusercontent.com/u/36066606?s=80&v=4)](/krsubbar)

Copy link

### **[krsubbar](/krsubbar)** commented [May 20, 2022](#issuecomment-1132545237)

| [@GrosSacASac](https://github.com/GrosSacASac) I still see 2.01 as the version at <https://www.npmjs.com/package/formidable> . Can we mark v3 as latest as you suggested above? |
| --- |

All reactions

Sorry, something went wrong.

[![@wxhthx](https://avatars.githubusercontent.com/u/8417961?s=80&u=c195b97e391def44ae375d296e1e0aa75a5b6b18&v=4)](/wxhthx)

Copy link

### **[wxhthx](/wxhthx)** commented [May 25, 2022](#issuecomment-1136648592) • edited Loading

| [@GrosSacASac](https://github.com/GrosSacASac) As I fond the v3.2.4 ver on npm, When can we make the v3.2.4 tag on github ? We need the github tag |
| --- |

All reactions

Sorry, something went wrong.

[![@wxhthx](https://avatars.githubusercontent.com/u/8417961?s=40&u=c195b97e391def44ae375d296e1e0aa75a5b6b18&v=4)](/wxhthx)
[wxhthx](/wxhthx)
mentioned this issue
[May 25, 2022](#ref-issue-1247369292)

[@GrosSacASac As I fond the v3.2.4 ver on npm, When can we make the v3.2.4 tag on github ? We need the github tag
#860](/node-formidable/formidable/issues/860)

Closed

[![@arikt-ms](https://avatars.githubusercontent.com/u/62397921?s=40&v=4)](/arikt-ms)
[arikt-ms](/arikt-ms)
mentioned this issue
[May 26, 2022](#ref-pullrequest-1248950477)

[Bump up the formidable package version.
microsoft/FluidFramework#10434](/microsoft/FluidFramework/pull/10434)
 Closed

8 tasks

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=80&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)

Copy link

### **[kolbma](/kolbma)** commented [May 26, 2022](#issuecomment-1138180400)

| WTF...?! [@GrosSacASac](https://github.com/GrosSacASac) Where is here the problem, when someone uploads a valid filename to the system with HTML-Tags and JS in it?  Doesn't the problem only exist in any frontend application showing filenames from the system unfiltered in any browser etc...?!  With this fix you have broken a valid usecase. Invalid filenames are only invalid if the filesystem says they are invalid and fs-module throws exceptions.  Do I miss the real problem here? |
| --- |

 👍
3
 tunnckoCore, jpage-godaddy, and pimterry reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [May 26, 2022](#issuecomment-1138491592)

| Doesn't the problem only exist in any frontend application showing filenames from the system unfiltered in any browser etc...?!  Correct.  The fix is to help people have safe default even if they blind copy paste code from stack-overflow for example.  If you want to have any filename possible, you can still do it by using the explicit filename option.  Having safe defaults is a principle I adhere to. |
| --- |

 👍
2
 wbt and tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=80&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)

Copy link

### **[kolbma](/kolbma)** commented [May 26, 2022](#issuecomment-1138531597)

| Having safe defaults is a principle I adhere to.  Hopefully you will not get the idea of filename length or special unicode might also be a problem in some of the many client applications and operating systems out there. Never ending story if you'd like to hit this on the wrong side. Did ever before came anybody to the thoughts to limit the capability of `scp`, what filenames it may accept because somebody could show a textual directory listing of the server per web application? |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [May 26, 2022](#issuecomment-1138736415)

| There was already removal of invalid characters from filename in the code since 2011-2010. If you look at the Pr you will see I only made it work 100% of the time. I did not add it. |
| --- |

All reactions

Sorry, something went wrong.

[![@znewton](https://avatars.githubusercontent.com/u/14362200?s=40&v=4)](/znewton)
[znewton](/znewton)
mentioned this issue
[May 27, 2022](#ref-pullrequest-1250239488)

[upgrade formidable to v3
microsoft/FluidFramework#10451](/microsoft/FluidFramework/pull/10451)
 Merged

8 tasks

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=80&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)

Copy link

### **[kolbma](/kolbma)** commented [May 27, 2022](#issuecomment-1139625402) • edited Loading

| There was already removal of invalid characters from filename in the code since 2011-2010. If you look at the Pr you will see I only made it work 100% of the time. I did not add it.  Sorry, didn't mean you ([@GrosSacASac](https://github.com/GrosSacASac)) with this "you". Your "Improve keep extension" is good purpose. I'm just thinking of this CVE is a joke.  But now I'm curious... I've had a fast look at   [formidable/src/Formidable.js](https://github.com/node-formidable/formidable/blob/143e473f2989f7efcd918b86a79a96a054f24bfa/src/Formidable.js#L513-L538)  Lines 513 to 538 in [143e473](/node-formidable/formidable/commit/143e473f2989f7efcd918b86a79a96a054f24bfa)   |  | \_getExtension(str) { | | --- | --- | |  | if (!str) { | |  | return ''; | |  | } | |  |  | |  | const basename = path.basename(str); | |  | const firstDot = basename.indexOf('.'); | |  | const lastDot = basename.lastIndexOf('.'); | |  | let rawExtname = path.extname(basename); | |  |  | |  | if (firstDot !== lastDot) { | |  | rawExtname = basename.slice(firstDot); | |  | } | |  |  | |  | let filtered; | |  | const firstInvalidIndex = Array.from(rawExtname).findIndex(invalidExtensionChar); | |  | if (firstInvalidIndex === -1) { | |  | filtered = rawExtname; | |  | } else { | |  | filtered = rawExtname.substring(0, firstInvalidIndex); | |  | } | |  | if (filtered === '.') { | |  | return ''; | |  | } | |  | return filtered; | |  | } |      Shouldn't the extension start with the `lastDot`?   [formidable/src/Formidable.js](https://github.com/node-formidable/formidable/blob/143e473f2989f7efcd918b86a79a96a054f24bfa/src/Formidable.js#L524)  Line 524 in [143e473](/node-formidable/formidable/commit/143e473f2989f7efcd918b86a79a96a054f24bfa)   |  | rawExtname = basename.slice(firstDot); | | --- | --- |      A filename `data-<test@example.com>.txt`. The extension is `txt` and not `com>.txt` which would become filtered to `com` (which is an executable in MS-DOS/Windows). The bug is the idea of this line...   [formidable/src/Formidable.js](https://github.com/node-formidable/formidable/blob/143e473f2989f7efcd918b86a79a96a054f24bfa/src/Formidable.js#L510)  Line 510 in [143e473](/node-formidable/formidable/commit/143e473f2989f7efcd918b86a79a96a054f24bfa)   |  | // able to get composed extension with multiple dots | | --- | --- |      OS handles files by the extension after the `lastDot`!  And *formidable* makes from a valid uploaded **txt**-file an executable **com** file, great improvement ;-) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [May 27, 2022](#issuecomment-1139648406)

| Open an issue if you think that it is a problem |
| --- |

All reactions

Sorry, something went wrong.

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=40&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)
[kolbma](/kolbma)
mentioned this issue
[May 27, 2022](#ref-issue-1250859256)

[Filename filtering is inappropriate
#862](/node-formidable/formidable/issues/862)

Closed

[![@danijeld](https://avatars.githubusercontent.com/u/10997459?s=40&v=4)](/danijeld)
[danijeld](/danijeld)
mentioned this issue
[May 27, 2022](#ref-issue-1251026575)

[[Feature]: critical vulnerability in formidable dependency
actionhero/actionhero#2197](/actionhero/actionhero/issues/2197)

Closed

1 task

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [May 30, 2022](#issuecomment-1141461966) • edited Loading

| Got here as SCA blocked the build of one of our services due to the CVE referenced earlier. I think [@kolbma](https://github.com/kolbma) is right here: [HERE](https://github.com/node-formidable/formidable/issues/856#issuecomment-1138180400) It should be OK to upload a file with a name that is supported by the file system. What someone does with the uploaded file after should be of no concern of this library.  The CVE looks to me like yet another overly eager "security professional" trying to get a CVE attached to his/her name by ignoring context and understanding of responsibilities. Then, all the other lemmings just accept it and pick it up without actually looking into the reported "issue". |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 1, 2022](#issuecomment-1144100600)

| Conditions to be vulnerable   * eval (user input) file name as code (for example unescaped in html) * use the keepextension option * use linux or ios (where `<>` are valid file chars) * not using the filename option , or using it without validating user input * use version 3.2.3 or earlier   Please install version 3.2.4 to have safer defaults  [@GrosSacASac](https://github.com/GrosSacASac) I have submitted a request to MITRE to remove the CVE assigned as some of us believe the library is not vulnerable. The MITRE guys decided that just because a contributor, it this case specifically referring to you admitted that the library is vulnerable under certain circumstances (see quoted above) they refuse the remove the CVE.  To help everyone better understand the "issue" could you please provide more context re your comments, following these questions:   1. RE: "Conditions to be vulnerable" - do you mean if these conditions are met then `formidable` is vulnerable or all these conditions are related to an application that may insecurely use `formidable`? 2. RE: "eval (user input) file name as code (for example unescaped in html)" - Are you referring to this library specifically or another application using this library that insecure may eval() the file name? (I have not seen a single line with `eval` in this library. 3. RE: "use the keepextension option" - When using this option, will it result in a vulnerability that is affecting `formidable` or you were also referring to another, insecurely implemented application that may use `formidable`? 4. RE: "use linux or ios (where `<>` are valid file chars)" - Do you consider this library being responsible for file systems supporting `<>` characters in the file name? 5. RE: "not using the filename option , or using it without validating user input" - Do you consider some users not using the `filename` option of the library a direct fault of the library? Any chance that it may be the users fault not reading the documentation?   In general, are you seriously considering this library to be vulnerable?  [@tunnckoCore](https://github.com/tunnckoCore) [@kolbma](https://github.com/kolbma) You guys may be also interested is this. |
| --- |

 😄
1
 tunnckoCore reacted with laugh emoji

All reactions

* 😄
  1 reaction

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [Jun 1, 2022](#issuecomment-1144168545)

| I'll be back in 30 days, consider the filename option if it is blocking |
| --- |

All reactions

Sorry, something went wrong.

[![@salielim](https://avatars.githubusercontent.com/u/13119163?s=80&u=b0c3174587f8c0c1291e785feb04ee55a3dd3e13&v=4)](/salielim)

Copy link

### **[salielim](/salielim)** commented [Jun 3, 2022](#issuecomment-1145475277)

| Will this vulnerability fix be backported to v2.x since v2 is still maintained? Some libraries cannot upgrade to v3 because the latest version of formidable is ESM only (e.g. [ladjs/superagent#1724](https://github.com/ladjs/superagent/pull/1724)) |
| --- |

 👍
4
 JamesIrish, stephen-risk-first, hrvojepavlinovic, and patrick330602 reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 4, 2022](#issuecomment-1146692521) • edited Loading

| I have written up my analysis of the "vulnerability" (I don't think there is a vulnerability) here if anyone is interested: [https://medium.com/@zsolt.imre/cve-2022-29622-in-vulnerability-analysis-5cf783c3721](https://medium.com/%40zsolt.imre/cve-2022-29622-in-vulnerability-analysis-5cf783c3721)  I personally could not find any indication of any of the vulnerabilities mentioned in the CVE to be present. The information disclosed by the CVE and the YT video referenced is not sufficient to prove the library is affected by the vuln. If anyone can come up with an exploit to prove there is an arbitrary code execution vulnerability **in formidable**, please share. Otherwise, I do believe the CVE is invalid. |
| --- |

 👍
5
 salielim, dennist-an, JamesIrish, hrvojepavlinovic, and alansongzoom reacted with thumbs up emoji
 ❤️
2
 tunnckoCore and jpage-godaddy reacted with heart emoji
 🚀
1
 tunnckoCore reacted with rocket emoji

All reactions

* 👍
  5 reactions
* ❤️
  2 reactions
* 🚀
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 8, 2022](#issuecomment-1150180165) • edited Loading

| Uh... 🤦‍♂️ that's continuing... [@keymandll](https://github.com/keymandll) thank you.  [@salielim](https://github.com/salielim) there's nothing to be backported in reality. the codebase between v3 and v2 is almost the same, and especially in that regard. The options are there and the documentation is there. I really don't like this `getExtension` function, but that's it for now. |
| --- |

All reactions

Sorry, something went wrong.

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
mentioned this issue
[Jun 8, 2022](#ref-issue-1242803102)

[Arbitrary File Upload in formidable versions <3.2.4
ladjs/superagent#1725](/ladjs/superagent/issues/1725)

Closed

[![@titanism](https://avatars.githubusercontent.com/u/101466223?s=80&u=c14add179bc9f13db29a7ea1d57f2ac6e0df9352&v=4)](/titanism)

Copy link

### **[titanism](/titanism)** commented [Jun 8, 2022](#issuecomment-1150286708)

| For most packages like `superagent` (and related `supertest`), an ESM/CJS version release will support the upgrade and these false vulnerability notices will go away. Thank you all for your help. 🙇 |
| --- |

 👍
3
 JamesIrish, zhongnansu, and salielim reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  3 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@titanism](https://avatars.githubusercontent.com/u/101466223?s=80&u=c14add179bc9f13db29a7ea1d57f2ac6e0df9352&v=4)](/titanism)

Copy link

### **[titanism](/titanism)** commented [Jun 8, 2022](#issuecomment-1150313641) • edited Loading

| We've reached out to some folks at Snyk to see if we can decrease the severity or remove the CVE altogether. In the interim, please ping us once you have released a new version with CJS/ESM support [@tunnckoCore](https://github.com/tunnckoCore) and [@keymandll](https://github.com/keymandll) and most of these issues should go away. Thanks! |
| --- |

 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 8, 2022](#issuecomment-1150319371)

| Yep, me and others also reached Mend to remove it, cuz it's nothing. |
| --- |

 🎉
1
 titanism reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 8, 2022](#issuecomment-1150345676)

| Check this too [https://medium.com/@zsolt.imre/cve-2022-29622-in-vulnerability-analysis-5cf783c3721](https://medium.com/%40zsolt.imre/cve-2022-29622-in-vulnerability-analysis-5cf783c3721)  I had read the article and completely agree with author's assessment that remote execution is not possible, at least not with formidable alone. The NVD remote-execution assessment and corresponding CVSS score of 9.8 appear incorrect. However, this should still be viewed as a CVSS 7.1 (High) vulnerability, although I'll admit the best exploit I can come up with right now is a Medium, I just don't have the time to do an extensive threat analysis for this. Here is my calculation: <https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N&version=3.1>  Here's my scenario to prove this is at least a Medium risk.   * We have two users, Alice and Bob. * Alice needs to upload a very important file to a website that relies on formidable and that website doesn't randomize the file name. * Alice also provides Bob with a copy of the file, or maybe Bob has also has access to it somehow. * Bob doesn't like what he sees in the file and uploads a modified copy after Alice. Since Formidable doesn't randomize the file name, Alice's file is overwritten, and no one is alerted. |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 8, 2022](#issuecomment-1150369027) • edited Loading

| @dpace-cs Interesting scenario. However, as far as I know and as far as the linked medium post goes, the default behavior is that formidable does not keep the extensions. (`keepExtensions: false`) In this default configuration, if you upload the same file twice, without changing its name, you cannot overwrite the file. These are the file names I'm getting:  ``` DEMO % ls -l ./uploads total 0 -rw-r--r--  1 keyman  staff  0  8 Jun 21:04 3f7e734605e781171150a5c00 -rw-r--r--  1 keyman  staff  0  8 Jun 21:04 3f7e734605e781171150a5c01  ```  It's definitely not randomized, its seems to be incremental.  If we try with the non-default configuration (`keepExtensions: true`), we get the following file names on the file system after having uploaded the same file multiple times:  ``` DEMO % ls -l ./uploads  total 0 -rw-r--r--  1 keyman  staff  0  8 Jun 21:10 f350d2616fc05a8b97df47700.txt.malicious.png -rw-r--r--  1 keyman  staff  0  8 Jun 21:10 f350d2616fc05a8b97df47701.txt.malicious.png -rw-r--r--  1 keyman  staff  0  8 Jun 21:10 f350d2616fc05a8b97df47702.txt.malicious.png  ```  As can be seen, the file name still has the incremnting part, threfore overwriting a previous file so far does not seem possible.  Considering how the default behavior works, the worst that can happen is someone could potentially brute-force the file names and maybe gain access to someone else's files. BUT, before anyone misunderstands, something important to note here is what @dpace-cs said: "... and that **website** doesn't randomize the file name". The developer of the website has the option to read the documentation and use the library according to his/her need/specific use case.  At the same time, if the default behaviour (`keepExtensions: false`) already produces a name that is not identical to the original file name, it could definitely generate a totally random value and then just hex string encode that. But, it does not seem to be a necessity at the moment.  What I ultimately wanted to say is, that while I like how @dpace-cs was thinking, I do not think there even a Medium risk there. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 8, 2022](#issuecomment-1150370583) • edited Loading

| @dpace-cs the last point is not correct though. By default when there's not provided `options.filename` rename function, `formidable` randomizes the names with `hexoid`.  As about second point, that's our user's (developer in our case) fault. We are not end-user service or library or whatever. Things that are building on top of open source software and libs should be 1) cautious, and 2) read docs, especially when there are docs. There's not a single package of mine for the past 8 years that has not excellent and big docs. And all these years I'm noticing exactly that - nobody reads, even with ton of documentation, concrete examples and notes.  In this default configuration, if you upload the same file twice, without changing its name, you cannot overwrite the file.  Exactly. That's good defaults. And is maximum we should and can do.  It's definitely not randomized, its seems to be incremental.  True tho, hexo is interesting one. But *IT IS* guaranteed (not cryptographically tho) random and there's minimal possibility of conflicts.  *(uh, why all this time i think of `cuid` lol, anyway)*   ---   edit: not to mention   [formidable/src/Formidable.js](https://github.com/node-formidable/formidable/blob/81dd350835e14dccca667fc46bc5c35f16f1b5ec/src/Formidable.js#L19)  Line 19 in [81dd350](/node-formidable/formidable/commit/81dd350835e14dccca667fc46bc5c35f16f1b5ec)   |  | const toHexoId = hexoid(25); | | --- | --- |      we force 25 length, while Hexo's default is 16. Quite enough to me.  Important: Your risk of collisions decreases with longer strings! |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 8, 2022](#issuecomment-1150391009) • edited Loading

| [@tunnckoCore](https://github.com/tunnckoCore) One thing to note is that hexoid produces incremental values and the first portion of the generated file name is fairly static. For example, I get the following when uploading two files, even with identical names.  ``` DEMO % ls -l ./uploads total 0 -rw-r--r--  1 keyman  staff  0  8 Jun 21:04 3f7e734605e781171150a5c00 -rw-r--r--  1 keyman  staff  0  8 Jun 21:04 3f7e734605e781171150a5c01  ```  So we have `3f7e734605e781171150a5c` part that is going to be static for a while until we reach a certain number of uploads, when the last character `c` will, I guess, turn into `d`. If a malicious actor uploads a file (just as a probe) he/she can get a significant portion of the file name. If the web app does not implement proper access control, the attacker may be able to access someone else's files. PLEASE NOTE: I'm still not blaming `formidable`. I'm blaming the developer of the fictional web app.  If I restart the service that I'm using now to do these tests of `formidable`, the file names now have a different start, such as:  ``` -rw-r--r--  1 keyman  staff  0  8 Jun 21:26 4ab0f591f75905fd411b0c901 -rw-r--r--  1 keyman  staff  0  8 Jun 21:26 4ab0f591f75905fd411b0c902  ```  So, an attacker targeting an insecurely implemented website could guess file names fairly easily between two service restarts, if the file name of his/her uploaded file is exposed.  Generating a `uuid` or `cuid` as mentioned by you instead of using `hexoid` would probably help with the above.  (I'm just praying no one going to misunderstand me and believe I'm saying there's any problem here... :) )  For now, my opinion that this "issue" worth maximum an INFO severity. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 8, 2022](#issuecomment-1150408037)

| Oh yea, perfectly agree. I probably didn't noticed that with `hexoid` back than.  Will switch to `cuid`, because i'm big fan of it since day one. |
| --- |

 👍
1
 keymandll reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 8, 2022](#issuecomment-1150409853) • edited Loading

| @dpace-cs Just realized there's something I've missed in your comment. W.r.t. the calculated CVSSv3 score, if I understand correctly, you calculated that for your example scenario, right? In that case, you have calculated that for a fictional webapp that behaves in a specific way. For example, the way we use `formidable` at our company you would not be able to calculate the same score. I'm sure you agree that any CVSS score you calculate will vary depending on specifics of the web application using the library and even in that case, it will be more about how the web app implemented file management, rather than `formidable`. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 9, 2022](#issuecomment-1151351191)

| It's definitely good that the filename is incremented and thus cannot be overwritten, and [@tunnckoCore](https://github.com/tunnckoCore) switching to cuid would eliminate an enumeration exploit (ref: <https://owasp.org/www-community/attacks/Forced_browsing>).  Outside of this issue, I have to disagree with [@tunnckoCore](https://github.com/tunnckoCore) and [@keymandll](https://github.com/keymandll) assessment of who's responsible for fixing or mitigating a vulnerability. CVSS scoring will take the rating of the highest risk vector to a vulnerability at the system's default state. If the default state allows for file enumeration you can't say it's not a vulnerability because the programmer didn't modify the default state to secure it (ref: <https://www.first.org/cvss/specification-document#3-1-Exploit-Code-Maturity-E>). That would be like Linksys saying that the default admin credentials to a router being set to admin/admin aren't a vulnerability because the user didn't read the read the manual and change it after installation. I also understand that a good webapp should prevent file enumeration via proper access controls but again, that doesn't negate the default state of the package. What keymandll is referring to would be considered a Modified Base Metric per CVSS 3.1 specifications (ref: <https://www.first.org/cvss/specification-document#4-2-Modified-Base-Metrics>). That occurs when the score would be lowered due to mitigating controls such as access control to prevent file enumeration, but the base metric would still not change, you would just have a Modified Base Metric instead.  Unrelated to this issue: I wouldn't use INFO as risk level as there is no widely accepted risk standard for the that term. LOW should always be used in the place of INFO (ref: <https://www.first.org/cvss/specification-document#Qualitative-Severity-Rating-Scale>).  None the less, thank you both for replying and deeply analyzing instead of ignoring. |
| --- |

 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151361048) • edited Loading

| @dpace-cs I completely understand what you are saying and you are not wrong, but you are not wrong in a different context. My professional opinion is that mitigating a vulnerability should be done where the vulnerability manifests itself. I do believe formidable was not vulnerable as the CVE stated, therefore I do not think it makes much sense to discuss who should be fixing something that did not exist.  What I'm trying to say, using what you have said: "If the default state allows for file enumeration" - I'm fairly certain that `formidable` does not provide an interface that would allow file enumeration. A web application may provide an interface indeed, independently of `formidable`, in which case, file enumeration *may* be possible. But, who is responsible for implementing an access control mechanism, and logical (or physical) segregation of user data? Would that be `formidable`? I don't think so. I do not think it's a good approach to force your unique use case on a general-purpose file upload library. Instead, you should implement an abstraction layer that utilizes the library the way you want to use it.  I'm noticing two things from some of the discussions I had so far (not only here):   1. For some reason people tend to confuse `formidable` with a Content Management System (CMS). What you have said would absolutely make sense and I'd agree 100% if we were talking about e.g. a content management system. 2. People confuse "attack vector" with "vulnerability"   Btw, I'm not saying `formidable` should not contribute to a defence in-depth approach. But, it should not be accused of being vulnerable to something it isn't. |
| --- |

All reactions

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 9, 2022](#issuecomment-1151363995)

| Well @dpace-cs , good point and example. I totally agree. I'm always for sane defaults and practicing it. Plus, I'm not that familiar with all the security procedures.  Thank god we are having experts. 🙏🙌 |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151379804) • edited Loading

| Alright, here is my proposal. As people so much want to force some vulnerability on `formidable`, I would be willing to make a **compromise**. Let's get rid of the original CVE as it's nonsense. We can get a new one with the following "vulnerability" description and with LOW severity (given the context):  "The way Formidable generated file names with the default configuration could have contributed to the successful exploitation of applications that were vulnerable to Forced Browsing."  What do you think @dpace-cs and [@tunnckoCore](https://github.com/tunnckoCore) ? |
| --- |

All reactions

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 9, 2022](#issuecomment-1151403075)

| Well, agree. "The default way Formidable generate filenames..."  Plus, we will patch the defaults, so.. |
| --- |

 👍
1
 keymandll reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151413098)

| I have updated my proposed "vuln" description based on [@tunnckoCore](https://github.com/tunnckoCore) 's comment. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@titanism](https://avatars.githubusercontent.com/u/101466223?s=80&u=c14add179bc9f13db29a7ea1d57f2ac6e0df9352&v=4)](/titanism)

Copy link

### **[titanism](/titanism)** commented [Jun 9, 2022](#issuecomment-1151420426)

| Make sure you email report@snyk.io when you make the updates or to request changes to the original. cc [@keymandll](https://github.com/keymandll) Thanks!!! |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151425027) • edited Loading

| Let's wait to see what @dpace-cs says about the proposed. Then, I will talk to MITRE to see if an update or a new entry would be more appropriate. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 9, 2022](#issuecomment-1151594291) • edited by ghost Loading

| I'm still having trouble seeing as how this would qualify as a Low. I'm calculating the CVSS score as 5.9 (Medium). I think it would be a big win if you could get NIST to drop the NVD score from 9.8 (Critical) to 5.9 (Medium).  Here is my reasoning:   1. Attack Vector: Should be **Network** based on the highest threat vector (i.e.. being integrated into a publicly exposed webapp). 2. Attack Complexity: Should be **High** since this would require a threat actor to be very familiar with formidable, and formidable on it's own doesn't provide access to the enumerated files. 3. Scope: Should be **Unchanged** based on <https://www.first.org/cvss/specification-document#2-2-Scope-S> 4. Integrity: Should be set to **None** since we determined files cannot be overwritten or modified. 5. Availability: Should be set to **None** since there is no proof or indication that formidable can be exploited to reduce, interrupt, or deny any component of the system. 6. Confidentiality: Should be set to **High** since the way formidable saves files could allow a threat actor to utilize a file-enumeration attack to gain full access to the file and not just the metadata. I understand that formidable is not providing that access but it is playing a role in enabling the attack. 7. User Interaction: Keep in mind that User Interaction means "This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable component." Ultimately this should be set to **None** since we are only evaluating formidable in a default state, and there is no authentication or enforced second-user interaction, etc. I'm not saying that this is Formidable's fault or anything, I'm just saying there is no mitigation for User Interaction until a developer integrates Formidable into their app and provides access control or some other mechanisms that would mitigate this. Example: I could make a website like file.io to allow anonymously file uploads, no login required. 8. Privileges Required: This is defined as "This metric describes the level of privileges an attacker must possess before successfully exploiting the vulnerability." This gets a little subjective; but if we are evaluating Formidable in a default state again, there is no mitigating control until a developer integrates Formidable into their app and provides them. I'll refer again to my file.io example.   <https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N&version=3.1>  FYI: I have no associated with MITRE or NIST and can't help you remove or reduce the existing CVE. You would need to communicate with them directly but referencing this threat would probably be very helpful to convincing them to reduce the score. |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151623805) • edited Loading

| @dpace-cs Just to confirm, are we both talking about [this](https://github.com/node-formidable/formidable/issues/856#issuecomment-1150391009)? If yes:  I **almost** agree with all your points, except with [#6](https://github.com/node-formidable/formidable/issues/6) (Confidentiality). I just do not see how you can calculate these for `formidable`, because all these depend on how an application using `formidable` is implemented. What I'm trying to say is that **it's contextually inappropriate** to have this calculation in the first place. Below is my reasoning.  Formidable does not dictate how an application should implement file management. It is possible to implement an application that even with `formidable`'s default behaviour an attacker would not be able to access any files. For example, what about the simplest scenario where you can upload files but you can never download them? (That's exactly our scenario, we are also a user of `formidable`) So, your 5.9 (Medium) is a 2.2 (Low) at best according to CVSS in our specific use case.  So, given your calculation and mine, if I subtract 2.2 from 5.9, the resulting **3.7** is all up to the specifics and use cases supported by the application. Why would you blame that **3.7** on `formidable`? |
| --- |

 ❤️
2
 tunnckoCore and jpage-godaddy reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=80&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)

Copy link

### **[kolbma](/kolbma)** commented [Jun 9, 2022](#issuecomment-1151667544)

| Ridiculous. Do you know the other victims of Whitesource they have used for their published self-marketing study? |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji
 😄
1
 tunnckoCore reacted with laugh emoji

All reactions

* 👍
  1 reaction
* 😄
  1 reaction

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151674396)

| [@kolbma](https://github.com/kolbma) As far as I know Whitesource is not directly responsible of this mess. I suspect, in this case it is most likely that their "vulnerability" scanner, just like all the others picked up the same nonesense from NVD. So now we have all these software composition analysis tools spitting out issue reports based on the CVE. Probably it just happened that [@johnchen05](https://github.com/johnchen05), probably a user/customer of Whitesource got a report from their tool...  However, your second sentence sounds like there is an interesting story out there I have not heard of. Most likely this is not the right forum to share, so If you write it up somewhere, let me know, happy to read it. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 9, 2022](#issuecomment-1151698972) • edited Loading

| You're amazing guys! Seems like you know your job.  But I think it would be far more easier, faster and better to just upgrade on [#857](https://github.com/node-formidable/formidable/pull/857) merged pr and my comments from there. I don't think we need to talk to them or disputing it, downgrading, dropping it, or opening a new one. It happened, let it go.  Or I'm just tired and not that familiar and interested in such things. What I can do is to try to patch it by the end of the week, and and add some more automation on the repo, plus CodeQL GH Action for the future. All that was part of the [#635](https://github.com/node-formidable/formidable/issues/635) and [#830](https://github.com/node-formidable/formidable/issues/830) anyway. I even think to skip v3, hahahaha. Joking.  Thanks, and don't think it or worry that much. :P |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 9, 2022](#issuecomment-1151703130) • edited Loading

| [@tunnckoCore](https://github.com/tunnckoCore) Sure, I completely understand. Indeed, there's no need for a new CVE. If you replace `hexoid` with `cuid` all is going to be good. Also, it wasn't your fight anyways, it was mine, so I'm just going to take it somewhere else. :)  Anyway, it was great having this discussion with all of you. Feel free to reach out to me if I can be of any help in the future.  Oh, and before I forget thanks a lot to all contributors for this amazing library. |
| --- |

 👍
1
 tunnckoCore reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=40&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)
[tunnckoCore](/tunnckoCore)
mentioned this issue
[Jun 14, 2022](#ref-issue-1270912921)

[npm module formidable@2.0.1 marked as latest
#865](/node-formidable/formidable/issues/865)

Closed

[![@zhongnansu](https://avatars.githubusercontent.com/u/32652829?s=40&v=4)](/zhongnansu)
[zhongnansu](/zhongnansu)
mentioned this issue
[Nov 16, 2022](#ref-issue-1239108480)

[CVE-2022-29622 (High) detected in formidable-2.0.1.tgz - autoclosed
opensearch-project/OpenSearch-Dashboards#1593](/opensearch-project/OpenSearch-Dashboards/issues/1593)

Closed

[![@jhuckaby](https://avatars.githubusercontent.com/u/700765?s=40&v=4)](/jhuckaby)
[jhuckaby](/jhuckaby)
mentioned this issue
[Apr 23, 2024](#ref-issue-2257761112)

[Formidable CVE
jhuckaby/pixl-server-web#4](/jhuckaby/pixl-server-web/issues/4)

Closed

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259885049)

[NOTICE: Formidable Vulnerability is NOT valid
strapi/strapi#20189](/strapi/strapi/issues/20189)

Closed

[![@worc](https://avatars.githubusercontent.com/u/5589725?s=40&v=4)](/worc)
[worc](/worc)
mentioned this issue
[Apr 25, 2024](#ref-issue-2262195077)

[Critical vulnerability - Formidable arbitrary file upload
newrelic/node-newrelic#2167](/newrelic/node-newrelic/issues/2167)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F856)

Assignees

No one assigned

Labels

[bug](/node-formidable/formidable/labels/bug)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Improve keep extension](/node-formidable/formidable/pull/857)
 [node-formidable/formidable](/node-formidable/formidable)

10 participants

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=52&v=4)](/keymandll) [![@andyedwardsibm](https://avatars.githubusercontent.com/u/3276852?s=52&v=4)](/andyedwardsibm) [![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=52&v=4)](/tunnckoCore) [![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=52&v=4)](/kolbma) [![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=52&v=4)](/GrosSacASac) [![@wxhthx](https://avatars.githubusercontent.com/u/8417961?s=52&v=4)](/wxhthx) [![@salielim](https://avatars.githubusercontent.com/u/13119163?s=52&v=4)](/salielim) [![@krsubbar](https://avatars.githubusercontent.com/u/36066606?s=52&v=4)](/krsubbar) [![@johnchen05](https://avatars.githubusercontent.com/u/43673963?s=52&v=4)](/johnchen05) [![@titanism](https://avatars.githubusercontent.com/u/101466223?s=52&v=4)](/titanism)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_284faa6e_20250111_023217.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F862)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F862)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=node-formidable%2Fformidable)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-formidable](/node-formidable)
/
**[formidable](/node-formidable/formidable)**
Public

* [Notifications](/login?return_to=%2Fnode-formidable%2Fformidable) You must be signed in to change notification settings
* [Fork
  681](/login?return_to=%2Fnode-formidable%2Fformidable)
* [Star
   7.1k](/login?return_to=%2Fnode-formidable%2Fformidable)

* [Code](/node-formidable/formidable)
* [Issues
  34](/node-formidable/formidable/issues)
* [Pull requests
  15](/node-formidable/formidable/pulls)
* [Discussions](/node-formidable/formidable/discussions)
* [Actions](/node-formidable/formidable/actions)
* [Security](/node-formidable/formidable/security)
* [Insights](/node-formidable/formidable/pulse)

Additional navigation options

* [Code](/node-formidable/formidable)
* [Issues](/node-formidable/formidable/issues)
* [Pull requests](/node-formidable/formidable/pulls)
* [Discussions](/node-formidable/formidable/discussions)
* [Actions](/node-formidable/formidable/actions)
* [Security](/node-formidable/formidable/security)
* [Insights](/node-formidable/formidable/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnode-formidable%2Fformidable%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnode-formidable%2Fformidable%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Filename filtering is inappropriate #862

Closed

[kolbma](/kolbma) opened this issue
May 27, 2022
· 7 comments

Closed

# [Filename filtering is inappropriate](#top) #862

[kolbma](/kolbma) opened this issue
May 27, 2022
· 7 comments

## Comments

[![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=80&u=1c2449d8de936a764652e7c3b10dbc9584ff10a5&v=4)](/kolbma)

Copy link

### **[kolbma](/kolbma)** commented [May 27, 2022](#issue-1250859256)

| I came across your filename handling and filtering with the [CVE-2022-29622](https://github.com/advisories/GHSA-8cp3-66vr-3r4c "CVE-2022-29622") and this issue [#856 (comment)](https://github.com/node-formidable/formidable/issues/856#issuecomment-1139648406)\_  First you got blamed also inappropriate by this [CVE-2022-29622](https://github.com/advisories/GHSA-8cp3-66vr-3r4c "CVE-2022-29622") whoever is responsible for publishing this without correct approval. Filenames of forms can have html-tags and js-like-text, like any other form inputs and it is the responsibility of the lib user to handle this, because only he/she knows where this filename is used and what is a safety risc. All this filtering and replacement makes it worse, because the original filename of upload gets lost.  Why I've opened this issue: Now your current code of **formidable** has some filename filtering which is **dysfunctional**.  This is an example you can put in e.g. <https://replit.com/languages/nodejs> The code is from your current master <https://github.com/node-formidable/formidable/blob/master/src/Formidable.js> and I've added some asserts to show the problem.  ``` const assert = require('assert'); const path = require('path');  const invalidExtensionChar = (c) => {   const code = c.charCodeAt(0);   return !(     code === 46 || // .     (code >= 48 && code <= 57) ||     (code >= 65 && code <= 90) ||     (code >= 97 && code <= 122)   ); };  function _getFileName(headerValue) {   // matches either a quoted-string or a token (RFC 2616 section 19.5.1)   const m = headerValue.match(     /\bfilename=("(.*?)"|([^()<>{}[\]@,;:"?=\s/\t]+))($|;\s)/i,   );   if (!m) return null;    const match = m[2] || m[3] || '';   let originalFilename = match.substr(match.lastIndexOf('\\') + 1);   originalFilename = originalFilename.replace(/%22/g, '"');   originalFilename = originalFilename.replace(/&#([\d]{4});/g, (_, code) =>     String.fromCharCode(code),   );    return originalFilename; }  // able to get composed extension with multiple dots // "a.b.c" -> ".b.c" // as opposed to path.extname -> ".c" function _getExtension(str) {   if (!str) {     return '';   }    const basename = path.basename(str);   const firstDot = basename.indexOf('.');   const lastDot = basename.lastIndexOf('.');   let rawExtname = path.extname(basename);    assert(rawExtname === '.txt'); // node knows how to do it    if (firstDot !== lastDot) {     rawExtname =  basename.slice(firstDot);   }    let filtered;   const firstInvalidIndex = Array.from(rawExtname).findIndex(invalidExtensionChar);   if (firstInvalidIndex === -1) {     filtered = rawExtname;   } else {     filtered = rawExtname.substring(0, firstInvalidIndex);   }   if (filtered === '.') {     return '';   }   return filtered; }  let headerValue = 'filename="data-<test@example.com>.txt"'; let filename = _getFileName(headerValue); let ext = _getExtension(filename);  assert(ext !== '.com', 'wrong extension .com !== .txt: dangerous executable');  assert(ext === '.txt'); // all would be fine ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
2
 tunnckoCore and OZZlE reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  2 reactions
* ❤️
  1 reaction

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [May 31, 2022](#issuecomment-1141756666)

| Got here as SCA blocked the build of one of our services due to the CVE referenced earlier. I think [@kolbma](https://github.com/kolbma) is right here: [#856 (comment)](https://github.com/node-formidable/formidable/issues/856#issuecomment-1138180400) It should be OK to upload a file with a name that is supported by the file system. What someone does with the uploaded file after should be of no concern of this library.  I've reached out to both NVD and MEND asking them to look into this and hopefully get the CVE removed as the vulnerability report is literally a joke. The YouTube video attached as proof to the CVE only proves that the person who submitted the vulnerability report is incompetent and that NVD has a serious quality control issue when it comes to vulnerability submissions. |
| --- |

 ❤️
4
 tunnckoCore, rgmz, ajmeese7, and jpage-godaddy reacted with heart emoji

All reactions

* ❤️
  4 reactions

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [May 31, 2022](#issuecomment-1142376310)

| Thanks for the support [@kolbma](https://github.com/kolbma) [@keymandll](https://github.com/keymandll), I think in the very same way.  I just got email from Daniel from Mend, and responded with the same narrative. We are low-level library and we intentionally do it that way, but provide extensions and options. It's a developer's job to ensure that better. We are not end-user service or whatever. |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jun 1, 2022](#issuecomment-1144118206)

| No worries [@tunnckoCore](https://github.com/tunnckoCore) . Great news and big respect to Daniel from Mend for reaching out to you.  I'm still trying to explain to MITRE that the vuln report is false and on MITRE's end there's been a serious misunderstanding re [@GrosSacASac](https://github.com/GrosSacASac) 's comment:  [#856 (comment)](https://github.com/node-formidable/formidable/issues/856#issuecomment-1144100600) |
| --- |

 👍
2
 tunnckoCore and jpage-godaddy reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=40&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)
[tunnckoCore](/tunnckoCore)
mentioned this issue
[Jun 14, 2022](#ref-issue-1270912921)

[npm module formidable@2.0.1 marked as latest
#865](/node-formidable/formidable/issues/865)

Closed

[![@ShawnLee2018](https://avatars.githubusercontent.com/u/39329569?s=80&u=2e4326194dba90644360e78b5a55e26dc6e674b4&v=4)](/ShawnLee2018)

Copy link

### **[ShawnLee2018](/ShawnLee2018)** commented [Jun 29, 2022](#issuecomment-1169656594) • edited Loading

| `keepExtensions: true` When I upload a file with named "file\_1.0.10000.0-1\_amd64.deb", it is rename to "3200c4254bbdc91f8e8458b01.0.10000.0". I think "3200c4254bbdc91f8e8458b01.deb" should be the correct name. |
| --- |

All reactions

Sorry, something went wrong.

[![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=80&u=e42c0a921f9da47a2ce9703899d8cc913d12b84b&v=4)](/tunnckoCore)

Copy link

Member

### **[tunnckoCore](/tunnckoCore)** commented [Jun 29, 2022](#issuecomment-1169799131)

| [@ShawnLee2018](https://github.com/ShawnLee2018) updates are near.  Use `options.filename: Function` for now. |
| --- |

All reactions

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=80&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)

Copy link

Contributor

### **[GrosSacASac](/GrosSacASac)** commented [Jul 13, 2022](#issuecomment-1183374186)

| What is SCA ?  The code from before already removed some characters from the file extension. But not always. So it was inconsistent. The new code cuts the file extension at the first invalid character (invalid in a file extension).  The characters that are considered invalid inside a file extension are all except the . numbers and a-Z.  Do you want to change that ? Yes/No ?  We can also change the algorithm to filter invalid characters instead of cutting off at the first invalid. Yes/No ? I believe [@ShawnLee2018](https://github.com/ShawnLee2018) that's what you want. |
| --- |

All reactions

Sorry, something went wrong.

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=80&u=fb03d1f7a3da5780012bd785a658e676d0fe8748&v=4)](/keymandll)

Copy link

### **[keymandll](/keymandll)** commented [Jul 20, 2022](#issuecomment-1190300383)

| [@GrosSacASac](https://github.com/GrosSacASac) Never mind. I'm perfectly happy now due to the [security analysis](https://medium.com/%40zsolt.imre/cve-2022-29622-in-vulnerability-analysis-5cf783c3721) I performed the industry slowly [started realising](https://security.snyk.io/vuln/SNYK-JS-FORMIDABLE-2838956) that Formidable was not vulnerable in the first place.  (SCA is Software Composition Analysis.) |
| --- |

 👍
2
 tunnckoCore and ajmeese7 reacted with thumbs up emoji
 ❤️
1
 tunnckoCore reacted with heart emoji

All reactions

* 👍
  2 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=40&u=92d772a85f0f3ecd75b4f933fe3bd0b12a80a68b&v=4)](/GrosSacASac)
[GrosSacASac](/GrosSacASac)
closed this as [completed](/node-formidable/formidable/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Oct 4, 2022](#event-7517072503)

[![@derrickmehaffy](https://avatars.githubusercontent.com/u/8593673?s=40&v=4)](/derrickmehaffy)
[derrickmehaffy](/derrickmehaffy)
mentioned this issue
[Apr 23, 2024](#ref-issue-2259885049)

[NOTICE: Formidable Vulnerability is NOT valid
strapi/strapi#20189](/strapi/strapi/issues/20189)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-formidable%2Fformidable%2Fissues%2F862)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@keymandll](https://avatars.githubusercontent.com/u/2221309?s=52&v=4)](/keymandll) [![@tunnckoCore](https://avatars.githubusercontent.com/u/5038030?s=52&v=4)](/tunnckoCore) [![@kolbma](https://avatars.githubusercontent.com/u/5228369?s=52&v=4)](/kolbma) [![@GrosSacASac](https://avatars.githubusercontent.com/u/5721194?s=52&v=4)](/GrosSacASac) [![@ShawnLee2018](https://avatars.githubusercontent.com/u/39329569?s=52&v=4)](/ShawnLee2018)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.youtube.com_b8119acb_20250111_023218.html ===
[About](https://www.youtube.com/about/)[Press](https://www.youtube.com/about/press/)[Copyright](https://www.youtube.com/about/copyright/)[Contact us](/t/contact_us/)[Creators](https://www.youtube.com/creators/)[Advertise](https://www.youtube.com/ads/)[Developers](https://developers.google.com/youtube)[Terms](/t/terms)[Privacy](/t/privacy)[Policy & Safety](https://www.youtube.com/about/policies/)[How YouTube works](https://www.youtube.com/howyoutubeworks?utm_campaign=ytgen&utm_source=ythp&utm_medium=LeftNav&utm_content=txt&u=https%3A%2F%2Fwww.youtube.com%2Fhowyoutubeworks%3Futm_source%3Dythp%26utm_medium%3DLeftNav%26utm_campaign%3Dytgen)[Test new features](/new)© 2025 Google LLC
