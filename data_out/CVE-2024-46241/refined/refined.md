Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The root cause is the lack of proper sanitization of user-supplied input in the `pname` parameter within the `/add-product.php` and `/edit-product.php` files of the Dairy Farm Shop Management System.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS) vulnerability. The application does not sanitize the `pname` parameter, allowing an attacker to inject arbitrary JavaScript code.

**Impact of Exploitation:**
- Compromise of user data.
- Hijacking of user accounts.
- Potential installation of malware on the host machine.

**Attack Vectors:**
- An attacker injects malicious JavaScript code into the `pname` field via the `/add-product.php` or `/edit-product.php` forms.
- The malicious script is then stored in the application's database.
- When a user views the product list, the stored script is executed in their browser, potentially leading to various malicious activities.

**Required Attacker Capabilities/Position:**
- The attacker needs to have the ability to add or edit products within the Dairy Farm Shop Management System. This typically requires an authenticated user account with sufficient permissions.
- No specific network position is required; the attacker can perform this remotely as long as they have access to the application.