
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flirantal%2Fdaloradius%2Fcommit%2F3d11f375a76ddb3741200296e15f81d82dfb80ce)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flirantal%2Fdaloradius%2Fcommit%2F3d11f375a76ddb3741200296e15f81d82dfb80ce)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lirantal%2Fdaloradius)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lirantal](/lirantal)
/
**[daloradius](/lirantal/daloradius)**
Public

* [Notifications](/login?return_to=%2Flirantal%2Fdaloradius) You must be signed in to change notification settings
* [Fork
  349](/login?return_to=%2Flirantal%2Fdaloradius)
* [Star
   703](/login?return_to=%2Flirantal%2Fdaloradius)

* [Code](/lirantal/daloradius)
* [Issues
  68](/lirantal/daloradius/issues)
* [Pull requests
  0](/lirantal/daloradius/pulls)
* [Actions](/lirantal/daloradius/actions)
* [Projects
  0](/lirantal/daloradius/projects)
* [Wiki](/lirantal/daloradius/wiki)
* [Security](/lirantal/daloradius/security)
* [Insights](/lirantal/daloradius/pulse)

Additional navigation options

* [Code](/lirantal/daloradius)
* [Issues](/lirantal/daloradius/issues)
* [Pull requests](/lirantal/daloradius/pulls)
* [Actions](/lirantal/daloradius/actions)
* [Projects](/lirantal/daloradius/projects)
* [Wiki](/lirantal/daloradius/wiki)
* [Security](/lirantal/daloradius/security)
* [Insights](/lirantal/daloradius/pulse)

## Commit

[Permalink](/lirantal/daloradius/commit/3d11f375a76ddb3741200296e15f81d82dfb80ce)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: introduced security fixes ([#263](https://github.com/lirantal/daloradius/pull/263))

[Browse files](/lirantal/daloradius/tree/3d11f375a76ddb3741200296e15f81d82dfb80ce)
Browse the repository at this point in the history

```
- dologin.php - validating user input and introduced CSRF token check
- logging.php - preventing direct access to this file, which means redirecting to index.php when directly hitting this include file, (repeated for other exten. / include / etc. files), and optimized logging features
- actionMessages.php and errorHandling.php same as logging.php
- library/exten-* files - preventing direct access to these files, generalized the approach of looking for known file locations, improved user input validation (params such as limit, etc.), improved output (escaping logfile output, etc.)
- in library/exten-server_info.php - i also have added new commands for retrieving network information and system distro/version
- opendb.php - general code optimization (TODO prevent direct access to this file)
- sessions.php - introduced new session handling (TODO prevent direct access to this file)
- login.php - removed the default username hardcoded in the form, added the csrf_token
- rep-* - user input validation, code optimization
```

* Loading branch information

[![@filippolauria](https://avatars.githubusercontent.com/u/4223503?s=40&v=4)](/filippolauria)

[filippolauria](/lirantal/daloradius/commits?author=filippolauria "View all commits by filippolauria")
authored
Oct 12, 2022

1 parent
[765fb6a](/lirantal/daloradius/commit/765fb6aff8505cd014e24e1591f84c3cf9a2573c)

commit 3d11f37

 Show file tree

 Hide file tree

Showing
**21 changed files**
with
**1,141 additions**
and
**1,125 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include

  + config

    - include/config/logging.php
      [logging.php](#diff-40ec8eaf6861f247c9230ddf51b12a288352daf9a69a90da45e451b01745cb66)
  + management

    - include/management/actionMessages.php
      [actionMessages.php](#diff-3b24636889a279f1a021b6c9c6ced44fff2d1fe6bebeebc6cce43bc74b256f86)
* library

  + library/errorHandling.php
    [errorHandling.php](#diff-598fb49d941607428446d1a66aa95baa0a7e3e1004c939640e89922bd40937e3)
  + library/exten-boot\_log.php
    [exten-boot\_log.php](#diff-88057586d5cc0ada7ca62a748d5794f7e7a922bf6157322e54d6a14143850a80)
  + library/exten-daloradius\_log.php
    [exten-daloradius\_log.php](#diff-cd245bc02cad58cf2546c38ef00c31ac7c8c690cd524e0d9d474e1f63e799c30)
  + library/exten-maint-radclient.php
    [exten-maint-radclient.php](#diff-723029214535d4ea3084c2c8c157bdb684f7ec9ea4ee60c71c050460d2c90b63)
  + library/exten-radius\_log.php
    [exten-radius\_log.php](#diff-49fe45fd1bf7917d19f656f126ab4d9189e163fb3b751c6a769dbd10f83cf8d5)
  + library/exten-radius\_server\_info.php
    [exten-radius\_server\_info.php](#diff-a3aba38c599b4303d9df06d7c2b8c31d8564c12541365a2ad79346ee79935904)
  + library/exten-server\_info.php
    [exten-server\_info.php](#diff-70470acfe6f3487fc2e87423d5a74ed532555180d2af4f0843c4ba9473f51916)
  + library/exten-syslog\_log.php
    [exten-syslog\_log.php](#diff-3b5a7d46c4d63c2cc43074dedb57b201b6c2ce012ace26cd2a8c798222334c13)
  + library/exten-welcome\_page.php
    [exten-welcome\_page.php](#diff-903ccc8b1fede8ae218556fdb7319fa44d43049a21dbce4243c8e26c562a451c)
* rep-logs-boot.php
  [rep-logs-boot.php](#diff-cbf11f64b17c2948102cce56409a1c33abe406c533ac85515d6746e945be206e)
* rep-logs-daloradius.php
  [rep-logs-daloradius.php](#diff-2ef83e4f556a95bf3326e3cf00a021b7da825af9e9d9008e7f7cb58f9ebe8003)
* rep-logs-radius.php
  [rep-logs-radius.php](#diff-01595aeb278968f3a0aa92a7fe1c14fd3e18345ddfbd0d649fe260ed474b1247)
* rep-logs-system.php
  [rep-logs-system.php](#diff-12ad1c0c178108498e565c9eebf91cffe32a1d7a39f24c730f11992c83944533)
* rep-logs.php
  [rep-logs.php](#diff-0664e9ad8bd40caec69f07bc2e5d575ff6c6b3e5f76c175d5403fd247ebb1b02)
* rep-stat-cron.php
  [rep-stat-cron.php](#diff-e779cd5649ef48bbd851f2a41a5464b93cf187944f4386dc4ce7ca1aff47d4bf)
* rep-stat-raid.php
  [rep-stat-raid.php](#diff-912c9317a31e02ea23fb0efb371bed5bf6c9d46aaba30120c30cd0a539d50b2b)
* rep-stat-server.php
  [rep-stat-server.php](#diff-0902c59b65160c685c551c6d908ef0db292e42cdd5acd71363fa6ae0d8bb050d)
* rep-stat-services.php
  [rep-stat-services.php](#diff-6ceeeb86be9f77a8be9572496ad9ad50ae43fac6e484bb1baa0ef9cc39c44f47)
* rep-stat-ups.php
  [rep-stat-ups.php](#diff-285f4f3f9ab362d75e4c6cee51a1b54fc1647a1ec4a9f1c6b0dd47a74cb08a2e)

## There are no files selected for viewing

173 changes: 91 additions & 82 deletions

173
[include/config/logging.php](#diff-40ec8eaf6861f247c9230ddf51b12a288352daf9a69a90da45e451b01745cb66 "include/config/logging.php")

Show comments

[View file](/lirantal/daloradius/blob/3d11f375a76ddb3741200296e15f81d82dfb80ce/include/config/logging.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,107 +1,116 @@ |
|  |  | <?php |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: logging.php |
|  |  | \* Author: Liran tal <liran.tal@gmail.com> |
|  |  | \* |
|  |  | \* This file is used for controlling the logging actions |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  |  |
|  |  |  |
|  |  | /\* |
|  |  | \* It is important to understand that when logging.php is included in |
|  |  | \* a page AFTER an include for config\_read.php it gains access to all |
|  |  | \* of the variables it's scope including the $configValues[....] because |
|  |  | \* it was included just before it. |
|  |  | \* |
|  |  | \* But it should be noticed that these variables are only accessible |
|  |  | \* in the scope of the general or main block of php code and are |
|  |  | \* not accessible from functions, so we can't just use $configValues[...] |
|  |  | \* variables from within logMessageNotice() or any other function |
|  |  | \* and so we must use them here as references. |
|  |  | \* |
|  |  | \* The relevant variables are: |
|  |  | \* |
|  |  | \* $operator |
|  |  | \* $\_SERVER["SCRIPT\_NAME"] |
|  |  | \* $configValues['CONFIG\_LOG\_FILE'] |
|  |  | \* |
|  |  | \*/ |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* daloRADIUS - RADIUS Web Platform |
|  |  | \* Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved. |
|  |  | \* |
|  |  | \* This program is free software; you can redistribute it and/or |
|  |  | \* modify it under the terms of the GNU General Public License |
|  |  | \* as published by the Free Software Foundation; either version 2 |
|  |  | \* of the License, or (at your option) any later version. |
|  |  | \* |
|  |  | \* You should have received a copy of the GNU General Public License |
|  |  | \* along with this program; if not, write to the Free Software |
|  |  | \* Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Description: This file is used for controlling the logging actions |
|  |  | \* |
|  |  | \* Authors: Liran Tal <liran@enginx.com> |
|  |  | \* Filippo Lauria <filippo.lauria@iit.cnr.it> |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \*/ |
|  |  |  |
|  |  | if ($configValues['CONFIG\_LOG\_PAGES'] == "yes") { |
|  |  | if (isset($log)) { |
|  |  | $msgNotice = $operator . " " . $log; |
|  |  | logMessage("NOTICE", $msgNotice, $configValues['CONFIG\_LOG\_FILE'], $\_SERVER["SCRIPT\_NAME"]); |
|  |  | } |
|  |  | // prevent this file to be directly accessed |
|  |  | if (strpos($\_SERVER['PHP\_SELF'], '/include/config/logging.php') !== false) { |
|  |  | header("Location: ../../index.php"); |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* It is important to understand that when logging.php is included in |
|  |  | \* a page AFTER an include for config\_read.php it gains access to all |
|  |  | \* of the variables it's scope including the $configValues[....] because |
|  |  | \* it was included just before it. |
|  |  | \* |
|  |  | \* But it should be noticed that these variables are only accessible |
|  |  | \* in the scope of the general or main block of php code and are |
|  |  | \* not accessible from functions, so we can't just use $configValues[...] |
|  |  | \* variables from within logMessageNotice() or any other function |
|  |  | \* and so we must use them here as references. |
|  |  | \* |
|  |  | \* The relevant variables are: |
|  |  | \* |
|  |  | \* $operator |
|  |  | \* $\_SERVER["SCRIPT\_NAME"] |
|  |  | \* $configValues['CONFIG\_LOG\_FILE'] |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | /\* |
|  |  | \* @param $type The message type, for example, NOTICE, DEBUG, ERROR, ACTION, etc... |
|  |  | \* @param $msg The message string which should be logged to the file |
|  |  | \* @param $logFile The full path for the filename to write logs to |
|  |  | \* @param $currPage The current page that we included from |
|  |  | \* @return $table The table name, either radcheck or radreply |
|  |  | \*/ |
|  |  | function logMessage($type, $msg, $logFile, $currPage) { |
|  |  | $date = date('M d G:i:s'); |
|  |  | $msgString = $date . " " . $type . " " . $msg . " " . $currPage; |
|  |  |  |
|  |  | if ($configValues['CONFIG\_LOG\_QUERIES'] == "yes") { |
|  |  | if (isset($logQuery)) { |
|  |  | $msgQuery = $operator . " " . $logQuery; |
|  |  | logMessage("QUERY", $msgQuery, $configValues['CONFIG\_LOG\_FILE'], $\_SERVER["SCRIPT\_NAME"]); |
|  |  | } |
|  |  | $fp = fopen($logFile, "a"); |
|  |  | if ($fp) { |
|  |  | fwrite($fp, $msgString . "\n"); |
|  |  | fclose($fp); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | echo "<div>" |
|  |  | . '<span style="color: red">error: could not open the file for writing: <strong>' |
|  |  | . $logFile . "</strong></span><br>" |
|  |  | . "Check file permissions. The file should be writable by the webserver's user/group" |
|  |  | . "</div>"; |
|  |  | } |
|  |  |  |
|  |  | $logger\_work = array(); |
|  |  |  |
|  |  | if ($configValues['CONFIG\_LOG\_PAGES'] == "yes" && isset($log) && !empty($log)) { |
|  |  | $logger\_work['NOTICE'] = "$operator $log"; |
|  |  | } |
|  |  |  |
|  |  | if ($configValues['CONFIG\_LOG\_ACTIONS'] == "yes") { |
|  |  | if (isset($logAction)) { |
|  |  | $msgAction = $operator . " " . $logAction; |
|  |  | logMessage("ACTION", $msgAction, $configValues['CONFIG\_LOG\_FILE'], $\_SERVER["SCRIPT\_NAME"]); |
|  |  | } |
|  |  | if ($configValues['CONFIG\_LOG\_QUERIES'] == "yes" && isset($logQuery) && !empty($logQuery)) { |
|  |  | $logger\_work['QUERIES'] = "$operator $logQuery"; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | if ($configValues['CONFIG\_LOG\_ACTIONS'] == "yes" && isset($logAction) && !empty($logAction)) { |
|  |  | $logger\_work['ACTIONS'] = "$operator $logAction"; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* evaluating whether we need to debug SQL queries to the database as well. |
|  |  | \* $logDebugSQL is set for each $sql = "query statement..." on the actual page |
|  |  | \* in the following form: $logDebugSQL += $sql . "\n"; |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | if ($configValues['CONFIG\_DEBUG\_SQL'] == "yes") { |
|  |  | if (isset($logDebugSQL)) { |
|  |  | $msgDebugSQL = "- SQL -" . " " . $logDebugSQL . " on page: "; |
|  |  | logMessage("DEBUG", $msgDebugSQL, $configValues['CONFIG\_LOG\_FILE'], $\_SERVER["SCRIPT\_NAME"]); |
|  |  | } |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \*/ |
|  |  | if ($configValues['CONFIG\_DEBUG\_SQL'] == "yes" && isset($logDebugSQL) && !empty($logDebugSQL)) { |
|  |  | $logger\_work['DEBUG'] = "- SQL -" . " " . $logDebugSQL . " on page: "; |
|  |  | } |
|  |  |  |
|  |  | /\* the continuation of the CONFIG\_DEBUG\_SQL actually, this prints to the page |
|  |  | \* being viewed \*/ |
|  |  | if ($configValues['CONFIG\_DEBUG\_SQL\_ONPAGE'] == "yes") { |
|  |  | if (isset($logDebugSQL)) { |
|  |  | echo "<br/><br/>"; |
|  |  | echo "Debugging SQL Queries: <br/>"; |
|  |  | echo $logDebugSQL; |
|  |  | echo "<br/><br/>"; |
|  |  | } |
|  |  | foreach ($logger\_work as $type => $message) { |
|  |  | logMessage($type, $message, $configValues['CONFIG\_LOG\_FILE'], $\_SERVER["SCRIPT\_NAME"]); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | function logMessage($type, $msg, $logFile, $currPage) { |
|  |  | /\* |
|  |  | \* @param $type The message type, for example, NOTICE, DEBUG, ERROR, ACTION, etc... |
|  |  | \* @param $msg The message string which should be logged to the file |
|  |  | \* @param $logFile The full path for the filename to write logs to |
|  |  | \* @param $currPage The current page that we included from |
|  |  | \* @return $table The table name, either radcheck or radreply |
|  |  | \*/ |
|  |  |  |
|  |  | $date = date('M d G:i:s'); |
|  |  | $msgString = $date . " " . $type . " " . $msg . " " . $currPage; |
|  |  |  |
|  |  | $fp = fopen($logFile, "a"); |
|  |  | if ($fp) { |
|  |  | fwrite($fp, $msgString . "\n"); |
|  |  | fclose($fp); |
|  |  | } else { |
|  |  |  |
|  |  | echo "<font color='#FF0000'>error: could not open the file for writing:<b> $logFile </b><br/></font>"; |
|  |  | echo "Check file permissions. The file should be writable by the webserver's user/group<br/>"; |
|  |  | } |
|  |  |  |
|  |  | /\* the continuation of the CONFIG\_DEBUG\_SQL actually, this prints to the page |
|  |  | \* being viewed \*/ |
|  |  | if ($configValues['CONFIG\_DEBUG\_SQL\_ONPAGE'] == "yes" && isset($logDebugSQL) && !empty($logDebugSQL)) { |
|  |  | echo "<br><br>" |
|  |  | . "Debugging SQL Queries: <br>" |
|  |  | . "<pre>$logDebugSQL</pre>" |
|  |  | . "<br><br>"; |
|  |  | } |
|  |  |  |
|  |  | ?> |

56 changes: 35 additions & 21 deletions

56
[include/management/actionMessages.php](#diff-3b24636889a279f1a021b6c9c6ced44fff2d1fe6bebeebc6cce43bc74b256f86 "include/management/actionMessages.php")

Show comments

[View file](/lirantal/daloradius/blob/3d11f375a76ddb3741200296e15f81d82dfb80ce/include/management/actionMessages.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,27 +1,41 @@ |
|  |  | <?php |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: actionMessages.php |
|  |  | \* Author: Liran tal <liran.tal@gmail.com> |
|  |  | \* |
|  |  | \* This file provides control for messages that are printed to the |
|  |  | \* screen in reply to actions such as applying forms, saving data, |
|  |  | \* removing data and such. |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | /\* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* daloRADIUS - RADIUS Web Platform |
|  |  | \* Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved. |
|  |  | \* |
|  |  | \* This program is free software; you can redistribute it and/or |
|  |  | \* modify it under the terms of the GNU General Public License |
|  |  | \* as published by the Free Software Foundation; either version 2 |
|  |  | \* of the License, or (at your option) any later version. |
|  |  | \* |
|  |  | \* You should have received a copy of the GNU General Public License |
|  |  | \* along with this program; if not, write to the Free Software |
|  |  | \* Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* |
|  |  | \* Description: |
|  |  | \* This file provides control for messages that are printed to the |
|  |  | \* screen in reply to actions such as applying forms, saving data, |
|  |  | \* removing data and such. |
|  |  | \* |
|  |  | \* Authors: Liran Tal <liran@enginx.com> |
|  |  | \* Filippo Lauria <filippo.lauria@iit.cnr.it> |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \*/ |
|  |  |  |
|  |  |  |
|  |  | if ((isset($failureMsg)) && ($failureMsg != "")) { |
|  |  | echo "<div class='failure'> |
|  |  | $failureMsg |
|  |  | </div> |
|  |  | "; |
|  |  | // prevent this file to be directly accessed |
|  |  | if (strpos($\_SERVER['PHP\_SELF'], '/include/management/actionMessages.php') !== false) { |
|  |  | header("Location: ../../index.php"); |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | if ((isset($successMsg)) && ($successMsg != "")) { |
|  |  | echo "<div class='success'> |
|  |  | $successMsg |
|  |  | </div> |
|  |  | "; |
|  |  | if (isset($failureMsg) && !empty($failureMsg)) { |
|  |  | printf('<div class="failure">%s</div>', $failureMsg); |
|  |  | } |
|  |  |  |
|  |  | if (isset($successMsg) && !empty($successMsg)) { |
|  |  | printf('<div class="success">%s</div>', $successMsg); |
|  |  | } |

26 changes: 17 additions & 9 deletions

26
[library/errorHandling.php](#diff-598fb49d941607428446d1a66aa95baa0a7e3e1004c939640e89922bd40937e3 "library/errorHandling.php")

Show comments

[View file](/lirantal/daloradius/blob/3d11f375a76ddb3741200296e15f81d82dfb80ce/library/errorHandling.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,22 +14,30 @@ |
|  |  | \* Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Description: |
|  |  | \* global error handling for all PEAR packages, it isn't too wise to do |
|  |  | \* that as I've no idea what other php applications are running on this machine |
|  |  | \* even though this is really just about handling the error but still. |
|  |  | \* So instead we're using the object's error handling method (see library/opendb.php) |
|  |  | \* PEAR::setErrorHandling(PEAR\_ERROR\_CALLBACK, 'errorHandler'); |
|  |  | \* |
|  |  | \* Description: global error handling for all PEAR packages, it isn't too wise to do |
|  |  | \* that as I've no idea what other php applications are running on this machine |
|  |  | \* even though this is really just about handling the error but still. |
|  |  | \* So instead we're using the object's error handling method (see library/opendb.php) |
|  |  | \* PEAR::setErrorHandling(PEAR\_ERROR\_CALLBACK, 'errorHandler'); |
|  |  | \* |
|  |  | \* Authors: Liran Tal <liran@enginx.com> |
|  |  | \* Authors: Liran Tal <liran@enginx.com> |
|  |  | \* Filippo Lauria <filippo.lauria@iit.cnr.it> |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \*/ |
|  |  |  |
|  |  | // prevent this file to be directly accessed |
|  |  | if (strpos($\_SERVER['PHP\_SELF'], '/library/errorHandling.php') !== false) { |
|  |  | header("Location: ../index.php"); |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  | function errorHandler($err) { |
|  |  | echo("<br/><b>Database error</b><br> |
|  |  | <b>Error Message: </b>" . $err->getMessage() . "<br><b>Debug info: </b>" . $err->getDebugInfo() . "<br>"); |
|  |  | echo '<div class="failure"><strong>Database error</strong><br>' |
|  |  | . "Error message: <strong>" . $err->getMessage() . "</strong><br>" |
|  |  | . "Debug info: <br>" . $err->getDebugInfo() |
|  |  | . "</div>"; |
|  |  | } |
|  |  |  |
|  |  | ?> |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3d11f37`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flirantal%2Fdaloradius%2Fcommit%2F3d11f375a76ddb3741200296e15f81d82dfb80ce) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

