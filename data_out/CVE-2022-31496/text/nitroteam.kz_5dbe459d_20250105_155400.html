
[![Nitro Team](static/img/logo.png) Nitro team](index.php)

* [Услуги](index.php?action=pages&page=services)
* [Исследования](index.php?action=researches)
* [Блог](index.php?action=blog)
* Ресурсы

  + [Вебинары](index.php?action=pages&page=webinars)
  + [GitHub](index.php?action=pages&page=github)
* [О компании](index.php?action=pages&page=about)
* RUS
  + [KAZ](index.php?action=changelang&lang=kk)
  + [ENG](index.php?action=changelang&lang=en)

[Главная](index.php)
 /
[Исследования](index.php?action=researches)
 /
Множественные уязвимости в LibreHealth part 2
### lab.

#### Исследования

* [WEB](index.php?action=researches&category=1)
* [Binary](index.php?action=researches&category=2)

#### Блог

* [Новости](index.php?action=blog&category=1)
* [В Казахстане](index.php?action=blog&category=2)

#### По тегам

1. [PHD2019](index.php?action=tags&tag=8)
2. [ZN2019](index.php?action=tags&tag=9)
3. [CTF](index.php?action=tags&tag=10)
4. [интервью](index.php?action=tags&tag=11)
5. [фишинг](index.php?action=tags&tag=12)
6. [мошенничество](index.php?action=tags&tag=13)
7. [алаяқтық](index.php?action=tags&tag=14)
8. [сұхбат](index.php?action=tags&tag=15)
9. [interview](index.php?action=tags&tag=16)
10. [fraud](index.php?action=tags&tag=17)

#### Присоединяйтесь к сообществу Nitro Team!

[![Telegram](static/img/social/telegram.svg)@nitroteamchat](https://t.me/nitroteamchat)
[![Facebook](static/img/social/facebook.svg)nitroteamkz](https://www.facebook.com/nitroteamkz/)
[![GitHub](static/img/social/github.svg)nitroteam-kz](https://github.com/nitroteam-kz)

# Множественные уязвимости в LibreHealth part 2

WEB
![](https://nitroteam.kz/static/img/calendar.png)
02.06.2022

![](https://nitroteam.kz/static/img/comments.png)
0

![](https://nitroteam.kz/static/img/eye.png)
22152

![](wp-content/uploads/images/760922fe325ce1f4dda027ff7a1cfe6e.jpg)

During an internship in our company, our students found several vulnerabilities in LibreHealth: Broken Access Control (CVE-2022-31496), Cross-Site Scripting (CVE-2022-31492, CVE-2022-31493, CVE-2022-31494, CVE-2022-31495, CVE-2022-31497, CVE-2022-31498).

We think these CVE’s are good achievement in their CV. They even not finished their bachelor degree, but already contributed to the safety of internet. The names of our heroes: Alibek Akhmetov, Bakdaulet Zhaksylyk, Daniyar Absadykov, Amir Askarov, Gaukhar Uzakbay.

**1. Broken Access Control (CVE-2022-31496)**

Any user or admin can access to the functionality for super admin page and change some files, that leads to **remote code execution**.

Vulnerable endpoint: librehealth\_host/interface/super/manage\_site\_files.php

Example of files, that can be changed using **manage\_site\_files.php** functionality:

![](https://murat.one/wp-content/uploads/2022/06/list.png)

The best choice to change is **custom\_pdf.php** file, because in case of other files, the site can be broken. Then to the custom\_pdf.php file malicious code can be injected:

![](https://murat.one/wp-content/uploads/2022/06/shell-1024x315.jpg)

After saving the code, web shell can be accessed using URL: librehealth\_host/sites/default/letter\_templates/custom\_pdf.php

![](https://murat.one/wp-content/uploads/2022/06/shell-1-1024x309.jpg)

**2. Cross-Site Scripting (XSS) attack via GET-param patient (CVE-2022-31497)**

Proof-of-concept:

![](https://murat.one/wp-content/uploads/2022/06/xss-1024x175.jpg)

> librehealth\_host/interface/main/finder/finder\_navigation.php?patient=1%22%3E%3Cscript%3Ealert(%27xss%27);%3C/script%3E%3C!--

**3. Cross-Site Scripting (XSS) attack via POST-param username (CVE-2022-31492)**

Web form for adding new users suffers from XSS:

> librehealth\_host/interface/usergroup/usergroup\_admin\_add.php

![](https://murat.one/wp-content/uploads/2022/06/xss-1-1024x555.jpg)

Field **username**is not filtered and leads to XSS in users list page:

![](https://murat.one/wp-content/uploads/2022/06/xss-2-1024x503.jpg)

**4. Cross-Site Scripting (XSS) via GET-param key (CVE-2022-31498)**

Proof-of-concept:

> librehealth\_host/orders/patient\_match\_dialog.php?key=%3C/script%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

![](https://murat.one/wp-content/uploads/2022/06/xss-3-1024x423.jpg)

**5. Cross-Site Scripting (XSS) via GET-params action, return\_page, acl\_id (CVE-2022-31493, CVE-2022-31494, CVE-2022-31495)**

Proof-of-concept:

> librehealth\_host/gacl/admin/acl\_admin.php?acl\_id=\%22%3E%3Cscript%3Ealert(%27XSS%27)%3C/script%3E librehealth\_host/gacl/admin/acl\_admin.php?return\_page=\%22%3E%3Cscript%3Ealert(%27XSS%27)%3C/script%3E librehealth\_host/gacl/admin/acl\_admin.php?action=\%22%3E%3Cscript%3Ealert(%27XSS%27)%3C/script%3E

![](https://murat.one/wp-content/uploads/2022/06/xss-4.jpg)

**Remediation**

There is no patch for this vulnerabilities because of migration to more stable framework. Never trust data from the client. Add htmlspecialchars() before printing values. To fix broken access control, super admin checking condition should be added. Or if there is no need to this functionality, file can be just deleted.

**Timeline of the vulnerabilities**:

05/13/2022 – initial discover

05/22/2022 – requesting CVE id’s from MITRE

05/24/2022 – MITRE was assigned CVE id’s

05/26/2022 – notification to vendor

06/02/2022 – vendor confirmed and allowed to publish write-up

06/02/2022 – published

1. [librehealth](index.php?action=tags&tag=24)
2. [xss](index.php?action=tags&tag=25)
3. [internship](index.php?action=tags&tag=26)
4. [research](index.php?action=tags&tag=27)

![](wp-content/uploads/avatar/../../../static/img/tmp/avatar.jpg)
Автор: Батыржан Тютеев

Понравилась статья? Поделитесь с друзьями:

* [![ВКонтакте](static/img/social/vk.svg)](https://vk.com/share.php?url=https://nitroteam.kz/index.php?action=researches%26slug=librehealth2_r)
* [![Facebook](static/img/social/facebook.svg)](https://www.facebook.com/sharer/sharer.php?u=https://nitroteam.kz/index.php?action=researches%26slug=librehealth2_r)
* [![Twitter](static/img/social/twitter.svg)](https://twitter.com/intent/tweet?url=https://nitroteam.kz/index.php?action=researches%26slug=librehealth2_r)
* [![Telegram](static/img/social/telegram.svg)](https://t.me/share/url?url=https://nitroteam.kz/index.php?action=researches%26slug=librehealth2_r)

### Вам также может быть интересно:

[![](https://nitroteam.kz/static/img/calendar.png)
06.12.2022

![](https://nitroteam.kz/static/img/comments.png)
0

![](https://nitroteam.kz/static/img/eye.png)
5634

## [CVE-2022-44153] XSS уязвимость в Rapid SCADA 5.8.4

WEB

Наш исследователь @claunch3r обнаружил XSS уязвимость в програмном обеспечении Rapid SCADA 5.8.4](index.php?action=researches&slug=CVE-2022-44153-Rapid-SCADA-ru)
[![](https://nitroteam.kz/static/img/calendar.png)
02.06.2022

![](https://nitroteam.kz/static/img/comments.png)
0

![](https://nitroteam.kz/static/img/eye.png)
22153

## Множественные уязвимости в LibreHealth part 2

WEB

Во время стажировки в нашей компании, студенты нашли множественные уязвимости в LibreHealth: Broken Access Control (CVE-2022-31496), Cross-Site Scripting (CVE-2022-31492, CVE-2022-31493, CVE-2022-31494, CVE-2022-31495, CVE-2022-31497, CVE-2022-31498).](index.php?action=researches&slug=librehealth2_r)
[![](https://nitroteam.kz/static/img/calendar.png)
03.05.2022

![](https://nitroteam.kz/static/img/comments.png)
0

![](https://nitroteam.kz/static/img/eye.png)
23301

## Описание уязвимостей CVE-2022-29938, CVE-2022-29939, CVE-2022-29940 в LibreHealth

WEB

Наш исследователь нашел в LibreHealth EHR 2.0.0 множественные уязвимости, а именно 1 SQL-injection (CVE-2022-29938) и 2 Cross-site scripting (XSS) (CVE-2022-29939, CVE-2022-29940)](index.php?action=researches&slug=librehealth_r)
[![](https://nitroteam.kz/static/img/calendar.png)
14.02.2021

![](https://nitroteam.kz/static/img/comments.png)
0

![](https://nitroteam.kz/static/img/eye.png)
19145

## Описание CVE-2020-29139, CVE-2020-29140, CVE-2020-29142, CVE-2020-29143 в OpenEMR 6.0.0-dev, OpenEMR 5.0.2(5)

WEB

В ходе исследования движка для медицинских организаций OpenEMR с открытым исходным кодом были обнаружены 4 уязвимости типа SQL-инъекция.
Тестирование уязвимостей производилось на Windows 10, Apache 2.4, 10.3.22-MariaDB. PHP 7.1.33 для OpenEMR 5.0.2(5) и PHP 7.4 для OpenEMR 6.0.0-dev. Настоятельно рекомендуем обновиться до последней версии продукта.](index.php?action=researches&slug=OpenEMR--9035)

## Заявка на консультацию

#### Перезвоним в течении 20 минут

![Нажмите для обновления картинки](https://nitroteam.kz/wp-content/captcha/captcha.php?rand=212623111)

Отправить заявку

![Nitro Team](static/img/logo.png) Nitro team

* [Правила использования](index.php?action=pages&page=tos)
* [Политика конфиденциальности](index.php?action=pages&page=policy)
* Copyright © 2025 NitroTeam

Напишите нам

* info@nitroteam.kz

