The provided content is related to a stored Cross-Site Scripting (XSS) vulnerability in Rukovoditel version 3.5.2.

**Root cause of vulnerability:**
The vulnerability lies in the `user_photo` parameter, which is not properly sanitized before being stored and displayed. This allows an attacker to inject malicious JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored XSS vulnerability due to lack of input sanitization on the `user_photo` parameter.

**Impact of exploitation:**
-  An attacker can inject malicious JavaScript code that gets executed in the victim's browser.
-  This can lead to theft of administrative cookies, allowing for session hijacking.
-  It can also lead to redirection to the attacker's website or other malicious activities.

**Attack vectors:**
- The vulnerability can be exploited by submitting a crafted request to:
    - The user account update functionality ("My Page").
    - The user registration functionality, if enabled.

**Required attacker capabilities/position:**
- The attacker needs to be able to make HTTP requests to the application.
- For the account update functionality, the attacker needs to be an authenticated user.
- For the user registration functionality, the attacker needs to be able to register or modify a registration.

**Detailed Steps:**
1.  **Vulnerable Parameter:** The `user_photo` parameter is vulnerable to XSS.
2.  **Payload:** The attacker uses the following payload: `"><img src=a onerror=alert(document.cookie)>`
3.  **Attack Vector 1 (Editing "My Page"):**
    - The attacker sends a `POST` request to `/index.php?module=users/account&action=update`
    - The `user_photo` parameter is set to `user_2_1712564921.jpeg"><img src=a onerror=alert(document.cookie)>`
    - The XSS is triggered when the user visits `/index.php?module=users/account`
4.  **Attack Vector 2 (Registration):**
    - The attacker sends a `POST` request to `/index.php?module=users/registration&action=save`
    - The `user_photo` parameter is set to `tmp_photo_1712573394_Hz7oBzXORq.png"><img src=a onerror=alert(document.cookie)>`
     - The XSS is triggered when the administrator goes to confirm new users.