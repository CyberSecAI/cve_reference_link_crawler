<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: mpg123 buffer overflow in versions before 1.32.8
 (Frankenstein's Monster)</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="3">[&lt;prev]</a> <a href="../../../2024/11/01/1">[next&gt;]</a> <a href="../../../2024/10/30/3">[&lt;thread-prev]</a> <a href="../../../2024/11/01/1">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CAOGQQ28MhqvZF9Jq8Hka-jyZzmhxey6riwAwn-4uxL8PKn6hWg&#64;mail.gmail.com&gt;
Date: Thu, 31 Oct 2024 14:38:00 -0300
From: Marco Benatto &lt;mbenatto&#64;...hat.com&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: mpg123 buffer overflow in versions before 1.32.8
 (Frankenstein's Monster)

Hello,

I just filed the details for the CVE above.

Description:
There's a out-of-bounds write issue in mpg123, the vulnerability is
located when handling crafted streams. During the decoding of PCM the
libmpg123 may write past the end of a heap located buffer, as
consequence heap corruption may happen and arbitrary code execution is
not discarded. The complexity required to exploit this flaw is
considered high as the payload needs to be validated by the MPEG
decoder and by the PCM synth before being executed. Additionally to
successfully execute the attack,the user needs to scan through the
stream making web live stream content (such as web radios) a very
unlikely attack vector.

CVSS: 6.7 CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H

Severity (according to the Red Hat severity policy): Moderate

Please let me know if there's any concern or different opinion
regarding the scoring or description of this issue.

Thanks,

Marco Benatto
Red Hat Product Security
secalert&#64;...hat.com for urgent response

On Wed, Oct 30, 2024 at 8:00 PM Marco Benatto &lt;mbenatto&#64;...hat.com&gt; wrote:
&gt;
&gt; Hello,
&gt;
&gt; I went ahead and assigned CVE-2024-10573 for this issue.
&gt; I'll try to come up with the cvss and severity analysis by tomorrow.
&gt;
&gt; Please let me know if there's anything else I could help with.
&gt;
&gt; Thanks,
&gt;
&gt; Marco Benatto
&gt; Red Hat Product Security
&gt; secalert&#64;...hat.com for urgent response
&gt;
&gt; On Wed, Oct 30, 2024 at 2:42 PM Dr. Thomas Orgis
&gt; &lt;thomas.orgis&#64;...-hamburg.de&gt; wrote:
&gt; &gt;
&gt; &gt; Dear list,
&gt; &gt;
&gt; &gt; as upstream of mpg123, I recently fixed a possibly serious issue that
&gt; &gt; resulted in writing past a buffer on the heap under certain use cases.
&gt; &gt; The fixed release is 1.32.8.
&gt; &gt;
&gt; &gt; There is no CVE for this (that I know of). If someone allocates one,
&gt; &gt; I'd be fine with that, but I am prioritizing my time in coordination
&gt; &gt; with demanding RL and focussed on getting the fix prepared. The bug
&gt; &gt; report
&gt; &gt;
&gt; &gt;         <a href="https://mpg123.org/bugs/322" rel="nofollow">https://mpg123.org/bugs/322</a>
&gt; &gt;
&gt; &gt; has always been public, so I got the fix out and decided that I do
&gt; &gt; spend a moment on this note here, seeing that distros still ship
&gt; &gt; vulnerable versions, notably Debian stable / oldstable ­— despite
&gt; &gt; the unstable repo duly having picked up my new release. I guess if
&gt; &gt; there is no CVE to grep in announcements people don't notice that it's
&gt; &gt; an important security fix? My bad, then …
&gt; &gt;
&gt; &gt; Observing that versions 1.26.x and 1.31.x are still in the wild, I
&gt; &gt; ported the recent security fix to those release series. Please see
&gt; &gt; recent commits to
&gt; &gt;
&gt; &gt;         svn://scm.orgis.org/mpg123/branches/1.26-fixes and
&gt; &gt;         svn://scm.orgis.org/mpg123/branches/1.31-fixes
&gt; &gt;
&gt; &gt; Current code is also visible under
&gt; &gt;
&gt; &gt;         <a href="https://scm.orgis.org/mpg123/branches/1.26-fixes/" rel="nofollow">https://scm.orgis.org/mpg123/branches/1.26-fixes/</a> and
&gt; &gt;         <a href="https://scm.orgis.org/mpg123/branches/1.31-fixes/" rel="nofollow">https://scm.orgis.org/mpg123/branches/1.31-fixes/</a>
&gt; &gt;
&gt; &gt; I am quoting the initial release announcement, also avaiable under
&gt; &gt;
&gt; &gt;         <a href="https://mpg123.org/cgi-bin/news.cgi#2024-10-26" rel="nofollow">https://mpg123.org/cgi-bin/news.cgi#2024-10-26</a>
&gt; &gt;
&gt; &gt; Releasing mpg123 version 1.32.8: Frankenstein's Monster
&gt; &gt;
&gt; &gt; This is an important security update! There is possible buffer overflow
&gt; &gt; (writing of decoded PCM samples beyond allocated output buffer) for
&gt; &gt; streams that change output properties together with certain usage of
&gt; &gt; libmpg123. This needed seeking around in the stream (including scanning
&gt; &gt; it before actual decoding) to trigger. So, your usual web radio stream
&gt; &gt; as obvious attack vector is unlikely, as you won't seek around in it.
&gt; &gt; If you do work with stream dumps, usage of MPG123_NO_FRANKENSTEIN or
&gt; &gt; the --no-frankenstein option to the mpg123 application is a workaround
&gt; &gt; to avoid the formerly dangerous situation in earlier mpg123 releases.
&gt; &gt; This also means that mpg123 will not decode streams of concatenated
&gt; &gt; files with either varying format or leading Info frames past the first
&gt; &gt; track anymore.
&gt; &gt;
&gt; &gt; With this release, the parser has been improved not to store certain
&gt; &gt; stream properties before actual MPEG frame data matching that property
&gt; &gt; has been stored. This avoids the inconsistency that triggered the
&gt; &gt; overflow. Also note that if you always use a fixed decoding buffer for
&gt; &gt; full stereo of the maximum of 1152 samples per frame, times two and
&gt; &gt; your choice of encoding, your application is also not susceptible.
&gt; &gt;
&gt; &gt; Exploitation of this is not trivial, but I cannot rule out the
&gt; &gt; possibility of gaining code execution. Your exploit payload needs to
&gt; &gt; pass through an MPEG decoder and PCM synth before possibly reaching the
&gt; &gt; CPU. Some heap corruption can follow at the least. So update or
&gt; &gt; mitigate. If you run 1.32.x, there is no excuse not to get the the
&gt; &gt; latest bugfix release now.
&gt; &gt;
&gt; &gt; Basically any version of mpg123 is affected by this, at least those
&gt; &gt; that explicitly support so-called Frankenstein streams.
&gt; &gt;
&gt; &gt; Thanks to kkkkk123 for bringing this heir to the initial bug 322 to my
&gt; &gt; attention.
&gt; &gt;
&gt; &gt;
&gt; &gt; Alrighty then,
&gt; &gt;
&gt; &gt; Thomas
&gt; &gt;
&gt; &gt; --
&gt; &gt; Dr. Thomas Orgis
&gt; &gt; HPC @ Universität Hamburg
&gt; &gt;

</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
