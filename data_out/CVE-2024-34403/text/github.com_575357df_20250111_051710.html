
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Furiparser%2Furiparser%2Fissues%2F183)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Furiparser%2Furiparser%2Fissues%2F183)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uriparser%2Furiparser)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uriparser](/uriparser)
/
**[uriparser](/uriparser/uriparser)**
Public

* [Notifications](/login?return_to=%2Furiparser%2Furiparser) You must be signed in to change notification settings
* [Fork
  81](/login?return_to=%2Furiparser%2Furiparser)
* [Star
   342](/login?return_to=%2Furiparser%2Furiparser)

* [Code](/uriparser/uriparser)
* [Issues
  5](/uriparser/uriparser/issues)
* [Pull requests
  1](/uriparser/uriparser/pulls)
* [Actions](/uriparser/uriparser/actions)
* [Security](/uriparser/uriparser/security)
* [Insights](/uriparser/uriparser/pulse)

Additional navigation options

* [Code](/uriparser/uriparser)
* [Issues](/uriparser/uriparser/issues)
* [Pull requests](/uriparser/uriparser/pulls)
* [Actions](/uriparser/uriparser/actions)
* [Security](/uriparser/uriparser/security)
* [Insights](/uriparser/uriparser/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Furiparser%2Furiparser%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Furiparser%2Furiparser%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [CVE-2024-34402, CVE-2024-34403] uriComposeQueryMallocExMmW Bug Report #183

Closed

[YancyLii](/YancyLii) opened this issue
Apr 21, 2024
¬∑ 7 comments

Closed

# [[CVE-2024-34402, CVE-2024-34403] uriComposeQueryMallocExMmW Bug Report](#top) #183

[YancyLii](/YancyLii) opened this issue
Apr 21, 2024
¬∑ 7 comments

Assignees
[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&v=4)](/hartwork)

Labels
[bug](/uriparser/uriparser/labels/bug)
Something isn't working
[security](/uriparser/uriparser/labels/security)

Milestone
[0.9.8](/uriparser/uriparser/milestone/11 "0.9.8")

## Comments

[![@YancyLii](https://avatars.githubusercontent.com/u/77482784?s=80&u=cdf6d4b6e79fb6b3b75eef9aa6e6b42c0b542a0f&v=4)](/YancyLii)

Copy link

### **[YancyLii](/YancyLii)** commented [Apr 21, 2024](#issue-2254925684)

| During fuzz testing of the uriparser library, we discovered a few potential security vulnerabilities that could impact the robustness and security of the software. These issues were identified in functions URI\_FUNC(ComposeQueryEngine) and URI\_FUNC(ComposeQueryMallocExMm) within the URI parsing logic. We recommend prompt attention to these matters to prevent possible exploits that could lead to buffer overflows, integer overflows, and denial of service.  Detailed Explanation and Source Code Snippets:  Integer Overflow Vulnerability:Location: File: UriQuery.c Function: URI\_FUNC(ComposeQueryEngine) Description: This function calculates required space for query string composition. There's a potential integer overflow when the length of keys or values is sufficiently large, which can result in incorrect memory allocations or operations based on malformed size calculations.Vulnerable Code: c Copy code const int worstCase = (normalizeBreaks == URI\_TRUE ? 6 : 3); const int keyLen = (key == NULL) ? 0 : (int)URI\_STRLEN(key); const int valueLen = (value == NULL) ? 0 : (int)URI\_STRLEN(value);  if ((keyLen >= INT\_MAX / worstCase) || (valueLen >= INT\_MAX / worstCase)) { return URI\_ERROR\_OUTPUT\_TOO\_LARGE; } Impact: This could allow attackers to cause a denial of service or potentially execute arbitrary code via specially crafted input. Buffer Overflow Vulnerability:Location: File: UriQuery.c Function: URI\_FUNC(ComposeQueryEngine) Description: This function handles the construction of query strings and may write beyond the allocated buffer if the total size of the composed query string exceeds the bounds specified by maxChars.Vulnerable Code:  if ((write - dest) + ampersandLen + keyRequiredChars > maxChars) { return URI\_ERROR\_OUTPUT\_TOO\_LARGE; } Impact: This flaw can lead to buffer overflow conditions, where memory adjacent to the buffer may be overwritten, potentially leading to code execution or corruption of data. Null Pointer Dereference Vulnerability:Location: File: UriQuery.c Function: URI\_FUNC(ComposeQueryEngine) Description: The function may attempt to dereference a NULL pointer if charsWritten is NULL but dest is not, which occurs after attempting to write the string terminator.Vulnerable Code:  if (dest != NULL) { write[0] = \_UT('\0'); if (charsWritten != NULL) { \*charsWritten = (int)(write - dest) + 1; // for terminator } } Impact: This could cause the application to crash, leading to a denial of service. Recommendations:  We advise reviewing these sections of code to add more robust boundary checks and input validation. Consider employing safer string manipulation methods that include boundary checks inherently. Furthermore, testing for extreme boundary |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [Apr 21, 2024](#issuecomment-2068024893)

| Hi [@YancyLii](https://github.com/YancyLii),  thanks for the report! While I consider myself part of "team security" in the sense that I consider security both important and interesting and that I'd be the first to help fixing even the smallest vulnerability rather than trying to argue it away, there is one problem though: dumping your report right into the public puts me under stress now to fix it in time (assuming there is something to fix, I have not yet had time for a closer look). That's not how security issues are supposed to be reported, please remember that next time with any project, not just uriparser. I made the same mistake once at [pypi/warehouse#2940](https://github.com/pypi/warehouse/issues/2940) myself. Usually criticism should be shared in private, but the issue is public so some public response is needed, and a response not bringing that criticism (and statement below) would be incomplete and misleading. I hope that's considered fair, I'm still glad to meet you and this is zero percent personal.  My past months had a crazy deadline and related overtime at work, and libexpat also takes my spare time these very days as replies to my call-for-help banner (added in [libexpat/libexpat@8548bc0](https://github.com/libexpat/libexpat/commit/8548bc03fdb887c8720f01e95440f1406bd15ffa)) and additional pro-active mails to companies start coming in. So I will not let this potential now-public vulnerability add more stress to me right now.  Whoever sees this post and would like to speed up analysis and a fix, coordinated help is welcome, let's jump on a voice call in German or English to increase efficiency. My profile has my e-mail address to co-ordinate a time that works for everyone.  Thanks for your patience and understanding, and thanks again for being a whitehat and the report üôè |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Apr 28, 2024

[[CVE-2024-34402] Protect against integer overflow in `ComposeQueryEngine` (related to #183)
#185](/uriparser/uriparser/pull/185)
 Merged

[[CVE-2024-34403] Protect against integer overflow in `ComposeQueryMallocExMm` (related to #183)
#186](/uriparser/uriparser/pull/186)
 Merged

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [Apr 28, 2024](#issuecomment-2081645546) ‚Ä¢ edited Loading

| [@YancyLii](https://github.com/YancyLii) I had a chance at a first closer look now, and will answer in detail below:  During fuzz testing of the uriparser library, we discovered a few potential security vulnerabilities that could impact the robustness and security of the software. These issues were identified in functions URI\_FUNC(ComposeQueryEngine) and URI\_FUNC(ComposeQueryMallocExMm) within the URI parsing logic.  Your report points out three things about `ComposeQueryEngine` but none about `ComposeQueryMallocExMm`. Did you post the complete report?  I'll address the three findings for `ComposeQueryEngine` in detail below.  I created pull request [#186](https://github.com/uriparser/uriparser/pull/186) now for my own integer overflow findings in `ComposeQueryMallocExMm`. Review would be appreciated.  We recommend prompt attention to these matters to prevent possible exploits that could lead to buffer overflows, integer overflows, and denial of service.  Definitely something worth fixing, yes.  Integer Overflow VulnerabilityLocation File: `UriQuery.c` Function `URI_FUNC(ComposeQueryEngine)` Description This function calculates required space for query string composition. There's a potential integer overflow when the length of keys or values is sufficiently large, which can result in incorrect memory allocations or operations based on malformed size calculations. Vulnerable Code ``` const int worstCase = (normalizeBreaks == URI_TRUE ? 6 : 3); const int keyLen = (key == NULL) ? 0 : (int)URI_STRLEN(key); const int valueLen = (value == NULL) ? 0 : (int)URI_STRLEN(value);  if ((keyLen >= INT_MAX / worstCase) || (valueLen >= INT_MAX / worstCase)) {   return URI_ERROR_OUTPUT_TOO_LARGE; }  ``` Impact This could allow attackers to cause a denial of service or potentially execute arbitrary code via specially crafted input.  Addressed by pull request [#185](https://github.com/uriparser/uriparser/pull/185), review is appreciated.  Buffer Overflow VulnerabilityLocation File: `UriQuery.c` Function `URI_FUNC(ComposeQueryEngine)` Description This function handles the construction of query strings and may write beyond the allocated buffer if the total size of the composed query string exceeds the bounds specified by maxChars. Vulnerable Code ``` if ((write - dest) + ampersandLen + keyRequiredChars > maxChars) {  return URI_ERROR_OUTPUT_TOO_LARGE; } ``` Impact This flaw can lead to buffer overflow conditions, where memory adjacent to the buffer may be overwritten, potentially leading to code execution or corruption of data.  Parameter `maxChars` is under control of the application using uriparser, and the user of the function needs to ensure that the content matches the reality of `URI_CHAR * dest`. I see no vulnerability here, and my understanding is that you needed to point out this potential risk as part of your analysis. If there is an attack vector beyond that, please help me see it. Thanks!  Null Pointer Dereference VulnerabilityLocation File: `UriQuery.c` Function `URI_FUNC(ComposeQueryEngine)` Description The function may attempt to dereference a `NULL` pointer if `charsWritten` is `NULL` but `dest` is not, which occurs after attempting to write the string terminator. Vulnerable Code ``` if (dest != NULL) {   write[0] = _UT('\0');   if (charsWritten != NULL) {     *charsWritten = (int)(write - dest) + 1; // for terminator   } } ``` Impact This could cause the application to crash, leading to a denial of service.  `write` is only `NULL` when `dest` is. I don't see a `NULL` dereference here, not with the mentioned condition and not any other way. Please help me see the issue if there is one. Thanks!  Recommendations We advise reviewing these sections of code to add more robust boundary checks and input validation.  I believe that pull requests [#185](https://github.com/uriparser/uriparser/pull/185) and [#186](https://github.com/uriparser/uriparser/pull/186) cover that. Do you agree?  Consider employing safer string manipulation methods that include boundary checks inherently.  I don't see how that would apply here or which functions to use instead where, given that we are still dealing with zero-terminated C strings. Please help me understand the idea.  Furthermore, testing for extreme boundary  Will need a sponsor or external reports like yours. uriparser is used in the industry ‚Äî see <https://uriparser.github.io/doc/users/#hardware> ‚Äî so these users would be best to come forward to support further hardening.  After review I would request two CVEs from Mitre for this. I would want to use your name for Mitre-internal discovery credit for the finding that pull request [#185](https://github.com/uriparser/uriparser/pull/185) fixes. Is "Yancy Lii" what I should use for your name? |
| --- |

All reactions

Sorry, something went wrong.

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)
[hartwork](/hartwork)
self-assigned this
[Apr 28, 2024](#event-12635810548)

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)
[hartwork](/hartwork)
added
[bug](/uriparser/uriparser/labels/bug)
Something isn't working
[security](/uriparser/uriparser/labels/security)
labels
[Apr 28, 2024](#event-12635810642)

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)
[hartwork](/hartwork)
added this to the [0.9.8](/uriparser/uriparser/milestone/11) milestone
[Apr 28, 2024](#event-12635810687)

[![@YancyLii](https://avatars.githubusercontent.com/u/77482784?s=80&u=cdf6d4b6e79fb6b3b75eef9aa6e6b42c0b542a0f&v=4)](/YancyLii)

Copy link

Author

### **[YancyLii](/YancyLii)** commented [Apr 29, 2024](#issuecomment-2081881674)

| Firstly, I apologize for directly submitting bug report on Github last time, which caused you significant work pressure. I am a freshman, and this is my first time participating in software testing and bug reporting. I am truly sorry.  Secondly, I believe there is no problem with your modifications to ComposeQuery Engine and ComposeQuery MallocExMm. Your modifications to the code looks good to me. As for the null Pointer Dereference Vulnerability issue I mentioned, it was submitted due to my analysis error. Your analysis is not a problem, so I apologize again.  I really hope that your project can become safer and more robust .Meanwhile, thank you for being willing to apply for two CVEs for my issue. My actual name is Yan Li, thank you very much! |
| --- |

 üëç
1
 hartwork reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [Apr 29, 2024](#issuecomment-2083836133)

| Thanks for your kind reply! I will need to call it a day for today, I'll send updates here soon‚Ä¶ |
| --- |

All reactions

Sorry, something went wrong.

[hartwork](/hartwork)
added a commit
that referenced
this issue
[Apr 30, 2024](#ref-commit-d271c2b)
[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

`[Merge pull request](/uriparser/uriparser/commit/d271c2bae3b2ebf51520538f8dbd319683a83213 "Merge pull request #185 from uriparser/issue-183-prevent-integer-overflow-in-compose-query-engine

Protect against integer overflow in `ComposeQueryEngine` (related to #183)") [#185](https://github.com/uriparser/uriparser/pull/185) [from uriparser/issue-183-prevent-integer-over‚Ä¶](/uriparser/uriparser/commit/d271c2bae3b2ebf51520538f8dbd319683a83213 "Merge pull request #185 from uriparser/issue-183-prevent-integer-overflow-in-compose-query-engine

Protect against integer overflow in `ComposeQueryEngine` (related to #183)")`
‚Ä¶

`[d271c2b](/uriparser/uriparser/commit/d271c2bae3b2ebf51520538f8dbd319683a83213)`

```
‚Ä¶flow-in-compose-query-engine

Protect against integer overflow in `ComposeQueryEngine` (related to [#183](https://github.com/uriparser/uriparser/issues/183))
```

[hartwork](/hartwork)
added a commit
that referenced
this issue
[Apr 30, 2024](#ref-commit-005a5d4)
[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

`[Merge pull request](/uriparser/uriparser/commit/005a5d4817473dee2afabf2a3ce52e132d6f320b "Merge pull request #186 from uriparser/issue-183-prevent-integer-overflow-in-compose-query-malloc-ex-mm

Protect against integer overflow in `ComposeQueryMallocExMm` (related to #183)") [#186](https://github.com/uriparser/uriparser/pull/186) [from uriparser/issue-183-prevent-integer-over‚Ä¶](/uriparser/uriparser/commit/005a5d4817473dee2afabf2a3ce52e132d6f320b "Merge pull request #186 from uriparser/issue-183-prevent-integer-overflow-in-compose-query-malloc-ex-mm

Protect against integer overflow in `ComposeQueryMallocExMm` (related to #183)")`
‚Ä¶

`[005a5d4](/uriparser/uriparser/commit/005a5d4817473dee2afabf2a3ce52e132d6f320b)`

```
‚Ä¶flow-in-compose-query-malloc-ex-mm

Protect against integer overflow in `ComposeQueryMallocExMm` (related to [#183](https://github.com/uriparser/uriparser/issues/183))
```

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [Apr 30, 2024](#issuecomment-2087739327) ‚Ä¢ edited Loading

| [@YancyLii](https://github.com/YancyLii) I have requested two CVEs from Mitre (through filling form <https://cveform.mitre.org/>) now. I did not pay as much attention when filling the forms as with fixing the issue itself, but it should be good enough. Also please note that the description that gets publish may be post-processed and not be what I entered into the form verbatim. Let's see what we get.  PS: Here's the raw quick scope analysis I did while filling the forms: Reverse call tree ``` ComposeQueryEngine                        <-- (1)     ComposeQueryCharsRequiredEx    PUBLIC         ComposeQueryCharsRequired  PUBLIC         ComposeQueryMallocExMm     PUBLIC <-- (2)             ComposeQueryMallocEx   PUBLIC                 ComposeQueryMalloc PUBLIC     ComposeQueryEx PUBIC         ComposeQuery PUBIC         ComposeQueryMallocExMm     PUBLIC <-- (2)  ``` Public API affected  * [[CVE-2024-34402] Protect against integer overflow in `ComposeQueryEngine` (related to #183)¬†#185](https://github.com/uriparser/uriparser/pull/185)   + `ComposeQueryCharsRequired`   + `ComposeQueryCharsRequiredEx`   + `ComposeQueryMalloc`   + `ComposeQueryMallocEx`   + `ComposeQueryMallocExMm` * [[CVE-2024-34403] Protect against integer overflow in `ComposeQueryMallocExMm` (related to #183)¬†#186](https://github.com/uriparser/uriparser/pull/186)   + `ComposeQueryMalloc`   + `ComposeQueryMallocEx`   + `ComposeQueryMallocExMm` |
| --- |

All reactions

Sorry, something went wrong.

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [May 3, 2024](#issuecomment-2093851173)

| [@YancyLii](https://github.com/YancyLii) this is the reply that I got back from Mitre, some text adjusted by them, some my unchanged input:  ``` -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA256   > [Suggested description] > An issue was discovered in uriparser through 0.9.7. > ComposeQueryEngine in UriQuery.c has an integer overflow via long keys or values, with a resultant buffer overflow. >  > ------------------------------------------ >  > [Vulnerability Type] > Buffer Overflow >  > ------------------------------------------ >  > [Vendor of Product] > uriparser >  > ------------------------------------------ >  > [Affected Product Code Base] > uriparser - Fixed in upcoming 0.9.8, all prior releases affected. >  > ------------------------------------------ >  > [Affected Component] > Internal functions family ComposeQueryEngine, public functions family ComposeQuery* >  > ------------------------------------------ >  > [Attack Type] > Remote >  > ------------------------------------------ >  > [Impact Code execution] > true >  > ------------------------------------------ >  > [Impact Denial of Service] > true >  > ------------------------------------------ >  > [Attack Vectors] > Crafted URI input that is longer than INT_MAX characters. >  > ------------------------------------------ >  > [Reference] > https://github.com/uriparser/uriparser/pull/185 > https://github.com/uriparser/uriparser/issues/183 >  > ------------------------------------------ >  > [Has vendor confirmed or acknowledged the vulnerability?] > true >  > ------------------------------------------ >  > [Discoverer] > Yan Li  Use CVE-2024-34402.   > [Suggested description] > An issue was discovered in uriparser through 0.9.7. > ComposeQueryMallocExMm in > UriQuery.c has an integer overflow via a long string. >  > ------------------------------------------ >  > [Additional Information] > Heap buffer overwrite in function ComposeQueryMallocExMm through > integer overflow (and functions calling that function) >  > ------------------------------------------ >  > [Vulnerability Type] > Buffer Overflow >  > ------------------------------------------ >  > [Vendor of Product] > uriparser >  > ------------------------------------------ >  > [Affected Product Code Base] > uriparser - Fixed in upcoming 0.9.8, all prior releases affected. >  > ------------------------------------------ >  > [Affected Component] > Public functions family ComposeQueryMalloc* >  > ------------------------------------------ >  > [Attack Type] > Remote >  > ------------------------------------------ >  > [Impact Code execution] > true >  > ------------------------------------------ >  > [Impact Denial of Service] > true >  > ------------------------------------------ >  > [Attack Vectors] > Crafted URI input that is longer than INT_MAX / 6 - 1 characters. >  > ------------------------------------------ >  > [Reference] > https://github.com/uriparser/uriparser/pull/186 > https://github.com/uriparser/uriparser/issues/183 >  > ------------------------------------------ >  > [Has vendor confirmed or acknowledged the vulnerability?] > true >  > ------------------------------------------ >  > [Discoverer] > Yan Li  Use CVE-2024-34403.   - --  CVE Assignment Team M/S M300, 202 Burlington Road, Bedford, MA 01730 USA [ A PGP key is available for encrypted communications at   https://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE-----  iQIzBAEBCAAdFiEEWDhf/nspQtINboAej/vgNEiM5UoFAmY0MVsACgkQj/vgNEiM 5Up9Xw/+K+BDwML5ffDTJq4XHnHi2HCRa+fu5ctCos1T19O3b2rC1nyIxvv91Qah Kfzht9t5duakvgNduhulAxyUdCs6qzx75/KmWvcUSjzwt/M5DPqygsIXru47Vm/J scU7ccqchnlXcxpQwdhES7sRAd8VkAIF3A2xGc8soEaE47qPsMD2bdIjq3VIi6KN iXUkfVfvUl4v+sM4LOGqEb/pQXZzF8BWnrvzUoWsIJY81cmXmEmXLpKiopazX55N x1QkcpuYew3jmZyIKY67Ba4kS/eRUddBo9XALNj4RX6Q7oRzuT5N5GnsyptL+pB3 0Lg5eqAAUeDitOxt6QAcDaIO0SFjbGTrANZ+dLEAzSlJ9mm1qPPdjrb7T0rENFb7 3vJm/Vr8dh8YzreFN+tzWmhL74fTG6OQbuHWcg03CD3mY3L9PGNKzaTu0ScvD3ca QoYYcCMEmK3dnMzAwuaWIlhOlUKSkpQa1yVLNTU0xee4dB4Dm1OCzk31zcbUOBWN 5akZxxypblAy5lEVjobBvRUarydExKhlrmdK//YN4H7bNkXGifVDHDST3AqUzat+ QQJvQNdGYmQrSuYsSbxVo6yhyYuozsShAUVyUkLFdBpYmBAUjnNPgb7yGQnC9yDF HnFUl6ysFHAOote2u/hNim7NeyLnvpK9tdGl3BF6I2X/M7Or5WQ= =dxlD -----END PGP SIGNATURE-----  ```  So we got two CVEs now:   * [CVE-2024-34402](https://github.com/advisories/GHSA-hwpw-xpj3-c397 "CVE-2024-34402") * [CVE-2024-34403](https://github.com/advisories/GHSA-c6h3-4727-9w7w "CVE-2024-34403")   Next step for me is to make a pull request with the version bump, the change log and anything more needed to make a release. |
| --- |

All reactions

Sorry, something went wrong.

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)
[hartwork](/hartwork)
changed the title
~~uriComposeQueryMallocExMmW Bug Report~~
[CVE-2024-34402, CVE-2024-34403] uriComposeQueryMallocExMmW Bug Report
[May 3, 2024](#event-12701851764)

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)
[hartwork](/hartwork)
closed this as [completed](/uriparser/uriparser/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 5, 2024](#event-12707563656)

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=80&u=89efa37b8b3dbc2796e254fa444f3b64cae02242&v=4)](/hartwork)

Copy link

Member

### **[hartwork](/hartwork)** commented [May 5, 2024](#issuecomment-2094887248)

| CC [#189](https://github.com/uriparser/uriparser/issues/189) [#190](https://github.com/uriparser/uriparser/pull/190) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Furiparser%2Furiparser%2Fissues%2F183)

Assignees

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=40&v=4)](/hartwork) [hartwork](/hartwork)

Labels

[bug](/uriparser/uriparser/labels/bug)
Something isn't working
[security](/uriparser/uriparser/labels/security)

Projects

None yet

Milestone

 [**0.9.8**](/uriparser/uriparser/milestone/11 "0.9.8")

Development

No branches or pull requests

2 participants

[![@hartwork](https://avatars.githubusercontent.com/u/1577132?s=52&v=4)](/hartwork) [![@YancyLii](https://avatars.githubusercontent.com/u/77482784?s=52&v=4)](/YancyLii)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

