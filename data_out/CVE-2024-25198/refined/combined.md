=== Content from github.com_29ea0b83_20250110_151943.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4070)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4070)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 #4070

 Merged

[SteveMacenski](/SteveMacenski)
merged 1 commit into
[ros-navigation:main](/ros-navigation/navigation2/tree/main "ros-navigation/navigation2:main")
from
GoesM:main

Jan 25, 2024

 Merged

# [change pointer free order in amcl to avoid use-after-free bug mentioned in #4068](#top) #4070

[SteveMacenski](/SteveMacenski)
merged 1 commit into
[ros-navigation:main](/ros-navigation/navigation2/tree/main "ros-navigation/navigation2:main")
from
GoesM:main

Jan 25, 2024

[Conversation
0](/ros-navigation/navigation2/pull/4070)
[Commits
1](/ros-navigation/navigation2/pull/4070/commits)
[Checks
9](/ros-navigation/navigation2/pull/4070/checks)
[Files changed](/ros-navigation/navigation2/pull/4070/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![GoesM](https://avatars.githubusercontent.com/u/130988564?s=60&v=4)](/GoesM)

Copy link

Contributor

### @GoesM **[GoesM](/GoesM)** commented [Jan 25, 2024](#issue-2101113725)

---

## Basic Info

| Info | Please fill out this column |
| --- | --- |
| Ticket(s) this addresses | [#4068](https://github.com/ros-navigation/navigation2/issues/4068) |
| Primary OS tested on | Ubuntu22.04 |
| Robotic platform tested on | gazebo simulation |
| Does this PR contain AI generated software? | No |

---

## Description of contribution in a few bullet points

make `tf_listener_.reset()` before `lase_scan_filter_.reset()`

---

## Future work that may be required in bullet points

#### For Maintainers:

* Check that any new parameters added are updated in navigation.ros.org
* Check that any significant change is added to the migration guide
* Check that any new features **OR** changes to existing behaviors are reflected in the tuning guide
* Check that any new functions have Doxygen added
* Check that any new features have test coverage
* Check that any new plugins is added to the plugins page
* If BT Node, Additionally: add to BT's XML index of nodes for groot, BT package's readme table, and BT library lists

Sorry, something went wrong.

All reactions

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/pull/4070/commits/ce1648f5cb9751a5deeda85cddb4ed87dbcc22ea "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068

Signed-off-by: GoesM <GoesM@buaa.edu.cn>")`
 …

`[ce1648f](/ros-navigation/navigation2/pull/4070/commits/ce1648f5cb9751a5deeda85cddb4ed87dbcc22ea)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
```

[![SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=60&v=4)](/SteveMacenski)

**[SteveMacenski](/SteveMacenski)**
approved these changes
[Jan 25, 2024](#pullrequestreview-1844637214)

 [View reviewed changes](/ros-navigation/navigation2/pull/4070/files/ce1648f5cb9751a5deeda85cddb4ed87dbcc22ea)

 Hide details
View details

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
merged commit [`1348e52`](/ros-navigation/navigation2/commit/1348e526f4c945ea0c64239f78736c71349a5913)
into
ros-navigation:main

[Jan 25, 2024](https://github.com/ros-navigation/navigation2/pull/4070#event-11602708427)
9 of 11 checks passed

[BriceRenaudeau](/BriceRenaudeau)
pushed a commit
to BriceRenaudeau/navigation2
that referenced
this pull request
[Jan 29, 2024](#ref-commit-3a3ebab)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&v=4)](/BriceRenaudeau)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/BriceRenaudeau/navigation2/commit/3a3ebab25d41487abeaed6e36fb96f41d954e1c8 "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>")`
…

`[3a3ebab](/BriceRenaudeau/navigation2/commit/3a3ebab25d41487abeaed6e36fb96f41d954e1c8)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
```

[BriceRenaudeau](/BriceRenaudeau)
pushed a commit
to BriceRenaudeau/navigation2
that referenced
this pull request
[Jan 29, 2024](#ref-commit-43aa44a)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&v=4)](/BriceRenaudeau)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/BriceRenaudeau/navigation2/commit/43aa44affa69cab60daa66d25b4cf3ba9787bc1b "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>")`
…

`[43aa44a](/BriceRenaudeau/navigation2/commit/43aa44affa69cab60daa66d25b4cf3ba9787bc1b)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Feb 12, 2024](#ref-commit-5111f98)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[5111f98](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[ajtudela](/ajtudela)
pushed a commit
to grupo-avispa/navigation2
that referenced
this pull request
[Mar 7, 2024](#ref-commit-3209c4f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@ajtudela](https://avatars.githubusercontent.com/u/4681902?s=40&v=4)](/ajtudela)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[3209c4f](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[redvinaa](/redvinaa)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this pull request
[Mar 18, 2024](#ref-commit-0989ebe)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@redvinaa](https://avatars.githubusercontent.com/u/60265874?s=40&v=4)](/redvinaa)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[0989ebe](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[stevedanomodolor](/stevedanomodolor)
pushed a commit
to stevedanomodolor/navigation2
that referenced
this pull request
[Mar 25, 2024](#ref-commit-fd0477b)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@stevedanomodolor](https://avatars.githubusercontent.com/u/61468301?s=40&v=4)](/stevedanomodolor)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")`
…

`[fd0477b](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>
```

[stevedanomodolor](/stevedanomodolor)
added a commit
to stevedanomodolor/navigation2
that referenced
this pull request
[Mar 25, 2024](#ref-commit-e1b1f24)
[![@stevedanomodolor](https://avatars.githubusercontent.com/u/61468301?s=40&u=246815559c33886f0a8c9cb96c8eefa2f975b667&v=4)](/stevedanomodolor)

`[Include goal heading mode to allow bidirectional and all direction goals](/stevedanomodolor/navigation2/commit/e1b1f24fed16aede76af1c70f5b52ce4e6d019bb "Include goal heading mode to allow bidirectional and all direction goals

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

[behavior_tree] support both ports and blackboard (#4060)

* check result of blackboard->get and use halTree

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove unused header

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* BT: add port inputs when missing and use getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add description

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* change return value of getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* updated tree XML

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

adding new Friends of Nav2 Sponsors!

Update README.md (#4114)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

CI green P3 (#4117)

Refactors `possible_inscribed_cost` to `possible_circumscribed_cost` in collision checker for smac_planner and mppi_controller (#4113). (#4118)

* Utilizes circumscribed radius to assess potential collision points on the robot.
* Ensures safety when the robot's center is outside the circumscribed radius, eliminating additional checks and optimizing CPU usage.
Signed-off-by: Alan Xue <alan.xuefei@googlemail.com>

Added cast to float to getClosestAngularBin return for behavior consistency (#4123)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

Adding context to MPPI readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

[behavior_tree] Add generate_nav2_tree_nodes_xml (#4073)

* Add generate_nav2_tree_nodes_xml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* behavior_tree: removed list of plugins from yaml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* check result of get_parameter(plugin_lib_names)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix previous commit (uncrustify)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* revert change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Fix compilation with clang (#4131)

Signed-off-by: Ramon Wijnands <ramon.wijnands@nobleo.nl>

code improvement based on feedback. Name changes and minor code improvement

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix goal handle was not freed correctly (#4137)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

Adding Nvidia as Gold Sponsor! (#4144)

Prevent a possible segmentation fault (#4141) (#4147)

* Prevent a possible segmentation fault

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

* Cleanup

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

---------

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

Updating stereolabs logo (#4158)

Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

behavior_tree: migration to BT.CPP 4.5.x (#4128)

* behavior_tree: migration to BT.CPP 4.5.x

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix formatting

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix lint warning

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove setStatus(BT::NodeStatus::IDLE)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* handle SKIPPED state

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix unit tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add emitWakeUpSignal()

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fit test

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* keep resetStatus() in action_node

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add suggestions from peer reviewer

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix compilation

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

bug fix (#4160)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>

Stop planner if the goal is cancelled (#4148)

* Add support for stopping planners when the action is cancelled

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Smac planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Theta* planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Navfn planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Update nav2_system_tests to use cancel checker

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add terminal_checking_interval parameter

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Handle timeout and cancel check on the same branch and default to 5000 iterations

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add system tests for cancel

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

---------

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>
Co-authored-by: Kemal Bektas <kemal.bektas@node-robotics.com>

Improvement on the wat the distance heuristic is calculated

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix BT.CPP import (#4165)

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

improvement based on feedback

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")`
…

`[e1b1f24](/stevedanomodolor/navigation2/commit/e1b1f24fed16aede76af1c70f5b52ce4e6d019bb)`

```
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

[behavior_tree] support both ports and blackboard ([ros-navigation#4060](https://github.com/ros-navigation/navigation2/pull/4060))

* check result of blackboard->get and use halTree

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove unused header

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* BT: add port inputs when missing and use getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add description

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* change return value of getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* updated tree XML

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

adding new Friends of Nav2 Sponsors!

Update README.md ([ros-navigation#4114](https://github.com/ros-navigation/navigation2/pull/4114))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

CI green P3 ([ros-navigation#4117](https://github.com/ros-navigation/navigation2/pull/4117))

Refactors `possible_inscribed_cost` to `possible_circumscribed_cost` in collision checker for smac_planner and mppi_controller ([ros-navigation#4113](https://github.com/ros-navigation/navigation2/issues/4113)). ([ros-navigation#4118](https://github.com/ros-navigation/navigation2/pull/4118))

* Utilizes circumscribed radius to assess potential collision points on the robot.
* Ensures safety when the robot's center is outside the circumscribed radius, eliminating additional checks and optimizing CPU usage.
Signed-off-by: Alan Xue <alan.xuefei@googlemail.com>

Added cast to float to getClosestAngularBin return for behavior consistency ([ros-navigation#4123](https://github.com/ros-navigation/navigation2/pull/4123))

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

Adding context to MPPI readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

[behavior_tree] Add generate_nav2_tree_nodes_xml ([ros-navigation#4073](https://github.com/ros-navigation/navigation2/pull/4073))

* Add generate_nav2_tree_nodes_xml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* behavior_tree: removed list of plugins from yaml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* check result of get_parameter(plugin_lib_names)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix previous commit (uncrustify)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* revert change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Fix compilation with clang ([ros-navigation#4131](https://github.com/ros-navigation/navigation2/pull/4131))

Signed-off-by: Ramon Wijnands <ramon.wijnands@nobleo.nl>

code improvement based on feedback. Name changes and minor code improvement

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix goal handle was not freed correctly ([ros-navigation#4137](https://github.com/ros-navigation/navigation2/pull/4137))

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

Adding Nvidia as Gold Sponsor! ([ros-navigation#4144](https://github.com/ros-navigation/navigation2/pull/4144))

Prevent a possible segmentation fault ([ros-navigation#4141](https://github.com/ros-navigation/navigation2/issues/4141)) ([ros-navigation#4147](https://github.com/ros-navigation/navigation2/pull/4147))

* Prevent a possible segmentation fault

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

* Cleanup

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

---------

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

Updating stereolabs logo ([ros-navigation#4158](https://github.com/ros-navigation/navigation2/pull/4158))

Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

behavior_tree: migration to BT.CPP 4.5.x ([ros-navigation#4128](https://github.com/ros-navigation/navigation2/pull/4128))

* behavior_tree: migration to BT.CPP 4.5.x

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix formatting

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix lint warning

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove setStatus(BT::NodeStatus::IDLE)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* handle SKIPPED state

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix unit tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add emitWakeUpSignal()

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fit test

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* keep resetStatus() in action_node

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add suggestions from peer reviewer

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix compilation

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

bug fix ([ros-navigation#4160](https://github.com/ros-navigation/navigation2/pull/4160))

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>

Stop planner if the goal is cancelled ([ros-navigation#4148](https://github.com/ros-navigation/navigation2/pull/4148))

* Add support for stopping planners when the action is cancelled

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Smac planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Theta* planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Navfn planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Update nav2_system_tests to use cancel checker

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add terminal_checking_interval parameter

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Handle timeout and cancel check on the same branch and default to 5000 iterations

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add system tests for cancel

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

---------

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>
Co-authored-by: Kemal Bektas <kemal.bektas@node-robotics.com>

Improvement on the wat the distance heuristic is calculated

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix BT.CPP import ([ros-navigation#4165](https://github.com/ros-navigation/navigation2/pull/4165))

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

improvement based on feedback

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>
```

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-dc952dc)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/commit/dc952dc95bec87abb7c1754477e4117aa21a97ed "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
…

`[dc952dc](/ros-navigation/navigation2/commit/dc952dc95bec87abb7c1754477e4117aa21a97ed)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-342ad51)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[342ad51](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-1dea56b)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/commit/1dea56b2b0ad2abfafffbb1b729d942c73825222 "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
…

`[1dea56b](/ros-navigation/navigation2/commit/1dea56b2b0ad2abfafffbb1b729d942c73825222)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-9aec27e)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[9aec27e](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-e6da02f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring)

`[Iron sync 5: April 4, 2024 (](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")[#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")`
…

`[e6da02f](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c)`

```
* nav2_controller: add loop rate log ([#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/ros-navigation/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/ros-navigation/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/ros-navigation/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Apr 4, 2024](#ref-commit-f41920e)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar)

`[Humble sync 10: April 4, 2024 (](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14 "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[#4241](https://github.com/ros-navigation/navigation2/pull/4241)[)](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14 "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[f41920e](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14)`

```
* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[RBT22](/RBT22)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this pull request
[Apr 9, 2024](#ref-commit-f72d95b)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@RBT22](https://avatars.githubusercontent.com/u/43723477?s=40&v=4)](/RBT22)

`[Humble sync 10: April 4, 2024 (](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[ros-navigation#4241](https://github.com/ros-navigation/navigation2/pull/4241)[)](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[f72d95b](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d)`

```
* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[emilnovak](/emilnovak)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this pull request
[Apr 10, 2024](#ref-commit-7046850)
[![@RBT22](https://avatars.githubusercontent.com/u/43723477?s=40&u=33340161802959fa7974a7d29457283e7b1b68f1&v=4)](/RBT22) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[![@thandal](https://avatars.githubusercontent.com/u/2613832?s=40&v=4)](/thandal) [![@antonkesy](https://avatars.githubusercontent.com/u/25124866?s=40&u=3083aaeb13978d3596bbe7798d56221aade670d5&v=4)](/antonkesy) [![@CihatAltiparmak](https://avatars.githubusercontent.com/u/35902471?s=40&u=0fd833e50b9c38b3aea34ac6f309e2e0a80cc1fc&v=4)](/CihatAltiparmak) [![@akchobby](https://avatars.githubusercontent.com/u/44644339?s=40&u=9c2b9d23034ba7075fe5bf72508882411f5bcd55&v=4)](/akchobby) [![@ladianchad](https://avatars.githubusercontent.com/u/60467877?s=40&u=165909f8e6e5923f22f3a1bc61aad3e4025b6927&v=4)](/ladianchad) [![@kevin-floatic](https://avatars.githubusercontent.com/u/89058869?s=40&v=4)](/kevin-floatic) [![@romi2002](https://avatars.githubusercontent.com/u/9159338?s=40&v=4)](/romi2002) [![@mikeferguson](https://avatars.githubusercontent.com/u/899410?s=40&v=4)](/mikeferguson) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@hsong-MLE](https://avatars.githubusercontent.com/u/158601314?s=40&v=4)](/hsong-MLE) [![@iceuw](https://avatars.githubusercontent.com/u/23731407?s=40&v=4)](/iceuw) [![@Chortine](https://avatars.githubusercontent.com/u/107395103?s=40&u=6ab6346d84f11c970344b9efdf2fa4bcc1d08845&v=4)](/Chortine) [![@MikeWrock](https://avatars.githubusercontent.com/u/8420420?s=40&u=c89c87d4f2bf9d6b962934c231b53868c2876a86&v=4)](/MikeWrock) [![@stephanie-eng](https://avatars.githubusercontent.com/u/10466537?s=40&u=5364cffbd08250932482d4fbb6c031741ba683d2&v=4)](/stephanie-eng) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar)

`[Nav2 Sync 3 2024 April 9 (](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2 "Nav2 Sync 3 2024 April 9 (#15)

* Fix #4001 (#4028)

* Humble Sync 9: Jan 23, 2024 (#4064)

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners (#3978)

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS (#4051)

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI (#4099) (#4101)

(cherry picked from commit 8f7b6ceef943c99497c39da341219a67a4796162)

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble (#4119)

* Added cast to float to getClosestAngularBin return for behavior consistency (#4123) (#4125)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit c59e0f362a867244d589562ecff56a9a5f23df59)

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly (#4137) (#4143)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit 2e491b18328ede064c75bfa024f57c7e49578eba)

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix (#4160) (#4162)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit 623434b09f25afac3872411b8fda786a6f6dce95)

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix (#4213) (#4216)

(cherry picked from commit 46ff0ecc4cc7d42cc92477e6159b29d69fd23050)

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) (#4239)

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[#15](https://github.com/EnjoyRobotics/navigation2/pull/15)[)](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2 "Nav2 Sync 3 2024 April 9 (#15)

* Fix #4001 (#4028)

* Humble Sync 9: Jan 23, 2024 (#4064)

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners (#3978)

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS (#4051)

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI (#4099) (#4101)

(cherry picked from commit 8f7b6ceef943c99497c39da341219a67a4796162)

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble (#4119)

* Added cast to float to getClosestAngularBin return for behavior consistency (#4123) (#4125)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit c59e0f362a867244d589562ecff56a9a5f23df59)

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly (#4137) (#4143)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit 2e491b18328ede064c75bfa024f57c7e49578eba)

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix (#4160) (#4162)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit 623434b09f25afac3872411b8fda786a6f6dce95)

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix (#4213) (#4216)

(cherry picked from commit 46ff0ecc4cc7d42cc92477e6159b29d69fd23050)

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) (#4239)

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[7046850](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2)`

```
* Fix [ros-navigation#4001](https://github.com/ros-navigation/navigation2/issues/4001) ([ros-navigation#4028](https://github.com/ros-navigation/navigation2/pull/4028))

* Humble Sync 9: Jan 23, 2024 ([ros-navigation#4064](https://github.com/ros-navigation/navigation2/pull/4064))

* Update README.md: fix typo ([ros-navigation#3842](https://github.com/ros-navigation/navigation2/pull/3842))

* Update package.xml

* fix typo ([ros-navigation#3850](https://github.com/ros-navigation/navigation2/pull/3850))

* adjust link to point to v3.8 of behavior tree docs ([ros-navigation#3851](https://github.com/ros-navigation/navigation2/pull/3851))

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node ([ros-navigation#3849](https://github.com/ros-navigation/navigation2/pull/3849))

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes [ros-navigation#3858](https://github.com/ros-navigation/navigation2/issues/3858) ([ros-navigation#3859](https://github.com/ros-navigation/navigation2/pull/3859))

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos ([ros-navigation#3892](https://github.com/ros-navigation/navigation2/pull/3892))

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free ([ros-navigation#3910](https://github.com/ros-navigation/navigation2/pull/3910))

* fix build mppi ([ros-navigation#3927](https://github.com/ros-navigation/navigation2/pull/3927))

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README ([ros-navigation#3963](https://github.com/ros-navigation/navigation2/pull/3963))

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners ([ros-navigation#3978](https://github.com/ros-navigation/navigation2/pull/3978))

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS ([ros-navigation#4051](https://github.com/ros-navigation/navigation2/pull/4051))

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI ([ros-navigation#4099](https://github.com/ros-navigation/navigation2/pull/4099)) ([ros-navigation#4101](https://github.com/ros-navigation/navigation2/pull/4101))

(cherry picked from commit [8f7b6ce](https://github.com/EnjoyRobotics/navigation2/commit/8f7b6ceef943c99497c39da341219a67a4796162))

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble ([ros-navigation#4119](https://github.com/ros-navigation/navigation2/pull/4119))

* Added cast to float to getClosestAngularBin return for behavior consistency ([ros-navigation#4123](https://github.com/ros-navigation/navigation2/pull/4123)) ([ros-navigation#4125](https://github.com/ros-navigation/navigation2/pull/4125))

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit [c59e0f3](https://github.com/EnjoyRobotics/navigation2/commit/c59e0f362a867244d589562ecff56a9a5f23df59))

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly ([ros-navigation#4137](https://github.com/ros-navigation/navigation2/pull/4137)) ([ros-navigation#4143](https://github.com/ros-navigation/navigation2/pull/4143))

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit [2e491b1](https://github.com/EnjoyRobotics/navigation2/commit/2e491b18328ede064c75bfa024f57c7e49578eba))

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix ([ros-navigation#4160](https://github.com/ros-navigation/navigation2/pull/4160)) ([ros-navigation#4162](https://github.com/ros-navigation/navigation2/pull/4162))

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit [623434b](https://github.com/EnjoyRobotics/navigation2/commit/623434b09f25afac3872411b8fda786a6f6dce95))

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix ([ros-navigation#4213](https://github.com/ros-navigation/navigation2/pull/4213)) ([ros-navigation#4216](https://github.com/ros-navigation/navigation2/pull/4216))

(cherry picked from commit [46ff0ec](https://github.com/EnjoyRobotics/navigation2/commit/46ff0ecc4cc7d42cc92477e6159b29d69fd23050))

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) ([ros-navigation#4239](https://github.com/ros-navigation/navigation2/pull/4239))

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 ([ros-navigation#4241](https://github.com/ros-navigation/navigation2/pull/4241))

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[enricosutera](/enricosutera)
pushed a commit
to enricosutera/navigation2
that referenced
this pull request
[May 19, 2024](#ref-commit-b5905a2)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@enricosutera](https://avatars.githubusercontent.com/u/51802424?s=40&v=4)](/enricosutera)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/enricosutera/navigation2/commit/b5905a2475785ee7320bc99d51121d79550f12fc "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>")`
…

`[b5905a2](/enricosutera/navigation2/commit/b5905a2475785ee7320bc99d51121d79550f12fc)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>
```

[enricosutera](/enricosutera)
pushed a commit
to enricosutera/navigation2
that referenced
this pull request
[May 19, 2024](#ref-commit-2241d1f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@enricosutera](https://avatars.githubusercontent.com/u/51802424?s=40&v=4)](/enricosutera)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>")`
…

`[2241d1f](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>
```

[maksymdidukh](/maksymdidukh)
pushed a commit
to logivations/navigation2
that referenced
this pull request
[Jun 24, 2024](#ref-commit-2e939bc)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@maksymdidukh](https://avatars.githubusercontent.com/u/142302397?s=40&v=4)](/maksymdidukh)

`[Iron sync 5: April 4, 2024 (](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")[ros-navigation#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")`
…

`[2e939bc](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77)`

```
* nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([ros-navigation#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [ros-navigation#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([ros-navigation#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([ros-navigation#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([ros-navigation#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/logivations/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([ros-navigation#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([ros-navigation#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([ros-navigation#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/logivations/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([ros-navigation#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/logivations/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
```

[![@maksymdidukh](https://avatars.githubusercontent.com/u/142302397?s=40&v=4)](/maksymdidukh)
[maksymdidukh](/maksymdidukh)
mentioned this pull request
[Jun 24, 2024](#ref-pullrequest-2370199569)

[Backport velocity polygons
logivations/navigation2#71](/logivations/navigation2/pull/71)
 Merged

[Marc-Morcos](/Marc-Morcos)
pushed a commit
to Marc-Morcos/navigation2
that referenced
this pull request
[Jul 4, 2024](#ref-commit-a3043bd)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Marc-Morcos](https://avatars.githubusercontent.com/u/30278842?s=40&v=4)](/Marc-Morcos)

`[Iron sync 5: April 4, 2024 (](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>")[ros-navigation#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>")`
…

`[a3043bd](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071)`

```
* nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([ros-navigation#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [ros-navigation#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([ros-navigation#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([ros-navigation#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([ros-navigation#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/Marc-Morcos/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([ros-navigation#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([ros-navigation#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([ros-navigation#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/Marc-Morcos/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([ros-navigation#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/Marc-Morcos/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4070)

Reviewers

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski) [SteveMacenski](/SteveMacenski)

SteveMacenski approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=52&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=52&v=4)](/SteveMacenski)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a93107d8_20250110_151940.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4068)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4068)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Inappropriate pointer free order in amcl may trigger use-after-free bug #4068

Closed

[GoesM](/GoesM) opened this issue
Jan 25, 2024
· 1 comment

Closed

# [Inappropriate pointer free order in amcl may trigger use-after-free bug](#top) #4068

[GoesM](/GoesM) opened this issue
Jan 25, 2024
· 1 comment

## Comments

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

### **[GoesM](/GoesM)** commented [Jan 25, 2024](#issue-2100420254)

| Bug report **Required Info:**   * Operating System:   + Ubuntu22.04 * ROS2 Version:   + humble * Version or commit hash:   + the latest * DDS implementation:   + defaulted  Steps to reproduce issue During my very ordinary use, an unexpected situation was triggered.  I launched the navigation2 normally, as following steps:  ``` #!/bin/bash export ASAN_OPTIONS=halt_on_error=0:new_delete_type_mismatch=0:detect_leaks=0:log_pah=asan source install/setup.bash export TURTLEBOT3_MODEL=waffle export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models ros2 launch nav2_bringup tb3_simulation_launch.py headless:=True use_rviz:=False use_composition:=False  ``` Expected behaviorActual behavior During my usage, the ASAN report a **use-after-free** bug to me, as following:  ``` ================================================================= ==1627006==ERROR: AddressSanitizer: heap-use-after-free on address 0x61700009e6b8 at pc 0x7ff9b0cf3539 bp 0x7ff9a7db9230 sp 0x7ff9a7db9228 READ of size 8 at 0x61700009e6b8 thread T11     #0 0x7ff9b0cf3538 in message_filters::Signal1<sensor_msgs::msg::LaserScan_<std::allocator<void> > >::call(message_filters::MessageEvent<sensor_msgs::msg::LaserScan_<std::allocator<void> > const> const&) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x4f3538) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #1 0x7ff9b0d38790 in tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>::transformReadyCallback(tf2_ros::TransformStampedFuture const&, unsigned long) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x538790) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #2 0x7ff9b0d3cc6e in std::_Function_handler<void (tf2_ros::TransformStampedFuture const&), std::_Bind<void (tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>::* (tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>*, std::_Placeholder<1>, unsigned long))(tf2_ros::TransformStampedFuture const&, unsigned long)> >::_M_invoke(std::_Any_data const&, tf2_ros::TransformStampedFuture const&) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x53cc6e) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #3 0x7ff9b2091e8d  (/opt/ros/humble/lib/libtf2_ros.so+0x4fe8d) (BuildId: dc6ad94876402bc27e6b8ba01e2b78c714ce71a6)     #4 0x7ff9b200d5fe in tf2::BufferCore::testTransformableRequests() (/opt/ros/humble/lib/libtf2.so+0x105fe) (BuildId: 3860beff8328ff840e10c2fded56403848cba9a0)     #5 0x7ff9b2010321 in tf2::BufferCore::setTransformImpl(tf2::Transform const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::chrono::time_point<std::chrono::_V2::system_clock, std::chrono::duration<long, std::ratio<1l, 1000000000l> > >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, bool) (/opt/ros/humble/lib/libtf2.so+0x13321) (BuildId: 3860beff8328ff840e10c2fded56403848cba9a0)     #6 0x7ff9b2010b69 in tf2::BufferCore::setTransform(geometry_msgs::msg::TransformStamped_<std::allocator<void> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, bool) (/opt/ros/humble/lib/libtf2.so+0x13b69) (BuildId: 3860beff8328ff840e10c2fded56403848cba9a0)     #7 0x7ff9b209abb0 in tf2_ros::TransformListener::subscription_callback(std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>, bool) (/opt/ros/humble/lib/libtf2_ros.so+0x58bb0) (BuildId: dc6ad94876402bc27e6b8ba01e2b78c714ce71a6)     #8 0x7ff9b209aa89 in std::_Function_handler<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>), std::_Bind<void (tf2_ros::TransformListener::* (tf2_ros::TransformListener*, std::_Placeholder<1>, bool))(std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>, bool)> >::_M_invoke(std::_Any_data const&, std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>&&) (/opt/ros/humble/lib/libtf2_ros.so+0x58a89) (BuildId: dc6ad94876402bc27e6b8ba01e2b78c714ce71a6)     #9 0x7ff9b20af601 in std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<void> (*)(rclcpp::AnySubscriptionCallback<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::allocator<void> >::dispatch(std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >, rclcpp::MessageInfo const&)::'lambda'(auto&&)&&, std::variant<std::function<void (tf2_msgs::msg::TFMessage_<std::allocator<void> > const&)>, std::function<void (tf2_msgs::msg::TFMessage_<std::allocator<void> > const&, rclcpp::MessageInfo const&)>, std::function<void (rclcpp::SerializedMessage const&)>, std::function<void (rclcpp::SerializedMessage const&, rclcpp::MessageInfo const&)>, std::function<void (std::unique_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::default_delete<tf2_msgs::msg::TFMessage_<std::allocator<void> > > >)>, std::function<void (std::unique_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::default_delete<tf2_msgs::msg::TFMessage_<std::allocator<void> > > >, rclcpp::MessageInfo const&)>, std::function<void (std::unique_ptr<rclcpp::SerializedMessage, std::default_delete<rclcpp::SerializedMessage> >)>, std::function<void (std::unique_ptr<rclcpp::SerializedMessage, std::default_delete<rclcpp::SerializedMessage> >, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const>)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const>, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const> const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const> const&, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const> const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const> const&, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage>)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage>, rclcpp::MessageInfo const&)> >&)>, std::integer_sequence<unsigned long, 8ul> >::__visit_invoke(rclcpp::AnySubscriptionCallback<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::allocator<void> >::dispatch(std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >, rclcpp::MessageInfo const&)::'lambda'(auto&&)&&, std::variant<std::function<void (tf2_msgs::msg::TFMessage_<std::allocator<void> > const&)>, std::function<void (tf2_msgs::msg::TFMessage_<std::allocator<void> > const&, rclcpp::MessageInfo const&)>, std::function<void (rclcpp::SerializedMessage const&)>, std::function<void (rclcpp::SerializedMessage const&, rclcpp::MessageInfo const&)>, std::function<void (std::unique_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::default_delete<tf2_msgs::msg::TFMessage_<std::allocator<void> > > >)>, std::function<void (std::unique_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> >, std::default_delete<tf2_msgs::msg::TFMessage_<std::allocator<void> > > >, rclcpp::MessageInfo const&)>, std::function<void (std::unique_ptr<rclcpp::SerializedMessage, std::default_delete<rclcpp::SerializedMessage> >)>, std::function<void (std::unique_ptr<rclcpp::SerializedMessage, std::default_delete<rclcpp::SerializedMessage> >, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const>, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const>)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const>, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const> const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > const> const&, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const> const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage const> const&, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >)>, std::function<void (std::shared_ptr<tf2_msgs::msg::TFMessage_<std::allocator<void> > >, rclcpp::MessageInfo const&)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage>)>, std::function<void (std::shared_ptr<rclcpp::SerializedMessage>, rclcpp::MessageInfo const&)> >&) (/opt/ros/humble/lib/libtf2_ros.so+0x6d601) (BuildId: dc6ad94876402bc27e6b8ba01e2b78c714ce71a6)     #10 0x7ff9b20ae93e  (/opt/ros/humble/lib/libtf2_ros.so+0x6c93e) (BuildId: dc6ad94876402bc27e6b8ba01e2b78c714ce71a6)     #11 0x7ff9b1c4c7ab in rclcpp::Executor::execute_subscription(std::shared_ptr<rclcpp::SubscriptionBase>) (/opt/ros/humble/lib/librclcpp.so+0xe77ab) (BuildId: 79589eb7552577357ad155ddcc914b38e18f0811)     #12 0x7ff9b1c4cfae in rclcpp::Executor::execute_any_executable(rclcpp::AnyExecutable&) (/opt/ros/humble/lib/librclcpp.so+0xe7fae) (BuildId: 79589eb7552577357ad155ddcc914b38e18f0811)     #13 0x7ff9b1c5489f in rclcpp::executors::SingleThreadedExecutor::spin() (/opt/ros/humble/lib/librclcpp.so+0xef89f) (BuildId: 79589eb7552577357ad155ddcc914b38e18f0811)     #14 0x7ff9b02dc252  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xdc252) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)     #15 0x7ff9afe94ac2 in start_thread nptl/./nptl/pthread_create.c:442:8     #16 0x7ff9aff26a3f  misc/../sysdeps/unix/sysv/linux/x86_64/clone3.S:81  0x61700009e6b8 is located 56 bytes inside of 704-byte region [0x61700009e680,0x61700009e940) freed by thread T1 here:     #0 0x55697b23a98d in operator delete(void*) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/nav2_amcl/amcl+0xe998d) (BuildId: 4e1ce3fcf62a6d0e51a98b07383906fe5ca789ec)     #1 0x7ff9b0bcbabc in std::__uniq_ptr_impl<tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>, std::default_delete<tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer> > >::reset(tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>*) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x3cbabc) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #2 0x7ff9b1b48b8c  (/opt/ros/humble/lib/librclcpp_lifecycle.so+0x28b8c) (BuildId: ccb1b39efb3eaee63de490386a8850a5752f307d)  previously allocated by thread T0 here:     #0 0x55697b23a12d in operator new(unsigned long) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/nav2_amcl/amcl+0xe912d) (BuildId: 4e1ce3fcf62a6d0e51a98b07383906fe5ca789ec)     #1 0x7ff9b0bc407f in std::_MakeUniq<tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer> >::__single_object std::make_unique<tf2_ros::MessageFilter<sensor_msgs::msg::LaserScan_<std::allocator<void> >, tf2_ros::Buffer>, message_filters::Subscriber<sensor_msgs::msg::LaserScan_<std::allocator<void> >, rclcpp_lifecycle::LifecycleNode>&, tf2_ros::Buffer&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, int, std::shared_ptr<rclcpp::node_interfaces::NodeLoggingInterface>, std::shared_ptr<rclcpp::node_interfaces::NodeClockInterface>, std::chrono::duration<long, std::ratio<1l, 1000000000l> >&>(message_filters::Subscriber<sensor_msgs::msg::LaserScan_<std::allocator<void> >, rclcpp_lifecycle::LifecycleNode>&, tf2_ros::Buffer&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, int&&, std::shared_ptr<rclcpp::node_interfaces::NodeLoggingInterface>&&, std::shared_ptr<rclcpp::node_interfaces::NodeClockInterface>&&, std::chrono::duration<long, std::ratio<1l, 1000000000l> >&) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x3c407f) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)  Thread T11 created by T0 here:     #0 0x55697b1e87dc in __interceptor_pthread_create (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/nav2_amcl/amcl+0x977dc) (BuildId: 4e1ce3fcf62a6d0e51a98b07383906fe5ca789ec)     #1 0x7ff9b02dc328 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/lib/x86_64-linux-gnu/libstdc++.so.6+0xdc328) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)     #2 0x7ff9b0cd3359 in std::_Sp_counted_ptr_inplace<tf2_ros::TransformListener, std::allocator<tf2_ros::TransformListener>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<tf2_ros::Buffer&>(std::allocator<tf2_ros::TransformListener>, tf2_ros::Buffer&) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x4d3359) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #3 0x7ff9b0b60ad2 in nav2_amcl::AmclNode::initTransforms() (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x360ad2) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #4 0x7ff9b0b59aa9 in nav2_amcl::AmclNode::on_configure(rclcpp_lifecycle::State const&) (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x359aa9) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0)     #5 0x7ff9b1b48b8c  (/opt/ros/humble/lib/librclcpp_lifecycle.so+0x28b8c) (BuildId: ccb1b39efb3eaee63de490386a8850a5752f307d)  Thread T1 created by T0 here:     #0 0x55697b1e87dc in __interceptor_pthread_create (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/nav2_amcl/amcl+0x977dc) (BuildId: 4e1ce3fcf62a6d0e51a98b07383906fe5ca789ec)     #1 0x7ff9b02dc328 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/lib/x86_64-linux-gnu/libstdc++.so.6+0xdc328) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)  SUMMARY: AddressSanitizer: heap-use-after-free (/home/****/ROS_ws/nav2/install/nav2_amcl/lib/libamcl_core.so+0x4f3538) (BuildId: 427f1d8584980a1646cc60c7a8e1d2739c4c5ca0) in message_filters::Signal1<sensor_msgs::msg::LaserScan_<std::allocator<void> > >::call(message_filters::MessageEvent<sensor_msgs::msg::LaserScan_<std::allocator<void> > const> const&) Shadow bytes around the buggy address:   0x0c2e8000bc80: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bc90: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bca0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bcb0: fd fd fd fd fd fa fa fa fa fa fa fa fa fa fa fa   0x0c2e8000bcc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c2e8000bcd0: fd fd fd fd fd fd fd[fd]fd fd fd fd fd fd fd fd   0x0c2e8000bce0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bcf0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bd00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bd10: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd   0x0c2e8000bd20: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==1627006==ABORTING  ``` Additional information  ---   It seems like a shutdown-issue, and caused by the inappropriate Ptr release order  focus on code lines in `AmclNode::on_cleanup()` : [amcl\_node.cpp#L331-L344](https://github.com/ros-planning/navigation2/blob/main/nav2_amcl/src/amcl_node.cpp#L331-L344), the `laser_scan_filter_.reset()` is done before `tf_listener_.reset()`.  SO, If there happens to be a message comming within the interval between two pointers being reset, `tf_listener_` would be in callback-work. And during the work, it would access the `laser_scan_filter_` to filter compliance messages, while the `laser_scan_filter_` has been freed. Finally, it would trigger an error similar to the UAF we reported this time.  a suggestion that may be helpful:   * shall we place `tf_listener_.reset()` before `laser_scan_filter_.reset()` ? |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Jan 25, 2024](#issuecomment-1910404410)

| Sure! Open the PR please |
| --- |

All reactions

Sorry, something went wrong.

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[GoesM](/GoesM)
mentioned this issue
[Jan 25, 2024](#ref-pullrequest-2100760140)

[change pointer free order in amcl to avoid use-after-free bug mentioned in #4068
#4069](/ros-navigation/navigation2/pull/4069)
 Closed

7 tasks

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
closed this as [completed](/ros-navigation/navigation2/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 25, 2024](#event-11600060368)

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[GoesM](/GoesM)
mentioned this issue
[Jan 25, 2024](#ref-pullrequest-2101113725)

[change pointer free order in amcl to avoid use-after-free bug mentioned in #4068
#4070](/ros-navigation/navigation2/pull/4070)
 Merged

7 tasks

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this issue
[Jan 25, 2024](#ref-commit-1348e52)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/commit/1348e526f4c945ea0c64239f78736c71349a5913 "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
…

`[1348e52](/ros-navigation/navigation2/commit/1348e526f4c945ea0c64239f78736c71349a5913)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[BriceRenaudeau](/BriceRenaudeau)
pushed a commit
to BriceRenaudeau/navigation2
that referenced
this issue
[Jan 29, 2024](#ref-commit-3a3ebab)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&v=4)](/BriceRenaudeau)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/BriceRenaudeau/navigation2/commit/3a3ebab25d41487abeaed6e36fb96f41d954e1c8 "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>")`
…

`[3a3ebab](/BriceRenaudeau/navigation2/commit/3a3ebab25d41487abeaed6e36fb96f41d954e1c8)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
```

[BriceRenaudeau](/BriceRenaudeau)
pushed a commit
to BriceRenaudeau/navigation2
that referenced
this issue
[Jan 29, 2024](#ref-commit-43aa44a)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&v=4)](/BriceRenaudeau)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/BriceRenaudeau/navigation2/commit/43aa44affa69cab60daa66d25b4cf3ba9787bc1b "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>")`
…

`[43aa44a](/BriceRenaudeau/navigation2/commit/43aa44affa69cab60daa66d25b4cf3ba9787bc1b)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this issue
[Feb 12, 2024](#ref-commit-5111f98)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[5111f98](/ros-navigation/navigation2/commit/5111f980163104820d1284c06eded88f12b3aa61)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[ajtudela](/ajtudela)
pushed a commit
to grupo-avispa/navigation2
that referenced
this issue
[Mar 7, 2024](#ref-commit-3209c4f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@ajtudela](https://avatars.githubusercontent.com/u/4681902?s=40&v=4)](/ajtudela)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[3209c4f](/grupo-avispa/navigation2/commit/3209c4f80546e8e966bd42c951ee999892ce5b05)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[redvinaa](/redvinaa)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this issue
[Mar 18, 2024](#ref-commit-0989ebe)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@redvinaa](https://avatars.githubusercontent.com/u/60265874?s=40&v=4)](/redvinaa)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[0989ebe](/EnjoyRobotics/navigation2/commit/0989ebe3be65f453264b840c17552a633efe7756)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[stevedanomodolor](/stevedanomodolor)
pushed a commit
to stevedanomodolor/navigation2
that referenced
this issue
[Mar 25, 2024](#ref-commit-fd0477b)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@stevedanomodolor](https://avatars.githubusercontent.com/u/61468301?s=40&v=4)](/stevedanomodolor)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")`
…

`[fd0477b](/stevedanomodolor/navigation2/commit/fd0477b39a04d37cd837cb319ca4df0bee4eb04e)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>
```

[stevedanomodolor](/stevedanomodolor)
added a commit
to stevedanomodolor/navigation2
that referenced
this issue
[Mar 25, 2024](#ref-commit-e1b1f24)
[![@stevedanomodolor](https://avatars.githubusercontent.com/u/61468301?s=40&u=246815559c33886f0a8c9cb96c8eefa2f975b667&v=4)](/stevedanomodolor)

`[Include goal heading mode to allow bidirectional and all direction goals](/stevedanomodolor/navigation2/commit/e1b1f24fed16aede76af1c70f5b52ce4e6d019bb "Include goal heading mode to allow bidirectional and all direction goals

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

[behavior_tree] support both ports and blackboard (#4060)

* check result of blackboard->get and use halTree

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove unused header

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* BT: add port inputs when missing and use getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add description

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* change return value of getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* updated tree XML

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

adding new Friends of Nav2 Sponsors!

Update README.md (#4114)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

CI green P3 (#4117)

Refactors `possible_inscribed_cost` to `possible_circumscribed_cost` in collision checker for smac_planner and mppi_controller (#4113). (#4118)

* Utilizes circumscribed radius to assess potential collision points on the robot.
* Ensures safety when the robot's center is outside the circumscribed radius, eliminating additional checks and optimizing CPU usage.
Signed-off-by: Alan Xue <alan.xuefei@googlemail.com>

Added cast to float to getClosestAngularBin return for behavior consistency (#4123)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

Adding context to MPPI readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

[behavior_tree] Add generate_nav2_tree_nodes_xml (#4073)

* Add generate_nav2_tree_nodes_xml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* behavior_tree: removed list of plugins from yaml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* check result of get_parameter(plugin_lib_names)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix previous commit (uncrustify)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* revert change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Fix compilation with clang (#4131)

Signed-off-by: Ramon Wijnands <ramon.wijnands@nobleo.nl>

code improvement based on feedback. Name changes and minor code improvement

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix goal handle was not freed correctly (#4137)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

Adding Nvidia as Gold Sponsor! (#4144)

Prevent a possible segmentation fault (#4141) (#4147)

* Prevent a possible segmentation fault

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

* Cleanup

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

---------

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

Updating stereolabs logo (#4158)

Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

behavior_tree: migration to BT.CPP 4.5.x (#4128)

* behavior_tree: migration to BT.CPP 4.5.x

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix formatting

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix lint warning

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove setStatus(BT::NodeStatus::IDLE)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* handle SKIPPED state

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix unit tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add emitWakeUpSignal()

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fit test

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* keep resetStatus() in action_node

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add suggestions from peer reviewer

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix compilation

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

bug fix (#4160)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>

Stop planner if the goal is cancelled (#4148)

* Add support for stopping planners when the action is cancelled

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Smac planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Theta* planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Navfn planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Update nav2_system_tests to use cancel checker

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add terminal_checking_interval parameter

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Handle timeout and cancel check on the same branch and default to 5000 iterations

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add system tests for cancel

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

---------

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>
Co-authored-by: Kemal Bektas <kemal.bektas@node-robotics.com>

Improvement on the wat the distance heuristic is calculated

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix BT.CPP import (#4165)

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

improvement based on feedback

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>")`
…

`[e1b1f24](/stevedanomodolor/navigation2/commit/e1b1f24fed16aede76af1c70f5b52ce4e6d019bb)`

```
Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

[behavior_tree] support both ports and blackboard ([ros-navigation#4060](https://github.com/ros-navigation/navigation2/pull/4060))

* check result of blackboard->get and use halTree

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove unused header

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* BT: add port inputs when missing and use getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add description

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* change return value of getInputPortOrBlackboard

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* updated tree XML

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

adding new Friends of Nav2 Sponsors!

Update README.md ([ros-navigation#4114](https://github.com/ros-navigation/navigation2/pull/4114))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

CI green P3 ([ros-navigation#4117](https://github.com/ros-navigation/navigation2/pull/4117))

Refactors `possible_inscribed_cost` to `possible_circumscribed_cost` in collision checker for smac_planner and mppi_controller ([ros-navigation#4113](https://github.com/ros-navigation/navigation2/issues/4113)). ([ros-navigation#4118](https://github.com/ros-navigation/navigation2/pull/4118))

* Utilizes circumscribed radius to assess potential collision points on the robot.
* Ensures safety when the robot's center is outside the circumscribed radius, eliminating additional checks and optimizing CPU usage.
Signed-off-by: Alan Xue <alan.xuefei@googlemail.com>

Added cast to float to getClosestAngularBin return for behavior consistency ([ros-navigation#4123](https://github.com/ros-navigation/navigation2/pull/4123))

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

Adding context to MPPI readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

[behavior_tree] Add generate_nav2_tree_nodes_xml ([ros-navigation#4073](https://github.com/ros-navigation/navigation2/pull/4073))

* Add generate_nav2_tree_nodes_xml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* behavior_tree: removed list of plugins from yaml

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* check result of get_parameter(plugin_lib_names)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix previous commit (uncrustify)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* revert change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

Fix compilation with clang ([ros-navigation#4131](https://github.com/ros-navigation/navigation2/pull/4131))

Signed-off-by: Ramon Wijnands <ramon.wijnands@nobleo.nl>

code improvement based on feedback. Name changes and minor code improvement

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix goal handle was not freed correctly ([ros-navigation#4137](https://github.com/ros-navigation/navigation2/pull/4137))

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

Adding Nvidia as Gold Sponsor! ([ros-navigation#4144](https://github.com/ros-navigation/navigation2/pull/4144))

Prevent a possible segmentation fault ([ros-navigation#4141](https://github.com/ros-navigation/navigation2/issues/4141)) ([ros-navigation#4147](https://github.com/ros-navigation/navigation2/pull/4147))

* Prevent a possible segmentation fault

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

* Cleanup

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

---------

Signed-off-by: Joni Pöllänen <joni.pollanen@karelics.fi>

Updating stereolabs logo ([ros-navigation#4158](https://github.com/ros-navigation/navigation2/pull/4158))

Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

behavior_tree: migration to BT.CPP 4.5.x ([ros-navigation#4128](https://github.com/ros-navigation/navigation2/pull/4128))

* behavior_tree: migration to BT.CPP 4.5.x

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix formatting

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix lint warning

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove setStatus(BT::NodeStatus::IDLE)

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* handle SKIPPED state

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix unit tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add emitWakeUpSignal()

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fit test

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* remove SequenceStar

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* keep resetStatus() in action_node

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* add suggestions from peer reviewer

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* fix compilation

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

bug fix ([ros-navigation#4160](https://github.com/ros-navigation/navigation2/pull/4160))

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>

Stop planner if the goal is cancelled ([ros-navigation#4148](https://github.com/ros-navigation/navigation2/pull/4148))

* Add support for stopping planners when the action is cancelled

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Smac planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Theta* planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Support cancel in Navfn planner

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Update nav2_system_tests to use cancel checker

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add terminal_checking_interval parameter

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Handle timeout and cancel check on the same branch and default to 5000 iterations

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

* Add system tests for cancel

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>

---------

Signed-off-by: Kemal Bektas <kemal.bektas@node-robotics.com>
Co-authored-by: Kemal Bektas <kemal.bektas@node-robotics.com>

Improvement on the wat the distance heuristic is calculated

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>

Fix BT.CPP import ([ros-navigation#4165](https://github.com/ros-navigation/navigation2/pull/4165))

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

improvement based on feedback

Signed-off-by: stevedan <stevedan.o.omodolor@gmail.com>
```

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-dc952dc)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/commit/dc952dc95bec87abb7c1754477e4117aa21a97ed "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
…

`[dc952dc](/ros-navigation/navigation2/commit/dc952dc95bec87abb7c1754477e4117aa21a97ed)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-342ad51)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[342ad51](/ros-navigation/navigation2/commit/342ad51640d904cdf9472e17d1a02756542d031f)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-1dea56b)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/ros-navigation/navigation2/commit/1dea56b2b0ad2abfafffbb1b729d942c73825222 "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
…

`[1dea56b](/ros-navigation/navigation2/commit/1dea56b2b0ad2abfafffbb1b729d942c73825222)`

```
…ed in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-9aec27e)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")[#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>")`
…

`[9aec27e](/ros-navigation/navigation2/commit/9aec27e2a1416302456e4c0dfa619db861885700)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-e6da02f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring)

`[Iron sync 5: April 4, 2024 (](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")[#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")`
…

`[e6da02f](/ros-navigation/navigation2/commit/e6da02fee11bce3a7cec6993f37a357ca49ed33c)`

```
* nav2_controller: add loop rate log ([#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/ros-navigation/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/ros-navigation/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/ros-navigation/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this issue
[Apr 4, 2024](#ref-commit-f41920e)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar)

`[Humble sync 10: April 4, 2024 (](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14 "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[#4241](https://github.com/ros-navigation/navigation2/pull/4241)[)](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14 "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[f41920e](/ros-navigation/navigation2/commit/f41920ee0912bb34caf746f0c8f4773e66bd0f14)`

```
* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[RBT22](/RBT22)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this issue
[Apr 9, 2024](#ref-commit-f72d95b)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@RBT22](https://avatars.githubusercontent.com/u/43723477?s=40&v=4)](/RBT22)

`[Humble sync 10: April 4, 2024 (](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[ros-navigation#4241](https://github.com/ros-navigation/navigation2/pull/4241)[)](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d "Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[f72d95b](/EnjoyRobotics/navigation2/commit/f72d95bd22917ef03c7f59487a7b8ada7155cc6d)`

```
* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[emilnovak](/emilnovak)
pushed a commit
to EnjoyRobotics/navigation2
that referenced
this issue
[Apr 10, 2024](#ref-commit-7046850)
[![@RBT22](https://avatars.githubusercontent.com/u/43723477?s=40&u=33340161802959fa7974a7d29457283e7b1b68f1&v=4)](/RBT22) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[![@thandal](https://avatars.githubusercontent.com/u/2613832?s=40&v=4)](/thandal) [![@antonkesy](https://avatars.githubusercontent.com/u/25124866?s=40&u=3083aaeb13978d3596bbe7798d56221aade670d5&v=4)](/antonkesy) [![@CihatAltiparmak](https://avatars.githubusercontent.com/u/35902471?s=40&u=0fd833e50b9c38b3aea34ac6f309e2e0a80cc1fc&v=4)](/CihatAltiparmak) [![@akchobby](https://avatars.githubusercontent.com/u/44644339?s=40&u=9c2b9d23034ba7075fe5bf72508882411f5bcd55&v=4)](/akchobby) [![@ladianchad](https://avatars.githubusercontent.com/u/60467877?s=40&u=165909f8e6e5923f22f3a1bc61aad3e4025b6927&v=4)](/ladianchad) [![@kevin-floatic](https://avatars.githubusercontent.com/u/89058869?s=40&v=4)](/kevin-floatic) [![@romi2002](https://avatars.githubusercontent.com/u/9159338?s=40&v=4)](/romi2002) [![@mikeferguson](https://avatars.githubusercontent.com/u/899410?s=40&v=4)](/mikeferguson) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@hsong-MLE](https://avatars.githubusercontent.com/u/158601314?s=40&v=4)](/hsong-MLE) [![@iceuw](https://avatars.githubusercontent.com/u/23731407?s=40&v=4)](/iceuw) [![@Chortine](https://avatars.githubusercontent.com/u/107395103?s=40&u=6ab6346d84f11c970344b9efdf2fa4bcc1d08845&v=4)](/Chortine) [![@MikeWrock](https://avatars.githubusercontent.com/u/8420420?s=40&u=c89c87d4f2bf9d6b962934c231b53868c2876a86&v=4)](/MikeWrock) [![@stephanie-eng](https://avatars.githubusercontent.com/u/10466537?s=40&u=5364cffbd08250932482d4fbb6c031741ba683d2&v=4)](/stephanie-eng) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar)

`[Nav2 Sync 3 2024 April 9 (](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2 "Nav2 Sync 3 2024 April 9 (#15)

* Fix #4001 (#4028)

* Humble Sync 9: Jan 23, 2024 (#4064)

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners (#3978)

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS (#4051)

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI (#4099) (#4101)

(cherry picked from commit 8f7b6ceef943c99497c39da341219a67a4796162)

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble (#4119)

* Added cast to float to getClosestAngularBin return for behavior consistency (#4123) (#4125)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit c59e0f362a867244d589562ecff56a9a5f23df59)

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly (#4137) (#4143)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit 2e491b18328ede064c75bfa024f57c7e49578eba)

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix (#4160) (#4162)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit 623434b09f25afac3872411b8fda786a6f6dce95)

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix (#4213) (#4216)

(cherry picked from commit 46ff0ecc4cc7d42cc92477e6159b29d69fd23050)

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) (#4239)

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")[#15](https://github.com/EnjoyRobotics/navigation2/pull/15)[)](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2 "Nav2 Sync 3 2024 April 9 (#15)

* Fix #4001 (#4028)

* Humble Sync 9: Jan 23, 2024 (#4064)

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners (#3978)

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS (#4051)

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI (#4099) (#4101)

(cherry picked from commit 8f7b6ceef943c99497c39da341219a67a4796162)

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble (#4119)

* Added cast to float to getClosestAngularBin return for behavior consistency (#4123) (#4125)

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit c59e0f362a867244d589562ecff56a9a5f23df59)

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly (#4137) (#4143)

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit 2e491b18328ede064c75bfa024f57c7e49578eba)

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix (#4160) (#4162)

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit 623434b09f25afac3872411b8fda786a6f6dce95)

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix (#4213) (#4216)

(cherry picked from commit 46ff0ecc4cc7d42cc92477e6159b29d69fd23050)

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) (#4239)

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 (#4241)

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>")`
…

`[7046850](/EnjoyRobotics/navigation2/commit/70468502a2e6bad988b7d93d206d78affffa9fd2)`

```
* Fix [ros-navigation#4001](https://github.com/ros-navigation/navigation2/issues/4001) ([ros-navigation#4028](https://github.com/ros-navigation/navigation2/pull/4028))

* Humble Sync 9: Jan 23, 2024 ([ros-navigation#4064](https://github.com/ros-navigation/navigation2/pull/4064))

* Update README.md: fix typo ([ros-navigation#3842](https://github.com/ros-navigation/navigation2/pull/3842))

* Update package.xml

* fix typo ([ros-navigation#3850](https://github.com/ros-navigation/navigation2/pull/3850))

* adjust link to point to v3.8 of behavior tree docs ([ros-navigation#3851](https://github.com/ros-navigation/navigation2/pull/3851))

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node ([ros-navigation#3849](https://github.com/ros-navigation/navigation2/pull/3849))

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* simplication of lattice_generator.py, fixes [ros-navigation#3858](https://github.com/ros-navigation/navigation2/issues/3858) ([ros-navigation#3859](https://github.com/ros-navigation/navigation2/pull/3859))

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Fix class doxygen

* fix minor typos ([ros-navigation#3892](https://github.com/ros-navigation/navigation2/pull/3892))

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* fix use after free ([ros-navigation#3910](https://github.com/ros-navigation/navigation2/pull/3910))

* fix build mppi ([ros-navigation#3927](https://github.com/ros-navigation/navigation2/pull/3927))

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* Fixed links for install and build in README ([ros-navigation#3963](https://github.com/ros-navigation/navigation2/pull/3963))

Currently the readme is linking to an invalida page in the docs (404 error).

* fix a few outdated comments in smac planners ([ros-navigation#3978](https://github.com/ros-navigation/navigation2/pull/3978))

* Update README.md

* bump to 1.1.13 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>

* Fixes for compiling with clang on macOS ([ros-navigation#4051](https://github.com/ros-navigation/navigation2/pull/4051))

amcl: declare void parameter for functions with no args

amcl: remove unused variables

behavior_tree: address clang compilation issues

behaviors: add missing override specifier

bt_navigator: add missing override specifier

collision_monitor: address clang compilation issues

constrained_smoother: address clang compilation issues

controller: address clang compilation issues

costmap_2d: add missing override specifier

costmap_2d: address clang compilation issues

costmap_2d: fix link issue for order_layer

dwb_controller: fix clang compile issue, replace ulong with uint32_t

map_server: replace std::experimental::filesystem

map_server: remove dependency on stdc++fs

waypoint_follower: address clang compilation issues

waypoint_follower: remove dependency on stdc++fs

waypoint_follower: replace std::experimental::filesystem

smoother: address clang compilation issues

smoother: remove unused variables

system_tests: remove dependency on stdc++fs

rotation_shim_controller: update percentage arg in setSpeedLimit to boolean

planner: remove unused variables

costmap_2d: address clang compilation issues

mppi_controller: replace use of auto as function param with templates

mppi_controller: address clang compilation issues

costmap_2d: resolve clang issue with std::pair non-const copy

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

* critical fix for path tracking MPPI ([ros-navigation#4099](https://github.com/ros-navigation/navigation2/pull/4099)) ([ros-navigation#4101](https://github.com/ros-navigation/navigation2/pull/4101))

(cherry picked from commit [8f7b6ce](https://github.com/EnjoyRobotics/navigation2/commit/8f7b6ceef943c99497c39da341219a67a4796162))

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* backport graceful controller to humble ([ros-navigation#4119](https://github.com/ros-navigation/navigation2/pull/4119))

* Added cast to float to getClosestAngularBin return for behavior consistency ([ros-navigation#4123](https://github.com/ros-navigation/navigation2/pull/4123)) ([ros-navigation#4125](https://github.com/ros-navigation/navigation2/pull/4125))

* Added cast to float to getClosestAngularBin return for behavior consistency.

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

* Revised test name

Signed-off-by: Hunter Song <hsong@macleanengineering.com>

---------

Signed-off-by: Hunter Song <hsong@macleanengineering.com>
(cherry picked from commit [c59e0f3](https://github.com/EnjoyRobotics/navigation2/commit/c59e0f362a867244d589562ecff56a9a5f23df59))

Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>

* Fix goal handle was not freed correctly ([ros-navigation#4137](https://github.com/ros-navigation/navigation2/pull/4137)) ([ros-navigation#4143](https://github.com/ros-navigation/navigation2/pull/4143))

* Fix goal handle was not freed correctly

* Update nav2_util/include/nav2_util/simple_action_server.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Ziohang <hang.zhou@agvsz.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
(cherry picked from commit [2e491b1](https://github.com/EnjoyRobotics/navigation2/commit/2e491b18328ede064c75bfa024f57c7e49578eba))

Co-authored-by: iceuw <m201770623@hust.edu.cn>

* bug fix ([ros-navigation#4160](https://github.com/ros-navigation/navigation2/pull/4160)) ([ros-navigation#4162](https://github.com/ros-navigation/navigation2/pull/4162))

Signed-off-by: Tianchu <tianchu.zhang0706@gmail.com>
(cherry picked from commit [623434b](https://github.com/EnjoyRobotics/navigation2/commit/623434b09f25afac3872411b8fda786a6f6dce95))

Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>

* Add uint suffix ([ros-navigation#4213](https://github.com/ros-navigation/navigation2/pull/4213)) ([ros-navigation#4216](https://github.com/ros-navigation/navigation2/pull/4216))

(cherry picked from commit [46ff0ec](https://github.com/EnjoyRobotics/navigation2/commit/46ff0ecc4cc7d42cc92477e6159b29d69fd23050))

Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>

* Fix merge conflict in nav2_mppi_controller README (humble) ([ros-navigation#4239](https://github.com/ros-navigation/navigation2/pull/4239))

Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>

* Humble sync 10: April 4, 2024 ([ros-navigation#4241](https://github.com/ros-navigation/navigation2/pull/4241))

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* bump humble to 1.1.14 for sync

* fix merge conflict

* custom version of cost critic's cost method

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Fix graceful humble release version

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix graceful_controller exceptions

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: 정찬희 <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: mergify[bot] <37929162+mergify[bot]@users.noreply.github.com>
Co-authored-by: hsong-MLE <158601314+hsong-MLE@users.noreply.github.com>
Co-authored-by: iceuw <m201770623@hust.edu.cn>
Co-authored-by: Chortine <107395103+Chortine@users.noreply.github.com>
Co-authored-by: Michael Wrock <michael.wrock@picknik.ai>
Co-authored-by: Stephanie Eng <stephanie-eng@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
```

[enricosutera](/enricosutera)
pushed a commit
to enricosutera/navigation2
that referenced
this issue
[May 19, 2024](#ref-commit-b5905a2)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@enricosutera](https://avatars.githubusercontent.com/u/51802424?s=40&v=4)](/enricosutera)

`[change pointer free order in amcl to avoid use-after-free bug mention…](/enricosutera/navigation2/commit/b5905a2475785ee7320bc99d51121d79550f12fc "change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>")`
…

`[b5905a2](/enricosutera/navigation2/commit/b5905a2475785ee7320bc99d51121d79550f12fc)`

```
…ed in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>
```

[enricosutera](/enricosutera)
pushed a commit
to enricosutera/navigation2
that referenced
this issue
[May 19, 2024](#ref-commit-2241d1f)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@enricosutera](https://avatars.githubusercontent.com/u/51802424?s=40&v=4)](/enricosutera)

`[New MPPI Cost Critic (Contrib: Brice Renaudeau) (](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>")[ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090)[)](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523 "New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>")`
…

`[2241d1f](/enricosutera/navigation2/commit/2241d1f583baef83dda15b621983274a19196523)`

```
* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>
Signed-off-by: enricosutera <enricosutera@outlook.com>
```

[maksymdidukh](/maksymdidukh)
pushed a commit
to logivations/navigation2
that referenced
this issue
[Jun 24, 2024](#ref-commit-2e939bc)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@maksymdidukh](https://avatars.githubusercontent.com/u/142302397?s=40&v=4)](/maksymdidukh)

`[Iron sync 5: April 4, 2024 (](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")[ros-navigation#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>")`
…

`[2e939bc](/logivations/navigation2/commit/2e939bca08767e2c514ad410b9cb44c3ba31bc77)`

```
* nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([ros-navigation#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [ros-navigation#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([ros-navigation#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([ros-navigation#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([ros-navigation#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/logivations/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([ros-navigation#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([ros-navigation#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([ros-navigation#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/logivations/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([ros-navigation#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/logivations/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
```

[![@maksymdidukh](https://avatars.githubusercontent.com/u/142302397?s=40&v=4)](/maksymdidukh)
[maksymdidukh](/maksymdidukh)
mentioned this issue
[Jun 24, 2024](#ref-pullrequest-2370199569)

[Backport velocity polygons
logivations/navigation2#71](/logivations/navigation2/pull/71)
 Merged

[Marc-Morcos](/Marc-Morcos)
pushed a commit
to Marc-Morcos/navigation2
that referenced
this issue
[Jul 4, 2024](#ref-commit-a3043bd)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@ARK3r](https://avatars.githubusercontent.com/u/22005547?s=40&u=1bf4ef752e3abb886ba07810eda0d65b43add74d&v=4)](/ARK3r)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@bi0ha2ard](https://avatars.githubusercontent.com/u/9082925?s=40&v=4)](/bi0ha2ard) [![@Mygao](https://avatars.githubusercontent.com/u/9464285?s=40&u=4299ee2056d6ff2f7652e082405398bc108e13ee&v=4)](/Mygao) [![@amock](https://avatars.githubusercontent.com/u/14216982?s=40&u=07f81cc5d44cb2c9bea16b7f05301fe2623347e5&v=4)](/amock) [![@tonynajjar](https://avatars.githubusercontent.com/u/14879660?s=40&u=e29d50db1bac036eae32b30fec612615ccd3791a&v=4)](/tonynajjar) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@kaichie](https://avatars.githubusercontent.com/u/37255935?s=40&v=4)](/kaichie) [![@anaelle-sw](https://avatars.githubusercontent.com/u/63144493?s=40&v=4)](/anaelle-sw) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@pepisg](https://avatars.githubusercontent.com/u/71234974?s=40&u=773ff9d28cda29a4a5e6f4e2b3da0252f70b6843&v=4)](/pepisg) [![@cybaol](https://avatars.githubusercontent.com/u/48387783?s=40&u=30575b3270dab56391b28e065ee4fca6b0bbdfee&v=4)](/cybaol) [![@nfriedrich00](https://avatars.githubusercontent.com/u/69539098?s=40&v=4)](/nfriedrich00) [![@facontidavide](https://avatars.githubusercontent.com/u/2822888?s=40&u=32673e6491cf92b7717752a53d9d0cfc949a2c50&v=4)](/facontidavide) [![@jncfa](https://avatars.githubusercontent.com/u/20467009?s=40&u=a1259d504040835cbd9abe7b69185be924ef4998&v=4)](/jncfa) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=40&v=4)](/Ryanf55) [![@pedro-fuoco](https://avatars.githubusercontent.com/u/62964137?s=40&u=e309ccd5c848eabc604009b3fb77d5a8c852423b&v=4)](/pedro-fuoco) [![@srmainwaring](https://avatars.githubusercontent.com/u/24916364?s=40&u=f97481d27b1e204dc73cff98f2aa3d9967672639&v=4)](/srmainwaring) [![@Marc-Morcos](https://avatars.githubusercontent.com/u/30278842?s=40&v=4)](/Marc-Morcos)

`[Iron sync 5: April 4, 2024 (](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>")[ros-navigation#4240](https://github.com/ros-navigation/navigation2/pull/4240)[)](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071 "Iron sync 5: April 4, 2024 (#4240)

* nav2_controller: add loop rate log (#4171)

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ (#4176)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node (#4178)

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in #4175 (#4180)

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages (#4188)

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call (#4182)

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop (#4191)

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo (#4196)

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed (#4193)

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare (#4203)

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert \"nav2_controller: add loop rate log (#4171)\" (#4210)

This reverts commit 47374622dee01a27e5f9b8ae08f3d19a15de9b3a.

* add polygon_subscribe_transient_local parameter in collision monitor (#4207)

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log (#4228)

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in #4078 (#4079)

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo (#4087)

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon (#3708)

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert \"use switch case\"

This reverts commit 1230ede0dd9f168eb38ea63663f250b1bca2fdbf.

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case (#4098)

* adding progress checker selector BT node (#4109)

* New MPPI Cost Critic (Contrib: Brice Renaudeau) (#4090)

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  (#4055)

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths (#3962)

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in #4068 (#4070)

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings (#4067)

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in \"blackboard->set\" (#4074)

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive (#4065)

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method (#4076)

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher (#4077)

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library (#4072)

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets (#4112)

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI (#4170)

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert \"Add velocity based polygon (#3708)\"

This reverts commit a3ed7456745e38d36966e07182d9e5994143af91.

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>")`
…

`[a3043bd](/Marc-Morcos/navigation2/commit/a3043bdbfc6434e543c1521660415f7f55308071)`

```
* nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))

* update smac_planner README

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* added current controller loop rate logging

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* linting

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* uncrustify lint

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update nav2_controller/src/controller_server.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* completely shutdown inital_pose_sub_ ([ros-navigation#4176](https://github.com/ros-navigation/navigation2/pull/4176))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* chore(nav2_behavior_tree): log actual wait period in bt_action_node ([ros-navigation#4178](https://github.com/ros-navigation/navigation2/pull/4178))

Signed-off-by: Felix <felix@fzeltner.de>
Co-authored-by: Felix <felix@fzeltner.de>

* replace throw-error with error-log to avoid UAF mentioned in [ros-navigation#4175](https://github.com/ros-navigation/navigation2/issues/4175) ([ros-navigation#4180](https://github.com/ros-navigation/navigation2/pull/4180))

* replace throw-error with error-log to avoid UAF

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* fix typo

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* fix typos in description messages ([ros-navigation#4188](https://github.com/ros-navigation/navigation2/pull/4188))

Signed-off-by: Antonio Park <kaypaklabs@gmail.com>

* AMCL: Set an initial guess by service call ([ros-navigation#4182](https://github.com/ros-navigation/navigation2/pull/4182))

* Added initial guess service. Signed-off-by: Alexander Mock

Signed-off-by: Alexander Mock <amock@uos.de>

* - Removed added empty line
- Renamed initialGuessCallback to initialPoseReceivedSrv
- Added new line to SetInitialPose service definition
- Removed mutex from initialPoseReceived
- Cleanup service server

Signed-off-by: Alexander Mock <amock@uos.de>

* added whitespace

Signed-off-by: Alexander Mock <amock@uos.de>

* renamed initial pose service in callback bind

Signed-off-by: Alexander Mock <amock@uos.de>

---------

Signed-off-by: Alexander Mock <amock@uos.de>

* Move lines for pre-computation to outside a loop ([ros-navigation#4191](https://github.com/ros-navigation/navigation2/pull/4191))

Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>

* Fix typo ([ros-navigation#4196](https://github.com/ros-navigation/navigation2/pull/4196))

* Fix BT.CPP import

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update README.md

---------

Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>

* Update footprint iif changed ([ros-navigation#4193](https://github.com/ros-navigation/navigation2/pull/4193))

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix missing param declare ([ros-navigation#4203](https://github.com/ros-navigation/navigation2/pull/4203))

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Revert "nav2_controller: add loop rate log ([ros-navigation#4171](https://github.com/ros-navigation/navigation2/pull/4171))" ([ros-navigation#4210](https://github.com/ros-navigation/navigation2/pull/4210))

This reverts commit [4737462](https://github.com/Marc-Morcos/navigation2/commit/47374622dee01a27e5f9b8ae08f3d19a15de9b3a).

* add polygon_subscribe_transient_local parameter in collision monitor ([ros-navigation#4207](https://github.com/ros-navigation/navigation2/pull/4207))

Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>

* nav2_controller: add loop rate log ([ros-navigation#4228](https://github.com/ros-navigation/navigation2/pull/4228))

* added current loop rate printout

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* remove empty line

Signed-off-by: ARK3r <kermani.areza@gmail.com>

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>

* bump to 1.2.7 for iron sync

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>

* free `map_sub_` before `map_free(map_)` to avoid UAF&&NullPtr bug mentioned in [ros-navigation#4078](https://github.com/ros-navigation/navigation2/issues/4078) ([ros-navigation#4079](https://github.com/ros-navigation/navigation2/pull/4079))

* free `map_sub_` before `map_free(map_)`

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

* reformat

Signed-off-by: GoesM <GoesM@buaa.edu.cn>

---------

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix typo ([ros-navigation#4087](https://github.com/ros-navigation/navigation2/pull/4087))

Fix AttributeError: 'BasicNavigator' object has no attribute '_BasicNavigator__getPathThroughPosesImpl'

Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>

* Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))

* add velocity based polygon

* fix header, copyright and variable name change

* optimise polygon update

* optimise duplicated code with setPolygonShape

* add warning log for uncovered speed

* update feedback

* rename polygon velocity to velocity polygon

* cleanup

* fix typo

* add dynamic support for velocity polygon

* wrap try catch for getting parameters

* update naming and linting

* use switch case

* Revert "use switch case"

This reverts commit [1230ede](https://github.com/Marc-Morcos/navigation2/commit/1230ede0dd9f168eb38ea63663f250b1bca2fdbf).

* fix proper return for invalid parameters

* remove topic parameter for velocity polygon

* fix formatting manually

* continue if points are not defined

* rewrite velocity polygon with polygon base class

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update review comments and description

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add VelocityPolygon to detector node

Signed-off-by: nelson <kaichie.lee@gmail.com>

* review update

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* Update nav2_collision_monitor/src/velocity_polygon.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>

* add velocity polygon tests

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix cpplint

Signed-off-by: nelson <kaichie.lee@gmail.com>

* add in-line comment

Signed-off-by: nelson <kaichie.lee@gmail.com>

* fix push back

Signed-off-by: nelson <kaichie.lee@gmail.com>

* minor change and update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

* update README

Signed-off-by: nelson <kaichie.lee@gmail.com>

---------

Signed-off-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* avoid implicit type case ([ros-navigation#4098](https://github.com/ros-navigation/navigation2/pull/4098))

* adding progress checker selector BT node ([ros-navigation#4109](https://github.com/ros-navigation/navigation2/pull/4109))

* New MPPI Cost Critic (Contrib: Brice Renaudeau) ([ros-navigation#4090](https://github.com/ros-navigation/navigation2/pull/4090))

* Share code

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update inflation_cost_critic.hpp

- copyright
- ifndef

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix lint cpp

- extra space

Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Fix Smac Planner confined collision checker  ([ros-navigation#4055](https://github.com/ros-navigation/navigation2/pull/4055))

* Update collision_checker.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Fix tests

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update test_a_star.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Prevent analytic expansions from shortcutting Smac Planner feasible paths ([ros-navigation#3962](https://github.com/ros-navigation/navigation2/pull/3962))

* a potential solution to smac shortcutting

* costmap reoslution

* some fixes

* completed prototype

* some fixes for collision detection and performance

* completing shortcutting fix

* updating tests

* adding readme

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* change pointer free order in amcl to avoid use-after-free bug mentioned in [ros-navigation#4068](https://github.com/ros-navigation/navigation2/issues/4068) ([ros-navigation#4070](https://github.com/ros-navigation/navigation2/pull/4070))

Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [Smac Planner] Massive Improvement of Behavior for SE2 Footprint Checking (ie non-circular robots) In Confined Settings ([ros-navigation#4067](https://github.com/ros-navigation/navigation2/pull/4067))

* prototype to test SE2 footprint H improvements

* some fixes

* fixed

* invert logic

* Working final prototype to be tested

* complete unit test conversions

* Update inflation_layer.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Adding new Smac paper to readme

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Update README.md

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* [behavior_tree] don't repeat yourself in "blackboard->set" ([ros-navigation#4074](https://github.com/ros-navigation/navigation2/pull/4074))

* don't repeat yourself: templates in tests

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

* misse change

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>

---------

Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Allow path end pose deviation revive ([ros-navigation#4065](https://github.com/ros-navigation/navigation2/pull/4065))

* Support stitching paths in compute path to poses

* Update nav2_planner/src/planner_server.cpp

Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>

* Rename parameter to allow_path_through_poses_goal_deviation

* Fix description

* restore nav2_params

* missing whitespace

* lint fix

* removed parameter

Signed-off-by: gg <josho.wallace@gmail.com>

* Update planner_server.hpp

* Update planner_server.cpp

---------

Signed-off-by: gg <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Updated code to use getInflationLayer() method ([ros-navigation#4076](https://github.com/ros-navigation/navigation2/pull/4076))

* updated code to use getInflationLayer method

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

* Fix linting

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>

---------

Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* 1594 twist stamped publisher ([ros-navigation#4077](https://github.com/ros-navigation/navigation2/pull/4077))

* Add TwistStamped to controller_server via TwistPublisher util

* Add a new util class for publishing either Twist or TwistStamped
* Add a new parameter for selecting to stamp the twist data
* Consume TwistPublisher in nav2_controller

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix small issues

* Unused variable
* Incorrect doxygen

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove stored node and assert

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add tests for node

* Facing timeout even though it does the same thing as velocity smoother test

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add missing spin call to solve timeout

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix copyright (me instead of intel)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add full test coverage with subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused rclcpp fixture

* Can't use it due to needing to join the pub thread after rclcpp shuts down

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in nav2_behaviors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistStamped in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistStamped readme updates to velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add TwistSubscriber implementation

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix syntax errors

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in test_velocity_smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in assisted_teleop

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in collision monitor node

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use TwistSubscriber in velocity smoother

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused code

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* add timestamp and frame_id to TwistStamped message

* Add missing utility include

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document TwistPublisher and TwistSubscriber usage

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Use pass-by-reference

* Instead of std::move(std::unique_ptr<TwistStamped>)

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Finish twist subscriber tests

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Add other constructor and docs

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Fix linter issues

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Manually fix paren alignment

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove GSoC reference

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Document twist bool param in README

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Handle twistPublisher in collision monitor

* Implement behavior in the stamped callback
* Unstamped callback calls the stamped callback
* Switch to unique pointer for publisher

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Convert to using TwistStamped interally

* Use incoming twistStamped timestamp if available
* Convert all internal representations to use TwistStamped

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove nav2_util usage instructions

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Remove unused Twist only subscriber

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* More linter fixes

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Prefer working with unique_ptr for cmd_vel

* This makes it easier to switch to std::move instead of dereference on
  publish

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Completing twist stamped migration

* shared to unique ptr

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* twist add stamps and properly propogated

* nav2_util: fix for compiling with clang

- Resolve error: moving a temporary object prevents copy elision [-Werror,-Wpessimizing-move]

Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>

---------

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Steve Macenski <stevenmacenski@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* Change costmap_queue to shared library ([ros-navigation#4072](https://github.com/ros-navigation/navigation2/pull/4072))

Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>

* fix include of hpp

Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>

* inflation cost optmiizations and cleanu

* rename, add defaults, and docs

* smoke test addition

* lintg

* normalize weight

* update readme

* increment cache

* Update cost_critic.hpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* Update cost_critic.cpp

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

---------

Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Co-authored-by: Kino <cybao292261@163.com>

* Use ament_export_targets for all targets ([ros-navigation#4112](https://github.com/ros-navigation/navigation2/pull/4112))

* Matches new internal ALIAS targets
* Use ALIAS targets for all internal linkage
* Remove unnecessary calls to ament_target_dependencies in test code
* Export includes in proper folders for overlays in colcon

Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>

* Update default recommendation from Obstacles to Cost critic in MPPI ([ros-navigation#4170](https://github.com/ros-navigation/navigation2/pull/4170))

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* fix merge conflict

* Revert "Add velocity based polygon ([ros-navigation#3708](https://github.com/ros-navigation/navigation2/pull/3708))"

This reverts commit [a3ed745](https://github.com/Marc-Morcos/navigation2/commit/a3ed7456745e38d36966e07182d9e5994143af91).

* custom backported version of cost critic inscribed cost

---------

Signed-off-by: ARK3r <kermani.areza@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: Felix <felix@fzeltner.de>
Signed-off-by: Antonio Park <kaypaklabs@gmail.com>
Signed-off-by: Alexander Mock <amock@uos.de>
Signed-off-by: Kyungsik Park <dkalxkwl@gmail.com>
Signed-off-by: Tony Najjar <tony.najjar.1997@gmail.com>
Signed-off-by: Brice <brice.renaudeau@gmail.com>
Signed-off-by: nelson <kaichie.lee@gmail.com>
Signed-off-by: asarazin <anaelle.sarazin@robocc.com>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: cybaol <cybao292261@163.com>
Signed-off-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Signed-off-by: Davide Faconti <davide.faconti@gmail.com>
Signed-off-by: Jose Faria <20467009+jncfa@users.noreply.github.com>
Signed-off-by: Ryan Friedman <ryanfriedman5410+github@gmail.com>
Signed-off-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: Brice Renaudeau <brice.renaudeau@gmail.com>
Co-authored-by: Reza Kermani <kermani.areza@gmail.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: bi0ha2ard <bi0ha2ard@users.noreply.github.com>
Co-authored-by: Felix <felix@fzeltner.de>
Co-authored-by: Antonio Park <kaypaklabs@gmail.com>
Co-authored-by: Alexander Mock <amock@uos.de>
Co-authored-by: Tony Najjar <tony.najjar.1997@gmail.com>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: nelson <kaichie.lee@gmail.com>
Co-authored-by: anaelle-sw <63144493+anaelle-sw@users.noreply.github.com>
Co-authored-by: asarazin <anaelle.sarazin@robocc.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: pepisg <pedro.gonzalez@eia.edu.co>
Co-authored-by: Pedro Alejandro González <71234974+pepisg@users.noreply.github.com>
Co-authored-by: Kino <cybao292261@163.com>
Co-authored-by: nfriedrich00 <69539098+nfriedrich00@users.noreply.github.com>
Co-authored-by: Davide Faconti <davide.faconti@gmail.com>
Co-authored-by: jncfa <20467009+jncfa@users.noreply.github.com>
Co-authored-by: Ryan <ryanfriedman5410+github@gmail.com>
Co-authored-by: pedro-fuoco <pedrofuoco6@gmail.com>
Co-authored-by: Rhys Mainwaring <rhys.mainwaring@me.com>
Signed-off-by: MarcM0 <marc.morcos9@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4068)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=52&v=4)](/SteveMacenski) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=52&v=4)](/GoesM)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5ec4c2b4_20250110_151937.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fblob%2Fmain%2Fnav2_amcl%2Fsrc%2Famcl_node.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fblob%2Fmain%2Fnav2_amcl%2Fsrc%2Famcl_node.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

## Files

 main
## Breadcrumbs

1. [navigation2](/ros-navigation/navigation2/tree/main)
2. /[nav2\_amcl](/ros-navigation/navigation2/tree/main/nav2_amcl)
3. /[src](/ros-navigation/navigation2/tree/main/nav2_amcl/src)
/
# amcl\_node.cpp

 Blame  Blame
## Latest commit

## History

[History](/ros-navigation/navigation2/commits/main/nav2_amcl/src/amcl_node.cpp)1653 lines (1434 loc) · 54.8 KB main
## Breadcrumbs

1. [navigation2](/ros-navigation/navigation2/tree/main)
2. /[nav2\_amcl](/ros-navigation/navigation2/tree/main/nav2_amcl)
3. /[src](/ros-navigation/navigation2/tree/main/nav2_amcl/src)
/
# amcl\_node.cpp

Top
## File metadata and controls

* Code
* Blame

1653 lines (1434 loc) · 54.8 KB[Raw](https://github.com/ros-navigation/navigation2/raw/refs/heads/main/nav2_amcl/src/amcl_node.cpp)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\* \* Copyright (c) 2008, Willow Garage, Inc. \* All rights reserved. \* \* This library is free software; you can redistribute it and/or \* modify it under the terms of the GNU Lesser General Public \* License as published by the Free Software Foundation; either \* version 2.1 of the License, or (at your option) any later version. \* \* This library is distributed in the hope that it will be useful, \* but WITHOUT ANY WARRANTY; without even the implied warranty of \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU \* Lesser General Public License for more details. \* \* You should have received a copy of the GNU Lesser General Public \* License along with this library; if not, write to the Free Software \* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA \* \*/
/\* Author: Brian Gerkey \*/
#include "nav2\_amcl/amcl\_node.hpp"
#include <algorithm>#include <memory>#include <string>#include <utility>#include <vector>
#include "message\_filters/subscriber.hpp"#include "nav2\_amcl/angleutils.hpp"#include "nav2\_util/geometry\_utils.hpp"#include "nav2\_amcl/pf/pf.hpp"#include "nav2\_util/string\_utils.hpp"#include "nav2\_amcl/sensors/laser/laser.hpp"#include "rclcpp/node\_options.hpp"#include "tf2/convert.hpp"#include "tf2/utils.hpp"#include "tf2\_geometry\_msgs/tf2\_geometry\_msgs.hpp"#include "tf2/LinearMath/Transform.hpp"#include "tf2\_ros/buffer.h"#include "tf2\_ros/message\_filter.h"#include "tf2\_ros/transform\_broadcaster.h"#include "tf2\_ros/transform\_listener.h"#include "tf2\_ros/create\_timer\_ros.h"
#include "nav2\_amcl/portable\_utils.hpp"#include "nav2\_util/validate\_messages.hpp"
using rcl\_interfaces::msg::ParameterType;using namespace std::chrono\_literals;
namespace nav2\_amcl{using nav2\_util::geometry\_utils::orientationAroundZAxis;
AmclNode::AmclNode(const rclcpp::NodeOptions & options): nav2\_util::LifecycleNode("amcl", "", options){ RCLCPP\_INFO(get\_logger(), "Creating");
 add\_parameter( "alpha1", rclcpp::ParameterValue(0.2), "This is the alpha1 parameter", "These are additional constraints for alpha1");
 add\_parameter( "alpha2", rclcpp::ParameterValue(0.2), "This is the alpha2 parameter", "These are additional constraints for alpha2");
 add\_parameter( "alpha3", rclcpp::ParameterValue(0.2), "This is the alpha3 parameter", "These are additional constraints for alpha3");
 add\_parameter( "alpha4", rclcpp::ParameterValue(0.2), "This is the alpha4 parameter", "These are additional constraints for alpha4");
 add\_parameter( "alpha5", rclcpp::ParameterValue(0.2), "This is the alpha5 parameter", "These are additional constraints for alpha5");
 add\_parameter( "base\_frame\_id", rclcpp::ParameterValue(std::string("base\_footprint")), "Which frame to use for the robot base");
 add\_parameter("beam\_skip\_distance", rclcpp::ParameterValue(0.5)); add\_parameter("beam\_skip\_error\_threshold", rclcpp::ParameterValue(0.9)); add\_parameter("beam\_skip\_threshold", rclcpp::ParameterValue(0.3)); add\_parameter("do\_beamskip", rclcpp::ParameterValue(false));
 add\_parameter( "global\_frame\_id", rclcpp::ParameterValue(std::string("map")), "The name of the coordinate frame published by the localization system");
 add\_parameter( "lambda\_short", rclcpp::ParameterValue(0.1), "Exponential decay parameter for z\_short part of model");
 add\_parameter( "laser\_likelihood\_max\_dist", rclcpp::ParameterValue(2.0), "Maximum distance to do obstacle inflation on map, for use in likelihood\_field model");
 add\_parameter( "laser\_max\_range", rclcpp::ParameterValue(100.0), "Maximum scan range to be considered", "-1.0 will cause the laser's reported maximum range to be used");
 add\_parameter( "laser\_min\_range", rclcpp::ParameterValue(-1.0), "Minimum scan range to be considered", "-1.0 will cause the laser's reported minimum range to be used");
 add\_parameter( "laser\_model\_type", rclcpp::ParameterValue(std::string("likelihood\_field")), "Which model to use, either beam, likelihood\_field, or likelihood\_field\_prob", "Same as likelihood\_field but incorporates the beamskip feature, if enabled");
 add\_parameter( "set\_initial\_pose", rclcpp::ParameterValue(false), "Causes AMCL to set initial pose from the initial\_pose\* parameters instead of " "waiting for the initial\_pose message");
 add\_parameter( "initial\_pose.x", rclcpp::ParameterValue(0.0), "X coordinate of the initial robot pose in the map frame");
 add\_parameter( "initial\_pose.y", rclcpp::ParameterValue(0.0), "Y coordinate of the initial robot pose in the map frame");
 add\_parameter( "initial\_pose.z", rclcpp::ParameterValue(0.0), "Z coordinate of the initial robot pose in the map frame");
 add\_parameter( "initial\_pose.yaw", rclcpp::ParameterValue(0.0), "Yaw of the initial robot pose in the map frame");
 add\_parameter( "max\_beams", rclcpp::ParameterValue(60), "How many evenly-spaced beams in each scan to be used when updating the filter");
 add\_parameter( "max\_particles", rclcpp::ParameterValue(2000), "Maximum allowed number of particles");
 add\_parameter( "min\_particles", rclcpp::ParameterValue(500), "Minimum allowed number of particles");
 add\_parameter( "odom\_frame\_id", rclcpp::ParameterValue(std::string("odom")), "Which frame to use for odometry");
 add\_parameter("pf\_err", rclcpp::ParameterValue(0.05)); add\_parameter("pf\_z", rclcpp::ParameterValue(0.99));
 add\_parameter( "recovery\_alpha\_fast", rclcpp::ParameterValue(0.0), "Exponential decay rate for the fast average weight filter, used in deciding when to recover " "by adding random poses", "A good value might be 0.1");
 add\_parameter( "recovery\_alpha\_slow", rclcpp::ParameterValue(0.0), "Exponential decay rate for the slow average weight filter, used in deciding when to recover " "by adding random poses", "A good value might be 0.001");
 add\_parameter( "resample\_interval", rclcpp::ParameterValue(1), "Number of filter updates required before resampling");
 add\_parameter("robot\_model\_type", rclcpp::ParameterValue("nav2\_amcl::DifferentialMotionModel"));
 add\_parameter( "save\_pose\_rate", rclcpp::ParameterValue(0.5), "Maximum rate (Hz) at which to store the last estimated pose and covariance to the parameter " "server, in the variables ~initial\_pose\_\* and ~initial\_cov\_\*. This saved pose will be used " "on subsequent runs to initialize the filter", "-1.0 to disable");
 add\_parameter("sigma\_hit", rclcpp::ParameterValue(0.2));
 add\_parameter( "tf\_broadcast", rclcpp::ParameterValue(true), "Set this to false to prevent amcl from publishing the transform between the global frame and " "the odometry frame");
 add\_parameter( "transform\_tolerance", rclcpp::ParameterValue(1.0), "Time with which to post-date the transform that is published, to indicate that this transform " "is valid into the future");
 add\_parameter( "update\_min\_a", rclcpp::ParameterValue(0.2), "Rotational movement required before performing a filter update");
 add\_parameter( "update\_min\_d", rclcpp::ParameterValue(0.25), "Translational movement required before performing a filter update");
 add\_parameter("z\_hit", rclcpp::ParameterValue(0.5)); add\_parameter("z\_max", rclcpp::ParameterValue(0.05)); add\_parameter("z\_rand", rclcpp::ParameterValue(0.5)); add\_parameter("z\_short", rclcpp::ParameterValue(0.05));
 add\_parameter( "always\_reset\_initial\_pose", rclcpp::ParameterValue(false), "Requires that AMCL is provided an initial pose either via topic or initial\_pose\* parameter " "(with parameter set\_initial\_pose: true) when reset. Otherwise, by default AMCL will use the" "last known pose to initialize");
 add\_parameter( "scan\_topic", rclcpp::ParameterValue("scan"), "Topic to subscribe to in order to receive the laser scan for localization");
 add\_parameter( "map\_topic", rclcpp::ParameterValue("map"), "Topic to subscribe to in order to receive the map to localize on");
 add\_parameter( "first\_map\_only", rclcpp::ParameterValue(false), "Set this to true, when you want to load a new map published from the map\_server");
 add\_parameter( "freespace\_downsampling", rclcpp::ParameterValue( false), "Downsample the free space used by the Pose Generator. Use it with large maps to save memory");}
AmclNode::~AmclNode(){}
nav2\_util::CallbackReturnAmclNode::on\_configure(const rclcpp\_lifecycle::State & /\*state\*/){ RCLCPP\_INFO(get\_logger(), "Configuring"); callback\_group\_ = create\_callback\_group( rclcpp::CallbackGroupType::MutuallyExclusive, false); initParameters(); initTransforms(); initParticleFilter(); initLaserScan(); initMessageFilters(); initPubSub(); initServices(); initOdometry(); executor\_ = std::make\_shared<rclcpp::executors::SingleThreadedExecutor>(); executor\_->add\_callback\_group(callback\_group\_, get\_node\_base\_interface()); executor\_thread\_ = std::make\_unique<nav2\_util::NodeThread>(executor\_); return nav2\_util::CallbackReturn::SUCCESS;}
nav2\_util::CallbackReturnAmclNode::on\_activate(const rclcpp\_lifecycle::State & /\*state\*/){ RCLCPP\_INFO(get\_logger(), "Activating");
 // Lifecycle publishers must be explicitly activated pose\_pub\_->on\_activate(); particle\_cloud\_pub\_->on\_activate();
 first\_pose\_sent\_ = false;
 // Keep track of whether we're in the active state. We won't // process incoming callbacks until we are active\_ = true;
 if (set\_initial\_pose\_) { auto msg = std::make\_shared<geometry\_msgs::msg::PoseWithCovarianceStamped>();
 msg->header.stamp = now(); msg->header.frame\_id = global\_frame\_id\_; msg->pose.pose.position.x = initial\_pose\_x\_; msg->pose.pose.position.y = initial\_pose\_y\_; msg->pose.pose.position.z = initial\_pose\_z\_; msg->pose.pose.orientation = orientationAroundZAxis(initial\_pose\_yaw\_);
 initialPoseReceived(msg); } else if (init\_pose\_received\_on\_inactive) { handleInitialPose(last\_published\_pose\_); }
 auto node = shared\_from\_this(); // Add callback for dynamic parameters dyn\_params\_handler\_ = node->add\_on\_set\_parameters\_callback( std::bind( &AmclNode::dynamicParametersCallback, this, std::placeholders::\_1));
 // create bond connection createBond();
 return nav2\_util::CallbackReturn::SUCCESS;}
nav2\_util::CallbackReturnAmclNode::on\_deactivate(const rclcpp\_lifecycle::State & /\*state\*/){ RCLCPP\_INFO(get\_logger(), "Deactivating");
 active\_ = false;
 // Lifecycle publishers must be explicitly deactivated pose\_pub\_->on\_deactivate(); particle\_cloud\_pub\_->on\_deactivate();
 // shutdown and reset dynamic parameter handler remove\_on\_set\_parameters\_callback(dyn\_params\_handler\_.get()); dyn\_params\_handler\_.reset();
 // destroy bond connection destroyBond();
 return nav2\_util::CallbackReturn::SUCCESS;}
nav2\_util::CallbackReturnAmclNode::on\_cleanup(const rclcpp\_lifecycle::State & /\*state\*/){ RCLCPP\_INFO(get\_logger(), "Cleaning up");
 executor\_thread\_.reset();
 // Get rid of the inputs first (services and message filter input), so we // don't continue to process incoming messages global\_loc\_srv\_.reset(); initial\_guess\_srv\_.reset(); nomotion\_update\_srv\_.reset(); initial\_pose\_sub\_.reset(); laser\_scan\_connection\_.disconnect(); tf\_listener\_.reset(); // listener may access lase\_scan\_filter\_, so it should be reset earlier laser\_scan\_filter\_.reset(); laser\_scan\_sub\_.reset();
 // Map map\_sub\_.reset(); // map\_sub\_ may access map\_, so it should be reset earlier if (map\_ != NULL) { map\_free(map\_); map\_ = nullptr; } first\_map\_received\_ = false; free\_space\_indices.resize(0);
 // Transforms tf\_broadcaster\_.reset(); tf\_buffer\_.reset();
 // PubSub pose\_pub\_.reset(); particle\_cloud\_pub\_.reset();
 // Odometry motion\_model\_.reset();
 // Particle Filter pf\_free(pf\_); pf\_ = nullptr;
 // Laser Scan lasers\_.clear(); lasers\_update\_.clear(); frame\_to\_laser\_.clear(); force\_update\_ = true;
 if (set\_initial\_pose\_) { set\_parameter( rclcpp::Parameter( "initial\_pose.x", rclcpp::ParameterValue(last\_published\_pose\_.pose.pose.position.x))); set\_parameter( rclcpp::Parameter( "initial\_pose.y", rclcpp::ParameterValue(last\_published\_pose\_.pose.pose.position.y))); set\_parameter( rclcpp::Parameter( "initial\_pose.z", rclcpp::ParameterValue(last\_published\_pose\_.pose.pose.position.z))); set\_parameter( rclcpp::Parameter( "initial\_pose.yaw", rclcpp::ParameterValue(tf2::getYaw(last\_published\_pose\_.pose.pose.orientation)))); }
 return nav2\_util::CallbackReturn::SUCCESS;}
nav2\_util::CallbackReturnAmclNode::on\_shutdown(const rclcpp\_lifecycle::State & /\*state\*/){ RCLCPP\_INFO(get\_logger(), "Shutting down"); return nav2\_util::CallbackReturn::SUCCESS;}
boolAmclNode::checkElapsedTime(std::chrono::seconds check\_interval, rclcpp::Time last\_time){ rclcpp::Duration elapsed\_time = now() - last\_time; if (elapsed\_time.nanoseconds() \* 1e-9 > check\_interval.count()) { return true; } return false;}
#if NEW\_UNIFORM\_SAMPLINGstd::vector<AmclNode::Point2D> AmclNode::free\_space\_indices;#endif
boolAmclNode::getOdomPose( geometry\_msgs::msg::PoseStamped & odom\_pose, double & x, double & y, double & yaw, const rclcpp::Time & sensor\_timestamp, const std::string & frame\_id){ // Get the robot's pose geometry\_msgs::msg::PoseStamped ident; ident.header.frame\_id = nav2\_util::strip\_leading\_slash(frame\_id); ident.header.stamp = sensor\_timestamp; tf2::toMsg(tf2::Transform::getIdentity(), ident.pose);
 try { tf\_buffer\_->transform(ident, odom\_pose, odom\_frame\_id\_); } catch (tf2::TransformException & e) { ++scan\_error\_count\_; if (scan\_error\_count\_ % 20 == 0) { RCLCPP\_ERROR( get\_logger(), "(%d) consecutive laser scan transforms failed: (%s)", scan\_error\_count\_, e.what()); } return false; }
 scan\_error\_count\_ = 0; // reset since we got a good transform x = odom\_pose.pose.position.x; y = odom\_pose.pose.position.y; yaw = tf2::getYaw(odom\_pose.pose.orientation);
 return true;}
pf\_vector\_tAmclNode::uniformPoseGenerator(void \* arg){ map\_t \* map = reinterpret\_cast<map\_t \*>(arg);
#if NEW\_UNIFORM\_SAMPLING unsigned int rand\_index = drand48() \* free\_space\_indices.size(); AmclNode::Point2D free\_point = free\_space\_indices[rand\_index]; pf\_vector\_t p; p.v[0] = MAP\_WXGX(map, free\_point.x); p.v[1] = MAP\_WYGY(map, free\_point.y); p.v[2] = drand48() \* 2 \* M\_PI - M\_PI;#else double min\_x, max\_x, min\_y, max\_y;
 min\_x = (map->size\_x \* map->scale) / 2.0 - map->origin\_x; max\_x = (map->size\_x \* map->scale) / 2.0 + map->origin\_x; min\_y = (map->size\_y \* map->scale) / 2.0 - map->origin\_y; max\_y = (map->size\_y \* map->scale) / 2.0 + map->origin\_y;
 pf\_vector\_t p;
 RCLCPP\_DEBUG(get\_logger(), "Generating new uniform sample"); for (;; ) { p.v[0] = min\_x + drand48() \* (max\_x - min\_x); p.v[1] = min\_y + drand48() \* (max\_y - min\_y); p.v[2] = drand48() \* 2 \* M\_PI - M\_PI; // Check that it's a free cell int i, j; i = MAP\_GXWX(map, p.v[0]); j = MAP\_GYWY(map, p.v[1]); if (MAP\_VALID(map, i, j) && (map->cells[MAP\_INDEX(map, i, j)].occ\_state == -1)) { break; } }#endif return p;}
voidAmclNode::globalLocalizationCallback( const std::shared\_ptr<rmw\_request\_id\_t>/\*request\_header\*/, const std::shared\_ptr<std\_srvs::srv::Empty::Request>/\*req\*/, std::shared\_ptr<std\_srvs::srv::Empty::Response>/\*res\*/){ std::lock\_guard<std::recursive\_mutex> cfl(mutex\_);
 RCLCPP\_INFO(get\_logger(), "Initializing with uniform distribution");
 pf\_init\_model( pf\_, (pf\_init\_model\_fn\_t)AmclNode::uniformPoseGenerator, reinterpret\_cast<void \*>(map\_)); RCLCPP\_INFO(get\_logger(), "Global initialisation done!"); initial\_pose\_is\_known\_ = true; pf\_init\_ = false;}
voidAmclNode::initialPoseReceivedSrv( const std::shared\_ptr<rmw\_request\_id\_t>/\*request\_header\*/, const std::shared\_ptr<nav2\_msgs::srv::SetInitialPose::Request> req, std::shared\_ptr<nav2\_msgs::srv::SetInitialPose::Response>/\*res\*/){ initialPoseReceived(std::make\_shared<geometry\_msgs::msg::PoseWithCovarianceStamped>(req->pose));}
// force nomotion updates (amcl updating without requiring motion)voidAmclNode::nomotionUpdateCallback( const std::shared\_ptr<rmw\_request\_id\_t>/\*request\_header\*/, const std::shared\_ptr<std\_srvs::srv::Empty::Request>/\*req\*/, std::shared\_ptr<std\_srvs::srv::Empty::Response>/\*res\*/){ RCLCPP\_INFO(get\_logger(), "Requesting no-motion update"); force\_update\_ = true;}
voidAmclNode::initialPoseReceived(geometry\_msgs::msg::PoseWithCovarianceStamped::SharedPtr msg){ std::lock\_guard<std::recursive\_mutex> cfl(mutex\_);
 RCLCPP\_INFO(get\_logger(), "initialPoseReceived");
 if (!nav2\_util::validateMsg(\*msg)) { RCLCPP\_ERROR(get\_logger(), "Received initialpose message is malformed. Rejecting."); return; } if (nav2\_util::strip\_leading\_slash(msg->header.frame\_id) != global\_frame\_id\_) { RCLCPP\_WARN( get\_logger(), "Ignoring initial pose in frame \"%s\"; initial poses must be in the global frame, \"%s\"", nav2\_util::strip\_leading\_slash(msg->header.frame\_id).c\_str(), global\_frame\_id\_.c\_str()); return; } if (first\_map\_received\_ && (abs(msg->pose.pose.position.x) > map\_->size\_x || abs(msg->pose.pose.position.y) > map\_->size\_y)) { RCLCPP\_ERROR( get\_logger(), "Received initialpose from message is out of the size of map. Rejecting."); return; }
 // Overriding last published pose to initial pose last\_published\_pose\_ = \*msg;
 if (!active\_) { init\_pose\_received\_on\_inactive = true; RCLCPP\_WARN( get\_logger(), "Received initial pose request, " "but AMCL is not yet in the active state"); return; } handleInitialPose(\*msg);}
voidAmclNode::handleInitialPose(geometry\_msgs::msg::PoseWithCovarianceStamped & msg){ std::lock\_guard<std::recursive\_mutex> cfl(mutex\_); // In case the client sent us a pose estimate in the past, integrate the // intervening odometric change. geometry\_msgs::msg::TransformStamped tx\_odom; try { rclcpp::Time rclcpp\_time = now(); tf2::TimePoint tf2\_time(std::chrono::nanoseconds(rclcpp\_time.nanoseconds()));
 // Check if the transform is available tx\_odom = tf\_buffer\_->lookupTransform( base\_frame\_id\_, tf2\_ros::fromMsg(msg.header.stamp), base\_frame\_id\_, tf2\_time, odom\_frame\_id\_); } catch (tf2::TransformException & e) { // If we've never sent a transform, then this is normal, because the // global\_frame\_id\_ frame doesn't exist. We only care about in-time // transformation for on-the-move pose-setting, so ignoring this // startup condition doesn't really cost us anything. if (sent\_first\_transform\_) { RCLCPP\_WARN(get\_logger(), "Failed to transform initial pose in time (%s)", e.what()); } tf2::impl::Converter<false, true>::convert(tf2::Transform::getIdentity(), tx\_odom.transform); }
 tf2::Transform tx\_odom\_tf2; tf2::impl::Converter<true, false>::convert(tx\_odom.transform, tx\_odom\_tf2);
 tf2::Transform pose\_old; tf2::impl::Converter<true, false>::convert(msg.pose.pose, pose\_old);
 tf2::Transform pose\_new = pose\_old \* tx\_odom\_tf2;
 // Transform into the global frame
 RCLCPP\_INFO( get\_logger(), "Setting pose (%.6f): %.3f %.3f %.3f", now().nanoseconds() \* 1e-9, pose\_new.getOrigin().x(), pose\_new.getOrigin().y(), tf2::getYaw(pose\_new.getRotation()));
 // Re-initialize the filter pf\_vector\_t pf\_init\_pose\_mean = pf\_vector\_zero(); pf\_init\_pose\_mean.v[0] = pose\_new.getOrigin().x(); pf\_init\_pose\_mean.v[1] = pose\_new.getOrigin().y(); pf\_init\_pose\_mean.v[2] = tf2::getYaw(pose\_new.getRotation());
 pf\_matrix\_t pf\_init\_pose\_cov = pf\_matrix\_zero(); // Copy in the covariance, converting from 6-D to 3-D for (int i = 0; i < 2; i++) { for (int j = 0; j < 2; j++) { pf\_init\_pose\_cov.m[i][j] = msg.pose.covariance[6 \* i + j]; } }
 pf\_init\_pose\_cov.m[2][2] = msg.pose.covariance[6 \* 5 + 5];
 pf\_init(pf\_, pf\_init\_pose\_mean, pf\_init\_pose\_cov); pf\_init\_ = false; init\_pose\_received\_on\_inactive = false; initial\_pose\_is\_known\_ = true;}
voidAmclNode::laserReceived(sensor\_msgs::msg::LaserScan::ConstSharedPtr laser\_scan){ std::lock\_guard<std::recursive\_mutex> cfl(mutex\_);
 // Since the sensor data is continually being published by the simulator or robot, // we don't want our callbacks to fire until we're in the active state if (!active\_) {return;} if (!first\_map\_received\_) { if (checkElapsedTime(2s, last\_time\_printed\_msg\_)) { RCLCPP\_WARN(get\_logger(), "Waiting for map...."); last\_time\_printed\_msg\_ = now(); } return; }
 std::string laser\_scan\_frame\_id = nav2\_util::strip\_leading\_slash(laser\_scan->header.frame\_id); last\_laser\_received\_ts\_ = now(); int laser\_index = -1; geometry\_msgs::msg::PoseStamped laser\_pose;
 // Do we have the base->base\_laser Tx yet? if (frame\_to\_laser\_.find(laser\_scan\_frame\_id) == frame\_to\_laser\_.end()) { if (!addNewScanner(laser\_index, laser\_scan, laser\_scan\_frame\_id, laser\_pose)) { return; // could not find transform } } else { // we have the laser pose, retrieve laser index laser\_index = frame\_to\_laser\_[laser\_scan->header.frame\_id]; }
 // Where was the robot when this scan was taken? pf\_vector\_t pose; if (!getOdomPose( latest\_odom\_pose\_, pose.v[0], pose.v[1], pose.v[2], laser\_scan->header.stamp, base\_frame\_id\_)) { RCLCPP\_ERROR(get\_logger(), "Couldn't determine robot's pose associated with laser scan"); return; }
 pf\_vector\_t delta = pf\_vector\_zero(); bool force\_publication = false; if (!pf\_init\_) { // Pose at last filter update pf\_odom\_pose\_ = pose; pf\_init\_ = true;
 for (unsigned int i = 0; i < lasers\_update\_.size(); i++) { lasers\_update\_[i] = true; }
 force\_publication = true; resample\_count\_ = 0; } else { // Set the laser update flags if (shouldUpdateFilter(pose, delta)) { for (unsigned int i = 0; i < lasers\_update\_.size(); i++) { lasers\_update\_[i] = true; } } if (lasers\_update\_[laser\_index]) { motion\_model\_->odometryUpdate(pf\_, pose, delta); } force\_update\_ = false; }
 bool resampled = false;
 // If the robot has moved, update the filter if (lasers\_update\_[laser\_index]) { updateFilter(laser\_index, laser\_scan, pose);
 // Resample the particles if (!(++resample\_count\_ % resample\_interval\_)) { pf\_update\_resample(pf\_, reinterpret\_cast<void \*>(map\_)); resampled = true; }
 pf\_sample\_set\_t \* set = pf\_->sets + pf\_->current\_set; RCLCPP\_DEBUG(get\_logger(), "Num samples: %d\n", set->sample\_count);
 if (!force\_update\_) { publishParticleCloud(set); } } if (resampled || force\_publication || !first\_pose\_sent\_) { amcl\_hyp\_t max\_weight\_hyps; std::vector<amcl\_hyp\_t> hyps; int max\_weight\_hyp = -1; if (getMaxWeightHyp(hyps, max\_weight\_hyps, max\_weight\_hyp)) { publishAmclPose(laser\_scan, hyps, max\_weight\_hyp); calculateMaptoOdomTransform(laser\_scan, hyps, max\_weight\_hyp);
 if (tf\_broadcast\_ == true) { // We want to send a transform that is good up until a // tolerance time so that odom can be used auto stamp = tf2\_ros::fromMsg(laser\_scan->header.stamp); tf2::TimePoint transform\_expiration = stamp + transform\_tolerance\_; sendMapToOdomTransform(transform\_expiration); sent\_first\_transform\_ = true; } } else { RCLCPP\_ERROR(get\_logger(), "No pose!"); } } else if (latest\_tf\_valid\_) { if (tf\_broadcast\_ == true) { // Nothing changed, so we'll just republish the last transform, to keep // everybody happy. tf2::TimePoint transform\_expiration = tf2\_ros::fromMsg(laser\_scan->header.stamp) + transform\_tolerance\_; sendMapToOdomTransform(transform\_expiration); } }}
bool AmclNode::addNewScanner( int & laser\_index, const sensor\_msgs::msg::LaserScan::ConstSharedPtr & laser\_scan, const std::string & laser\_scan\_frame\_id, geometry\_msgs::msg::PoseStamped & laser\_pose){ lasers\_.push\_back(createLaserObject()); lasers\_update\_.push\_back(true); laser\_index = frame\_to\_laser\_.size();
 geometry\_msgs::msg::PoseStamped ident; ident.header.frame\_id = laser\_scan\_frame\_id; ident.header.stamp = rclcpp::Time(); tf2::toMsg(tf2::Transform::getIdentity(), ident.pose); try { tf\_buffer\_->transform(ident, laser\_pose, base\_frame\_id\_, transform\_tolerance\_); } catch (tf2::TransformException & e) { RCLCPP\_ERROR( get\_logger(), "Couldn't transform from %s to %s, " "even though the message notifier is in use: (%s)", laser\_scan->header.frame\_id.c\_str(), base\_frame\_id\_.c\_str(), e.what()); return false; }
 pf\_vector\_t laser\_pose\_v; laser\_pose\_v.v[0] = laser\_pose.pose.position.x; laser\_pose\_v.v[1] = laser\_pose.pose.position.y; // laser mounting angle gets computed later -> set to 0 here! laser\_pose\_v.v[2] = 0; lasers\_[laser\_index]->SetLaserPose(laser\_pose\_v); frame\_to\_laser\_[laser\_scan->header.frame\_id] = laser\_index; return true;}
bool AmclNode::shouldUpdateFilter(const pf\_vector\_t pose, pf\_vector\_t & delta){ delta.v[0] = pose.v[0] - pf\_odom\_pose\_.v[0]; delta.v[1] = pose.v[1] - pf\_odom\_pose\_.v[1]; delta.v[2] = angleutils::angle\_diff(pose.v[2], pf\_odom\_pose\_.v[2]);
 // See if we should update the filter bool update = fabs(delta.v[0]) > d\_thresh\_ || fabs(delta.v[1]) > d\_thresh\_ || fabs(delta.v[2]) > a\_thresh\_; update = update || force\_update\_; return update;}
bool AmclNode::updateFilter( const int & laser\_index, const sensor\_msgs::msg::LaserScan::ConstSharedPtr & laser\_scan, const pf\_vector\_t & pose){ nav2\_amcl::LaserData ldata; ldata.laser = lasers\_[laser\_index]; ldata.range\_count = laser\_scan->ranges.size(); // To account for lasers that are mounted upside-down, we determine the // min, max, and increment angles of the laser in the base frame. // // Construct min and max angles of laser, in the base\_link frame. // Here we set the roll pich yaw of the lasers. We assume roll and pich are zero. geometry\_msgs::msg::QuaternionStamped min\_q, inc\_q; min\_q.header.stamp = laser\_scan->header.stamp; min\_q.header.frame\_id = nav2\_util::strip\_leading\_slash(laser\_scan->header.frame\_id); min\_q.quaternion = orientationAroundZAxis(laser\_scan->angle\_min);
 inc\_q.header = min\_q.header; inc\_q.quaternion = orientationAroundZAxis(laser\_scan->angle\_min + laser\_scan->angle\_increment); try { tf\_buffer\_->transform(min\_q, min\_q, base\_frame\_id\_); tf\_buffer\_->transform(inc\_q, inc\_q, base\_frame\_id\_); } catch (tf2::TransformException & e) { RCLCPP\_WARN( get\_logger(), "Unable to transform min/max laser angles into base frame: %s", e.what()); return false; } double angle\_min = tf2::getYaw(min\_q.quaternion); double angle\_increment = tf2::getYaw(inc\_q.quaternion) - angle\_min;
 // wrapping angle to [-pi .. pi] angle\_increment = fmod(angle\_increment + 5 \* M\_PI, 2 \* M\_PI) - M\_PI;
 RCLCPP\_DEBUG( get\_logger(), "Laser %d angles in base frame: min: %.3f inc: %.3f", laser\_index, angle\_min, angle\_increment);
 // Check the validity of range\_max, must > 0.0 if (laser\_scan->range\_max <= 0.0) { RCLCPP\_WARN( get\_logger(), "wrong range\_max of laser\_scan data: %f. The message could be malformed." " Ignore this message and stop updating.", laser\_scan->range\_max); return false; }
 // Apply range min/max thresholds, if the user supplied them if (laser\_max\_range\_ > 0.0) { ldata.range\_max = std::min(laser\_scan->range\_max, static\_cast<float>(laser\_max\_range\_)); } else { ldata.range\_max = laser\_scan->range\_max; } double range\_min; if (laser\_min\_range\_ > 0.0) { range\_min = std::max(laser\_scan->range\_min, static\_cast<float>(laser\_min\_range\_)); } else { range\_min = laser\_scan->range\_min; }
 // The LaserData destructor will free this memory ldata.ranges = new double[ldata.range\_count][2]; for (int i = 0; i < ldata.range\_count; i++) { // amcl doesn't (yet) have a concept of min range. So we'll map short // readings to max range. if (laser\_scan->ranges[i] <= range\_min) { ldata.ranges[i][0] = ldata.range\_max; } else { ldata.ranges[i][0] = laser\_scan->ranges[i]; } // Compute bearing ldata.ranges[i][1] = angle\_min + (i \* angle\_increment); } lasers\_[laser\_index]->sensorUpdate(pf\_, reinterpret\_cast<nav2\_amcl::LaserData \*>(&ldata)); lasers\_update\_[laser\_index] = false; pf\_odom\_pose\_ = pose; return true;}
voidAmclNode::publishParticleCloud(const pf\_sample\_set\_t \* set){ // If initial pose is not known, AMCL does not know the current pose if (!initial\_pose\_is\_known\_) {return;} auto cloud\_with\_weights\_msg = std::make\_unique<nav2\_msgs::msg::ParticleCloud>(); cloud\_with\_weights\_msg->header.stamp = this->now(); cloud\_with\_weights\_msg->header.frame\_id = global\_frame\_id\_; cloud\_with\_weights\_msg->particles.resize(set->sample\_count);
 for (int i = 0; i < set->sample\_count; i++) { cloud\_with\_weights\_msg->particles[i].pose.position.x = set->samples[i].pose.v[0]; cloud\_with\_weights\_msg->particles[i].pose.position.y = set->samples[i].pose.v[1]; cloud\_with\_weights\_msg->particles[i].pose.position.z = 0; cloud\_with\_weights\_msg->particles[i].pose.orientation = orientationAroundZAxis( set->samples[i].pose.v[2]); cloud\_with\_weights\_msg->particles[i].weight = set->samples[i].weight; }
 particle\_cloud\_pub\_->publish(std::move(cloud\_with\_weights\_msg));}
boolAmclNode::getMaxWeightHyp( std::vector<amcl\_hyp\_t> & hyps, amcl\_hyp\_t & max\_weight\_hyps, int & max\_weight\_hyp){ // Read out the current hypotheses double max\_weight = 0.0; hyps.resize(pf\_->sets[pf\_->current\_set].cluster\_count); for (int hyp\_count = 0; hyp\_count < pf\_->sets[pf\_->current\_set].cluster\_count; hyp\_count++) { double weight; pf\_vector\_t pose\_mean; pf\_matrix\_t pose\_cov; if (!pf\_get\_cluster\_stats(pf\_, hyp\_count, &weight, &pose\_mean, &pose\_cov)) { RCLCPP\_ERROR(get\_logger(), "Couldn't get stats on cluster %d", hyp\_count); return false; }
 hyps[hyp\_count].weight = weight; hyps[hyp\_count].pf\_pose\_mean = pose\_mean; hyps[hyp\_count].pf\_pose\_cov = pose\_cov;
 if (hyps[hyp\_count].weight > max\_weight) { max\_weight = hyps[hyp\_count].weight; max\_weight\_hyp = hyp\_count; } }
 if (max\_weight > 0.0) { RCLCPP\_DEBUG( get\_logger(), "Max weight pose: %.3f %.3f %.3f", hyps[max\_weight\_hyp].pf\_pose\_mean.v[0], hyps[max\_weight\_hyp].pf\_pose\_mean.v[1], hyps[max\_weight\_hyp].pf\_pose\_mean.v[2]);
 max\_weight\_hyps = hyps[max\_weight\_hyp]; return true; } return false;}
voidAmclNode::publishAmclPose( const sensor\_msgs::msg::LaserScan::ConstSharedPtr & laser\_scan, const std::vector<amcl\_hyp\_t> & hyps, const int & max\_weight\_hyp){ // If initial pose is not known, AMCL does not know the current pose if (!initial\_pose\_is\_known\_) { if (checkElapsedTime(2s, last\_time\_printed\_msg\_)) { RCLCPP\_WARN( get\_logger(), "AMCL cannot publish a pose or update the transform. " "Please set the initial pose..."); last\_time\_printed\_msg\_ = now(); } return; }
 auto p = std::make\_unique<geometry\_msgs::msg::PoseWithCovarianceStamped>(); // Fill in the header p->header.frame\_id = global\_frame\_id\_; p->header.stamp = laser\_scan->header.stamp; // Copy in the pose p->pose.pose.position.x = hyps[max\_weight\_hyp].pf\_pose\_mean.v[0]; p->pose.pose.position.y = hyps[max\_weight\_hyp].pf\_pose\_mean.v[1]; p->pose.pose.orientation = orientationAroundZAxis(hyps[max\_weight\_hyp].pf\_pose\_mean.v[2]); // Copy in the covariance, converting from 3-D to 6-D pf\_sample\_set\_t \* set = pf\_->sets + pf\_->current\_set; for (int i = 0; i < 2; i++) { for (int j = 0; j < 2; j++) { // Report the overall filter covariance, rather than the // covariance for the highest-weight cluster // p->covariance[6\*i+j] = hyps[max\_weight\_hyp].pf\_pose\_cov.m[i][j]; p->pose.covariance[6 \* i + j] = set->cov.m[i][j]; } } p->pose.covariance[6 \* 5 + 5] = set->cov.m[2][2]; float temp = 0.0; for (auto covariance\_value : p->pose.covariance) { temp += covariance\_value; } temp += p->pose.pose.position.x + p->pose.pose.position.y; if (!std::isnan(temp)) { RCLCPP\_DEBUG(get\_logger(), "Publishing pose"); last\_published\_pose\_ = \*p; first\_pose\_sent\_ = true; pose\_pub\_->publish(std::move(p)); } else { RCLCPP\_WARN( get\_logger(), "AMCL covariance or pose is NaN, likely due to an invalid " "configuration or faulty sensor measurements! Pose is not available!"); }
 RCLCPP\_DEBUG( get\_logger(), "New pose: %6.3f %6.3f %6.3f", hyps[max\_weight\_hyp].pf\_pose\_mean.v[0], hyps[max\_weight\_hyp].pf\_pose\_mean.v[1], hyps[max\_weight\_hyp].pf\_pose\_mean.v[2]);}
voidAmclNode::calculateMaptoOdomTransform( const sensor\_msgs::msg::LaserScan::ConstSharedPtr & laser\_scan, const std::vector<amcl\_hyp\_t> & hyps, const int & max\_weight\_hyp){ // subtracting base to odom from map to base and send map to odom instead geometry\_msgs::msg::PoseStamped odom\_to\_map;[View remainder of file in raw view](https://github.com/ros-navigation/navigation2/raw/refs/heads/main/nav2_amcl/src/amcl_node.cpp)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


