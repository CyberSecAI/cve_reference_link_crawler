```
{
  "cveId": "CVE-2024-36904",
  "baseScore": "7.0",
  "impactScore": "5.9",
  "exploitabilityScore": "1.0",
  "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "description": "A use-after-free vulnerability exists in the Linux kernel's TCP handling, specifically within the tcp_twsk_unique() function. This function is responsible for checking if a TIME-WAIT socket can be reused during a new connection attempt. The vulnerability stems from a race condition introduced by commit ec94c2696f0b, where inet_twsk_hashdance() sets the socket's sk_refcnt after placing it in the ehash and releasing the bucket lock. This creates a window where other threads can attempt to reuse the port via connect() and call sock_hold() on a TIME-WAIT socket that has a zero refcount. Consequently, the refcount taken by tcp_twsk_unique() can be overwritten, leading to an underflow in sock_put() and triggering a use-after-free elsewhere in the code.",
  "vulnerabilityDetails": {
    "rootCause": "Race condition in refcount handling of TIME-WAIT sockets during port reuse.",
    "weaknesses": [
      "Use-after-free",
      "Race Condition",
	  "Incorrect Reference Counting"
    ],
    "impact": "The vulnerability can lead to a use-after-free condition, potentially resulting in a denial of service (DoS), privilege escalation or information disclosure.",
    "attackVectors": "Local exploitation via a TCP connect attempt, triggering the port reuse mechanism.",
    "attackerCapabilities": "Requires a local attacker with the ability to initiate TCP connections. The attacker needs to be able to trigger a port reuse attempt during the race window.",
	"affectedComponents": [
		"net/ipv4/tcp_ipv4.c"
	]
  },
  "affectedProducts": [
	  "AFF Baseboard Management Controller (BMC) - A700s",
	  "E-Series SANtricity OS Controller Software 11.x",
	  "FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400"
  ],
  "fixes": [
    "The vulnerability was addressed by replacing the direct sock_hold() with refcount_inc_not_zero(). If refcount_inc_not_zero() returns false, the port reuse attempt is aborted."
  ],
   "additionalNotes": [
    "The vulnerability was reported by Anderson Nascimento.",
	"The fix was suggested by Eric Dumazet."
  ]
}
```