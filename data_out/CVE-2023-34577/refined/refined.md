- **Root cause of vulnerability**: The `OpartPlannedPopupModuleFrontController::prepareHook()` method in the "Opart planned popup" module for PrestaShop has SQL calls that are vulnerable to SQL injection. The `display_order` parameter is not properly sanitized before being used in a SQL query.

- **Weaknesses/vulnerabilities present**:
    - SQL Injection (CWE-89): The module uses user-controlled input (`$current_step`) directly in a SQL query without proper sanitization.
- **Impact of exploitation**:
    - Obtain admin access
    - Remove data from the associated PrestaShop
    - Copy/paste data from sensitive tables to the front end, exposing tokens and unlocking admin's AJAX scripts
    - Rewrite SMTP settings to hijack emails
- **Attack vectors**:
    - Network-based attack via HTTP requests to the vulnerable controller. The specific controller path can be concealed during the exploit, as the request will appear as "POST /" in conventional frontend logs.
- **Required attacker capabilities/position**:
    - No privileges required, guest user can exploit the vulnerability.
    - No user interaction required.