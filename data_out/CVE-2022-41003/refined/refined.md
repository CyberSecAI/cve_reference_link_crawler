The content is related to CVE-2022-41003.

**Root cause of vulnerability:**
The vulnerability is caused by a stack-based buffer overflow in the `DetranCLI` command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. Specifically, the `sprintf` function is used to format strings into a fixed-size stack buffer without proper size checks on the input parameters, which are derived from user-supplied command arguments.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow (CWE-120) in the `ip nat outside source` command.
- Lack of input validation and size checking when using `sprintf` to format strings.
- The `sprintf` function is used to copy user-supplied data into fixed-size buffers on the stack without proper checks.
- The vulnerable code is within the `DetranCLI` binary which handles user commands.

**Impact of exploitation:**
Successful exploitation of this vulnerability can lead to arbitrary command execution on the device, potentially allowing a malicious actor to gain full control of the router. This could lead to data theft, denial of service, or other malicious activities.

**Attack vectors:**
An attacker can exploit the vulnerability by sending a specially-crafted network packet with the `ip nat outside source` command to the router's CLI interface.

**Required attacker capabilities/position:**
- The attacker needs to be able to send network packets to the router's CLI interface.
- The attacker needs to have knowledge of the specific vulnerable command template: `ip nat outside source (udp|tcp|all) (WORD|null) WORD to A.B.C.D (WORD|null) description (WORD|null)`
- The attacker requires a user with high privileges (indicated by the CVSS score "PR:H").