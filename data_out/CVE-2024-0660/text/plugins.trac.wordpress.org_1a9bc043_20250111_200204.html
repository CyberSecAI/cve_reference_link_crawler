

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3026901%2Fformidable%2Ftags%2F6.8%2Fclasses%2Fcontrollers%2FFrmFormsController.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3017166/formidable/trunk/classes/controllers/FrmFormsController.php "Changeset 3017166 for formidable/tags/6.8/classes/controllers/FrmFormsController.php")
* Next Change →

---

# Changeset [3026901](/changeset/3026901 "Show full changeset") for [formidable/tags/6.8/classes/controllers/FrmFormsController.php](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
01/25/2024 04:26:06 PM
([12 months](/timeline?from=2024-01-25T16%3A26%3A06Z&precision=second "See timeline at 01/25/2024 04:26:06 PM") ago)

Author:
formidableforms
Message:

Update to version 6.8 from GitHub

Location:
[formidable/tags/6.8](/browser/formidable/tags/6.8?rev=3026901)
Files:

1 edited
1 copied

* [.](/browser/formidable/tags/6.8?rev=3026901 "Show entry in browser")
  (copied)
  *(copied from [formidable/trunk](/browser/formidable/trunk?rev=3017821 "Show original file (revision 3026899)"))*
* [classes/controllers/FrmFormsController.php](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [formidable/tags/6.8/classes/controllers/FrmFormsController.php](/changeset/3026901/formidable/tags/6.8/classes/controllers/FrmFormsController.php "Show the changeset 3026901 restricted to formidable/tags/6.8/classes/controllers/FrmFormsController.php")

  | [r3017166](/browser/formidable/trunk/classes/controllers/FrmFormsController.php?rev=3017166#L158 "Show revision 3017166 of this file in browser") | [r3026901](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901#L158 "Show revision 3026901 of this file in browser") |  |
  | --- | --- | --- |
  | 158 | 158 | public static function update\_settings() { |
  | 159 | 159 | FrmAppHelper::permission\_check( 'frm\_edit\_forms' ); |
  |  | 160 | $process\_form = FrmAppHelper::get\_post\_param( 'process\_form', '', 'sanitize\_text\_field' ); |
  |  | 161 |  |
  |  | 162 | if ( ! wp\_verify\_nonce( $process\_form, 'process\_form\_nonce' ) ) { |
  |  | 163 | $frm\_settings = FrmAppHelper::get\_settings(); |
  |  | 164 | $error\_args = array( |
  |  | 165 | 'title'       => \_\_( 'Verification failed', 'formidable' ), |
  |  | 166 | 'body'        => $frm\_settings->admin\_permission, |
  |  | 167 | 'cancel\_text' => \_\_( 'Cancel', 'formidable' ), |
  |  | 168 | ); |
  |  | 169 | FrmAppController::show\_error\_modal( $error\_args ); |
  |  | 170 | return; |
  |  | 171 | } |
  | 160 | 172 |  |
  | 161 | 173 | $id = FrmAppHelper::get\_param( 'id', '', 'get', 'absint' ); |
  | […](/browser/formidable/trunk/classes/controllers/FrmFormsController.php?rev=3017166#L214) | […](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901#L226) |  |
  | 214 | 226 | return self::get\_edit\_vars( $id, $errors ); |
  | 215 | 227 | } else { |
  |  | 228 | self::maybe\_remove\_draft\_option\_from\_fields( $id ); |
  |  | 229 |  |
  | 216 | 230 | FrmForm::update( $id, $values ); |
  | 217 | 231 | $message = \_\_( 'Form was successfully updated.', 'formidable' ); |
  | […](/browser/formidable/trunk/classes/controllers/FrmFormsController.php?rev=3017166#L232) | […](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901#L246) |  |
  | 232 | 246 | return self::get\_edit\_vars( $id, array(), $message ); |
  | 233 | 247 | }//end if |
  |  | 248 | } |
  |  | 249 |  |
  |  | 250 | /\*\* |
  |  | 251 | \* Remove the draft flag from any new fields from this current session. |
  |  | 252 | \* |
  |  | 253 | \* @since 6.8 |
  |  | 254 | \* |
  |  | 255 | \* @param int $form\_id |
  |  | 256 | \* @return void |
  |  | 257 | \*/ |
  |  | 258 | private static function maybe\_remove\_draft\_option\_from\_fields( $form\_id ) { |
  |  | 259 | $draft\_field\_ids\_csv = FrmAppHelper::get\_post\_param( 'draft\_fields', '', 'sanitize\_text\_field' ); |
  |  | 260 | if ( ! $draft\_field\_ids\_csv ) { |
  |  | 261 | // If the draft\_fields input is empty there are no new fields in the session. |
  |  | 262 | return; |
  |  | 263 | } |
  |  | 264 |  |
  |  | 265 | $draft\_field\_ids = array\_filter( explode( ',', $draft\_field\_ids\_csv ), 'is\_numeric' ); |
  |  | 266 | if ( ! $draft\_field\_ids ) { |
  |  | 267 | // Exit early if the draft fields input is invalid. It should be a CSV of integer values. |
  |  | 268 | return; |
  |  | 269 | } |
  |  | 270 |  |
  |  | 271 | $draft\_field\_rows = FrmFieldsHelper::get\_draft\_field\_results( $form\_id, $draft\_field\_ids ); |
  |  | 272 | foreach ( $draft\_field\_rows as $row ) { |
  |  | 273 | $row->field\_options['draft'] = 0; |
  |  | 274 | FrmField::update( $row->id, array( 'field\_options' => $row->field\_options ) ); |
  |  | 275 | } |
  | 234 | 276 | } |
  | 235 | 277 |  |
  | […](/browser/formidable/trunk/classes/controllers/FrmFormsController.php?rev=3017166#L1075) | […](/browser/formidable/tags/6.8/classes/controllers/FrmFormsController.php?rev=3026901#L1117) |  |
  | 1075 | 1117 | if ( defined( 'DOING\_AJAX' ) ) { |
  | 1076 | 1118 | wp\_die(); |
  | 1077 |  | }~~else {~~ |
  | 1078 |  | require( FrmAppHelper::plugin\_path() . '/classes/views/frm-forms/edit.php' ); |
  | 1079 |  | ~~}~~ |
  |  | 1119 | } |
  |  | 1120 |  |
  |  | 1121 | require FrmAppHelper::plugin\_path() . '/classes/views/frm-forms/edit.php'; |
  | 1080 | 1122 | } |
  | 1081 | 1123 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3026901)
* [Zip Archive](?format=zip&new=3026901)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

