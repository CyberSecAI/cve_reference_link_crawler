<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Submit #304572: Simd Simd commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32 heap-buffer-overflow</title><meta name="keywords" content="#304572: Simd Simd commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32 heap-buffer-overflow,VulDB,Vulnerability,Vulnerability Database,Vulnerability Data Feed,VDB,VulnDB,CVE,NVD,Cyber Threat Intelligence,Hack,Hacking,IT-Security,Information Security,Infosec,Cybersecurity,Exploit,Exploiting,Open-Source" /><meta name="description" content="Simd Simd commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32 heap-buffer-overflow" /><meta name="robots" content="all" /><meta name="revisit-after" content="90 days" /><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" /><link rel="preload" href="/_thm/style-20240920.min.css" as="style"><link rel="preload" href="/_thm/fontawesome-6.1.1/css/all.min.css" as="style"><link rel="stylesheet" href="/_thm/style-20240920.min.css" type="text/css" media="all" /><link rel="stylesheet" href="/_thm/fontawesome-6.1.1/css/all.min.css" type="text/css" media="all" /><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#555"><meta name="msapplication-TileColor" content="#555"><link rel="alternate" hreflang="de" href="https://vuldb.com/de/?submit.304572" /><link rel="alternate" hreflang="fr" href="https://vuldb.com/fr/?submit.304572" /><link rel="alternate" hreflang="it" href="https://vuldb.com/it/?submit.304572" /><link rel="alternate" hreflang="es" href="https://vuldb.com/es/?submit.304572" /><link rel="alternate" hreflang="pt" href="https://vuldb.com/pt/?submit.304572" /><link rel="alternate" hreflang="ru" href="https://vuldb.com/ru/?submit.304572" /><link rel="alternate" hreflang="pl" href="https://vuldb.com/pl/?submit.304572" /><link rel="alternate" hreflang="sv" href="https://vuldb.com/sv/?submit.304572" /><link rel="alternate" hreflang="zh" href="https://vuldb.com/zh/?submit.304572" /><link rel="alternate" hreflang="ja" href="https://vuldb.com/ja/?submit.304572" /><link rel="alternate" hreflang="ar" href="https://vuldb.com/ar/?submit.304572" /><link rel="alternate" type="application/rss+xml" title="Recent" href="/?rss.recent" /><link rel="alternate" type="application/rss+xml" title="Updates" href="/?rss.updates" /><link rel="alternate" type="application/rss+xml" title="Submits" href="/?rss.submits" /><link rel="alternate" type="application/rss+xml" title="Changelog" href="/?rss.changelog" /></head><body><div id="app"><header id="app-header"><nav id="app-nav"><div id="menuwrapper"><div id="menu"><div id="logo" class="hideonphone hideonphone_h" title="VulDB"><a href="?"><img src="/_thm/vuldb.png" alt="VulDB"></a></div><div id="menubox"><form id="search_nav" class="hideonphone_h hideonphonesmall" method="post" action="?search"><input type="text" name="search" maxlength="255" placeholder="Vendor, Product, CVE, ..." autocomplete="on" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"><input type="submit" class="hideonphone buttoninsidetextbox" value="&#128269;"></form><div id="mainmenu"><ul class="top-level-menu"><li><div><a href="?"><div class="m_txt">Home</div></a></div><ul class="second-level-menu"><li><a href="?"><div class="m_txt">Overview</div></a></li><li><a href="?live.recent"><div class="m_txt">Live Recent</div></a></li><li><a href="?live.updates"><div class="m_txt">Live Updates</div></a></li><li><a href="?live.archive"><div class="m_txt">Live Archive</div></a></li><li><a href="?live.submits"><div class="m_txt">Live Submits</div></a></li></ul></li><li><div class="m_a"><a href="?recent"><div class="m_txt">Entries</div></a></div><ul class="second-level-menu"><li><a href="?recent"><div class="m_txt">Recent</div></a></li><li><a href="?updates"><div class="m_txt">Updates</div></a></li><li class="hideonphonesmall"><a href="?commits"><div class="m_txt">Commits</div></a></li><li><a href="?archive"><div class="m_txt">Archive</div></a></li><li><a href="?cna"><div class="m_txt">CNA</div></a></li><li><a href="?stats"><div class="m_txt">Stats</div></a></li><li class="hideonphone"><a href="?submits"><div class="m_txt">Submits</div></a></li><li class="hideonphone"><a href="?id.add"><div class="m_txt">Add</div></a></li></ul></li><li class="hideontablet"><div><a href="?product"><div class="m_txt">Products</div></a></div><ul class="second-level-menu"><li><a href="?vendor"><div class="m_txt">Vendor</div></a></li><li><a href="?product"><div class="m_txt">Product</div></a></li><li><a href="?type"><div class="m_txt">Type</div></a></li></ul></li><li class="hideonphone"><div><a href="?cvssv3"><div class="m_txt">Risk</div></a></div><ul class="second-level-menu"><li><a href="?cvssv4"><div class="m_txt">CVSSv4</div></a></li><li><a href="?cvssv3"><div class="m_txt">CVSSv3</div></a></li><li><a href="?cvssv2"><div class="m_txt">CVSSv2</div></a></li><li><a href="?risk"><div class="m_txt">Risks</div></a></li><li><a href="?exploits"><div class="m_txt">Exploits</div></a></li></ul></li><li class="hideonphone"><div><a href="?cti"><div class="m_txt">Threat</div></a></div><ul class="second-level-menu"><li class="hideonphonesmall"><a href="?cti.analyze"><div class="m_txt">Analysis</div></a></li><li><a href="?activities"><div class="m_txt">Activities</div></a></li><li><a href="?events"><div class="m_txt">Events</div></a></li><li><a href="?actor"><div class="m_txt">Actors</div></a></li><li><a href="?ip"><div class="m_txt">IP addresses</div></a></li><li><a href="?country"><div class="m_txt">Country</div></a></li><li><a href="?sector"><div class="m_txt">Sector</div></a></li><li><a href="?exploitprices"><div class="m_txt">Exploit Prices</div></a></li></ul></li><li class="hideontablet"><div><a href="?references"><div class="m_txt">References</div></a></div><ul class="second-level-menu"><li><a href="?references"><div class="m_txt">References</div></a></li><li><a href="?tools"><div class="m_txt">Tools</div></a></li><li><a href="?videos"><div class="m_txt">Videos</div></a></li><li><a href="?googlehacking"><div class="m_txt">Google Hacking</div></a></li><li><a href="?export"><div class="m_txt">Exports</div></a></li></ul></li><li class="hideonphonesmall"><div><a href="?search"><div class="m_txt">Search</div></a></div><ul class="second-level-menu"><li><form id="search_menu" method="post" action="?search"><div><input type="text" name="search" maxlength="255" placeholder="Type here..." autocomplete="off" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"></div></form></li><li><a href="?search"><div class="m_txt">Search</div></a></li><li class="hideonphonesmall"><a href="?search.advanced"><div class="m_txt">Advanced Search</div></a></li><li><a href="?user"><div class="m_txt">User</div></a></li><li class="hideonphone"><a href="?feeds"><div class="m_txt">Feeds</div></a></li><li><a href="?kb.api"><div class="m_txt">API</div></a></li></ul></li><li class="hideonphablet"><div><a href="?kb"><div class="m_txt">Support</div></a></div><ul class="second-level-menu"><li><a href="?kb"><div class="m_txt">Knowledge Base</div></a></li><li><a href="?kb.faq"><div class="m_txt">FAQ</div></a></li><li><a href="?kb.changelog"><div class="m_txt">Changelog</div></a></li><li><a href="?kb.roadmap"><div class="m_txt">Roadmap</div></a></li><li><a href="?status"><div class="m_txt">Status</div></a></li><li><a href="?contact"><div class="m_txt">Contact</div></a></li></ul></li><li class="hideonwatch"><div><a href="?login"><div class="m_txt">Login</div></a></div><ul class="second-level-menu"><li><a href="?login"><div class="m_txt">Login</div></a></li><li><a href="?signup"><div class="m_txt">Signup</div></a></li><li><a href="?pay"><div class="m_txt">Purchase</div></a></li><li><a href="?kb.terms"><div class="m_txt">Terms of Use</div></a></li></ul></li></ul></div></div></div></div></nav></header><main id="app-main"><aside id="app-sidemenu" class="app-sidelement hideonphone"><ul><li><a href="?live.submits"><div class="icon fas fa-satellite-dish"></div><div class="icontext">Live</div></a></li><li><a href="?submits"><div class="icon fa-regular fa-folder-open"></div><div class="icontext">Submits</div></a></li><li><a href="?id.add"><div class="icon fas fa-file-upload"></div><div class="icontext">Add</div></a></li><li><a href="?kb.submission"><div class="icon fas fa-file-upload"></div><div class="icontext">Policy</div></a></li><li><a href="?pay"><div class="icon fa-solid fa-cart-shopping"></div><div class="icontext">Purchase</div></a></li></ul><div id="usermenu" class="hideonphonesmall_h"><a href="?login">Login</a><a href="?signup">Signup</a></div></aside><div id="container"><div id="content"><nav id="breadcrumbs" class="hideonphonesmall hideonphone_h"><a href="?" class="breadcrumbs-item">&#x1f6e1; Home</a><a href="?submit" class="breadcrumbs-item">Submit</a><div class="breadcrumbs-item breadcrumbs-item-isactive">304572</div></nav><a href="?rss.submit" class="rssicon fas fa-rss hideonphone hideonphone_h" alt="RSS" title="RSS" target="rss"></a><h1>Submit #304572: Simd Simd commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32 heap-buffer-overflow<span class="minibutton"><a href="?kb.submission">info</a></span></h1><div class="tablewrapper"><table class="htable col1fitcontent"><tr><th>Title</th><td class="bold">Simd Simd commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32 heap-buffer-overflow</td></tr><tr><th>Description</th><td>## Description

[Simd](https://github.com/ermig1979/Simd) has heap-buffer-overflow src/Simd/SimdMemoryStream.h:199:27 in ReadUnsigned&lt;unsigned char&gt;

## version

```shell
commit a1580a5fb13e2f8c78715afb0bc47e44519ccd32
```

## harnss

From https://github.com/google/oss-fuzz/blob/master/projects/simd/simd_load_fuzzer.cpp

```c++
#include &lt;stdint.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &quot;Test/TestUtils.h&quot;

extern &quot;C&quot;
int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size){
  if (size&lt;5) {
    return 0;
  }
  Test::View::Format formats[4] = {Test::View::Gray8,
                                   Test::View::Bgr24,
                                   Test::View::Bgra32,
                                   Test::View::Rgb24};
  for(int i=0; i&lt;4; i++) {
    Test::View dst1;
    dst1.Load(data, size, formats[i]);
  }
  return 0;
}
```

 ## Proof of Concept

The poc can be obtained from Google Drive: https://drive.google.com/drive/folders/1z0JBsZ-QR3RsuAf-uyit_ZGXCh0rEvFq?usp=sharing

```shell
$ ./simd_load_fuzzer f3d3a0b9-f889-4853-86b3-6cd46a34fc3e 
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2587314779
INFO: Loaded 1 modules   (400161 inline 8-bit counters): 400161 [0xff2cb90, 0xff8e6b1), 
INFO: Loaded 1 PC tables (400161 PCs): 400161 [0xff8e6b8,0x105a98c8), 
./simd_load_fuzzer: Running 1 inputs 1 time(s) each.
Running: f3d3a0b9-f889-4853-86b3-6cd46a34fc3e
=================================================================
==1101636==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61a000000b6f at pc 0x00000072e654 bp 0x7fffffffd920 sp 0x7fffffffd918
READ of size 1 at 0x61a000000b6f thread T0
    #0 0x72e653 in ReadUnsigned&lt;unsigned char&gt; /src/Simd/prj/cmake/../../src/Simd/SimdMemoryStream.h:199:27
    #1 0x72e653 in Simd::Base::ImagePpmTxtLoader::FromStream() /src/Simd/src/Simd/SimdBaseImageLoad.cpp:264:38
    #2 0x5ad5916 in Simd::Avx512bw::ImageLoadFromMemory(unsigned char const*, unsigned long, unsigned long*, unsigned long*, unsigned long*, SimdPixelFormatType*) /src/Simd/src/Simd/SimdAvx512bwImageLoad.cpp:146:33
    #3 0x592545 in SimdImageLoadFromMemory /src/Simd/src/Simd/SimdLib.cpp:2747:12
    #4 0x57f256 in Load /src/Simd/src/Simd/SimdView.hpp:1284:29
    #5 0x57f256 in LLVMFuzzerTestOneInput /src/simd_load_fuzzer.cpp:29:10
    #6 0x450a33 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #7 0x42bbc2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:337:6
    #8 0x436ca1 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:1053:9
    #9 0x46add2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x7ffff7c43082 in __libc_start_main /build/glibc-wuryBv/glibc-2.31/csu/../csu/libc-start.c:308:16
    #11 0x421d8d in _start (/home/zhangwei28/80result/simd/simd_load_fuzzer+0x421d8d)

0x61a000000b6f is located 0 bytes to the right of 1263-byte region [0x61a000000680,0x61a000000b6f)
allocated by thread T0 here:
    #0 0x541ca6 in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x4c06a7 in operator new(unsigned long) cxa_noexception.cpp
    #2 0x42bbc2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:337:6
    #3 0x436ca1 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:1053:9
    #4 0x46add2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #5 0x7ffff7c43082 in __libc_start_main /build/glibc-wuryBv/glibc-2.31/csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: heap-buffer-overflow /src/Simd/prj/cmake/../../src/Simd/SimdMemoryStream.h:199:27 in ReadUnsigned&lt;unsigned char&gt;
Shadow bytes around the buggy address:
  0x0c347fff8110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8130: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8140: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8150: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&gt;0x0c347fff8160: 00 00 00 00 00 00 00 00 00 00 00 00 00[07]fa fa
  0x0c347fff8170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff8180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff8190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff81a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff81b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==1101636==ABORTING
```</td></tr><tr><th>Source</th><td><span title="visit with caution">&#9888;&#65039; https:/<wbr>/<wbr>drive.<wbr>google.<wbr>com/<wbr>drive/<wbr>folders/<wbr>1z0JBsZ-QR3RsuAf-uyit_<wbr>ZGXCh0rEvFq?usp=<wbr>sharing</span></td></tr><tr><th>User</th><td><a href="?kb.anonymous"><div class="user-avatar fa-solid fa-ghost white undefined"></div>&nbsp;Anonymous User</a></td></tr><tr><th>Submission</th><td>03/26/2024 09:07 AM (10 months ago)</td></tr><tr><th>Moderation</th><td>04/02/2024 06:45 PM (7 days later)</td></tr><tr><th>Status</th><td><a href="?kb.submission" class="symbol cvss1">Accepted</a></td></tr><tr><th>VulDB Entry</th><td><a href="?id.259054" class="symbol price4">259054</a> [ermig1979 Simd up to 6.0.134 SimdMemoryStream.h ReadUnsigned heap-based overflow]</td></tr><tr><th>Points</th><td>20</td></tr></table></div><p><div class="submenubuttons"><a href="?submit.304571">&#9666;<span class="hideonphone"> Previous</span></a><a href="?submit">Overview</a><a href="?submit.304573"><span class="hideonphone">Next </span>&#9656;</a></div></p><section id="servicebox" class="ribbon ribbonbox hideonwatch hideonphablet_h"><h1>Do you need the next level of professionalism?</h1><p>Upgrade your account now!</p><a href="?pay"><input type="button" value="Click here" /></a></section></div></div><aside id="app-tocmenu" class="app-sidelement hideonphablet"><div class="sidemenuwrapper"><h2><span class="fa-solid fa-triangle-exclamation"></span> Notice</h2><p>Submissions are made by <a href="?user">VulDB community users</a>. VulDB is <em>not responsible</em> for their content nor the links to external sources.</p><p>Please use the raw information shown and the links listed <em>with caution</em>. They might contain malicious and harmful actions, code or data.</p><p>The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.</p><h2><span class="fas fa-question-circle"></span> Documentation</h2><ul><li><a href="?kb.submission">Submission Policy</a></li><li><a href="?kb.processing">Data Processing</a></li><li><a href="?kb.cna">CVE Handling</a></li></ul></div></aside></main><footer id="app-footer"><div id="footerwrapper"><div id="footercontent"><div id="copyright"><a href="?kb.terms">&copy; <span class="hideonphone">1997-</span>2025<span class="hideonphonesmall"> vuldb.com</span></a><span class="hideontablet"> &middot; <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="license">cc by-nc-sa</a></span></div><div id="languages" class="hideonphablet"><a href="/de/?submit.304572" hreflang="de" title="German">de</a> &middot; <a href="/fr/?submit.304572" hreflang="fr" title="French">fr</a> &middot; <a href="/it/?submit.304572" hreflang="it" title="Italian">it</a> &middot; <a href="/es/?submit.304572" hreflang="es" title="Spanish">es</a> &middot; <a href="/pt/?submit.304572" hreflang="pt" title="Portuguese">pt</a> &middot; <a href="/ru/?submit.304572" hreflang="ru" title="Russian">ru</a> &middot; <a href="/pl/?submit.304572" hreflang="pl" title="Polish">pl</a> &middot; <a href="/sv/?submit.304572" hreflang="sv" title="Swedish">sv</a> &middot; <a href="/zh/?submit.304572" hreflang="zh" title="Chinese">zh</a> &middot; <a href="/ja/?submit.304572" hreflang="ja" title="Japanese">ja</a> &middot; <a href="/ar/?submit.304572" hreflang="ar" title="Arabic">ar</a></div><div id="version"><a href="?kb.changelog">v18.14.7</a></div></div></div></footer></div></body></html>