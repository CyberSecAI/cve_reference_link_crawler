=== Content from bugs.launchpad.net_f6ba81eb_20250111_180347.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[provd package](https://launchpad.net/ubuntu/%2Bsource/provd)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/provd)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/provd)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/provd)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/provd)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/provd)

# sprovd binary enables local privilege escalation

Bug #2071574 reported by
[James Henstridge](https://launchpad.net/~jamesh)
on 2024-07-01

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [provd (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/provd "Latest release: 0.1.5, uploaded to universe on 2024-07-18 08:24:08.621433+00:00 by Matthew Hagemann (matt-hagemann), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | High | [Matthew Hagemann](https://launchpad.net/~matt-hagemann) |  |
|  | [Noble](https://bugs.launchpad.net/ubuntu/noble/%2Bsource/provd) | Fix Released | High | [Matthew Hagemann](https://launchpad.net/~matt-hagemann) |  |

### Bug Description

The provd 0.1.2 package includes a setuid binary called sprovd that is executable by anyone:

$ ls -l /usr/libexec/sprovd

    -rwsr-xr-x 1 root provd 2139560 Apr 11 13:48 /usr/libexec/sprovd

There are a few places where this binary executes subprocesses, looking up the executable via $PATH. For example:

<https://github.com/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/sprovd/sprovd.go#L62-L68>

Unfortunately, it doesn't do anything to clean its environment. So the path is controlled by the caller and it can pick which executable gets run with elevated privileges.

The attached exploit script creates a fake "pro" executable that writes it's user/group information to a file.

$ sh exploit.sh

    $ ls -l /tmp/called-from-sprovd.txt

    -rw-rw-r-- 1 root james 144 Jul 1 09:05 /tmp/called-from-sprovd.txt

    $ cat /tmp/called-from-sprovd.txt

    uid=0(root) gid=1000(james) groups=1000(james),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),121(lpadmin),132(lxd),133(sambashare),136(libvirt)

This shows that my executable was called as root and could do anything else that root can do.

See [original description](comments/0)

## CVE References

* [2024-6714](/bugs/cve/2024-6714 "This CVE was automatically created fr...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Henstridge (jamesh)](https://launchpad.net/~jamesh) wrote on 2024-07-01: |  |  | [#1](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/1) |
| --- | --- | --- | --- |

* [Simple demonstration exploit](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Battachment/5793670/%2Bfiles/exploit.sh)
  [Edit](/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Battachment/5793670)
  (233 bytes,
  text/x-sh)

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Henstridge (jamesh)](https://launchpad.net/~jamesh) wrote on 2024-07-01: |  |  | [#2](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/2) |
| --- | --- | --- | --- |

The simplest mitigation for this would be to remove the world execute bit, so sprovd can only be run by members of the provd group. From what I can tell, this would work in the gnome-initial-setup user environment it is run in. The bug would still be present, but couldn't be exercised by regular users.

It'd be better to get rid of the need for a setuid binary all together though. A D-Bus system daemon using polkit auth might be a better approach, since the unprivileged caller won't be able to control the execution environment of the privileged helper.

The simplest mitigation for this would be to remove the world execute bit, so sprovd can only be run by members of the provd group. From what I can tell, this would work in the gnome-initial-setup user environment it is run in. The bug would still be present, but couldn't be exercised by regular users.
It'd be better to get rid of the need for a setuid binary all together though. A D-Bus system daemon using polkit auth might be a better approach, since the unprivileged caller won't be able to control the execution environment of the privileged helper.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-01: |  |  | [#3](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/3) |
| --- | --- | --- | --- |

Thanks James. The plan is to move the Ubuntu Pro attach step into the first login experience so that we can drop this altogether.

Thanks James. The plan is to move the Ubuntu Pro attach step into the first login experience so that we can drop this altogether.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-01: |  |  | [#4](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/4) |
| --- | --- | --- | --- |

For 24.04, I'll provide a patch that removes the service this is associated with, dropping the vulnerability.

For 24.04, I'll provide a patch that removes the service this is associated with, dropping the vulnerability.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-11: |  |  | [#5](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/5) |
| --- | --- | --- | --- |

Hi from Security Engineering team!

Would you like us to assign a CVE identifier for this vulnerability? This will allow all of us to track it, as well for our team to send out a security notice once the fix is released.

Hi from Security Engineering team!
Would you like us to assign a CVE identifier for this vulnerability? This will allow all of us to track it, as well for our team to send out a security notice once the fix is released.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-15 (last edit on 2024-07-19): |  |  | [#6](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/6) |
| --- | --- | --- | --- |

Hi,

As confirmed with Matthew Hagemann earlier, please use CVE-2024-6714 to refer to this vulnerability, including in any private commit messages or release notes.

Additionally, we have assigned a CVSS of 8.8 (high) for this, with a vector string of CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H (<https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H>). Please let us know if you consider this incorrect.

Would I be right in thinking that the patch is going to land in the archive for both noble and oracular?

Finally, could you please give us a 48-72 hour heads-up before release, so that we can publish CVE details when the update lands?

Thank you!

Edited on 2024-07-19: refer to CVE-2024-6714, previously said CVE-2024-6713, which is incorrect.

Hi,
As confirmed with Matthew Hagemann earlier, please use CVE-2024-6714 to refer to this vulnerability, including in any private commit messages or release notes.
Additionally, we have assigned a CVSS of 8.8 (high) for this, with a vector string of CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H (https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H). Please let us know if you consider this incorrect.
Would I be right in thinking that the patch is going to land in the archive for both noble and oracular?
Finally, could you please give us a 48-72 hour heads-up before release, so that we can publish CVE details when the update lands?
Thank you!
Edited on 2024-07-19: refer to CVE-2024-6714, previously said CVE-2024-6713, which is incorrect.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-15: |  |  | [#7](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/7) |
| --- | --- | --- | --- |

Hi Luci

We can publish to Oracular, but will need the ubuntu-security team support to push a security upload to noble. We don't have upload rights to that pocket.

We will ping when we are 48-72 hours out to co-ordinate the upload.

Hi Luci
We can publish to Oracular, but will need the ubuntu-security team support to push a security upload to noble. We don't have upload rights to that pocket.
We will ping when we are 48-72 hours out to co-ordinate the upload.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-16: |  |  | [#8](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/8) |
| --- | --- | --- | --- |

Hi Matthew,

We have a private PPA that we use for this purpose and can give nominated people from your team temporary upload rights to it, during this vulnerability's coordination process. This will allow you to build and run autopkgtests for noble and the ubuntu-security team can then sponsor the upload by copying to the security pocket.

Do you have an estimated timeline for release at this point, by any chance?

Thanks!

Hi Matthew,
We have a private PPA that we use for this purpose and can give nominated people from your team temporary upload rights to it, during this vulnerability's coordination process. This will allow you to build and run autopkgtests for noble and the ubuntu-security team can then sponsor the upload by copying to the security pocket.
Do you have an estimated timeline for release at this point, by any chance?
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-16: |  |  | [#9](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/9) |
| --- | --- | --- | --- |

Hi Luci,

Ah that's great! I've passed on a patched version to James Henstridge who is happy, so from a timeline perspective I'd say give me a day to poke someone on Desktop for a final sign off and we should be ready (I'll reply again when we are)

Hi Luci,
Ah that's great! I've passed on a patched version to James Henstridge who is happy, so from a timeline perspective I'd say give me a day to poke someone on Desktop for a final sign off and we should be ready (I'll reply again when we are)

| Changed in provd (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → Matthew Hagemann (matt-hagemann) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-17: |  |  | [#10](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/10) |
| --- | --- | --- | --- |

Thanks, Matthew! Could you please let me know who I should give upload rights to in the private PPA, so I can get this set up for you?

Thanks, Matthew! Could you please let me know who I should give upload rights to in the private PPA, so I can get this set up for you?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-17: |  |  | [#11](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/11) |
| --- | --- | --- | --- |

Hi Luci, Didier Roche-Tolomelli (didrocks).

Hi Luci, Didier Roche-Tolomelli (didrocks).

[Sebastien Bacher (seb128)](https://launchpad.net/~seb128)
on 2024-07-18

| Changed in provd (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Fix Committed |

[Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann)
on 2024-07-18

| Changed in provd (Ubuntu Noble): | |
| --- | --- |
| **assignee**: | nobody → Matthew Hagemann (matt-hagemann) |
| **importance**: | Undecided → High |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-19: |  |  | [#12](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/12) |
| --- | --- | --- | --- |

Hi, Matthew!

Unfortunately we made a typo when referring to the CVE ID - it's CVE-2024-6714, NOT CVE-2024-6713. Have you used the identifier anywhere (release notes, changelog, etc.), by any chance?

Hi, Matthew!
Unfortunately we made a typo when referring to the CVE ID - it's CVE-2024-6714, NOT CVE-2024-6713. Have you used the identifier anywhere (release notes, changelog, etc.), by any chance?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-19: |  |  | [#13](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/13) |
| --- | --- | --- | --- |

Hi, Luci.

No not yet, currently only an internal / unreleased project within Desktop makes use of this package, so we haven't said anything public yet

Hi, Luci.
No not yet, currently only an internal / unreleased project within Desktop makes use of this package, so we haven't said anything public yet

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Hagemann (matt-hagemann)](https://launchpad.net/~matt-hagemann) wrote on 2024-07-19: |  |  | [#14](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/14) |
| --- | --- | --- | --- |

The changelogs point to this lp bug, which is linked to the cve (updated it now to CVE-2024-6714)

The changelogs point to this lp bug, which is linked to the cve (updated it now to CVE-2024-6714)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-07-20: |  |  | [#15](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/15) |
| --- | --- | --- | --- |

This bug was fixed in the package provd - 0.1.5

---------------

provd (0.1.5) oracular; urgency=medium

\* Remove Ubuntu Pro and Chmod services (LP: [#2071574](/bugs/2071574))

provd (0.1.4) noble; urgency=medium

\* Gnome-keyring now unlocked for wifi password prompt to appear during setup.

provd (0.1.3) noble; urgency=medium

\* Fixed a flaky test that failed occasionally on arm64.

-- Matthew Gary Hagemann <email address hidden> Mon, 1 Jul 2024 14:23:46 +0200

This bug was fixed in the package provd - 0.1.5
---------------
provd (0.1.5) oracular; urgency=medium
\* Remove Ubuntu Pro and Chmod services (LP: #2071574)
provd (0.1.4) noble; urgency=medium
\* Gnome-keyring now unlocked for wifi password prompt to appear during setup.
provd (0.1.3) noble; urgency=medium
\* Fixed a flaky test that failed occasionally on arm64.
-- Matthew Gary Hagemann <matt.hagemann@canonical.com> Mon, 1 Jul 2024 14:23:46 +0200

| Changed in provd (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-23: |  |  | [#16](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/16) |
| --- | --- | --- | --- |

Hi, all.

We'll be publishing CVE details for this today.

Thanks!

Hi, all.
We'll be publishing CVE details for this today.
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-07-23: |  |  | [#17](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/17) |
| --- | --- | --- | --- |

This bug was fixed in the package provd - 0.1.2+24.04

---------------

provd (0.1.2+24.04) noble; urgency=medium

\* Remove Ubuntu Pro and Chmod services (LP: [#2071574](/bugs/2071574))

-- Matthew Gary Hagemann <email address hidden> Thu, 18 Jul 2024 12:31:09 +0200

This bug was fixed in the package provd - 0.1.2+24.04
---------------
provd (0.1.2+24.04) noble; urgency=medium
\* Remove Ubuntu Pro and Chmod services (LP: #2071574)
-- Matthew Gary Hagemann <matt.hagemann@canonical.com> Thu, 18 Jul 2024 12:31:09 +0200

| Changed in provd (Ubuntu Noble): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu) wrote on 2024-07-24: |  |  | [#18](/ubuntu/%2Bsource/provd/%2Bbug/2071574/comments/18) |
| --- | --- | --- | --- |

Hi all,

The USN was published. I'll make this bug report public 7 days from CVE detail publication.

Thanks!

Hi all,
The USN was published. I'll make this bug report public 7 days from CVE detail publication.
Thanks!

[Luci Stanescu (lucistanescu)](https://launchpad.net/~lucistanescu)
on 2024-07-31

| **information type**: | Private Security → Public Security |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/provd/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [Simple demonstration exploit](https://bugs.launchpad.net/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Battachment/5793670/%2Bfiles/exploit.sh)
  [Edit](/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Battachment/5793670 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/provd/%2Bbug/2071574/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_2aaad812_20250111_180348.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fubuntu-desktop-provision%2Fcommit%2F8d9086de0f82894ff27a9e429ff4f45231020092)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fubuntu-desktop-provision%2Fcommit%2F8d9086de0f82894ff27a9e429ff4f45231020092)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=canonical%2Fubuntu-desktop-provision)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[canonical](/canonical)
/
**[ubuntu-desktop-provision](/canonical/ubuntu-desktop-provision)**
Public

* [Notifications](/login?return_to=%2Fcanonical%2Fubuntu-desktop-provision) You must be signed in to change notification settings
* [Fork
  33](/login?return_to=%2Fcanonical%2Fubuntu-desktop-provision)
* [Star
   82](/login?return_to=%2Fcanonical%2Fubuntu-desktop-provision)

* [Code](/canonical/ubuntu-desktop-provision)
* [Issues
  58](/canonical/ubuntu-desktop-provision/issues)
* [Pull requests
  23](/canonical/ubuntu-desktop-provision/pulls)
* [Actions](/canonical/ubuntu-desktop-provision/actions)
* [Wiki](/canonical/ubuntu-desktop-provision/wiki)
* [Security](/canonical/ubuntu-desktop-provision/security)
* [Insights](/canonical/ubuntu-desktop-provision/pulse)

Additional navigation options

* [Code](/canonical/ubuntu-desktop-provision)
* [Issues](/canonical/ubuntu-desktop-provision/issues)
* [Pull requests](/canonical/ubuntu-desktop-provision/pulls)
* [Actions](/canonical/ubuntu-desktop-provision/actions)
* [Wiki](/canonical/ubuntu-desktop-provision/wiki)
* [Security](/canonical/ubuntu-desktop-provision/security)
* [Insights](/canonical/ubuntu-desktop-provision/pulse)

## Commit

[Permalink](/canonical/ubuntu-desktop-provision/commit/8d9086de0f82894ff27a9e429ff4f45231020092)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#784](https://github.com/canonical/ubuntu-desktop-provision/pull/784) from matthew-hagemann/UDENG-3455

[Browse files](/canonical/ubuntu-desktop-provision/tree/8d9086de0f82894ff27a9e429ff4f45231020092)
Browse the repository at this point in the history

```
provd: Removing pro and chown services (sprovd)
```

* Loading branch information

[![@matthew-hagemann](https://avatars.githubusercontent.com/u/93575731?s=40&v=4)](/matthew-hagemann)

[matthew-hagemann](/canonical/ubuntu-desktop-provision/commits?author=matthew-hagemann "View all commits by matthew-hagemann")
authored
Jul 3, 2024

2 parents
[d455276](/canonical/ubuntu-desktop-provision/commit/d4552766db6e210bd399d199930e2016bac1c7c0)
+
[08178a2](/canonical/ubuntu-desktop-provision/commit/08178a2b6ed5bc5b225f983ffcc7ac1dd87b0cf9)

commit 8d9086d

 Show file tree

 Hide file tree

Showing
**29 changed files**
with
**7 additions**
and
**1,013 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* packages/ubuntu\_init/lib/src

  + packages/ubuntu\_init/lib/src/init\_model.dart
    [init\_model.dart](#diff-4978036d589c9a30bfb6de564687b95d63afaf5623e7cc0708b64728104f35cc)
  + packages/ubuntu\_init/lib/src/init\_services.dart
    [init\_services.dart](#diff-0a2d475f7b224137310b49c5a3189001ce8b2eb5b7218e19f37b9d71d85697c2)
  + services

    - packages/ubuntu\_init/lib/src/services/provd\_chown\_service.dart
      [provd\_chown\_service.dart](#diff-0fe1b393023d6f8a4f83f014ef2114e8b85b392644ad174efde1b576e8b59bb8)
* provd

  + debian

    - provd/debian/changelog
      [changelog](#diff-0854333012b6c538fe6ad61dce27d68dfbab39056cc5af1d9a93a01c038d9293)
    - provd/debian/provd.install
      [provd.install](#diff-ae08f37736aa03fae775ac84ca16a1fdaa1667edd9e7332f8b06cb6c09ce4c66)
    - provd/debian/provd.postinst
      [provd.postinst](#diff-775587b89727c7ff0956722775129478fd2922f9e628c8b8fea165834f006d12)
  + internal/services

    - chown

      * provd/internal/services/chown/chowm\_test.go
        [chowm\_test.go](#diff-6aca2a175e82948d859c14436d6dadffb479cb8e4184ec0577784c0fa3ec719c)
      * provd/internal/services/chown/chown.go
        [chown.go](#diff-eb08449ec96fdda4525fa2ea88edf06bdf7649d7c25599bf5a594438f2e9dee4)
      * provd/internal/services/chown/export\_test.go
        [export\_test.go](#diff-5a77459be144f14b618b1b13897b36eaf7db4be6688786530de3144984836606)
      * testdata/TestChownSettings/golden

        + provd/internal/services/chown/testdata/TestChownSettings/golden/error\_when\_chown\_settings\_fails
          [error\_when\_chown\_settings\_fails](#diff-a6056e2f21f0c7195229d8ca2bfaad41386a9cb44163e52c7a3dd34121b16b3b)
        + provd/internal/services/chown/testdata/TestChownSettings/golden/successfully\_chown\_settings\_to\_a\_new\_user
          [successfully\_chown\_settings\_to\_a\_new\_user](#diff-d27373e4d7ae7d45ce8390ae13abab2709722fc7704296e5ceb2f41416b57be7)
    - provd/internal/services/manager.go
      [manager.go](#diff-17fb2e19af3632f8edd0b6bb809e9186cd3857ba051b13954c5d5c90d98d97d1)
    - pro

      * provd/internal/services/pro/export\_test.go
        [export\_test.go](#diff-6f75ba62addfd9ad3ce51b40be2152a3c85ac48d9f6209020d0d3294427b3831)
      * provd/internal/services/pro/pro.go
        [pro.go](#diff-1e633a934a5298d1520985be5f64eddafda77b8ea860073a4539a4d41ed6d7dc)
      * provd/internal/services/pro/pro\_test.go
        [pro\_test.go](#diff-7fe20ebb8339834cfcc1d65b60f365b3cfad0e306935eb3673f488b829291cd4)
      * testdata

        + TestProAttach/golden

          - provd/internal/services/pro/testdata/TestProAttach/golden/alreadyattachederror\_returned\_when\_already\_attached
            [alreadyattachederror\_returned\_when\_already\_attached](#diff-329baa649fd54d55e2caa02d9e99f65c900674c7b3a6ad9321de1ef275601d31)
          - provd/internal/services/pro/testdata/TestProAttach/golden/successfully\_attach\_machine\_to\_pro\_subscription
            [successfully\_attach\_machine\_to\_pro\_subscription](#diff-8c5952ff55c79da990e565d4c763938352b1b01a32baacacfc7c77c85e790326)
          - provd/internal/services/pro/testdata/TestProAttach/golden/unknownerror\_code\_returned\_when\_fail\_to\_call\_attach
            [unknownerror\_code\_returned\_when\_fail\_to\_call\_attach](#diff-e19dcfa40321be722be8ddc2161a27eaeeaaf7456eea511dfab4e33ac6acfb62)
        + TestProMagicAttach/golden

          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/alreadyattachederror\_code\_returned\_when\_already\_attached
            [alreadyattachederror\_code\_returned\_when\_already\_attached](#diff-73674bd034866a8d2061b2965999da4b9468534a5d04e2a2cd5316e5f1a64149)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/error\_when\_fail\_to\_call\_initiate
            [error\_when\_fail\_to\_call\_initiate](#diff-f33b78c0514514286f35eb2057b70f12253e0956d95c970c4464430f772af047)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/error\_when\_fail\_to\_call\_wait
            [error\_when\_fail\_to\_call\_wait](#diff-9f05bc39226d56302139c5edf5e83dfc02a137ca0c4e1a033c437058073546a7)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/networkerror\_code\_returned\_when\_network\_fails\_when\_calling\_initiate
            [networkerror\_code\_returned\_when\_network\_fails\_when\_calling\_initiate](#diff-f60be341d945f07fa5c7d3111413f9f7daee31120c1dd1bfc16f8a0ea7e3f99b)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/networkerror\_code\_returned\_when\_network\_fails\_while\_waiting
            [networkerror\_code\_returned\_when\_network\_fails\_while\_waiting](#diff-429ff03b0d9799c3f59cc3638a916eca7f0fdf08374199428e68c95227bc8503)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/successfully\_attach\_machine\_after,\_single\_user\_code\_refresh
            [successfully\_attach\_machine\_after,\_single\_user\_code\_refresh](#diff-0b3436328febb375d1ea54d381643f1414275b4b50fb8aec944b9a0855fc725d)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/successfully\_attach\_machine\_to\_pro\_subscription
            [successfully\_attach\_machine\_to\_pro\_subscription](#diff-7efd38acb5c6b46c732a214ca07590f41019bd8fc36da25536aac33dc30a75fa)
          - provd/internal/services/pro/testdata/TestProMagicAttach/golden/unknownerror\_code\_returned\_when\_fail\_to\_call\_attach
            [unknownerror\_code\_returned\_when\_fail\_to\_call\_attach](#diff-03099b47b430f3f401c7827ba9f43fbc8803aad8bdaf97e615b5b06fdbec8f9c)
    - testdata/TestRegisterGRPCServices

      * provd/internal/services/testdata/TestRegisterGRPCServices/golden
        [golden](#diff-0d6f4761309a755e9a6a8b938627087c97c8a242c5ad22a23b35292173549d24)
    - user

      * provd/internal/services/user/actions
        [actions](#diff-f0e4c87ebc3b65f1442b18150f710a340010953f3acf7d599ce80a01a03d869b)
  + sprovd

    - provd/sprovd/sprovd.go
      [sprovd.go](#diff-609447e88b928e1f0cd3da7370e451c89724073a0d6a4d066bcf54dd68a93f1a)

## There are no files selected for viewing

7 changes: 1 addition & 6 deletions

7
[packages/ubuntu\_init/lib/src/init\_model.dart](#diff-4978036d589c9a30bfb6de564687b95d63afaf5623e7cc0708b64728104f35cc "packages/ubuntu_init/lib/src/init_model.dart")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/packages/ubuntu_init/lib/src/init_model.dart)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,7 +14,6 @@ final initModelProvider = Provider( |
|  |  | args: tryGetService<ArgResults>(), |
|  |  | identityService: tryGetService<IdentityService>(), |
|  |  | gdmService: tryGetService<GdmService>(), |
|  |  | chownService: tryGetService<ChownService>(), |
|  |  | ), |
|  |  | ); |
|  |  |  |
| Expand All | | @@ -24,23 +23,19 @@ class InitModel { |
|  |  | ArgResults? args, |
|  |  | IdentityService? identityService, |
|  |  | GdmService? gdmService, |
|  |  | ChownService? chownService, |
|  |  | }) : \_gdmService = gdmService, |
|  |  | \_identityService = identityService, |
|  |  | \_pageConfig = pageConfig, |
|  |  | \_chownService = chownService; |
|  |  | \_pageConfig = pageConfig; |
|  |  |  |
|  |  | final PageConfigService? \_pageConfig; |
|  |  | final IdentityService? \_identityService; |
|  |  | final GdmService? \_gdmService; |
|  |  | final ChownService? \_chownService; |
|  |  |  |
|  |  | Future<void> launchDesktopSession() async { |
|  |  | final identity = await \_identityService?.getIdentity(); |
|  |  | if (identity == null) return; |
|  |  |  |
|  |  | try { |
|  |  | await \_chownService?.chownSettings(identity.username); |
|  |  | await \_gdmService?.launchSession( |
|  |  | identity.username, |
|  |  | identity.password, |
| Expand Down | |  |

3 changes: 0 additions & 3 deletions

3
[packages/ubuntu\_init/lib/src/init\_services.dart](#diff-0a2d475f7b224137310b49c5a3189001ce8b2eb5b7218e19f37b9d71d85697c2 "packages/ubuntu_init/lib/src/init_services.dart")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/packages/ubuntu_init/lib/src/init_services.dart)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,6 @@ import 'package:gsettings/gsettings.dart'; |
|  |  | import 'package:timezone\_map/timezone\_map.dart'; |
|  |  | import 'package:ubuntu\_init/src/init\_step.dart'; |
|  |  | import 'package:ubuntu\_init/src/services/provd\_accessibility\_service.dart'; |
|  |  | import 'package:ubuntu\_init/src/services/provd\_chown\_service.dart'; |
|  |  | import 'package:ubuntu\_init/src/services/provd\_gdm\_service.dart'; |
|  |  | import 'package:ubuntu\_init/src/services/provd\_identity\_service.dart'; |
|  |  | import 'package:ubuntu\_init/src/services/provd\_keyboard\_service.dart'; |
| Expand All | | @@ -22,7 +21,6 @@ export 'package:args/args.dart' show ArgResults; |
|  |  | export 'package:timezone\_map/timezone\_map.dart' show GeoService; |
|  |  |  |
|  |  | export 'services/provd\_accessibility\_service.dart'; |
|  |  | export 'services/provd\_chown\_service.dart'; |
|  |  | export 'services/provd\_gdm\_service.dart'; |
|  |  | export 'services/provd\_identity\_service.dart'; |
|  |  | export 'services/provd\_keyboard\_service.dart'; |
| Expand Down  Expand Up | | @@ -51,7 +49,6 @@ Future<void> registerInitServices(List<String> args) async { |
|  |  |  |
|  |  | tryRegisterService<ActiveDirectoryService>(RealmdActiveDirectoryService.new); |
|  |  | tryRegisterService<AccessibilityService>(ProvdAccessibilityService.new); |
|  |  | tryRegisterService<ChownService>(ProvdChownService.new); |
|  |  | tryRegisterService<ConfigService>(ConfigService.new); |
|  |  | tryRegisterService<GdmService>(ProvdGdmService.new); |
|  |  | tryRegisterServiceFactory<GSettings, String>(GSettings.new); |
| Expand Down | |  |

23 changes: 0 additions & 23 deletions

23
[packages/ubuntu\_init/lib/src/services/provd\_chown\_service.dart](#diff-0fe1b393023d6f8a4f83f014ef2114e8b85b392644ad174efde1b576e8b59bb8 "packages/ubuntu_init/lib/src/services/provd_chown_service.dart")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/packages/ubuntu_init/lib/src/services/provd_chown_service.dart)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

6 changes: 6 additions & 0 deletions

6
[provd/debian/changelog](#diff-0854333012b6c538fe6ad61dce27d68dfbab39056cc5af1d9a93a01c038d9293 "provd/debian/changelog")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/provd/debian/changelog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,9 @@ |
|  |  | provd (0.1.5~ppa1) noble; urgency=medium |
|  |  |  |
|  |  | \* Remove Ubuntu Pro and Chmod services |
|  |  |  |
|  |  | -- Matthew Gary Hagemann <matt.hagemann@canonical.com> Mon, 1 Jul 2024 14:23:46 +0200 |
|  |  |  |
|  |  | provd (0.1.4) noble; urgency=medium |
|  |  |  |
|  |  | \* Gnome-keyring now unlocked for wifi password prompt to appear during setup. |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[provd/debian/provd.install](#diff-ae08f37736aa03fae775ac84ca16a1fdaa1667edd9e7332f8b06cb6c09ce4c66 "provd/debian/provd.install")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/provd/debian/provd.install)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,2 @@ |
|  |  | usr/bin/provd usr/libexec/ |
|  |  | usr/bin/sprovd usr/libexec/ |
|  |  | debian/launch-desktop-provision-init usr/libexec/ |

2 changes: 0 additions & 2 deletions

2
[provd/debian/provd.postinst](#diff-775587b89727c7ff0956722775129478fd2922f9e628c8b8fea165834f006d12 "provd/debian/provd.postinst")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/provd/debian/provd.postinst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,9 +13,7 @@ case "$1" in |
|  |  | chmod 750 /usr/libexec/launch-desktop-provision-init |
|  |  |  |
|  |  | # Set ownership and permissions for bin's |
|  |  | chown root:provd /usr/libexec/sprovd |
|  |  | chown root:provd /usr/libexec/provd |
|  |  | chmod u+s /usr/libexec/sprovd |
|  |  | ;; |
|  |  | esac |
|  |  |  |
| Expand Down | |  |

108 changes: 0 additions & 108 deletions

108
[provd/internal/services/chown/chowm\_test.go](#diff-6aca2a175e82948d859c14436d6dadffb479cb8e4184ec0577784c0fa3ec719c "provd/internal/services/chown/chowm_test.go")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/chown/chowm_test.go)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

70 changes: 0 additions & 70 deletions

70
[provd/internal/services/chown/chown.go](#diff-eb08449ec96fdda4525fa2ea88edf06bdf7649d7c25599bf5a594438f2e9dee4 "provd/internal/services/chown/chown.go")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/chown/chown.go)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

11 changes: 0 additions & 11 deletions

11
[provd/internal/services/chown/export\_test.go](#diff-5a77459be144f14b618b1b13897b36eaf7db4be6688786530de3144984836606 "provd/internal/services/chown/export_test.go")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/chown/export_test.go)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

1 change: 0 additions & 1 deletion

1
[...internal/services/chown/testdata/TestChownSettings/golden/error\_when\_chown\_settings\_fails](#diff-a6056e2f21f0c7195229d8ca2bfaad41386a9cb44163e52c7a3dd34121b16b3b "provd/internal/services/chown/testdata/TestChownSettings/golden/error_when_chown_settings_fails")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/chown/testdata/TestChownSettings/golden/error_when_chown_settings_fails)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

Empty file removed
0

[...ervices/chown/testdata/TestChownSettings/golden/successfully\_chown\_settings\_to\_a\_new\_user](#diff-d27373e4d7ae7d45ce8390ae13abab2709722fc7704296e5ceb2f41416b57be7 "provd/internal/services/chown/testdata/TestChownSettings/golden/successfully_chown_settings_to_a_new_user")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/chown/testdata/TestChownSettings/golden/successfully_chown_settings_to_a_new_user)
Edit file

Delete file

Empty file.

18 changes: 0 additions & 18 deletions

18
[provd/internal/services/manager.go](#diff-17fb2e19af3632f8edd0b6bb809e9186cd3857ba051b13954c5d5c90d98d97d1 "provd/internal/services/manager.go")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/8d9086de0f82894ff27a9e429ff4f45231020092/provd/internal/services/manager.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,12 +8,10 @@ import ( |
|  |  | "log/slog" |
|  |  |  |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/accessibility" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/chown" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/gdm" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/keyboard" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/locale" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/privacy" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/pro" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/telemetry" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/timezone" |
|  |  | "github.com/canonical/ubuntu-desktop-provision/provd/internal/services/user" |
| Expand All | | @@ -33,8 +31,6 @@ type Manager struct { |
|  |  | privacyService privacy.Service |
|  |  | timezoneService timezone.Service |
|  |  | accessibilityService accessibility.Service |
|  |  | proService pro.Service |
|  |  | chownService chown.Service |
|  |  | telemetryService telemetry.Service |
|  |  | gdmService \*gdm.Service |
|  |  | bus \*dbus.Conn |
| Expand Down  Expand Up | | @@ -93,16 +89,6 @@ func NewManager(ctx context.Context) (m \*Manager, e error) { |
|  |  | return nil, status.Errorf(codes.Internal, "%s", errs) |
|  |  | } |
|  |  |  |
|  |  | proService, err := pro.New() |
|  |  | if err != nil { |
|  |  | return nil, status.Errorf(codes.Internal, "failed to create pro service: %s", err) |
|  |  | } |
|  |  |  |
|  |  | chownService, err := chown.New() |
|  |  | if err != nil { |
|  |  | return nil, status.Errorf(codes.Internal, "failed to create chown service: %s", err) |
|  |  | } |
|  |  |  |
|  |  | telemetryService, err := telemetry.New() |
|  |  | if err != nil { |
|  |  | return nil, status.Errorf(codes.Internal, "failed to create telemetry service: %s", err) |
| Expand All | | @@ -115,8 +101,6 @@ func NewManager(ctx context.Context) (m \*Manager, e error) { |
|  |  | privacyService: \*privacyService, |
|  |  | timezoneService: \*timezoneService, |
|  |  | accessibilityService: \*accessibilityService, |
|  |  | proService: \*proService, |
|  |  | chownService: \*chownService, |
|  |  | telemetryService: \*telemetryService, |
|  |  | gdmService: gdmService, |
|  |  | bus: bus, |
| Expand All | | @@ -135,8 +119,6 @@ func (m Manager) RegisterGRPCServices(ctx context.Context) \*grpc.Server { |
|  |  | pb.RegisterPrivacyServiceServer(grpcServer, &m.privacyService) |
|  |  | pb.RegisterTimezoneServiceServer(grpcServer, &m.timezoneService) |
|  |  | pb.RegisterAccessibilityServiceServer(grpcServer, &m.accessibilityService) |
|  |  | pb.RegisterProServiceServer(grpcServer, &m.proService) |
|  |  | pb.RegisterChownServiceServer(grpcServer, &m.chownService) |
|  |  | pb.RegisterTelemetryServiceServer(grpcServer, &m.telemetryService) |
|  |  |  |
|  |  | if m.gdmService != nil { |
| Expand Down | |  |

14 changes: 0 additions & 14 deletions

14
[provd/internal/services/pro/export\_test.go](#diff-6f75ba62addfd9ad3ce51b40be2152a3c85ac48d9f6209020d0d3294427b3831 "provd/internal/services/pro/export_test.go")

Show comments

[View file](/canonical/ubuntu-desktop-provision/blob/d4552766db6e210bd399d199930e2016bac1c7c0/provd/internal/services/pro/export_test.go)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8d9086d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fubuntu-desktop-provision%2Fcommit%2F8d9086de0f82894ff27a9e429ff4f45231020092) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


