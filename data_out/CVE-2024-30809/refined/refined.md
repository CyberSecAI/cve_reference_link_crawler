Based on the provided information, this content is related to CVE-2024-30809.

**Root Cause of Vulnerability:**
The root cause is a heap-use-after-free vulnerability in the Bento4 library, specifically triggered by the `mp42ts` tool. The vulnerability occurs when accessing memory that has already been freed.

**Weaknesses/Vulnerabilities Present:**
- Heap-use-after-free in `AP4_SubStream::~AP4_SubStream()` (BUG1)
- Heap-use-after-free in `AP4_UnknownAtom::~AP4_UnknownAtom()` (BUG2)
- Heap-use-after-free in `AP4_Sample::GetOffset()` (BUG3)

**Impact of Exploitation:**
The impact of exploitation is a Denial of Service (DoS) due to the program crashing when it attempts to access freed memory.

**Attack Vectors:**
The attack vector is by providing a specially crafted MP4 file as input to the `mp42ts` tool. This input triggers the vulnerability during processing.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide a malicious MP4 file to the vulnerable `mp42ts` tool.
- The attacker can be in any position where they can influence the input to the vulnerable application.

**More Details:**
The provided issue report includes ASan (AddressSanitizer) outputs and steps to reproduce the vulnerability. Specifically, it details the exact function calls and lines of code where the heap-use-after-free occurs. The provided ASan output clearly shows the memory location where the free occurs and where it is subsequently used. There are three distinct crash scenarios (BUG1, BUG2, BUG3) each involving a different location but all resulting in a heap-use-after-free. The affected version of Bento4 is v1.6.0-641.