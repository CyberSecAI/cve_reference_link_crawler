=== Content from git.kernel.org_c5871cc6_20250110_190550.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2024-01-11 18:17:44 +0200 |
| --- | --- | --- |
| committer | Johannes Berg <johannes.berg@intel.com> | 2024-01-18 14:50:21 +0100 |
| commit | [b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)) | |
| tree | [100fb4592dfd1285fee03e666d8d0ee0e8eced91](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26) | |
| parent | [26490da5a71da9064e58f0d4ce82756c26ef9eb1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=26490da5a71da9064e58f0d4ce82756c26ef9eb1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26&id2=26490da5a71da9064e58f0d4ce82756c26ef9eb1)) | |
| download | [linux-b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26.tar.gz) | |

wifi: mac80211: fix potential sta-link leakWhen a station is allocated, links are added but not
set to valid yet (e.g. during connection to an AP MLD),
we might remove the station without ever marking links
valid, and leak them. Fix that.
Fixes: cb71f1d136a6 ("wifi: mac80211: add sta link addition/removal")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Reviewed-by: Ilan Peer <ilan.peer@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6@changeid](https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)

| -rw-r--r-- | [net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/sta_info.c?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/net/mac80211/sta\_info.c b/net/mac80211/sta\_info.cindex 0ba613dd1cc478..c33decbb97f2d7 100644--- a/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=26490da5a71da9064e58f0d4ce82756c26ef9eb1)+++ b/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26)@@ -404,7 +404,10 @@ void sta\_info\_free(struct ieee80211\_local \*local, struct sta\_info \*sta) int i;  for (i = 0; i < ARRAY\_SIZE(sta->link); i++) {- if (!(sta->sta.valid\_links & BIT(i)))+ struct link\_sta\_info \*link\_sta;++ link\_sta = rcu\_access\_pointer(sta->link[i]);+ if (!link\_sta) continue;  sta\_remove\_link(sta, i, false); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:04:27 +0000



=== Content from git.kernel.org_164729f8_20250110_190549.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=587c5892976108674bbe61a8ff659de279318034)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=587c5892976108674bbe61a8ff659de279318034)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=587c5892976108674bbe61a8ff659de279318034)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=587c5892976108674bbe61a8ff659de279318034)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2024-01-11 18:17:44 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-31 16:19:00 -0800 |
| commit | [587c5892976108674bbe61a8ff659de279318034](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=587c5892976108674bbe61a8ff659de279318034) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=587c5892976108674bbe61a8ff659de279318034)) | |
| tree | [6bc14c942f24ce1fa012dd05d480a652047d5319](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=587c5892976108674bbe61a8ff659de279318034) | |
| parent | [3f5aab7efd402b7494eeacb00f352f8f20b40d2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f5aab7efd402b7494eeacb00f352f8f20b40d2d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=587c5892976108674bbe61a8ff659de279318034&id2=3f5aab7efd402b7494eeacb00f352f8f20b40d2d)) | |
| download | [linux-587c5892976108674bbe61a8ff659de279318034.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-587c5892976108674bbe61a8ff659de279318034.tar.gz) | |

wifi: mac80211: fix potential sta-link leak[ Upstream commit b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26 ]
When a station is allocated, links are added but not
set to valid yet (e.g. during connection to an AP MLD),
we might remove the station without ever marking links
valid, and leak them. Fix that.
Fixes: cb71f1d136a6 ("wifi: mac80211: add sta link addition/removal")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Reviewed-by: Ilan Peer <ilan.peer@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6@changeid](https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=587c5892976108674bbe61a8ff659de279318034)

| -rw-r--r-- | [net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/sta_info.c?id=587c5892976108674bbe61a8ff659de279318034) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/net/mac80211/sta\_info.c b/net/mac80211/sta\_info.cindex 0c5cc75857e4f4..e112300caaf755 100644--- a/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=3f5aab7efd402b7494eeacb00f352f8f20b40d2d)+++ b/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=587c5892976108674bbe61a8ff659de279318034)@@ -398,7 +398,10 @@ void sta\_info\_free(struct ieee80211\_local \*local, struct sta\_info \*sta) int i;  for (i = 0; i < ARRAY\_SIZE(sta->link); i++) {- if (!(sta->sta.valid\_links & BIT(i)))+ struct link\_sta\_info \*link\_sta;++ link\_sta = rcu\_access\_pointer(sta->link[i]);+ if (!link\_sta) continue;  sta\_remove\_link(sta, i, false); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:04:26 +0000



=== Content from git.kernel.org_debcc1bb_20250110_190548.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2024-01-11 18:17:44 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-31 16:17:03 -0800 |
| commit | [49aaeb8c539b1633b3bd7c2df131ec578aa1eae1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)) | |
| tree | [07287b15be957840111f59adb878eeb6623b4f66](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1) | |
| parent | [b59e08c872e0995328bbcd765f07f747d98b3ba4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b59e08c872e0995328bbcd765f07f747d98b3ba4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1&id2=b59e08c872e0995328bbcd765f07f747d98b3ba4)) | |
| download | [linux-49aaeb8c539b1633b3bd7c2df131ec578aa1eae1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-49aaeb8c539b1633b3bd7c2df131ec578aa1eae1.tar.gz) | |

wifi: mac80211: fix potential sta-link leak[ Upstream commit b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26 ]
When a station is allocated, links are added but not
set to valid yet (e.g. during connection to an AP MLD),
we might remove the station without ever marking links
valid, and leak them. Fix that.
Fixes: cb71f1d136a6 ("wifi: mac80211: add sta link addition/removal")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Reviewed-by: Ilan Peer <ilan.peer@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6@changeid](https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)

| -rw-r--r-- | [net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/sta_info.c?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/net/mac80211/sta\_info.c b/net/mac80211/sta\_info.cindex 49b71453dec370..f3d6c3e4c970e5 100644--- a/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=b59e08c872e0995328bbcd765f07f747d98b3ba4)+++ b/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=49aaeb8c539b1633b3bd7c2df131ec578aa1eae1)@@ -396,7 +396,10 @@ void sta\_info\_free(struct ieee80211\_local \*local, struct sta\_info \*sta) int i;  for (i = 0; i < ARRAY\_SIZE(sta->link); i++) {- if (!(sta->sta.valid\_links & BIT(i)))+ struct link\_sta\_info \*link\_sta;++ link\_sta = rcu\_access\_pointer(sta->link[i]);+ if (!link\_sta) continue;  sta\_remove\_link(sta, i, false); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:04:25 +0000



=== Content from git.kernel.org_5409394b_20250110_190550.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e04bf59bdba0fa45d52160be676114e16be855a9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e04bf59bdba0fa45d52160be676114e16be855a9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e04bf59bdba0fa45d52160be676114e16be855a9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e04bf59bdba0fa45d52160be676114e16be855a9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2024-01-11 18:17:44 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-31 16:21:04 -0800 |
| commit | [e04bf59bdba0fa45d52160be676114e16be855a9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e04bf59bdba0fa45d52160be676114e16be855a9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e04bf59bdba0fa45d52160be676114e16be855a9)) | |
| tree | [b784ac39f8dac4642d427704ea29e01ef8b2565a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e04bf59bdba0fa45d52160be676114e16be855a9) | |
| parent | [ebb67233acf708c0a943475af58b53da2b23ff3d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ebb67233acf708c0a943475af58b53da2b23ff3d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e04bf59bdba0fa45d52160be676114e16be855a9&id2=ebb67233acf708c0a943475af58b53da2b23ff3d)) | |
| download | [linux-e04bf59bdba0fa45d52160be676114e16be855a9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e04bf59bdba0fa45d52160be676114e16be855a9.tar.gz) | |

wifi: mac80211: fix potential sta-link leak[ Upstream commit b01a74b3ca6fd51b62c67733ba7c3280fa6c5d26 ]
When a station is allocated, links are added but not
set to valid yet (e.g. during connection to an AP MLD),
we might remove the station without ever marking links
valid, and leak them. Fix that.
Fixes: cb71f1d136a6 ("wifi: mac80211: add sta link addition/removal")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Reviewed-by: Ilan Peer <ilan.peer@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6@changeid](https://msgid.link/20240111181514.6573998beaf8.I09ac2e1d41c80f82a5a616b8bd1d9d8dd709a6a6%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e04bf59bdba0fa45d52160be676114e16be855a9)

| -rw-r--r-- | [net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/sta_info.c?id=e04bf59bdba0fa45d52160be676114e16be855a9) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/net/mac80211/sta\_info.c b/net/mac80211/sta\_info.cindex 0ba613dd1cc478..c33decbb97f2d7 100644--- a/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=ebb67233acf708c0a943475af58b53da2b23ff3d)+++ b/[net/mac80211/sta\_info.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/sta_info.c?id=e04bf59bdba0fa45d52160be676114e16be855a9)@@ -404,7 +404,10 @@ void sta\_info\_free(struct ieee80211\_local \*local, struct sta\_info \*sta) int i;  for (i = 0; i < ARRAY\_SIZE(sta->link); i++) {- if (!(sta->sta.valid\_links & BIT(i)))+ struct link\_sta\_info \*link\_sta;++ link\_sta = rcu\_access\_pointer(sta->link[i]);+ if (!link\_sta) continue;  sta\_remove\_link(sta, i, false); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:04:27 +0000


