=== Content from www.openwall.com_d38746eb_20250110_151944.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2023/07/27/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <369A681F-5EC7-4399-A428-66ECAC1BF4F5@beckweb.net>
Date: Wed, 26 Jul 2023 15:25:47 +0200
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins and Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* Jenkins 2.416
* Jenkins LTS 2.401.3
* GitLab Authentication Plugin 1.18
* Gradle Plugin 2.8.1
* Qualys Web App Scanning Connector Plugin 2.0.11
* ServiceNow DevOps Plugin 1.38.1

Additionally, we announce unresolved security issues in the following
plugins:

* Bazaar Plugin
* Chef Identity Plugin

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://www.jenkins.io/security/advisory/2023-07-26/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-3188 / CVE-2023-39151
Jenkins applies formatting to the console output of builds, transforming
plain URLs into hyperlinks.

Jenkins 2.415 and earlier, LTS 2.401.2 and earlier does not sanitize or
properly encode URLs of these hyperlinks in build logs.

This results in a stored cross-site scripting (XSS) vulnerability
exploitable by attackers able to control build log contents.

SECURITY-3208 / CVE-2023-39152
Gradle Plugin 2.8 improperly invokes APIs available only on the controller
from an agent when setting up build log annotations, causing an exception.

As a result, credentials may not be masked (i.e., replaced with asterisks)
in the build log in some circumstances.

SECURITY-2696 / CVE-2023-39153
GitLab Authentication Plugin 1.17.1 and earlier does not implement a state
parameter in its OAuth flow, a unique and non-guessable value associated
with each authentication request.

This vulnerability allows attackers to trick users into logging in to the
attacker's account.

SECURITY-3129 / CVE-2023-3414 (CSRF) & CVE-2023-3442 (missing permission check)
ServiceNow DevOps Plugin 1.38.0 and earlier does not perform a permission
check in a method implementing form validation.

This allows attackers with Overall/Read permission to connect to an
attacker-specified URL using attacker-specified credentials IDs obtained
through another method, capturing credentials stored in Jenkins.

Additionally, this form validation method does not require POST requests,
resulting in a cross-site request forgery (CSRF) vulnerability.

SECURITY-3012 / CVE-2023-39154
Qualys Web App Scanning Connector Plugin 2.0.10 and earlier does not
correctly perform permission checks in several HTTP endpoints.

This allows attackers with global Item/Configure permission to connect to
an attacker-specified URL using attacker-specified credentials IDs obtained
through another method, capturing credentials stored in Jenkins.

SECURITY-3192 / CVE-2023-39155
Chef Identity Plugin stores the user.pem key in its global configuration
file `io.chef.jenkins.ChefIdentityBuildWrapper.xml` on the Jenkins
controller as part of its configuration.

While this key is stored encrypted on disk, in Chef Identity Plugin 2.0.3
and earlier the global configuration form does not mask the user.pem key
form field, increasing the potential for attackers to observe and capture
it.

As of publication of this advisory, there is no fix.

SECURITY-3095 / CVE-2023-39156
Bazaar Plugin 1.22 and earlier does not require POST requests for an HTTP
endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to delete previously created Bazaar SCM
tags.

As of publication of this advisory, there is no fix.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.jenkins.io_3fed5584_20250110_151945.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2023-07-26

This advisory announces vulnerabilities in the following Jenkins deliverables:

* Jenkins (core)
* [Bazaar
  Plugin](https://plugins.jenkins.io/bazaar)
* [Chef Identity
  Plugin](https://plugins.jenkins.io/chef-identity)
* [GitLab Authentication
  Plugin](https://plugins.jenkins.io/gitlab-oauth)
* [Gradle
  Plugin](https://plugins.jenkins.io/gradle)
* [Qualys Web App Scanning Connector
  Plugin](https://plugins.jenkins.io/qualys-was)
* [ServiceNow DevOps
  Plugin](https://plugins.jenkins.io/servicenow-devops)

## Descriptions

### Stored XSS vulnerability

**SECURITY-3188
/
CVE-2023-39151**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)

**Description:**

Jenkins applies formatting to the console output of builds, transforming plain URLs into hyperlinks.

Jenkins 2.415 and earlier, LTS 2.401.2 and earlier does not sanitize or properly encode URLs of these hyperlinks in build logs.

This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to control build log contents.

Jenkins 2.416, LTS 2.401.3, and LTS 2.414.1 encode URLs of affected hyperlink annotations in build logs.

### Incorrect control flow in Gradle Plugin breaks credentials masking in the build log

**SECURITY-3208
/
CVE-2023-39152**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`gradle`](https://plugins.jenkins.io/gradle)**

**Description:**

Gradle Plugin 2.8 improperly invokes APIs available only on the controller from an agent when setting up build log annotations, causing an exception.

As a result, credentials may not be masked (i.e., replaced with asterisks) in the build log in some circumstances.

Gradle Plugin 2.8.1 improves the control flow and handles the exception, so that credentials masking is not affected.

|  | An improvement in [Pipeline: API](https://plugins.jenkins.io/workflow-api/) 1232.v1679fa\_2f0f76 prevents issues like this from affecting credentials masking in the future. As of the publication of this advisory, the Jenkins security team is not aware of other plugins with a similar issue. |
| --- | --- |

### CSRF vulnerability in GitLab Authentication Plugin

**SECURITY-2696
/
CVE-2023-39153**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N)

**Affected plugin:
[`gitlab-oauth`](https://plugins.jenkins.io/gitlab-oauth)**

**Description:**

GitLab Authentication Plugin 1.17.1 and earlier does not implement a state parameter in its OAuth flow, a unique and non-guessable value associated with each authentication request.

This vulnerability allows attackers to trick users into logging in to the attacker’s account.

GitLab Authentication Plugin 1.18 implements a state parameter in its OAuth flow.

### CSRF vulnerability and missing permission check in ServiceNow DevOps Plugin allow capturing credentials

**SECURITY-3129
/
CVE-2023-3414 (CSRF), CVE-2023-3442 (missing permission check)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`servicenow-devops`](https://plugins.jenkins.io/servicenow-devops)**

**Description:**

ServiceNow DevOps Plugin 1.38.0 and earlier does not perform a permission check in a method implementing form validation.

This allows attackers with Overall/Read permission to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

Additionally, this form validation method does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.

ServiceNow DevOps Plugin 1.38.1 requires POST requests and Overall/Administer permission for the affected form validation method.

### Incorrect permission checks in Qualys Web App Scanning Connector Plugin allow capturing credentials

**SECURITY-3012
/
CVE-2023-39154**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`qualys-was`](https://plugins.jenkins.io/qualys-was)**

**Description:**

Qualys Web App Scanning Connector Plugin 2.0.10 and earlier does not correctly perform permission checks in several HTTP endpoints.

This allows attackers with global Item/Configure permission to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

Qualys Web App Scanning Connector Plugin 2.0.11 requires the appropriate permissions for the affected HTTP endpoints.

### Secret displayed without masking by Chef Identity Plugin

**SECURITY-3192
/
CVE-2023-39155**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)

**Affected plugin:
[`chef-identity`](https://plugins.jenkins.io/chef-identity)**

**Description:**

Chef Identity Plugin stores the user.pem key in its global configuration file `io.chef.jenkins.ChefIdentityBuildWrapper.xml` on the Jenkins controller as part of its configuration.

While this key is stored encrypted on disk, in Chef Identity Plugin 2.0.3 and earlier the global configuration form does not mask the user.pem key form field, increasing the potential for attackers to observe and capture it.

As of publication of this advisory, there is no fix.
[Learn why we announce this.](/security/plugins/#unresolved)

### CSRF vulnerability in Bazaar Plugin

**SECURITY-3095
/
CVE-2023-39156**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

**Affected plugin:
[`bazaar`](https://plugins.jenkins.io/bazaar)**

**Description:**

Bazaar Plugin 1.22 and earlier does not require POST requests for an HTTP endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to delete previously created Bazaar SCM tags.

As of publication of this advisory, there is no fix.
[Learn why we announce this.](/security/plugins/#unresolved)

## Severity

* SECURITY-2696:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N)
* SECURITY-3012:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-3095:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)
* SECURITY-3129:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-3188:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-3192:
  [Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)
* SECURITY-3208:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

## Affected Versions

* **Jenkins weekly**
  up to and including
  2.415
* **Jenkins LTS**
  up to and including
  2.401.2
* **Bazaar
  Plugin**
  up to and including
  1.22
* **Chef Identity
  Plugin**
  up to and including
  2.0.3
* **GitLab Authentication
  Plugin**
  up to and including
  1.17.1
* **Gradle
  Plugin**
  up to and including
  2.8
* **Qualys Web App Scanning Connector
  Plugin**
  up to and including
  2.0.10
* **ServiceNow DevOps
  Plugin**
  up to and including
  1.38.0

## Fix

* **Jenkins weekly**
  should be updated to version
  2.416
* **Jenkins LTS**
  should be updated to version
  2.401.3 or 2.414.1
* **GitLab Authentication
  Plugin**
  should be updated to version
  1.18
* **Gradle
  Plugin**
  should be updated to version
  2.8.1
* **Qualys Web App Scanning Connector
  Plugin**
  should be updated to version
  2.0.11
* **ServiceNow DevOps
  Plugin**
  should be updated to version
  1.38.1

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

As of publication of this advisory, no fixes are available for the following plugins:

* Bazaar
  Plugin
* Chef Identity
  Plugin

[Learn why we announce these issues.](/security/plugins/#unresolved)

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Alvaro MuÃ±oz (@pwntester), GitHub Security Lab**
  for
  SECURITY-3129
* **Andrea Chiera, CloudBees, Inc.**
  for
  SECURITY-3192
* **Kevin Guerroudj, CloudBees, Inc.**
  for
  SECURITY-3095
* **Kevin Guerroudj, CloudBees, Inc. and Devin Nusbaum, CloudBees, Inc.**
  for
  SECURITY-3188
* **Wadeck Follonier, CloudBees Inc.**
  for
  SECURITY-2696
* **Yaroslav Afenkin, CloudBees, Inc.**
  for
  SECURITY-3012


