=== Content from phabricator.wikimedia.org_4fcd79e0_20250110_193643.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT363884)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T363884
# CVE-2024-40603: Special:ChangeRating is vulnerable to CSRFClosed, Resolved[Public](/policy/explain/PHID-TASK-g4yw3eejmafh6xb6pobz/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/363884/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/363884/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Protect as security issue](/wmf/escalate-task/363884/)
* [Award Token](/token/give/PHID-TASK-g4yw3eejmafh6xb6pobz/)
* [Flag For Later](/flag/edit/PHID-TASK-g4yw3eejmafh6xb6pobz/)

Assigned To

|  | [ashley](/p/ashley/) |
| --- | --- |

Authored By

|  | [ashley](/p/ashley/) |
| --- | --- |
| May 1 2024, 1:02 AM2024-05-01 01:02:36 (UTC+0) |

Tags

* [Security](/tag/security/)
* [ArticleRatings](/tag/articleratings/) [(Bugs)](/project/board/1948/)
* [Vuln-CSRF](/tag/vuln-csrf/) [(Tracked)](/project/board/907/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [ashley](/p/ashley/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

# Description

Special:ChangeRating can be used to change a page's rating, but the page has no token checking and on top of that, it does write queries on a GET request (!).

I'll fix this soon-ish together with a bunch of other "modernization"/cleanup patches to ARE...

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [[SECURITY] Fix CSRF in Special:ChangeRating](https://gerrit.wikimedia.org/r/c/1051766) | [mediawiki/extensions/ArticleRatings](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings) | [REL1\_41](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings/%2B/REL1_41) | +14 -4 |
|  | [[SECURITY] Fix CSRF in Special:ChangeRating](https://gerrit.wikimedia.org/r/c/1051767) | [mediawiki/extensions/ArticleRatings](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings) | [REL1\_42](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings/%2B/REL1_42) | +14 -4 |
|  | [[SECURITY] Fix CSRF in Special:ChangeRating](https://gerrit.wikimedia.org/r/c/1051768) | [mediawiki/extensions/ArticleRatings](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings/%2B/REL1_40) | +14 -4 |
|  | [[SECURITY] Fix CSRF in Special:ChangeRating](https://gerrit.wikimedia.org/r/c/1026188) | [mediawiki/extensions/ArticleRatings](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/ArticleRatings/%2B/master) | +14 -4 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T363884)
# Related Objects

* Mentions

Mentioned In [rEARA319b62b4d168: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARA319b62b4d1683b137e51a529ab63f3ce12a6d003)
[rEARAafe43a708efd: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARAafe43a708efd1de4416a8ffaf8daa41ca8581c54)
[T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321)
[rEARAc4cb89b5e65c: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARAc4cb89b5e65c58099acf694cc971f04cb3e046f9)
### Event Timeline

[ashley](/p/ashley/) created this task.[May 1 2024, 1:02 AM2024-05-01 01:02:36 (UTC+0)](#9760095)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/5907502/)[May 1 2024, 1:02 AM2024-05-01 01:02:37 (UTC+0)](#9760105)[ashley](/p/ashley/) claimed this task.[May 1 2024, 1:03 AM2024-05-01 01:03:16 (UTC+0)](#9760106)[ashley](/p/ashley/) added projects: [ArticleRatings](/tag/articleratings/), [Vuln-CSRF](/tag/vuln-csrf/).[ashley](/p/ashley/) moved this task from [Backlog](/project/board/1948/) to [Bugs](/project/board/1948/) on the [ArticleRatings](/tag/articleratings/) board.[May 1 2024, 1:52 PM2024-05-01 13:52:03 (UTC+0)](#9760983)[Bawolff](/p/Bawolff/) subscribed.[May 1 2024, 10:26 PM2024-05-01 22:26:51 (UTC+0)](#9762415)Comment Actions

the patch at <https://pastebin.com/9wVWHEpa> lgtm

[ashley](/p/ashley/) mentioned this in [rEARAc4cb89b5e65c: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARAc4cb89b5e65c58099acf694cc971f04cb3e046f9).[May 1 2024, 10:44 PM2024-05-01 22:44:08 (UTC+0)](#9762516)[ashley](/p/ashley/) closed this task as Resolved.[May 1 2024, 10:49 PM2024-05-01 22:49:35 (UTC+0)](#9762526)[Bawolff](/p/Bawolff/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-zekxpwf5f5l256k/)" to "Public (No Login Required)".[May 1 2024, 10:52 PM2024-05-01 22:52:04 (UTC+0)](#9762531)[Bawolff](/p/Bawolff/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-43i5ekgnawbsybe/)" to "All Users".[sbassett](/p/sbassett/) edited projects, added [SecTeam-Processed](/tag/secteam-processed/); removed [Security-Team](/tag/security-team/).[May 2 2024, 3:24 PM2024-05-02 15:24:30 (UTC+0)](#9764274)[sbassett](/p/sbassett/) mentioned this in [T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321).[gerritbot](/p/gerritbot/) added a comment.[Jul 3 2024, 2:39 PM2024-07-03 14:39:49 (UTC+0)](#9949853)Comment Actions

Change #1051766 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/extensions/ArticleRatings@REL1\_41] [SECURITY] Fix CSRF in Special:ChangeRating

<https://gerrit.wikimedia.org/r/1051766>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Jul 3 2024, 2:39 PM2024-07-03 14:39:50 (UTC+0)](#9949854)Comment Actions

Change #1051767 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/extensions/ArticleRatings@REL1\_42] [SECURITY] Fix CSRF in Special:ChangeRating

<https://gerrit.wikimedia.org/r/1051767>

[gerritbot](/p/gerritbot/) added a comment.[Jul 3 2024, 2:42 PM2024-07-03 14:42:15 (UTC+0)](#9949870)Comment Actions

Change #1051768 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/extensions/ArticleRatings@REL1\_40] [SECURITY] Fix CSRF in Special:ChangeRating

<https://gerrit.wikimedia.org/r/1051768>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:38 PM2024-07-05 19:38:28 (UTC+0)](#9957555)Comment Actions

Change #1051768 **abandoned** by Umherirrender:

[mediawiki/extensions/ArticleRatings@REL1\_40] [SECURITY] Fix CSRF in Special:ChangeRating

Reason:

REL1\_40 is end of life

<https://gerrit.wikimedia.org/r/1051768>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:45 PM2024-07-05 19:45:36 (UTC+0)](#9957577)Comment Actions

Change #1051767 **merged** by Umherirrender:

[mediawiki/extensions/ArticleRatings@REL1\_42] [SECURITY] Fix CSRF in Special:ChangeRating

<https://gerrit.wikimedia.org/r/1051767>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:46 PM2024-07-05 19:46:21 (UTC+0)](#9957579)Comment Actions

Change #1051766 **merged** by jenkins-bot:

[mediawiki/extensions/ArticleRatings@REL1\_41] [SECURITY] Fix CSRF in Special:ChangeRating

<https://gerrit.wikimedia.org/r/1051766>

[mmartorana](/p/mmartorana/) mentioned this in [rEARAafe43a708efd: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARAafe43a708efd1de4416a8ffaf8daa41ca8581c54).[Jul 5 2024, 7:50 PM2024-07-05 19:50:06 (UTC+0)](#9957585)[mmartorana](/p/mmartorana/) mentioned this in [rEARA319b62b4d168: [SECURITY] Fix CSRF in Special:ChangeRating](/rEARA319b62b4d1683b137e51a529ab63f3ce12a6d003).[mmartorana](/p/mmartorana/) renamed this task from Special:ChangeRating is vulnerable to CSRF to CVE-2024-40603: Special:ChangeRating is vulnerable to CSRF.[Jul 8 2024, 5:38 PM2024-07-08 17:38:06 (UTC+0)](#9962257)[Maintenance\_bot](/p/Maintenance_bot/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[Jul 9 2024, 7:51 PM2024-07-09 19:51:38 (UTC+0)](#9966881)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
