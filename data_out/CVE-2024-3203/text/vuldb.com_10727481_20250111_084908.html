![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)üõ° Home[Submit](?submit)304556
# Submit #304556: blosc c-blosc2 1dd1e55cb329d01c210da77ceb53027853c35b72 heap-buffer-overflow[info](?kb.submission)

| Title | blosc c-blosc2 1dd1e55cb329d01c210da77ceb53027853c35b72 heap-buffer-overflow |
| --- | --- |
| Description | ## Description [c-blosc2](https://github.com/Blosc/c-blosc2) has heap-buffer-overflow in ndlz8\_decompress /src/c-blosc2/plugins/codecs/ndlz/ndlz8x8.c:468:3 ## version ```shell commit 1dd1e55cb329d01c210da77ceb53027853c35b72 ``` ## harnss From https://github.com/Blosc/c-blosc2/blob/main/tests/fuzz/fuzz\_decompress\_chunk.c ```c++ #include <stdint.h> #include <stdlib.h> #include <blosc2.h> #ifdef \_\_cplusplus extern "C" { #endif int LLVMFuzzerTestOneInput(const uint8\_t \*data, size\_t size) { size\_t nbytes = 0, cbytes = 0, blocksize = 0; void \*output = NULL; if (size < BLOSC\_MIN\_HEADER\_LENGTH) { return 0; } blosc2\_init(); blosc2\_set\_nthreads(1); blosc1\_cbuffer\_sizes(data, &nbytes, &cbytes, &blocksize); if (cbytes != size || nbytes == 0) { blosc2\_destroy(); return 0; } if (blosc1\_cbuffer\_validate(data, size, &nbytes) != 0) { /\* Unexpected `nbytes` specified in blosc header \*/ blosc2\_destroy(); return 0; } output = malloc(cbytes); if (output != NULL) { blosc2\_decompress(data, (int32\_t)size, output, (int32\_t)cbytes); free(output); } blosc2\_destroy(); return 0; } #ifdef \_\_cplusplus } #endif ``` ## Proof of Concept The poc can be obtained from Google Drive: https://drive.google.com/drive/folders/1T1k3UeS09m65LjVXExUuZfedNQPWQWCo?usp=sharing ```shell $ ./decompress\_chunk\_fuzzer dbb107d7-a7e3-4c4c-a758-8abf63983136 INFO: Running with entropic power schedule (0xFF, 100). INFO: Seed: 2069136812 INFO: Loaded 1 modules (47965 inline 8-bit counters): 47965 [0xc89df0, 0xc9594d), INFO: Loaded 1 PC tables (47965 PCs): 47965 [0xc95950,0xd50f20), ./decompress\_chunk\_fuzzer: Running 1 inputs 1 time(s) each. Running: dbb107d7-a7e3-4c4c-a758-8abf63983136 ================================================================= ==4100452==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6140000001a4 at pc 0x00000053f3ee bp 0x7fffffffd440 sp 0x7fffffffcc10 WRITE of size 134217728 at 0x6140000001a4 thread T0 #0 0x53f3ed in \_\_asan\_memset /src/llvm-project/compiler-rt/lib/asan/asan\_interceptors\_memintrinsics.cpp:26:3 #1 0xa224b9 in ndlz8\_decompress /src/c-blosc2/plugins/codecs/ndlz/ndlz8x8.c:468:3 #2 0x596f49 in blosc\_d /src/c-blosc2/blosc/blosc2.c:1870:24 #3 0x5a1189 in serial\_blosc /src/c-blosc2/blosc/blosc2.c:1971:16 #4 0x5a1189 in do\_job /src/c-blosc2/blosc/blosc2.c:2138:15 #5 0x58f209 in blosc\_run\_decompression\_with\_context /src/c-blosc2/blosc/blosc2.c:2920:13 #6 0x58f775 in blosc2\_decompress /src/c-blosc2/blosc/blosc2.c:2998:12 #7 0x57d410 in LLVMFuzzerTestOneInput /src/c-blosc2/tests/fuzz/fuzz\_decompress\_chunk.c:34:5 #8 0x44eb03 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const\*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15 #9 0x429c92 in fuzzer::RunOneTest(fuzzer::Fuzzer\*, char const\*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:337:6 #10 0x434d71 in fuzzer::FuzzerDriver(int\*, char\*\*\*, int (\*)(unsigned char const\*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:1053:9 #11 0x468ea2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10 #12 0x7ffff7c43082 in \_\_libc\_start\_main /build/glibc-wuryBv/glibc-2.31/csu/../csu/libc-start.c:308:16 #13 0x41fe5d in \_start (/home/zhangwei28/80result/c-blosc2/decompress\_chunk\_fuzzer+0x41fe5d) 0x6140000001a4 is located 0 bytes to the right of 356-byte region [0x614000000040,0x6140000001a4) allocated by thread T0 here: #0 0x5408c7 in posix\_memalign /src/llvm-project/compiler-rt/lib/asan/asan\_malloc\_linux.cpp:145:3 #1 0x5993e3 in my\_malloc /src/c-blosc2/blosc/blosc2.c:188:9 #2 0x5993e3 in init\_thread\_context /src/c-blosc2/blosc/blosc2.c:2028:25 #3 0x59911d in create\_thread\_context /src/c-blosc2/blosc/blosc2.c:2065:12 #4 0x5a0a9b in do\_job /src/c-blosc2/blosc/blosc2.c:2131:33 #5 0x58f209 in blosc\_run\_decompression\_with\_context /src/c-blosc2/blosc/blosc2.c:2920:13 #6 0x58f775 in blosc2\_decompress /src/c-blosc2/blosc/blosc2.c:2998:12 #7 0x57d410 in LLVMFuzzerTestOneInput /src/c-blosc2/tests/fuzz/fuzz\_decompress\_chunk.c:34:5 #8 0x44eb03 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const\*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15 #9 0x429c92 in fuzzer::RunOneTest(fuzzer::Fuzzer\*, char const\*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:337:6 #10 0x434d71 in fuzzer::FuzzerDriver(int\*, char\*\*\*, int (\*)(unsigned char const\*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:1053:9 #11 0x468ea2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10 #12 0x7ffff7c43082 in \_\_libc\_start\_main /build/glibc-wuryBv/glibc-2.31/csu/../csu/libc-start.c:308:16 SUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/asan\_interceptors\_memintrinsics.cpp:26:3 in \_\_asan\_memset Shadow bytes around the buggy address: 0x0c287fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c287fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c287fff8000: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c287fff8010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c287fff8020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c287fff8030: 00 00 00 00[04]fa fa fa fa fa fa fa fa fa fa fa 0x0c287fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c287fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c287fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c287fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c287fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Container overflow: fc Array cookie: ac Intra object redzone: bb ASan internal: fe Left alloca redzone: ca Right alloca redzone: cb ==4100452==ABORTING ``` |
| Source | ‚ö†Ô∏è https://drive.google.com/drive/folders/1T1k3UeS09m65LjVXExUuZfedNQPWQWCo?usp=sharing |
| User | [Anonymous User](?kb.anonymous) |
| Submission | 03/26/2024 08:50 AM (10 months ago) |
| Moderation | 04/02/2024 06:34 PM (7 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [259050](?id.259050) [c-blosc2 up to 2.13.2 ndlz8x8.c ndlz8\_decompress heap-based overflow] |
| Points | 20 |

[‚óÇ Previous](?submit.304555)[Overview](?submit)[Next ‚ñ∏](?submit.304557)

# Are you interested in using VulDB?

Download the whitepaper to learn more about our service!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[¬© 1997-2025 vuldb.com](?kb.terms) ¬∑ [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.304556 "German") ¬∑ [fr](/fr/?submit.304556 "French") ¬∑ [it](/it/?submit.304556 "Italian") ¬∑ [es](/es/?submit.304556 "Spanish") ¬∑ [pt](/pt/?submit.304556 "Portuguese") ¬∑ [ru](/ru/?submit.304556 "Russian") ¬∑ [pl](/pl/?submit.304556 "Polish") ¬∑ [sv](/sv/?submit.304556 "Swedish") ¬∑ [zh](/zh/?submit.304556 "Chinese") ¬∑ [ja](/ja/?submit.304556 "Japanese") ¬∑ [ar](/ar/?submit.304556 "Arabic")[v18.14.7](?kb.changelog)