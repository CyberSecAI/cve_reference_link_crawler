Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-47524

**Root Cause of Vulnerability:** The application fails to sanitize user input when creating or editing a "Device Group" name. This allows an attacker to inject malicious JavaScript code.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. The injected JavaScript is saved in the database and executed when other users view the device group details.

**Impact of Exploitation:**
*   **Malicious JavaScript Execution:** An attacker can execute arbitrary JavaScript code in the context of a user's browser when they view a device group with a malicious name.
*   **Potential Account Takeover:** The injected JavaScript could be used to steal cookies, redirect users to malicious sites, or perform actions on behalf of the user, potentially leading to account compromise.
*   **Impact on all Users:** Since anyone can access the details page of the device group, all users are at risk of exploitation.

**Attack Vectors:**
*   **Network:** The vulnerability is exploitable over the network, as it involves a web-based application.

**Required Attacker Capabilities/Position:**
*   **Admin Role:** The attacker needs to have an admin role within the application to create or modify device groups.
*   **Access to Device Group Creation/Edit Functionality:** The attacker needs to be able to access the specific web page to create or edit the device groups.

**Technical Details:**
*   The vulnerability exists within the `includes/html/pages/devices.inc.php` file. Specifically, the `device_group_name` was not being properly sanitized before being rendered on the page.
*   The fix involves using `htmlentities()` to properly encode the `device_group_name` before outputting it to the HTML.
*   The Proof of Concept (PoC) demonstrates injecting `<img src="x" onerror="alert(document.cookie)">` as the device group name, which triggers a JavaScript alert popup when the page is viewed, thus confirming the XSS vulnerability.

**CVSS v3 Metrics:**
*   **Attack Vector:** Network (N)
*   **Attack Complexity:** Low (L)
*   **Privileges Required:** High (H)
*   **User Interaction:** None (N)
*   **Scope:** Unchanged (U)
*   **Confidentiality:** High (H)
*   **Integrity:** High (H)
*   **Availability:** High (H)
*   **CVSS Score:** 7.2

**Patched Versions:** 24.9.0

**Affected Versions:** 24.6.0

**CWE:** CWE-80 (Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS))