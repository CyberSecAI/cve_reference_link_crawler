=== Content from bugzilla.mozilla.org_12de78c1_20250110_194058.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1773874)
* [XML](/show_bug.cgi?ctype=xml&id=1773874)

Closed
[Bug 1773874](/show_bug.cgi?id=1773874)
(CVE-2023-4582)

Opened 3 years ago
Closed 1 years ago

# WebGL glGetProgramiv Buffer Overflow Vulnerability

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

WebGL glGetProgramiv Buffer Overflow Vulnerability

## Categories

### (Core :: Graphics: CanvasWebGL, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20CanvasWebGL#Graphics%3A%20CanvasWebGL)

Graphics: CanvasWebGL
▾

Core :: Graphics: CanvasWebGL
Bugs with the WebGL Canvas Context.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20CanvasWebGL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 101

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

118 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified) |
| firefox118 | [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 117+ | verified |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox117 | + | verified |
| firefox118 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: contact, Assigned: ErichDonGubler)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/4d274a8f8d707b0fc831c2027ffb0168?d=mm&size=40)  [ErichDonGubler](/user_profile?user_id=713343)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/73252f04cda9564465da60e2333c66b3?d=mm&size=40)  [contact](/user_profile?user_id=689218)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

Dependency [tree](/showdependencytree.cgi?id=1773874&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1773874)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1842110](/show_bug.cgi?id=1842110 "RESOLVED DUPLICATE - OOB Access in Firefox WebGL")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-29531](/show_bug.cgi?id=1794292 "RESOLVED FIXED - Firefox WebGL glvmInterpretFPTransformFour Memory Corruption Vulnerability"), [CVE-2023-6856](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)")

## Details

### (4 keywords, Whiteboard: [adv-main117+][adv-esr115.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4582

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main117+][adv-esr115.2+]

QA Whiteboard:

[post-critsmash-triage][qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ \_\_\_chkstk\_darwin ]](https://crash-stats.mozilla.org/signature/?signature=___chkstk_darwin)

[[@ thread\_start ]](https://crash-stats.mozilla.org/signature/?signature=thread_start)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (9 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=9280834)  [3 years ago](#c0)  [SSD Secure Disclosure](/user_profile?user_id=689218)   5.23 KB, text/html |  | [Details](/attachment.cgi?id=9280834&action=edit) |
| --- | --- | --- |
| [report.md](/attachment.cgi?id=9280835)  [3 years ago](#c1)  [SSD Secure Disclosure](/user_profile?user_id=689218)   10.12 KB, text/plain |  | [Details](/attachment.cgi?id=9280835&action=edit) |
| [debug crash report](/attachment.cgi?id=9281446)  [3 years ago](#c3)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   11.16 KB, text/plain |  | [Details](/attachment.cgi?id=9281446&action=edit) |
| [Bug 1773874: normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` r=jgilbert](/attachment.cgi?id=9344947)  [1 years ago](#c18)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9344947&action=edit) | [Review](/attachment.cgi?id=9344947) |
| [Bug 1773874: build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor\_from\_git` r=jgilbert](/attachment.cgi?id=9344948)  [1 years ago](#c19)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9344948&action=edit) | [Review](/attachment.cgi?id=9344948) |
| [Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert](/attachment.cgi?id=9344949)  [1 years ago](#c20)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9344949&action=edit) | [Review](/attachment.cgi?id=9344949) |
| [Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](/attachment.cgi?id=9347301)  [1 years ago](#c27)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c33 "1 years ago") | [Details](/attachment.cgi?id=9347301&action=edit) | [Review](/attachment.cgi?id=9347301) |
| [Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](/attachment.cgi?id=9347302)  [1 years ago](#c28)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9347302&action=edit) | [Review](/attachment.cgi?id=9347302) |
| [Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](/attachment.cgi?id=9347304)  [1 years ago](#c30)  [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c34 "1 years ago") | [Details](/attachment.cgi?id=9347304&action=edit) | [Review](/attachment.cgi?id=9347304) |
| [advisory.txt](/attachment.cgi?id=9350222)  [1 year ago](#c39)  [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341)   275 bytes, text/plain |  | [Details](/attachment.cgi?id=9350222&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [SSD Secure Disclosure](/user_profile?user_id=689218)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1773874#c0)• 3 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9280834)
— [Details](attachment.cgi?id=9280834&action=edit)

Steps to reproduce:

A Buffer Overflow vulnerability exists in the Firefox OpenGL in glGetProgramiv. An attacker must open a arbitrary generated HTML file to exploit this vulnerability.

* This vulnerability only works on macOS.

# Test environment

* OS : macOS Monterey 12.4(21F79)
* iMac GPU : AMD Radeon Pro Vega 48
* Product : Mozilla Firefox 101.0.1 (64-bit)

\*\* As of my testing, this vulnerability only works on macOS. \*\*

Actual results:

## Root Cause Analysis

* A Buffer Overflow vulnerability exists in the Firefox OpenGL in glGetProgramiv.

  ```
  * thread #36, name = 'Compositor', queue = 'OpenGLMT', stop reason = EXC_BAD_ACCESS (code=2, address=0x700009632ff8)
      frame #0: 0x00007ff80513dfa7 libsystem_pthread.dylib`___chkstk_darwin + 55
  libsystem_pthread.dylib`___chkstk_darwin:
  ->  0x7ff80513dfa7 <+55>: test   qword ptr [rcx - 0x8], rcx
      0x7ff80513dfab <+59>: cmp    rax, 0x1000
      0x7ff80513dfb1 <+65>: jb     0x7ff80513dfcd            ; <+93>
      0x7ff80513dfb3 <+67>: push   rax
  Target 0: (firefox) stopped.

  (lldb) reg read
  General Purpose Registers:
         rax = 0x0000000000100000
         rbx = 0x00007000096b1290
         rcx = 0x0000700009633000
         rdx = 0x0000000000000000
         rdi = 0x0000000000040000
         rsi = 0x0000000000000000
         rbp = 0x00007000096b1320
         rsp = 0x00007000096b1268
          r8 = 0x0000000000000043
          r9 = 0x0000000000000000
         r10 = 0x0000000000041002
         r11 = 0x0000000000000202
         r12 = 0x000000012e5a7440
         r13 = 0x0000000000000000
         r14 = 0x000000012e5a7480
         r15 = 0x00007000096b1c90
         rip = 0x00007ff80513dfa7  libsystem_pthread.dylib`___chkstk_darwin + 55
      rflags = 0x0000000000010216
          cs = 0x000000000000002b
          fs = 0x0000000000000000
          gs = 0x0000000000000000

  ```
* If you debug at the point where the crash occurred, you can see that the crash occurred in OpenGL.

```
  (lldb) disassemble -address 0x7ff80513dfa7
  libsystem_pthread.dylib`___chkstk_darwin:
      0x7ff80513df70 <+0>:   push   rcx
      0x7ff80513df71 <+1>:   lea    rcx, [rsp + 0x10]
      0x7ff80513df76 <+6>:   cmp    qword ptr gs:[-0x30], rcx
      0x7ff80513df7f <+15>:  jb     0x7ff80513dfab            ; <+59>
      0x7ff80513df81 <+17>:  cmp    qword ptr gs:[-0x28], rcx
      0x7ff80513df8a <+26>:  jae    0x7ff80513dfab            ; <+59>
      0x7ff80513df8c <+28>:  sub    rcx, rax
      0x7ff80513df8f <+31>:  jb     0x7ff80513df9e            ; <+46>
      0x7ff80513df91 <+33>:  cmp    qword ptr gs:[-0x28], rcx
      0x7ff80513df9a <+42>:  ja     0x7ff80513df9e            ; <+46>
      0x7ff80513df9c <+44>:  pop    rcx
      0x7ff80513df9d <+45>:  ret
      0x7ff80513df9e <+46>:  mov    rcx, qword ptr gs:[-0x28]
  ->  0x7ff80513dfa7 <+55>:  test   qword ptr [rcx - 0x8], rcx
      0x7ff80513dfab <+59>:  cmp    rax, 0x1000
      0x7ff80513dfb1 <+65>:  jb     0x7ff80513dfcd            ; <+93>
      0x7ff80513dfb3 <+67>:  push   rax
      0x7ff80513dfb4 <+68>:  sub    rcx, 0x1000
      0x7ff80513dfbb <+75>:  test   qword ptr [rcx], rcx
      0x7ff80513dfbe <+78>:  sub    rax, 0x1000
      0x7ff80513dfc4 <+84>:  cmp    rax, 0x1000
      0x7ff80513dfca <+90>:  ja     0x7ff80513dfb4            ; <+68>
      0x7ff80513dfcc <+92>:  pop    rax
      0x7ff80513dfcd <+93>:  sub    rcx, rax
      0x7ff80513dfd0 <+96>:  test   qword ptr [rcx], rcx
      0x7ff80513dfd3 <+99>:  pop    rcx
      0x7ff80513dfd4 <+100>: ret

  (lldb) mem read $rcx-0x8
  error: memory read failed for 0x700009632e00

```

* If you check the address of `rcx - 0x8` in `qword ptr [rcx - 0x8], rcx` where the crash occurred, you can see that it points to an address that cannot be accessed.

```
  (lldb) bt
  * thread #36, name = 'Compositor', queue = 'OpenGLMT', stop reason = EXC_BAD_ACCESS (code=2, address=0x700009632ff8)
    * frame #0: 0x00007ff80513dfa7 libsystem_pthread.dylib`___chkstk_darwin + 55
      frame #1: 0x00007ff80513df70 libsystem_pthread.dylib`thread_start + 20
      frame #2: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #3: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #4: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #5: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #6: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #7: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #8: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #9: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #10: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #11: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #12: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #13: 0x00007ffa1e0afabb libGLProgrammability.dylib`phase2AddDef + 251
      frame #14: 0x00007ffa1e03453c libGLProgrammability.dylib`glpASTMergePhase2 + 516
      frame #15: 0x00007ffa1e0653bd libGLProgrammability.dylib`glpLinkProgram + 253
      frame #16: 0x00007ffa1e084072 libGLProgrammability.dylib`ShLink + 228
      frame #17: 0x00007ffa1e251fb7 GLEngine`gleLinkProgram + 1440
      frame #18: 0x00007ffa1e1b8cab GLEngine`glLinkProgramARB_Exec + 291
      frame #19: 0x00007ffa1e1bb0c2 GLEngine`glLinkProgramARB_UnpackThread + 12
      frame #20: 0x00007ffa1e2277d1 GLEngine`gleCmdProcessor + 77
      frame #21: 0x00007ff804f8b317 libdispatch.dylib`_dispatch_client_callout + 8
      frame #22: 0x00007ff804f987ee libdispatch.dylib`_dispatch_lane_barrier_sync_invoke_and_complete + 60
      frame #23: 0x00007ffa1e1bb1e9 GLEngine`glGetProgramiv_ExecThread + 29
      frame #24: 0x0000000105b5c4b6 XUL`___lldb_unnamed_symbol112171$$XUL + 54
      frame #25: 0x0000000106713efa XUL`___lldb_unnamed_symbol159126$$XUL + 122
      frame #26: 0x00000001066f9bf1 XUL`___lldb_unnamed_symbol158857$$XUL + 881
      frame #27: 0x00000001066f9825 XUL`___lldb_unnamed_symbol158856$$XUL + 101
      frame #28: 0x00000001066d5ba8 XUL`___lldb_unnamed_symbol158352$$XUL + 72
      frame #29: 0x000000010671e9df XUL`___lldb_unnamed_symbol159339$$XUL + 63
      frame #30: 0x000000010670e0de XUL`___lldb_unnamed_symbol159036$$XUL + 3550
      frame #31: 0x00000001067492bb XUL`___lldb_unnamed_symbol159722$$XUL + 763
      frame #32: 0x0000000105c6b081 XUL`___lldb_unnamed_symbol119129$$XUL + 353
      frame #33: 0x00000001038d8186 XUL`___lldb_unnamed_symbol22404$$XUL + 1062
      frame #34: 0x000000010366bc24 XUL`___lldb_unnamed_symbol15500$$XUL + 5252
      frame #35: 0x00000001038dd6bf XUL`___lldb_unnamed_symbol22430$$XUL + 447
      frame #36: 0x000000010389c170 XUL`___lldb_unnamed_symbol21804$$XUL + 80
      frame #37: 0x000000010366338b XUL`___lldb_unnamed_symbol15472$$XUL + 267
      frame #38: 0x0000000102f46526 libnss3.dylib`___lldb_unnamed_symbol732$$libnss3.dylib + 310
      frame #39: 0x00007ff8051424e1 libsystem_pthread.dylib`_pthread_start + 125
      frame #40: 0x00007ff80513df6b libsystem_pthread.dylib`thread_start + 15

  (lldb) image list | grep XUL
  [  0] AE51D397-7A60-3944-9FE0-A57DCAD758B8 0x00000001030e2000 /Applications/Firefox.app/Contents/MacOS/XUL

  (lldb) image lookup --address 0x0000000105b5c4b6
        Address: XUL[0x0000000002a7a4b6] (XUL.__TEXT.__text + 44532918)
        Summary: XUL`___lldb_unnamed_symbol112171$$XUL + 54
  (lldb) image lookup --address 0x0000000106713efa
        Address: XUL[0x0000000003631efa] (XUL.__TEXT.__text + 56819450)
        Summary: XUL`___lldb_unnamed_symbol159126$$XUL + 122

```

* Based on the above call stack, it can be inferred that this vulnerability occurs when moving from XUL to OpenGL. The next step required here is to find the root cause of the actual vulnerability in the line of code.

  ```
    // frame #25: 0x0000000106713efa XUL`___lldb_unnamed_symbol159126$$XUL + 122
  	// bad sp value at call has been detected, the output may be wrong!
  	__int64 __fastcall sub_3631E80(__int64 a1)
  	{
  	  __int64 v1; // rax
  	  __int64 v2; // r15
  	  __int64 v3; // rbx
  	  void *v4; // r13
  	  __int64 v6; // [rsp+0h] [rbp-40h] BYREF
  	  int v7[13]; // [rsp+Ch] [rbp-34h] BYREF

  	  sub_3611A00(a1 + 136, 0LL);
  	  v1 = *(_QWORD *)(*(_QWORD *)(a1 + 16) + 8LL);
  	  if ( v1 )
  	    v1 -= 16LL;
  	  v2 = **(_QWORD **)(v1 + 40);
  	  sub_2A7B750(v2, *(unsigned int *)(a1 + 24));
  	  LODWORD(v6) = 0;
  	  sub_2A7A480(v2, *(_DWORD *)(a1 + 24), 0x8B84u, (__int64)&v6);// [1]
  	  v3 = (unsigned int)v6;
  	  if ( (unsigned int)v6 < 2uLL )
  	  {
  	    if ( (*(_BYTE *)(a1 + 112) & 1) != 0 )
  	    {
  	      **(_BYTE **)(a1 + 128) = 0;
  	      *(_QWORD *)(a1 + 120) = 0LL;
  	    }
  	    else
  	    {
  	      *(_WORD *)(a1 + 112) = 0;
  	    }
  	  }
  	  else
  	  {
  	    v4 = (void *)moz_xmalloc((unsigned int)v6);
  	    __bzero(v4, v3);
  	    sub_2A7B800(v2, *(unsigned int *)(a1 + 24), (unsigned int)v3, 0LL, v4);
  	    std::string::assign(a1 + 112, v4);
  	    free(v4);
  	  }
  	  v7[0] = 0;
  	  sub_2A7A480(v2, *(_DWORD *)(a1 + 24), 0x8B82u, (__int64)v7);
  	  if ( v7[0] )
  	  {
  	    sub_362F510(&v6, a1, v2);
  	    sub_3611A00(a1 + 136, v6);
  	  }
  	  return __stack_chk_guard;
  	}

  ```

```
// frame #24: 0x0000000105b5c4b6 XUL`___lldb_unnamed_symbol112171$$XUL + 54
  __int64 __fastcall sub_2A7A480(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4)
  {
    __int64 result; // rax

    result = sub_9DEBC0((_BYTE *)a1, (__int64)"void mozilla::gl::GLContext::fGetProgramiv(GLuint, GLenum, GLint *)");
    if ( (_BYTE)result )
    {
      result = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64))(a1 + 600))(a2, a3, a4); // [2]
      ++*(_QWORD *)(a1 + 2648);
      if ( *(_BYTE *)(a1 + 177) )
        return sub_2A7E050(a1, "void mozilla::gl::GLContext::fGetProgramiv(GLuint, GLenum, GLint *)");
    }
    return result;
  }

```

* You can see that the sub\_2A7A480 function is called at [1] and the glGetProgramiv function of the OpenGL library is called at point [2]. After that, a buffer overflow occurs while loading and processing the OpenGL library in XUL.

## Reproduce

* Download the attached file.
* open poc.html on firefox.

## CREDIT Information

* Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.

Expected results:

No crash

|  | [SSD Secure Disclosure](/user_profile?user_id=689218)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1773874#c1)• 3 years ago |
|  | |

Attached file
[report.md](attachment.cgi?id=9280835)
— [Details](attachment.cgi?id=9280835&action=edit)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36026_691597)• 3 years ago |

Group: firefox-core-security → core-securityComponent: Untriaged → Canvas: WebGLProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a47022_406194)• 3 years ago |

Group: core-security → gfx-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1773874#c2)• 3 years ago |
|  | |

I can reproduce this crash in Nightly. [bp-0f99e382-6d2b-4091-891c-5c0d60220615](https://crash-stats.mozilla.org/report/index/0f99e382-6d2b-4091-891c-5c0d60220615)

Status: UNCONFIRMED → NEWCrash Signature: [@ \_\_\_chkstk\_darwin ]Ever confirmed: trueKeywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1773874#c3)• 3 years ago |
|  | |

Attached file
[debug crash report](attachment.cgi?id=9281446)
— [Details](attachment.cgi?id=9281446&action=edit)

I also reproduced a crash in a debug build, but we don't seem to get any useful console messages (like asserts). The stack is similar, but not quite the same. It brought up the OSX crash reporter. Here's an except of the report (the crashing thread and the main thread).

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1773874#c4)• 3 years ago |
|  | |

Kelsey, can you take a look? Thanks.

Flags: needinfo?(jgilbert)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a310738_406194)• 3 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1773874#c5)• 3 years ago |
|  | |

This is the crashing line: <https://hg.mozilla.org/mozilla-central/file/b1ed2fa50612451f8f39fc84c5f64af62cf7fe3a/dom/canvas/WebGLProgram.cpp#l1161>

```
void WebGLProgram::LinkAndUpdate() {
  mMostRecentLinkInfo = nullptr;

  gl::GLContext* gl = mContext->gl;
  gl->fLinkProgram(mGLName);

  // Grab the program log.
  {
    GLuint logLenWithNull = 0;
->  gl->fGetProgramiv(mGLName, LOCAL_GL_INFO_LOG_LENGTH,
                      (GLint*)&logLenWithNull);
    if (logLenWithNull > 1) {
      std::vector<char> buffer(logLenWithNull);
      gl->fGetProgramInfoLog(mGLName, buffer.size(), nullptr, buffer.data());
      mLinkLog = buffer.data();
    } else {
      mLinkLog.clear();
    }
  }

  GLint ok = 0;
  gl->fGetProgramiv(mGLName, LOCAL_GL_LINK_STATUS, &ok);
  if (!ok) return;

  mMostRecentLinkInfo =
      QueryProgramInfo(this, gl);  // Fallible after context loss.

}

```

`fGetProgramiv` is not doing anything wrong, which makes me think this is a driver issue. It would be sad (maybe bad?) if we couldn't offer the driver's log for when programs failed to link. We then risk only being able to tell authors "the drivers says no" if it passes all our own validation.

Maybe this is acceptable, but I hesitate.

Assignee: nobody → jgilbertFlags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1773874#c6)• 3 years ago |
|  | |

Looking again, yeah it looks like this is crashing during the internal driver linker:

```
      [...]
      frame #11: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #12: 0x00007ffa1e0afc16 libGLProgrammability.dylib`phase2Process + 56
      frame #13: 0x00007ffa1e0afabb libGLProgrammability.dylib`phase2AddDef + 251
      frame #14: 0x00007ffa1e03453c libGLProgrammability.dylib`glpASTMergePhase2 + 516
      frame #15: 0x00007ffa1e0653bd libGLProgrammability.dylib`glpLinkProgram + 253
      [...]

```

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1773874#c7)• 3 years ago |
|  | |

The severity field is not set for this bug.

:jgilbert, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1773874#c8)• 2 years ago |
|  | |

This is the frag shader:

```
  precision mediump float;

  varying float floatVar;

  int x[0x00080];
  void main(void) {
    x[0x7f] = 0x41414141;
    x[0x7e] = 0x41414141;
// [...]
    x[0x1b] = 0x41414141;
    x[0x1a] = 0x41414141;
    if(floatVar > 0.)
      x[0x1a] = 0x41414141;
    else
      x[0x1a] = 0x41414141;
    x[0x19] = 0x41414141;
    x[0x18] = 0x41414141;
// [...]
    x[0x02] = 0x41414141;
    x[0x01] = 0x41414141;

    //gl_FragColor = vec4( float(x[0+offset]), float(x[1+offset]), float(x[2+offset]), 1);

    // Here we allocate memory, without writing to it
    if (int(x[0]) == 42) { // [1]
      int pad[0x40000]; // [2]
      gl_FragColor += vec4(float(pad[42])); // [3]
    }
  }

```

Three weird things:

1. At [1], glsl branches on a value that the glsl doesn't set (though in WebGL it should be therefore zero)
2. At [2], there's a *large* stack allocation of ~260K ints. This is super weird, and is suspect for causing the in-driver crash.
3. At [3], glsl writes a value from the large allocation that was never explicitly initialized. (though in WebGL it should be therefore zero)
Flags: needinfo?(jgilbert)

|  | [SSD Secure Disclosure](/user_profile?user_id=689218)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1773874#c9)• 2 years ago |
|  | |

No progress?

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1773874#c10)• 2 years ago |
|  | |

```
  int x[0x00080];
// ...
    // Here we allocate memory, without writing to it
    if (int(x[0]) == 42) {
      //int pad[0x40000]; // crash
      //int pad[0x400]; // ok
      //int pad[0x4000]; // crash
      //int pad[0x1000]; // ok
      //int pad[0x2000]; // crash
      //int pad[0x1800]; // ok
      //int pad[0x1c00]; // ok
      //int pad[0x1e00]; // ok
      //int pad[0x1f00]; // ok
      //int pad[0x1ff0]; // crash
      //int pad[0x2000-0x80]; // ok
      int pad[0x2000-0x80+1]; // crash
      gl_FragColor += vec4(float(pad[42]));
    }

```

Seems like we have a max of 0x2000=8192 words (0x8000=32768 bytes) of private memory.

32KB looks like "Maximum total threadgroup memory allocation" from the MSL limits: <https://developer.apple.com/metal/Metal-Feature-Set-Tables.pdf>

Does ANGLE have a pass for this I wonder?

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1773874#c11)• 2 years ago |
|  | |

Ok, yeah, this is darwin's pthread stackoverflow protection.

We crash here: <https://github.com/apple/darwin-libpthread/blob/c60d249cc84dfd6097a7e71c68a36b47cbe076d1/src/pthread_asm.s#L84>

```
	.globl ____chkstk_darwin
____chkstk_darwin: // %rax == alloca size
	pushq  %rcx
	leaq   0x10(%rsp), %rcx

	// validate that the frame pointer is on our stack (no alt stack)
	cmpq   %rcx, %gs:_PTHREAD_STRUCT_DIRECT_STACKADDR_OFFSET
	jb     Lprobe
	cmpq   %rcx, %gs:_PTHREAD_STRUCT_DIRECT_STACKBOTTOM_OFFSET
	jae    Lprobe

	// validate alloca size
	subq   %rax, %rcx
	jb     Lcrash
	cmpq   %rcx, %gs:_PTHREAD_STRUCT_DIRECT_STACKBOTTOM_OFFSET
	ja     Lcrash

	popq   %rcx
	retq

Lcrash:
	// POSIX mandates that stack overflow crashes with SIGSEGV
	// so load an address in the guard page and dereference it
	movq   %gs:_PTHREAD_STRUCT_DIRECT_STACKBOTTOM_OFFSET, %rcx
->	testq  %rcx, -8(%rcx) // CRASH FRAME 0

```

I believe this is a fail-safe'd stack overflow check crashing, which would make this a non-exploitable sec-dos.

@dveditz Does that sound right?

Flags: needinfo?(dveditz)Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [SSD Secure Disclosure](/user_profile?user_id=689218)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1773874#c12)• 2 years ago |
|  | |

Any update?

|  | [SSD Secure Disclosure](/user_profile?user_id=689218)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1773874#c13)• 2 years ago |
|  | |

Any update?

The item is more than 3 months old

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1773874#c14)• 2 years ago |
|  | |

The crash graph is a lie—this crash is still reproducible ([bp-c41c22f0-9eca-4879-8ddb-e66d80221013](https://crash-stats.mozilla.org/report/index/c41c22f0-9eca-4879-8ddb-e66d80221013)), but on 2022-09-14 it looks like Socorro started reporting a different signature. I'll add the new signature (it's still actually crashing in `____chkstk_darwin`, it's just the reported signature that has changed).

> I believe this is a fail-safe'd stack overflow check crashing, which would make this a non-exploitable sec-dos. @dveditz Does that sound right?

Not exploitable for RCE, but crashing the entire browser is definitely a Denial of Service!

The testcase crashes just the tab in Chrome, but takes 20-30 seconds during which time Chrome is hung (the Firefox takedown is near instantaneous). The hang arguably makes this more abusable on Chrome: scammers love being able to hang the browser and show a message saying their machine is hacked and to call "Microsoft" or "Google" for help—and then "helping" the user by charging them for useless "service" or getting the user to download and install malware as a "fix".

Blocks: [eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")Crash Signature: [@ \_\_\_chkstk\_darwin ] → [@ \_\_\_chkstk\_darwin ]
[@ thread\_start ]Flags: needinfo?(dveditz)Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a13015585_419431)• 2 years ago |

Severity: -- → S3

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a25545547_419431)• 2 years ago |

Priority: -- → P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1773874#c15)• 2 years ago |
|  | |

This might get fixed as a side-effect of [bug 1794292](/show_bug.cgi?id=1794292 "RESOLVED FIXED - Firefox WebGL glvmInterpretFPTransformFour Memory Corruption Vulnerability") which recently landed in dev builds

See Also: → [CVE-2023-29531](/show_bug.cgi?id=1794292 "RESOLVED FIXED - Firefox WebGL glvmInterpretFPTransformFour Memory Corruption Vulnerability")

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34267084_419431)• 1 years ago |

Duplicate of this bug: [1842110](/show_bug.cgi?id=1842110 "RESOLVED DUPLICATE - OOB Access in Firefox WebGL")

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1773874#c17)• 1 years ago |
|  | |

Via dveditz in <https://bugzilla.mozilla.org/show_bug.cgi?id=1842110#c4>:

The patch is apparently [https://chromium.googlesource.com/angle/angle/+/fe45418c6592ab210ba5a6101f5058fe24eed266%5E%21/#F0](https://chromium.googlesource.com/angle/angle/%2B/fe45418c6592ab210ba5a6101f5058fe24eed266%5E%21/#F0)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34337023_75935)• 1 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34865852_419431)• 1 years ago |

Assignee: jgilbert → egubler

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1773874#c18)• 1 years ago |
|  | |

Attached file
[Bug 1773874: normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` r=jgilbert](attachment.cgi?id=9344947)
— [Details](attachment.cgi?id=9344947&action=edit)

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1773874#c19)• 1 years ago |
|  | |

Attached file
[Bug 1773874: build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor\_from\_git` r=jgilbert](attachment.cgi?id=9344948)
— [Details](attachment.cgi?id=9344948&action=edit)

Depends on D184172

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1773874#c20)• 1 years ago |
|  | |

Attached file
[Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert](attachment.cgi?id=9344949)
— [Details](attachment.cgi?id=9344949&action=edit)

Depends on D184173

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34872100_600971)• 1 years ago |

[Attachment #9344947](/attachment.cgi?id=9344947&action=edit "Bug 1773874: normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` r=jgilbert") -
Attachment description: WIP: Bug 1773874: normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` → Bug 1773874: normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` r=jgilbert

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34872110_600971)• 1 years ago |

[Attachment #9344948](/attachment.cgi?id=9344948&action=edit "Bug 1773874: build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor_from_git` r=jgilbert") -
Attachment description: WIP: Bug 1773874: build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor\_from\_git` → Bug 1773874: build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor\_from\_git` r=jgilbert

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a34872115_600971)• 1 years ago |

[Attachment #9344949](/attachment.cgi?id=9344949&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert") -
Attachment description: WIP: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream → Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1773874#c21)• 1 years ago |
|  | |

Pushed by egubler@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/3548c3bc97e2>
normalize to Unix line endings in `gfx/angle/auto-update-angle.sh` r=jgilbert
<https://hg.mozilla.org/integration/autoland/rev/c356ce52303f>
build(angle): explicitly set `git-log`'s `format`, `decorate`, and `abbrev-commit` options in `vendor\_from\_git` r=jgilbert
<https://hg.mozilla.org/integration/autoland/rev/0421f7e408c0>
fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1773874#c22)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/3548c3bc97e2>

<https://hg.mozilla.org/mozilla-central/rev/c356ce52303f>

<https://hg.mozilla.org/mozilla-central/rev/0421f7e408c0>

Group: gfx-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 1 years ago
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B)Resolution: --- → FIXEDTarget Milestone: --- → 118 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1773874#c23)• 1 years ago |
|  | |

The patch landed in nightly and beta is affected.

:ErichDonGubler, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox117` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(egubler)

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1773874#c24)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1773874&comment_id=16521264 "2 revisions") |
|  | |

:jgilbert has informed me that while the patches I have supplied are important, they may not be sufficient to fix this issue. We may still need to opt into the new validation from these patches when we set up ANGLE.

Will investigate soon.

Status: RESOLVED → REOPENEDFlags: needinfo?(egubler)Resolution: FIXED → ---

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1773874#c25)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1773874&comment_id=16522315 "1 revision") |
|  | |

I can confirm that I've gotten crash exactly the same as OP before the ANGLE patch. After the patch, I can no longer produce the crash, but get an `alert` instead warning about the size of the private variable `pad` from the OP's `poc.html`.

Status: REOPENED → RESOLVEDClosed: 1 years ago → 1 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1773874#c26)• 1 years ago |
|  | |

Please nominate this for Beta and ESR115 approval when you get a chance.

Flags: needinfo?(egubler)

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1773874#c27)• 1 years ago |
|  | |

Attached file
[Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](attachment.cgi?id=9347301)
— [Details](attachment.cgi?id=9347301&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D184174>

Depends on D184173

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36093382_600971)• 1 years ago |

[Attachment #9347301](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment description: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream → WIP: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1773874#c28)• 1 years ago |
|  | |

Attached file
[Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](attachment.cgi?id=9347302) (obsolete)
— [Details](attachment.cgi?id=9347302&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D184174>

Depends on D184173

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36093957_600971)• 1 years ago |

[Attachment #9347301](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment description: WIP: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream → Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36094040_600971)• 1 years ago |

[Attachment #9347302](/attachment.cgi?id=9347302&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment description: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream → Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36094639_600971)• 1 years ago |

[Attachment #9347301](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment description: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert → Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream
[Attachment #9347301](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36094701_600971)• 1 years ago |

[Attachment #9347302](/attachment.cgi?id=9347302&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment description: Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream r=jgilbert → Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream
[Attachment #9347302](/attachment.cgi?id=9347302&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1773874#c29)• 1 years ago |
|  | |

# Uplift Approval Request

* **Risk associated with taking this patch**: Low
* **String changes made/needed**: None
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: yes
* **Is Android affected?**: no
* **User impact if declined**: DoS possible on MacOS via custom HTML
* **Code covered by automated testing**: no
* **Explanation of risk level**: None identified; downgrading severity of a crash to an `alert`
* **Steps to reproduce for manual QE testing**: Run `poc.html` from [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability")
Flags: qe-verify+

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1773874#c30)• 1 years ago |
|  | |

Attached file
[Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream](attachment.cgi?id=9347304)
— [Details](attachment.cgi?id=9347304&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D184174>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1773874#c31)• 1 years ago |
|  | |

# Uplift Approval Request

* **Needs manual QE test**: yes
* **Fix verified in Nightly**: yes
* **String changes made/needed**: None
* **Risk associated with taking this patch**: Low
* **Steps to reproduce for manual QE testing**: Run `poc.html` from [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability")
* **Explanation of risk level**: None identified; downgrading severity of a crash to an `alert`
* **Code covered by automated testing**: no
* **User impact if declined**: DoS possible on MacOS via custom HTML
* **Is Android affected?**: no

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36095871_600971)• 1 years ago |

[Attachment #9347302](/attachment.cgi?id=9347302&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Attachment is obsolete: true
[Attachment #9347302](/attachment.cgi?id=9347302&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Flags: approval-mozilla-esr115?

|  | [Erich Gubler [:ErichDonGubler]](/user_profile?user_id=713343)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1773874#c32)• 1 years ago |
|  | |

:ryanvm: Done!

Flags: needinfo?(egubler)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1773874#c33)• 1 years ago |
|  | |

Comment on [attachment 9347301](/attachment.cgi?id=9347301 "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") [[details]](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream")

[Bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability"): fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream

Approved for 117.0b4.

[Attachment #9347301](/attachment.cgi?id=9347301&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1773874#c34)• 1 years ago |
|  | |

Comment on [attachment 9347304](/attachment.cgi?id=9347304 "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") [[details]](/attachment.cgi?id=9347304&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream")

[Bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability"): fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream

Approved for 115.2esr.

[Attachment #9347304](/attachment.cgi?id=9347304&action=edit "Bug 1773874: fix(angle): cherry-pick fe45418c6592ab210ba5a6101f5058fe24eed266 from upstream") -
Flags: approval-mozilla-esr115+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36096673_640478)• 1 years ago |

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1773874#c35)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/926c0c79b59e>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36096713_640478)• 1 years ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1773874#c36)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/b3253bff7063>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36107659_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36129253_553429)• 1 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1773874#c37)• 1 years ago |
|  | |

Managed to reproduce the issue on macOS 11.6 on a macbook pro with gpu: Intel Iris Plus Graphics 655 1536 MB.

The issue isn't reproducible anymore on Firefox Nightly 118.0a1 (2023-08-04).

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=verified)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1773874#c38)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1773874&comment_id=16527933 "1 revision") |
|  | |

Verified as fixed on Firefox 117.0b4 and on FIrefox 115.2.0esr on macOS 11.6.

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a36381167_583007)• 1 year ago |

Status: RESOLVED → VERIFIED
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1773874#c39)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9350222)
— [Details](attachment.cgi?id=9350222&action=edit)

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a37926714_626341)• 1 year ago |

Whiteboard: [adv-main117+][adv-esr115.2+]

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a43844679_419431)• 1 year ago |

See Also: → [CVE-2023-6856](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a49336789_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773874#a49342536_1689)• 1 year ago |

Alias: CVE-2023-4582
You need to [log in](/show_bug.cgi?id=1773874&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [SSD Secure Disclosure](/user_profile?user_id=689218)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8ea4e939_20250110_194100.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-38

## Security Vulnerabilities fixed in Thunderbird 115.2

Announced
August 29, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_e6b091cb_20250110_194059.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-36

## Security Vulnerabilities fixed in Firefox ESR 115.2

Announced
August 29, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.2

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_61f780b1_20250110_194059.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-34

## Security Vulnerabilities fixed in Firefox 117

Announced
August 29, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 117

This advisory was updated October 24, 2023 to add CVE-2023-5732 which was included in the original release of Firefox 117, but did not appear in the advisory published at that time.

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-5732: Address bar spoofing via bidirectional characters](#CVE-2023-5732)

Reporter
Armin Ebert
Impact
moderate
##### Description

An attacker could have created a malicious link using bidirectional characters to spoof the location in the address bar when visited.

##### References

* [Bug 1690979](https://bugzilla.mozilla.org/show_bug.cgi?id=1690979)
* [Bug 1836962](https://bugzilla.mozilla.org/show_bug.cgi?id=1836962)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4579: Persisted search terms were formatted as URLs](#CVE-2023-4579)

Reporter
Malte Jürgens
Impact
moderate
##### Description

Search queries in the default search engine could appear to have been the currently navigated URL if the search query itself was a well formed URL. This could have led to a site spoofing another if it had been maliciously set as the default search engine.

##### References

* [Bug 1842766](https://bugzilla.mozilla.org/show_bug.cgi?id=1842766)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


