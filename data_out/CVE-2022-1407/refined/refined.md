Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**
The VikBooking Hotel Booking Engine & PMS plugin lacks CSRF (Cross-Site Request Forgery) protection when adding tracking campaigns. Additionally, it fails to properly sanitize the campaign fields when outputting them in HTML attributes.

**Weaknesses/Vulnerabilities Present:**
*   **CSRF:** The absence of CSRF checks allows an attacker to trick a logged-in administrator into performing actions they didn't intend.
*   **Stored Cross-Site Scripting (XSS):** The lack of proper escaping/sanitization of user-supplied data (campaign names, keys, values) when outputting them in HTML attributes allows for the injection of malicious JavaScript code.

**Impact of Exploitation:**
*   Successful exploitation can lead to the execution of arbitrary JavaScript code within the context of an administrator's session. This can allow the attacker to perform various actions, including:
    *   Stealing session cookies.
    *   Modifying website content.
    *   Redirecting users to malicious sites.
    *   Performing administrative actions on behalf of the victim.

**Attack Vectors:**
*   **CSRF:** The attacker crafts a malicious HTML page that includes a form pre-filled with XSS payloads. When a logged-in administrator visits this page (or when the page is loaded in an iframe), the form is automatically submitted to the vulnerable plugin's settings page.
*   **XSS:** The injected JavaScript is then triggered when the administrator views the tracking campaign settings page, as the injected payload is not sanitized and is displayed within the HTML attributes.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be able to induce a logged-in administrator to visit a malicious web page or load an attacker controlled page in an iframe that initiates the CSRF request.
*   The attacker doesn't need to have any prior access to the WordPress admin panel.
* The attacker needs knowledge of the vulnerable plugin and its parameters for adding tracking campaigns.

**Additional Notes:**
*   The provided Proof of Concept (PoC) code demonstrates how an attacker can exploit this vulnerability using a simple HTML form.
*   The vulnerability is classified as a medium severity with a CVSS score of 6.1.
*   The vulnerability is fixed in version 1.5.7 of the VikBooking plugin.