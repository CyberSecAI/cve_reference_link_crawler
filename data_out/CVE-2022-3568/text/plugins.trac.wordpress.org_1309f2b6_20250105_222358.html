

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2801283%2540imagemagick-engine%26old%3D2801283%2540imagemagick-engine)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2801280/imagemagick-engine "Changeset 2801280 for imagemagick-engine")
* [Next Change](/changeset/2862130/imagemagick-engine "Changeset 2862130 for imagemagick-engine") →

---

# Changeset [2801283](/changeset/2801283 "Show full changeset") for [imagemagick-engine](/browser/imagemagick-engine?rev=2801283 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/19/2022 01:54:35 PM
([2 years](/timeline?from=2022-10-19T13%3A54%3A35Z&precision=second "See timeline at 10/19/2022 01:54:35 PM") ago)

Author:
rickardw
Message:

Update to version 1.7.6 from GitHub

Location:
[imagemagick-engine](/browser/imagemagick-engine?rev=2801283)
Files:

6 edited
1 copied

* [tags/1.7.6](/browser/imagemagick-engine/tags/1.7.6?rev=2801283 "Show entry in browser")
  (copied)
  *(copied from [imagemagick-engine/trunk](/browser/imagemagick-engine/trunk?rev=2732430 "Show original file (revision 2801282)"))*
* [tags/1.7.6/imagemagick-engine.php](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283 "Show entry in browser")
  (modified)
  ([12 diffs](#file1 "Show differences"))
* [tags/1.7.6/js/ime-admin.js](/browser/imagemagick-engine/tags/1.7.6/js/ime-admin.js?rev=2801283 "Show entry in browser")
  (modified)
  ([4 diffs](#file2 "Show differences"))
* [tags/1.7.6/readme.txt](/browser/imagemagick-engine/tags/1.7.6/readme.txt?rev=2801283 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [trunk/imagemagick-engine.php](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283 "Show entry in browser")
  (modified)
  ([12 diffs](#file4 "Show differences"))
* [trunk/js/ime-admin.js](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2801283 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [trunk/readme.txt](/browser/imagemagick-engine/trunk/readme.txt?rev=2801283 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [imagemagick-engine/tags/1.7.6/imagemagick-engine.php](/changeset/2801283/imagemagick-engine/tags/1.7.6/imagemagick-engine.php "Show the changeset 2801283 restricted to imagemagick-engine/tags/1.7.6/imagemagick-engine.php")

  | [r2732430](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L6 "Show revision 2732430 of this file in browser") | [r2801283](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L6 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: Orangelab |
  | 7 | 7 | Author URI: https://orangelab.com/ |
  | 8 |  | Version: 1.7.~~4~~ |
  |  | 8 | Version: 1.7.6 |
  | 9 | 9 | Text Domain: imagemagick-engine |
  | 10 | 10 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L36) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L36) |  |
  | 36 | 36 | \*/ |
  | 37 | 37 | define( 'IME\_OPTION\_VERSION', 1 ); |
  | 38 |  | define( 'IME\_VERSION', '1.7.~~3~~' ); |
  |  | 38 | define( 'IME\_VERSION', '1.7.6' ); |
  | 39 | 39 |  |
  | 40 | 40 | /\* |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L660) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L660) |  |
  | 660 | 660 | // Test if a path is correct for IM binary |
  | 661 | 661 | function ime\_ajax\_test\_im\_path() { |
  | 662 |  | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  | 663 |  | ~~die(~~); |
  |  | 662 | if ( ! current\_user\_can( 'manage\_options' ) || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  |  | 663 | wp\_die( 'Sorry, but you do not have permissions to perform this action.' ); |
  | 664 | 664 | } |
  | 665 | 665 | $r = ime\_im\_cli\_check\_command( $\_REQUEST['cli\_path'] ); |
  | 666 | 666 | echo empty( $r ) ? '0' : '1'; |
  | 667 |  | die(); |
  |  | 667 | wp\_die(); |
  | 668 | 668 | } |
  | 669 | 669 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L672) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L672) |  |
  | 672 | 672 | global $wpdb; |
  | 673 | 673 |  |
  | 674 |  | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 674 | if ( ! current\_user\_can( 'manage\_options' ) || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  | 675 | 675 | wp\_die( 'Sorry, but you do not have permissions to perform this action.' ); |
  | 676 | 676 | } |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L686) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L686) |  |
  | 686 | 686 | $ids = implode( ',', $ids ); |
  | 687 | 687 |  |
  | 688 |  | die( $ids ); |
  |  | 688 | wp\_die( $ids ); |
  | 689 | 689 | } |
  | 690 | 690 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L695) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L695) |  |
  | 695 | 695 | error\_reporting( E\_ERROR | E\_WARNING ); |
  | 696 | 696 |  |
  | 697 |  | if ( ! current\_user\_can( 'manage\_options' ) || ! ime\_mode\_valid() ) { |
  | 698 |  | die( '-1' ); |
  |  | 697 | if ( ! current\_user\_can( 'manage\_options' ) || ! ime\_mode\_valid() || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  |  | 698 | wp\_die( '-1' ); |
  | 699 | 699 | } |
  | 700 | 700 |  |
  | 701 | 701 | if ( ! isset( $\_REQUEST['id'] ) ) { |
  | 702 |  | die( '-1' ); |
  |  | 702 | wp\_die( '-1' ); |
  | 703 | 703 | } |
  | 704 | 704 |  |
  | 705 | 705 | $id = intval( $\_REQUEST['id'] ); |
  | 706 | 706 | if ( $id <= 0 ) { |
  | 707 |  | die( '-1' ); |
  |  | 707 | wp\_die( '-1' ); |
  | 708 | 708 | } |
  | 709 | 709 |  |
  | 710 | 710 | $temp\_sizes = $\_REQUEST['sizes']; |
  | 711 | 711 | if ( empty( $temp\_sizes ) ) { |
  | 712 |  | die( '-1' ); |
  |  | 712 | wp\_die( '-1' ); |
  | 713 | 713 | } |
  | 714 | 714 | $temp\_sizes = explode( '|', $temp\_sizes ); |
  | 715 | 715 | if ( count( $temp\_sizes ) < 1 ) { |
  | 716 |  | die( '-1' ); |
  |  | 716 | wp\_die( '-1' ); |
  | 717 | 717 | } |
  | 718 | 718 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L750) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L750) |  |
  | 750 | 750 |  |
  | 751 | 751 | if ( false === $ime\_image\_file || ! file\_exists( $ime\_image\_file ) ) { |
  | 752 |  | die( '-1' ); |
  |  | 752 | wp\_die( '-1' ); |
  | 753 | 753 | } |
  | 754 | 754 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L765) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L765) |  |
  | 765 | 765 | } |
  | 766 | 766 | if ( count( $sizes ) < 1 ) { |
  | 767 |  | die( 1 ); |
  |  | 767 | wp\_die( 1 ); |
  | 768 | 768 | } |
  | 769 | 769 | } |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L775) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L775) |  |
  | 775 | 775 | $new\_meta = ime\_filter\_attachment\_metadata( $metadata, $id ); |
  | 776 | 776 | if ( is\_wp\_error( $new\_meta ) ) { |
  | 777 |  | die( '-1' ); |
  |  | 777 | wp\_die( '-1' ); |
  | 778 | 778 | } |
  | 779 | 779 | wp\_update\_attachment\_metadata( $id, $new\_meta ); |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L791) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L791) |  |
  | 791 | 791 | // No old sizes, nothing to check |
  | 792 | 792 | if ( ! isset( $metadata['sizes'] ) || empty( $metadata['sizes'] ) ) { |
  | 793 |  | die( '1' ); |
  |  | 793 | wp\_die( '1' ); |
  | 794 | 794 | } |
  | 795 | 795 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L816) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L816) |  |
  | 816 | 816 | } |
  | 817 | 817 |  |
  | 818 |  | die( '1' ); |
  |  | 818 | wp\_die( '1' ); |
  | 819 | 819 | } |
  | 820 | 820 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L845) | […](/browser/imagemagick-engine/tags/1.7.6/imagemagick-engine.php?rev=2801283#L845) |  |
  | 845 | 845 | 'failed'        => '<strong>' . \_\_( 'Failed to resize image!', 'imagemagick-engine' ) . '</strong>', |
  | 846 | 846 | 'resized'       => \_\_( 'Resized using ImageMagick Engine', 'imagemagick-engine' ), |
  |  | 847 | 'ime\_nonce'     => wp\_create\_nonce('ime-admin-nonce'), |
  | 847 | 848 | ]; |
  | 848 | 849 | wp\_localize\_script( 'ime-admin', 'ime\_admin', $data ); |
* ## [imagemagick-engine/tags/1.7.6/js/ime-admin.js](/changeset/2801283/imagemagick-engine/tags/1.7.6/js/ime-admin.js "Show the changeset 2801283 restricted to imagemagick-engine/tags/1.7.6/js/ime-admin.js")

  | [r2311431](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L13 "Show revision 2311431 of this file in browser") | [r2801283](/browser/imagemagick-engine/tags/1.7.6/js/ime-admin.js?rev=2801283#L13 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | jQuery.get( ajaxurl, { |
  | 14 | 14 | action: 'ime\_test\_im\_path', |
  |  | 15 | ime\_nonce: ime\_admin.ime\_nonce, |
  | 15 | 16 | cli\_path: jQuery( '#cli\_path' ).val() |
  | 16 | 17 | }, function( data ) { |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L66) | […](/browser/imagemagick-engine/tags/1.7.6/js/ime-admin.js?rev=2801283#L67) |  |
  | 66 | 67 | //Regeneration of progressbar |
  | 67 | 68 | function imeRegenImages( id ) { |
  | 68 |  | jQuery.post( ajaxurl, { action: 'ime\_process\_image', id: id, sizes: rt\_sizes, force: rt\_force }, function( data ) { |
  |  | 69 | jQuery.post( ajaxurl, { action: 'ime\_process\_image', ime\_nonce: ime\_admin.ime\_nonce, id: id, sizes: rt\_sizes, force: rt\_force }, function( data ) { |
  | 69 | 70 | var n = parseInt( data, 10 ); |
  | 70 | 71 | if ( isNaN( n ) ) { |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L106) | […](/browser/imagemagick-engine/tags/1.7.6/js/ime-admin.js?rev=2801283#L107) |  |
  | 106 | 107 |  |
  | 107 | 108 | var message = jQuery( '#ime-message-' + id ).show(); |
  | 108 |  | jQuery.post( ajaxurl, { action: 'ime\_process\_image', id: id, sizes: sizes, force: force }, function( data ) { |
  |  | 109 | jQuery.post( ajaxurl, { action: 'ime\_process\_image', ime\_nonce: ime\_admin.ime\_nonce, id: id, sizes: sizes, force: force }, function( data ) { |
  | 109 | 110 | spinner.hide(); |
  | 110 | 111 | link.removeClass( 'disabled' ); |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L142) | […](/browser/imagemagick-engine/tags/1.7.6/js/ime-admin.js?rev=2801283#L143) |  |
  | 142 | 143 | $( '#regenerate-images' ).click( function() { |
  | 143 | 144 | $( '#regenerate-images-metabox img.ajax-feedback' ).show(); |
  | 144 |  | $.post( ajaxurl, { action: 'ime\_regeneration\_get\_images' }, function( data ) { |
  |  | 145 | $.post( ajaxurl, { action: 'ime\_regeneration\_get\_images', ime\_nonce: ime\_admin.ime\_nonce, }, function( data ) { |
  | 145 | 146 | jQuery( '#regen-message' ).addClass( 'hidden' ); |
  | 146 | 147 | rt\_images = data.split( ',' ); |
* ## [imagemagick-engine/tags/1.7.6/readme.txt](/changeset/2801283/imagemagick-engine/tags/1.7.6/readme.txt "Show the changeset 2801283 restricted to imagemagick-engine/tags/1.7.6/readme.txt")

  | [r2732430](/browser/imagemagick-engine/trunk/readme.txt?rev=2732430#L3 "Show revision 2732430 of this file in browser") | [r2801283](/browser/imagemagick-engine/tags/1.7.6/readme.txt?rev=2801283#L3 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: image, images, picture, imagemagick, gd, regenerate |
  | 4 | 4 | Requires at least: 3.0 |
  | 5 |  | Tested up to: 6.0.~~0~~ |
  | 6 |  | Stable tag: 1.7.~~4~~ |
  |  | 5 | Tested up to: 6.0.3 |
  |  | 6 | Stable tag: 1.7.6 |
  | 7 | 7 |  |
  | 8 | 8 | Improve the quality of re-sized images by replacing standard GD library with ImageMagick. |
  | […](/browser/imagemagick-engine/trunk/readme.txt?rev=2732430#L74) | […](/browser/imagemagick-engine/tags/1.7.6/readme.txt?rev=2801283#L74) |  |
  | 74 | 74 |  |
  | 75 | 75 | == Changelog == |
  |  | 76 |  |
  |  | 77 | = 1.7.6 = |
  |  | 78 | \* Fix plugin vulnerabilities and added nonce checks |
  | 76 | 79 |  |
  | 77 | 80 | = 1.7.4 = |
* ## [imagemagick-engine/trunk/imagemagick-engine.php](/changeset/2801283/imagemagick-engine/trunk/imagemagick-engine.php "Show the changeset 2801283 restricted to imagemagick-engine/trunk/imagemagick-engine.php")

  | [r2732430](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L6 "Show revision 2732430 of this file in browser") | [r2801283](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L6 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: Orangelab |
  | 7 | 7 | Author URI: https://orangelab.com/ |
  | 8 |  | Version: 1.7.~~4~~ |
  |  | 8 | Version: 1.7.6 |
  | 9 | 9 | Text Domain: imagemagick-engine |
  | 10 | 10 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L36) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L36) |  |
  | 36 | 36 | \*/ |
  | 37 | 37 | define( 'IME\_OPTION\_VERSION', 1 ); |
  | 38 |  | define( 'IME\_VERSION', '1.7.~~3~~' ); |
  |  | 38 | define( 'IME\_VERSION', '1.7.6' ); |
  | 39 | 39 |  |
  | 40 | 40 | /\* |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L660) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L660) |  |
  | 660 | 660 | // Test if a path is correct for IM binary |
  | 661 | 661 | function ime\_ajax\_test\_im\_path() { |
  | 662 |  | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  | 663 |  | ~~die(~~); |
  |  | 662 | if ( ! current\_user\_can( 'manage\_options' ) || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  |  | 663 | wp\_die( 'Sorry, but you do not have permissions to perform this action.' ); |
  | 664 | 664 | } |
  | 665 | 665 | $r = ime\_im\_cli\_check\_command( $\_REQUEST['cli\_path'] ); |
  | 666 | 666 | echo empty( $r ) ? '0' : '1'; |
  | 667 |  | die(); |
  |  | 667 | wp\_die(); |
  | 668 | 668 | } |
  | 669 | 669 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L672) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L672) |  |
  | 672 | 672 | global $wpdb; |
  | 673 | 673 |  |
  | 674 |  | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 674 | if ( ! current\_user\_can( 'manage\_options' ) || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  | 675 | 675 | wp\_die( 'Sorry, but you do not have permissions to perform this action.' ); |
  | 676 | 676 | } |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L686) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L686) |  |
  | 686 | 686 | $ids = implode( ',', $ids ); |
  | 687 | 687 |  |
  | 688 |  | die( $ids ); |
  |  | 688 | wp\_die( $ids ); |
  | 689 | 689 | } |
  | 690 | 690 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L695) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L695) |  |
  | 695 | 695 | error\_reporting( E\_ERROR | E\_WARNING ); |
  | 696 | 696 |  |
  | 697 |  | if ( ! current\_user\_can( 'manage\_options' ) || ! ime\_mode\_valid() ) { |
  | 698 |  | die( '-1' ); |
  |  | 697 | if ( ! current\_user\_can( 'manage\_options' ) || ! ime\_mode\_valid() || ! wp\_verify\_nonce( $\_REQUEST['ime\_nonce'], 'ime-admin-nonce') ) { |
  |  | 698 | wp\_die( '-1' ); |
  | 699 | 699 | } |
  | 700 | 700 |  |
  | 701 | 701 | if ( ! isset( $\_REQUEST['id'] ) ) { |
  | 702 |  | die( '-1' ); |
  |  | 702 | wp\_die( '-1' ); |
  | 703 | 703 | } |
  | 704 | 704 |  |
  | 705 | 705 | $id = intval( $\_REQUEST['id'] ); |
  | 706 | 706 | if ( $id <= 0 ) { |
  | 707 |  | die( '-1' ); |
  |  | 707 | wp\_die( '-1' ); |
  | 708 | 708 | } |
  | 709 | 709 |  |
  | 710 | 710 | $temp\_sizes = $\_REQUEST['sizes']; |
  | 711 | 711 | if ( empty( $temp\_sizes ) ) { |
  | 712 |  | die( '-1' ); |
  |  | 712 | wp\_die( '-1' ); |
  | 713 | 713 | } |
  | 714 | 714 | $temp\_sizes = explode( '|', $temp\_sizes ); |
  | 715 | 715 | if ( count( $temp\_sizes ) < 1 ) { |
  | 716 |  | die( '-1' ); |
  |  | 716 | wp\_die( '-1' ); |
  | 717 | 717 | } |
  | 718 | 718 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L750) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L750) |  |
  | 750 | 750 |  |
  | 751 | 751 | if ( false === $ime\_image\_file || ! file\_exists( $ime\_image\_file ) ) { |
  | 752 |  | die( '-1' ); |
  |  | 752 | wp\_die( '-1' ); |
  | 753 | 753 | } |
  | 754 | 754 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L765) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L765) |  |
  | 765 | 765 | } |
  | 766 | 766 | if ( count( $sizes ) < 1 ) { |
  | 767 |  | die( 1 ); |
  |  | 767 | wp\_die( 1 ); |
  | 768 | 768 | } |
  | 769 | 769 | } |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L775) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L775) |  |
  | 775 | 775 | $new\_meta = ime\_filter\_attachment\_metadata( $metadata, $id ); |
  | 776 | 776 | if ( is\_wp\_error( $new\_meta ) ) { |
  | 777 |  | die( '-1' ); |
  |  | 777 | wp\_die( '-1' ); |
  | 778 | 778 | } |
  | 779 | 779 | wp\_update\_attachment\_metadata( $id, $new\_meta ); |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L791) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L791) |  |
  | 791 | 791 | // No old sizes, nothing to check |
  | 792 | 792 | if ( ! isset( $metadata['sizes'] ) || empty( $metadata['sizes'] ) ) { |
  | 793 |  | die( '1' ); |
  |  | 793 | wp\_die( '1' ); |
  | 794 | 794 | } |
  | 795 | 795 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L816) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L816) |  |
  | 816 | 816 | } |
  | 817 | 817 |  |
  | 818 |  | die( '1' ); |
  |  | 818 | wp\_die( '1' ); |
  | 819 | 819 | } |
  | 820 | 820 |  |
  | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2732430#L845) | […](/browser/imagemagick-engine/trunk/imagemagick-engine.php?rev=2801283#L845) |  |
  | 845 | 845 | 'failed'        => '<strong>' . \_\_( 'Failed to resize image!', 'imagemagick-engine' ) . '</strong>', |
  | 846 | 846 | 'resized'       => \_\_( 'Resized using ImageMagick Engine', 'imagemagick-engine' ), |
  |  | 847 | 'ime\_nonce'     => wp\_create\_nonce('ime-admin-nonce'), |
  | 847 | 848 | ]; |
  | 848 | 849 | wp\_localize\_script( 'ime-admin', 'ime\_admin', $data ); |
* ## [imagemagick-engine/trunk/js/ime-admin.js](/changeset/2801283/imagemagick-engine/trunk/js/ime-admin.js "Show the changeset 2801283 restricted to imagemagick-engine/trunk/js/ime-admin.js")

  | [r2311431](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L13 "Show revision 2311431 of this file in browser") | [r2801283](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2801283#L13 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | jQuery.get( ajaxurl, { |
  | 14 | 14 | action: 'ime\_test\_im\_path', |
  |  | 15 | ime\_nonce: ime\_admin.ime\_nonce, |
  | 15 | 16 | cli\_path: jQuery( '#cli\_path' ).val() |
  | 16 | 17 | }, function( data ) { |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L66) | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2801283#L67) |  |
  | 66 | 67 | //Regeneration of progressbar |
  | 67 | 68 | function imeRegenImages( id ) { |
  | 68 |  | jQuery.post( ajaxurl, { action: 'ime\_process\_image', id: id, sizes: rt\_sizes, force: rt\_force }, function( data ) { |
  |  | 69 | jQuery.post( ajaxurl, { action: 'ime\_process\_image', ime\_nonce: ime\_admin.ime\_nonce, id: id, sizes: rt\_sizes, force: rt\_force }, function( data ) { |
  | 69 | 70 | var n = parseInt( data, 10 ); |
  | 70 | 71 | if ( isNaN( n ) ) { |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L106) | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2801283#L107) |  |
  | 106 | 107 |  |
  | 107 | 108 | var message = jQuery( '#ime-message-' + id ).show(); |
  | 108 |  | jQuery.post( ajaxurl, { action: 'ime\_process\_image', id: id, sizes: sizes, force: force }, function( data ) { |
  |  | 109 | jQuery.post( ajaxurl, { action: 'ime\_process\_image', ime\_nonce: ime\_admin.ime\_nonce, id: id, sizes: sizes, force: force }, function( data ) { |
  | 109 | 110 | spinner.hide(); |
  | 110 | 111 | link.removeClass( 'disabled' ); |
  | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2311431#L142) | […](/browser/imagemagick-engine/trunk/js/ime-admin.js?rev=2801283#L143) |  |
  | 142 | 143 | $( '#regenerate-images' ).click( function() { |
  | 143 | 144 | $( '#regenerate-images-metabox img.ajax-feedback' ).show(); |
  | 144 |  | $.post( ajaxurl, { action: 'ime\_regeneration\_get\_images' }, function( data ) { |
  |  | 145 | $.post( ajaxurl, { action: 'ime\_regeneration\_get\_images', ime\_nonce: ime\_admin.ime\_nonce, }, function( data ) { |
  | 145 | 146 | jQuery( '#regen-message' ).addClass( 'hidden' ); |
  | 146 | 147 | rt\_images = data.split( ',' ); |
* ## [imagemagick-engine/trunk/readme.txt](/changeset/2801283/imagemagick-engine/trunk/readme.txt "Show the changeset 2801283 restricted to imagemagick-engine/trunk/readme.txt")

  | [r2732430](/browser/imagemagick-engine/trunk/readme.txt?rev=2732430#L3 "Show revision 2732430 of this file in browser") | [r2801283](/browser/imagemagick-engine/trunk/readme.txt?rev=2801283#L3 "Show revision 2801283 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: image, images, picture, imagemagick, gd, regenerate |
  | 4 | 4 | Requires at least: 3.0 |
  | 5 |  | Tested up to: 6.0.~~0~~ |
  | 6 |  | Stable tag: 1.7.~~4~~ |
  |  | 5 | Tested up to: 6.0.3 |
  |  | 6 | Stable tag: 1.7.6 |
  | 7 | 7 |  |
  | 8 | 8 | Improve the quality of re-sized images by replacing standard GD library with ImageMagick. |
  | […](/browser/imagemagick-engine/trunk/readme.txt?rev=2732430#L74) | […](/browser/imagemagick-engine/trunk/readme.txt?rev=2801283#L74) |  |
  | 74 | 74 |  |
  | 75 | 75 | == Changelog == |
  |  | 76 |  |
  |  | 77 | = 1.7.6 = |
  |  | 78 | \* Fix plugin vulnerabilities and added nonce checks |
  | 76 | 79 |  |
  | 77 | 80 | = 1.7.4 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2801283)
* [Zip Archive](?format=zip&new=2801283)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

