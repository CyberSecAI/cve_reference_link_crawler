```
{
  "vulnerability_details": {
    "root_cause": "The `ipv4_mib_exit_net` function is called before `tcp_sk_exit_batch` during net namespace destruction. This occurs because `tcp_sk_ops` is registered before `ipv4_mib_ops`, placing it earlier in the `pernet_list`. Consequently, if time-wait timers are still active, a use-after-free condition arises in `tw_timer_handler` when it attempts to access `net->mib.net_statistics` after `ipv4_mib_exit_net` has freed it.",
    "weaknesses": [
      "Use-after-free"
    ],
    "impact": "Kernel panic due to use-after-free in `tw_timer_handler`, potentially leading to denial of service.",
    "attack_vectors": "Triggering the destruction of a network namespace while time-wait timers are active can lead to exploitation.",
    "required_capabilities": "The attacker needs to have the ability to create and destroy network namespaces, and create connections that will lead to time-wait timers."
  },
  "additional_details": "The vulnerability was introduced by commit 61a7e26028b9 ('mib: put net statistics on struct net'), which allocated network statistics to the `net` structure and freed it during namespace destruction. The fix moves `init_ipv4_mibs()` before `tcp_init()` to ensure mib exit is called after tcp exit and also replaces `pr_crit()` with `panic()` when initialization fails."
}
```