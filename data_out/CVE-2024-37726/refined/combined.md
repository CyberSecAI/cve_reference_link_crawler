=== Content from github.com_c90e9316_20250111_132803.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=carsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[carsonchan12345](/carsonchan12345)
/
**[CVE-2024-37726-MSI-Center-Local-Privilege-Escalation](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation)**
Public

* [Notifications](/login?return_to=%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)
* [Star
   33](/login?return_to=%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)

[33
stars](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/stargazers) [13
forks](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/forks) [Branches](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/branches) [Tags](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tags) [Activity](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/activity)
 [Star](/login?return_to=%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation)

 [Notifications](/login?return_to=%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation) You must be signed in to change notification settings

* [Code](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation)
* [Issues
  0](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/issues)
* [Pull requests
  0](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/pulls)
* [Actions](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/actions)
* [Projects
  0](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/projects)
* [Security](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/security)
* [Insights](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/pulse)

Additional navigation options

* [Code](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation)
* [Issues](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/issues)
* [Pull requests](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/pulls)
* [Actions](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/actions)
* [Projects](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/projects)
* [Security](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/security)
* [Insights](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/pulse)

# carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation

    main[Branches](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/branches)[Tags](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/commits/main/) | | |
| [CVE-2024-37726 MSI Center Local Privilege Escalati 0fff3750575149f29933d4a87bbd3164](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tree/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164 "CVE-2024-37726 MSI Center Local Privilege Escalati 0fff3750575149f29933d4a87bbd3164") | | [CVE-2024-37726 MSI Center Local Privilege Escalati 0fff3750575149f29933d4a87bbd3164](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tree/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164 "CVE-2024-37726 MSI Center Local Privilege Escalati 0fff3750575149f29933d4a87bbd3164") |  |  |
| [MSI Center EOP](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tree/main/MSI%20Center%20EOP "MSI Center EOP") | | [MSI Center EOP](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/tree/main/MSI%20Center%20EOP "MSI Center EOP") |  |  |
| [.gitattributes](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/.gitattributes ".gitattributes") |  |  |
| [README.md](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/README.md "README.md") | | [README.md](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-37726 MSI Center Local Privilege Escalation - Arbitrary File Overwrite Vulnerability

# Vulnerability Summary

A local privilege escalation vulnerability on Windows OS has been identified in MSI Center versions <= 2.0.36.0, which allows a low-privileged user to arbitrarily overwrite or delete high-privileged and critical files on a system. This vulnerability is caused by the MSI Center application running with NT AUTHORITY\SYSTEM privileges and writing the file to a low privilege user controlled directory, which allows a low-privileged user to manipulate the file system with symlink and trick the application into writing or overwriting files in arbitrary locations.

# **Vulnerability Details**

The vulnerability is triggered when a low-privileged user creates a directory and sets an OpLock on a file within that directory. The user can then utilize the "Export System Info" function in MSI Center to trigger a file write operation on the OpLocked file. While the OpLock is in place, the user can move the original file and create a junction to a target file, allowing the MSI Center application to overwrite or delete the target file with SYSTEM privileges.

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled.png)

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%201.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%201.png)

# **Steps to Reproduce**

1. Create a directory with a single file (e.g., C:\Users\Public\eop\12345.txt).
2. Set an OpLock on the file 12345.txt.
3. Choose the "Export System Info" function in MSI Center and select the OpLocked file to trigger a file write operation.
4. The MSI Center.exe and MSI.CentralServer.exe processes will be paused due to the OpLock.
5. Move the 12345.txt to empty the directory.
6. Create a junction from the original directory to a target location (e.g., GLOBAL\GLOBALROOT\RPC Control\12345.txt).
7. Create a symbolic link from the target location to the target file (e.g., C:\Windows\lsasetup.log).
8. Release the OpLock.
9. Delete the symbolic link.
10. The target file (e.g., C:\Windows\lsasetup.log) will be deleted and overwritten.

# Privilege Escalation

We could create and install the program without admin right, install it on anyway that low privilege user have write access. As the output contain the name of the installed program, we can abuse the program name, write the result to C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\backdoor.bat. Whenever an administrator login, they will execute our payload and cause privilege escalation.

Be sure to user MsiInfo.exe to remove the admin requirement of installation.

```
C:\Program Files (x86)\Windows Kits\10\bin\10.0.17763.0\x86\MsiInfo.exe "D:\tools\MSI Center EOP\t& calc.exe &\Release\t& calc.exe &.msi" -w 10
```

# **Steps of Privilege Escalation**

1. With Low privilege user, create and install the program with payload as program name.

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%202.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%202.png)

2. Re-run the poc but point the link to C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\calc.bat

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%203.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%203.png)

3. Observed that our payload has included in the output.

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%204.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%204.png)

4. By abusing the autorun features, when an administrator login, we could trick them to run arbitrary code.

[![Untitled](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/raw/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%205.png)](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/blob/main/CVE-2024-37726%20MSI%20Center%20Local%20Privilege%20Escalati%200fff3750575149f29933d4a87bbd3164/Untitled%205.png)

# **Impact**

A successful exploitation of this vulnerability allows a low-privileged user to arbitrarily overwrite or delete critical system files, leading to a potential escalation of privileges. This could result in a complete compromise of the system.

# **Reference**

<https://csr.msi.com/global/product-security-advisories>

# Remark

A new version (2.0.38.0) has been released on 3/7/2024 and fixed the vulnerability.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/activity)
### Stars

[**33**
stars](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/stargazers)
### Watchers

[**2**
watching](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/watchers)
### Forks

[**13**
forks](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fcarsonchan12345%2FCVE-2024-37726-MSI-Center-Local-Privilege-Escalation&report=carsonchan12345+%28user%29)

## [Releases](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/releases)

No releases published

## [Packages 0](/users/carsonchan12345/packages?repo_name=CVE-2024-37726-MSI-Center-Local-Privilege-Escalation)

No packages published

## Languages

* [C++
  83.5%](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/search?l=c%2B%2B)
* [C
  16.5%](/carsonchan12345/CVE-2024-37726-MSI-Center-Local-Privilege-Escalation/search?l=c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


