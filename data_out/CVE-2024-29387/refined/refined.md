- **Root cause of vulnerability**: The vulnerability stems from the `print.php` file using the `exec` function with the `$path` variable, which is retrieved from a global parameter `pathToWkHtmlToPdf`. This parameter can be modified by a low-privileged user. By injecting malicious code into this path and then triggering the print function, arbitrary OS commands can be executed.

- **Weaknesses/vulnerabilities present**:
    - **Uncontrolled Parameter Modification**: Low-privileged users can modify the `pathToWkHtmlToPdf` global parameter through `/tool/saveGlobalParameter.php`.
    - **OS Command Injection**: The `$path` variable, after being modified to contain malicious commands, is passed to the `exec` function in `/view/print.php`, leading to OS command injection.

- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary OS commands on the server, potentially leading to complete server compromise, data exfiltration, or other malicious activities.

- **Attack vectors**:
    - The attacker first logs in with guest credentials
    -  The attacker modifies the `paramAttachmentDirectory` parameter to a known location
    - The attacker uploads a file with a malicious name containing a command to execute.
    - The attacker modifies the `pathToWkHtmlToPdf` parameter to include the path to the uploaded file.
    - The attacker triggers the print function, which executes the malicious command.

- **Required attacker capabilities/position**:
    - The attacker needs to have a low-privileged account (e.g., guest) on the ProjeQtOr application.
    - The attacker needs to be able to send HTTP requests to the web application.