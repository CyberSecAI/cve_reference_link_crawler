<!DOCTYPE html>
<html lang='en'>
<head>
<title>cachefiles: defer exposing anon_fd until after copy_to_user() succeeds - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Baokun Li &lt;libaokun1@huawei.com&gt;</td><td class='right'>2024-05-22 19:43:05 +0800</td></tr>
<tr><th>committer</th><td>Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;</td><td class='right'>2024-06-21 14:40:16 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>6adeef1334a88e31ba3257908560645b63007ac3</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=53e5207a045f9b0a4596046d89b79aeb86c7da5c'>53e5207a045f9b0a4596046d89b79aeb86c7da5c</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32&amp;id2=53e5207a045f9b0a4596046d89b79aeb86c7da5c'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32.tar.gz'>linux-b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>cachefiles: defer exposing anon_fd until after copy_to_user() succeeds</div><div class='commit-msg'>[ Upstream commit 4b4391e77a6bf24cba2ef1590e113d9b73b11039 ]

After installing the anonymous fd, we can now see it in userland and close
it. However, at this point we may not have gotten the reference count of
the cache, but we will put it during colse fd, so this may cause a cache
UAF.

So grab the cache reference count before fd_install(). In addition, by
kernel convention, fd is taken over by the user land after fd_install(),
and the kernel should not call close_fd() after that, i.e., it should call
fd_install() after everything is ready, thus fd_install() is called after
copy_to_user() succeeds.

Fixes: c8383054506c ("cachefiles: notify the user daemon when looking up cookie")
Suggested-by: Hou Tao &lt;houtao1@huawei.com&gt;
Signed-off-by: Baokun Li &lt;libaokun1@huawei.com&gt;
Link: <a href="https://lore.kernel.org/r/20240522114308.2402121-10-libaokun@huaweicloud.com">https://lore.kernel.org/r/20240522114308.2402121-10-libaokun@huaweicloud.com</a>
Acked-by: Jeff Layton &lt;jlayton@kernel.org&gt;
Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/cachefiles/ondemand.c?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>fs/cachefiles/ondemand.c</a></td><td class='right'>53</td><td class='graph'><table summary='file diffstat' width='53%'><tr><td class='add' style='width: 62.3%;'/><td class='rem' style='width: 37.7%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 33 insertions, 20 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/fs/cachefiles/ondemand.c b/fs/cachefiles/ondemand.c<br/>index dbcd4161ea3a11..89f118d68d1254 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/cachefiles/ondemand.c?id=53e5207a045f9b0a4596046d89b79aeb86c7da5c'>fs/cachefiles/ondemand.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/cachefiles/ondemand.c?id=b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32'>fs/cachefiles/ondemand.c</a></div><div class='hunk'>@@ -4,6 +4,11 @@</div><div class='ctx'> #include &lt;linux/uio.h&gt;</div><div class='ctx'> #include "internal.h"</div><div class='ctx'> </div><div class='add'>+struct ondemand_anon_file {</div><div class='add'>+	struct file *file;</div><div class='add'>+	int fd;</div><div class='add'>+};</div><div class='add'>+</div><div class='ctx'> static inline void cachefiles_req_put(struct cachefiles_req *req)</div><div class='ctx'> {</div><div class='ctx'> 	if (refcount_dec_and_test(&amp;req-&gt;ref))</div><div class='hunk'>@@ -250,14 +255,14 @@ int cachefiles_ondemand_restore(struct cachefiles_cache *cache, char *args)</div><div class='ctx'> 	return 0;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-static int cachefiles_ondemand_get_fd(struct cachefiles_req *req)</div><div class='add'>+static int cachefiles_ondemand_get_fd(struct cachefiles_req *req,</div><div class='add'>+				      struct ondemand_anon_file *anon_file)</div><div class='ctx'> {</div><div class='ctx'> 	struct cachefiles_object *object;</div><div class='ctx'> 	struct cachefiles_cache *cache;</div><div class='ctx'> 	struct cachefiles_open *load;</div><div class='del'>-	struct file *file;</div><div class='ctx'> 	u32 object_id;</div><div class='del'>-	int ret, fd;</div><div class='add'>+	int ret;</div><div class='ctx'> </div><div class='ctx'> 	object = cachefiles_grab_object(req-&gt;object,</div><div class='ctx'> 			cachefiles_obj_get_ondemand_fd);</div><div class='hunk'>@@ -269,16 +274,16 @@ static int cachefiles_ondemand_get_fd(struct cachefiles_req *req)</div><div class='ctx'> 	if (ret &lt; 0)</div><div class='ctx'> 		goto err;</div><div class='ctx'> </div><div class='del'>-	fd = get_unused_fd_flags(O_WRONLY);</div><div class='del'>-	if (fd &lt; 0) {</div><div class='del'>-		ret = fd;</div><div class='add'>+	anon_file-&gt;fd = get_unused_fd_flags(O_WRONLY);</div><div class='add'>+	if (anon_file-&gt;fd &lt; 0) {</div><div class='add'>+		ret = anon_file-&gt;fd;</div><div class='ctx'> 		goto err_free_id;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	file = anon_inode_getfile("[cachefiles]", &amp;cachefiles_ondemand_fd_fops,</div><div class='del'>-				  object, O_WRONLY);</div><div class='del'>-	if (IS_ERR(file)) {</div><div class='del'>-		ret = PTR_ERR(file);</div><div class='add'>+	anon_file-&gt;file = anon_inode_getfile("[cachefiles]",</div><div class='add'>+				&amp;cachefiles_ondemand_fd_fops, object, O_WRONLY);</div><div class='add'>+	if (IS_ERR(anon_file-&gt;file)) {</div><div class='add'>+		ret = PTR_ERR(anon_file-&gt;file);</div><div class='ctx'> 		goto err_put_fd;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='hunk'>@@ -286,16 +291,15 @@ static int cachefiles_ondemand_get_fd(struct cachefiles_req *req)</div><div class='ctx'> 	if (object-&gt;ondemand-&gt;ondemand_id &gt; 0) {</div><div class='ctx'> 		spin_unlock(&amp;object-&gt;ondemand-&gt;lock);</div><div class='ctx'> 		/* Pair with check in cachefiles_ondemand_fd_release(). */</div><div class='del'>-		file-&gt;private_data = NULL;</div><div class='add'>+		anon_file-&gt;file-&gt;private_data = NULL;</div><div class='ctx'> 		ret = -EEXIST;</div><div class='ctx'> 		goto err_put_file;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	file-&gt;f_mode |= FMODE_PWRITE | FMODE_LSEEK;</div><div class='del'>-	fd_install(fd, file);</div><div class='add'>+	anon_file-&gt;file-&gt;f_mode |= FMODE_PWRITE | FMODE_LSEEK;</div><div class='ctx'> </div><div class='ctx'> 	load = (void *)req-&gt;msg.data;</div><div class='del'>-	load-&gt;fd = fd;</div><div class='add'>+	load-&gt;fd = anon_file-&gt;fd;</div><div class='ctx'> 	object-&gt;ondemand-&gt;ondemand_id = object_id;</div><div class='ctx'> 	spin_unlock(&amp;object-&gt;ondemand-&gt;lock);</div><div class='ctx'> </div><div class='hunk'>@@ -304,9 +308,11 @@ static int cachefiles_ondemand_get_fd(struct cachefiles_req *req)</div><div class='ctx'> 	return 0;</div><div class='ctx'> </div><div class='ctx'> err_put_file:</div><div class='del'>-	fput(file);</div><div class='add'>+	fput(anon_file-&gt;file);</div><div class='add'>+	anon_file-&gt;file = NULL;</div><div class='ctx'> err_put_fd:</div><div class='del'>-	put_unused_fd(fd);</div><div class='add'>+	put_unused_fd(anon_file-&gt;fd);</div><div class='add'>+	anon_file-&gt;fd = ret;</div><div class='ctx'> err_free_id:</div><div class='ctx'> 	xa_erase(&amp;cache-&gt;ondemand_ids, object_id);</div><div class='ctx'> err:</div><div class='hunk'>@@ -363,6 +369,7 @@ ssize_t cachefiles_ondemand_daemon_read(struct cachefiles_cache *cache,</div><div class='ctx'> 	struct cachefiles_msg *msg;</div><div class='ctx'> 	size_t n;</div><div class='ctx'> 	int ret = 0;</div><div class='add'>+	struct ondemand_anon_file anon_file;</div><div class='ctx'> 	XA_STATE(xas, &amp;cache-&gt;reqs, cache-&gt;req_id_next);</div><div class='ctx'> </div><div class='ctx'> 	xa_lock(&amp;cache-&gt;reqs);</div><div class='hunk'>@@ -396,7 +403,7 @@ ssize_t cachefiles_ondemand_daemon_read(struct cachefiles_cache *cache,</div><div class='ctx'> 	xa_unlock(&amp;cache-&gt;reqs);</div><div class='ctx'> </div><div class='ctx'> 	if (msg-&gt;opcode == CACHEFILES_OP_OPEN) {</div><div class='del'>-		ret = cachefiles_ondemand_get_fd(req);</div><div class='add'>+		ret = cachefiles_ondemand_get_fd(req, &amp;anon_file);</div><div class='ctx'> 		if (ret)</div><div class='ctx'> 			goto out;</div><div class='ctx'> 	}</div><div class='hunk'>@@ -404,10 +411,16 @@ ssize_t cachefiles_ondemand_daemon_read(struct cachefiles_cache *cache,</div><div class='ctx'> 	msg-&gt;msg_id = xas.xa_index;</div><div class='ctx'> 	msg-&gt;object_id = req-&gt;object-&gt;ondemand-&gt;ondemand_id;</div><div class='ctx'> </div><div class='del'>-	if (copy_to_user(_buffer, msg, n) != 0) {</div><div class='add'>+	if (copy_to_user(_buffer, msg, n) != 0)</div><div class='ctx'> 		ret = -EFAULT;</div><div class='del'>-		if (msg-&gt;opcode == CACHEFILES_OP_OPEN)</div><div class='del'>-			close_fd(((struct cachefiles_open *)msg-&gt;data)-&gt;fd);</div><div class='add'>+</div><div class='add'>+	if (msg-&gt;opcode == CACHEFILES_OP_OPEN) {</div><div class='add'>+		if (ret &lt; 0) {</div><div class='add'>+			fput(anon_file.file);</div><div class='add'>+			put_unused_fd(anon_file.fd);</div><div class='add'>+			goto out;</div><div class='add'>+		}</div><div class='add'>+		fd_install(anon_file.fd, anon_file.file);</div><div class='ctx'> 	}</div><div class='ctx'> out:</div><div class='ctx'> 	cachefiles_put_object(req-&gt;object, cachefiles_obj_put_read_req);</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-10 20:38:23 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
