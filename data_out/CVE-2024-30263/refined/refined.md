The provided content is related to CVE-2024-30263.

**Root cause of vulnerability:**
The PDF Viewer macro in XWiki allows users to access restricted PDF attachments by directly using the attachment URL in the `file` parameter of the macro, bypassing intended access controls.

**Weaknesses/vulnerabilities present:**
- Improper access control: The macro does not properly verify user permissions when an absolute URL is used to reference a PDF attachment.
- Information disclosure: Allows unauthorized access to restricted PDF attachments.
- The "asauthor" parameter, intended to delegate view rights, doesn't work as expected when an absolute URL is used.

**Impact of exploitation:**
- Users with edit rights can access restricted PDF files attached to wiki pages.
- On public wikis, guest users might access private PDF files if displayed on public pages using the attachment URL.
- Potential exposure of sensitive or confidential information stored in PDF files.

**Attack vectors:**
- A user with edit rights can create/edit a page and embed the PDF Viewer macro using the URL of a restricted PDF.
- A user with view rights can search for pages using the macro and find ones using a direct URL instead of the reference.

**Required attacker capabilities/position:**
- An attacker needs at least edit rights on the wiki to create a new page and insert the macro with the direct URL.
- Alternatively, an attacker with view rights can attempt to discover existing pages with vulnerable macro usage.
- The attacker needs the URL of the protected PDF attachment.