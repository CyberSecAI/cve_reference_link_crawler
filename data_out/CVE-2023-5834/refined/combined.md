=== Content from discuss.hashicorp.com_275d3299_20250111_082503.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-31 - Vagrant’s Windows Installer Allowed Directory Junction Write](/t/hcsec-2023-31-vagrant-s-windows-installer-allowed-directory-junction-write/59568)

[Security](/c/security/52)

[security-vagrant](https://discuss.hashicorp.com/tag/security-vagrant)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 27, 2023, 9:04pm

1

**Bulletin ID:** HCSEC-2023-31

**Affected Products / Versions:** Vagrant’s Windows installer; fixed in Vagrant 2.4.0.

**Publication Date:** October 27, 2023

**Summary**

The Vagrant Windows installer targeted a custom location with a non-protected path that could be junctioned, introducing potential for unauthorized file system writes. This vulnerability, CVE-2023-5834, was fixed in Vagrant 2.4.0.

**Background**

Vagrant is distributed in a range of platform-specific formats, available from [Vagrant downloads](https://developer.hashicorp.com/vagrant/downloads).

For the Windows platform, the format used is [Windows Installer](https://learn.microsoft.com/en-us/windows/win32/msi/windows-installer-portal) (MSI).

**Details**

It was reported that the Vagrant Windows installer’s usage of a custom location with a non-protected path exposed the target system to unauthorized file system write, via usage of a directory junction. The impact of this is system-dependent, but in some cases may include privilege escalation.

**Remediation**

This was addressed in Vagrant 2.4.0, by moving the Windows install location to the system-protected Program Files directory.

Customers using the Vagrant Windows installer should consider moving to the 2.4.0 release or newer. Please refer to [Upgrading Vagrant](https://developer.hashicorp.com/vagrant/docs/installation/upgrading) for general guidance and upgrade notes.

**Acknowledgement**

This issue was identified by the Lockheed Martin Red Team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-25 - Vagrant VMware Utility installation files vulnerable to modification by unprivileged user](https://discuss.hashicorp.com/t/hcsec-2024-25-vagrant-vmware-utility-installation-files-vulnerable-to-modification-by-unprivileged-user/71012)  [Security](/c/security/52) [security-vagrant](https://discuss.hashicorp.com/tag/security-vagrant) | 0 | 721 | October 29, 2024 |
| [HCSEC-2022-23 - Vagrant NFS sudoers Configuration Allows for Local Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2022-23-vagrant-nfs-sudoers-configuration-allows-for-local-privilege-escalation/45423)  [Security](/c/security/52) | 0 | 6119 | October 10, 2022 |
| [HCSEC-2022-02 - Nomad alloc Filesystem and Container Escape](https://discuss.hashicorp.com/t/hcsec-2022-02-nomad-alloc-filesystem-and-container-escape/35560)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7190 | February 11, 2022 |
| [Revoked certificate prevents Vagrant installation on Windows](https://discuss.hashicorp.com/t/revoked-certificate-prevents-vagrant-installation-on-windows/48846)  [Vagrant](/c/vagrant/24) [windows](https://discuss.hashicorp.com/tag/windows) | 1 | 381 | January 11, 2023 |
| [Mistaken Platform on Windows (PR suggestion)](https://discuss.hashicorp.com/t/mistaken-platform-on-windows-pr-suggestion/23295)  [Vagrant](/c/vagrant/24) | 5 | 1060 | January 11, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


