- **Root cause of vulnerability**: The TOTOLink A3700R router firmware (V9.1.2u.6134_B20201202) contains a command injection vulnerability in the `UploadFirmwareFile` function. The "FileName" parameter is directly passed to the `dosystem` function without proper sanitization.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to unsanitized input being passed to the `dosystem` function, which directly executes the input as a system command.
- **Impact of exploitation**: An attacker can execute arbitrary commands on the router's operating system, potentially leading to complete control over the device. This can result in data breaches, denial of service, or further attacks on the local network.
- **Attack vectors**: The vulnerability is exploited via a crafted HTTP POST request to `/cgi-bin/cstecgi.cgi` with a malicious "FileName" parameter in the JSON payload. The request is sent to the web interface of the router.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the router's web interface. This typically means being on the same network or having access through a port forward or other external access method. The attacker does not appear to need authentication.