

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tobias Schramm <t.schramm@manjaro.org> | 2023-08-27 17:25:57 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-10-06 13:16:07 +0200 |
| commit | [b3c21c9c7289692f4019f163c3b06d8bdf78b355](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)) | |
| tree | [27ac04e0fdb37c658f083f7c689ed73165c4780d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355) | |
| parent | [77562272fbf347f16aecbd8ba5b87f87a73a90be](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=77562272fbf347f16aecbd8ba5b87f87a73a90be) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355&id2=77562272fbf347f16aecbd8ba5b87f87a73a90be)) | |
| download | [linux-b3c21c9c7289692f4019f163c3b06d8bdf78b355.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b3c21c9c7289692f4019f163c3b06d8bdf78b355.tar.gz) | |

spi: sun6i: reduce DMA RX transfer width to single byte[ Upstream commit 171f8a49f212e87a8b04087568e1b3d132e36a18 ]
Through empirical testing it has been determined that sometimes RX SPI
transfers with DMA enabled return corrupted data. This is down to single
or even multiple bytes lost during DMA transfer from SPI peripheral to
memory. It seems the RX FIFO within the SPI peripheral can become
confused when performing bus read accesses wider than a single byte to it
during an active SPI transfer.
This patch reduces the width of individual DMA read accesses to the
RX FIFO to a single byte to mitigate that issue.
Signed-off-by: Tobias Schramm <t.schramm@manjaro.org>
Link: [https://lore.kernel.org/r/20230827152558.5368-2-t.schramm@manjaro.org](https://lore.kernel.org/r/20230827152558.5368-2-t.schramm%40manjaro.org)
Signed-off-by: Mark Brown <broonie@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)

| -rw-r--r-- | [drivers/spi/spi-sun6i.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/spi/spi-sun6i.c?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/spi/spi-sun6i.c b/drivers/spi/spi-sun6i.cindex cec2747235abfc..bc9c88dce067ab 100644--- a/[drivers/spi/spi-sun6i.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/spi/spi-sun6i.c?id=77562272fbf347f16aecbd8ba5b87f87a73a90be)+++ b/[drivers/spi/spi-sun6i.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/spi/spi-sun6i.c?id=b3c21c9c7289692f4019f163c3b06d8bdf78b355)@@ -211,7 +211,7 @@ static int sun6i\_spi\_prepare\_dma(struct sun6i\_spi \*sspi, struct dma\_slave\_config rxconf = { .direction = DMA\_DEV\_TO\_MEM, .src\_addr = sspi->dma\_addr\_rx,- .src\_addr\_width = DMA\_SLAVE\_BUSWIDTH\_4\_BYTES,+ .src\_addr\_width = DMA\_SLAVE\_BUSWIDTH\_1\_BYTE, .src\_maxburst = 8, }; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:31:33 +0000

