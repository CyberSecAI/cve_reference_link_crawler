=== Content from seclists.org_89952392_20250110_201354.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](68)
[By Date](date.html#69)
[![Next](/images/right-icon-16x16.png)](70)

[![Previous](/images/left-icon-16x16.png)](68)
[By Thread](index.html#69)
[![Next](/images/right-icon-16x16.png)](74)

![](/shared/images/nst-icons.svg#search)

# Buffer overflow in Sane

---

*From*: Meng Ruijie <ruijie\_meng () u nus edu>

*Date*: Sat, 20 Jan 2024 04:20:26 +0000

---

```
[Vulnerability description]
A buffer overflow existed in Sane v.1.2.1 via a crafted config file to the init_options() function.

[Vulnerability Type]
Buffer Overflow

[Vendor of Product]
sane

[Affected Product Code Base]
sane - 1.2.1

[Reference]
<https://gitlab.com/sane-project/backends/-/issues/709>

[CVE Reference]
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2023-46052 to this
vulnerability.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](68)
[By Date](date.html#69)
[![Next](/images/right-icon-16x16.png)](70)

[![Previous](/images/left-icon-16x16.png)](68)
[By Thread](index.html#69)
[![Next](/images/right-icon-16x16.png)](74)

### Current thread:

* **Buffer overflow in Sane** *Meng Ruijie (Jan 26)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from gitlab.com_e1036786_20250110_201355.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Possible SEGV (heap bounds overwrite) in init\_options() (test.c)

There is a possible heap bounds overwrite in `init_options()` from `test.c` (see [here](https://gitlab.com/sane-project/backends/-/blob/3c20a989cfec676fde7f64381f5d15dc6e30586a/backend/test.c#L401)):

```
  od->size = (SANE_Int) max_string_size (mode_list);
  ...
  test_device->val[opt_mode].s = malloc ((size_t) od->size);
  ...
  strcpy (test_device->val[opt_mode].s, init_mode);
```

The `test_device->val[opt_mode].s` buffer is set to the max mode size. However, the `init_mode` string is read directly from a file and could be any length, leading to a buffer overwrite in the call to `strcpy()`. This corrupts the heap, leading to a SEGV in a future call to `malloc()`.

Stack:

```
Program received signal SIGSEGV, Segmentation fault.
_int_malloc (av=av@entry=0x7ffff7df6c80 <main_arena>, bytes=bytes@entry=4)
    at ./malloc/malloc.c:3989
#0  _int_malloc (av=av@entry=0x7ffff7df6c80 <main_arena>, bytes=bytes@entry=4)
    at ./malloc/malloc.c:3989
#1  0x00007ffff7c9f592 in __GI___libc_malloc (bytes=bytes@entry=4)
    at ./malloc/malloc.c:3297
#2  0x00007ffff771d0eb in init_options (test_device=0x55555557b0f0)
    at /build/sane-backends-FM1saq/sane-backends-1.2.1/backend/test.c:469
#3  sane_test_open (devicename=<optimized out>, handle=<optimized out>)
    at /build/sane-backends-FM1saq/sane-backends-1.2.1/backend/test.c:2014
#4  0x00007ffff7f96de6 in sane_dll_open (full_name=<optimized out>,
    full_name@entry=0x7fffffffe32f "test",
    meta_handle=meta_handle@entry=0x5555555644b8 <device>)
    at /build/sane-backends-FM1saq/sane-backends-1.2.1/backend/dll.c:1294
#5  0x00007ffff7f96fd9 in sane_open (name=name@entry=0x7fffffffe32f "test",
    h=h@entry=0x5555555644b8 <device>)
    at /build/sane-backends-FM1saq/sane-backends-1.2.1/backend/dll-s.c:27
#6  0x0000555555557188 in main (argc=<optimized out>, argv=0x7fffffffdff8)
    at /usr/src/sane-backends-1.2.1-1/frontend/scanimage.c:2434
```

PoC:

[test.conf](/-/project/429008/uploads/837bdd27ac32232ca5a4404dc7d868f8/test.conf)

To reproduce, run `scanimage -d test`.

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


