=== Content from git.kernel.org_1b4abbd8_20250110_194047.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Boris Ostrovsky <boris.ostrovsky@oracle.com> | 2019-10-30 19:01:31 +0000 |
| --- | --- | --- |
| committer | Paolo Bonzini <pbonzini@redhat.com> | 2020-01-30 18:45:54 +0100 |
| commit | [8c6de56a42e0c657955e12b882a81ef07d1d073e](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)) | |
| tree | [46a20e7ac5a0365ffa0d5bf414955ebf3f36db46](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e) | |
| parent | [ae6088216ce4b99b3a4aaaccd2eb2dd40d473d42](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ae6088216ce4b99b3a4aaaccd2eb2dd40d473d42) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e&id2=ae6088216ce4b99b3a4aaaccd2eb2dd40d473d42)) | |
| download | [linux-8c6de56a42e0c657955e12b882a81ef07d1d073e.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-8c6de56a42e0c657955e12b882a81ef07d1d073e.tar.gz) | |

x86/kvm: Be careful not to clear KVM\_VCPU\_FLUSH\_TLB bitkvm\_steal\_time\_set\_preempted() may accidentally clear KVM\_VCPU\_FLUSH\_TLB
bit if it is called more than once while VCPU is preempted.
This is part of CVE-2019-3016.
(This bug was also independently discovered by Jim Mattson
<jmattson@google.com>)
Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)

| -rw-r--r-- | [arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/kvm/x86.c?id=8c6de56a42e0c657955e12b882a81ef07d1d073e) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.cindex cf917139de6ba2..8c9369151e9f3f 100644--- a/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=ae6088216ce4b99b3a4aaaccd2eb2dd40d473d42)+++ b/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)@@ -3504,6 +3504,9 @@ static void kvm\_steal\_time\_set\_preempted(struct kvm\_vcpu \*vcpu) if (!(vcpu->arch.st.msr\_val & KVM\_MSR\_ENABLED)) return; + if (vcpu->arch.st.steal.preempted)+ return;+ vcpu->arch.st.steal.preempted = KVM\_VCPU\_PREEMPTED;  kvm\_write\_guest\_offset\_cached(vcpu->kvm, &vcpu->arch.st.stime, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:39:25 +0000



=== Content from packetstormsecurity.com_0106215e_20250110_194046.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from usn.ubuntu.com_f16cfd06_20250110_194050.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4301-1: Linux kernel vulnerabilities

25 March 2020

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [linux-aws-5.0](/security/cves?package=linux-aws-5.0) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-gke-5.0](/security/cves?package=linux-gke-5.0) - Linux kernel for Google Container Engine (GKE) systems
* [linux-oem-osp1](/security/cves?package=linux-oem-osp1) - Linux kernel for OEM processors
* [linux-oracle-5.0](/security/cves?package=linux-oracle-5.0) - Linux kernel for Oracle Cloud systems

## Details

It was discovered that the KVM implementation in the Linux kernel, when

paravirtual TLB flushes are enabled in guests, the hypervisor in some

situations could miss deferred TLB flushes or otherwise mishandle them. An

attacker in a guest VM could use this to expose sensitive information (read

memory from another guest VM). ([CVE-2019-3016](/security/CVE-2019-3016))

Paulo Bonzini discovered that the KVM hypervisor implementation in the

Linux kernel could improperly let a nested (level 2) guest access the

resources of a parent (level 1) guest in certain situations. An attacker

could use this to expose sensitive information. ([CVE-2020-2732](/security/CVE-2020-2732))

It was discovered that the RPMSG character device interface in the Linux

kernel did not properly deallocate memory in certain error conditions. A

local attacker could possibly use this to cause a denial of service (kernel

memory exhaustion). ([CVE-2019-19053](/security/CVE-2019-19053))

It was discovered that the Marvell Wi-Fi device driver in the Linux kernel

did not properly deallocate memory in certain error conditions. A local

attacker could use this to possibly cause a denial of service (kernel

memory exhaustion). ([CVE-2019-19056](/security/CVE-2019-19056))

It was discovered that the Intel(R) Wi-Fi device driver in the Linux kernel

device driver in the Linux kernel did not properly deallocate memory in

certain error conditions. A local attacker could possibly use this to cause

a denial of service (kernel memory exhaustion). ([CVE-2019-19058](/security/CVE-2019-19058),

[CVE-2019-19059](/security/CVE-2019-19059))

It was discovered that the Brocade BFA Fibre Channel device driver in the

Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-19066](/security/CVE-2019-19066))

It was discovered that the Realtek RTL8xxx USB Wi-Fi device driver in the

Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-19068](/security/CVE-2019-19068))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [linux-image-5.0.0-1013-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oracle-5.0)
  -
  [5.0.0-1013.18](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oracle-5.0/5.0.0-1013.18)
* [linux-image-5.0.0-1027-aws](https://launchpad.net/ubuntu/%2Bsource/linux-aws-5.0)
  -
  [5.0.0-1027.30](https://launchpad.net/ubuntu/%2Bsource/linux-aws-5.0/5.0.0-1027.30)
* [linux-image-5.0.0-1032-gke](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.0)
  -
  [5.0.0-1032.33](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.0/5.0.0-1032.33)
* [linux-image-5.0.0-1033-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp)
  -
  [5.0.0-1033.34](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp/5.0.0-1033.34)
* [linux-image-5.0.0-1035-azure](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure)
  -
  [5.0.0-1035.37](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure/5.0.0-1035.37)
* [linux-image-5.0.0-1043-oem-osp1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-osp1)
  -
  [5.0.0-1043.48](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-osp1/5.0.0-1043.48)
* [linux-image-aws-edge](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws-5.0)
  -
  [5.0.0.1027.41](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws-5.0/5.0.0.1027.41)
* [linux-image-azure](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure)
  -
  [5.0.0.1035.46](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure/5.0.0.1035.46)
* [linux-image-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp)
  -
  [5.0.0.1033.37](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp/5.0.0.1033.37)
* [linux-image-gke-5.0](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.0)
  -
  [5.0.0.1032.20](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.0/5.0.0.1032.20)
* [linux-image-oem-osp1](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-osp1)
  -
  [5.0.0.1043.48](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-osp1/5.0.0.1043.48)
* [linux-image-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oracle-5.0)
  -
  [5.0.0.1013.13](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oracle-5.0/5.0.0.1013.13)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2019-19053](/security/CVE-2019-19053)
* [CVE-2019-19056](/security/CVE-2019-19056)
* [CVE-2019-19058](/security/CVE-2019-19058)
* [CVE-2019-19059](/security/CVE-2019-19059)
* [CVE-2019-19066](/security/CVE-2019-19066)
* [CVE-2019-19068](/security/CVE-2019-19068)
* [CVE-2019-3016](/security/CVE-2019-3016)
* [CVE-2020-2732](/security/CVE-2020-2732)

## Related notices

* [USN-4300-1](/security/notices/USN-4300-1)
* [USN-4286-1](/security/notices/USN-4286-1)
* [USN-4286-2](/security/notices/USN-4286-2)
* [USN-4302-1](/security/notices/USN-4302-1)
* [LSN-0065-1](/security/notices/LSN-0065-1)
* [USN-4303-1](/security/notices/USN-4303-1)
* [USN-4303-2](/security/notices/USN-4303-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lore.kernel.org_f3f863db_20250110_194049.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../?t=20200130180203)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Paolo Bonzini <pbonzini@redhat.com>
To: [linux-kernel@vger.kernel.org](../../lkml/?t=20200130180203), [kvm@vger.kernel.org](../../kvm/?t=20200130180203)
Cc: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Subject: [[FYI PATCH 0/5] Missing TLB flushes](#r)
Date: Thu, 30 Jan 2020 19:01:51 +0100	[[thread overview]](#r)
Message-ID: <1580407316-11391-1-git-send-email-pbonzini@redhat.com> (<raw>)

From: Boris Ostrovsky <boris.ostrovsky@oracle.com>

The KVM hypervisor may provide a guest with ability to defer remote TLB
flush when the remote VCPU is not running. When this feature is used,
the TLB flush will happen only when the remote VPCU is scheduled to run
again. This will avoid unnecessary (and expensive) IPIs.

Under certain circumstances, when a guest initiates such deferred action,
the hypervisor may miss the request. It is also possible that the guest
may mistakenly assume that it has already marked remote VCPU as needing
a flush when in fact that request had already been processed by the
hypervisor. In both cases this will result in an invalid translation
being present in a vCPU, potentially allowing accesses to memory locations
in that guest's address space that should not be accessible.

Note that only intra-guest memory is vulnerable.

The attached patches address both of these problems:
1. The first patch makes sure the hypervisor doesn't accidentally clear
guest's remote flush request
2. The rest of the patches prevent the race between hypervisor
acknowledging a remote flush request and guest issuing a new one.

Boris Ostrovsky (5):
  x86/kvm: Be careful not to clear KVM_VCPU_FLUSH_TLB bit
  x86/kvm: Introduce kvm_(un)map_gfn()
  x86/kvm: Cache gfn to pfn translation
  x86/KVM: Make sure KVM_VCPU_FLUSH_TLB flag is not missed
  x86/KVM: Clean up host's steal time structure

 arch/x86/include/asm/kvm_host.h |   4 +-
 arch/x86/kvm/x86.c              |  69 +++++++++++++++---------
 include/linux/kvm_host.h        |   5 ++
 include/linux/kvm_types.h       |   9 +++-
 virt/kvm/kvm_main.c             | 113 ++++++++++++++++++++++++++++++++++------
 5 files changed, 154 insertions(+), 46 deletions(-)

--
1.8.3.1

```

---

```
[next](../1580407316-11391-2-git-send-email-pbonzini%40redhat.com/)             [reply](#R)other threads:[[~2020-01-30 18:02 UTC](../?t=20200130180203)|[newest](../)]

Thread overview: 7+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
2020-01-30 18:01 [Paolo Bonzini [this message]](#t)
2020-01-30 18:01 ` [[FYI PATCH 1/5] x86/kvm: Be careful not to clear KVM_VCPU_FLUSH_TLB bit](../1580407316-11391-2-git-send-email-pbonzini%40redhat.com/) Paolo Bonzini
2020-01-30 18:01 ` [[FYI PATCH 2/5] x86/kvm: Introduce kvm_(un)map_gfn()](../1580407316-11391-3-git-send-email-pbonzini%40redhat.com/) Paolo Bonzini
2020-01-30 18:01 ` [[FYI PATCH 3/5] x86/kvm: Cache gfn to pfn translation](../1580407316-11391-4-git-send-email-pbonzini%40redhat.com/) Paolo Bonzini
2020-01-30 18:01 ` [[FYI PATCH 4/5] x86/KVM: Make sure KVM_VCPU_FLUSH_TLB flag is not missed](../1580407316-11391-5-git-send-email-pbonzini%40redhat.com/) Paolo Bonzini
2020-01-30 18:01 ` [[FYI PATCH 5/5] x86/KVM: Clean up host's steal time structure](../1580407316-11391-6-git-send-email-pbonzini%40redhat.com/) Paolo Bonzini
2020-02-01  5:53 ` [[FYI PATCH 0/5] Missing TLB flushes](../CANRm%2BCyyuWUOAj81Sg8UH_jMybZWmvZxWPWZ_twMvFnPxKD3hQ%40mail.gmail.com/) Wanpeng Li

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=1580407316-11391-1-git-send-email-pbonzini@redhat.com \
    --to=pbonzini@redhat.com \
    --cc=boris.ostrovsky@oracle.com \
    --cc=kvm@vger.kernel.org \
    --cc=linux-kernel@vger.kernel.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from git.kernel.org_06373724_20250110_194048.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=b043138246a41064527cf019a3d51d9f015e9796)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b043138246a41064527cf019a3d51d9f015e9796)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b043138246a41064527cf019a3d51d9f015e9796)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b043138246a41064527cf019a3d51d9f015e9796)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Boris Ostrovsky <boris.ostrovsky@oracle.com> | 2019-12-05 03:45:32 +0000 |
| --- | --- | --- |
| committer | Paolo Bonzini <pbonzini@redhat.com> | 2020-01-30 18:45:55 +0100 |
| commit | [b043138246a41064527cf019a3d51d9f015e9796](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b043138246a41064527cf019a3d51d9f015e9796) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=b043138246a41064527cf019a3d51d9f015e9796)) | |
| tree | [e702c1dec588a3c872d1c94e8e877176480b5846](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b043138246a41064527cf019a3d51d9f015e9796) | |
| parent | [917248144db5d7320655dbb41d3af0b8a0f3d589](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=917248144db5d7320655dbb41d3af0b8a0f3d589) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b043138246a41064527cf019a3d51d9f015e9796&id2=917248144db5d7320655dbb41d3af0b8a0f3d589)) | |
| download | [linux-b043138246a41064527cf019a3d51d9f015e9796.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-b043138246a41064527cf019a3d51d9f015e9796.tar.gz) | |

x86/KVM: Make sure KVM\_VCPU\_FLUSH\_TLB flag is not missedThere is a potential race in record\_steal\_time() between setting
host-local vcpu->arch.st.steal.preempted to zero (i.e. clearing
KVM\_VCPU\_PREEMPTED) and propagating this value to the guest with
kvm\_write\_guest\_cached(). Between those two events the guest may
still see KVM\_VCPU\_PREEMPTED in its copy of kvm\_steal\_time, set
KVM\_VCPU\_FLUSH\_TLB and assume that hypervisor will do the right
thing. Which it won't.
Instad of copying, we should map kvm\_steal\_time and that will
guarantee atomicity of accesses to @preempted.
This is part of CVE-2019-3016.
Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b043138246a41064527cf019a3d51d9f015e9796)

| -rw-r--r-- | [arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/kvm/x86.c?id=b043138246a41064527cf019a3d51d9f015e9796) | 51 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 30 insertions, 21 deletions

| diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.cindex 0795bc876abcca..f1845df7e7c324 100644--- a/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=917248144db5d7320655dbb41d3af0b8a0f3d589)+++ b/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=b043138246a41064527cf019a3d51d9f015e9796)@@ -2581,45 +2581,47 @@ static void kvm\_vcpu\_flush\_tlb(struct kvm\_vcpu \*vcpu, bool invalidate\_gpa)  static void record\_steal\_time(struct kvm\_vcpu \*vcpu) {+ struct kvm\_host\_map map;+ struct kvm\_steal\_time \*st;+ if (!(vcpu->arch.st.msr\_val & KVM\_MSR\_ENABLED)) return; - if (unlikely(kvm\_read\_guest\_cached(vcpu->kvm, &vcpu->arch.st.stime,- &vcpu->arch.st.steal, sizeof(struct kvm\_steal\_time))))+ /\* -EAGAIN is returned in atomic context so we can just return. \*/+ if (kvm\_map\_gfn(vcpu, vcpu->arch.st.msr\_val >> PAGE\_SHIFT,+ &map, &vcpu->arch.st.cache, false)) return; + st = map.hva ++ offset\_in\_page(vcpu->arch.st.msr\_val & KVM\_STEAL\_VALID\_BITS);+ /\* \* Doing a TLB flush here, on the guest's behalf, can avoid \* expensive IPIs. \*/ trace\_kvm\_pv\_tlb\_flush(vcpu->vcpu\_id,- vcpu->arch.st.steal.preempted & KVM\_VCPU\_FLUSH\_TLB);- if (xchg(&vcpu->arch.st.steal.preempted, 0) & KVM\_VCPU\_FLUSH\_TLB)+ st->preempted & KVM\_VCPU\_FLUSH\_TLB);+ if (xchg(&st->preempted, 0) & KVM\_VCPU\_FLUSH\_TLB) kvm\_vcpu\_flush\_tlb(vcpu, false); - if (vcpu->arch.st.steal.version & 1)- vcpu->arch.st.steal.version += 1; /\* first time write, random junk \*/+ vcpu->arch.st.steal.preempted = 0; - vcpu->arch.st.steal.version += 1;+ if (st->version & 1)+ st->version += 1; /\* first time write, random junk \*/ - kvm\_write\_guest\_cached(vcpu->kvm, &vcpu->arch.st.stime,- &vcpu->arch.st.steal, sizeof(struct kvm\_steal\_time));+ st->version += 1;  smp\_wmb(); - vcpu->arch.st.steal.steal += current->sched\_info.run\_delay -+ st->steal += current->sched\_info.run\_delay - vcpu->arch.st.last\_steal; vcpu->arch.st.last\_steal = current->sched\_info.run\_delay; - kvm\_write\_guest\_cached(vcpu->kvm, &vcpu->arch.st.stime,- &vcpu->arch.st.steal, sizeof(struct kvm\_steal\_time));- smp\_wmb(); - vcpu->arch.st.steal.version += 1;+ st->version += 1; - kvm\_write\_guest\_cached(vcpu->kvm, &vcpu->arch.st.stime,- &vcpu->arch.st.steal, sizeof(struct kvm\_steal\_time));+ kvm\_unmap\_gfn(vcpu, &map, &vcpu->arch.st.cache, true, false); }  int kvm\_set\_msr\_common(struct kvm\_vcpu \*vcpu, struct msr\_data \*msr\_info)@@ -3501,18 +3503,25 @@ void kvm\_arch\_vcpu\_load(struct kvm\_vcpu \*vcpu, int cpu)  static void kvm\_steal\_time\_set\_preempted(struct kvm\_vcpu \*vcpu) {+ struct kvm\_host\_map map;+ struct kvm\_steal\_time \*st;+ if (!(vcpu->arch.st.msr\_val & KVM\_MSR\_ENABLED)) return;  if (vcpu->arch.st.steal.preempted) return; - vcpu->arch.st.steal.preempted = KVM\_VCPU\_PREEMPTED;+ if (kvm\_map\_gfn(vcpu, vcpu->arch.st.msr\_val >> PAGE\_SHIFT, &map,+ &vcpu->arch.st.cache, true))+ return;++ st = map.hva ++ offset\_in\_page(vcpu->arch.st.msr\_val & KVM\_STEAL\_VALID\_BITS);++ st->preempted = vcpu->arch.st.steal.preempted = KVM\_VCPU\_PREEMPTED; - kvm\_write\_guest\_offset\_cached(vcpu->kvm, &vcpu->arch.st.stime,- &vcpu->arch.st.steal.preempted,- offsetof(struct kvm\_steal\_time, preempted),- sizeof(vcpu->arch.st.steal.preempted));+ kvm\_unmap\_gfn(vcpu, &map, &vcpu->arch.st.cache, true, true); }  void kvm\_arch\_vcpu\_put(struct kvm\_vcpu \*vcpu) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:39:26 +0000



=== Content from www.openwall.com_6f7dc575_20250110_194046.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <7151FEEF-4905-4333-8F4A-8B46AEC36E07@oracle.com>
Date: Thu, 30 Jan 2020 18:00:03 +0000
From: John Haxby <john.haxby@...cle.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2019-3016: information leak within a KVM guest

The problem is missing TLB flushes which potentially allows a process in a KVM guest to access memory locations within that guest that it should not have access to.

The problem is limited to host kernels 4.10 onwards with guest kernels running 4.16 onwards and PV TLB exposed to the guests.  Additionally, the problem mainly affects AMD processors but we cannot rule out Intel CPUs.

From the patch cover note:

> The KVM hypervisor may provide a guest with ability to defer remote TLB
> flush when the remote VCPU is not running. When this feature is used,
> the TLB flush will happen only when the remote VPCU is scheduled to run
> again. This will avoid unnecessary (and expensive) IPIs.
>
> Under certain circumstances, when a guest initiates such deferred action,
> the hypervisor may miss the request. It is also possible that the guest
> may mistakenly assume that it has already marked remote VCPU as needing a
> flush when in fact that request had already been processed by the hypervisor.
> In both cases this will result in an invalid translation being present in a
> vCPU, potentially allowing accesses to memory locations in that guest's
> address space that should not be accessible.
>
> Note that only intra-guest memory is vulnerable.
>
> The attached patches address both of these problems:
> 1. The first patch makes sure the hypervisor doesn't accidentally clear
> guest's remote flush request
> 2. The rest of the patches prevent the race between hypervisor
> acknowledging a remote flush request and guest issuing a new one.

Part of the attached patches were discovered independently[1] and made public on 2019-01-16 although it was our considered opinion that the security implications of this were not at all obvious so we kept the embargo.

The original patches posted to linux-distros broke ARM so I'm attaching the v2 patches.  These will be heading to the mainline kernel shortly.

jch

[1] [https://lore.kernel.org/kvm/20200116001635.174948-1-jmattson@google.com](https://lore.kernel.org/kvm/20200116001635.174948-1-jmattson%40google.com)

Download attachment "[CVE-2019-3016.v2.tgz](4/1)" of type "application/octet-stream" (5853 bytes)

Download attachment "[signature.asc](4/2)" of type "application/pgp-signature" (269 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_c749fe97_20250110_194047.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Boris Ostrovsky <boris.ostrovsky@oracle.com> | 2019-11-12 16:35:06 +0000 |
| --- | --- | --- |
| committer | Paolo Bonzini <pbonzini@redhat.com> | 2020-01-30 18:45:54 +0100 |
| commit | [1eff70a9abd46f175defafd29bc17ad456f398a7](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1eff70a9abd46f175defafd29bc17ad456f398a7) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)) | |
| tree | [977d32b00d6c75b404fb7b131d89f9e5de9021cd](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=1eff70a9abd46f175defafd29bc17ad456f398a7) | |
| parent | [8c6de56a42e0c657955e12b882a81ef07d1d073e](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8c6de56a42e0c657955e12b882a81ef07d1d073e) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1eff70a9abd46f175defafd29bc17ad456f398a7&id2=8c6de56a42e0c657955e12b882a81ef07d1d073e)) | |
| download | [linux-1eff70a9abd46f175defafd29bc17ad456f398a7.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-1eff70a9abd46f175defafd29bc17ad456f398a7.tar.gz) | |

x86/kvm: Introduce kvm\_(un)map\_gfn()kvm\_vcpu\_(un)map operates on gfns from any current address space.
In certain cases we want to make sure we are not mapping SMRAM
and for that we can use kvm\_(un)map\_gfn() that we are introducing
in this patch.
This is part of CVE-2019-3016.
Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=1eff70a9abd46f175defafd29bc17ad456f398a7)

| -rw-r--r-- | [include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/linux/kvm_host.h?id=1eff70a9abd46f175defafd29bc17ad456f398a7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/virt/kvm/kvm_main.c?id=1eff70a9abd46f175defafd29bc17ad456f398a7) | 29 | |  |  |  | | --- | --- | --- | |

2 files changed, 26 insertions, 5 deletions

| diff --git a/include/linux/kvm\_host.h b/include/linux/kvm\_host.hindex 538c25e778c07e..0cb78f55b92c93 100644--- a/[include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_host.h?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)+++ b/[include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_host.h?id=1eff70a9abd46f175defafd29bc17ad456f398a7)@@ -775,8 +775,10 @@ struct kvm\_memory\_slot \*kvm\_vcpu\_gfn\_to\_memslot(struct kvm\_vcpu \*vcpu, gfn\_t gfn kvm\_pfn\_t kvm\_vcpu\_gfn\_to\_pfn\_atomic(struct kvm\_vcpu \*vcpu, gfn\_t gfn); kvm\_pfn\_t kvm\_vcpu\_gfn\_to\_pfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn); int kvm\_vcpu\_map(struct kvm\_vcpu \*vcpu, gpa\_t gpa, struct kvm\_host\_map \*map);+int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map); struct page \*kvm\_vcpu\_gfn\_to\_page(struct kvm\_vcpu \*vcpu, gfn\_t gfn); void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty);+int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty); unsigned long kvm\_vcpu\_gfn\_to\_hva(struct kvm\_vcpu \*vcpu, gfn\_t gfn); unsigned long kvm\_vcpu\_gfn\_to\_hva\_prot(struct kvm\_vcpu \*vcpu, gfn\_t gfn, bool \*writable); int kvm\_vcpu\_read\_guest\_page(struct kvm\_vcpu \*vcpu, gfn\_t gfn, void \*data, int offset,diff --git a/virt/kvm/kvm\_main.c b/virt/kvm/kvm\_main.cindex 00268290dcbd85..9ef58a233a7c38 100644--- a/[virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/virt/kvm/kvm_main.c?id=8c6de56a42e0c657955e12b882a81ef07d1d073e)+++ b/[virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/virt/kvm/kvm_main.c?id=1eff70a9abd46f175defafd29bc17ad456f398a7)@@ -1821,12 +1821,13 @@ struct page \*gfn\_to\_page(struct kvm \*kvm, gfn\_t gfn) } EXPORT\_SYMBOL\_GPL(gfn\_to\_page); -static int \_\_kvm\_map\_gfn(struct kvm\_memory\_slot \*slot, gfn\_t gfn,+static int \_\_kvm\_map\_gfn(struct kvm\_memslots \*slots, gfn\_t gfn, struct kvm\_host\_map \*map) { kvm\_pfn\_t pfn; void \*hva = NULL; struct page \*page = KVM\_UNMAPPED\_PAGE;+ struct kvm\_memory\_slot \*slot = \_\_gfn\_to\_memslot(slots, gfn);  if (!map) return -EINVAL;@@ -1855,14 +1856,20 @@ static int \_\_kvm\_map\_gfn(struct kvm\_memory\_slot \*slot, gfn\_t gfn, return 0; } +int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map)+{+ return \_\_kvm\_map\_gfn(kvm\_memslots(vcpu->kvm), gfn, map);+}+EXPORT\_SYMBOL\_GPL(kvm\_map\_gfn);+ int kvm\_vcpu\_map(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map) {- return \_\_kvm\_map\_gfn(kvm\_vcpu\_gfn\_to\_memslot(vcpu, gfn), gfn, map);+ return \_\_kvm\_map\_gfn(kvm\_vcpu\_memslots(vcpu), gfn, map); } EXPORT\_SYMBOL\_GPL(kvm\_vcpu\_map); -void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map,- bool dirty)+static void \_\_kvm\_unmap\_gfn(struct kvm\_memory\_slot \*memslot,+ struct kvm\_host\_map \*map, bool dirty) { if (!map) return;@@ -1878,7 +1885,7 @@ void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, #endif  if (dirty) {- kvm\_vcpu\_mark\_page\_dirty(vcpu, map->gfn);+ mark\_page\_dirty\_in\_slot(memslot, map->gfn); kvm\_release\_pfn\_dirty(map->pfn); } else { kvm\_release\_pfn\_clean(map->pfn);@@ -1887,6 +1894,18 @@ void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, map->hva = NULL; map->page = NULL; }++int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty)+{+ \_\_kvm\_unmap\_gfn(gfn\_to\_memslot(vcpu->kvm, map->gfn), map, dirty);+ return 0;+}+EXPORT\_SYMBOL\_GPL(kvm\_unmap\_gfn);++void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty)+{+ \_\_kvm\_unmap\_gfn(kvm\_vcpu\_gfn\_to\_memslot(vcpu, map->gfn), map, dirty);+} EXPORT\_SYMBOL\_GPL(kvm\_vcpu\_unmap);  struct page \*kvm\_vcpu\_gfn\_to\_page(struct kvm\_vcpu \*vcpu, gfn\_t gfn) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:54:01 +0000



=== Content from bugzilla.redhat.com_d2d496d2_20250110_194047.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1792167)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1792167)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1792167)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1792167

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1792167**](show_bug.cgi?id=1792167)
(CVE-2019-3016)
- [CVE-2019-3016](https://access.redhat.com/security/cve/CVE-2019-3016) kernel: kvm: Information leak within a KVM guest

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2019-3016 kernel: kvm: Information leak within a KVM guest

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2019-3016 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1795128](show_bug.cgi?id=1795128) [1795129](show_bug.cgi?id=1795129) [1796650](show_bug.cgi?id=1796650 "CLOSED ERRATA - CVE-2019-3016 kernel: kvm: Information leak within a KVM guest [fedora-all]") [1857755](show_bug.cgi?id=1857755) [1857756](show_bug.cgi?id=1857756) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1792163](show_bug.cgi?id=1792163) | | TreeView+ | [depends on](buglist.cgi?bug_id=1792167&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1792167&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-01-17 08:11 UTC by msiddiqu | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-16 20:45 UTC ([History](show_activity.cgi?id=1792167)) | | [CC List:](page.cgi?id=fields.html#cclist) | 49 users (show)  acaringi airlied bdas bhu blc brdeoliv bskeggs dhoward dvlasenk esammons fhrbata hdegoede hkrzesin iboverma ichavero itamar jarodwilson jeremy jforbes jglisse jlelli jmaloy john.j5live jonathan josef jross jshortt jstancek jwboyer kernel-maint kernel-mgr labbott lgoncalv linville masami256 matt mchehab mcressma mjg59 mlangsdo nmurray pbonzini ppandit qzhao rt-maint rvrbovsk security-response-team steved williams | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | A flaw was found in the way Linux kernel's KVM hypervisor handled deferred TLB flush requests from guest. A race condition may occur between the guest issuing a deferred TLB flush request to KVM, and then KVM handling and acknowledging it. This may result in invalid address translations from TLB being used to access guest memory, leading to a potential information leakage issue. An attacker may use this flaw to access guest memory locations that it should not have access to. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-07-21 13:27:47 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHBA-2020:3086](https://access.redhat.com/errata/RHBA-2020%3A3086) | 0 | None | None | None | 2020-07-22 01:04:29 UTC | | Red Hat Product Errata | [RHSA-2020:3010](https://access.redhat.com/errata/RHSA-2020%3A3010) | 0 | None | None | None | 2020-07-21 11:04:55 UTC | | Red Hat Product Errata | [RHSA-2020:3016](https://access.redhat.com/errata/RHSA-2020%3A3016) | 0 | None | None | None | 2020-07-21 11:23:11 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1792167#c0)  msiddiqu    2020-01-17 08:11:17 UTC  ``` A flaw was found in the way Linux kernel's KVM hypervisor handled deferred TLB flush requests from guest. A race condition may occur between guest issuing a deferred TLB flush request to KVM and KVM handling and acknowledging it. This may result in invalid address translations from TLB being used to access guest memory, leading to potential information leakage issue.  A guest user/process may use this flaw to access guest memory locations which it should not have access to.  Upstream patches: -----------------   -> <https://git.kernel.org/linus/a6bd811f1209fe1c64c9f6fd578101d6436c6b6e>   -> <https://git.kernel.org/linus/b043138246a41064527cf019a3d51d9f015e9796>   -> <https://git.kernel.org/linus/917248144db5d7320655dbb41d3af0b8a0f3d589>   -> <https://git.kernel.org/linus/1eff70a9abd46f175defafd29bc17ad456f398a7>   -> <https://git.kernel.org/linus/8c6de56a42e0c657955e12b882a81ef07d1d073e>   -> <https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/?qt=grep&q=CVE-2019-3016>   ```  [Comment 4](show_bug.cgi?id=1792167#c4)  Petr Matousek    2020-01-30 13:55:07 UTC  ``` Mitigation:  This issue can only be resolved by applying updates.  Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.   ```  [Comment 5](show_bug.cgi?id=1792167#c5)  Petr Matousek    2020-01-30 20:35:53 UTC  ``` External References:  <https://www.openwall.com/lists/oss-security/2020/01/30/4>   ```  [Comment 6](show_bug.cgi?id=1792167#c6)  Petr Matousek    2020-01-30 20:37:20 UTC  ``` Created kernel tracking bugs for this issue:  Affects: fedora-all [[bug 1796650](show_bug.cgi?id=1796650 "CLOSED ERRATA - CVE-2019-3016 kernel: kvm: Information leak within a KVM guest [fedora-all]")]   ```  [Comment 8](show_bug.cgi?id=1792167#c8)  Justin M. Forbes    2020-03-20 15:38:55 UTC  ``` This issue was fixed for Fedora with the 5.4.19 stable kernel updates.   ```  [Comment 10](show_bug.cgi?id=1792167#c10)  errata-xmlrpc    2020-07-21 11:04:45 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2020:3010 [https://access.redhat.com/errata/RHSA-2020:3010](https://access.redhat.com/errata/RHSA-2020%3A3010)   ```  [Comment 11](show_bug.cgi?id=1792167#c11)  errata-xmlrpc    2020-07-21 11:23:03 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2020:3016 [https://access.redhat.com/errata/RHSA-2020:3016](https://access.redhat.com/errata/RHSA-2020%3A3016)   ```  [Comment 12](show_bug.cgi?id=1792167#c12)  Product Security DevOps Team    2020-07-21 13:27:47 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2019-3016>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1792167&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from security.netapp.com_7d6e7676_20250110_194049.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [February 2020 Linux Kernel Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20200313-0003)

## February 2020 Linux Kernel Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20200313-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20200313-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20200313-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20200313-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20200313-0003
**Version:**
25.0

**Last updated:**
05/27/2022

**Status:**
Final.

**CVEs:** CVE-2019-20422, CVE-2019-3016, CVE-2020-8428, CVE-2020-8992, CVE-2020-9383, CVE-2020-9391

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel versions through 5.5.6 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-20422](https://nvd.nist.gov/vuln/detail/CVE-2019-20422) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-3016](https://nvd.nist.gov/vuln/detail/CVE-2019-3016) | 4.7 (MEDIUM) | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2020-8428](https://nvd.nist.gov/vuln/detail/CVE-2020-8428) | 7.1 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H |
| [CVE-2020-8992](https://nvd.nist.gov/vuln/detail/CVE-2020-8992) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2020-9383](https://nvd.nist.gov/vuln/detail/CVE-2020-9383) | 7.1 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H |
| [CVE-2020-9391](https://nvd.nist.gov/vuln/detail/CVE-2020-9391) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* Active IQ Unified Manager for VMware vSphere
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Data Availability Services
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire Baseboard Management Controller (BMC)
* NetApp SteelStore Cloud Integrated Storage

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ mobile app
* Astra Trident
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element HealthTools
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SAS Firmware
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapManager for Hyper-V
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 9.7 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2884466.html) for more information. |
| **Active IQ Unified Manager for VMware vSphere** | <https://mysupport.netapp.com/site/products/all/details/activeiq-unified-manager/downloads-tab/download/62791/9.7P1/downloads> <https://mysupport.netapp.com/site/products/all/details/activeiq-unified-manager/about-tab/download/62791/9.7P1> |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.5> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.10> |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |
| **NetApp Data Availability Services** | NetApp Data Availability Services has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2870808.html) for more information. |
| **NetApp SolidFire Baseboard Management Controller (BMC)** | NetApp SolidFire Baseboard Management Controller (BMC) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2847476.html%20) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20200313-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20200313 | Initial Public Release |
| 2.0 | 20200316 | E-Series SANtricity OS Controller Baseboard Management Controller (BMC) - EF600A moved to Products Not Affected |
| 3.0 | 20200319 | NetApp VASA Provider for Clustered Data ONTAP 7.2 and above, Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above, and Virtual Storage Console for VMware vSphere 7.2 and above moved to Products Not Affected |
| 4.0 | 20200320 | Cloud Volumes ONTAP Mediator moved to Products Not Affected |
| 5.0 | 20200324 | NetApp HCI Compute Nodes moved to Products Not Affected |
| 6.0 | 20200327 | Element Software Management Node, Element Software (formerly SolidFire Element OS), NetApp HCI Compute Nodes moved to Affected Products and NetApp HCI Storage Nodes moved to Products Not Affected |
| 7.0 | 20200330 | After additional review Element Software (formerly SolidFire Element OS) moved from Affected Products to Products Not Affected |
| 8.0 | 20200423 | Host Utilities - SAN for Linux moved to Products Not Affected |
| 9.0 | 20200424 | Host Utilities - SAN for Unix moved to Products Not Affected |
| 10.0 | 20200507 | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved to Products Not Affected |
| 11.0 | 20200515 | AFF Baseboard Management Controller (BMC) - A700s moved to Products Not Affected |
| 12.0 | 20200519 | Service Processor moved to Products Not Affected |
| 13.0 | 20200522 | FAS/AFF Baseboard Management Controller (BMC) moved to Products Not Affected |
| 14.0 | 20200618 | Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above added to Software Versions and Fixes |
| 15.0 | 20200722 | Brocade Fabric Operating System Firmware moved to Products Not Affected |
| 16.0 | 20200724 | NetApp Data Availability Services moved to Won't Fix status |
| 17.0 | 20200730 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Affected Products |
| 18.0 | 20200807 | After additional review NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved from Products Not Affected to Affected Products |
| 19.0 | 20200821 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Products Not Affected |
| 20.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 21.0 | 20210105 | After additional review NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved from Affected Products to Products Not Affected |
| 22.0 | 20211012 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Won't Fix status |
| 23.0 | 20211101 | NetApp SolidFire Baseboard Management Controller (BMC) moved to Won't Fix status |
| 24.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status |
| 25.0 | 20220527 | NetApp SolidFire & HCI Management Node added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from git.kernel.org_601a831d_20250110_194048.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Boris Ostrovsky <boris.ostrovsky@oracle.com> | 2019-12-06 15:36:12 +0000 |
| --- | --- | --- |
| committer | Paolo Bonzini <pbonzini@redhat.com> | 2020-01-30 18:45:55 +0100 |
| commit | [a6bd811f1209fe1c64c9f6fd578101d6436c6b6e](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)) | |
| tree | [a03422951a08c65df3fc51e92d9e02b8c396b9bc](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e) | |
| parent | [b043138246a41064527cf019a3d51d9f015e9796](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b043138246a41064527cf019a3d51d9f015e9796) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e&id2=b043138246a41064527cf019a3d51d9f015e9796)) | |
| download | [linux-a6bd811f1209fe1c64c9f6fd578101d6436c6b6e.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-a6bd811f1209fe1c64c9f6fd578101d6436c6b6e.tar.gz) | |

x86/KVM: Clean up host's steal time structureNow that we are mapping kvm\_steal\_time from the guest directly we
don't need keep a copy of it in kvm\_vcpu\_arch.st. The same is true
for the stime field.
This is part of CVE-2019-3016.
Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)

| -rw-r--r-- | [arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/include/asm/kvm_host.h?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/kvm/x86.c?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 4 insertions, 10 deletions

| diff --git a/arch/x86/include/asm/kvm\_host.h b/arch/x86/include/asm/kvm\_host.hindex f48a306e1d665a..4925bdbfb51604 100644--- a/[arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=b043138246a41064527cf019a3d51d9f015e9796)+++ b/[arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)@@ -685,10 +685,9 @@ struct kvm\_vcpu\_arch { bool pvclock\_set\_guest\_stopped\_request;  struct {+ u8 preempted; u64 msr\_val; u64 last\_steal;- struct gfn\_to\_hva\_cache stime;- struct kvm\_steal\_time steal; struct gfn\_to\_pfn\_cache cache; } st; diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.cindex f1845df7e7c324..a0381ec905cee1 100644--- a/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=b043138246a41064527cf019a3d51d9f015e9796)+++ b/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=a6bd811f1209fe1c64c9f6fd578101d6436c6b6e)@@ -2604,7 +2604,7 @@ static void record\_steal\_time(struct kvm\_vcpu \*vcpu) if (xchg(&st->preempted, 0) & KVM\_VCPU\_FLUSH\_TLB) kvm\_vcpu\_flush\_tlb(vcpu, false); - vcpu->arch.st.steal.preempted = 0;+ vcpu->arch.st.preempted = 0;  if (st->version & 1) st->version += 1; /\* first time write, random junk \*/@@ -2788,11 +2788,6 @@ int kvm\_set\_msr\_common(struct kvm\_vcpu \*vcpu, struct msr\_data \*msr\_info) if (data & KVM\_STEAL\_RESERVED\_MASK) return 1; - if (kvm\_gfn\_to\_hva\_cache\_init(vcpu->kvm, &vcpu->arch.st.stime,- data & KVM\_STEAL\_VALID\_BITS,- sizeof(struct kvm\_steal\_time)))- return 1;- vcpu->arch.st.msr\_val = data;  if (!(data & KVM\_MSR\_ENABLED))@@ -3509,7 +3504,7 @@ static void kvm\_steal\_time\_set\_preempted(struct kvm\_vcpu \*vcpu) if (!(vcpu->arch.st.msr\_val & KVM\_MSR\_ENABLED)) return; - if (vcpu->arch.st.steal.preempted)+ if (vcpu->arch.st.preempted) return;  if (kvm\_map\_gfn(vcpu, vcpu->arch.st.msr\_val >> PAGE\_SHIFT, &map,@@ -3519,7 +3514,7 @@ static void kvm\_steal\_time\_set\_preempted(struct kvm\_vcpu \*vcpu) st = map.hva + offset\_in\_page(vcpu->arch.st.msr\_val & KVM\_STEAL\_VALID\_BITS); - st->preempted = vcpu->arch.st.steal.preempted = KVM\_VCPU\_PREEMPTED;+ st->preempted = vcpu->arch.st.preempted = KVM\_VCPU\_PREEMPTED;  kvm\_unmap\_gfn(vcpu, &map, &vcpu->arch.st.cache, true, true); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:39:25 +0000



=== Content from www.debian.org_bc792128_20250110_194050.html ===


---

[[Date Prev](msg00102.html)][[Date Next](msg00104.html)]
[[Thread Prev](msg00102.html)][[Thread Next](msg00104.html)]
[[Date Index](maillist.html#00103)]
[[Thread Index](threads.html#00103)]

# [SECURITY] [DSA 4699-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4699-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 09 Jun 2020 19:44:24 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1jikAa-0001Hz-Cs%40seger.debian.org) [E1jikAa-0001Hz-Cs@seger.debian.org](msg00103.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4699-1                   security@debian.org
<https://www.debian.org/security/>                            Ben Hutchings
June 09, 2020                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2019-3016 CVE-2019-19462 CVE-2020-0543 CVE-2020-10711
                 CVE-2020-10732 CVE-2020-10751 CVE-2020-10757 CVE-2020-12114
                 CVE-2020-12464 CVE-2020-12768 CVE-2020-12770 CVE-2020-13143
Debian Bug     : 960271

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2019-3016

    It was discovered that the KVM implementation for x86 did not
    always perform TLB flushes when needed, if the paravirtualised
    TLB flush feature was enabled.  This could lead to disclosure of
    sensitive information within a guest VM.

CVE-2019-19462

    The syzkaller tool found a missing error check in the 'relay'
    library used to implement various files under debugfs.  A local
    user permitted to access debugfs could use this to cause a denial
    of service (crash) or possibly for privilege escalation.

CVE-2020-0543

    Researchers at VU Amsterdam discovered that on some Intel CPUs
    supporting the RDRAND and RDSEED instructions, part of a random
    value generated by these instructions may be used in a later
    speculative execution on any core of the same physical CPU.
    Depending on how these instructions are used by applications, a
    local user or VM guest could use this to obtain sensitive
    information such as cryptographic keys from other users or VMs.

    This vulnerability can be mitigated by a microcode update, either
    as part of system firmware (BIOS) or through the intel-microcode
    package in Debian's non-free archive section.  This kernel update
    only provides reporting of the vulnerability and the option to
    disable the mitigation if it is not needed.

CVE-2020-10711

    Matthew Sheets reported NULL pointer dereference issues in the
    SELinux subsystem while receiving CIPSO packet with null category. A
    remote attacker can take advantage of this flaw to cause a denial of
    service (crash). Note that this issue does not affect the binary
    packages distributed in Debian as CONFIG_NETLABEL is not enabled.

CVE-2020-10732

    An information leak of kernel private memory to userspace was found
    in the kernel's implementation of core dumping userspace processes.

CVE-2020-10751

    Dmitry Vyukov reported that the SELinux subsystem did not properly
    handle validating multiple messages, which could allow a privileged
    attacker to bypass SELinux netlink restrictions.

CVE-2020-10757

    Fan Yang reported a flaw in the way mremap handled DAX hugepages,
    allowing a local user to escalate their privileges.

CVE-2020-12114

    Piotr Krysiuk discovered a race condition between the umount and
    pivot_root operations in the filesystem core (vfs).  A local user
    with the CAP_SYS_ADMIN capability in any user namespace could use
    this to cause a denial of service (crash).

CVE-2020-12464

    Kyungtae Kim reported a race condition in the USB core that can
    result in a use-after-free.  It is not clear how this can be
    exploited, but it could result in a denial of service (crash or
    memory corruption) or privilege escalation.

CVE-2020-12768

    A bug was discovered in the KVM implementation for AMD processors,
    which could result in a memory leak.  The security impact of this
    is unclear.

CVE-2020-12770

    It was discovered that the sg (SCSI generic) driver did not
    correctly release internal resources in a particular error case.
    A local user permitted to access an sg device could possibly use
    this to cause a denial of service (resource exhaustion).

CVE-2020-13143

    Kyungtae Kim reported a potential heap out-of-bounds write in
    the USB gadget subsystem.  A local user permitted to write to
    the gadget configuration filesystem could use this to cause a
    denial of service (crash or memory corruption) or potentially
    for privilege escalation.

For the stable distribution (buster), these problems have been fixed
in version 4.19.118-2+deb10u1.  This version also fixes some related
bugs that do not have their own CVE IDs, and a regression in the
<linux/swab.h> UAPI header introduced in the previous point release
(bug #960271).

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAl7f5cVfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Q2Gg//b/hL9fW9Js1PYDU/VtS6r5Cca5xsCYlbAheAlMPMtm/Vym4NJOuEvyuI
DvPXbf0Bi7gjQ0gEgM/urJTzqjzIccwrUQe1aFHt0N9exC53z1xPWZDJepGkSQOB
2AB5YaFTxkuGur/HXbKomdMWvSVphpBM+id9v2V1iWY2iA6cI1sCjgziUKcDMECD
T7tCe4Hrjf6BY/W4xBiT0BEQNOO2i/rn7p9pNk+wi85BbC7g5ubKWGn9sSDd8KtA
u2z5tsicaM7kXaPsaW11fSPxu7YOz09qLgBQnY8B2gdMEAp3YjN9ibyHppjme3GK
02ZZUHQ+Y4MyQQgCzWxaqXCu6Aa+4B5i2nTY907BVBslrfulKRbr1qS3D2CJojT/
qYVub7C5RCW5VnbJZxCDLgSmGRbyPW2pVpnBTvID8czTUhd+M5e6fW932TzUW07w
18ueto1fRlcAauIO3SQV7Ai9froFGjH4L8XbUipiv0qwotSjcPb4HoZpp0xgNcRU
xjZW0MMhK/lyfe8gDx8wjpihbQVKtTtIaWbeoZPoMENE92yW8+7DbXjfXAylX3px
IdVaeo7iF3MOYuez4qEAsyPF4ver8Xl9HKS05J9NUYUeRf2BF3M6xFWjpTm5xjoH
bdIGBJ322sNjTAzkneriX5iO3szBDINPHII2V/AaqafhYZYWtoM=
=c00Y
-----END PGP SIGNATURE-----

```

---



=== Content from git.kernel.org_258781f9_20250110_194048.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Boris Ostrovsky <boris.ostrovsky@oracle.com> | 2019-12-05 01:30:51 +0000 |
| --- | --- | --- |
| committer | Paolo Bonzini <pbonzini@redhat.com> | 2020-01-30 18:45:55 +0100 |
| commit | [917248144db5d7320655dbb41d3af0b8a0f3d589](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=917248144db5d7320655dbb41d3af0b8a0f3d589) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)) | |
| tree | [4c865f9aeb61137847ce9d283bc33febded17714](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | |
| parent | [1eff70a9abd46f175defafd29bc17ad456f398a7](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1eff70a9abd46f175defafd29bc17ad456f398a7) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=917248144db5d7320655dbb41d3af0b8a0f3d589&id2=1eff70a9abd46f175defafd29bc17ad456f398a7)) | |
| download | [linux-917248144db5d7320655dbb41d3af0b8a0f3d589.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-917248144db5d7320655dbb41d3af0b8a0f3d589.tar.gz) | |

x86/kvm: Cache gfn to pfn translation\_\_kvm\_map\_gfn()'s call to gfn\_to\_pfn\_memslot() is
\* relatively expensive
\* in certain cases (such as when done from atomic context) cannot be called
Stashing gfn-to-pfn mapping should help with both cases.
This is part of CVE-2019-3016.
Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=917248144db5d7320655dbb41d3af0b8a0f3d589)

| -rw-r--r-- | [arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/include/asm/kvm_host.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/arch/x86/kvm/x86.c?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | 10 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/linux/kvm_host.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | 7 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [include/linux/kvm\_types.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/linux/kvm_types.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | 9 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/virt/kvm/kvm_main.c?id=917248144db5d7320655dbb41d3af0b8a0f3d589) | 98 | |  |  |  | | --- | --- | --- | |

5 files changed, 103 insertions, 22 deletions

| diff --git a/arch/x86/include/asm/kvm\_host.h b/arch/x86/include/asm/kvm\_host.hindex b79cd6aa407563..f48a306e1d665a 100644--- a/[arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=1eff70a9abd46f175defafd29bc17ad456f398a7)+++ b/[arch/x86/include/asm/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/kvm_host.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589)@@ -689,6 +689,7 @@ struct kvm\_vcpu\_arch { u64 last\_steal; struct gfn\_to\_hva\_cache stime; struct kvm\_steal\_time steal;+ struct gfn\_to\_pfn\_cache cache; } st;  u64 tsc\_offset;diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.cindex 8c9369151e9f3f..0795bc876abcca 100644--- a/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=1eff70a9abd46f175defafd29bc17ad456f398a7)+++ b/[arch/x86/kvm/x86.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kvm/x86.c?id=917248144db5d7320655dbb41d3af0b8a0f3d589)@@ -9088,6 +9088,9 @@ static void fx\_init(struct kvm\_vcpu \*vcpu) void kvm\_arch\_vcpu\_free(struct kvm\_vcpu \*vcpu) { void \*wbinvd\_dirty\_mask = vcpu->arch.wbinvd\_dirty\_mask;+ struct gfn\_to\_pfn\_cache \*cache = &vcpu->arch.st.cache;++ kvm\_release\_pfn(cache->pfn, cache->dirty, cache);  kvmclock\_reset(vcpu); @@ -9761,11 +9764,18 @@ out\_free:  void kvm\_arch\_memslots\_updated(struct kvm \*kvm, u64 gen) {+ struct kvm\_vcpu \*vcpu;+ int i;+ /\* \* memslots->generation has been incremented. \* mmio generation may have reached its maximum value. \*/ kvm\_mmu\_invalidate\_mmio\_sptes(kvm, gen);++ /\* Force re-initialization of steal\_time cache \*/+ kvm\_for\_each\_vcpu(i, vcpu, kvm)+ kvm\_vcpu\_kick(vcpu); }  int kvm\_arch\_prepare\_memory\_region(struct kvm \*kvm,diff --git a/include/linux/kvm\_host.h b/include/linux/kvm\_host.hindex 0cb78f55b92c93..71cb9cc105f0a5 100644--- a/[include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_host.h?id=1eff70a9abd46f175defafd29bc17ad456f398a7)+++ b/[include/linux/kvm\_host.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_host.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589)@@ -723,6 +723,7 @@ void kvm\_set\_pfn\_dirty(kvm\_pfn\_t pfn); void kvm\_set\_pfn\_accessed(kvm\_pfn\_t pfn); void kvm\_get\_pfn(kvm\_pfn\_t pfn); +void kvm\_release\_pfn(kvm\_pfn\_t pfn, bool dirty, struct gfn\_to\_pfn\_cache \*cache); int kvm\_read\_guest\_page(struct kvm \*kvm, gfn\_t gfn, void \*data, int offset, int len); int kvm\_read\_guest\_atomic(struct kvm \*kvm, gpa\_t gpa, void \*data,@@ -775,10 +776,12 @@ struct kvm\_memory\_slot \*kvm\_vcpu\_gfn\_to\_memslot(struct kvm\_vcpu \*vcpu, gfn\_t gfn kvm\_pfn\_t kvm\_vcpu\_gfn\_to\_pfn\_atomic(struct kvm\_vcpu \*vcpu, gfn\_t gfn); kvm\_pfn\_t kvm\_vcpu\_gfn\_to\_pfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn); int kvm\_vcpu\_map(struct kvm\_vcpu \*vcpu, gpa\_t gpa, struct kvm\_host\_map \*map);-int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map);+int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map,+ struct gfn\_to\_pfn\_cache \*cache, bool atomic); struct page \*kvm\_vcpu\_gfn\_to\_page(struct kvm\_vcpu \*vcpu, gfn\_t gfn); void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty);-int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty);+int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map,+ struct gfn\_to\_pfn\_cache \*cache, bool dirty, bool atomic); unsigned long kvm\_vcpu\_gfn\_to\_hva(struct kvm\_vcpu \*vcpu, gfn\_t gfn); unsigned long kvm\_vcpu\_gfn\_to\_hva\_prot(struct kvm\_vcpu \*vcpu, gfn\_t gfn, bool \*writable); int kvm\_vcpu\_read\_guest\_page(struct kvm\_vcpu \*vcpu, gfn\_t gfn, void \*data, int offset,diff --git a/include/linux/kvm\_types.h b/include/linux/kvm\_types.hindex 1c88e69db3d9dc..68e84cf42a3f94 100644--- a/[include/linux/kvm\_types.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_types.h?id=1eff70a9abd46f175defafd29bc17ad456f398a7)+++ b/[include/linux/kvm\_types.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/kvm_types.h?id=917248144db5d7320655dbb41d3af0b8a0f3d589)@@ -18,7 +18,7 @@ struct kvm\_memslots;  enum kvm\_mr\_change; -#include <asm/types.h>+#include <linux/types.h>  /\* \* Address types:@@ -51,4 +51,11 @@ struct gfn\_to\_hva\_cache { struct kvm\_memory\_slot \*memslot; }; +struct gfn\_to\_pfn\_cache {+ u64 generation;+ gfn\_t gfn;+ kvm\_pfn\_t pfn;+ bool dirty;+};+ #endif /\* \_\_KVM\_TYPES\_H\_\_ \*/diff --git a/virt/kvm/kvm\_main.c b/virt/kvm/kvm\_main.cindex 9ef58a233a7c38..67eb302a7240ac 100644--- a/[virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/virt/kvm/kvm_main.c?id=1eff70a9abd46f175defafd29bc17ad456f398a7)+++ b/[virt/kvm/kvm\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/virt/kvm/kvm_main.c?id=917248144db5d7320655dbb41d3af0b8a0f3d589)@@ -1821,27 +1821,72 @@ struct page \*gfn\_to\_page(struct kvm \*kvm, gfn\_t gfn) } EXPORT\_SYMBOL\_GPL(gfn\_to\_page); +void kvm\_release\_pfn(kvm\_pfn\_t pfn, bool dirty, struct gfn\_to\_pfn\_cache \*cache)+{+ if (pfn == 0)+ return;++ if (cache)+ cache->pfn = cache->gfn = 0;++ if (dirty)+ kvm\_release\_pfn\_dirty(pfn);+ else+ kvm\_release\_pfn\_clean(pfn);+}++static void kvm\_cache\_gfn\_to\_pfn(struct kvm\_memory\_slot \*slot, gfn\_t gfn,+ struct gfn\_to\_pfn\_cache \*cache, u64 gen)+{+ kvm\_release\_pfn(cache->pfn, cache->dirty, cache);++ cache->pfn = gfn\_to\_pfn\_memslot(slot, gfn);+ cache->gfn = gfn;+ cache->dirty = false;+ cache->generation = gen;+}+ static int \_\_kvm\_map\_gfn(struct kvm\_memslots \*slots, gfn\_t gfn,- struct kvm\_host\_map \*map)+ struct kvm\_host\_map \*map,+ struct gfn\_to\_pfn\_cache \*cache,+ bool atomic) { kvm\_pfn\_t pfn; void \*hva = NULL; struct page \*page = KVM\_UNMAPPED\_PAGE; struct kvm\_memory\_slot \*slot = \_\_gfn\_to\_memslot(slots, gfn);+ u64 gen = slots->generation;  if (!map) return -EINVAL; - pfn = gfn\_to\_pfn\_memslot(slot, gfn);+ if (cache) {+ if (!cache->pfn || cache->gfn != gfn ||+ cache->generation != gen) {+ if (atomic)+ return -EAGAIN;+ kvm\_cache\_gfn\_to\_pfn(slot, gfn, cache, gen);+ }+ pfn = cache->pfn;+ } else {+ if (atomic)+ return -EAGAIN;+ pfn = gfn\_to\_pfn\_memslot(slot, gfn);+ } if (is\_error\_noslot\_pfn(pfn)) return -EINVAL;  if (pfn\_valid(pfn)) { page = pfn\_to\_page(pfn);- hva = kmap(page);+ if (atomic)+ hva = kmap\_atomic(page);+ else+ hva = kmap(page); #ifdef CONFIG\_HAS\_IOMEM- } else {+ } else if (!atomic) { hva = memremap(pfn\_to\_hpa(pfn), PAGE\_SIZE, MEMREMAP\_WB);+ } else {+ return -EINVAL; #endif } @@ -1856,20 +1901,25 @@ static int \_\_kvm\_map\_gfn(struct kvm\_memslots \*slots, gfn\_t gfn, return 0; } -int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map)+int kvm\_map\_gfn(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map,+ struct gfn\_to\_pfn\_cache \*cache, bool atomic) {- return \_\_kvm\_map\_gfn(kvm\_memslots(vcpu->kvm), gfn, map);+ return \_\_kvm\_map\_gfn(kvm\_memslots(vcpu->kvm), gfn, map,+ cache, atomic); } EXPORT\_SYMBOL\_GPL(kvm\_map\_gfn);  int kvm\_vcpu\_map(struct kvm\_vcpu \*vcpu, gfn\_t gfn, struct kvm\_host\_map \*map) {- return \_\_kvm\_map\_gfn(kvm\_vcpu\_memslots(vcpu), gfn, map);+ return \_\_kvm\_map\_gfn(kvm\_vcpu\_memslots(vcpu), gfn, map,+ NULL, false); } EXPORT\_SYMBOL\_GPL(kvm\_vcpu\_map);  static void \_\_kvm\_unmap\_gfn(struct kvm\_memory\_slot \*memslot,- struct kvm\_host\_map \*map, bool dirty)+ struct kvm\_host\_map \*map,+ struct gfn\_to\_pfn\_cache \*cache,+ bool dirty, bool atomic) { if (!map) return;@@ -1877,34 +1927,44 @@ static void \_\_kvm\_unmap\_gfn(struct kvm\_memory\_slot \*memslot, if (!map->hva) return; - if (map->page != KVM\_UNMAPPED\_PAGE)- kunmap(map->page);+ if (map->page != KVM\_UNMAPPED\_PAGE) {+ if (atomic)+ kunmap\_atomic(map->hva);+ else+ kunmap(map->page);+ } #ifdef CONFIG\_HAS\_IOMEM- else+ else if (!atomic) memunmap(map->hva);+ else+ WARN\_ONCE(1, "Unexpected unmapping in atomic context"); #endif - if (dirty) {+ if (dirty) mark\_page\_dirty\_in\_slot(memslot, map->gfn);- kvm\_release\_pfn\_dirty(map->pfn);- } else {- kvm\_release\_pfn\_clean(map->pfn);- }++ if (cache)+ cache->dirty |= dirty;+ else+ kvm\_release\_pfn(map->pfn, dirty, NULL);  map->hva = NULL; map->page = NULL; } -int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty)+int kvm\_unmap\_gfn(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, + struct gfn\_to\_pfn\_cache \*cache, bool dirty, bool atomic) {- \_\_kvm\_unmap\_gfn(gfn\_to\_memslot(vcpu->kvm, map->gfn), map, dirty);+ \_\_kvm\_unmap\_gfn(gfn\_to\_memslot(vcpu->kvm, map->gfn), map,+ cache, dirty, atomic); return 0; } EXPORT\_SYMBOL\_GPL(kvm\_unmap\_gfn);  void kvm\_vcpu\_unmap(struct kvm\_vcpu \*vcpu, struct kvm\_host\_map \*map, bool dirty) {- \_\_kvm\_unmap\_gfn(kvm\_vcpu\_gfn\_to\_memslot(vcpu, map->gfn), map, dirty);+ \_\_kvm\_unmap\_gfn(kvm\_vcpu\_gfn\_to\_memslot(vcpu, map->gfn), map, NULL,+ dirty, false); } EXPORT\_SYMBOL\_GPL(kvm\_vcpu\_unmap); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:39:25 +0000



=== Content from usn.ubuntu.com_992897fb_20250110_194050.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4300-1: Linux kernel vulnerabilities

25 March 2020

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.10](/security/notices?release=eoan)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel
* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-azure-5.3](/security/cves?package=linux-azure-5.3) - Linux kernel for Microsoft Azure Cloud systems
* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-gcp-5.3](/security/cves?package=linux-gcp-5.3) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-gke-5.3](/security/cves?package=linux-gke-5.3) - Linux kernel for Google Container Engine (GKE) systems
* [linux-hwe](/security/cves?package=linux-hwe) - Linux hardware enablement (HWE) kernel
* [linux-kvm](/security/cves?package=linux-kvm) - Linux kernel for cloud environments
* [linux-oracle](/security/cves?package=linux-oracle) - Linux kernel for Oracle Cloud systems
* [linux-raspi2](/security/cves?package=linux-raspi2) - Linux kernel for Raspberry Pi 2
* [linux-raspi2-5.3](/security/cves?package=linux-raspi2-5.3) - Linux kernel for Raspberry Pi 2

## Details

It was discovered that the KVM implementation in the Linux kernel, when

paravirtual TLB flushes are enabled in guests, the hypervisor in some

situations could miss deferred TLB flushes or otherwise mishandle them. An

attacker in a guest VM could use this to expose sensitive information (read

memory from another guest VM). ([CVE-2019-3016](/security/CVE-2019-3016))

Paulo Bonzini discovered that the KVM hypervisor implementation in the

Linux kernel could improperly let a nested (level 2) guest access the

resources of a parent (level 1) guest in certain situations. An attacker

could use this to expose sensitive information. ([CVE-2020-2732](/security/CVE-2020-2732))

It was discovered that the Afatech AF9005 DVB-T USB device driver in the

Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-18809](/security/CVE-2019-18809))

It was discovered that the Intel(R) XL710 Ethernet Controller device driver

in the Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-19043](/security/CVE-2019-19043))

It was discovered that the RPMSG character device interface in the Linux

kernel did not properly deallocate memory in certain error conditions. A

local attacker could possibly use this to cause a denial of service (kernel

memory exhaustion). ([CVE-2019-19053](/security/CVE-2019-19053))

It was discovered that the Marvell Wi-Fi device driver in the Linux kernel

did not properly deallocate memory in certain error conditions. A local

attacker could use this to possibly cause a denial of service (kernel

memory exhaustion). ([CVE-2019-19056](/security/CVE-2019-19056))

It was discovered that the Intel(R) Wi-Fi device driver in the Linux kernel

device driver in the Linux kernel did not properly deallocate memory in

certain error conditions. A local attacker could possibly use this to cause

a denial of service (kernel memory exhaustion). ([CVE-2019-19058](/security/CVE-2019-19058),

[CVE-2019-19059](/security/CVE-2019-19059))

It was discovered that the Serial Peripheral Interface (SPI) driver in the

Linux kernel device driver in the Linux kernel did not properly deallocate

memory in certain error conditions. A local attacker could possibly use

this to cause a denial of service (kernel memory exhaustion).

([CVE-2019-19064](/security/CVE-2019-19064))

It was discovered that the Brocade BFA Fibre Channel device driver in the

Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-19066](/security/CVE-2019-19066))

It was discovered that the Realtek RTL8xxx USB Wi-Fi device driver in the

Linux kernel did not properly deallocate memory in certain error

conditions. A local attacker could possibly use this to cause a denial of

service (kernel memory exhaustion). ([CVE-2019-19068](/security/CVE-2019-19068))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.10

* [linux-image-5.3.0-1011-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-oracle)
  -
  [5.3.0-1011.12](https://launchpad.net/ubuntu/%2Bsource/linux-oracle/5.3.0-1011.12)
* [linux-image-5.3.0-1012-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [5.3.0-1012.13](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/5.3.0-1012.13)
* [linux-image-5.3.0-1013-aws](https://launchpad.net/ubuntu/%2Bsource/linux-aws)
  -
  [5.3.0-1013.14](https://launchpad.net/ubuntu/%2Bsource/linux-aws/5.3.0-1013.14)
* [linux-image-5.3.0-1014-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-gcp)
  -
  [5.3.0-1014.15](https://launchpad.net/ubuntu/%2Bsource/linux-gcp/5.3.0-1014.15)
* [linux-image-5.3.0-1016-azure](https://launchpad.net/ubuntu/%2Bsource/linux-azure)
  -
  [5.3.0-1016.17](https://launchpad.net/ubuntu/%2Bsource/linux-azure/5.3.0-1016.17)
* [linux-image-5.3.0-1019-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [5.3.0-1019.21](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/5.3.0-1019.21)
* [linux-image-5.3.0-42-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-42.34](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-42.34)
* [linux-image-5.3.0-42-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-42.34](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-42.34)
* [linux-image-5.3.0-42-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-42.34](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-42.34)
* [linux-image-5.3.0-42-snapdragon](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-42.34](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-42.34)
* linux-image-aws
  -
  5.3.0.1013.15
* linux-image-azure
  -
  5.3.0.1016.35
* linux-image-gcp
  -
  5.3.0.1014.15
* linux-image-generic
  -
  5.3.0.42.36
* linux-image-generic-lpae
  -
  5.3.0.42.36
* linux-image-gke
  -
  5.3.0.1014.15
* linux-image-kvm
  -
  5.3.0.1012.14
* linux-image-lowlatency
  -
  5.3.0.42.36
* linux-image-oracle
  -
  5.3.0.1011.12
* linux-image-raspi2
  -
  5.3.0.1019.16
* linux-image-snapdragon
  -
  5.3.0.42.36
* linux-image-virtual
  -
  5.3.0.42.36

##### Ubuntu 18.04

* [linux-image-5.3.0-1014-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp-5.3)
  -
  [5.3.0-1014.15~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp-5.3/5.3.0-1014.15~18.04.1)
* [linux-image-5.3.0-1014-gke](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.3)
  -
  [5.3.0-1014.15~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.3/5.3.0-1014.15~18.04.1)
* [linux-image-5.3.0-1016-azure](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure-5.3)
  -
  [5.3.0-1016.17~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure-5.3/5.3.0-1016.17~18.04.1)
* [linux-image-5.3.0-1019-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2-5.3)
  -
  [5.3.0-1019.21~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2-5.3/5.3.0-1019.21~18.04.1)
* [linux-image-5.3.0-42-generic](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe)
  -
  [5.3.0-42.34~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe/5.3.0-42.34~18.04.1)
* [linux-image-5.3.0-42-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [5.3.0-42.34~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/5.3.0-42.34~18.04.1)
* [linux-image-5.3.0-42-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe)
  -
  [5.3.0-42.34~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe/5.3.0-42.34~18.04.1)
* [linux-image-azure-edge](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure-5.3)
  -
  [5.3.0.1016.16](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure-5.3/5.3.0.1016.16)
* [linux-image-gcp-edge](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp-5.3)
  -
  [5.3.0.1014.13](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp-5.3/5.3.0.1014.13)
* [linux-image-generic-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [5.3.0.42.99](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/5.3.0.42.99)
* [linux-image-generic-lpae-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [5.3.0.42.99](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/5.3.0.42.99)
* [linux-image-gke-5.3](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.3)
  -
  [5.3.0.1014.4](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.3/5.3.0.1014.4)
* [linux-image-lowlatency-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [5.3.0.42.99](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/5.3.0.42.99)
* [linux-image-raspi2-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi2-5.3)
  -
  [5.3.0.1019.8](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi2-5.3/5.3.0.1019.8)
* [linux-image-snapdragon-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [5.3.0.42.99](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/5.3.0.42.99)
* [linux-image-virtual-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [5.3.0.42.99](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/5.3.0.42.99)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2019-18809](/security/CVE-2019-18809)
* [CVE-2019-19043](/security/CVE-2019-19043)
* [CVE-2019-19053](/security/CVE-2019-19053)
* [CVE-2019-19056](/security/CVE-2019-19056)
* [CVE-2019-19058](/security/CVE-2019-19058)
* [CVE-2019-19059](/security/CVE-2019-19059)
* [CVE-2019-19064](/security/CVE-2019-19064)
* [CVE-2019-19066](/security/CVE-2019-19066)
* [CVE-2019-19068](/security/CVE-2019-19068)
* [CVE-2019-3016](/security/CVE-2019-3016)
* [CVE-2020-2732](/security/CVE-2020-2732)

## Related notices

* [USN-4285-1](/security/notices/USN-4285-1)
* [USN-4287-1](/security/notices/USN-4287-1)
* [USN-4287-2](/security/notices/USN-4287-2)
* [USN-4301-1](/security/notices/USN-4301-1)
* [USN-4286-1](/security/notices/USN-4286-1)
* [USN-4286-2](/security/notices/USN-4286-2)
* [USN-4302-1](/security/notices/USN-4302-1)
* [LSN-0065-1](/security/notices/LSN-0065-1)
* [USN-4303-1](/security/notices/USN-4303-1)
* [USN-4303-2](/security/notices/USN-4303-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


