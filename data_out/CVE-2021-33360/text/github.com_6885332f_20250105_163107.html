
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstoqey%2Fgnuplot%2Fblob%2Fcd76060a15f58348baeef1c5fd867ce856515949%2Fsrc%2Findex.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstoqey%2Fgnuplot%2Fblob%2Fcd76060a15f58348baeef1c5fd867ce856515949%2Fsrc%2Findex.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=stoqey%2Fgnuplot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stoqey](/stoqey)
/
**[gnuplot](/stoqey/gnuplot)**
Public

* [Notifications](/login?return_to=%2Fstoqey%2Fgnuplot) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fstoqey%2Fgnuplot)
* [Star
   1](/login?return_to=%2Fstoqey%2Fgnuplot)

* [Code](/stoqey/gnuplot)
* [Issues
  0](/stoqey/gnuplot/issues)
* [Pull requests
  6](/stoqey/gnuplot/pulls)
* [Actions](/stoqey/gnuplot/actions)
* [Projects
  0](/stoqey/gnuplot/projects)
* [Security](/stoqey/gnuplot/security)
* [Insights](/stoqey/gnuplot/pulse)

Additional navigation options

* [Code](/stoqey/gnuplot)
* [Issues](/stoqey/gnuplot/issues)
* [Pull requests](/stoqey/gnuplot/pulls)
* [Actions](/stoqey/gnuplot/actions)
* [Projects](/stoqey/gnuplot/projects)
* [Security](/stoqey/gnuplot/security)
* [Insights](/stoqey/gnuplot/pulse)

## Files

 cd76060
## Breadcrumbs

1. [gnuplot](/stoqey/gnuplot/tree/cd76060a15f58348baeef1c5fd867ce856515949)
2. /[src](/stoqey/gnuplot/tree/cd76060a15f58348baeef1c5fd867ce856515949/src)
/
# index.ts

 Blame  Blame
## Latest commit

## History

[History](/stoqey/gnuplot/commits/cd76060a15f58348baeef1c5fd867ce856515949/src/index.ts)290 lines (254 loc) · 8.64 KB cd76060
## Breadcrumbs

1. [gnuplot](/stoqey/gnuplot/tree/cd76060a15f58348baeef1c5fd867ce856515949)
2. /[src](/stoqey/gnuplot/tree/cd76060a15f58348baeef1c5fd867ce856515949/src)
/
# index.ts

Top
## File metadata and controls

* Code
* Blame

290 lines (254 loc) · 8.64 KB[Raw](https://github.com/stoqey/gnuplot/raw/cd76060a15f58348baeef1c5fd867ce856515949/src/index.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290/\* @stoqey/gnuplot \* this project is a fork of Richard Meadows's 'node-plotter' \*/
import { exec, ExecException } from 'child\_process';import \_ from 'lodash';import { SetUpOptions, PlotOptions } from './interfaces';
/\* \* Performs a n-point moving average on array. \*/function moving\_average(array: number[], n: number) { var nums: number[] = [];
 Object.keys(array).forEach((i: any) => { /\* If this item in the array is a number \*/ if (\_.isNumber(array[i])) { nums.push(array[i]); if (nums.length > n) { nums.splice(0, 1); /\* Remove the first element of the array \*/ } /\* Take the average of the n items in this array \*/ var sum = \_.reduce(nums, function (memo: number, num: number) { return memo + num; }, 0); array[i] = sum / nums.length; } });
 return array;}/\*\* \* Performs a n-point maximum on array. \*/function moving\_maximum(array: number[], n: number) { var nums: number[] = [];
 Object.keys(array).forEach(function (i: any) { /\* If this item in the array is a number \*/ if (\_.isNumber(array[i])) { nums.push(array[i]); if (nums.length > n) { nums.splice(0, 1); /\* Remove the first element of the array \*/ } /\* Take the average of the n items in this array \*/ var sum = \_.reduce(nums, function (memo: any, num: any) { return memo + num; }, 0); array[i] = sum / nums.length; } });
 return array;}/\*\* \* Applys an n-point moving filter to a set of series. \*/function apply\_moving\_filter(set: { [x: string]: any; }, filter: { (array: number[], n: number): number[]; (array: number[], n: number): number[]; (arg0: any, arg1: any): any; }, n: number) { if (!\_.isNumber(n)) { n = 3; }
 Object.keys(set).forEach(function (series) { /\* Apply the filter \*/ set[series] = filter(set[series], n); });
 return set;}/\*\* \* Returns the string to give to gnuplot based on the value of options.time. \*/function time\_format(time: any) { if (\_.isString(time)) { /\* Translate the string we've been given into a format \*/ switch (time) { case 'days': case 'Days': return '%d/%m'; case 'hours': case 'Hours': return '%H:%M'; default: /\* Presume we've been given a gnuplot-readable time format string \*/ return time; } } else { /\* Just default to hours \*/ return '%H:%M'; }}/\*\* \* Sets up gnuplot based on the properties we're given in the options object. \*/function setup\_gnuplot(gnuplot: { stdin: { write: (arg0: string) => void; }; }, options: PlotOptions) { if (options.format === 'svg') { /\* Setup gnuplot for SVG \*/ // gnuplot.stdin.write(`set term svg fname "${options.font || 'system-ui'}" fsize ${options.fontSize || 13}\n`); } else if (options.format == 'pdf') { /\* PDF: setup Gnuplot output to postscript so ps2pdf can interpret it \*/ gnuplot.stdin.write(`set term postscript landscape enhanced color dashed "${options.font || 'Arial'}" fsize ${options.fontSize || 14}\n`); } else { /\* Setup gnuplot for png \*/ gnuplot.stdin.write(`set term png size ${options.width || 800},${options.height || 640} font "${options.font || 'Arial'}, ${options.fontSize || 13}"\n`); }
 if (options && options.args) { const args = options.args || []; args.forEach(a => gnuplot.stdin.write(`${a}\n`)) }
 /\* Locale config \*/ if (options.locale) { gnuplot.stdin.write(`set locale '${options.locale}'\n`); }
 /\* Data range config \*/ if (options.xRange) { gnuplot.stdin.write(`set xrange ['${options.xRange.min}':'${options.xRange.max}']\n`); }
 if (options.yRange) { gnuplot.stdin.write(`set yrange ['${options.yRange.min}':'${options.yRange.max}']\n`); }
 /\* Margin config \*/ if (options.margin) { gnuplot.stdin.write(`set lmargin ${options.margin.left}\n`); gnuplot.stdin.write(`set rmargin ${options.margin.right}\n`); gnuplot.stdin.write(`set tmargin ${options.margin.top}\n`); gnuplot.stdin.write(`set bmargin ${options.margin.bottom}\n`); }
 /\* Formatting Options \*/ if (options.time) { gnuplot.stdin.write('set xdata time\n'); gnuplot.stdin.write('set timefmt "%s"\n'); gnuplot.stdin.write(`set format x "${time\_format(options.time)}"\n`); gnuplot.stdin.write('set xlabel ""\n'); } if (options.title) { gnuplot.stdin.write(`set title "${options.title}" font "${options.font || 'Helvetica'}, ${options.titleSize || 13}"\n`); } if (options.logscale) { gnuplot.stdin.write('set logscale y\n'); } if (options.xlabel) { gnuplot.stdin.write(`set xlabel "${options.xlabel}"\n`); } if (options.ylabel) { gnuplot.stdin.write(`set ylabel "${options.ylabel}"\n`); } if (options.decimalsign) { gnuplot.stdin.write(`set decimalsign '${options.decimalsign}'\n`); } if (options.xRotate) { gnuplot.stdin.write(`set xtics rotate by ${options.xRotate.value} offset ${options.xRotate.xOffset},${options.xRotate.yOffset}\n`); } if (options.yFormat) { gnuplot.stdin.write(`set format y '${options.yFormat}'\n`); }
 /\* Setup ticks \*/ // gnuplot.stdin.write('set grid xtics ytics mxtics\n'); // gnuplot.stdin.write('set mxtics\n');
 if (options.nokey) { gnuplot.stdin.write('set nokey\n'); }}/\*\* \* Called after Gnuplot has finished. \*/function post\_gnuplot\_processing(error: ExecException | null, stdout: string | Buffer, stderr: string | Buffer) { /\* Print stuff \*/ console.log('stdout: ' + stdout); console.log('stderr: ' + stderr); if (error !== null) { console.log('exec error: ' + error); }}
/\* -------- Public Functions -------- \*/
/\*\* \* Plots data to a PDF file. If it does not exist, the PDF file will \* be created, otherwise this plot will be appended as a new page. \*/function plotCallack(options: PlotOptions) { /\* Required Options \*/ if (!options.data || !options.filename) { throw new Error('The options object must have \'data\' and \'filename\' properties!'); } /\* Translate data into an object if needs be \*/ if (\_.isArray(options.data)) { /\* If it's a one-dimentional array \*/ if (\_.isEqual(\_.flatten(options.data), options.data)) { options.data = { 'Series 1': options.data }; } }
 /\* Defaults \*/ if (!options.style) { options.style = 'lines'; /\* Default to lines \*/ }
 /\* Apply moving averages and maximums \*/ if (options.moving\_avg) { options.data = apply\_moving\_filter(options.data, moving\_average, options.moving\_avg); } if (options.moving\_max) { options.data = apply\_moving\_filter(options.data, moving\_maximum, options.moving\_max); }
 /\* Execute Gnuplot specifing a function to be called when it terminates \*/ var gnuplot: { stdin: any; };
 const filePath = options.filename;
 exec(`touch ${filePath}`);
 if (options.format === 'pdf') { /\* Special setup for pdf \*/ gnuplot = exec(`gnuplot | ps2pdf - ${filePath}`, (options.exec ? options.exec : {}), options.finish || post\_gnuplot\_processing); } else { /\* Default for everything else \*/ gnuplot = exec(`gnuplot > ${filePath}`, (options.exec ? options.exec : {}), options.finish || post\_gnuplot\_processing); }
 /\* Sets up gnuplot based on the properties we've been given in the \* options object \*/ setup\_gnuplot(gnuplot, options);
 /\* Get an array containing all the series \*/ var series = \_.keys(options.data); /\* Reject series that are functions or come from higher up the protoype chain \*/ for (var i = 0; i < series.length; i += 1) { if (!options.data.hasOwnProperty(series[i]) || typeof options.data[series[i]] === 'function') { delete series[i]; /\* undefine this element \*/ } } /\* Filter out any undefined elements \*/ series = \_.filter(series, function () { return true; });
 /\* Print the command to actually do the plot \*/ gnuplot.stdin.write('plot'); for (var i = 1; i <= series.length; i += 1) { /\* For each series \*/ /\* Instruct gnuplot to plot this series \*/ var s = `\'-\' using 1:2 with ${options.style}`;
 if (!options.hideSeriesTitle) { s += ` title\' ${series[i - 1]} \'`; } else { s += ' notitle'; }
 gnuplot.stdin.write(s); /\* If another series is to follow, add a comma \*/ if (i < series.length) { gnuplot.stdin.write(','); } } gnuplot.stdin.write('\n');
 /\* Print out the data \*/ for (var i = 0; i < series.length; i += 1) { /\* For each series \*/ Object.keys(options.data[series[i]]).forEach(function (key) { gnuplot.stdin.write(key + ' ' + options.data[series[i]][key] + '\n'); });
 /\* Terminate the data \*/ gnuplot.stdin.write('e\n'); }
 gnuplot.stdin.end();}
/\*\* \* Plots data to a PDF file. If it does not exist, the PDF file will \* be created, otherwise this plot will be appended as a new page. \*/export function plot(options: PlotOptions): Promise<boolean> | void { if (options.finish) { return plotCallack(options); }
 // Promise return new Promise((resolve, reject) => { plotCallack({ ...options, finish: (error) => { if (error) { return reject(error); } resolve(true); } }) })}
export default plot;

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

