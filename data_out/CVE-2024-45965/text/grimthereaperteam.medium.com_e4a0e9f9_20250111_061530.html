[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F30edb8820ecb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fgrimthereaperteam.medium.com%2Fcontao-5-4-1-malicious-file-upload-xss-in-svg-30edb8820ecb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fgrimthereaperteam.medium.com%2Fcontao-5-4-1-malicious-file-upload-xss-in-svg-30edb8820ecb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Contao 5.4.1: Malicious File Upload (XSS in SVG) (CVE-2024–45965)

[![GrimTheRipper](https://miro.medium.com/v2/resize:fill:88:88/1*vcfV4sVoQWkw9SMupICkKA.jpeg)](/?source=post_page---byline--30edb8820ecb--------------------------------)

[GrimTheRipper](/?source=post_page---byline--30edb8820ecb--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda8b7823d35f&operation=register&redirect=https%3A%2F%2Fgrimthereaperteam.medium.com%2Fcontao-5-4-1-malicious-file-upload-xss-in-svg-30edb8820ecb&user=GrimTheRipper&userId=da8b7823d35f&source=post_page-da8b7823d35f--byline--30edb8820ecb---------------------post_header-----------)

2 min read·Sep 5, 2024

--

Listen

Share

**Description:**

# An Issue is discovered in Contao 5.4.1

# We have identified a vulnerability that allows an authenticated admin account to upload a SVG file containing malicious javascript code (Stored Cross-Site Scripting) into the target system. If the file is accessed through the website, it could lead to a Cross-Site Scripting (XSS) attack or execute arbitrary code via a crafted javascript to the target.

**Affected Component:**

http://[ip]/contao?act=move&do=files&mode=2&pid=files%2Fcontaodemo%2Fmedia%2Fcontent-images&id=&rt=deaa7b02c06d6cc4f3c68ec0f5.OX1bkqiOHJbgkGATVkTDE19Y1RBqS0HILO0uzSkPxcs.Zk8M3c77JfnT8lN4JxSSTC4Zj2EeMQ2Qdph4gEI8iKxcTD\_bytRb3KHlNQ&ref=14YjsbRN

**Payload:**

```
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
   <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
   <script type="text/javascript">
      alert('Grim The Ripper Team by SOSECURE Thailand');
   </script>
</svg>
```

First, log in to the target web application using an admin account.

![]()

http://[ip]/contao/login

Next, click on the “Files” panel.

![]()

Choose function “files”.

And click on “Upload files” function.

![]()

Choose function “Upload files”.

Click icon As in the picture.

![]()

Click icon on picture.

After that, click on “Click or drop here to upload” to upload a malicious file.

![]()

Upload files to the server.

Select the “GrimtheRipperTeam.svg” file to upload to the web application.

![]()

Select to “GrimTheRipperTeam.svg” file.

“GrimtheRipperTeam.svg” file has uploaded and click “Go back”.

![]()

“GrimTheRipperTeam.svg” file has uploaded.

Click “GrimtheRipperTeam.svg” Open New Tap.

![]()

the location of svg file on web.

Finally, we found that the malicious is working.

![]()

The payload was executed on the target.

**Author:**

Grim The Ripper Team by SOSECURE Thailand.

--

--

[![GrimTheRipper](https://miro.medium.com/v2/resize:fill:96:96/1*vcfV4sVoQWkw9SMupICkKA.jpeg)](/?source=post_page---post_author_info--30edb8820ecb--------------------------------)[![GrimTheRipper](https://miro.medium.com/v2/resize:fill:128:128/1*vcfV4sVoQWkw9SMupICkKA.jpeg)](/?source=post_page---post_author_info--30edb8820ecb--------------------------------)Follow[## Written by GrimTheRipper](/?source=post_page---post_author_info--30edb8820ecb--------------------------------)[24 Followers](/followers?source=post_page---post_author_info--30edb8820ecb--------------------------------)·[7 Following](/following?source=post_page---post_author_info--30edb8820ecb--------------------------------)

You get the best out of others when you give the best of yourself

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----30edb8820ecb--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----30edb8820ecb--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----30edb8820ecb--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----30edb8820ecb--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----30edb8820ecb--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----30edb8820ecb--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----30edb8820ecb--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----30edb8820ecb--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----30edb8820ecb--------------------------------)[Teams](https://medium.com/business?source=post_page-----30edb8820ecb--------------------------------)

