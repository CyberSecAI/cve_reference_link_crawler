=== Content from www.debian.org_55cabd48_20250110_203526.html ===


---

[[Date Prev](msg00185.html)][[Date Next](msg00187.html)]
[[Thread Prev](msg00185.html)][[Thread Next](msg00187.html)]
[[Date Index](maillist.html#00186)]
[[Thread Index](threads.html#00186)]

# [SECURITY] [DSA 5494-1] mutt security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5494-1] mutt security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sun, 10 Sep 2023 18:52:02 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1qfPXO-007vCE-UW%40seger.debian.org)Â [E1qfPXO-007vCE-UW@seger.debian.org](msg00186.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5494-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
September 10, 2023                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : mutt
CVE ID         : CVE-2023-4874 CVE-2023-4875
Debian Bug     : 1051563

Several NULL pointer dereference flaws were discovered in Mutt, a
text-based mailreader supporting MIME, GPG, PGP and threading, which may
result in denial of service (application crash) when viewing a specially
crafted email or when composing from a specially crafted draft message.

For the oldstable distribution (bullseye), these problems have been fixed
in version 2.0.5-4.1+deb11u3.

For the stable distribution (bookworm), these problems have been fixed in
version 2.2.9-1+deb12u1.

We recommend that you upgrade your mutt packages.

For the detailed security status of mutt please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/mutt>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmT+D8dfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0SSRw/9FWka9wnMAzBxcNsxoGxyRD8fWiFitW/MuwDy/29mlPjW+jR1GZsl841e
LX6dUHCJYveoo2yccLuj68pTeIVmv9gHh6pHazxCrnMlMq3/677wrT/mJKZZQZzh
mAg27I3jUqgUyZPSkS8mXVIA9zLY0qg1Yt5OJx/TJgKdXjHf6xne7ZeCgNo+ESf9
Dtx5fkYSS3yIYPOBRMRJK9kB+4ppsmy5hpSWlsWFrbulKiFEO3nwjcBA6SG6pqJO
NmHBp4t5Z1qgSoI5W0WgcL6BzK4Ewz/Jcnh18wCMearITnrpl4TXzeAcPK3jajzg
jeUwcu2sPilkOdDq3qXdm58Y5pQDft3gjaDS2XsYuJxyLURrzU4eDAJYGiT4vl1R
DPGIwon+0RY1fygtN5Nl6ybAhJ8AMp4JChzhI7RZl//5H+Im3juYymGRj2POG8jp
6uQwyIcC14bvDN9/ZBjJbMqkwhtZPJy/SkteipEVK7LW7J0Hw6jMpDJfbKrttTur
BwxuNYdf/NVcLu4jvPNinuxKc4UsJ62HBS8R9i+Ffa96GlHjvuUK2neKuxdhA2m/
/nANosFHK9Wyxg6z9MvoSHsJZY3OjLa3nOfByzTGKKDV4rf8iPqgeg1mv0IWYv0i
d3idQbkP65GcT1UgoNBreoO4R3JD07djIQqC1tAa5Rqmb0O7rgQ=
=Jqb0
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_3c4e2975_20250110_203525.html ===
From 4cc3128abdf52c615911589394a03271fddeefc6 Mon Sep 17 00:00:00 2001
From: Kevin McCarthy
Date: Mon, 4 Sep 2023 12:50:07 +0800
Subject: [PATCH] Check for NULL userhdrs.
When composing an email, miscellaneous extra headers are stored in a
userhdrs list. Mutt first checks to ensure each header contains at
least a colon character, passes the entire userhdr field (name, colon,
and body) to the rfc2047 decoder, and safe\_strdup()'s the result on
the userhdrs list. An empty result would from the decode would result
in a NULL headers being added to list.
The previous commit removed the possibility of the decoded header
field being empty, but it's prudent to add a check to the strchr
calls, in case there is another unexpected bug resulting in one.
Thanks to Chenyuan Mi (@morningbread) for discovering the two strchr
crashes, giving a working example draft message, and providing the
stack traces for the two NULL derefences.
---
sendlib.c | 4 ++--
1 file changed, 2 insertions(+), 2 deletions(-)
diff --git a/sendlib.c b/sendlib.c
index c2283972..763bff41 100644
--- a/sendlib.c
+++ b/sendlib.c
@@ -2418,7 +2418,7 @@ int mutt\_write\_rfc822\_header (FILE \*fp, ENVELOPE \*env, BODY \*attach, char \*date,
/\* Add any user defined headers \*/
for (; tmp; tmp = tmp->next)
{
- if ((p = strchr (tmp->data, ':')))
+ if ((p = strchr (NONULL (tmp->data), ':')))
{
q = p;
@@ -2466,7 +2466,7 @@ static void encode\_headers (LIST \*h)
for (; h; h = h->next)
{
- if (!(p = strchr (h->data, ':')))
+ if (!(p = strchr (NONULL (h->data), ':')))
continue;
i = p - h->data;
--
GitLab


=== Content from lists.debian.org_030eca23_20250110_203526.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3574-1] mutt security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3574-1] mutt security update
* *From*: Santiago Ruano RincÃ³n <santiago@freexian.com>
* *Date*: Wed, 20 Sep 2023 14:40:21 -0300
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZQsuhZt_hM4ycP52%40novelo)Â [ZQsuhZt\_hM4ycP52@novelo](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3574-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Santiago Ruano RincÃ³n
September 20, 2023                            <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : mutt
Version        : 1.10.1-2.1+deb10u7
CVE ID         : CVE-2023-4874 CVE-2023-4875
Debian Bug     : 1051563

Two NULL pointer dereference flaws were discovered in Mutt, a text-based
mailreader supporting MIME, GPG, PGP and threading, which may result in
denial of service (application crash) when viewing a specially crafted
email or when composing from a specially crafted draft message.

For Debian 10 buster, these problems have been fixed in version
1.10.1-2.1+deb10u7.

We recommend that you upgrade your mutt packages.

For the detailed security status of mutt please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mutt>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp6geZLhOPKK.pgp)**

*Description:* PGP signature

---



=== Content from gitlab.com_c60e83dc_20250110_203525.html ===
From 452ee330e094bfc7c9a68555e5152b1826534555 Mon Sep 17 00:00:00 2001
From: Kevin McCarthy
Date: Sun, 3 Sep 2023 12:22:01 +0800
Subject: [PATCH] Fix rfc2047 base64 decoding to abort on illegal characters.
For some reason, the rfc2047 base64 decoder ignored illegal
characters, instead of aborting. This seems innocuous, but in fact
leads to at least three crash-bugs elsewhere in Mutt.
These stem from Mutt, in some cases, passing an entire header
field (name, colon, and body) to the rfc2047 decoder. (It is
technically incorrect to do so, by the way, but is beyond scope for
these fixes in stable). Mutt then assumes the result can't be empty
because of a previous check that the header contains at least a colon.
This commit takes care of the source of the crashes, by aborting the
rfc2047 decode. The following two commits add protective fixes to the
specific crash points.
Thanks to Chenyuan Mi (@morningbread) for discovering the strchr
crashes, giving a working example draft message, and providing the
stack traces for the two NULL derefences.
---
rfc2047.c | 2 +-
1 file changed, 1 insertion(+), 1 deletion(-)
diff --git a/rfc2047.c b/rfc2047.c
index 1ce82ebbe..36cc76dbc 100644
--- a/rfc2047.c
+++ b/rfc2047.c
@@ -724,7 +724,7 @@ static int rfc2047\_decode\_word (BUFFER \*d, const char \*s, char \*\*charset)
if (\*pp == '=')
break;
if ((\*pp & ~127) || (c = base64val(\*pp)) == -1)
- continue;
+ goto error\_out\_0;
if (k + 6 >= 8)
{
k -= 2;
--
GitLab


=== Content from www.openwall.com_88885820_20250110_203525.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](../../../2023/09/09/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZRLUvitwwOp190UE@quatroqueijos.cascardo.eti.br>
Date: Tue, 26 Sep 2023 09:55:26 -0300
From: Thadeu Lima de Souza Cascardo <cascardo@...onical.com>
To: oss-security@...ts.openwall.com
Subject: Re: mutt 2.2.12 security update

On Sat, Sep 09, 2023 at 07:00:40PM -0000, Tavis Ormandy wrote:
> FYI, a mutt update that fixes a crash on header parsing:
>
> <http://lists.mutt.org/pipermail/mutt-announce/Week-of-Mon-20230904/000056.html>
>
> Tavis.
>
> --
>  _o)            $ lynx lock.cmpxchg8b.com
>  /\\  _o)  _o)  $ finger taviso@....org
> _\_V _( ) _( )  @taviso
>

These are CVE-2023-4874 and CVE-2023-4875.

Cascardo.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


