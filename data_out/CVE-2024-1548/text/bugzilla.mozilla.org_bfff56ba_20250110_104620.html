

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1832627)
* [XML](/show_bug.cgi?ctype=xml&id=1832627)

Closed
[Bug 1832627](/show_bug.cgi?id=1832627)
(CVE-2024-1548)

Opened 2 years ago
Closed 1 year ago

# select option with hides fullscreen notification, leads to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

select option with hides fullscreen notification, leads to spoof

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

123 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix) |
| firefox123 | [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 123+ | verified |
| firefox-esr128 | --- | --- |
| firefox121 |  | wontfix |
| firefox122 |  | wontfix |
| firefox123 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: m\_kato)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1875645d5594d36bca29657d51d24ed6?d=mm&size=40)  [m\_kato](/user_profile?user_id=8636)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=40)  [hsinyi](/user_profile?user_id=434964)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1869607](/show_bug.cgi?id=1869607 "RESOLVED DUPLICATE - HTML Select Option Can Be Used to Spoof Fullscreen")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1869607](/show_bug.cgi?id=1869607 "RESOLVED DUPLICATE - HTML Select Option Can Be Used to Spoof Fullscreen")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main123+][adv-esr115.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-1548

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main123+][adv-esr115.8+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c6 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [bandicam 2023-05-04 20-34-33-377.mp4](/attachment.cgi?id=9333128)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   2.26 MB, video/mp4 |  | [Details](/attachment.cgi?id=9333128&action=edit) |
| --- | --- | --- |
| [selectoption2.html](/attachment.cgi?id=9333129)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   2.99 KB, text/html |  | [Details](/attachment.cgi?id=9333129&action=edit) |
| [Bug 1832627 - Popup should be closed. r=edgar!](/attachment.cgi?id=9369850)  [1 year ago](#c13)  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta-](#c21 "1 year ago")  RyanVM : [approval-mozilla-esr115+](#c25 "1 year ago")  tjr : [sec-approval+](#c17 "1 year ago") | [Details](/attachment.cgi?id=9369850&action=edit) | [Review](/attachment.cgi?id=9369850) |
| [Bug 1832627 - Add mochitest. r=edgar!](/attachment.cgi?id=9369851)  [1 year ago](#c14)  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9369851&action=edit) | [Review](/attachment.cgi?id=9369851) |
| [Gif showing the issue on fixed Nightly](/attachment.cgi?id=9373497)  [1 year ago](#c22)  [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188)   121.85 KB, image/gif |  | [Details](/attachment.cgi?id=9373497&action=edit) |
| [advisory.txt](/attachment.cgi?id=9380024)  [11 months ago](#c28)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   243 bytes, text/plain |  | [Details](/attachment.cgi?id=9380024&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1832627#c0)• 2 years ago |
|  | |

Attached video
[bandicam 2023-05-04 20-34-33-377.mp4](attachment.cgi?id=9333128)
— [Details](attachment.cgi?id=9333128&action=edit)

I found a vulnerability where a select option can cover fullscreen notifications which can lead to spoofs.

steps to produce

1. open <http://103.186.0.20/selectoption2.html> or selectoption2.html
2. double click or 3 times click (not fast click) on select option , (when the select option clicked it covers the fullscreen notification)
Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1832627#c1)• 2 years ago |
|  | |

Attached file
[selectoption2.html](attachment.cgi?id=9333129)
— [Details](attachment.cgi?id=9333129&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a2179_406194)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Core & HTMLProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1832627#c2)• 2 years ago |
|  | |

I was able to reproduce this on MacOS, although the bar covered the notification even less than in the video. It felt like the first click triggered the full screen and the second triggered the select, so maybe it is a bit sensitive to timing.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1832627#c3)• 2 years ago |
|  | |

m\_kato, is this the same basic issue as [bug 1832195](/show_bug.cgi?id=1832195 "VERIFIED FIXED - Select Option Dropdown able to Overlap Fullscreen Notification Toast"), or do you think it might be different? Thanks.

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1832627#c4)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #3](/show_bug.cgi?id=1832627#c3 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))

> m\_kato, is this the same basic issue as [bug 1832195](/show_bug.cgi?id=1832195 "VERIFIED FIXED - Select Option Dropdown able to Overlap Fullscreen Notification Toast"), or do you think it might be different? Thanks.

As long as I look sample HTML, this is same issue.

Flags: needinfo?(m\_kato)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a85518_406194)• 2 years ago |

Status: NEW → RESOLVEDClosed: 2 years agoDuplicate of bug: [CVE-2023-37204](/show_bug.cgi?id=1832195 "VERIFIED FIXED - Select Option Dropdown able to Overlap Fullscreen Notification Toast")Resolution: --- → DUPLICATE

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1832627#c6)• 2 years ago |
|  | |

This was filed within the collision window of its dupe and therefore eligible for a split bounty

Flags: sec-bounty? → sec-bounty+

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1832627#c7)• 2 years ago |
|  | |

Hmm, [bug 1832195](/show_bug.cgi?id=1832195 "VERIFIED FIXED - Select Option Dropdown able to Overlap Fullscreen Notification Toast") is similar bug, but it isn't same since this isn't regression. reopen this.

Assignee: nobody → m\_katoStatus: RESOLVED → REOPENEDNo longer duplicate of bug: [CVE-2023-37204](/show_bug.cgi?id=1832195 "VERIFIED FIXED - Select Option Dropdown able to Overlap Fullscreen Notification Toast")Resolution: DUPLICATE → ---

|  | [Jan Jaeschke [:jjaschke]](/user_profile?user_id=711005) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a1897213_711005)• 2 years ago |

Severity: -- → S2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a2354122_1689)• 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1832627#c8)• 2 years ago |
|  | |

Hi Makoto! Any updates on this issue? Thanks!

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1832627#c9)• 2 years ago |
|  | |

I asked emilio (<https://bugzilla.mozilla.org/show_bug.cgi?id=1832195#c22>) whether notification box (HTML element) can override select box (XUL element). But no way. So I am finding to get notification box's rectangle when showing select box. I seem to get its rectangle, so I am working on.

Flags: needinfo?(m\_kato)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1832627#c10)• 1 year ago |
|  | |

hello any updates?

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1832627#c11)• 1 year ago |
|  | |

(In reply to Hafiizh from [comment #10](/show_bug.cgi?id=1832627#c10 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))

> hello any updates?

I am still working in progress. we need more work since I need to fix timing issue too. I hope that it is ready for review next week.

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a14474800_8636)• 1 year ago |

Severity: S2 → S3

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1832627#c12)• 1 year ago |
|  | |

(In reply to Makoto Kato [:m\_kato] from [comment #11](/show_bug.cgi?id=1832627#c11 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))

> (In reply to Hafiizh from [comment #10](/show_bug.cgi?id=1832627#c10 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))
>
> > hello any updates?
>
> I am still working in progress. we need more work since I need to fix timing issue too. I hope that it is ready for review next week.

hello any updates?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a18588614_406194)• 1 year ago |

See Also: → [1869607](/show_bug.cgi?id=1869607 "RESOLVED DUPLICATE - HTML Select Option Can Be Used to Spoof Fullscreen")

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1832627#c13)• 1 year ago |
|  | |

Attached file
[Bug 1832627 - Popup should be closed. r=edgar!](attachment.cgi?id=9369850)
— [Details](attachment.cgi?id=9369850&action=edit)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1832627#c14)• 1 year ago |
|  | |

Attached file
[Bug 1832627 - Add mochitest. r=edgar!](attachment.cgi?id=9369851)
— [Details](attachment.cgi?id=9369851&action=edit)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a19342139_8636)• 1 year ago |

Duplicate of this bug: [1869607](/show_bug.cgi?id=1869607 "RESOLVED DUPLICATE - HTML Select Option Can Be Used to Spoof Fullscreen")

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1832627#c16)• 1 year ago |
|  | |

Comment on [attachment 9369850](/attachment.cgi?id=9369850 "Bug 1832627 - Popup should be closed. r=edgar!") [[details]](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!")

[Bug 1832627](/show_bug.cgi?id=1832627 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof") - Popup should be closed. r=edgar!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: When entering full screen by user interaction, if user script can show pop up of <select> by same interaction and can move its element to same area of full screen notification box, its notification box keeps invisible.

But this depends on timing issue, this exploit isn't be always successful. Attacker has to consider a way to delay to open select's popup because opening popup requires user interaction. It isn't easy.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: 115
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Low. I add new custom event to close popup.
* **Is Android affected?**: No
[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1832627#c17)• 1 year ago |
|  | |

Comment on [attachment 9369850](/attachment.cgi?id=9369850 "Bug 1832627 - Popup should be closed. r=edgar!") [[details]](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!")

[Bug 1832627](/show_bug.cgi?id=1832627 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof") - Popup should be closed. r=edgar!

Approved to request uplift and land

[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: sec-approval? → sec-approval+

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1832627#c18)• 1 year ago |
|  | |

Comment on [attachment 9369850](/attachment.cgi?id=9369850 "Bug 1832627 - Popup should be closed. r=edgar!") [[details]](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!")

[Bug 1832627](/show_bug.cgi?id=1832627 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof") - Popup should be closed. r=edgar!

### Beta/Release Uplift Approval Request

* **User impact if declined**: When entering full screen by user interaction, if user script can show pop up of <select> by same interaction and can move its element to same area of full screen notification box, its notification box keeps invisible.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: see [comment #0](/show_bug.cgi?id=1832627#c0 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof")
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Low. When showing full screen notification box, all pop up by <select> element is closed.
* **String changes made/needed**:
* **Is Android affected?**: No

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec bug
* **User impact if declined**: When entering full screen by user interaction, if user script can show pop up of <select> by same interaction and can move its element to same area of full screen notification box, its notification box keeps invisible.
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Low. When showing full screen notification box, all pop up by <select> element is closed.
[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: approval-mozilla-esr115?
[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: approval-mozilla-beta?

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a21658430_8636)• 1 year ago |

Flags: qe-verify+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1832627#c19)• 1 year ago |
|  | |

Pushed by m\_kato@ga2.so-net.ne.jp:
<https://hg.mozilla.org/integration/autoland/rev/b03b4a8f6dc5>
Popup should be closed. r=edgar

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a21744131_258347)• 1 year ago |

Group: dom-core-security → core-security-releaseStatus: REOPENED → RESOLVEDClosed: 2 years ago → 1 year ago
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 123 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a21746461_553429)• 1 year ago |

QA Whiteboard: [qa-triaged]

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1832627#c20)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b03b4a8f6dc5>

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1832627#c21)• 1 year ago |
|  | |

Comment on [attachment 9369850](/attachment.cgi?id=9369850 "Bug 1832627 - Popup should be closed. r=edgar!") [[details]](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!")

[Bug 1832627](/show_bug.cgi?id=1832627 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof") - Popup should be closed. r=edgar!

Rejecting beta uplift request.

This landed in central for Fx123 and will ride the train to beta next week.

[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta-

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1832627#c22)• 1 year ago |
|  | |

Attached image
[Gif showing the issue on fixed Nightly](attachment.cgi?id=9373497)
— [Details](attachment.cgi?id=9373497&action=edit)

Reproduced the initial issue using an old Nightly build from 2023-04-30 on Windows 11 and using latest Nightly with the fix I can still kind of reproduce but using a kind of a pause between clicks (see gif attached) which probably can't be counted as double click but I thought was worth mentioning. It could take a few tries but you can definitely still make the full screen notification be covered.

Any thoughts?

Flags: needinfo?(m\_kato)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a21779088_75935)• 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox123](/buglist.cgi?f1=cf_tracking_firefox123&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1832627#c23)• 1 year ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #22](/show_bug.cgi?id=1832627#c22 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))

> Created [attachment 9373497](/attachment.cgi?id=9373497 "Gif showing the issue on fixed Nightly") [[details]](/attachment.cgi?id=9373497&action=edit "Gif showing the issue on fixed Nightly")
>
> Gif showing the issue on fixed Nightly
>
> Reproduced the initial issue using an old Nightly build from 2023-04-30 on Windows 11 and using latest Nightly with the fix I can still kind of reproduce but using a kind of a pause between clicks (see gif attached) which probably can't be counted as double click but I thought was worth mentioning. It could take a few tries but you can definitely still make the full screen notification be covered.
>
> Any thoughts?

Before landing this, notification box is never showed. So this fix shows this box and cancel popup when this box is animated. So this is expected.

Flags: needinfo?(m\_kato)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1832627#c24)• 1 year ago |
|  | |

(In reply to Makoto Kato [:m\_kato] from [comment #23](/show_bug.cgi?id=1832627#c23 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))

> (In reply to Bogdan Maris, Desktop QA from [comment #22](/show_bug.cgi?id=1832627#c22 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof"))
>
> > Created [attachment 9373497](/attachment.cgi?id=9373497 "Gif showing the issue on fixed Nightly") [[details]](/attachment.cgi?id=9373497&action=edit "Gif showing the issue on fixed Nightly")
> >
> > Gif showing the issue on fixed Nightly
> >
> > Reproduced the initial issue using an old Nightly build from 2023-04-30 on Windows 11 and using latest Nightly with the fix I can still kind of reproduce but using a kind of a pause between clicks (see gif attached) which probably can't be counted as double click but I thought was worth mentioning. It could take a few tries but you can definitely still make the full screen notification be covered.
> >
> > Any thoughts?
>
> Before landing this, notification box is never showed. So this fix shows this box and cancel popup when this box is animated. So this is expected.

Thanks. In this case I'll go ahead and mark this as verified fixed on Firefox 123 after I checked on Windows 11, macOS 13 and Ubuntu 22.04, but not closing the bug since esr115 is affected and tracked.

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1832627#c25)• 11 months ago |
|  | |

Comment on [attachment 9369850](/attachment.cgi?id=9369850 "Bug 1832627 - Popup should be closed. r=edgar!") [[details]](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!")

[Bug 1832627](/show_bug.cgi?id=1832627 "VERIFIED FIXED - select option with hides fullscreen notification, leads to spoof") - Popup should be closed. r=edgar!

Approved for 115.8esr.

[Attachment #9369850](/attachment.cgi?id=9369850&action=edit "Bug 1832627 - Popup should be closed. r=edgar!") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1832627#c26)• 11 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/4ef8e1792fda>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a23622581_75935)• 11 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1832627#c27)• 11 months ago |
|  | |

Also verified using Firefox 115.8.0esr build across platforms (Windows 11, macOS 13.6 and Ubuntu 22.04).

Status: RESOLVED → VERIFIED
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a24035272_578488)• 11 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main123+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a24035823_578488)• 11 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main123+] → [reporter-external] [client-bounty-form] [verif?][adv-main123+][adv-esr115.8+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1832627#c28)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9380024)
— [Details](attachment.cgi?id=9380024&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a24197209_578488)• 11 months ago |

Alias: CVE-2024-1548

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a33269647_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1832627#a42648109_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1832627&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

