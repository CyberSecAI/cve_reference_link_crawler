[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## kubernetes-security-announce

[Conversations](./g/kubernetes-security-announce)[About](./g/kubernetes-security-announce/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# [Ingress-nginx Security Advisory] CVE-2024-7646: Ingress-nginx Annotation Validation Bypass

 1,845 viewsSkip to first unread message![Craig Ingram's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUVVjEmOKUBD6mvzS-dQNalSgAW20gny6hjhLou9XHEkmDv6GeX=s40-c)
### Craig Ingram

unread,Aug 16, 2024, 6:08:03 PM8/16/24Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto kubernete...@googlegroups.com, d...@kubernetes.io, kubernetes-sec...@googlegroups.com, kubernetes-se...@googlegroups.com, distributors-announce

Hello Kubernetes Community,

A security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects (in the `[networking.k8s.io](http://networking.k8s.io)` or `extensions` API group) can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.

This issue has been rated High (8.8) [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and assigned CVE-2024-7646.

Am I vulnerable?

This bug affects ingress-nginx. If you do not have ingress-nginx installed on your cluster, you are not affected. You can check this by running `kubectl get po -A` and looking for `ingress-nginx-controller`.

Multi-tenant environments where non-admin users have permissions to create Ingress objects are most affected by this issue.

Affected Versions

ingress-nginx controller < v1.11.2

How do I mitigate this vulnerability?

This issue can be mitigated by upgrading to the fixed version.

Fixed Versions

ingress-nginx controller v1.11.2

Detection

Review your Kubernetes audit logs for Ingress objects created with annotations (e.g. `[nginx.ingress.kubernetes.io/auth-tls-verify-client`](http://nginx.ingress.kubernetes.io/auth-tls-verify-client)) that contain carriage returns (`\r`).

If you find evidence that this vulnerability has been exploited, please contact secu...@kubernetes.io

Additional Details

See the GitHub issue for more details:

<https://github.com/kubernetes/kubernetes/issues/126744>

Acknowledgements

This vulnerability was reported by André Storfjord Kristiansen @dev-bio.

The issue was fixed and coordinated by the fix team:

André Storfjord Kristiansen @dev-bio

Jintao Zhang @tao12345666333

Marco Ebert @Gacko

Thank You,

Craig Ingram on behalf of the Kubernetes Security Response Committee

--

|  |
| --- |
| |  | | Craig Ingram | | | --- | --- | | Security Engineer | | | cjin...@google.com | | | | --- | --- | --- | --- | --- | --- | --- | --- | |

Reply allReply to authorForward0 new messages