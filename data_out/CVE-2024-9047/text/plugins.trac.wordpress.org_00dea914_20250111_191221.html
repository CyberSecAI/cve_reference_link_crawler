

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3164449%2Fwp-file-upload)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3146595/wp-file-upload "Changeset 3146595 for wp-file-upload")
* [Next Change](/changeset/3164451/wp-file-upload "Changeset 3164451 for wp-file-upload") →

---

# Changeset [3164449](/changeset/3164449 "Show full changeset") for [wp-file-upload](/browser/wp-file-upload?rev=3164449 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/07/2024 04:44:52 PM
([3 months](/timeline?from=2024-10-07T16%3A44%3A52Z&precision=second "See timeline at 10/07/2024 04:44:52 PM") ago)

Author:
nickboss
Message:

committing new version 4.24.12 changes:

* verified compatibility with Wordpress version 6.6.2
* fixed directory traversal security issue in wfu\_file\_downloader.php file
* extended csv, xml and m4a mime types

Location:
[wp-file-upload/trunk](/browser/wp-file-upload/trunk?rev=3164449)
Files:

6 edited

* [lib/wfu\_functions.php](/browser/wp-file-upload/trunk/lib/wfu_functions.php?rev=3164449 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [lib/wfu\_security.php](/browser/wp-file-upload/trunk/lib/wfu_security.php?rev=3164449 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.txt](/browser/wp-file-upload/trunk/readme.txt?rev=3164449 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [release\_notes.txt](/browser/wp-file-upload/trunk/release_notes.txt?rev=3164449 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [wfu\_file\_downloader.php](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449 "Show entry in browser")
  (modified)
  ([11 diffs](#file4 "Show differences"))
* [wordpress\_file\_upload.php](/browser/wp-file-upload/trunk/wordpress_file_upload.php?rev=3164449 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-file-upload/trunk/lib/wfu\_functions.php](/changeset/3164449/wp-file-upload/trunk/lib/wfu_functions.php "Show the changeset 3164449 restricted to wp-file-upload/trunk/lib/wfu_functions.php")

  | [r3140351](/browser/wp-file-upload/trunk/lib/wfu_functions.php?rev=3140351#L6549 "Show revision 3140351 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/lib/wfu_functions.php?rev=3164449#L6549 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 6549 | 6549 | $cookie, |
  | 6550 | 6550 | time() + intval(WFU\_VAR("WFU\_US\_COOKIE\_LIFE")) \* 3600, |
  | 6551 |  | ~~COOKIEPATH~~ ? COOKIEPATH : '/', |
  | 6552 |  | ~~COOKIE\_DOMAIN~~, |
  |  | 6551 | defined("COOKIEPATH") ? COOKIEPATH : '/', |
  |  | 6552 | defined("COOKIE\_DOMAIN") ? COOKIE\_DOMAIN : '/', |
  | 6553 | 6553 | false, |
  | 6554 | 6554 | false |
* ## [wp-file-upload/trunk/lib/wfu\_security.php](/changeset/3164449/wp-file-upload/trunk/lib/wfu_security.php "Show the changeset 3164449 restricted to wp-file-upload/trunk/lib/wfu_security.php")

  | [r3146594](/browser/wp-file-upload/trunk/lib/wfu_security.php?rev=3146594#L47 "Show revision 3146594 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/lib/wfu_security.php?rev=3164449#L47 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 47 | 47 | \*/ |
  | 48 | 48 | function wfu\_extensions\_mime\_types() { |
  | 49 |  | $list = array( "ez" => array( "application/andrew-inset" ), "anx" => array( "application/annodex" ), "atom" => array( "application/atom+xml" ), "atomcat" => array( "application/atomcat+xml" ), "atomsrv" => array( "application/atomserv+xml" ), "lin" => array( "application/bbolin" ), "cu" => array( "application/cu-seeme" ), "davmount" => array( "application/davmount+xml" ), "dcm" => array( "application/dicom" ), "tsp" => array( "application/dsptype" ), "es" => array( "application/ecmascript" ), "epub" => array( "application/epub+zip" ), "otf" => array( "application/font-sfnt", "font/otf", "font/sfnt", "font/ttf" ), "ttf" => array( "application/font-sfnt", "font/otf", "font/sfnt", "font/ttf" ), "pfr" => array( "application/font-tdpfr" ), "woff" => array( "application/font-woff", "font/woff" ), "spl" => array( "application/futuresplash", "application/x-futuresplash" ), "gz" => array( "application/gzip" ), "hta" => array( "application/hta" ), "jar" => array( "application/java-archive" ), "ser" => array( "application/java-serialized-object" ), "class" => array( "application/java-vm" ), "js" => array( "application/javascript" ), "json" => array( "application/json" ), "m3g" => array( "application/m3g" ), "hqx" => array( "application/mac-binhex40" ), "cpt" => array( "application/mac-compactpro", "image/x-corelphotopaint" ), "nb" => array( "application/mathematica" ), "nbp" => array( "application/mathematica" ), "mbox" => array( "application/mbox" ), "mdb" => array( "application/msaccess" ), "doc" => array( "application/msword" ), "dot" => array( "application/msword" ), "mxf" => array( "application/mxf" ), "bin" => array( "application/octet-stream" ), "deploy" => array( "application/octet-stream" ), "msu" => array( "application/octet-stream" ), "msp" => array( "application/octet-stream" ), "oda" => array( "application/oda" ), "opf" => array( "application/oebps-package+xml" ), "ogx" => array( "application/ogg" ), "one" => array( "application/onenote" ), "onetoc2" => array( "application/onenote" ), "onetmp" => array( "application/onenote" ), "onepkg" => array( "application/onenote" ), "pdf" => array( "application/pdf" ), "pgp" => array( "application/pgp-encrypted" ), "key" => array( "application/pgp-keys" ), "sig" => array( "application/pgp-signature" ), "prf" => array( "application/pics-rules" ), "ps" => array( "application/postscript" ), "ai" => array( "application/postscript" ), "eps" => array( "application/postscript" ), "epsi" => array( "application/postscript" ), "epsf" => array( "application/postscript" ), "eps2" => array( "application/postscript" ), "eps3" => array( "application/postscript" ), "rar" => array( "application/rar" ), "rdf" => array( "application/rdf+xml" ), "rtf" => array( "application/rtf" ), "stl" => array( "application/sla" ), "smi" => array( "application/smil+xml" ), "smil" => array( "application/smil+xml" ), "xhtml" => array( "application/xhtml+xml" ), "xht" => array( "application/xhtml+xml" ), "xml" => array( "application/xml"~~), "xsd" => array( "application/xml" ), "xsl" => array( "application/xslt+xml" ), "xslt" => array( "application/xslt+xml" ), "xspf" => array( "application/xspf+xml" ), "zip" => array( "application/zip" ), "apk" => array( "application/vnd.android.package-archive" ), "cdy" => array( "application/vnd.cinderella" ), "deb" => array( "application/vnd.debian.binary-package", "application/x-debian-package" ), "ddeb" => array( "application/vnd.debian.binary-package" ), "udeb" => array( "application/vnd.debian.binary-package", "application/x-debian-package" ), "sfd" => array( "application/vnd.font-fontforge-sfd" ), "kml" => array( "application/vnd.google-earth.kml+xml" ), "kmz" => array( "application/vnd.google-earth.kmz" ), "xul" => array( "application/vnd.mozilla.xul+xml" ), "xls" => array( "application/vnd.ms-excel" ), "xlb" => array( "application/vnd.ms-excel" ), "xlt" => array( "application/vnd.ms-excel" ), "xlam" => array( "application/vnd.ms-excel.addin.macroenabled.12" ), "xlsb" => array( "application/vnd.ms-excel.sheet.binary.macroenabled.12" ), "xlsm" => array( "application/vnd.ms-excel.sheet.macroenabled.12" ), "xltm" => array( "application/vnd.ms-excel.template.macroenabled.12" ), "eot" => array( "application/vnd.ms-fontobject" ), "thmx" => array( "application/vnd.ms-officetheme" ), "cat" => array( "application/vnd.ms-pki.seccat" ), "ppt" => array( "application/vnd.ms-powerpoint" ), "pps" => array( "application/vnd.ms-powerpoint" ), "ppam" => array( "application/vnd.ms-powerpoint.addin.macroenabled.12" ), "pptm" => array( "application/vnd.ms-powerpoint.presentation.macroenabled.12" ), "sldm" => array( "application/vnd.ms-powerpoint.slide.macroenabled.12" ), "ppsm" => array( "application/vnd.ms-powerpoint.slideshow.macroenabled.12" ), "potm" => array( "application/vnd.ms-powerpoint.template.macroenabled.12" ), "docm" => array( "application/vnd.ms-word.document.macroenabled.12" ), "dotm" => array( "application/vnd.ms-word.template.macroenabled.12" ), "odc" => array( "application/vnd.oasis.opendocument.chart" ), "odb" => array( "application/vnd.oasis.opendocument.database" ), "odf" => array( "application/vnd.oasis.opendocument.formula" ), "odg" => array( "application/vnd.oasis.opendocument.graphics" ), "otg" => array( "application/vnd.oasis.opendocument.graphics-template" ), "odi" => array( "application/vnd.oasis.opendocument.image" ), "odp" => array( "application/vnd.oasis.opendocument.presentation" ), "otp" => array( "application/vnd.oasis.opendocument.presentation-template" ), "ods" => array( "application/vnd.oasis.opendocument.spreadsheet" ), "ots" => array( "application/vnd.oasis.opendocument.spreadsheet-template" ), "odt" => array( "application/vnd.oasis.opendocument.text" ), "odm" => array( "application/vnd.oasis.opendocument.text-master" ), "ott" => array( "application/vnd.oasis.opendocument.text-template" ), "oth" => array( "application/vnd.oasis.opendocument.text-web" ), "pptx" => array( "application/vnd.openxmlformats-officedocument.presentationml.presentation" ), "sldx" => array( "application/vnd.openxmlformats-officedocument.presentationml.slide" ), "ppsx" => array( "application/vnd.openxmlformats-officedocument.presentationml.slideshow" ), "potx" => array( "application/vnd.openxmlformats-officedocument.presentationml.template" ), "xlsx" => array( "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" ), "xltx" => array( "application/vnd.openxmlformats-officedocument.spreadsheetml.template" ), "docx" => array( "application/vnd.openxmlformats-officedocument.wordprocessingml.document" ), "dotx" => array( "application/vnd.openxmlformats-officedocument.wordprocessingml.template" ), "cod" => array( "application/vnd.rim.cod" ), "mmf" => array( "application/vnd.smaf" ), "sdc" => array( "application/vnd.stardivision.calc" ), "sds" => array( "application/vnd.stardivision.chart" ), "sda" => array( "application/vnd.stardivision.draw" ), "sdd" => array( "application/vnd.stardivision.impress" ), "sdf" => array( "application/vnd.stardivision.math", "chemical/x-mdl-sdfile" ), "sdw" => array( "application/vnd.stardivision.writer" ), "sgl" => array( "application/vnd.stardivision.writer-global" ), "sxc" => array( "application/vnd.sun.xml.calc" ), "stc" => array( "application/vnd.sun.xml.calc.template" ), "sxd" => array( "application/vnd.sun.xml.draw" ), "std" => array( "application/vnd.sun.xml.draw.template" ), "sxi" => array( "application/vnd.sun.xml.impress" ), "sti" => array( "application/vnd.sun.xml.impress.template" ), "sxm" => array( "application/vnd.sun.xml.math" ), "sxw" => array( "application/vnd.sun.xml.writer" ), "sxg" => array( "application/vnd.sun.xml.writer.global" ), "stw" => array( "application/vnd.sun.xml.writer.template" ), "sis" => array( "application/vnd.symbian.install" ), "cap" => array( "application/vnd.tcpdump.pcap" ), "pcap" => array( "application/vnd.tcpdump.pcap" ), "vsd" => array( "application/vnd.visio" ), "vst" => array( "application/vnd.visio" ), "vsw" => array( "application/vnd.visio" ), "vss" => array( "application/vnd.visio" ), "wbxml" => array( "application/vnd.wap.wbxml" ), "wmlc" => array( "application/vnd.wap.wmlc" ), "wmlsc" => array( "application/vnd.wap.wmlscriptc" ), "wpd" => array( "application/vnd.wordperfect" ), "wp5" => array( "application/vnd.wordperfect5.1" ), "wk" => array( "application/x-123" ), "7z" => array( "application/x-7z-compressed" ), "abw" => array( "application/x-abiword" ), "dmg" => array( "application/x-apple-diskimage" ), "bcpio" => array( "application/x-bcpio" ), "torrent" => array( "application/x-bittorrent" ), "cab" => array( "application/x-cab" ), "cbr" => array( "application/x-cbr" ), "cbz" => array( "application/x-cbz" ), "cdf" => array( "application/x-cdf" ), "cda" => array( "application/x-cdf" ), "vcd" => array( "application/x-cdlink" ), "pgn" => array( "application/x-chess-pgn" ), "mph" => array( "application/x-comsol" ), "cpio" => array( "application/x-cpio" ), "csh" => array( "application/x-csh", "text/x-csh" ), "dcr" => array( "application/x-director" ), "dir" => array( "application/x-director" ), "dxr" => array( "application/x-director" ), "dms" => array( "application/x-dms" ), "wad" => array( "application/x-doom" ), "dvi" => array( "application/x-dvi" ), "pfa" => array( "application/x-font" ), "pfb" => array( "application/x-font" ), "gsf" => array( "application/x-font" ), "pcf" => array( "application/x-font-pcf" ), "pcf.z" => array( "application/x-font-pcf" ), "mm" => array( "application/x-freemind" ), "gan" => array( "application/x-ganttproject" ), "gnumeric" => array( "application/x-gnumeric" ), "sgf" => array( "application/x-go-sgf" ), "gcf" => array( "application/x-graphing-calculator" ), "gtar" => array( "application/x-gtar" ), "tgz" => array( "application/x-gtar-compressed" ), "taz" => array( "application/x-gtar-compressed" ), "hdf" => array( "application/x-hdf" ), "hwp" => array( "application/x-hwp" ), "ica" => array( "application/x-ica" ), "info" => array( "application/x-info" ), "ins" => array( "application/x-internet-signup" ), "isp" => array( "application/x-internet-signup" ), "iii" => array( "application/x-iphone" ), "iso" => array( "application/x-iso9660-image" ), "jam" => array( "application/x-jam" ), "jnlp" => array( "application/x-java-jnlp-file" ), "jmz" => array( "application/x-jmol" ), "chrt" => array( "application/x-kchart" ), "kil" => array( "application/x-killustrator" ), "skp" => array( "application/x-koan" ), "skd" => array( "application/x-koan" ), "skt" => array( "application/x-koan" ), "skm" => array( "application/x-koan" ), "kpr" => array( "application/x-kpresenter" ), "kpt" => array( "application/x-kpresenter" ), "ksp" => array( "application/x-kspread" ), "kwd" => array( "application/x-kword" ), "kwt" => array( "application/x-kword" ), "latex" => array( "application/x-latex" ), "lha" => array( "application/x-lha" ), "lyx" => array( "application/x-lyx" ), "lzh" => array( "application/x-lzh" ), "lzx" => array( "application/x-lzx" ), "frm" => array( "application/x-maker" ), "maker" => array( "application/x-maker" ), "frame" => array( "application/x-maker" ), "fm" => array( "application/x-maker" ), "fb" => array( "application/x-maker" ), "book" => array( "application/x-maker" ), "fbdoc" => array( "application/x-maker" ), "mif" => array( "application/x-mif" ), "m3u8" => array( "application/x-mpegurl" ), "application" => array( "application/x-ms-application" ), "manifest" => array( "application/x-ms-manifest" ), "wmd" => array( "application/x-ms-wmd" ), "wmz" => array( "application/x-ms-wmz" ), "com" => array( "application/x-msdos-program" ), "exe" => array( "application/x-msdos-program" ), "bat" => array( "application/x-msdos-program" ), "dll" => array( "application/x-msdos-program" ), "msi" => array( "application/x-msi" ), "nc" => array( "application/x-netcdf" ), "pac" => array( "application/x-ns-proxy-autoconfig" ), "nwc" => array( "application/x-nwc" ), "o" => array( "application/x-object" ), "oza" => array( "application/x-oz-application" ), "p7r" => array( "application/x-pkcs7-certreqresp" ), "crl" => array( "application/x-pkcs7-crl" ), "pyc" => array( "application/x-python-code" ), "pyo" => array( "application/x-python-code" ), "qgs" => array( "application/x-qgis" ), "shp" => array( "application/x-qgis" ), "shx" => array( "application/x-qgis" ), "qtl" => array( "application/x-quicktimeplayer" ), "rdp" => array( "application/x-rdp" ), "rpm" => array( "application/x-redhat-package-manager" ), "rss" => array( "application/x-rss+xml" ), "rb" => array( "application/x-ruby" ), "sci" => array( "application/x-scilab" ), "sce" => array( "application/x-scilab" ), "xcos" => array( "application/x-scilab-xcos" ), "sh" => array( "application/x-sh", "text/x-sh" ), "shar" => array( "application/x-shar" ), "swf" => array( "application/x-shockwave-flash" ), "swfl" => array( "application/x-shockwave-flash" ), "scr" => array( "application/x-silverlight" ), "sql" => array( "application/x-sql" ), "sit" => array( "application/x-stuffit" ), "sitx" => array( "application/x-stuffit" ), "sv4cpio" => array( "application/x-sv4cpio" ), "sv4crc" => array( "application/x-sv4crc" ), "tar" => array( "application/x-tar" ), "tcl" => array( "application/x-tcl", "text/x-tcl" ), "gf" => array( "application/x-tex-gf" ), "pk" => array( "application/x-tex-pk" ), "texinfo" => array( "application/x-texinfo" ), "texi" => array( "application/x-texinfo" ), "~" => array( "application/x-trash" ), "%" => array( "application/x-trash" ), "bak" => array( "application/x-trash" ), "old" => array( "application/x-trash" ), "sik" => array( "application/x-trash" ), "t" => array( "application/x-troff" ), "tr" => array( "application/x-troff" ), "roff" => array( "application/x-troff" ), "man" => array( "application/x-troff-man" ), "me" => array( "application/x-troff-me" ), "ms" => array( "application/x-troff-ms" ), "ustar" => array( "application/x-ustar" ), "src" => array( "application/x-wais-source" ), "wz" => array( "application/x-wingz" ), "crt" => array( "application/x-x509-ca-cert" ), "xcf" => array( "application/x-xcf" ), "fig" => array( "application/x-xfig" ), "xpi" => array( "application/x-xpinstall" ), "xz" => array( "application/x-xz" ), "amr" => array( "audio/amr" ), "awb" => array( "audio/amr-wb" ), "axa" => array( "audio/annodex" ), "au" => array( "audio/basic" ), "snd" => array( "audio/basic" ), "csd" => array( "audio/csound" ), "orc" => array( "audio/csound" ), "sco" => array( "audio/csound" ), "flac" => array( "audio/flac" ), "mid" => array( "audio/midi" ), "midi" => array( "audio/midi" ), "kar" => array( "audio/midi" ), "mpga" => array( "audio/mpeg" ), "mpega" => array( "audio/mpeg" ), "mp2" => array( "audio/mpeg" ), "mp3" => array( "audio/mpeg" ), "m4a" => array( "audio/mpeg" ), "m3u" => array( "audio/mpegurl", "audio/x-mpegurl" ), "oga" => array( "audio/ogg" ), "ogg" => array( "audio/ogg" ), "opus" => array( "audio/ogg" ), "spx" => array( "audio/ogg" ), "sid" => array( "audio/prs.sid" ), "aif" => array( "audio/x-aiff" ), "aiff" => array( "audio/x-aiff" ), "aifc" => array( "audio/x-aiff" ), "gsm" => array( "audio/x-gsm" ), "wma" => array( "audio/x-ms-wma" ), "wax" => array( "audio/x-ms-wax" ), "ra" => array( "audio/x-pn-realaudio", "audio/x-realaudio" ), "rm" => array( "audio/x-pn-realaudio" ), "ram" => array( "audio/x-pn-realaudio" ), "pls" => array( "audio/x-scpls" ), "sd2" => array( "audio/x-sd2" ), "wav" => array( "audio/x-wav" ), "alc" => array( "chemical/x-alchemy" ), "cac" => array( "chemical/x-cache" ), "cache" => array( "chemical/x-cache" ), "csf" => array( "chemical/x-cache-csf" ), "cbin" => array( "chemical/x-cactvs-binary" ), "cascii" => array( "chemical/x-cactvs-binary" ), "ctab" => array( "chemical/x-cactvs-binary" ), "cdx" => array( "chemical/x-cdx" ), "cer" => array( "chemical/x-cerius" ), "c3d" => array( "chemical/x-chem3d" ), "chm" => array( "chemical/x-chemdraw" ), "cif" => array( "chemical/x-cif" ), "cmdf" => array( "chemical/x-cmdf" ), "cml" => array( "chemical/x-cml" ), "cpa" => array( "chemical/x-compass" ), "bsd" => array( "chemical/x-crossfire" ), "csml" => array( "chemical/x-csml" ), "csm" => array( "chemical/x-csml" ), "ctx" => array( "chemical/x-ctx" ), "cxf" => array( "chemical/x-cxf" ), "cef" => array( "chemical/x-cxf" ), "emb" => array( "chemical/x-embl-dl-nucleotide" ), "embl" => array( "chemical/x-embl-dl-nucleotide" ), "spc" => array( "chemical/x-galactic-spc" ), "inp" => array( "chemical/x-gamess-input" ), "gam" => array( "chemical/x-gamess-input" ), "gamin" => array( "chemical/x-gamess-input" ), "fch" => array( "chemical/x-gaussian-checkpoint" ), "fchk" => array( "chemical/x-gaussian-checkpoint" ), "cub" => array( "chemical/x-gaussian-cube" ), "gau" => array( "chemical/x-gaussian-input" ), "gjc" => array( "chemical/x-gaussian-input" ), "gjf" => array( "chemical/x-gaussian-input" ), "gal" => array( "chemical/x-gaussian-log" ), "gcg" => array( "chemical/x-gcg8-sequence" ), "gen" => array( "chemical/x-genbank" ), "hin" => array( "chemical/x-hin" ), "istr" => array( "chemical/x-isostar" ), "ist" => array( "chemical/x-isostar" ), "jdx" => array( "chemical/x-jcamp-dx" ), "dx" => array( "chemical/x-jcamp-dx" ), "kin" => array( "chemical/x-kinemage" ), "mcm" => array( "chemical/x-macmolecule" ), "mmd" => array( "chemical/x-macromodel-input" ), "mmod" => array( "chemical/x-macromodel-input" ), "mol" => array( "chemical/x-mdl-molfile" ), "rd" => array( "chemical/x-mdl-rdfile" ), "rxn" => array( "chemical/x-mdl-rxnfile" ), "sd" => array( "chemical/x-mdl-sdfile" ), "tgf" => array( "chemical/x-mdl-tgf" ), "mcif" => array( "chemical/x-mmcif" ), "mol2" => array( "chemical/x-mol2" ), "b" => array( "chemical/x-molconn-z" ), "gpt" => array( "chemical/x-mopac-graph" ), "mop" => array( "chemical/x-mopac-input" ), "mopcrt" => array( "chemical/x-mopac-input" ), "mpc" => array( "chemical/x-mopac-input" ), "zmt" => array( "chemical/x-mopac-input" ), "moo" => array( "chemical/x-mopac-out" ), "mvb" => array( "chemical/x-mopac-vib" ), "asn" => array( "chemical/x-ncbi-asn1", "chemical/x-ncbi-asn1-spec" ), "prt" => array( "chemical/x-ncbi-asn1-ascii" ), "ent" => array( "chemical/x-ncbi-asn1-ascii", "chemical/x-pdb" ), "val" => array( "chemical/x-ncbi-asn1-binary" ), "aso" => array( "chemical/x-ncbi-asn1-binary" ), "pdb" => array( "chemical/x-pdb" ), "ros" => array( "chemical/x-rosdal" ), "sw" => array( "chemical/x-swissprot" ), "vms" => array( "chemical/x-vamas-iso14976" ), "vmd" => array( "chemical/x-vmd" ), "xtel" => array( "chemical/x-xtel" ), "xyz" => array( "chemical/x-xyz" ), "ttc" => array( "font/collection" ), "woff2" => array( "font/woff2" ), "gif" => array( "image/gif" ), "ief" => array( "image/ief" ), "jp2" => array( "image/jp2" ), "jpg2" => array( "image/jp2" ), "jpeg" => array( "image/jpeg" ), "jpg" => array( "image/jpeg" ), "jpe" => array( "image/jpeg" ), "jpm" => array( "image/jpm" ), "jpx" => array( "image/jpx" ), "jpf" => array( "image/jpx" ), "pcx" => array( "image/pcx" ), "png" => array( "image/png" ), "svg" => array( "image/svg+xml" ), "svgz" => array( "image/svg+xml" ), "tiff" => array( "image/tiff" ), "tif" => array( "image/tiff" ), "djvu" => array( "image/vnd.djvu" ), "djv" => array( "image/vnd.djvu" ), "ico" => array( "image/vnd.microsoft.icon" ), "wbmp" => array( "image/vnd.wap.wbmp" ), "cr2" => array( "image/x-canon-cr2" ), "crw" => array( "image/x-canon-crw" ), "ras" => array( "image/x-cmu-raster" ), "cdr" => array( "image/x-coreldraw" ), "pat" => array( "image/x-coreldrawpattern" ), "cdt" => array( "image/x-coreldrawtemplate" ), "erf" => array( "image/x-epson-erf" ), "art" => array( "image/x-jg" ), "jng" => array( "image/x-jng" ), "bmp" => array( "image/x-ms-bmp" ), "nef" => array( "image/x-nikon-nef" ), "orf" => array( "image/x-olympus-orf" ), "psd" => array( "image/x-photoshop" ), "pnm" => array( "image/x-portable-anymap" ), "pbm" => array( "image/x-portable-bitmap" ), "pgm" => array( "image/x-portable-graymap" ), "ppm" => array( "image/x-portable-pixmap" ), "rgb" => array( "image/x-rgb" ), "xbm" => array( "image/x-xbitmap" ), "xpm" => array( "image/x-xpixmap" ), "xwd" => array( "image/x-xwindowdump" ), "eml" => array( "message/rfc822" ), "igs" => array( "model/iges" ), "iges" => array( "model/iges" ), "msh" => array( "model/mesh" ), "mesh" => array( "model/mesh" ), "silo" => array( "model/mesh" ), "wrl" => array( "model/vrml", "x-world/x-vrml" ), "vrml" => array( "model/vrml", "x-world/x-vrml" ), "x3dv" => array( "model/x3d+vrml" ), "x3d" => array( "model/x3d+xml" ), "x3db" => array( "model/x3d+binary" ), "appcache" => array( "text/cache-manifest" ), "ics" => array( "text/calendar" ), "icz" => array( "text/calendar" ), "css" => array( "text/css" ), "csv" => array( "text/csv~~" ), "323" => array( "text/h323" ), "html" => array( "text/html" ), "htm" => array( "text/html" ), "shtml" => array( "text/html" ), "uls" => array( "text/iuls" ), "mml" => array( "text/mathml" ), "md" => array( "text/markdown" ), "markdown" => array( "text/markdown" ), "asc" => array( "text/plain" ), "txt" => array( "text/plain" ), "text" => array( "text/plain" ), "pot" => array( "text/plain" ), "brf" => array( "text/plain" ), "srt" => array( "text/plain" ), "rtx" => array( "text/richtext" ), "sct" => array( "text/scriptlet" ), "wsc" => array( "text/scriptlet" ), "tm" => array( "text/texmacs" ), "tsv" => array( "text/tab-separated-values" ), "ttl" => array( "text/turtle" ), "vcf" => array( "text/vcard" ), "vcard" => array( "text/vcard" ), "jad" => array( "text/vnd.sun.j2me.app-descriptor" ), "wml" => array( "text/vnd.wap.wml" ), "wmls" => array( "text/vnd.wap.wmlscript" ), "bib" => array( "text/x-bibtex" ), "boo" => array( "text/x-boo" ), "h++" => array( "text/x-c++hdr" ), "hpp" => array( "text/x-c++hdr" ), "hxx" => array( "text/x-c++hdr" ), "hh" => array( "text/x-c++hdr" ), "c++" => array( "text/x-c++src" ), "cpp" => array( "text/x-c++src" ), "cxx" => array( "text/x-c++src" ), "cc" => array( "text/x-c++src" ), "h" => array( "text/x-chdr" ), "htc" => array( "text/x-component" ), "c" => array( "text/x-csrc" ), "d" => array( "text/x-dsrc" ), "diff" => array( "text/x-diff" ), "patch" => array( "text/x-diff" ), "hs" => array( "text/x-haskell" ), "java" => array( "text/x-java" ), "ly" => array( "text/x-lilypond" ), "lhs" => array( "text/x-literate-haskell" ), "moc" => array( "text/x-moc" ), "p" => array( "text/x-pascal" ), "pas" => array( "text/x-pascal" ), "gcd" => array( "text/x-pcs-gcd" ), "pl" => array( "text/x-perl" ), "pm" => array( "text/x-perl" ), "py" => array( "text/x-python" ), "scala" => array( "text/x-scala" ), "etx" => array( "text/x-setext" ), "sfv" => array( "text/x-sfv" ), "tk" => array( "text/x-tcl" ), "tex" => array( "text/x-tex" ), "ltx" => array( "text/x-tex" ), "sty" => array( "text/x-tex" ), "cls" => array( "text/x-tex" ), "vcs" => array( "text/x-vcalendar" ), "3gp" => array( "video/3gpp" ), "axv" => array( "video/annodex" ), "dl" => array( "video/dl" ), "dif" => array( "video/dv" ), "dv" => array( "video/dv" ), "fli" => array( "video/fli" ), "gl" => array( "video/gl" ), "mpeg" => array( "video/mpeg" ), "mpg" => array( "video/mpeg" ), "mpe" => array( "video/mpeg" ), "ts" => array( "video/mp2t" ), "mp4" => array( "video/mp4" ), "qt" => array( "video/quicktime" ), "mov" => array( "video/quicktime" ), "ogv" => array( "video/ogg" ), "webm" => array( "video/webm" ), "mxu" => array( "video/vnd.mpegurl" ), "flv" => array( "video/x-flv" ), "lsf" => array( "video/x-la-asf" ), "lsx" => array( "video/x-la-asf" ), "mng" => array( "video/x-mng" ), "asf" => array( "video/x-ms-asf" ), "asx" => array( "video/x-ms-asf" ), "wm" => array( "video/x-ms-wm" ), "wmv" => array( "video/x-ms-wmv" ), "wmx" => array( "video/x-ms-wmx" ), "wvx" => array( "video/x-ms-wvx" ), "avi" => array( "video/x-msvideo" ), "movie" => array( "video/x-sgi-movie" ), "mpv" => array( "video/x-matroska" ), "mkv" => array( "video/x-matroska" ), "ice" => array( "x-conference/x-cooltalk" ), "sisx" => array( "x-epoc/x-sisx-app" ), "vrm" => array( "x-world/x-vrml" ) ); |
  |  | 49 | $list = array( "ez" => array( "application/andrew-inset" ), "anx" => array( "application/annodex" ), "atom" => array( "application/atom+xml" ), "atomcat" => array( "application/atomcat+xml" ), "atomsrv" => array( "application/atomserv+xml" ), "lin" => array( "application/bbolin" ), "cu" => array( "application/cu-seeme" ), "davmount" => array( "application/davmount+xml" ), "dcm" => array( "application/dicom" ), "tsp" => array( "application/dsptype" ), "es" => array( "application/ecmascript" ), "epub" => array( "application/epub+zip" ), "otf" => array( "application/font-sfnt", "font/otf", "font/sfnt", "font/ttf" ), "ttf" => array( "application/font-sfnt", "font/otf", "font/sfnt", "font/ttf" ), "pfr" => array( "application/font-tdpfr" ), "woff" => array( "application/font-woff", "font/woff" ), "spl" => array( "application/futuresplash", "application/x-futuresplash" ), "gz" => array( "application/gzip" ), "hta" => array( "application/hta" ), "jar" => array( "application/java-archive" ), "ser" => array( "application/java-serialized-object" ), "class" => array( "application/java-vm" ), "js" => array( "application/javascript" ), "json" => array( "application/json" ), "m3g" => array( "application/m3g" ), "hqx" => array( "application/mac-binhex40" ), "cpt" => array( "application/mac-compactpro", "image/x-corelphotopaint" ), "nb" => array( "application/mathematica" ), "nbp" => array( "application/mathematica" ), "mbox" => array( "application/mbox" ), "mdb" => array( "application/msaccess" ), "doc" => array( "application/msword" ), "dot" => array( "application/msword" ), "mxf" => array( "application/mxf" ), "bin" => array( "application/octet-stream" ), "deploy" => array( "application/octet-stream" ), "msu" => array( "application/octet-stream" ), "msp" => array( "application/octet-stream" ), "oda" => array( "application/oda" ), "opf" => array( "application/oebps-package+xml" ), "ogx" => array( "application/ogg" ), "one" => array( "application/onenote" ), "onetoc2" => array( "application/onenote" ), "onetmp" => array( "application/onenote" ), "onepkg" => array( "application/onenote" ), "pdf" => array( "application/pdf" ), "pgp" => array( "application/pgp-encrypted" ), "key" => array( "application/pgp-keys" ), "sig" => array( "application/pgp-signature" ), "prf" => array( "application/pics-rules" ), "ps" => array( "application/postscript" ), "ai" => array( "application/postscript" ), "eps" => array( "application/postscript" ), "epsi" => array( "application/postscript" ), "epsf" => array( "application/postscript" ), "eps2" => array( "application/postscript" ), "eps3" => array( "application/postscript" ), "rar" => array( "application/rar" ), "rdf" => array( "application/rdf+xml" ), "rtf" => array( "application/rtf" ), "stl" => array( "application/sla" ), "smi" => array( "application/smil+xml" ), "smil" => array( "application/smil+xml" ), "xhtml" => array( "application/xhtml+xml" ), "xht" => array( "application/xhtml+xml" ), "xml" => array( "application/xml", "text/xml" ), "xsd" => array( "application/xml" ), "xsl" => array( "application/xslt+xml" ), "xslt" => array( "application/xslt+xml" ), "xspf" => array( "application/xspf+xml" ), "zip" => array( "application/zip" ), "apk" => array( "application/vnd.android.package-archive" ), "cdy" => array( "application/vnd.cinderella" ), "deb" => array( "application/vnd.debian.binary-package", "application/x-debian-package" ), "ddeb" => array( "application/vnd.debian.binary-package" ), "udeb" => array( "application/vnd.debian.binary-package", "application/x-debian-package" ), "sfd" => array( "application/vnd.font-fontforge-sfd" ), "kml" => array( "application/vnd.google-earth.kml+xml" ), "kmz" => array( "application/vnd.google-earth.kmz" ), "xul" => array( "application/vnd.mozilla.xul+xml" ), "xls" => array( "application/vnd.ms-excel" ), "xlb" => array( "application/vnd.ms-excel" ), "xlt" => array( "application/vnd.ms-excel" ), "xlam" => array( "application/vnd.ms-excel.addin.macroenabled.12" ), "xlsb" => array( "application/vnd.ms-excel.sheet.binary.macroenabled.12" ), "xlsm" => array( "application/vnd.ms-excel.sheet.macroenabled.12" ), "xltm" => array( "application/vnd.ms-excel.template.macroenabled.12" ), "eot" => array( "application/vnd.ms-fontobject" ), "thmx" => array( "application/vnd.ms-officetheme" ), "cat" => array( "application/vnd.ms-pki.seccat" ), "ppt" => array( "application/vnd.ms-powerpoint" ), "pps" => array( "application/vnd.ms-powerpoint" ), "ppam" => array( "application/vnd.ms-powerpoint.addin.macroenabled.12" ), "pptm" => array( "application/vnd.ms-powerpoint.presentation.macroenabled.12" ), "sldm" => array( "application/vnd.ms-powerpoint.slide.macroenabled.12" ), "ppsm" => array( "application/vnd.ms-powerpoint.slideshow.macroenabled.12" ), "potm" => array( "application/vnd.ms-powerpoint.template.macroenabled.12" ), "docm" => array( "application/vnd.ms-word.document.macroenabled.12" ), "dotm" => array( "application/vnd.ms-word.template.macroenabled.12" ), "odc" => array( "application/vnd.oasis.opendocument.chart" ), "odb" => array( "application/vnd.oasis.opendocument.database" ), "odf" => array( "application/vnd.oasis.opendocument.formula" ), "odg" => array( "application/vnd.oasis.opendocument.graphics" ), "otg" => array( "application/vnd.oasis.opendocument.graphics-template" ), "odi" => array( "application/vnd.oasis.opendocument.image" ), "odp" => array( "application/vnd.oasis.opendocument.presentation" ), "otp" => array( "application/vnd.oasis.opendocument.presentation-template" ), "ods" => array( "application/vnd.oasis.opendocument.spreadsheet" ), "ots" => array( "application/vnd.oasis.opendocument.spreadsheet-template" ), "odt" => array( "application/vnd.oasis.opendocument.text" ), "odm" => array( "application/vnd.oasis.opendocument.text-master" ), "ott" => array( "application/vnd.oasis.opendocument.text-template" ), "oth" => array( "application/vnd.oasis.opendocument.text-web" ), "pptx" => array( "application/vnd.openxmlformats-officedocument.presentationml.presentation" ), "sldx" => array( "application/vnd.openxmlformats-officedocument.presentationml.slide" ), "ppsx" => array( "application/vnd.openxmlformats-officedocument.presentationml.slideshow" ), "potx" => array( "application/vnd.openxmlformats-officedocument.presentationml.template" ), "xlsx" => array( "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" ), "xltx" => array( "application/vnd.openxmlformats-officedocument.spreadsheetml.template" ), "docx" => array( "application/vnd.openxmlformats-officedocument.wordprocessingml.document" ), "dotx" => array( "application/vnd.openxmlformats-officedocument.wordprocessingml.template" ), "cod" => array( "application/vnd.rim.cod" ), "mmf" => array( "application/vnd.smaf" ), "sdc" => array( "application/vnd.stardivision.calc" ), "sds" => array( "application/vnd.stardivision.chart" ), "sda" => array( "application/vnd.stardivision.draw" ), "sdd" => array( "application/vnd.stardivision.impress" ), "sdf" => array( "application/vnd.stardivision.math", "chemical/x-mdl-sdfile" ), "sdw" => array( "application/vnd.stardivision.writer" ), "sgl" => array( "application/vnd.stardivision.writer-global" ), "sxc" => array( "application/vnd.sun.xml.calc" ), "stc" => array( "application/vnd.sun.xml.calc.template" ), "sxd" => array( "application/vnd.sun.xml.draw" ), "std" => array( "application/vnd.sun.xml.draw.template" ), "sxi" => array( "application/vnd.sun.xml.impress" ), "sti" => array( "application/vnd.sun.xml.impress.template" ), "sxm" => array( "application/vnd.sun.xml.math" ), "sxw" => array( "application/vnd.sun.xml.writer" ), "sxg" => array( "application/vnd.sun.xml.writer.global" ), "stw" => array( "application/vnd.sun.xml.writer.template" ), "sis" => array( "application/vnd.symbian.install" ), "cap" => array( "application/vnd.tcpdump.pcap" ), "pcap" => array( "application/vnd.tcpdump.pcap" ), "vsd" => array( "application/vnd.visio" ), "vst" => array( "application/vnd.visio" ), "vsw" => array( "application/vnd.visio" ), "vss" => array( "application/vnd.visio" ), "wbxml" => array( "application/vnd.wap.wbxml" ), "wmlc" => array( "application/vnd.wap.wmlc" ), "wmlsc" => array( "application/vnd.wap.wmlscriptc" ), "wpd" => array( "application/vnd.wordperfect" ), "wp5" => array( "application/vnd.wordperfect5.1" ), "wk" => array( "application/x-123" ), "7z" => array( "application/x-7z-compressed" ), "abw" => array( "application/x-abiword" ), "dmg" => array( "application/x-apple-diskimage" ), "bcpio" => array( "application/x-bcpio" ), "torrent" => array( "application/x-bittorrent" ), "cab" => array( "application/x-cab" ), "cbr" => array( "application/x-cbr" ), "cbz" => array( "application/x-cbz" ), "cdf" => array( "application/x-cdf" ), "cda" => array( "application/x-cdf" ), "vcd" => array( "application/x-cdlink" ), "pgn" => array( "application/x-chess-pgn" ), "mph" => array( "application/x-comsol" ), "cpio" => array( "application/x-cpio" ), "csh" => array( "application/x-csh", "text/x-csh" ), "dcr" => array( "application/x-director" ), "dir" => array( "application/x-director" ), "dxr" => array( "application/x-director" ), "dms" => array( "application/x-dms" ), "wad" => array( "application/x-doom" ), "dvi" => array( "application/x-dvi" ), "pfa" => array( "application/x-font" ), "pfb" => array( "application/x-font" ), "gsf" => array( "application/x-font" ), "pcf" => array( "application/x-font-pcf" ), "pcf.z" => array( "application/x-font-pcf" ), "mm" => array( "application/x-freemind" ), "gan" => array( "application/x-ganttproject" ), "gnumeric" => array( "application/x-gnumeric" ), "sgf" => array( "application/x-go-sgf" ), "gcf" => array( "application/x-graphing-calculator" ), "gtar" => array( "application/x-gtar" ), "tgz" => array( "application/x-gtar-compressed" ), "taz" => array( "application/x-gtar-compressed" ), "hdf" => array( "application/x-hdf" ), "hwp" => array( "application/x-hwp" ), "ica" => array( "application/x-ica" ), "info" => array( "application/x-info" ), "ins" => array( "application/x-internet-signup" ), "isp" => array( "application/x-internet-signup" ), "iii" => array( "application/x-iphone" ), "iso" => array( "application/x-iso9660-image" ), "jam" => array( "application/x-jam" ), "jnlp" => array( "application/x-java-jnlp-file" ), "jmz" => array( "application/x-jmol" ), "chrt" => array( "application/x-kchart" ), "kil" => array( "application/x-killustrator" ), "skp" => array( "application/x-koan" ), "skd" => array( "application/x-koan" ), "skt" => array( "application/x-koan" ), "skm" => array( "application/x-koan" ), "kpr" => array( "application/x-kpresenter" ), "kpt" => array( "application/x-kpresenter" ), "ksp" => array( "application/x-kspread" ), "kwd" => array( "application/x-kword" ), "kwt" => array( "application/x-kword" ), "latex" => array( "application/x-latex" ), "lha" => array( "application/x-lha" ), "lyx" => array( "application/x-lyx" ), "lzh" => array( "application/x-lzh" ), "lzx" => array( "application/x-lzx" ), "frm" => array( "application/x-maker" ), "maker" => array( "application/x-maker" ), "frame" => array( "application/x-maker" ), "fm" => array( "application/x-maker" ), "fb" => array( "application/x-maker" ), "book" => array( "application/x-maker" ), "fbdoc" => array( "application/x-maker" ), "mif" => array( "application/x-mif" ), "m3u8" => array( "application/x-mpegurl" ), "application" => array( "application/x-ms-application" ), "manifest" => array( "application/x-ms-manifest" ), "wmd" => array( "application/x-ms-wmd" ), "wmz" => array( "application/x-ms-wmz" ), "com" => array( "application/x-msdos-program" ), "exe" => array( "application/x-msdos-program" ), "bat" => array( "application/x-msdos-program" ), "dll" => array( "application/x-msdos-program" ), "msi" => array( "application/x-msi" ), "nc" => array( "application/x-netcdf" ), "pac" => array( "application/x-ns-proxy-autoconfig" ), "nwc" => array( "application/x-nwc" ), "o" => array( "application/x-object" ), "oza" => array( "application/x-oz-application" ), "p7r" => array( "application/x-pkcs7-certreqresp" ), "crl" => array( "application/x-pkcs7-crl" ), "pyc" => array( "application/x-python-code" ), "pyo" => array( "application/x-python-code" ), "qgs" => array( "application/x-qgis" ), "shp" => array( "application/x-qgis" ), "shx" => array( "application/x-qgis" ), "qtl" => array( "application/x-quicktimeplayer" ), "rdp" => array( "application/x-rdp" ), "rpm" => array( "application/x-redhat-package-manager" ), "rss" => array( "application/x-rss+xml" ), "rb" => array( "application/x-ruby" ), "sci" => array( "application/x-scilab" ), "sce" => array( "application/x-scilab" ), "xcos" => array( "application/x-scilab-xcos" ), "sh" => array( "application/x-sh", "text/x-sh" ), "shar" => array( "application/x-shar" ), "swf" => array( "application/x-shockwave-flash" ), "swfl" => array( "application/x-shockwave-flash" ), "scr" => array( "application/x-silverlight" ), "sql" => array( "application/x-sql" ), "sit" => array( "application/x-stuffit" ), "sitx" => array( "application/x-stuffit" ), "sv4cpio" => array( "application/x-sv4cpio" ), "sv4crc" => array( "application/x-sv4crc" ), "tar" => array( "application/x-tar" ), "tcl" => array( "application/x-tcl", "text/x-tcl" ), "gf" => array( "application/x-tex-gf" ), "pk" => array( "application/x-tex-pk" ), "texinfo" => array( "application/x-texinfo" ), "texi" => array( "application/x-texinfo" ), "~" => array( "application/x-trash" ), "%" => array( "application/x-trash" ), "bak" => array( "application/x-trash" ), "old" => array( "application/x-trash" ), "sik" => array( "application/x-trash" ), "t" => array( "application/x-troff" ), "tr" => array( "application/x-troff" ), "roff" => array( "application/x-troff" ), "man" => array( "application/x-troff-man" ), "me" => array( "application/x-troff-me" ), "ms" => array( "application/x-troff-ms" ), "ustar" => array( "application/x-ustar" ), "src" => array( "application/x-wais-source" ), "wz" => array( "application/x-wingz" ), "crt" => array( "application/x-x509-ca-cert" ), "xcf" => array( "application/x-xcf" ), "fig" => array( "application/x-xfig" ), "xpi" => array( "application/x-xpinstall" ), "xz" => array( "application/x-xz" ), "amr" => array( "audio/amr" ), "awb" => array( "audio/amr-wb" ), "axa" => array( "audio/annodex" ), "au" => array( "audio/basic" ), "snd" => array( "audio/basic" ), "csd" => array( "audio/csound" ), "orc" => array( "audio/csound" ), "sco" => array( "audio/csound" ), "flac" => array( "audio/flac" ), "mid" => array( "audio/midi" ), "midi" => array( "audio/midi" ), "kar" => array( "audio/midi" ), "mpga" => array( "audio/mpeg" ), "mpega" => array( "audio/mpeg" ), "mp2" => array( "audio/mpeg" ), "mp3" => array( "audio/mpeg" ), "m4a" => array( "audio/mpeg", "audio/x-m4a" ), "m3u" => array( "audio/mpegurl", "audio/x-mpegurl" ), "oga" => array( "audio/ogg" ), "ogg" => array( "audio/ogg" ), "opus" => array( "audio/ogg" ), "spx" => array( "audio/ogg" ), "sid" => array( "audio/prs.sid" ), "aif" => array( "audio/x-aiff" ), "aiff" => array( "audio/x-aiff" ), "aifc" => array( "audio/x-aiff" ), "gsm" => array( "audio/x-gsm" ), "wma" => array( "audio/x-ms-wma" ), "wax" => array( "audio/x-ms-wax" ), "ra" => array( "audio/x-pn-realaudio", "audio/x-realaudio" ), "rm" => array( "audio/x-pn-realaudio" ), "ram" => array( "audio/x-pn-realaudio" ), "pls" => array( "audio/x-scpls" ), "sd2" => array( "audio/x-sd2" ), "wav" => array( "audio/x-wav" ), "alc" => array( "chemical/x-alchemy" ), "cac" => array( "chemical/x-cache" ), "cache" => array( "chemical/x-cache" ), "csf" => array( "chemical/x-cache-csf" ), "cbin" => array( "chemical/x-cactvs-binary" ), "cascii" => array( "chemical/x-cactvs-binary" ), "ctab" => array( "chemical/x-cactvs-binary" ), "cdx" => array( "chemical/x-cdx" ), "cer" => array( "chemical/x-cerius" ), "c3d" => array( "chemical/x-chem3d" ), "chm" => array( "chemical/x-chemdraw" ), "cif" => array( "chemical/x-cif" ), "cmdf" => array( "chemical/x-cmdf" ), "cml" => array( "chemical/x-cml" ), "cpa" => array( "chemical/x-compass" ), "bsd" => array( "chemical/x-crossfire" ), "csml" => array( "chemical/x-csml" ), "csm" => array( "chemical/x-csml" ), "ctx" => array( "chemical/x-ctx" ), "cxf" => array( "chemical/x-cxf" ), "cef" => array( "chemical/x-cxf" ), "emb" => array( "chemical/x-embl-dl-nucleotide" ), "embl" => array( "chemical/x-embl-dl-nucleotide" ), "spc" => array( "chemical/x-galactic-spc" ), "inp" => array( "chemical/x-gamess-input" ), "gam" => array( "chemical/x-gamess-input" ), "gamin" => array( "chemical/x-gamess-input" ), "fch" => array( "chemical/x-gaussian-checkpoint" ), "fchk" => array( "chemical/x-gaussian-checkpoint" ), "cub" => array( "chemical/x-gaussian-cube" ), "gau" => array( "chemical/x-gaussian-input" ), "gjc" => array( "chemical/x-gaussian-input" ), "gjf" => array( "chemical/x-gaussian-input" ), "gal" => array( "chemical/x-gaussian-log" ), "gcg" => array( "chemical/x-gcg8-sequence" ), "gen" => array( "chemical/x-genbank" ), "hin" => array( "chemical/x-hin" ), "istr" => array( "chemical/x-isostar" ), "ist" => array( "chemical/x-isostar" ), "jdx" => array( "chemical/x-jcamp-dx" ), "dx" => array( "chemical/x-jcamp-dx" ), "kin" => array( "chemical/x-kinemage" ), "mcm" => array( "chemical/x-macmolecule" ), "mmd" => array( "chemical/x-macromodel-input" ), "mmod" => array( "chemical/x-macromodel-input" ), "mol" => array( "chemical/x-mdl-molfile" ), "rd" => array( "chemical/x-mdl-rdfile" ), "rxn" => array( "chemical/x-mdl-rxnfile" ), "sd" => array( "chemical/x-mdl-sdfile" ), "tgf" => array( "chemical/x-mdl-tgf" ), "mcif" => array( "chemical/x-mmcif" ), "mol2" => array( "chemical/x-mol2" ), "b" => array( "chemical/x-molconn-z" ), "gpt" => array( "chemical/x-mopac-graph" ), "mop" => array( "chemical/x-mopac-input" ), "mopcrt" => array( "chemical/x-mopac-input" ), "mpc" => array( "chemical/x-mopac-input" ), "zmt" => array( "chemical/x-mopac-input" ), "moo" => array( "chemical/x-mopac-out" ), "mvb" => array( "chemical/x-mopac-vib" ), "asn" => array( "chemical/x-ncbi-asn1", "chemical/x-ncbi-asn1-spec" ), "prt" => array( "chemical/x-ncbi-asn1-ascii" ), "ent" => array( "chemical/x-ncbi-asn1-ascii", "chemical/x-pdb" ), "val" => array( "chemical/x-ncbi-asn1-binary" ), "aso" => array( "chemical/x-ncbi-asn1-binary" ), "pdb" => array( "chemical/x-pdb" ), "ros" => array( "chemical/x-rosdal" ), "sw" => array( "chemical/x-swissprot" ), "vms" => array( "chemical/x-vamas-iso14976" ), "vmd" => array( "chemical/x-vmd" ), "xtel" => array( "chemical/x-xtel" ), "xyz" => array( "chemical/x-xyz" ), "ttc" => array( "font/collection" ), "woff2" => array( "font/woff2" ), "gif" => array( "image/gif" ), "ief" => array( "image/ief" ), "jp2" => array( "image/jp2" ), "jpg2" => array( "image/jp2" ), "jpeg" => array( "image/jpeg" ), "jpg" => array( "image/jpeg" ), "jpe" => array( "image/jpeg" ), "jpm" => array( "image/jpm" ), "jpx" => array( "image/jpx" ), "jpf" => array( "image/jpx" ), "pcx" => array( "image/pcx" ), "png" => array( "image/png" ), "svg" => array( "image/svg+xml" ), "svgz" => array( "image/svg+xml" ), "tiff" => array( "image/tiff" ), "tif" => array( "image/tiff" ), "djvu" => array( "image/vnd.djvu" ), "djv" => array( "image/vnd.djvu" ), "ico" => array( "image/vnd.microsoft.icon" ), "wbmp" => array( "image/vnd.wap.wbmp" ), "cr2" => array( "image/x-canon-cr2" ), "crw" => array( "image/x-canon-crw" ), "ras" => array( "image/x-cmu-raster" ), "cdr" => array( "image/x-coreldraw" ), "pat" => array( "image/x-coreldrawpattern" ), "cdt" => array( "image/x-coreldrawtemplate" ), "erf" => array( "image/x-epson-erf" ), "art" => array( "image/x-jg" ), "jng" => array( "image/x-jng" ), "bmp" => array( "image/x-ms-bmp" ), "nef" => array( "image/x-nikon-nef" ), "orf" => array( "image/x-olympus-orf" ), "psd" => array( "image/x-photoshop" ), "pnm" => array( "image/x-portable-anymap" ), "pbm" => array( "image/x-portable-bitmap" ), "pgm" => array( "image/x-portable-graymap" ), "ppm" => array( "image/x-portable-pixmap" ), "rgb" => array( "image/x-rgb" ), "xbm" => array( "image/x-xbitmap" ), "xpm" => array( "image/x-xpixmap" ), "xwd" => array( "image/x-xwindowdump" ), "eml" => array( "message/rfc822" ), "igs" => array( "model/iges" ), "iges" => array( "model/iges" ), "msh" => array( "model/mesh" ), "mesh" => array( "model/mesh" ), "silo" => array( "model/mesh" ), "wrl" => array( "model/vrml", "x-world/x-vrml" ), "vrml" => array( "model/vrml", "x-world/x-vrml" ), "x3dv" => array( "model/x3d+vrml" ), "x3d" => array( "model/x3d+xml" ), "x3db" => array( "model/x3d+binary" ), "appcache" => array( "text/cache-manifest" ), "ics" => array( "text/calendar" ), "icz" => array( "text/calendar" ), "css" => array( "text/css" ), "csv" => array( "text/csv", "text/plain" ), "323" => array( "text/h323" ), "html" => array( "text/html" ), "htm" => array( "text/html" ), "shtml" => array( "text/html" ), "uls" => array( "text/iuls" ), "mml" => array( "text/mathml" ), "md" => array( "text/markdown" ), "markdown" => array( "text/markdown" ), "asc" => array( "text/plain" ), "txt" => array( "text/plain" ), "text" => array( "text/plain" ), "pot" => array( "text/plain" ), "brf" => array( "text/plain" ), "srt" => array( "text/plain" ), "rtx" => array( "text/richtext" ), "sct" => array( "text/scriptlet" ), "wsc" => array( "text/scriptlet" ), "tm" => array( "text/texmacs" ), "tsv" => array( "text/tab-separated-values" ), "ttl" => array( "text/turtle" ), "vcf" => array( "text/vcard" ), "vcard" => array( "text/vcard" ), "jad" => array( "text/vnd.sun.j2me.app-descriptor" ), "wml" => array( "text/vnd.wap.wml" ), "wmls" => array( "text/vnd.wap.wmlscript" ), "bib" => array( "text/x-bibtex" ), "boo" => array( "text/x-boo" ), "h++" => array( "text/x-c++hdr" ), "hpp" => array( "text/x-c++hdr" ), "hxx" => array( "text/x-c++hdr" ), "hh" => array( "text/x-c++hdr" ), "c++" => array( "text/x-c++src" ), "cpp" => array( "text/x-c++src" ), "cxx" => array( "text/x-c++src" ), "cc" => array( "text/x-c++src" ), "h" => array( "text/x-chdr" ), "htc" => array( "text/x-component" ), "c" => array( "text/x-csrc" ), "d" => array( "text/x-dsrc" ), "diff" => array( "text/x-diff" ), "patch" => array( "text/x-diff" ), "hs" => array( "text/x-haskell" ), "java" => array( "text/x-java" ), "ly" => array( "text/x-lilypond" ), "lhs" => array( "text/x-literate-haskell" ), "moc" => array( "text/x-moc" ), "p" => array( "text/x-pascal" ), "pas" => array( "text/x-pascal" ), "gcd" => array( "text/x-pcs-gcd" ), "pl" => array( "text/x-perl" ), "pm" => array( "text/x-perl" ), "py" => array( "text/x-python" ), "scala" => array( "text/x-scala" ), "etx" => array( "text/x-setext" ), "sfv" => array( "text/x-sfv" ), "tk" => array( "text/x-tcl" ), "tex" => array( "text/x-tex" ), "ltx" => array( "text/x-tex" ), "sty" => array( "text/x-tex" ), "cls" => array( "text/x-tex" ), "vcs" => array( "text/x-vcalendar" ), "3gp" => array( "video/3gpp" ), "axv" => array( "video/annodex" ), "dl" => array( "video/dl" ), "dif" => array( "video/dv" ), "dv" => array( "video/dv" ), "fli" => array( "video/fli" ), "gl" => array( "video/gl" ), "mpeg" => array( "video/mpeg" ), "mpg" => array( "video/mpeg" ), "mpe" => array( "video/mpeg" ), "ts" => array( "video/mp2t" ), "mp4" => array( "video/mp4" ), "qt" => array( "video/quicktime" ), "mov" => array( "video/quicktime" ), "ogv" => array( "video/ogg" ), "webm" => array( "video/webm" ), "mxu" => array( "video/vnd.mpegurl" ), "flv" => array( "video/x-flv" ), "lsf" => array( "video/x-la-asf" ), "lsx" => array( "video/x-la-asf" ), "mng" => array( "video/x-mng" ), "asf" => array( "video/x-ms-asf" ), "asx" => array( "video/x-ms-asf" ), "wm" => array( "video/x-ms-wm" ), "wmv" => array( "video/x-ms-wmv" ), "wmx" => array( "video/x-ms-wmx" ), "wvx" => array( "video/x-ms-wvx" ), "avi" => array( "video/x-msvideo" ), "movie" => array( "video/x-sgi-movie" ), "mpv" => array( "video/x-matroska" ), "mkv" => array( "video/x-matroska" ), "ice" => array( "x-conference/x-cooltalk" ), "sisx" => array( "x-epoc/x-sisx-app" ), "vrm" => array( "x-world/x-vrml" ) ); |
  | 50 | 50 |  |
  | 51 | 51 | /\*\* |
* ## [wp-file-upload/trunk/readme.txt](/changeset/3164449/wp-file-upload/trunk/readme.txt "Show the changeset 3164449 restricted to wp-file-upload/trunk/readme.txt")

  | [r3146594](/browser/wp-file-upload/trunk/readme.txt?rev=3146594#L4 "Show revision 3146594 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/readme.txt?rev=3164449#L4 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: file, upload, ajax, form, page, post, sidebar, responsive, widget, webcam, ftp |
  | 5 | 5 | Requires at least: 2.9.2 |
  | 6 |  | Tested up to: 6.6.~~1~~ |
  |  | 6 | Tested up to: 6.6.2 |
  | 7 | 7 | Stable tag: "trunk" |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/wp-file-upload/trunk/readme.txt?rev=3146594#L150) | […](/browser/wp-file-upload/trunk/readme.txt?rev=3164449#L150) |  |
  | 150 | 150 |  |
  | 151 | 151 | == Changelog == |
  |  | 152 |  |
  |  | 153 | = 4.24.12 = |
  |  | 154 | \* verified compatibility with Wordpress version 6.6.2 |
  |  | 155 | \* fixed directory traversal security issue in wfu\_file\_downloader.php file |
  |  | 156 | \* extended csv, xml and m4a mime types |
  | 152 | 157 |  |
  | 153 | 158 | = 4.24.11 = |
  | […](/browser/wp-file-upload/trunk/readme.txt?rev=3146594#L1053) | […](/browser/wp-file-upload/trunk/readme.txt?rev=3164449#L1058) |  |
  | 1053 | 1058 | == Upgrade Notice == |
  | 1054 | 1059 |  |
  |  | 1060 | = 4.24.12 = |
  |  | 1061 | Minor update to fix some security issues. |
  |  | 1062 |  |
  | 1055 | 1063 | = 4.24.11 = |
  | 1056 | 1064 | Minor update to fix some bugs. |
* ## [wp-file-upload/trunk/release\_notes.txt](/changeset/3164449/wp-file-upload/trunk/release_notes.txt "Show the changeset 3164449 restricted to wp-file-upload/trunk/release_notes.txt")

  | [r3146594](/browser/wp-file-upload/trunk/release_notes.txt?rev=3146594#L1 "Show revision 3146594 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/release_notes.txt?rev=3164449#L1 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <!--  --> |
  | 2 | 2 | <div class="wfu-releasenotes-container"> |
  | 3 |  | <span><strong>Version 4.24.1~~1</strong> is a minor update that fixes a bug where files with extensions containing capital letters were rejected due to MIME check failure~~.<br /><br /> |
  |  | 3 | <span><strong>Version 4.24.12</strong> is a minor update that fixes a security issue in the download function of the plugin.<br /><br /> |
  | 4 | 4 | Please note that since Version 4.24.0 the <strong>Professional</strong> version of the plugin introduces some significant changes, such as <strong>licensing</strong> and <strong>external extensions</strong>. |
  | 5 | 5 | <br /><br /> |
* ## [wp-file-upload/trunk/wfu\_file\_downloader.php](/changeset/3164449/wp-file-upload/trunk/wfu_file_downloader.php "Show the changeset 3164449 restricted to wp-file-upload/trunk/wfu_file_downloader.php")

  | [r3004967](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L19 "Show revision 3004967 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L19 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | } |
  | 20 | 20 |  |
  |  | 21 | /\*\* |
  |  | 22 | \* Download a File. |
  |  | 23 | \* |
  |  | 24 | \* This function causes a file to be downloaded. |
  |  | 25 | \* |
  |  | 26 | \* @global string $wfu\_user\_state\_handler The user state handler. |
  |  | 27 | \*/ |
  | 21 | 28 | function wfu\_download\_file() { |
  | 22 | 29 | global $wfu\_user\_state\_handler; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L46) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L53) |  |
  | 46 | 53 | //$filepath = wfu\_get\_filepath\_from\_safe($file\_code); |
  | 47 | 54 | $filepath = WFU\_USVAR\_downloader('wfu\_storage\_'.$file\_code); |
  |  | 55 | //validate the file path to avoid directory traversals that could lead |
  |  | 56 | //to deletion of the wrong file |
  |  | 57 | if ( !wfu\_validate\_storage\_filepath("exportdata", $filepath) ) die(); |
  | 48 | 58 | $disposition\_name = "wfu\_export.csv"; |
  | 49 | 59 | $delete\_file = true; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L123) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L133) |  |
  | 123 | 133 | } |
  | 124 | 134 |  |
  |  | 135 | /\*\* |
  |  | 136 | \* Update Download Status. |
  |  | 137 | \* |
  |  | 138 | \* Stores in user state the new download status. |
  |  | 139 | \* |
  |  | 140 | \* @param string $ticket The download ticket. |
  |  | 141 | \* @param string $new\_status The new download status. |
  |  | 142 | \*/ |
  | 125 | 143 | function wfu\_update\_download\_status($ticket, $new\_status) { |
  | 126 | 144 | require\_once WFU\_USVAR\_downloader('wfu\_ABSPATH').'wp-load.php'; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L128) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L146) |  |
  | 128 | 146 | } |
  | 129 | 147 |  |
  |  | 148 | /\*\* |
  |  | 149 | \* Check User State Variable For Existence. |
  |  | 150 | \* |
  |  | 151 | \* Checks whether a user state variable exists. |
  |  | 152 | \* |
  |  | 153 | \* @global string $wfu\_user\_state\_handler The user state handler. |
  |  | 154 | \* |
  |  | 155 | \* @param mixed $var The user state variable to check. |
  |  | 156 | \* @return bool True if it exists, false otherwise. |
  |  | 157 | \*/ |
  | 130 | 158 | function WFU\_USVAR\_exists\_downloader($var) { |
  | 131 | 159 | global $wfu\_user\_state\_handler; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L134) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L162) |  |
  | 134 | 162 | } |
  | 135 | 163 |  |
  |  | 164 | /\*\* |
  |  | 165 | \* Get User State Variable. |
  |  | 166 | \* |
  |  | 167 | \* Returns the value of a user state variable. The variable needs to exist. |
  |  | 168 | \* |
  |  | 169 | \* @global string $wfu\_user\_state\_handler The user state handler. |
  |  | 170 | \* |
  |  | 171 | \* @param mixed $var The user state variable to read. |
  |  | 172 | \* @return mixed The variable value. |
  |  | 173 | \*/ |
  | 136 | 174 | function WFU\_USVAR\_downloader($var) { |
  | 137 | 175 | global $wfu\_user\_state\_handler; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L140) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L178) |  |
  | 140 | 178 | } |
  | 141 | 179 |  |
  |  | 180 | /\*\* |
  |  | 181 | \* Unset User State Variable. |
  |  | 182 | \* |
  |  | 183 | \* Unsets a user state variable. |
  |  | 184 | \* |
  |  | 185 | \* @global string $wfu\_user\_state\_handler The user state handler. |
  |  | 186 | \* |
  |  | 187 | \* @param mixed $var The user state variable to unset. |
  |  | 188 | \*/ |
  | 142 | 189 | function WFU\_USVAR\_unset\_downloader($var) { |
  | 143 | 190 | global $wfu\_user\_state\_handler; |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L145) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L192) |  |
  | 145 | 192 | } |
  | 146 | 193 |  |
  |  | 194 | /\*\* |
  |  | 195 | \* Check for File Existence. |
  |  | 196 | \* |
  |  | 197 | \* Checks whether a file exists. |
  |  | 198 | \* |
  |  | 199 | \* @param string $filepath The full path of the file to check. |
  |  | 200 | \* @return bool True if the file exists, false otherwise. |
  |  | 201 | \*/ |
  | 147 | 202 | function wfu\_file\_exists\_for\_downloader($filepath) { |
  | 148 | 203 | if ( substr($filepath, 0, 7) != "sftp://" ) return file\_exists($filepath); |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L162) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L217) |  |
  | 162 | 217 | } |
  | 163 | 218 |  |
  |  | 219 | /\*\* |
  |  | 220 | \* Get File Size. |
  |  | 221 | \* |
  |  | 222 | \* Return the size of a file. |
  |  | 223 | \* |
  |  | 224 | \* @param string $filepath The full path of the file. |
  |  | 225 | \* @return int|bool The size of the file on success, false on failure. |
  |  | 226 | \*/ |
  | 164 | 227 | function wfu\_filesize\_for\_downloader($filepath) { |
  | 165 | 228 | if ( substr($filepath, 0, 7) != "sftp://" ) return filesize($filepath); |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L179) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L242) |  |
  | 179 | 242 | } |
  | 180 | 243 |  |
  |  | 244 | /\*\* |
  |  | 245 | \* Get File Handler. |
  |  | 246 | \* |
  |  | 247 | \* Returns a file handler for reading the contents of the file. If the file is |
  |  | 248 | \* in an FTP location, then it is first copied in a memory stream and the |
  |  | 249 | \* handler of the memory stream is returned. |
  |  | 250 | \* |
  |  | 251 | \* @param string $filepath The full path of the file. |
  |  | 252 | \* @param string $mode The reading mode. |
  |  | 253 | \* @return resource|bool The file handler on success, false on failure. |
  |  | 254 | \*/ |
  | 181 | 255 | function wfu\_fopen\_for\_downloader($filepath, $mode) { |
  | 182 | 256 | if ( substr($filepath, 0, 7) != "sftp://" ) return @fopen($filepath, $mode); |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L203) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L277) |  |
  | 203 | 277 | } |
  | 204 | 278 |  |
  |  | 279 | /\*\* |
  |  | 280 | \* Delete a File. |
  |  | 281 | \* |
  |  | 282 | \* Deletes a file. It also supports FTP locations. |
  |  | 283 | \* |
  |  | 284 | \* @param string $filepath The full file path of the file to delete. |
  |  | 285 | \* @return bool True on success, false otherwise. |
  |  | 286 | \*/ |
  | 205 | 287 | function wfu\_unlink\_for\_downloader($filepath) { |
  | 206 | 288 | if ( substr($filepath, 0, 7) != "sftp://" ) return @unlink($filepath); |
  | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3004967#L219) | […](/browser/wp-file-upload/trunk/wfu_file_downloader.php?rev=3164449#L301) |  |
  | 219 | 301 | return $ret; |
  | 220 | 302 | } |
  |  | 303 |  |
  |  | 304 | /\*\* |
  |  | 305 | \* Validate Storage Filepath. |
  |  | 306 | \* |
  |  | 307 | \* It validates the filepath that was retrieved from user state storage. For the |
  |  | 308 | \* moment it works only when the downloaded file is an export of the plugin's |
  |  | 309 | \* data. It validates that the retrieved filepath is the PHP temp path. |
  |  | 310 | \* |
  |  | 311 | \* @since 4.24.12 |
  |  | 312 | \* |
  |  | 313 | \* @param string $code The download code. |
  |  | 314 | \* @param string $filepath The retrieved full file path. |
  |  | 315 | \* @return bool True if validation has passed, false otherwise. |
  |  | 316 | \*/ |
  |  | 317 | function wfu\_validate\_storage\_filepath($code, $filepath) { |
  |  | 318 | $result = false; |
  |  | 319 | if ( $code === "exportdata" ) { |
  |  | 320 | $onlypath = wfu\_basedir($filepath); |
  |  | 321 | if ( substr($onlypath, -1) !== '/' ) $onlypath .= '/'; |
  |  | 322 | $exportpath = sys\_get\_temp\_dir(); |
  |  | 323 | if ( substr($exportpath, -1) !== '/' ) $exportpath .= '/'; |
  |  | 324 | $result = ( $onlypath === $exportpath ); |
  |  | 325 | } |
  |  | 326 | return $result; |
  |  | 327 | } |
* ## [wp-file-upload/trunk/wordpress\_file\_upload.php](/changeset/3164449/wp-file-upload/trunk/wordpress_file_upload.php "Show the changeset 3164449 restricted to wp-file-upload/trunk/wordpress_file_upload.php")

  | [r3146594](/browser/wp-file-upload/trunk/wordpress_file_upload.php?rev=3146594#L4 "Show revision 3146594 of this file in browser") | [r3164449](/browser/wp-file-upload/trunk/wordpress_file_upload.php?rev=3164449#L4 "Show revision 3164449 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://www.iptanus.com/support/wordpress-file-upload |
  | 5 | 5 | Description: Simple interface to upload files from a page. |
  | 6 |  | Version: 4.24.1~~1~~ |
  |  | 6 | Version: 4.24.12 |
  | 7 | 7 | Author: Nickolas Bossinas |
  | 8 | 8 | Author URI: https://www.iptanus.com/nickolas |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3164449)
* [Zip Archive](?format=zip&new=3164449)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

