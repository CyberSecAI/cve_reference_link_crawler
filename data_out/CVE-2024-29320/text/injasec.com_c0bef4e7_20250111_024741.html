

[![隠者 Inja Security](https://injasec.com/wp-content/uploads/2024/03/newlogo-1.png)隠者 Inja Security](https://injasec.com/ "隠者 Inja Security")

 Toggle Navigation

* [Home](https://injasec.com/ "Home")
* [~$ whoami](https://injasec.com/about/ "~$ whoami")

# CVE-2024-29320: SQL Injection in Wallos

#### Published by [**Matheus Boschetti**](https://injasec.com/author/injasec-com/) on April 4, 2024April 4, 2024

![](https://injasec.com/wp-content/uploads/2024/03/wallos-sql-cover.jpg)

**Introduction**

An open-source personal subscription tracker, **Wallos** designed to empower people to manage their finances with ease.

Wallos is written in PHP with a SQLite database, it has over 1.000 stars in [GitHub](https://github.com/ellite/Wallos) and over 100.00 downloads for its [Docker image](https://hub.docker.com/r/bellamy/wallos).

A quick search on Shodan reveals at least 66 public instances of Wallos.

![](https://injasec.com/wp-content/uploads/2024/03/shodan-1-1024x516.png)

**Initial Analysis**

Starting from the start. Taking a look at critical components, such as the authentication functionality, I’ve noticed that the developer was already following security best practices, such as the usage of prepared statements.

![](https://injasec.com/wp-content/uploads/2024/03/login-code-1024x341.png)

This *could* indicate that no low-hanging fruits could be found, however, humans are humans and mistakes are inevitable.

With that in mind, I started mapping out the application and noticed that previous vulnerabilities reported included things like [Cross-Site Scripting (XSS)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22776) and File Upload.

The application is rather simple, the interface doesn’t provide many options or complex functionality.

![](https://injasec.com/wp-content/uploads/2024/03/mainscreen-1024x481.png)

**Vulnerability Discovery**

By looking at the interface one can already note that the attack surface is rather small. The most obvious paths were already taken and fixed… what now?

Shifting focus back to the code, I started reviewing each implementation, and, to my surprise, one of the database interactions was lacking input validation and the usage of prepared statements.

![](https://injasec.com/wp-content/uploads/2024/03/sql-original-code-1024x660.png)

One can note that in both highlighted sections, the value from the category and payment GET parameters are passed directly into the query right below them.

**Exploitation**

Going back to dynamic analysis, one can build the request based on the code.

This should be a GET request, the endpoint will be the file itself as no MVC framework or similar is being used. Both parameters should be affected the same way, so one can be picked as the target.

![](https://injasec.com/wp-content/uploads/2024/03/burp1-1024x484.png)

As there are no items with the payment method provided, it didn’t return any data. A simple condition can then be introduced to force the database to return something based on a positive result.

![](https://injasec.com/wp-content/uploads/2024/03/burp2-1024x607.png)

Below is an example payload for extracting the password hash.

`UNION ALL SELECT NULL, group_concat(password), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM user`

![](https://injasec.com/wp-content/uploads/2024/04/sql_payload-1024x659.png)

This already confirms the vulnerability can be exploited. Throwing it on SQLmap produces the expected results.

![](https://injasec.com/wp-content/uploads/2024/03/sqlmap-1024x808.png)

**Closing Thoughts**

If you are using or hosting an instance of Wallos, the vulnerability can be easily fixed by upgrading to [version 1.16.0](https://github.com/ellite/Wallos/releases/tag/v1.16.0) or above.

**Timeline**

* **March 9th, 2024:** Vulnerability identified and reported via e-mail
* **March 9th, 2024:** CVE requested to MITRE
* **March 10th, 2024:** The vulnerability was mitigated overnight, version 1.16.0 was released with the fix
* **March 26th, 2024:** Feedback received from MITRE with the CVE assigned

**References**

* [Wallos – GitHub](https://github.com/ellite/Wallos)
* [Wallos – Docker Hub](https://hub.docker.com/r/bellamy/wallos)
* [SQL Injection – OWASP](https://owasp.org/www-community/attacks/SQL_Injection)
* [SQL Injection Prevention – OWASP](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
* [CVE-2024-29320 – MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-29320)

Categories: [Application Security](https://injasec.com/category/application-security/)[Open Source Software (OSS)](https://injasec.com/category/open-source-software-oss/)
Tags: [Application Security](https://injasec.com/tag/application-security/)[Open Source Software (OSS)](https://injasec.com/tag/open-source-software-oss/)

---

### 0 Comments

### Leave a Reply [Cancel reply](/open-source-software-oss/cve-2024-29320-sql-injection-in-wallos/#respond)

![Avatar placeholder](https://injasec.com/wp-content/themes/hestia/assets/img/placeholder.jpg)

Your email address will not be published. Required fields are marked \*

   Name \*
  Email \*
  Website
 What's on your mind?

 Save my name, email, and website in this browser for the next time I comment.

SearchSearch
## Recent Posts

* [CVE-2024-29320: SQL Injection in Wallos](https://injasec.com/open-source-software-oss/cve-2024-29320-sql-injection-in-wallos/)
* [CVE-2024-27613: Arbitrary File Manipulation in Numbas](https://injasec.com/security-research/cve-2024-27613-arbitrary-file-manipulation-in-numbas/)
* [Bypassing PowerShell CLM with Custom Runspaces](https://injasec.com/defense-evasion/bypassing-powershell-clm-with-custom-runspaces/)
* [Striking Blue: Picking Digital Lockers](https://injasec.com/defense-evasion/striking-blue-picking-digital-lockers/)
* [Leveraging Process Injection for AV Evasion](https://injasec.com/defense-evasion/leveraging-process-injection-for-av-evasion/)

## Archive

* [April 2024](https://injasec.com/2024/04/)
* [March 2024](https://injasec.com/2024/03/)
* [August 2023](https://injasec.com/2023/08/)
* [July 2023](https://injasec.com/2023/07/)
* [June 2023](https://injasec.com/2023/06/)
* [January 2023](https://injasec.com/2023/01/)
* [October 2022](https://injasec.com/2022/10/)
* [July 2022](https://injasec.com/2022/07/)
* [April 2022](https://injasec.com/2022/04/)
* [February 2022](https://injasec.com/2022/02/)

## Categories

* [Application Security](https://injasec.com/category/application-security/)
* [Binary Exploitation](https://injasec.com/category/binary-exploitation/)
* [Certification Review](https://injasec.com/category/certification-review/)
* [Defense Evasion](https://injasec.com/category/defense-evasion/)
* [Malware Development](https://injasec.com/category/malware-development-2/)
* [Open Source Software (OSS)](https://injasec.com/category/open-source-software-oss/)
* [Phishing](https://injasec.com/category/phishing/)
* [Red Team](https://injasec.com/category/red-team/)
* [Security Research](https://injasec.com/category/security-research/)

## Related Posts

[![](https://injasec.com/wp-content/uploads/2024/02/numbas-bg-360x240.jpg)](https://injasec.com/security-research/cve-2024-27613-arbitrary-file-manipulation-in-numbas/ "CVE-2024-27613: Arbitrary File Manipulation in Numbas")

###### [Application Security](https://injasec.com/category/application-security/ "View all posts in Application Security")

#### [CVE-2024-27613: Arbitrary File Manipulation in Numbas](https://injasec.com/security-research/cve-2024-27613-arbitrary-file-manipulation-in-numbas/ "CVE-2024-27613: Arbitrary File Manipulation in Numbas")

Introduction Developed by Newcastle University’s School of Mathematics, Statistics, and Physics, Numbas is an open-source e-assessment/e-learning system. According to its website, Numbas is used in over 1.000 institutions worldwide and has been in use for [Read more…](https://injasec.com/security-research/cve-2024-27613-arbitrary-file-manipulation-in-numbas/)

* [~$ whoami](https://injasec.com/about/)

Hestia | Developed by [ThemeIsle](https://themeisle.com)

