The provided content relates to CVE-2021-47228.

**Root cause of vulnerability:**
The Linux kernel's `__ioremap_check_other()` function, when running on an SEV (Secure Encrypted Virtualization) guest, was not correctly identifying and mapping certain EFI-reserved memory regions. Specifically, memory marked with `EFI_BOOT_SERVICES_DATA` and `EFI_MEMORY_RUNTIME` attributes was not being mapped as encrypted. This was causing a general protection fault and kernel crash during boot.

**Weaknesses/vulnerabilities present:**
The vulnerability lies in the insufficient checks within the `__ioremap_check_other()` function. It was only checking for `EFI_RUNTIME_SERVICES_DATA` memory, but not also for `EFI_BOOT_SERVICES_DATA` with `EFI_MEMORY_RUNTIME` attributes, which require encryption under SEV.

**Impact of exploitation:**
If the kernel attempts to access memory that is marked as `EFI_BOOT_SERVICES_DATA` and has the `EFI_MEMORY_RUNTIME` attribute, it will trigger a general protection fault, leading to a kernel crash and preventing the system from booting properly.

**Attack vectors:**
An attacker would likely need to control the guest OS, where they could influence the EFI memory map. While this is not a remote attack, it is a vulnerability that could be triggered by the guest operating system using specific combinations of EFI memory attributes.

**Required attacker capabilities/position:**
The attacker would require control of the guest OS running under SEV. This level of access would allow the attacker to manipulate the EFI memory map and expose the issue through the usage of specific memory regions and attributes. The attacker would not need to be in a privileged position within the guest.