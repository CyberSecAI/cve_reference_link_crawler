[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F97bb6192ed4a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40danielshaul0v%2Fmalwarebytes-premium-security-av-bypass-cve-2024-44744-97bb6192ed4a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40danielshaul0v%2Fmalwarebytes-premium-security-av-bypass-cve-2024-44744-97bb6192ed4a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Malwarebytes Premium Security AV Bypass — CVE-2024–44744

[![Daniel Shaulov](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*WaNHRrW4QquFyezb)](/%40danielshaul0v?source=post_page---byline--97bb6192ed4a--------------------------------)

[Daniel Shaulov](/%40danielshaul0v?source=post_page---byline--97bb6192ed4a--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c5566628d27&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40danielshaul0v%2Fmalwarebytes-premium-security-av-bypass-cve-2024-44744-97bb6192ed4a&user=Daniel+Shaulov&userId=2c5566628d27&source=post_page-2c5566628d27--byline--97bb6192ed4a---------------------post_header-----------)

2 min read·Oct 1, 2024

--

Listen

Share

An issue in Malwarebytes Premium Security v5.0.0.883 allows attackers to execute arbitrary code via placing crafted binaries into unspecified directories.

A vulnerability exists due to the differences in how Win32 and NT handle file paths, permitting attackers to execute malware exclusively from certain locations. This flaw enables attackers to run malicious code by leveraging path conversion inconsistencies, targeting specific directories that evade typical security checks.

An attacker can exploit this vulnerability to place malware in folders with a specific name pattern, allowing it to evade detection.

**Steps To Reproduce:**

1. Create a folder named “undetected.” (Note: Ensure there is a dot at the end of the name.)
2. Place the malware inside this folder.
3. Execute the malware using the NtCreateUserProcess WinAPI function. (Note: Running the malware via Explorer or Command Prompt will not work.)

![]()![]()![]()![]()

**Impact:**

The impact of this vulnerability is significant, as it allows attackers to place and execute malware from specific directories while avoiding detection. This can lead to user & system compromise, and evasion of security controls. Consequently, attackers can operate with increased stealth and persistence, potentially causing severe damage to the system.

For more insights and updates, follow me on X (Twitter): [@danielshaul0v](https://x.com/DanielShaul0v)

**Reference:**

<https://googleprojectzero.blogspot.com/2016/02/the-definitive-guide-on-win32-to-nt.html>
<https://github.com/BlackOfWorld/NtCreateUserProcess>

[Cybersecurity](/tag/cybersecurity?source=post_page-----97bb6192ed4a--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----97bb6192ed4a--------------------------------)[Infosec](/tag/infosec?source=post_page-----97bb6192ed4a--------------------------------)[Malware](/tag/malware?source=post_page-----97bb6192ed4a--------------------------------)[Endpoint Security](/tag/endpoint-security?source=post_page-----97bb6192ed4a--------------------------------)

--

--

[![Daniel Shaulov](https://miro.medium.com/v2/resize:fill:96:96/0*WaNHRrW4QquFyezb)](/%40danielshaul0v?source=post_page---post_author_info--97bb6192ed4a--------------------------------)[![Daniel Shaulov](https://miro.medium.com/v2/resize:fill:128:128/0*WaNHRrW4QquFyezb)](/%40danielshaul0v?source=post_page---post_author_info--97bb6192ed4a--------------------------------)Follow[## Written by Daniel Shaulov](/%40danielshaul0v?source=post_page---post_author_info--97bb6192ed4a--------------------------------)0 Followers·[8 Following](/%40danielshaul0v/following?source=post_page---post_author_info--97bb6192ed4a--------------------------------)

Security Research | Windows Internals

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----97bb6192ed4a--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----97bb6192ed4a--------------------------------)[About](/about?autoplay=1&source=post_page-----97bb6192ed4a--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----97bb6192ed4a--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----97bb6192ed4a--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----97bb6192ed4a--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----97bb6192ed4a--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----97bb6192ed4a--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----97bb6192ed4a--------------------------------)[Teams](/business?source=post_page-----97bb6192ed4a--------------------------------)

