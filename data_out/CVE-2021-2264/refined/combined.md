=== Content from www.openwall.com_d58bd032_20250110_163235.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2021/04/27/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <YIbC/ejOYMYVFOPM@f195.suse.de>
Date: Mon, 26 Apr 2021 15:41:17 +0200
From: Matthias Gerstner <mgerstner@...e.de>
To: oss-security@...ts.openwall.com
Subject: virtualbox: CVE-2021-25319: missing sticky bit in openSUSE packaging
 for /etc/box allows local root exploit for members of vboxusers group

Hi,

somewhat related to CVE-2021-2264 I noticed an openSUSE specific
security issue in the openSUSE packaging for virtualbox [1]. To enable
the autostart feature in virtualbox as outlined in the upstream manual
[2] our packagers introduced a group 'vboxusers' that is granted write
access to the directory /etc/vbox as the "autostart DB". Contrary to
what the manual says the directory was not packaged with the sticky bit
set, however.

The file /etc/vbox/vbox.cfg is a configuration file for virtualbox. This
file is sourced by other virtualbox bash scripts running as root like
'vboxautostart.sh', 'vboxdrv.sh' and 'vboxweb-service.sh'. Due to the
missing sticky bit any member of the vboxusers group can replace the
/etc/vbox/vbox.cfg file by a manipulated one, allowing for full code
execution in the context of the root user once e.g. the vboxautostart
systemd service runs.

Reproducer:

    root# su -g vboxusers nobody
    nobody$ cd /etc/vbox
    nobody$ cp vbox.cfg vbox.cfg.new
    nobody$ rm -f vbox.cfg
    nobody$ mv vbox.cfg.new vbox.cfg
    nobody$ echo "touch /root/evil" >>vbox.cfg

    nobody$ exit
    root# systemctl start vboxautostart.service
    root# ls -lh /root/evil
    -rw-r--r-- 1 root root 0  2. Mär 12:14 /root/evil

I have been looking into other distributions like Arch Linux, Fedora and
also some of the RPMs distributed on www.virtualbox.org. They all
package /etc/vbox as root:root mode 755 and are therefore not affected.

Updates for the openSUSE virtualbox packages are underway [3] that will
fix the packaging error and also move the "autostart DB" directory from
/etc/vbox to /etc/vbox/autostart.d to avoid mixing the autostart related
files with the virtualbox system configuration file in the same
directory.

Cheers

Matthias

[1]: <https://build.opensuse.org/package/show/Virtualization/virtualbox>
[2]: <https://www.virtualbox.org/manual/ch09.html#autostart-linux>
[3]: <https://bugzilla.suse.com/show_bug.cgi?id=1182918>

--
Matthias Gerstner <matthias.gerstner@...e.de>
Dipl.-Wirtsch.-Inf. (FH), Security Engineer
<https://www.suse.com/security>
Phone: +49 911 740 53 290
GPG Key ID: 0x14C405C971923553

SUSE Software Solutions Germany GmbH
HRB 36809, AG Nürnberg
Geschäftsführer: Felix Imendörffer

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_fa35fab4_20250110_163235.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Oracle VirtualBox: Multiple Vulnerabilities — GLSA **202208-36**

Multiple vulnerabilities have been discovered in Oracle Virtualbox, the worst of which could result in root privilege escalation.

### Affected packages

| Package | **app-emulation/virtualbox** on all architectures |
| --- | --- |
| Affected versions | < **6.1.36** |
| Unaffected versions | >= **6.1.36** |

| Package | **app-emulation/virtualbox-additions** on all architectures |
| --- | --- |
| Affected versions | < **6.1.36** |
| Unaffected versions | >= **6.1.36** |

| Package | **app-emulation/virtualbox-extpack-oracle** on all architectures |
| --- | --- |
| Affected versions | < **6.1.36** |
| Unaffected versions | >= **6.1.36** |

| Package | **app-emulation/virtualbox-guest-additions** on all architectures |
| --- | --- |
| Affected versions | < **6.1.36** |
| Unaffected versions | >= **6.1.36** |

| Package | **app-emulation/virtualbox-modules** on all architectures |
| --- | --- |
| Affected versions | < **6.1.36** |
| Unaffected versions | >= **6.1.36** |

### Background

VirtualBox is a powerful virtualization product from Oracle.

### Description

Multiple vulnerabilities have been discovered in VirtualBox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All VirtualBox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/virtualbox-6.1.36"

```
### References

* [CVE-2021-2145](https://nvd.nist.gov/vuln/detail/CVE-2021-2145)
* [CVE-2021-2250](https://nvd.nist.gov/vuln/detail/CVE-2021-2250)
* [CVE-2021-2264](https://nvd.nist.gov/vuln/detail/CVE-2021-2264)
* [CVE-2021-2266](https://nvd.nist.gov/vuln/detail/CVE-2021-2266)
* [CVE-2021-2279](https://nvd.nist.gov/vuln/detail/CVE-2021-2279)
* [CVE-2021-2280](https://nvd.nist.gov/vuln/detail/CVE-2021-2280)
* [CVE-2021-2281](https://nvd.nist.gov/vuln/detail/CVE-2021-2281)
* [CVE-2021-2282](https://nvd.nist.gov/vuln/detail/CVE-2021-2282)
* [CVE-2021-2283](https://nvd.nist.gov/vuln/detail/CVE-2021-2283)
* [CVE-2021-2284](https://nvd.nist.gov/vuln/detail/CVE-2021-2284)
* [CVE-2021-2285](https://nvd.nist.gov/vuln/detail/CVE-2021-2285)
* [CVE-2021-2286](https://nvd.nist.gov/vuln/detail/CVE-2021-2286)
* [CVE-2021-2287](https://nvd.nist.gov/vuln/detail/CVE-2021-2287)
* [CVE-2021-2291](https://nvd.nist.gov/vuln/detail/CVE-2021-2291)
* [CVE-2021-2296](https://nvd.nist.gov/vuln/detail/CVE-2021-2296)
* [CVE-2021-2297](https://nvd.nist.gov/vuln/detail/CVE-2021-2297)
* [CVE-2021-2306](https://nvd.nist.gov/vuln/detail/CVE-2021-2306)
* [CVE-2021-2309](https://nvd.nist.gov/vuln/detail/CVE-2021-2309)
* [CVE-2021-2310](https://nvd.nist.gov/vuln/detail/CVE-2021-2310)
* [CVE-2021-2312](https://nvd.nist.gov/vuln/detail/CVE-2021-2312)
* [CVE-2021-2409](https://nvd.nist.gov/vuln/detail/CVE-2021-2409)
* [CVE-2021-2442](https://nvd.nist.gov/vuln/detail/CVE-2021-2442)
* [CVE-2021-2443](https://nvd.nist.gov/vuln/detail/CVE-2021-2443)
* [CVE-2021-2454](https://nvd.nist.gov/vuln/detail/CVE-2021-2454)
* [CVE-2021-2475](https://nvd.nist.gov/vuln/detail/CVE-2021-2475)
* [CVE-2021-35538](https://nvd.nist.gov/vuln/detail/CVE-2021-35538)
* [CVE-2021-35540](https://nvd.nist.gov/vuln/detail/CVE-2021-35540)
* [CVE-2021-35542](https://nvd.nist.gov/vuln/detail/CVE-2021-35542)
* [CVE-2021-35545](https://nvd.nist.gov/vuln/detail/CVE-2021-35545)
* [CVE-2022-21394](https://nvd.nist.gov/vuln/detail/CVE-2022-21394)
* [CVE-2022-21465](https://nvd.nist.gov/vuln/detail/CVE-2022-21465)
* [CVE-2022-21471](https://nvd.nist.gov/vuln/detail/CVE-2022-21471)
* [CVE-2022-21487](https://nvd.nist.gov/vuln/detail/CVE-2022-21487)
* [CVE-2022-21488](https://nvd.nist.gov/vuln/detail/CVE-2022-21488)
* [CVE-2022-21554](https://nvd.nist.gov/vuln/detail/CVE-2022-21554)
* [CVE-2022-21571](https://nvd.nist.gov/vuln/detail/CVE-2022-21571)

**Release date**

August 31, 2022

**Latest revision**

August 31, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [785445](https://bugs.gentoo.org/show_bug.cgi?id=785445)
* [803134](https://bugs.gentoo.org/show_bug.cgi?id=803134)
* [820425](https://bugs.gentoo.org/show_bug.cgi?id=820425)
* [831440](https://bugs.gentoo.org/show_bug.cgi?id=831440)
* [839990](https://bugs.gentoo.org/show_bug.cgi?id=839990)
* [859391](https://bugs.gentoo.org/show_bug.cgi?id=859391)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.openwall.com_15a1c556_20250110_163235.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2021/04/25/2) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <YIa+TGj3iH9HuCtU@f195.suse.de>
Date: Mon, 26 Apr 2021 15:21:16 +0200
From: Matthias Gerstner <mgerstner@...e.de>
To: oss-security@...ts.openwall.com
Subject: virtualbox: CVE-2021-2264: vboxautostart-service.sh allows injection
 of parameters in 'su' invocation

Hello,

I recently discovered an issue in the script "vboxautostart-service.sh"
which is distributed by Oracle as part of their virtualbox RPMs [1]. By
default this script is not used but it can be enabled by an
Administrator according to the manual [2].

In the context of the autostart feature a directory "$VBOXAUTOSTART_DB"
(by default /etc/vbox) is used. Local users in the system are granted
write access to this directory. Users are supposed to create files of
the form "<username>.start" to configure autostarting of their
respective virtualbox VMs.

The version of the script in virtualbox release 6.1.18 (and older
releases) runs as root and uses the following bash for loop in its
`start()` function:

```
    for user in `ls $VBOXAUTOSTART_DB/*.start`
    do
        start_daemon `basename $user | sed -ne "s/\(.*\).start/\1/p"` $binary $PARAMS > /dev/null 2>&1
    done

    [...]

    start_daemon() {
        usr="$1"
        shift
        su - $usr -c "$*"
    }
```

Since by design unprivileged users need to have write access to this
directory, an unprivileged user can create arbitrarily named new files
in it that will be processed by the for loop above.

If a user creates a file like "$VBOXAUTOSTART_DB/--evil.start", then the
for loop will pass "--evil" as parameter to `start_daemon()`, resulting
in the command line flag `--evil` being passed to the `su` utility. A
reproducer for the openSUSE virtualbox package, which uses an older but
similarly vulnerable autostart script, looks like this:

    # emulate a malicious user that is a member of the vboxusers group
    root# su -g vboxusers nobody
    nobody$ cd /etc/vbox
    # try to inject a parameter to 'su'
    nobody$ touch -- '-s myshell.start'
    nobody$ exit
    # execute the autostart script
    root# /usr/lib/virtualbox/vboxautostart.sh start
    vboxautostart.sh: Starting VirtualBox VMs configured for autostart.
    vboxautostart.sh: Starting VMs for user -s myshell.
    # execution fails, because we cannot embed '/' characters in
    # filenames
    su: failed to execute  myshell: No such file or directory

Luckily this is not a full local root exploit. Two aspects are reponsible for
this:

- filenames cannot contain '/' characters, therefore we cannot specify
  any valid executable beyond the CWD (usually "/") of the autosart.sh script.
- the $user argument is passed before the `-c /usr/lib/virtualbox/VBoxAutostart`
  parameter. And the command line parsing logic of 'su' lets the final
  `-c` parameter win, i.e. the attacker cannot influence the command that is run.

Still a local attacker can specify arbitrary other parameters to `su` this way
e.g. the `--group=mygroup` parameter. It could be a successful attack vector
when combined with other security issues.

Beyond this any member of the vboxusers group can influence the autostart
settings of other users, as long as the victim user is allowed to
autostart via /etc/vbox/autostart.cfg.

On a more generic level this design of /etc/vbox as "autostart DB"
allows any member of the vboxusers group to trigger a run of
/usr/lib/virtualbox/VBoxAutostart as any local user (by influencing the
$user value) or as root with any local group (by setting $user to
--group=mygroup).

I privately reported this issue to Oracle Security on 2021-04-08. It has
been fixed via a critical patch update by upstream on 2021-04-20. The
fixed version of the script has stronger limitations on the accepatble
*.start filenames and also requires that the username present in the
file matches the owner of the file.

The openSUSE packages for virtualbox are about to receive updates [3].

[1]: <https://www.virtualbox.org/wiki/Linux_Downloads>
[2]: <https://www.virtualbox.org/manual/ch09.html#autostart-linux>
[3]: <https://bugzilla.suse.com/show_bug.cgi?id=1184542>

Cheers

Matthias

--
Matthias Gerstner <matthias.gerstner@...e.de>
Dipl.-Wirtsch.-Inf. (FH), Security Engineer
<https://www.suse.com/security>
Phone: +49 911 740 53 290
GPG Key ID: 0x14C405C971923553

SUSE Software Solutions Germany GmbH
HRB 36809, AG Nürnberg
Geschäftsführer: Felix Imendörffer

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


