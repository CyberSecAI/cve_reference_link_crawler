=== Content from bugzilla.mozilla.org_8482c279_20250110_222200.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1875701)
* [XML](/show_bug.cgi?ctype=xml&id=1875701)

Closed
[Bug 1875701](/show_bug.cgi?id=1875701)
(CVE-2024-2613)

Opened 1 year ago
Closed 11 months ago

# firefox/neqo: unbounded mem alloc based on unsanitized network input

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

firefox/neqo: unbounded mem alloc based on unsanitized network input

## Categories

### (Core :: Networking, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

124 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox122 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix) |
| firefox123 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix) |
| firefox124 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox122 |  | wontfix |
| firefox123 |  | wontfix |
| firefox124 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mail, Assigned: kershaw)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ec7202f5ae48eecc36b07aaa371fab12?d=mm&size=40)  [mail](/user_profile?user_id=741948)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b032108dab3ccfada1140fb485c6e182?d=mm&size=40)  [smayya](/user_profile?user_id=711499)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1877942](/show_bug.cgi?id=1877942 "RESOLVED FIXED - neqo 0.7.0")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[QUIC](/show_bug.cgi?id=1158011 "NEW - [meta] QUIC support")

Dependency [tree](/showdependencytree.cgi?id=1875701&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1875701)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla/neqo/security/advi...](https://github.com/mozilla/neqo/security/advisories/GHSA-5m9j-vr32-g7j5 "https://github.com/mozilla/neqo/security/advisories/GHSA-5m9j-vr32-g7j5")

[github.com/mozilla/neqo-ghsa-5m9j-vr3...](https://github.com/mozilla/neqo-ghsa-5m9j-vr32-g7j5/pull/1 "https://github.com/mozilla/neqo-ghsa-5m9j-vr32-g7j5/pull/1")

## Details

### (Keywords: csectype-dos, reporter-external, sec-low, Whiteboard: [Fixed in bug 1877942][reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main124+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-2613

[Keywords:](/describekeywords.cgi)

[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[Fixed in bug 1877942][reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main124+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c11 "1 year ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a12339623_578488 "7 months ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2636580_488993 "11 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch](/attachment.cgi?id=9375675)  [1 year ago](#c0)  [Max Inden](/user_profile?user_id=741948)   2.17 KB, patch |  | [Details](/attachment.cgi?id=9375675&action=edit) | [Diff](/attachment.cgi?id=9375675&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1875701&attachment=9375675) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9391561)  [10 months ago](#c13)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   196 bytes, text/plain |  | [Details](/attachment.cgi?id=9391561&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Max Inden](/user_profile?user_id=741948)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1875701#c0)• 1 year ago |
|  | |

Attached patch

[0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch](attachment.cgi?id=9375675&action=diff)
— [Details](attachment.cgi?id=9375675&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1875701&attachment=9375675)

Hi there,

This is Max Inden (<https://github.com/mxinden>).

I believe I found a security vulnerability affecting Firefox.

### Summary

A malicious remote server can send a tampered QUIC ACK frame, causing a Firefox instance to attempt an effectively unbounded memory allocation and thus OOM.

### Details

When decoding a QUIC ACK frame, Neqo will first read the ACK range count (nr) and then allocate a Vec with a capacity of the count (arr). It does not enforce an upper bound on the count. Thus an attacker can choose an arbitrarily large ACK range count and thus cause Neqo to attempt an effectively infinite memory allocation.

> FRAME\_TYPE\_ACK | FRAME\_TYPE\_ACK\_ECN => {
>
> let la = dv(dec)?;
>
> let ad = dv(dec)?;
>
> let nr = dv(dec)?;
>
> let fa = dv(dec)?;
>
> let mut arr: Vec<AckRange> = Vec::with\_capacity(nr as usize);

<https://github.com/mozilla/neqo/blob/4de3279b8ac881ef4683a8331fc33c2917019562/neqo-transport/src/frame.rs#L410-L415>

### Next steps

I have attached a patch to this email. You can apply the patch onto latest Neqo main brach via:

> git apply 0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch

I suggest looping in the Neqo maintainers.

* Martin Thomson <mt@lowentropy.net>
* Kershaw <kershaw@mozilla.com>
* Lars Eggert <lars@eggert.org>

I am happy to open a GitHub advisory on the Neqo GitHub repository directly to ease the process.

Hope this is of some help!

Max

Flags: sec-bounty?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1875701#c1)• 1 year ago |
|  | |

Moving to right component and adding cc's. Thanks!

Group: firefox-core-security → core-securityComponent: Security → NetworkingProduct: Firefox → Core

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1875701#c2)• 1 year ago |
|  | |

Hi Max,

Thanks for filing this bug.

Could you open a github PR for the attached patch?

Thanks.

Flags: needinfo?(mail)

|  | [Max Inden](/user_profile?user_id=741948)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1875701#c3)• 1 year ago |
|  | |

> Could you open a github PR for the attached patch?

Yes, of course. Though wouldn't a GitHub advisory with a private pull request be more appropriate, given that this is security sensitive? I am fine either way.

Flags: needinfo?(mail) → needinfo?(kershaw)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a87873_406194)• 1 year ago |

Group: core-security → network-core-security

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1875701#c4)• 1 year ago |
|  | |

Comment on [attachment 9375675](/attachment.cgi?id=9375675 "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[details]](/attachment.cgi?id=9375675&action=edit "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[diff]](/attachment.cgi?id=9375675&action=diff "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1875701&attachment=9375675)
0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch
Review of [attachment 9375675](/attachment.cgi?id=9375675 "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[details]](/attachment.cgi?id=9375675&action=edit "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[diff]](/attachment.cgi?id=9375675&action=diff "0001-fix-transport-bound-ACK-range-count-in-ACK-frame.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1875701&attachment=9375675):
-----------------------------------------------------------------
This looks like a fine fix. I might go smaller, but we're still talking kB, not whatever it was before, which is good.
::: neqo-transport/src/frame.rs
@@ +59,5 @@
> +/// > the number of ACK blocks possible.
> +//
> +// Taken from
> +// [msquic](<https://github.com/microsoft/msquic/blob/7d7a792d088abb80186a2fa20070ad82092e9736/src/core/frame.c#L257-L261>).
> +const MAX\_ACK\_RANGE\_COUNT: u64 = u16::MAX as u64;
Let's see. An ACK range could be as little as two varints, each of which are one octet. If the UDP payload is 64k, we really have at most 32k ranges. That suggests that the cap could be 32k, not 64.

|  | [Max Inden](/user_profile?user_id=741948)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1875701#c5)• 1 year ago |
|  | |

A smaller limit sounds good. I will make the adjustment.

> > Could you open a github PR for the attached patch?
>
> Yes, of course. Though wouldn't a GitHub advisory with a private pull request be more appropriate, given that this is security sensitive? I am fine either way.

It is hard for me to judge what impact an OOM in a Neqo connection has on a running Firefox instance, thus the caution. I am fine with a public pull request. Can you please confirm that a public pull request is preferred, Kershaw? I am sorry for the back-and-forth.

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1875701#c6)• 1 year ago |
|  | |

(In reply to Max Inden from [comment #5](/show_bug.cgi?id=1875701#c5 "RESOLVED FIXED - firefox/neqo: unbounded mem alloc based on unsanitized network input"))

> A smaller limit sounds good. I will make the adjustment.
>
> > > Could you open a github PR for the attached patch?
> >
> > Yes, of course. Though wouldn't a GitHub advisory with a private pull request be more appropriate, given that this is security sensitive? I am fine either way.
>
> It is hard for me to judge what impact an OOM in a Neqo connection has on a running Firefox instance, thus the caution. I am fine with a public pull request. Can you please confirm that a public pull request is preferred, Kershaw? I am sorry for the back-and-forth.

Let's go with an advisory. Thanks!

Flags: needinfo?(kershaw)

|  | [Max Inden](/user_profile?user_id=741948)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1875701#c7)• 1 year ago |
|  | |

I created an advisory and a private pull request with the above suggestions incorporated.

<https://github.com/mozilla/neqo/security/advisories/GHSA-5m9j-vr32-g7j5>

<https://github.com/mozilla/neqo-ghsa-5m9j-vr32-g7j5/pull/1>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a282619_1689)• 1 year ago |

Keywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)See Also: → <https://github.com/mozilla/neqo/security/advisories/GHSA-5m9j-vr32-g7j5>,
<https://github.com/mozilla/neqo-ghsa-5m9j-vr32-g7j5/pull/1>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a282629_1689)• 1 year ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1875701#c8)• 1 year ago |
|  | |

We should get this fix into neqo; not high severity due to there being many ways to DOS a browser that can't be blocked. Thanks!

Severity: -- → S3Priority: -- → P2

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1875701#c9)• 1 year ago |
|  | |

This bug is tracked [here](https://github.com/mozilla/neqo/security/advisories/GHSA-5m9j-vr32-g7j5) and will be fixed with a new lease of neqo.

Blocks: [QUIC](/show_bug.cgi?id=1158011 "NEW - [meta] QUIC support")Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][necko-triaged]

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1875701#c10)• 11 months ago |
|  | |

Fixed by [bug 1877942](/show_bug.cgi?id=1877942 "RESOLVED FIXED - neqo 0.7.0").

Thank you, Max!

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a1279943_505624)• 11 months ago |

Status: NEW → RESOLVEDClosed: 11 months agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a1336904_75935)• 11 months ago |

Assignee: nobody → kershawGroup: network-core-security → core-security-release
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix)
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Depends on: [1877942](/show_bug.cgi?id=1877942 "RESOLVED FIXED - neqo 0.7.0")Target Milestone: --- → 124 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1875701#c11)• 11 months ago |
|  | |

Unfortunately DOS bugs are generally excluded from our bug bounty program

Flags: sec-bounty? → sec-bounty-Whiteboard: [reporter-external] [client-bounty-form] [verif?][necko-triaged] → [Fixed in bug 1877942][reporter-external] [client-bounty-form] [verif?][necko-triaged]

|  | [Max Inden](/user_profile?user_id=741948)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1875701#c12)• 11 months ago |
|  | |

> Unfortunately DOS bugs are generally excluded from our bug bounty program

Totally fine! Thank you for all the help getting this into Firefox.

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a2636580_488993)• 11 months ago |

Flags: qe-verify-

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a2636630_488993)• 11 months ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a4519477_486634)• 10 months ago |

Whiteboard: [Fixed in bug 1877942][reporter-external] [client-bounty-form] [verif?][necko-triaged] → [Fixed in bug 1877942][reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main124+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1875701#c13)• 10 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9391561)
— [Details](attachment.cgi?id=9391561&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a4922532_428608)• 10 months ago |

Alias: CVE-2024-2613

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a11236728_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a12339623_578488)• 7 months ago |

Flags: sec-bounty-hof+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1875701#a20615213_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1875701&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Max Inden](/user_profile?user_id=741948)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_1388573f_20250110_222200.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-12

## Security Vulnerabilities fixed in Firefox 124

Announced
March 19, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 124

#### [#CVE-2024-2605: Windows Error Reporter could be used as a Sandbox escape vector](#CVE-2024-2605)

Reporter
goodbyeselene
Impact
high
##### Description

An attacker could have leveraged the Windows Error Reporter to run arbitrary code on the system escaping the sandbox. *Note:* This issue only affected Windows operating systems. Other operating systems are unaffected.

##### References

* [Bug 1872920](https://bugzilla.mozilla.org/show_bug.cgi?id=1872920)

#### [#CVE-2024-2606: Mishandling of WASM register values](#CVE-2024-2606)

Reporter
P1umer
Impact
high
##### Description

Passing invalid data could have led to invalid wasm values being created, such as arbitrary integers turning into pointer values.

##### References

* [Bug 1879237](https://bugzilla.mozilla.org/show_bug.cgi?id=1879237)

#### [#CVE-2024-2607: JIT code failed to save return registers on Armv7-A](#CVE-2024-2607)

Reporter
Gary Kwong
Impact
high
##### Description

Return registers were overwritten which could have allowed an attacker to execute arbitrary code. *Note:* This issue only affected Armv7-A systems. Other operating systems are unaffected.

##### References

* [Bug 1879939](https://bugzilla.mozilla.org/show_bug.cgi?id=1879939)

#### [#CVE-2024-2608: Integer overflow could have led to out of bounds write](#CVE-2024-2608)

Reporter
Ronald Crane
Impact
high
##### Description

`AppendEncodedAttributeValue(), ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` could have experienced integer overflows, causing underallocation of an output buffer leading to an out of bounds write.

##### References

* [Bug 1880692](https://bugzilla.mozilla.org/show_bug.cgi?id=1880692)

#### [#CVE-2023-5388: NSS susceptible to timing attack against RSA decryption](#CVE-2023-5388)

Reporter
Hubert Kario
Impact
moderate
##### Description

NSS was susceptible to a timing side-channel attack when performing RSA decryption. This attack could potentially allow an attacker to recover the private data.

##### References

* [Bug 1780432](https://bugzilla.mozilla.org/show_bug.cgi?id=1780432)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could have expired while the window is not in focus, which made the prompt vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-2610: Improper handling of html and body tags enabled CSP nonce leakage](#CVE-2024-2610)

Reporter
Georg Felber and Marco Squarcina (TU Wien)
Impact
moderate
##### Description

Using a markup injection an attacker could have stolen nonce values. This could have been used to bypass strict content security policies.

##### References

* [Bug 1871112](https://bugzilla.mozilla.org/show_bug.cgi?id=1871112)

#### [#CVE-2024-2611: Clickjacking vulnerability could have led to a user accidentally granting permissions](#CVE-2024-2611)

Reporter
Hafiizh
Impact
moderate
##### Description

A missing delay on when pointer lock was used could have allowed a malicious page to trick a user into granting permissions.

##### References

* [Bug 1876675](https://bugzilla.mozilla.org/show_bug.cgi?id=1876675)

#### [#CVE-2024-2612: Self referencing object could have potentially led to a use-after-free](#CVE-2024-2612)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an attacker could find a way to trigger a particular code path in `SafeRefPtr`, it could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1879444](https://bugzilla.mozilla.org/show_bug.cgi?id=1879444)

#### [#CVE-2024-2613: Improper handling of QUIC ACK frame data could have led to OOM](#CVE-2024-2613)

Reporter
Max Inden
Impact
low
##### Description

Data was not properly sanitized when decoding a QUIC ACK frame; this could have led to unrestricted memory consumption and a crash.

##### References

* [Bug 1875701](https://bugzilla.mozilla.org/show_bug.cgi?id=1875701)

#### [#CVE-2024-2614: Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](#CVE-2024-2614)

Reporter
Noah Lokocz, Kevin Brosnan, Ryan VanderMeulen and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685358%2C1861016%2C1880405%2C1881093)

#### [#CVE-2024-2615: Memory safety bugs fixed in Firefox 124](#CVE-2024-2615)

Reporter
Paul Bone and the Mozilla Fuzzing Team
Impact
critical
##### Description

Memory safety bugs present in Firefox 123. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1881074%2C1882438%2C1881650)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


