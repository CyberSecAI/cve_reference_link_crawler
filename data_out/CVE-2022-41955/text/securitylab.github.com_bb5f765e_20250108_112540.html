
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 7, 2023
# GHSL-2022-100: Path traversal vulnerability and remote code execution (RCE) vulnerability in Autolab - CVE-2022-41955,CVE-2022-41956

[![Author avatar](https://avatars.githubusercontent.com/u/176818)
Peter Stöckli](https://github.com/p-)

## Coordinated Disclosure Timeline

* 2022-11-21: Notified Autolab maintainers via email.
* 2022-11-21: Received initial acknowledgments by the Autolab team.
* 2022-11-21: The Autolab team started working on the fixes.
* 2022-01-13: Vulnerabilities were fixed and advisories were published [1](https://github.com/autolab/Autolab/security/advisories/GHSA-g7x7-mgrv-f24x), [2](https://github.com/autolab/Autolab/security/advisories/GHSA-x5r3-vf3p-3269).

## Summary

Two vulnerabilities were found in Autolab:

* Issue 1: File disclosure due to path traversal (`GHSL-2022-100`) - A path traversal vulnerability exists in Autolab’s remote handin feature.
* Issue 2: Authenticated Remote Code Execution (`GHSL-2022-124`) - A remote code execution vulnerability exists in the plagiarism checker functionality of Autolab.

These issues are listed in detail below.

## Product

Autolab

## Tested Version

[v2.9.0](https://github.com/autolab/Autolab/releases/tag/v2.9.0)

## Details

### Issue 1: File disclosure due to path traversal (`GHSL-2022-100`)

Autolab provides the possibility to allow submissions of students via a so-called remote handin feature. Handins submitted with this feature are copied from a path that is accessible to the running Autolab instance. In practice the remote handin path will probably be located in a directory of a shared drive. The endpoint for such submissions allows unauthenticated attackers to hand-in assignments for registered users using paths outside of their submission directory. The value of the [`submit`](https://github.com/autolab/Autolab/blob/524d4bb896e6d47e469e621b5d44c8cc36b90cd2/app/controllers/assessment/handin.rb#L131) parameter is passed to the [`saveHandin`](https://github.com/autolab/Autolab/blob/524d4bb896e6d47e469e621b5d44c8cc36b90cd2/app/controllers/assessment/handin.rb#L145) module method without futher sanitization or verification. The contents of the corresponding files of the submitted file paths could then be viewed by users viewing “their” submissions.

#### Proof of Concept

Preconditions:

1. Remote handin path needs to be set
2. Handin directory inside remote handin path for a user must exist in the form: `<email>_remote_handin_<assessment-name>` (This seems to be a general precondition for making the remote handin feature work)
3. At least one email address of a user that is registered to any course and assigment

The attacker then simply needs to construct an URL in this form and call it via GET request:

```
http://<autolab-host>/courses/<course-name>/assessments/<assessment-name>/local_submit?user=<registered-user-email>&submit=../../../../../<path-to-existing-file>

```

E.g.:

```
http://127.0.0.1/courses/Mycourse/assessments/mylab/local_submit?user=student@host.test&submit=../../../../../etc/passwd

```

Afterwards the attacker can view or download the contents of the desired file (e.g., `/etc/passwd`) in the “Handin History” of the assessment.

#### Impact

This issue may lead to `Information Disclosure`.

#### Resources

* [Submissions via Andrew File System (AFS)](https://github.com/autolab/Autolab/issues/126)

### Issue 2: Authenticated Remote Code Execution (`GHSL-2022-124`)

Autolab provides the functionality to check submissions for plagiarism using [MOSS (Measure Of Software Similarity)](https://docs.autolabproject.com/features/moss/). The Moss Cheat Checker can be run by instructors with sufficient permissions. The parameters [`max_lines`](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L397) and [`language_selection`](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L399) both flow unsanitized through several ([1](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L402), [2](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L403), [3](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L414)) different join operations before flowing into a [command execution sink](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L415). Using this vulnerability an attacker might gain control over the server running Autolab.

This vulnerability was discovered with the help of CodeQL’s [Uncontrolled command line](https://codeql.github.com/codeql-query-help/ruby/rb-command-line-injection/) query.

#### Proof of Concept

Preconditions:

1. Attacker needs to be logged in as instructor
2. There needs to be an existing course where the instructor has access permissions

This vulnerability can simply be exploited by using a browser and navigating to:

```
http://<autolab-host>/courses/<course-name>/moss

```

After selecting an assignment, the checkbox “Max Lines” needs to be enabled and instead of providing a valid number of lines a shell command such as `| touch /tmp/pwned.txt |` can be provided. (Which will then create the file `/tmp/pwned.txt` after clicking “GO!”).

To manipulate the `language_selection` parameter in the same way a browser inspection tools or a tool like `curl` can be used to manufacture the desired requests.

#### Impact

This issue may lead to Remote Code Execution (RCE).

#### Resources

* [Uncontrolled command line](https://codeql.github.com/codeql-query-help/ruby/rb-command-line-injection/)

## CVE

* CVE-2022-41955: RCE via MOSS functionality
* CVE-2022-41956: File disclosure via remote handin feature

## Credit

This issue was discovered and reported by GHSL team member [@p- (Peter Stöckli)](https://github.com/p-).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-100` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

