- **Root cause of vulnerability**: The application constructs OS commands using user-supplied input without proper validation, specifically in the port scanning functionality.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The application uses `subprocess.Popen()` with `shell=True`, allowing arbitrary commands to be executed via the injected input.
- **Impact of exploitation**: An authenticated user can execute arbitrary code on the web application server with root privileges. This could lead to complete system compromise, including data breaches, malware installation, denial of service, etc.
- **Attack vectors**: An attacker sends a crafted HTTP POST request to the `/portscanner/scan` endpoint with a malicious "ip" parameter in the JSON body.
- **Required attacker capabilities/position**: The attacker needs to be an authenticated user of the application. No special privileges are required, as even a low-privileged user can exploit the vulnerability.