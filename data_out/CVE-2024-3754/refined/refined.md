- **Root cause of vulnerability:** The plugin fails to properly sanitize and escape user-supplied input in its settings, specifically the "watermark text" field when creating a new watermark.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS).
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that will be executed in the browsers of other users who access the affected pages. This can lead to various malicious activities, including session hijacking, defacement, or redirection to malicious websites.
- **Attack vectors:** The attack vector is through the WordPress admin interface, specifically the watermark creation page. An attacker with "author" level privileges can input malicious code into the "watermark text" field.
- **Required attacker capabilities/position:** The attacker needs to have "author" level access to the WordPress admin panel. The vulnerability is exploitable even when the `unfiltered_html` capability is disallowed.