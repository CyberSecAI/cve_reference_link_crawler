<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Submit #356316: gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolv</title><meta name="keywords" content="#356316: gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolv,VulDB,Vulnerability,Vulnerability Database,Vulnerability Data Feed,VDB,VulnDB,CVE,NVD,Cyber Threat Intelligence,Hack,Hacking,IT-Security,Information Security,Infosec,Cybersecurity,Exploit,Exploiting,Open-Source" /><meta name="description" content="gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolv" /><meta name="robots" content="all" /><meta name="revisit-after" content="90 days" /><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" /><link rel="preload" href="/_thm/style-20240920.min.css" as="style"><link rel="preload" href="/_thm/fontawesome-6.1.1/css/all.min.css" as="style"><link rel="stylesheet" href="/_thm/style-20240920.min.css" type="text/css" media="all" /><link rel="stylesheet" href="/_thm/fontawesome-6.1.1/css/all.min.css" type="text/css" media="all" /><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#555"><meta name="msapplication-TileColor" content="#555"><link rel="alternate" hreflang="de" href="https://vuldb.com/de/?submit.356316" /><link rel="alternate" hreflang="fr" href="https://vuldb.com/fr/?submit.356316" /><link rel="alternate" hreflang="it" href="https://vuldb.com/it/?submit.356316" /><link rel="alternate" hreflang="es" href="https://vuldb.com/es/?submit.356316" /><link rel="alternate" hreflang="pt" href="https://vuldb.com/pt/?submit.356316" /><link rel="alternate" hreflang="ru" href="https://vuldb.com/ru/?submit.356316" /><link rel="alternate" hreflang="pl" href="https://vuldb.com/pl/?submit.356316" /><link rel="alternate" hreflang="sv" href="https://vuldb.com/sv/?submit.356316" /><link rel="alternate" hreflang="zh" href="https://vuldb.com/zh/?submit.356316" /><link rel="alternate" hreflang="ja" href="https://vuldb.com/ja/?submit.356316" /><link rel="alternate" hreflang="ar" href="https://vuldb.com/ar/?submit.356316" /><link rel="alternate" type="application/rss+xml" title="Recent" href="/?rss.recent" /><link rel="alternate" type="application/rss+xml" title="Updates" href="/?rss.updates" /><link rel="alternate" type="application/rss+xml" title="Submits" href="/?rss.submits" /><link rel="alternate" type="application/rss+xml" title="Changelog" href="/?rss.changelog" /></head><body><div id="app"><header id="app-header"><nav id="app-nav"><div id="menuwrapper"><div id="menu"><div id="logo" class="hideonphone hideonphone_h" title="VulDB"><a href="?"><img src="/_thm/vuldb.png" alt="VulDB"></a></div><div id="menubox"><form id="search_nav" class="hideonphone_h hideonphonesmall" method="post" action="?search"><input type="text" name="search" maxlength="255" placeholder="Vendor, Product, CVE, ..." autocomplete="on" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"><input type="submit" class="hideonphone buttoninsidetextbox" value="&#128269;"></form><div id="mainmenu"><ul class="top-level-menu"><li><div><a href="?"><div class="m_txt">Home</div></a></div><ul class="second-level-menu"><li><a href="?"><div class="m_txt">Overview</div></a></li><li><a href="?live.recent"><div class="m_txt">Live Recent</div></a></li><li><a href="?live.updates"><div class="m_txt">Live Updates</div></a></li><li><a href="?live.archive"><div class="m_txt">Live Archive</div></a></li><li><a href="?live.submits"><div class="m_txt">Live Submits</div></a></li></ul></li><li><div class="m_a"><a href="?recent"><div class="m_txt">Entries</div></a></div><ul class="second-level-menu"><li><a href="?recent"><div class="m_txt">Recent</div></a></li><li><a href="?updates"><div class="m_txt">Updates</div></a></li><li class="hideonphonesmall"><a href="?commits"><div class="m_txt">Commits</div></a></li><li><a href="?archive"><div class="m_txt">Archive</div></a></li><li><a href="?cna"><div class="m_txt">CNA</div></a></li><li><a href="?stats"><div class="m_txt">Stats</div></a></li><li class="hideonphone"><a href="?submits"><div class="m_txt">Submits</div></a></li><li class="hideonphone"><a href="?id.add"><div class="m_txt">Add</div></a></li></ul></li><li class="hideontablet"><div><a href="?product"><div class="m_txt">Products</div></a></div><ul class="second-level-menu"><li><a href="?vendor"><div class="m_txt">Vendor</div></a></li><li><a href="?product"><div class="m_txt">Product</div></a></li><li><a href="?type"><div class="m_txt">Type</div></a></li></ul></li><li class="hideonphone"><div><a href="?cvssv3"><div class="m_txt">Risk</div></a></div><ul class="second-level-menu"><li><a href="?cvssv4"><div class="m_txt">CVSSv4</div></a></li><li><a href="?cvssv3"><div class="m_txt">CVSSv3</div></a></li><li><a href="?cvssv2"><div class="m_txt">CVSSv2</div></a></li><li><a href="?risk"><div class="m_txt">Risks</div></a></li><li><a href="?exploits"><div class="m_txt">Exploits</div></a></li></ul></li><li class="hideonphone"><div><a href="?cti"><div class="m_txt">Threat</div></a></div><ul class="second-level-menu"><li class="hideonphonesmall"><a href="?cti.analyze"><div class="m_txt">Analysis</div></a></li><li><a href="?activities"><div class="m_txt">Activities</div></a></li><li><a href="?events"><div class="m_txt">Events</div></a></li><li><a href="?actor"><div class="m_txt">Actors</div></a></li><li><a href="?ip"><div class="m_txt">IP addresses</div></a></li><li><a href="?country"><div class="m_txt">Country</div></a></li><li><a href="?sector"><div class="m_txt">Sector</div></a></li><li><a href="?exploitprices"><div class="m_txt">Exploit Prices</div></a></li></ul></li><li class="hideontablet"><div><a href="?references"><div class="m_txt">References</div></a></div><ul class="second-level-menu"><li><a href="?references"><div class="m_txt">References</div></a></li><li><a href="?tools"><div class="m_txt">Tools</div></a></li><li><a href="?videos"><div class="m_txt">Videos</div></a></li><li><a href="?googlehacking"><div class="m_txt">Google Hacking</div></a></li><li><a href="?export"><div class="m_txt">Exports</div></a></li></ul></li><li class="hideonphonesmall"><div><a href="?search"><div class="m_txt">Search</div></a></div><ul class="second-level-menu"><li><form id="search_menu" method="post" action="?search"><div><input type="text" name="search" maxlength="255" placeholder="Type here..." autocomplete="off" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"></div></form></li><li><a href="?search"><div class="m_txt">Search</div></a></li><li class="hideonphonesmall"><a href="?search.advanced"><div class="m_txt">Advanced Search</div></a></li><li><a href="?user"><div class="m_txt">User</div></a></li><li class="hideonphone"><a href="?feeds"><div class="m_txt">Feeds</div></a></li><li><a href="?kb.api"><div class="m_txt">API</div></a></li></ul></li><li class="hideonphablet"><div><a href="?kb"><div class="m_txt">Support</div></a></div><ul class="second-level-menu"><li><a href="?kb"><div class="m_txt">Knowledge Base</div></a></li><li><a href="?kb.faq"><div class="m_txt">FAQ</div></a></li><li><a href="?kb.changelog"><div class="m_txt">Changelog</div></a></li><li><a href="?kb.roadmap"><div class="m_txt">Roadmap</div></a></li><li><a href="?status"><div class="m_txt">Status</div></a></li><li><a href="?contact"><div class="m_txt">Contact</div></a></li></ul></li><li class="hideonwatch"><div><a href="?login"><div class="m_txt">Login</div></a></div><ul class="second-level-menu"><li><a href="?login"><div class="m_txt">Login</div></a></li><li><a href="?signup"><div class="m_txt">Signup</div></a></li><li><a href="?pay"><div class="m_txt">Purchase</div></a></li><li><a href="?kb.terms"><div class="m_txt">Terms of Use</div></a></li></ul></li></ul></div></div></div></div></nav></header><main id="app-main"><aside id="app-sidemenu" class="app-sidelement hideonphone"><ul><li><a href="?live.submits"><div class="icon fas fa-satellite-dish"></div><div class="icontext">Live</div></a></li><li><a href="?submits"><div class="icon fa-regular fa-folder-open"></div><div class="icontext">Submits</div></a></li><li><a href="?id.add"><div class="icon fas fa-file-upload"></div><div class="icontext">Add</div></a></li><li><a href="?kb.submission"><div class="icon fas fa-file-upload"></div><div class="icontext">Policy</div></a></li><li><a href="?pay"><div class="icon fa-solid fa-cart-shopping"></div><div class="icontext">Purchase</div></a></li></ul><div id="usermenu" class="hideonphonesmall_h"><a href="?login">Login</a><a href="?signup">Signup</a></div></aside><div id="container"><div id="content"><nav id="breadcrumbs" class="hideonphonesmall hideonphone_h"><a href="?" class="breadcrumbs-item">&#x1f6e1; Home</a><a href="?submit" class="breadcrumbs-item">Submit</a><div class="breadcrumbs-item breadcrumbs-item-isactive">356316</div></nav><a href="?rss.submit" class="rssicon fas fa-rss hideonphone hideonphone_h" alt="RSS" title="RSS" target="rss"></a><h1>Submit #356316: gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolv<span class="minibutton"><a href="?kb.submission">info</a></span></h1><div class="tablewrapper"><table class="htable col1fitcontent"><tr><th>Title</th><td class="bold">gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolv</td></tr><tr><th>Description</th><td>## version
```shell 
./MP4Box -version                                                                              
MP4Box - GPAC version 2.5-DEV-rev228-g11067ea92-master
(c) 2000-2024 Telecom Paris distributed under LGPL v2.1+ - https://gpac.io

Please cite our work in your research:
        GPAC Filters: https://doi.org/10.1145/3339825.3394929
        GPAC: https://doi.org/10.1145/1291233.1291452

GPAC Configuration: --enable-sanitizer
Features: GPAC_CONFIG_LINUX GPAC_64_BITS GPAC_HAS_IPV6 GPAC_HAS_SSL GPAC_HAS_SOCK_UN GPAC_MINIMAL_ODF GPAC_HAS_QJS GPAC_HAS_LINUX_DVB  GPAC_DISABLE_3D
```
## reproduce 
Complie and run 
```
./configure --enable-sanitizer
make
./MP4Box -info poc4 
```
Information 
```shell
XMT: MPEG-4 (XMT) Scene Parsing
[XMT Parsing] Warning: descriptor InitialObjectDescriptor defined outside scene scope - skipping (line 10)
=================================================================
==18912==ERROR: AddressSanitizer: heap-use-after-free on address 0x607000032052 at pc 0x7f54fc2647ed bp 0x7ffce79c0f30 sp 0x7ffce79c0f20
READ of size 2 at 0x607000032052 thread T0
    #0 0x7f54fc2647ec in xmt_resolve_od_links scene_manager/loader_xmt.c:531
    #1 0x7f54fc2666f0 in load_xmt_run scene_manager/loader_xmt.c:3148
    #2 0x7f54fc93db85 in ctxload_process filters/load_bt_xmt.c:522
    #3 0x7f54fc67ed9d in gf_filter_process_task filter_core/filter.c:3164
    #4 0x7f54fc64a599 in gf_fs_thread_proc filter_core/filter_session.c:2145
    #5 0x7f54fc64e903 in gf_fs_run filter_core/filter_session.c:2452
    #6 0x7f54fc0cc145 in gf_media_import media_tools/media_import.c:1239
    #7 0x5647e6b54da4 in convert_file_info /home/ubuntu/gpac_testt/gpac/applications/mp4box/fileimport.c:130
    #8 0x5647e6b2212d in mp4box_main /home/ubuntu/gpac_testt/gpac/applications/mp4box/mp4box.c:6398
    #9 0x7f54f989fc86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #10 0x5647e6b01579 in _start (/home/ubuntu/gpac_testt/gpac/bin/gcc/MP4Box+0x87579)

0x607000032052 is located 2 bytes inside of 80-byte region [0x607000032050,0x6070000320a0)
freed by thread T0 here:
    #0 0x7f54fe7b17a8 in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xde7a8)
    #1 0x7f54fbfbab49 in gf_odf_del_iod odf/odf_code.c:442
    #2 0x7f54fb94c1ff in xml_sax_node_end utils/xml_parser.c:265
    #3 0x7f54fb94f965 in xml_sax_parse utils/xml_parser.c:867
    #4 0x7f54fb951cce in gf_xml_sax_parse_intern utils/xml_parser.c:1104
    #5 0x7f54fb952507 in gf_xml_sax_parse utils/xml_parser.c:1132
    #6 0x7f54fb952818 in xml_sax_read_file utils/xml_parser.c:1219
    #7 0x7f54fb9539aa in gf_xml_sax_parse_file utils/xml_parser.c:1331
    #8 0x7f54fc2666ba in load_xmt_run scene_manager/loader_xmt.c:3144
    #9 0x7f54fc93db85 in ctxload_process filters/load_bt_xmt.c:522
    #10 0x7f54fc67ed9d in gf_filter_process_task filter_core/filter.c:3164
    #11 0x7f54fc64a599 in gf_fs_thread_proc filter_core/filter_session.c:2145
    #12 0x7f54fc64e903 in gf_fs_run filter_core/filter_session.c:2452
    #13 0x7f54fc0cc145 in gf_media_import media_tools/media_import.c:1239
    #14 0x5647e6b54da4 in convert_file_info /home/ubuntu/gpac_testt/gpac/applications/mp4box/fileimport.c:130
    #15 0x5647e6b2212d in mp4box_main /home/ubuntu/gpac_testt/gpac/applications/mp4box/mp4box.c:6398
    #16 0x7f54f989fc86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)

previously allocated by thread T0 here:
    #0 0x7f54fe7b1b40 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb40)
    #1 0x7f54fbfba932 in gf_odf_new_iod odf/odf_code.c:415
    #2 0x7f54fbfc3fe3 in gf_odf_desc_new odf/odf_codec.c:244
    #3 0x7f54fc278e6f in xmt_parse_descriptor scene_manager/loader_xmt.c:1951
    #4 0x7f54fc27bf5d in xmt_node_start scene_manager/loader_xmt.c:2578
    #5 0x7f54fb94cd55 in xml_sax_node_start utils/xml_parser.c:308
    #6 0x7f54fb94fe5d in xml_sax_parse_attribute utils/xml_parser.c:397
    #7 0x7f54fb94fe5d in xml_sax_parse utils/xml_parser.c:940
    #8 0x7f54fb951cce in gf_xml_sax_parse_intern utils/xml_parser.c:1104
    #9 0x7f54fb952507 in gf_xml_sax_parse utils/xml_parser.c:1132
    #10 0x7f54fb952818 in xml_sax_read_file utils/xml_parser.c:1219
    #11 0x7f54fb9539aa in gf_xml_sax_parse_file utils/xml_parser.c:1331
    #12 0x7f54fc2666ba in load_xmt_run scene_manager/loader_xmt.c:3144
    #13 0x7f54fc93db85 in ctxload_process filters/load_bt_xmt.c:522
    #14 0x7f54fc67ed9d in gf_filter_process_task filter_core/filter.c:3164
    #15 0x7f54fc64a599 in gf_fs_thread_proc filter_core/filter_session.c:2145
    #16 0x7f54fc64e903 in gf_fs_run filter_core/filter_session.c:2452
    #17 0x7f54fc0cc145 in gf_media_import media_tools/media_import.c:1239
    #18 0x5647e6b54da4 in convert_file_info /home/ubuntu/gpac_testt/gpac/applications/mp4box/fileimport.c:130
    #19 0x5647e6b2212d in mp4box_main /home/ubuntu/gpac_testt/gpac/applications/mp4box/mp4box.c:6398
    #20 0x7f54f989fc86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)

SUMMARY: AddressSanitizer: heap-use-after-free scene_manager/loader_xmt.c:531 in xmt_resolve_od_links
Shadow bytes around the buggy address:
  0x0c0e7fffe3b0: 00 00 fa fa fa fa 00 00 00 00 00 00 00 00 00 00
  0x0c0e7fffe3c0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 fa fa
  0x0c0e7fffe3d0: fa fa 00 00 00 00 00 00 00 00 00 00 fa fa fa fa
  0x0c0e7fffe3e0: 00 00 00 00 00 00 00 00 00 00 fa fa fa fa 00 00
  0x0c0e7fffe3f0: 00 00 00 00 00 00 00 00 fa fa fa fa fd fd fd fd
=&gt;0x0c0e7fffe400: fd fd fd fd fd fd fa fa fa fa[fd]fd fd fd fd fd
  0x0c0e7fffe410: fd fd fd fd fa fa fa fa 00 00 00 00 00 00 00 00
  0x0c0e7fffe420: 00 00 fa fa fa fa 00 00 00 00 00 00 00 00 00 00
  0x0c0e7fffe430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0e7fffe440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0e7fffe450: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==18912==ABORTING

```</td></tr><tr><th>Source</th><td><span title="visit with caution">&#9888;&#65039; https:/<wbr>/<wbr>github.<wbr>com/<wbr>gpac/<wbr>gpac/<wbr>issues/<wbr>2874</span></td></tr><tr><th>User</th><td><a href="?user.69897"><div class="user-avatar fa-solid fa-wheat-awn green bg-aqua"></div>&nbsp;Fantasy (UID 69897)</a></td></tr><tr><th>Submission</th><td>06/13/2024 03:33 PM (7 months ago)</td></tr><tr><th>Moderation</th><td>06/17/2024 03:38 PM (4 days later)</td></tr><tr><th>Status</th><td><a href="?kb.submission" class="symbol cvss1">Accepted</a></td></tr><tr><th>VulDB Entry</th><td><a href="?id.268792" class="symbol price4">268792</a> [GPAC 2.5-DEV-rev228-g11067ea92-master MP4Box loader_xmt.c xmt_node_end use after free]</td></tr><tr><th>Points</th><td>20</td></tr></table></div><p><div class="submenubuttons"><a href="?submit.356315">&#9666;<span class="hideonphone"> Previous</span></a><a href="?submit">Overview</a><a href="?submit.356317"><span class="hideonphone">Next </span>&#9656;</a></div></p><section id="servicebox" class="ribbon ribbonbox hideonwatch hideonphablet_h"><h1>Do you want to use VulDB in your project?</h1><p>Use the official API to access entries easily!</p><a href="?kb.api"><input type="button" value="Click here" /></a></section></div></div><aside id="app-tocmenu" class="app-sidelement hideonphablet"><div class="sidemenuwrapper"><h2><span class="fa-solid fa-triangle-exclamation"></span> Notice</h2><p>Submissions are made by <a href="?user">VulDB community users</a>. VulDB is <em>not responsible</em> for their content nor the links to external sources.</p><p>Please use the raw information shown and the links listed <em>with caution</em>. They might contain malicious and harmful actions, code or data.</p><p>The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.</p><h2><span class="fas fa-question-circle"></span> Documentation</h2><ul><li><a href="?kb.submission">Submission Policy</a></li><li><a href="?kb.processing">Data Processing</a></li><li><a href="?kb.cna">CVE Handling</a></li></ul></div></aside></main><footer id="app-footer"><div id="footerwrapper"><div id="footercontent"><div id="copyright"><a href="?kb.terms">&copy; <span class="hideonphone">1997-</span>2025<span class="hideonphonesmall"> vuldb.com</span></a><span class="hideontablet"> &middot; <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="license">cc by-nc-sa</a></span></div><div id="languages" class="hideonphablet"><a href="/de/?submit.356316" hreflang="de" title="German">de</a> &middot; <a href="/fr/?submit.356316" hreflang="fr" title="French">fr</a> &middot; <a href="/it/?submit.356316" hreflang="it" title="Italian">it</a> &middot; <a href="/es/?submit.356316" hreflang="es" title="Spanish">es</a> &middot; <a href="/pt/?submit.356316" hreflang="pt" title="Portuguese">pt</a> &middot; <a href="/ru/?submit.356316" hreflang="ru" title="Russian">ru</a> &middot; <a href="/pl/?submit.356316" hreflang="pl" title="Polish">pl</a> &middot; <a href="/sv/?submit.356316" hreflang="sv" title="Swedish">sv</a> &middot; <a href="/zh/?submit.356316" hreflang="zh" title="Chinese">zh</a> &middot; <a href="/ja/?submit.356316" hreflang="ja" title="Japanese">ja</a> &middot; <a href="/ar/?submit.356316" hreflang="ar" title="Arabic">ar</a></div><div id="version"><a href="?kb.changelog">v18.14.7</a></div></div></div></footer></div></body></html>