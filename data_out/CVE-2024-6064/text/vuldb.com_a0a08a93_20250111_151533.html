![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)🛡 Home[Submit](?submit)356316
# Submit #356316: gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene\_manager/loader\_xmt.c:531 in xmt\_resolv[info](?kb.submission)

| Title | gpac 2.5-DEV-rev228-g11067ea92-master Heap-use-after-free scene\_manager/loader\_xmt.c:531 in xmt\_resolv |
| --- | --- |
| Description | ## version ```shell ./MP4Box -version MP4Box - GPAC version 2.5-DEV-rev228-g11067ea92-master (c) 2000-2024 Telecom Paris distributed under LGPL v2.1+ - https://gpac.io Please cite our work in your research: GPAC Filters: https://doi.org/10.1145/3339825.3394929 GPAC: https://doi.org/10.1145/1291233.1291452 GPAC Configuration: --enable-sanitizer Features: GPAC\_CONFIG\_LINUX GPAC\_64\_BITS GPAC\_HAS\_IPV6 GPAC\_HAS\_SSL GPAC\_HAS\_SOCK\_UN GPAC\_MINIMAL\_ODF GPAC\_HAS\_QJS GPAC\_HAS\_LINUX\_DVB GPAC\_DISABLE\_3D ``` ## reproduce Complie and run ``` ./configure --enable-sanitizer make ./MP4Box -info poc4 ``` Information ```shell XMT: MPEG-4 (XMT) Scene Parsing [XMT Parsing] Warning: descriptor InitialObjectDescriptor defined outside scene scope - skipping (line 10) ================================================================= ==18912==ERROR: AddressSanitizer: heap-use-after-free on address 0x607000032052 at pc 0x7f54fc2647ed bp 0x7ffce79c0f30 sp 0x7ffce79c0f20 READ of size 2 at 0x607000032052 thread T0 #0 0x7f54fc2647ec in xmt\_resolve\_od\_links scene\_manager/loader\_xmt.c:531 #1 0x7f54fc2666f0 in load\_xmt\_run scene\_manager/loader\_xmt.c:3148 #2 0x7f54fc93db85 in ctxload\_process filters/load\_bt\_xmt.c:522 #3 0x7f54fc67ed9d in gf\_filter\_process\_task filter\_core/filter.c:3164 #4 0x7f54fc64a599 in gf\_fs\_thread\_proc filter\_core/filter\_session.c:2145 #5 0x7f54fc64e903 in gf\_fs\_run filter\_core/filter\_session.c:2452 #6 0x7f54fc0cc145 in gf\_media\_import media\_tools/media\_import.c:1239 #7 0x5647e6b54da4 in convert\_file\_info /home/ubuntu/gpac\_testt/gpac/applications/mp4box/fileimport.c:130 #8 0x5647e6b2212d in mp4box\_main /home/ubuntu/gpac\_testt/gpac/applications/mp4box/mp4box.c:6398 #9 0x7f54f989fc86 in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x21c86) #10 0x5647e6b01579 in \_start (/home/ubuntu/gpac\_testt/gpac/bin/gcc/MP4Box+0x87579) 0x607000032052 is located 2 bytes inside of 80-byte region [0x607000032050,0x6070000320a0) freed by thread T0 here: #0 0x7f54fe7b17a8 in \_\_interceptor\_free (/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xde7a8) #1 0x7f54fbfbab49 in gf\_odf\_del\_iod odf/odf\_code.c:442 #2 0x7f54fb94c1ff in xml\_sax\_node\_end utils/xml\_parser.c:265 #3 0x7f54fb94f965 in xml\_sax\_parse utils/xml\_parser.c:867 #4 0x7f54fb951cce in gf\_xml\_sax\_parse\_intern utils/xml\_parser.c:1104 #5 0x7f54fb952507 in gf\_xml\_sax\_parse utils/xml\_parser.c:1132 #6 0x7f54fb952818 in xml\_sax\_read\_file utils/xml\_parser.c:1219 #7 0x7f54fb9539aa in gf\_xml\_sax\_parse\_file utils/xml\_parser.c:1331 #8 0x7f54fc2666ba in load\_xmt\_run scene\_manager/loader\_xmt.c:3144 #9 0x7f54fc93db85 in ctxload\_process filters/load\_bt\_xmt.c:522 #10 0x7f54fc67ed9d in gf\_filter\_process\_task filter\_core/filter.c:3164 #11 0x7f54fc64a599 in gf\_fs\_thread\_proc filter\_core/filter\_session.c:2145 #12 0x7f54fc64e903 in gf\_fs\_run filter\_core/filter\_session.c:2452 #13 0x7f54fc0cc145 in gf\_media\_import media\_tools/media\_import.c:1239 #14 0x5647e6b54da4 in convert\_file\_info /home/ubuntu/gpac\_testt/gpac/applications/mp4box/fileimport.c:130 #15 0x5647e6b2212d in mp4box\_main /home/ubuntu/gpac\_testt/gpac/applications/mp4box/mp4box.c:6398 #16 0x7f54f989fc86 in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x21c86) previously allocated by thread T0 here: #0 0x7f54fe7b1b40 in \_\_interceptor\_malloc (/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xdeb40) #1 0x7f54fbfba932 in gf\_odf\_new\_iod odf/odf\_code.c:415 #2 0x7f54fbfc3fe3 in gf\_odf\_desc\_new odf/odf\_codec.c:244 #3 0x7f54fc278e6f in xmt\_parse\_descriptor scene\_manager/loader\_xmt.c:1951 #4 0x7f54fc27bf5d in xmt\_node\_start scene\_manager/loader\_xmt.c:2578 #5 0x7f54fb94cd55 in xml\_sax\_node\_start utils/xml\_parser.c:308 #6 0x7f54fb94fe5d in xml\_sax\_parse\_attribute utils/xml\_parser.c:397 #7 0x7f54fb94fe5d in xml\_sax\_parse utils/xml\_parser.c:940 #8 0x7f54fb951cce in gf\_xml\_sax\_parse\_intern utils/xml\_parser.c:1104 #9 0x7f54fb952507 in gf\_xml\_sax\_parse utils/xml\_parser.c:1132 #10 0x7f54fb952818 in xml\_sax\_read\_file utils/xml\_parser.c:1219 #11 0x7f54fb9539aa in gf\_xml\_sax\_parse\_file utils/xml\_parser.c:1331 #12 0x7f54fc2666ba in load\_xmt\_run scene\_manager/loader\_xmt.c:3144 #13 0x7f54fc93db85 in ctxload\_process filters/load\_bt\_xmt.c:522 #14 0x7f54fc67ed9d in gf\_filter\_process\_task filter\_core/filter.c:3164 #15 0x7f54fc64a599 in gf\_fs\_thread\_proc filter\_core/filter\_session.c:2145 #16 0x7f54fc64e903 in gf\_fs\_run filter\_core/filter\_session.c:2452 #17 0x7f54fc0cc145 in gf\_media\_import media\_tools/media\_import.c:1239 #18 0x5647e6b54da4 in convert\_file\_info /home/ubuntu/gpac\_testt/gpac/applications/mp4box/fileimport.c:130 #19 0x5647e6b2212d in mp4box\_main /home/ubuntu/gpac\_testt/gpac/applications/mp4box/mp4box.c:6398 #20 0x7f54f989fc86 in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x21c86) SUMMARY: AddressSanitizer: heap-use-after-free scene\_manager/loader\_xmt.c:531 in xmt\_resolve\_od\_links Shadow bytes around the buggy address: 0x0c0e7fffe3b0: 00 00 fa fa fa fa 00 00 00 00 00 00 00 00 00 00 0x0c0e7fffe3c0: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 fa fa 0x0c0e7fffe3d0: fa fa 00 00 00 00 00 00 00 00 00 00 fa fa fa fa 0x0c0e7fffe3e0: 00 00 00 00 00 00 00 00 00 00 fa fa fa fa 00 00 0x0c0e7fffe3f0: 00 00 00 00 00 00 00 00 fa fa fa fa fd fd fd fd =>0x0c0e7fffe400: fd fd fd fd fd fd fa fa fa fa[fd]fd fd fd fd fd 0x0c0e7fffe410: fd fd fd fd fa fa fa fa 00 00 00 00 00 00 00 00 0x0c0e7fffe420: 00 00 fa fa fa fa 00 00 00 00 00 00 00 00 00 00 0x0c0e7fffe430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0e7fffe440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0e7fffe450: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Container overflow: fc Array cookie: ac Intra object redzone: bb ASan internal: fe Left alloca redzone: ca Right alloca redzone: cb ==18912==ABORTING ``` |
| Source | ⚠️ https://github.com/gpac/gpac/issues/2874 |
| User | [Fantasy (UID 69897)](?user.69897) |
| Submission | 06/13/2024 03:33 PM (7 months ago) |
| Moderation | 06/17/2024 03:38 PM (4 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [268792](?id.268792) [GPAC 2.5-DEV-rev228-g11067ea92-master MP4Box loader\_xmt.c xmt\_node\_end use after free] |
| Points | 20 |

[◂ Previous](?submit.356315)[Overview](?submit)[Next ▸](?submit.356317)

# Do you want to use VulDB in your project?

Use the official API to access entries easily!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[© 1997-2025 vuldb.com](?kb.terms) · [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.356316 "German") · [fr](/fr/?submit.356316 "French") · [it](/it/?submit.356316 "Italian") · [es](/es/?submit.356316 "Spanish") · [pt](/pt/?submit.356316 "Portuguese") · [ru](/ru/?submit.356316 "Russian") · [pl](/pl/?submit.356316 "Polish") · [sv](/sv/?submit.356316 "Swedish") · [zh](/zh/?submit.356316 "Chinese") · [ja](/ja/?submit.356316 "Japanese") · [ar](/ar/?submit.356316 "Arabic")[v18.14.7](?kb.changelog)