<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>0034433: CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature - MantisBT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<link rel="stylesheet" type="text/css" href="https://mantisbt.org/bugs/css/default.css?cache_key=5ddbd846abe9c5a7f4ad097f1016c5ca" />
	<link rel="stylesheet" type="text/css" href="https://mantisbt.org/bugs/css/status_config.php?cache_key=4721a82bd9d85f263cbd56f398f9fa4e" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.0/min/dropzone.min.css"  crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu"  crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"  crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans"  crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" integrity="sha256-yMjaV542P+q1RnH6XByCPDfUFhmOafWbeLPmqKh11zo="  crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css" href="https://mantisbt.org/bugs/css/ace.min.css?cache_key=5ddbd846abe9c5a7f4ad097f1016c5ca" />
	<link rel="stylesheet" type="text/css" href="https://mantisbt.org/bugs/css/ace-mantis.css?cache_key=5ddbd846abe9c5a7f4ad097f1016c5ca" />
	<link rel="stylesheet" type="text/css" href="https://mantisbt.org/bugs/css/ace-skins.min.css?cache_key=5ddbd846abe9c5a7f4ad097f1016c5ca" />

<style>
* { font-family: "Open Sans"; } 
h1, h2, h3, h4, h5 { font-family: "Open Sans"; } 
</style>
	<link rel="shortcut icon" href="/bugs/images/favicon.ico" type="image/x-icon" />
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: full-text search" href="https://mantisbt.org/bugs/browser_search_plugin.php?type=text"/>
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: search by Issue Id" href="https://mantisbt.org/bugs/browser_search_plugin.php?type=id"/>
	<script type="text/javascript" src="/bugs/javascript_config.php?cache_key=4721a82bd9d85f263cbd56f398f9fa4e"></script>
	<script type="text/javascript" src="/bugs/javascript_translations.php?cache_key=200d9adb4497fbca080a04bc9e1aef7a"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.0/min/dropzone.min.js" integrity="sha384-TBYvJK9bRa7Ii3OZh+eaXb5r98Ad36+kotsxTD3tIEa9vgJOQ0lRMfZtWAJxPq4P" crossorigin="anonymous"></script>
	<script type="text/javascript" src="/bugs/js/common.js"></script>
	<link rel="canonical" href="https://mantisbt.org/bugs/view.php?id=34433" />
<link rel="stylesheet" href="/bugs/plugin_file.php?file=MantisCoreFormatting/markdown.css" /><script
					id="mantis-core-formatting-syntax-highlighting-init"
					data-cdn="1"
					data-theme="prism.min.css"
					data-plugins="copy-to-clipboard,show-language,line-numbers"
					data-i18n='{"copy-to-clipboard":{"copy":"Copy","copy-success":"\u2713 Copied","copy-error":"Press Ctrl+C to copy"}}'
					src="/bugs/plugin_file.php?file=MantisCoreFormatting/syntax-highlighting/init.js"></script>
			<script src="/bugs/plugin_file.php?file=Snippets/jquery-textrange.js"></script>
			<script src="/bugs/plugin_file.php?file=Snippets/jquery.qtip.min.js"></script>
			<script src="/bugs/plugin_file.php?file=Snippets/snippets.js"></script>
			<link rel="stylesheet" type="text/css" href="/bugs/plugin_file.php?file=Snippets/jquery.qtip.min.css"/>
			<link rel="stylesheet" type="text/css" href="/bugs/plugin_file.php?file=Snippets/snippets.css"/></head>
<body id="view-issue-page" class="skin-3">
<div id="navbar" class="navbar navbar-default navbar-collapse navbar-fixed-top noprint"><div id="navbar-container" class="navbar-container"><button id="menu-toggler" type="button" class="navbar-toggle menu-toggler pull-left hidden-lg hidden-md" data-target="#sidebar"><span class="sr-only">Toggle sidebar</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="navbar-header"><a href="/bugs//" class="navbar-brand"><span class="smaller-75"> MantisBT </span></a><button type="button" class="navbar-toggle navbar-toggle-img collapsed pull-right hidden-sm hidden-md hidden-lg" data-toggle="collapse" data-target=".navbar-buttons,.navbar-menu"><span class="sr-only">Toggle user menu</span><i class="fa fa-user ace-icon fa-2x white" ></i> </button></div><div class="navbar-buttons navbar-header navbar-collapse collapse"><ul class="nav ace-nav">
<li class="grey" id="dropdown_projects_menu">
<a data-toggle="dropdown" href="#" class="dropdown-toggle">
&#160;mantisbt&#160;
<i class="fa fa-angle-down ace-icon bigger-110" ></i>
</a>
<ul id="projects-list" class=" dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-close">
<li><div class="projects-searchbox"><input class="search form-control input-md" placeholder="Search" /></div></li>
<li class="divider"></li>
<li><div class="scrollable-menu">
<ul class="list dropdown-yellow no-margin">
<li><a class="project-link" href="/bugs/set_project.php?project_id=0">All Projects</a></li>
<li class="divider"></li>
<li class="active"><a class="project-link" href="/bugs/set_project.php?project_id=1">mantisbt</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=20">Mylyn Connector</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=25">Plugin - agileMantis</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=11">Plugin - CsvImport</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=21">Plugin - CustomerManagement</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=10">Plugin - EmailReporting</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=15">Plugin - FilterPageEdit</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=14">Plugin - InlineColumnConfiguration</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=16">Plugin - LinkedCustomFields</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=22">Plugin - MantisTouchRedirect</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=6">Plugin - RecurrCall</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=13">Plugin - RelatedIssuesExport</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=7">Plugin - Reminder</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=8">Plugin - Tasks</a></li>
<li><a class="project-link" href="/bugs/set_project.php?project_id=18">Plugin - Time Tracking</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li class="grey"><a data-toggle="dropdown" href="#" class="dropdown-toggle"><i class="fa fa-user ace-icon fa-2x white" ></i> <span class="user-info">anonymous</span><i class="fa fa-angle-down ace-icon" ></i></a><ul class="user-menu dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-close"><li><a href="https://mantisbt.org/bugs/issues_rss.php?"><i class="fa fa-rss-square orange ace-icon" ></i> RSS</a></li><li class="divider"></li><li><a href="/bugs/logout_page.php"><i class="fa fa-sign-out ace-icon" ></i> Logout</a></li></ul></li></ul></div></div></div><div class="main-container" id="main-container">
<div id="sidebar" class="sidebar sidebar-fixed responsive compact "><ul class="nav nav-list"><li>
<a href="/bugs/my_view_page.php">
<i class="fa fa-dashboard menu-icon" ></i>
<span class="menu-text"> My View </span>
</a>
<b class="arrow"></b>
</li>
<li class="active">
<a href="/bugs/view_all_bug_page.php">
<i class="fa fa-list-alt menu-icon" ></i>
<span class="menu-text"> View Issues </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/bugs/changelog_page.php">
<i class="fa fa-retweet menu-icon" ></i>
<span class="menu-text"> Change Log </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/bugs/roadmap_page.php">
<i class="fa fa-road menu-icon" ></i>
<span class="menu-text"> Roadmap </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/bugs/wiki.php?type=project&amp;id=1">
<i class="fa fa-book menu-icon" ></i>
<span class="menu-text"> Wiki </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/bugs/plugin.php?page=Source/index">
<i class="fa fa-code-fork menu-icon" ></i>
<span class="menu-text"> Repositories </span>
</a>
<b class="arrow"></b>
</li>
</ul><div id="sidebar-btn" class="sidebar-toggle sidebar-collapse"><i data-icon2="ace-icon fa fa-angle-double-right" data-icon1="ace-icon fa fa-angle-double-left"
		class="ace-icon fa fa-angle-double-left"></i></div></div><div class="main-content">
<div id="breadcrumbs" class="breadcrumbs noprint">
<ul class="breadcrumb">
 <li><i class="fa fa-user home-icon active" ></i>Anonymous </li>
<div class="btn-group btn-corner">
	<a href="/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D34433" class="btn btn-primary btn-xs">Login</a>
	<a href="/bugs/signup_page.php" class="btn btn-primary btn-xs">Signup for a new account</a>
</div>
</ul>
<div id="nav-search" class="nav-search"><form class="form-search" method="post" action="/bugs/jump_to_bug.php"><span class="input-icon"><input type="text" name="bug_id" autocomplete="off" class="nav-search-input" placeholder="Issue #"><i class="fa fa-search ace-icon nav-search-icon" ></i></span></form></div>
</div>
  <div class="page-content">
<div class="row">
<div class="col-md-12 col-xs-12"><div class="widget-box widget-color-blue2"><div class="widget-header widget-header-small"><h4 class="widget-title lighter"><i class="fa fa-bars ace-icon" ></i>View Issue Details</h4></div><div class="widget-body"><div class="widget-toolbox padding-8 clearfix noprint"><div class="btn-group pull-left"><a class="btn btn-primary btn-white btn-round btn-sm" href="wiki.php?id=34433">Wiki</a><a class="btn btn-primary btn-white btn-round btn-sm" href="#changesets">Related Changesets</a><a class="btn btn-primary btn-white btn-round btn-sm" href="#bugnotes">Jump to Notes</a></div><div class="btn-group pull-right"></div></div><div class="widget-main no-padding"><div class="table-responsive"><table class="table table-bordered table-condensed"><tfoot><tr class="noprint"><td colspan="6"><div class="btn-group"></div></td></tr></tfoot><tbody><tr class="bug-header"><th class="bug-id category width-15">ID</th><th class="bug-project category width-20">Project</th><th class="bug-category category width-15">Category</th><th class="bug-view-status category width-15">View Status</th><th class="bug-date-submitted category width-15">Date Submitted</th><th class="bug-last-modified category width-20">Last Update</th></tr><tr class="bug-header-data"><td class="bug-id">0034433</td><td class="bug-project">mantisbt</td><td class="bug-category">security</td><td class="bug-view-status">public</td><td class="bug-date-submitted">2024-05-05 04:30</td><td class="bug-last-modified">2024-05-12 12:34</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr><tr><th class="bug-reporter category">Reporter</th><td class="bug-reporter"><a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>&nbsp;</td><th class="bug-assigned-to category">Assigned To</th><td class="bug-assigned-to"><a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>&nbsp;</td><td colspan="2">&#160;</td></tr><tr><th class="bug-priority category">Priority</th><td class="bug-priority">normal</td><th class="bug-severity category">Severity</th><td class="bug-severity">major</td><th class="bug-reproducibility category">Reproducibility</th><td class="bug-reproducibility">sometimes</td></tr><tr><th class="bug-status category">Status</th><td class="bug-status"><i class="fa fa-square fa-status-box status-90-fg" ></i> closed</td><th class="bug-resolution category">Resolution</th><td class="bug-resolution">fixed</td><td colspan="2">&#160;</td></tr><tr><th class="bug-os category">OS</th><td class="bug-os">Debian GNU/Linux</td><th class="bug-os-build category">OS Version</th><td class="bug-os-build">12 (Bookworm)</td><td colspan="2">&#160;</td></tr><tr><th class="bug-product-version category">Product Version</th><td class="bug-product-version">2.26.1</td><td colspan="4">&#160;</td></tr><tr><th class="bug-target-version category">Target Version</th><td class="bug-target-version">2.26.2</td><th class="bug-fixed-in-version category">Fixed in Version</th><td class="bug-fixed-in-version">2.26.2</td><td colspan="2">&#160;</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr><tr><th class="bug-summary category">Summary</th><td class="bug-summary" colspan="5">0034433: CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature</td></tr><tr><th class="bug-description category">Description</th><td class="bug-description" colspan="5"><p>The password reset and account registration feature is vulnerable to broken access control, it's possible to send HTTP request to /account_update.php with verify_user_id that belongs to another user account. However, this exploit only works when the following criterial is met:</p>
<ol>
<li>For password reset, target username and email must be known.</li>
<li>Link in the email must be clicked / opened, either by the user or &quot;checked&quot; automatically by some sort of security feature within the email. When the link is clicked / opened, data type 6 and value of 1 will be updated to the mantis_tokens_table.</li>
<li>Target user have not sent request to the /account_update.php to change the password.</li>
</ol></td></tr><tr><th class="bug-steps-to-reproduce category">Steps To Reproduce</th><td class="bug-steps-to-reproduce" colspan="5"><ol>
<li>Reset both user 1 (current user) and user 2 (target user) password or register two new users (e.g. user 1 and user 2).</li>
<li>Click the reset password link that belongs to user 2 (target user). In a real scenario, attack with user interaction (for example by tempting the target user to click the link using &quot;phising&quot; email) or security feature within email that will automatically &quot;check&quot; the link will be needed.</li>
<li>Open the reset password link received within email that belongs to user 1 (current user).</li>
<li>Follow the link until the edit account page is being shown.</li>
<li>Fill the form, submit it, intercept the request, tamper the value of verify_user_id parameter (e.g. from 2 to 3), and send the request.</li>
<li>Login using to an account which identified by the verify_user_id.</li>
</ol>
<p>===</p>
<p>Note:<br />
If the user 2 (target) previously have used either the password reset or user registration feature, and somehow the link has been clicked without the user performing actual password change to the /account_update.php, then step 1 is not needed.</p>
<p>Since normal user won't be able to know which registration link has been clicked and which registration link belong to whom (don't have database access), brute force attack can be performed within the value of the verify_user_id parameter when sending request to the /account_update.php</p></td></tr><tr><th class="bug-additional-information category">Additional Information</th><td class="bug-additional-information" colspan="5"><p><a href="https://github.com/mantisbt/mantisbt/security/advisories/GHSA-93x3-m7pw-ppqm" rel="noopener,nofollow">https://github.com/mantisbt/mantisbt/security/advisories/GHSA-93x3-m7pw-ppqm</a></p>
<p>I would like to be credited for the finding.<br />
Name: Alexander Christian<br />
Company: Vantage Point Security Indonesia</p></td></tr><tr><th class="bug-tags category">Tags</th><td class="bug-tags" colspan="5">No tags attached.</td></tr><tr class="noprint"><th class="bug-attach-tags category">Attached Files</th><td class="bug-attach-tags" colspan="5"><div class="well well-xs">
<div id="attachment_preview_12589_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12589&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12589&amp;type=bug" target="_self">1 - user 1 reset password.png</a>&#32;(189,464&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12589_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12589&amp;type=bug" target="_self"><img src="file_download.php?file_id=12589&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111XiYmPRbwsf4dDqedAD7-CcUhHo0S3Dqu" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12589_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12589&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12589&amp;type=bug" target="_self">1 - user 1 reset password.png</a>&#32;(189,464&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12589_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12590_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12590&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12590&amp;type=bug" target="_self">1.2 - user 2 reset password.png</a>&#32;(186,691&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12590_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12590&amp;type=bug" target="_self"><img src="file_download.php?file_id=12590&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111aBaasFwSLv1VTJJMbNUYynDepCNltaDH" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12590_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12590&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12590&amp;type=bug" target="_self">1.2 - user 2 reset password.png</a>&#32;(186,691&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12590_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12591_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12591&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12591&amp;type=bug" target="_self">2 - data in mantis_token_table.png</a>&#32;(33,034&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12591_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12591&amp;type=bug" target="_self"><img src="file_download.php?file_id=12591&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111JE_ut4ca17c7MZFTaVEJ_vPjD_LlKTBZ" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12591_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12591&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12591&amp;type=bug" target="_self">2 - data in mantis_token_table.png</a>&#32;(33,034&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12591_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12592_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12592&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12592&amp;type=bug" target="_self">3 - reset password link.png</a>&#32;(17,670&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12592_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12592&amp;type=bug" target="_self"><img src="file_download.php?file_id=12592&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111XiqhVlwYW5bNvMdileb9XvNDHkH8qZjV" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12592_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12592&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12592&amp;type=bug" target="_self">3 - reset password link.png</a>&#32;(17,670&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12592_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12593_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12593&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12593&amp;type=bug" target="_self">4 - open the reset password link that belong to user 1.png</a>&#32;(43,313&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12593_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12593&amp;type=bug" target="_self"><img src="file_download.php?file_id=12593&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=202501110wvhlz5TYL9b2FMujdwgMZg4AA2YiZqh" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12593_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12593&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12593&amp;type=bug" target="_self">4 - open the reset password link that belong to user 1.png</a>&#32;(43,313&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12593_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12594_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12594&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12594&amp;type=bug" target="_self">5.1 - data in the user table before submission.png</a>&#32;(7,691&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12594_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12594&amp;type=bug" target="_self"><img src="file_download.php?file_id=12594&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111-1DTgu5XtzkkvUtVBc4Q0ErHnXFfKpVI" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12594_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12594&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12594&amp;type=bug" target="_self">5.1 - data in the user table before submission.png</a>&#32;(7,691&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12594_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12595_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12595&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12595&amp;type=bug" target="_self">5.2 - original request.png</a>&#32;(107,444&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12595_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12595&amp;type=bug" target="_self"><img src="file_download.php?file_id=12595&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111Crx6FX-CA-PMV3JPC3wWNaxZtxIIMiCc" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12595_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12595&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12595&amp;type=bug" target="_self">5.2 - original request.png</a>&#32;(107,444&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12595_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12596_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12596&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12596&amp;type=bug" target="_self">5.3 - tampered request.png</a>&#32;(174,651&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12596_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12596&amp;type=bug" target="_self"><img src="file_download.php?file_id=12596&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111QYkp7YgawaCVqEBxXAf_qFBlfDRYBl6V" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12596_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12596&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12596&amp;type=bug" target="_self">5.3 - tampered request.png</a>&#32;(174,651&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12596_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12597_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12597&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12597&amp;type=bug" target="_self">5.4 - data in the user table after submission.png</a>&#32;(7,225&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12597_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12597&amp;type=bug" target="_self"><img src="file_download.php?file_id=12597&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111RKqO4oCrTcZSfTEIqfflWMczEYbmbJgm" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12597_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12597&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12597&amp;type=bug" target="_self">5.4 - data in the user table after submission.png</a>&#32;(7,225&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12597_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12598_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12598&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12598&amp;type=bug" target="_self">6 - login using user 2 with new creds.png</a>&#32;(189,778&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12598_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12598&amp;type=bug" target="_self"><img src="file_download.php?file_id=12598&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111TY9s9ShVoLnMdYem76KQPtpz9rUpeOM0" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12598_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12598&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12598&amp;type=bug" target="_self">6 - login using user 2 with new creds.png</a>&#32;(189,778&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12598_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12599_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12599&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12599&amp;type=bug" target="_self">7 - login successful.png</a>&#32;(31,719&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12599_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12599&amp;type=bug" target="_self"><img src="file_download.php?file_id=12599&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111ZfDL66iTQWb6pNShSmeUR55AwgYHNTLC" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12599_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12599&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12599&amp;type=bug" target="_self">7 - login successful.png</a>&#32;(31,719&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12599_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12600_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12600&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12600&amp;type=bug" target="_self">8.1 - brute force attempt.png</a>&#32;(134,193&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12600_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12600&amp;type=bug" target="_self"><img src="file_download.php?file_id=12600&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111wsG02Fb6azoJwtx1Fb2jifTBFh0fRqC0" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12600_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12600&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12600&amp;type=bug" target="_self">8.1 - brute force attempt.png</a>&#32;(134,193&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12600_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs">
<div id="attachment_preview_12601_open" class=" collapse-open noprint"><a href="file_download.php?file_id=12601&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12601&amp;type=bug" target="_self">8.2 - brute force result.png</a>&#32;(241,922&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12601_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<div class="bug-attachment-preview-image"><a href="file_download.php?file_id=12601&amp;type=bug" target="_self"><img src="file_download.php?file_id=12601&amp;type=bug&amp;show_inline=1&amp;file_show_inline_token=20250111eWYJkHalp6QoN4JtFLmCGviuOmeLQ1T6" alt="" loading="lazy" style="border: 0;" /></a></div></div>
<div id="attachment_preview_12601_closed" class="collapse-section-closed  collapse-closed"><a href="file_download.php?file_id=12601&amp;type=bug" target="_self"><i class="fa fa-file-image-o " title="png file icon"></i></a>&#32;<a href="file_download.php?file_id=12601&amp;type=bug" target="_self">8.2 - brute force result.png</a>&#32;(241,922&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_12601_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div></td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr></tbody></table></div></div></div></div></div>
<div class="col-md-12 col-xs-12">
<a id="attachments"></a>
<a id="bugnotes"></a>
<div class="space-10"></div>

<div id="bugnotes" class="widget-box widget-color-blue2 ">
<div class="widget-header widget-header-small">
	<h4 class="widget-title lighter">
		<i class="fa fa-comments ace-icon" ></i>		Activities	</h4>
	<div class="widget-toolbar">
		<a data-action="collapse" href="#">
			<i class="fa fa-chevron-up 1 ace-icon bigger-125" ></i>		</a>
	</div>
	</div>
	<div class="widget-body">
	<div class="widget-main no-padding">
	<div class="table-responsive">
	<table class="table table-bordered table-condensed table-striped">
<tr class="bugnote visible-on-hover-toggle" id="c68885">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-05 05:39					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68885" class="lighter" title="Direct link to note">
				~0068885			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Many thanks for the detailed report, I'm looking into it.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68886">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-05 11:15					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68886" class="lighter" title="Direct link to note">
				~0068886			</a>
					</p>
		<p class="no-margin small lighter"><i class="fa fa-retweet " ></i> Last edited:&#32;2024-05-05 11:16</p>		<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>I had a look and can confirm the issue. </p>
<p>In fact it's even worse than you describe, because it is actually possible to reset the password of any user that has a pending TOKEN_ACCOUNT_VERIFY, without the attacker even owning an account, using a brute-force approach calling account_update.php with increasing user IDs with a simple request like so:</p>
<pre><code>curl -X POST http://example.com/mantisbt/account_update.php --data &#039;verify_user_id=XXX&amp;password=NEW_PWD&amp;password_confirm= NEW_PWD&#039;</code></pre>
<p>For the record, even after this vulnerability is fixed, it will not be possible to be 100% bulletproof in a password reset/account creation scenario - if the attacker somehow obtains the confirmation hash, they will be able to reset the target user's password and there is nothing we can do about it (referring to point 2 of your steps to reproduce).</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68887">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-05 12:36					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68887" class="lighter" title="Direct link to note">
				~0068887			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>I agree with you, if the attacker gains access to the confirmation_hash, then the account is highly likely to be compromised. What I'm concerned about in the 2nd step of step to reproduce is if the link got &quot;accidentally opened&quot; without changing the actual password, then the account will have the pending TOKEN_ACCOUNT_VERIFY.</p>
<p>However, I believe it should be sufficient to include the confirmation_hash or a similar validation during password reset / registration, it can help to determine whether the current request is authorized to perform password changes for the given user_id.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68888">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-05 12:59					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68888" class="lighter" title="Direct link to note">
				~0068888			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<blockquote>
<p>I believe it should be sufficient to include the confirmation_hash or a similar validation during password reset / registration</p>
</blockquote>
<p>Yep, this is precisely how I was planning to address this issue.</p>
<p>We use Github advisories to handle CVE requests and code review for security fixes. Please let me know your Github user id, so I can grant you access to a private fork for you to review and test the patch.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68892">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-05 21:47					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68892" class="lighter" title="Direct link to note">
				~0068892			</a>
					</p>
		<p class="no-margin small lighter"><i class="fa fa-retweet " ></i> Last edited:&#32;2024-05-06 01:51</p>		<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Sure, my Github user id is 54769255 (<a href="https://github.com/redna-xela" rel="noopener,nofollow">https://github.com/redna-xela</a>)</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68893">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 04:07					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68893" class="lighter" title="Direct link to note">
				~0068893			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<blockquote>
<p>my Github user id is 54769255</p>
</blockquote>
<p>Thanks, I actually meant username, not id, sorry ;-)</p>
<p>I added you to the Github Advisory <a href="https://github.com/mantisbt/mantisbt/security/advisories/GHSA-93x3-m7pw-ppqm" rel="noopener,nofollow">GHSA-93x3-m7pw-ppqm</a>. You will also find a proposed patch there. Please review, feedback is welcome.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68894">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 05:20					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68894" class="lighter" title="Direct link to note">
				~0068894			</a>
					</p>
		<p class="no-margin small lighter"><i class="fa fa-retweet " ></i> Last edited:&#32;2024-05-06 05:22</p>		<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Thank you, I'll look into this and get back to you as soon as possible.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68895">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 06:10					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68895" class="lighter" title="Direct link to note">
				~0068895			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Thanks for waiting! I've reviewed the patches, and everything looks good. I've also confirmed that the previous vulnerability is no longer exploitable.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68897">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 06:26					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68897" class="lighter" title="Direct link to note">
				~0068897			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Thanks for the feedback, that was quick :-)<br />
Are you also happy with the advisory's wording, CVSS evaluation and selected CWE ?</p>
<p>I'm now waiting for a CVE ID to be assigned.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68898">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 07:55					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68898" class="lighter" title="Direct link to note">
				~0068898			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Thanks for asking. The advisory's wording, CVSS evaluation and selected CWE already looks good to me, but I would like to suggest the following if possible:</p>
<ul>
<li>Impact: &quot;A successful attack could grant the attacker full access to the compromised account, including sensitive information or functionalities associated with the account&quot; or something similar.</li>
<li>CVSS Scoring: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L</li>
<li>Workarounds: I think it's better if we provide the workaround according to what has been done, which is by adding additional validation to the /account_update.php</li>
</ul>
<p>For the CVSS scoring, I believe the impact could be worse depending on who uses it and what kind of data is being stored, hence the C:H and I:H. Attack Complexity changed to High because successful attack cannot be accomplished at will, but rather need some perquisites to be fulfilled.</p>
<p>I appreciate any feedback you may have.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68899">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 08:31					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68899" class="lighter" title="Direct link to note">
				~0068899			</a>
					</p>
		<p class="no-margin small lighter"><i class="fa fa-retweet " ></i> Last edited:&#32;2024-05-06 08:36</p>		<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<blockquote>
<p>Impact: &quot;A successful attack could grant the attacker full access to the compromised account, including sensitive information or functionalities associated with the account&quot; </p>
</blockquote>
<p>OK sounds good.</p>
<blockquote>
<p>C:H and I:H</p>
</blockquote>
<p>This is somewhat subjective, and as you say depends on external factors, in particular the access level of the account that gets hijacked.<br />
I did not want to paint things too black considering that the probability of a successful attack is quite low</p>
<blockquote>
<p>Attack Complexity changed to High because successful attack cannot be accomplished at will, but rather need some perquisites to be fulfilled.</p>
</blockquote>
<p>I set it to low initially, because a brute-force attack <em>can</em> be launched at will and very easily, as explained in <a href="/bugs/view.php?id=34433#c68886" title="0034433: [2024-05-05 11:16] dregad" class="resolved">0034433:0068886</a>, even if the probability of success would be very low without some preparation work (e.g. social engineering to trick users so there are actual requests pending). Someone could just get lucky...</p>
<blockquote>
<p>provide the workaround according to what has been done, which is by adding additional validation</p>
</blockquote>
<p>The idea was to have a quick and simple to implement option to reduce the risk, until a patch was available.</p>
<p>I guess the point is kind of moot, as I would make the Advisory public together with the patch and 2.26.2 release, so anyone could either a) upgrade or b) apply the patch.</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68900">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=80929"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/ec52785537f1b5652aa75447a8cd5277?d=identicon&amp;r=G&amp;s=80" alt="rednaxela" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=80929">rednaxela</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 09:34					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68900" class="lighter" title="Direct link to note">
				~0068900			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Thanks for your input! I'm on board with you regarding the CVSS Scoring, I guess it would be better to use the previous score you've provided to avoid inflating the perceived risk. I also see your point about the workaround section, we can leave it as is.</p>
<p>I think that's all, no further feedback from me based on what we've discussed :)</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68901">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 10:16					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68901" class="lighter" title="Direct link to note">
				~0068901			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>Great, thanks for your collaboration.<br />
I reverted the CVSS change, now back to 7.3 - <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L</code></p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c68902">
		<td class="category">
		<div class="pull-left padding-2"><div class="bugnote-avatar-container-80"><a rel="nofollow" href="https://mantisbt.org/bugs/view_user_page.php?id=17784"><img class="bugnote-avatar-80" src="https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?d=identicon&amp;r=G&amp;s=80" alt="dregad" /></a></div>		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2024-05-06 10:37					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">developer</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=34433#c68902" class="lighter" title="Direct link to note">
				~0068902			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	<p>CVE-2024-34077 assigned</p>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
		<div class="col-md-12 col-xs-12">
			<div class="space-10"></div>
			<div class="widget-box widget-color-blue2" id="changesets">
				<div class="widget-header widget-header-small">
					<h4 class="widget-title lighter">
						<i class="ace-icon fa fa-file-code-o"></i>
						Related Changesets					</h4>
					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="1 ace-icon fa-chevron-down fa bigger-125"></i>
						</a>
					</div>
				</div>
				<div class="widget-body">
					<div class="table-responsive">
						<table class="table table-bordered table-striped table-condensed no-margin">
							<tr>
<td class="category width-25" rowspan="3">
	<a id="92d11a01b195a1b6717a2f205218089158ea6d00"></a>
	<p class="no-margin">MantisBT: master-2.26 92d11a01</p>
	<p class="no-margin small">
		<i class="fa fa-clock-o grey"></i>
		2024-05-05 20:09	</p>
	<p class="no-margin lighter">
		<i class="fa fa-user grey"></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>	</p>
<br><a class="btn btn-primary btn-white btn-round btn-xs" href="/bugs/plugin.php?page=Source/view&amp;id=27067">Details</a>
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00">Diff</a></td>

<td colspan=2>Validate confirm hash when updating account<br />
<br />
This prevents an attacker from resetting another user's password if they<br />
have an incomplete account validation or password reset request pending.<br />
<br />
Fixes <a href="/bugs/view.php?id=34433" title="[closed] CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature" class="resolved">0034433</a>, CVE-2024-xxxxx</td>

<td>
<span class="bold">Affected Issues</span><br><span><a href="/bugs/view.php?id=34433" title="[closed] CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature" class="resolved">0034433</a></span></td>

</tr>
<tr>
<td class="small" colspan="2">
	mod - account_update.php</td>
<td class="center width-13">
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00">Diff</a>
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/account_update.php">File</a></td>
</tr>
<tr>
<td class="small" colspan="2">
	mod - verify.php</td>
<td class="center width-13">
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00">Diff</a>
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/verify.php">File</a></td>
</tr>
<tr>
<td class="category width-25" rowspan="2">
	<a id="b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a"></a>
	<p class="no-margin">MantisBT: master-2.26 b12b1f8b</p>
	<p class="no-margin small">
		<i class="fa fa-clock-o grey"></i>
		2024-05-05 20:18	</p>
	<p class="no-margin lighter">
		<i class="fa fa-user grey"></i> <a href="https://mantisbt.org/bugs/view_user_page.php?id=17784">dregad</a>	</p>
<br><a class="btn btn-primary btn-white btn-round btn-xs" href="/bugs/plugin.php?page=Source/view&amp;id=27068">Details</a>
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/commit/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a">Diff</a></td>

<td colspan=2>Use g_reauthentication_expiry to set token timeout<br />
<br />
The timeout of the account verification token (TOKEN_ACCOUNT_VERIFY) is<br />
now set based on the $g_reauthentication_expiry config, instead of the<br />
TOKEN_EXPIRY_AUTHENTICATED constant.<br />
<br />
With default settings this does not change the system's behavior, but<br />
ensures there is a consistent timeout with other &quot;secure&quot; pages that<br />
require reauthentication and allows the admin to change the timeout,<br />
which was not possible before.<br />
<br />
The timeout is applied regardless of whether reauthentication is<br />
enabled or not.</td>

<td>
<span class="bold">Affected Issues</span><br><span><a href="/bugs/view.php?id=34433" title="[closed] CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature" class="resolved">0034433</a></span></td>

</tr>
<tr>
<td class="small" colspan="2">
	mod - verify.php</td>
<td class="center width-13">
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/commit/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a">Diff</a>
<a class="btn btn-primary btn-white btn-round btn-xs" href="https://github.com/mantisbt/mantisbt/blob/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a/verify.php">File</a></td>
</tr>
						</table>
					</div>
				</div>
			</div>
		</div>
</div>
</div>
</div>
<div class="clearfix"></div>
<div class="space-20"></div>
<div class="footer noprint">
<div class="footer-inner">
<div class="footer-content">
<div class="col-md-6 col-xs-12 no-padding">
<address>
<strong>Powered by <a href="https://www.mantisbt.org" title="bug tracking software">MantisBT  2.28.0-dev-master-a94bae75d</a></strong> <br>
<small>Copyright &copy; 2000 - 2025 MantisBT Team</small><br><small>Contact <a href="mailto:vboctor@mantisbt.org" title="Contact the webmaster via e-mail.">administrator</a> for assistance</small><br>
</address>
</div>
<div class="col-md-6 col-xs-12">
<div class="pull-right" id="powered-by-mantisbt-logo">
<a href="https://www.mantisbt.org" title="Mantis Bug Tracker: a free and open source web based bug tracking system."><img src="/bugs/images/mantis_logo.png" width="102" height="35" alt="Powered by Mantis Bug Tracker: a free and open source web based bug tracking system." /></a>
</div>
</div>
<div class="col-xs-12 no-padding grey">
<address class="no-margin pull-right">
<small><i class="fa fa-clock-o " ></i> Page execution time: 0.1929 seconds</small>&#160;&#160;&#160;&#160;
</address>
</div>
</div>
</div>
</div>
<a class="btn-scroll-up btn btn-sm btn-inverse display" id="btn-scroll-up" href="#">
<i class="fa fa-angle-double-up ace-icon icon-only bigger-110" ></i>
</a>
</div>
	<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js" integrity="sha256-5YmaxAwMjIpMrVlK84Y/+NjCpKnFYa8bWWBbUHSBGfU=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/corejs-typeahead/1.3.4/typeahead.jquery.min.js" integrity="sha512-+f1CvxhWImXOCzqPaBaXNtH+cyfZYeHaJTPoT1v/CK326MliOFISS+rEEwRwO4atJr1+eXpVRVyaUyjXotFBKg==" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js" integrity="sha512-93wYgwrIFL+b+P3RvYxi/WUFRXXUDSLCT2JQk9zhVGXuS2mHl2axj6d+R6pP+gcU5isMHRj1u0oYE/mWyt/RjA==" crossorigin="anonymous"></script>
	<script type="text/javascript" src="/bugs/js/ace.min.js"></script>
</body>
</html>
