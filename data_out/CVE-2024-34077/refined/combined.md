=== Content from github.com_b2179bfd_20250111_112350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F92d11a01b195a1b6717a2f205218089158ea6d00)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F92d11a01b195a1b6717a2f205218089158ea6d00)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  76](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Validate confirm hash when updating account

[Browse files](/mantisbt/mantisbt/tree/92d11a01b195a1b6717a2f205218089158ea6d00)
Browse the repository at this point in the history

```
This prevents an attacker from resetting another user's password if they
have an incomplete account validation or password reset request pending.

Fixes #34433, CVE-2024-xxxxx
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 12, 2024

1 parent
[0a50562](/mantisbt/mantisbt/commit/0a50562369d823689c9b946066d1e49d3c2df226)

commit 92d11a0

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**20 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* account\_update.php
  [account\_update.php](#diff-d7039e85e12e3d4b545fa650944c68f0ad24251cc65de2aa723516fec5f08999)
* verify.php
  [verify.php](#diff-e1aed510834dc8c4efa11466eb87001dafe7387c67f37f4e699ea61224f99f99)

## There are no files selected for viewing

27 changes: 19 additions & 8 deletions

27
[account\_update.php](#diff-d7039e85e12e3d4b545fa650944c68f0ad24251cc65de2aa723516fec5f08999 "account_update.php")

Show comments

[View file](/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/account_update.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,19 +60,30 @@ |
|  |  |  |
|  |  | form\_security\_validate( 'account\_update' ); |
|  |  |  |
|  |  | # If token is set, it's a password reset request from verify.php, and if |
|  |  | # not we need to reauthenticate the user |
|  |  | $t\_verify\_user\_id = gpc\_get( 'verify\_user\_id', false ); |
|  |  | $t\_account\_verification = $t\_verify\_user\_id ? token\_get\_value( TOKEN\_ACCOUNT\_VERIFY, $t\_verify\_user\_id ) : false; |
|  |  | if( !$t\_account\_verification ) { |
|  |  | auth\_reauthenticate(); |
|  |  | $t\_user\_id = auth\_get\_current\_user\_id(); |
|  |  | } else { |
|  |  | $t\_verify\_user\_id = gpc\_get\_int( 'verify\_user\_id', 0 ); |
|  |  | $t\_account\_verification = (bool)$t\_verify\_user\_id; |
|  |  | if( $t\_account\_verification ) { |
|  |  | # Password reset request from verify.php - validate the confirmation hash |
|  |  | $f\_confirm\_hash = gpc\_get\_string( 'confirm\_hash' ); |
|  |  | $t\_token\_confirm\_hash = token\_get\_value( TOKEN\_ACCOUNT\_ACTIVATION, $t\_verify\_user\_id ); |
|  |  | if( $t\_token\_confirm\_hash == null || $f\_confirm\_hash !== $t\_token\_confirm\_hash ) { |
|  |  | trigger\_error( ERROR\_LOST\_PASSWORD\_CONFIRM\_HASH\_INVALID, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | # Make sure the token is not expired |
|  |  | if( null === token\_get\_value( TOKEN\_ACCOUNT\_VERIFY, $t\_verify\_user\_id ) ) { |
|  |  | trigger\_error( ERROR\_SESSION\_NOT\_VALID, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | # set a temporary cookie so the login information is passed between pages. |
|  |  | auth\_set\_cookies( $t\_verify\_user\_id ); |
|  |  | # fake login so the user can set their password |
|  |  | auth\_attempt\_script\_login( user\_get\_username( $t\_verify\_user\_id ) ); |
|  |  | $t\_user\_id = $t\_verify\_user\_id; |
|  |  | } else { |
|  |  | # Normal account update - authenticate the user |
|  |  | auth\_reauthenticate(); |
|  |  | $t\_user\_id = auth\_get\_current\_user\_id(); |
|  |  | } |
|  |  |  |
|  |  | auth\_ensure\_user\_authenticated(); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[verify.php](#diff-e1aed510834dc8c4efa11466eb87001dafe7387c67f37f4e699ea61224f99f99 "verify.php")

Show comments

[View file](/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/verify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -131,6 +131,7 @@ |
|  |  | <legend><span><?php echo lang\_get( 'edit\_account\_title' ) . ' - ' . string\_display\_line( $u\_username ) ?></span></legend> |
|  |  | <div class="space-10"></div> |
|  |  | <input type="hidden" name="verify\_user\_id" value="<?php echo $u\_id ?>"> |
|  |  | <input type="hidden" name="confirm\_hash" value="<?php echo string\_html\_specialchars( $f\_confirm\_hash ) ?>"> |
|  |  | <?php |
|  |  | echo form\_security\_field( 'account\_update' ); |
|  |  | # When verifying account, set a token and don't display current password |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `92d11a0`

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=80&v=4)](/dregad)

Copy link

Member

Author

### @dregad **[dregad](/dregad)** commented on `[92d11a0](/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00)` [May 12, 2024](#commitcomment-141928511)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Forgot to amend the commit message to set CVE ID -> [CVE-2024-34077](https://github.com/advisories/GHSA-93x3-m7pw-ppqm "CVE-2024-34077")

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F92d11a01b195a1b6717a2f205218089158ea6d00) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1f61fb36_20250111_112350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fsecurity%2Fadvisories%2FGHSA-93x3-m7pw-ppqm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fsecurity%2Fadvisories%2FGHSA-93x3-m7pw-ppqm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  76](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

# User account takeover in the signup/reset password process

High

[dregad](/dregad)
published
GHSA-93x3-m7pw-ppqm
May 12, 2024

## Package

composer

mantisbt
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<=2.26.1

## Patched versions

2.26.2

## Description

Insufficient access control in the registration and password reset process allows an attacker to reset another user's password and takeover their account, if the victim has an incomplete request pending.

The exploit is only possible while the verification token is valid, i.e for 5 minutes after the confirmation URL sent by e-mail has been opened, and the user did not complete the process by updating their password.

A brute-force attack calling account\_update.php with increasing user IDs is possible.

### Impact

A successful takeover would grant the attacker full access to the compromised account, including sensitive information and functionalities associated with the account, the extent of which depends on its privileges and the data it has access to.

### Patches

[92d11a0](https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00)

### Workarounds

Mitigate the risk by reducing the verification token's validity (change the value of the `TOKEN_EXPIRY_AUTHENTICATED` constant in *constants\_inc.php*).

### References

<https://mantisbt.org/bugs/view.php?id=34433>

### Credits

Alexander Christian, from Vantage Point Security Indonesia

### Severity

High

7.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

### CVE ID

CVE-2024-34077

### Weaknesses

[CWE-305](/advisories?query=cwe%3A305) [CWE-620](/advisories?query=cwe%3A620)

### Credits

* [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)
  [dregad](/dregad)
  Remediation developer
* [![@redna-xela](https://avatars.githubusercontent.com/u/54769255?s=40&v=4)](/redna-xela)
  [redna-xela](/redna-xela)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_3b410a68_20250111_112351.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D34433)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=34433)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0034433 | mantisbt | security | public | 2024-05-05 04:30 | 2024-05-12 12:34 |
|  | | | | | |
|
| Reporter | [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | major | Reproducibility | sometimes |
| Status | closed | Resolution | fixed |  | |
| OS | Debian GNU/Linux | OS Version | 12 (Bookworm) |  | |
| Product Version | 2.26.1 |  | | | |
| Target Version | 2.26.2 | Fixed in Version | 2.26.2 |  | |
|  | | | | | |
|
| Summary | 0034433: CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature | | | | |
| Description | The password reset and account registration feature is vulnerable to broken access control, it's possible to send HTTP request to /account\_update.php with verify\_user\_id that belongs to another user account. However, this exploit only works when the following criterial is met:   1. For password reset, target username and email must be known. 2. Link in the email must be clicked / opened, either by the user or "checked" automatically by some sort of security feature within the email. When the link is clicked / opened, data type 6 and value of 1 will be updated to the mantis\_tokens\_table. 3. Target user have not sent request to the /account\_update.php to change the password. | | | | |
| Steps To Reproduce | 1. Reset both user 1 (current user) and user 2 (target user) password or register two new users (e.g. user 1 and user 2). 2. Click the reset password link that belongs to user 2 (target user). In a real scenario, attack with user interaction (for example by tempting the target user to click the link using "phising" email) or security feature within email that will automatically "check" the link will be needed. 3. Open the reset password link received within email that belongs to user 1 (current user). 4. Follow the link until the edit account page is being shown. 5. Fill the form, submit it, intercept the request, tamper the value of verify\_user\_id parameter (e.g. from 2 to 3), and send the request. 6. Login using to an account which identified by the verify\_user\_id.   ===  Note: If the user 2 (target) previously have used either the password reset or user registration feature, and somehow the link has been clicked without the user performing actual password change to the /account\_update.php, then step 1 is not needed.  Since normal user won't be able to know which registration link has been clicked and which registration link belong to whom (don't have database access), brute force attack can be performed within the value of the verify\_user\_id parameter when sending request to the /account\_update.php | | | | |
| Additional Information | <https://github.com/mantisbt/mantisbt/security/advisories/GHSA-93x3-m7pw-ppqm>  I would like to be credited for the finding. Name: Alexander Christian Company: Vantage Point Security Indonesia | | | | |
| Tags | No tags attached. | | | | |
| Attached Files | [1 - user 1 reset password.png](file_download.php?file_id=12589&type=bug) (189,464 bytes)      [1 - user 1 reset password.png](file_download.php?file_id=12589&type=bug) (189,464 bytes)     [1.2 - user 2 reset password.png](file_download.php?file_id=12590&type=bug) (186,691 bytes)      [1.2 - user 2 reset password.png](file_download.php?file_id=12590&type=bug) (186,691 bytes)     [2 - data in mantis\_token\_table.png](file_download.php?file_id=12591&type=bug) (33,034 bytes)      [2 - data in mantis\_token\_table.png](file_download.php?file_id=12591&type=bug) (33,034 bytes)     [3 - reset password link.png](file_download.php?file_id=12592&type=bug) (17,670 bytes)      [3 - reset password link.png](file_download.php?file_id=12592&type=bug) (17,670 bytes)     [4 - open the reset password link that belong to user 1.png](file_download.php?file_id=12593&type=bug) (43,313 bytes)      [4 - open the reset password link that belong to user 1.png](file_download.php?file_id=12593&type=bug) (43,313 bytes)     [5.1 - data in the user table before submission.png](file_download.php?file_id=12594&type=bug) (7,691 bytes)      [5.1 - data in the user table before submission.png](file_download.php?file_id=12594&type=bug) (7,691 bytes)     [5.2 - original request.png](file_download.php?file_id=12595&type=bug) (107,444 bytes)      [5.2 - original request.png](file_download.php?file_id=12595&type=bug) (107,444 bytes)     [5.3 - tampered request.png](file_download.php?file_id=12596&type=bug) (174,651 bytes)      [5.3 - tampered request.png](file_download.php?file_id=12596&type=bug) (174,651 bytes)     [5.4 - data in the user table after submission.png](file_download.php?file_id=12597&type=bug) (7,225 bytes)      [5.4 - data in the user table after submission.png](file_download.php?file_id=12597&type=bug) (7,225 bytes)     [6 - login using user 2 with new creds.png](file_download.php?file_id=12598&type=bug) (189,778 bytes)      [6 - login using user 2 with new creds.png](file_download.php?file_id=12598&type=bug) (189,778 bytes)     [7 - login successful.png](file_download.php?file_id=12599&type=bug) (31,719 bytes)      [7 - login successful.png](file_download.php?file_id=12599&type=bug) (31,719 bytes)     [8.1 - brute force attempt.png](file_download.php?file_id=12600&type=bug) (134,193 bytes)      [8.1 - brute force attempt.png](file_download.php?file_id=12600&type=bug) (134,193 bytes)     [8.2 - brute force result.png](file_download.php?file_id=12601&type=bug) (241,922 bytes)      [8.2 - brute force result.png](file_download.php?file_id=12601&type=bug) (241,922 bytes) | | | | |
|  | | | | | |
|

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-05 05:39  developer    [~0068885](view.php?id=34433#c68885 "Direct link to note") | Many thanks for the detailed report, I'm looking into it. |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-05 11:15  developer    [~0068886](view.php?id=34433#c68886 "Direct link to note")  Last edited: 2024-05-05 11:16 | I had a look and can confirm the issue.  In fact it's even worse than you describe, because it is actually possible to reset the password of any user that has a pending TOKEN\_ACCOUNT\_VERIFY, without the attacker even owning an account, using a brute-force approach calling account\_update.php with increasing user IDs with a simple request like so:  ``` curl -X POST http://example.com/mantisbt/account_update.php --data 'verify_user_id=XXX&password=NEW_PWD&password_confirm= NEW_PWD' ```  For the record, even after this vulnerability is fixed, it will not be possible to be 100% bulletproof in a password reset/account creation scenario - if the attacker somehow obtains the confirmation hash, they will be able to reset the target user's password and there is nothing we can do about it (referring to point 2 of your steps to reproduce). |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-05 12:36  reporter    [~0068887](view.php?id=34433#c68887 "Direct link to note") | I agree with you, if the attacker gains access to the confirmation\_hash, then the account is highly likely to be compromised. What I'm concerned about in the 2nd step of step to reproduce is if the link got "accidentally opened" without changing the actual password, then the account will have the pending TOKEN\_ACCOUNT\_VERIFY.  However, I believe it should be sufficient to include the confirmation\_hash or a similar validation during password reset / registration, it can help to determine whether the current request is authorized to perform password changes for the given user\_id. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-05 12:59  developer    [~0068888](view.php?id=34433#c68888 "Direct link to note") | I believe it should be sufficient to include the confirmation\_hash or a similar validation during password reset / registration  Yep, this is precisely how I was planning to address this issue.  We use Github advisories to handle CVE requests and code review for security fixes. Please let me know your Github user id, so I can grant you access to a private fork for you to review and test the patch. |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-05 21:47  reporter    [~0068892](view.php?id=34433#c68892 "Direct link to note")  Last edited: 2024-05-06 01:51 | Sure, my Github user id is 54769255 (<https://github.com/redna-xela>) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 04:07  developer    [~0068893](view.php?id=34433#c68893 "Direct link to note") | my Github user id is 54769255  Thanks, I actually meant username, not id, sorry ;-)  I added you to the Github Advisory [GHSA-93x3-m7pw-ppqm](https://github.com/mantisbt/mantisbt/security/advisories/GHSA-93x3-m7pw-ppqm). You will also find a proposed patch there. Please review, feedback is welcome. |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-06 05:20  reporter    [~0068894](view.php?id=34433#c68894 "Direct link to note")  Last edited: 2024-05-06 05:22 | Thank you, I'll look into this and get back to you as soon as possible. |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-06 06:10  reporter    [~0068895](view.php?id=34433#c68895 "Direct link to note") | Thanks for waiting! I've reviewed the patches, and everything looks good. I've also confirmed that the previous vulnerability is no longer exploitable. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 06:26  developer    [~0068897](view.php?id=34433#c68897 "Direct link to note") | Thanks for the feedback, that was quick :-) Are you also happy with the advisory's wording, CVSS evaluation and selected CWE ?  I'm now waiting for a CVE ID to be assigned. |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-06 07:55  reporter    [~0068898](view.php?id=34433#c68898 "Direct link to note") | Thanks for asking. The advisory's wording, CVSS evaluation and selected CWE already looks good to me, but I would like to suggest the following if possible:   * Impact: "A successful attack could grant the attacker full access to the compromised account, including sensitive information or functionalities associated with the account" or something similar. * CVSS Scoring: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L * Workarounds: I think it's better if we provide the workaround according to what has been done, which is by adding additional validation to the /account\_update.php   For the CVSS scoring, I believe the impact could be worse depending on who uses it and what kind of data is being stored, hence the C:H and I:H. Attack Complexity changed to High because successful attack cannot be accomplished at will, but rather need some perquisites to be fulfilled.  I appreciate any feedback you may have. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 08:31  developer    [~0068899](view.php?id=34433#c68899 "Direct link to note")  Last edited: 2024-05-06 08:36 | Impact: "A successful attack could grant the attacker full access to the compromised account, including sensitive information or functionalities associated with the account"  OK sounds good.  C:H and I:H  This is somewhat subjective, and as you say depends on external factors, in particular the access level of the account that gets hijacked. I did not want to paint things too black considering that the probability of a successful attack is quite low  Attack Complexity changed to High because successful attack cannot be accomplished at will, but rather need some perquisites to be fulfilled.  I set it to low initially, because a brute-force attack *can* be launched at will and very easily, as explained in [0034433:0068886](/bugs/view.php?id=34433#c68886 "0034433: [2024-05-05 11:16] dregad"), even if the probability of success would be very low without some preparation work (e.g. social engineering to trick users so there are actual requests pending). Someone could just get lucky...  provide the workaround according to what has been done, which is by adding additional validation  The idea was to have a quick and simple to implement option to reduce the risk, until a patch was available.  I guess the point is kind of moot, as I would make the Advisory public together with the patch and 2.26.2 release, so anyone could either a) upgrade or b) apply the patch. |
|  | |
| [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)   [rednaxela](https://mantisbt.org/bugs/view_user_page.php?id=80929)  2024-05-06 09:34  reporter    [~0068900](view.php?id=34433#c68900 "Direct link to note") | Thanks for your input! I'm on board with you regarding the CVSS Scoring, I guess it would be better to use the previous score you've provided to avoid inflating the perceived risk. I also see your point about the workaround section, we can leave it as is.  I think that's all, no further feedback from me based on what we've discussed :) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 10:16  developer    [~0068901](view.php?id=34433#c68901 "Direct link to note") | Great, thanks for your collaboration. I reverted the CVSS change, now back to 7.3 - `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L` |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 10:37  developer    [~0068902](view.php?id=34433#c68902 "Direct link to note") | CVE-2024-34077 assigned |
|  | |

#### Related Changesets

| MantisBT: master-2.26 92d11a01  2024-05-05 20:09  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=27067) [Diff](https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00) | Validate confirm hash when updating account | | Affected Issues[0034433](/bugs/view.php?id=34433 "[closed] CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature") |
| --- | --- | --- | --- |
| mod - account\_update.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00) [File](https://github.com/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/account_update.php) |
| mod - verify.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/92d11a01b195a1b6717a2f205218089158ea6d00) [File](https://github.com/mantisbt/mantisbt/blob/92d11a01b195a1b6717a2f205218089158ea6d00/verify.php) |
| MantisBT: master-2.26 b12b1f8b  2024-05-05 20:18  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=27068) [Diff](https://github.com/mantisbt/mantisbt/commit/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a) | Use g\_reauthentication\_expiry to set token timeout | | Affected Issues[0034433](/bugs/view.php?id=34433 "[closed] CVE-2024-34077: Account Takeover in Password Reset and Account Registration Feature") |
| mod - verify.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a) [File](https://github.com/mantisbt/mantisbt/blob/b12b1f8b4b68da663b3690e83b98b5e9c8f39a7a/verify.php) |

**Powered by [MantisBT 2.28.0-dev-master-a94bae75d](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1929 seconds


