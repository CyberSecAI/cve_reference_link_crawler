<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'none';
                    connect-src https://D9HG3G8GS4-dsn.algolia.net;
                    font-src data: https://fonts.gstatic.com;
                    img-src 'self' https://avatars2.githubusercontent.com https://avatars.githubusercontent.com;
                    object-src 'none';
                    
                    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net ;
                    style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;
                    
                    ">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>2023 Security Audit — Homebrew</title>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.10.0">
<meta property="og:title" content="2023 Security Audit">
<meta name="author" content="p-linnane">
<meta property="og:locale" content="en_US">
<meta name="description" content="Homebrew had a security audit performed in 2023. This audit was funded by the Open Technology Fund and conducted by Trail of Bits. Trail of Bits’ report contained 25 items, of which 16 were fixed, 3 are in progress, and 6 are acknowledged by Homebrew’s maintainers. Below is the scope of testing, findings by severity, and mitigation and acknowledgements.">
<meta property="og:description" content="Homebrew had a security audit performed in 2023. This audit was funded by the Open Technology Fund and conducted by Trail of Bits. Trail of Bits’ report contained 25 items, of which 16 were fixed, 3 are in progress, and 6 are acknowledged by Homebrew’s maintainers. Below is the scope of testing, findings by severity, and mitigation and acknowledgements.">
<link rel="canonical" href="https://brew.sh/2024/07/30/homebrew-security-audit/">
<meta property="og:url" content="https://brew.sh/2024/07/30/homebrew-security-audit/">
<meta property="og:site_name" content="Homebrew">
<meta property="og:image" content="https://brew.sh/assets/img/homebrew-social-card.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-07-30T00:00:00+00:00">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="https://brew.sh/assets/img/homebrew-social-card.png">
<meta property="twitter:title" content="2023 Security Audit">
<meta name="twitter:site" content="@MacHomebrew">
<meta name="twitter:creator" content="@p-linnane">
<meta property="article:publisher" content="https://www.facebook.com/machomebrew/">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"p-linnane"},"dateModified":"2024-07-30T00:00:00+00:00","datePublished":"2024-07-30T00:00:00+00:00","description":"Homebrew had a security audit performed in 2023. This audit was funded by the Open Technology Fund and conducted by Trail of Bits. Trail of Bits’ report contained 25 items, of which 16 were fixed, 3 are in progress, and 6 are acknowledged by Homebrew’s maintainers. Below is the scope of testing, findings by severity, and mitigation and acknowledgements.","headline":"2023 Security Audit","image":"https://brew.sh/assets/img/homebrew-social-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://brew.sh/2024/07/30/homebrew-security-audit/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://brew.sh/assets/img/homebrew.svg"},"name":"p-linnane"},"url":"https://brew.sh/2024/07/30/homebrew-security-audit/"}</script>
<!-- End Jekyll SEO tag -->
    <link type="application/atom+xml" rel="alternate" href="https://brew.sh/atom.xml" title="Homebrew">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/assets/img/favicon.ico" sizes="48x48">
    <link rel="icon" href="/assets/img/homebrew.svg" sizes="any" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png">
    <link rel="stylesheet" href="/assets/css/style.css" type="text/css" media="screen">
    <link rel="preconnect" href="https://D9HG3G8GS4-dsn.algolia.net" crossorigin>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3/dist/style.min.css" as="style" media="screen" onload="this.onload=null;this.rel='stylesheet'">
    </head>
  <body>
    <div id="wrap">
      <div id="header">
        <img alt="Homebrew logo" src="/assets/img/homebrew.svg" width="128" height="128">
        <h1><a href="/">Homebrew</a></h1>
        <div id="search-container"></div>

        </div>

      <div id="post">
  <h2>2023 Security Audit</h2>
  <h3>30 July 2024</h3>
  <h3 class="author"><a href="https://github.com/p-linnane"><img class="avatar" src="https://avatars2.githubusercontent.com/p-linnane?v=3&amp;s=80" alt="p-linnane" width="40" height="40">p-linnane</a></h3>
  <div class="postcontent singlepostcontent">
    <p>Homebrew had a security audit performed in 2023. This audit was funded by the <a href="https://www.usagm.gov/networks/otf/">Open Technology Fund</a> and conducted by <a href="https://www.trailofbits.com">Trail of Bits</a>. Trail of Bits’ report contained 25 items, of which 16 were fixed, 3 are in progress, and 6 are acknowledged by Homebrew’s maintainers. Below is the scope of testing, findings by severity, and mitigation and acknowledgements.</p>

<p>You can read Trail of Bits’ blog post on the audit <a href="https://blog.trailofbits.com/2024/07/30/our-audit-of-homebrew/">here</a> and find the full public report <a href="https://github.com/trailofbits/publications/blob/eb9344f2261031a4be1be2f223e9b5bc535be6b9/reviews/2023-08-28-homebrew-securityreview.pdf">here</a>.</p>

<p>Homebrew’s maintainers and Project Leadership Commitee would like to thank Open Technology Fund and Trail of Bits for sponsoring and running this engagement. Our partnership directly improves the security of Homebrew and open source software in general.</p>

<p>Scope: <a href="https://github.com/Homebrew/brew">Homebrew/brew</a>, <a href="https://github.com/Homebrew/actions">Homebrew/actions</a>, <a href="https://github.com/Homebrew/formulae.brew.sh">Homebrew/formulae.brew.sh</a>, <a href="https://github.com/Homebrew/homebrew-test-bot">Homebrew/homebrew-test-bot</a>.</p>

<p>Findings by severity:</p>

<ul>
  <li>High: 0</li>
  <li>Medium: 14</li>
  <li>Low: 2</li>
  <li>Informational: 7</li>
  <li>Undetermined: 2</li>
</ul>

<p>Mitigation &amp; acknowledgement:</p>

<ol>
  <li>Path traversal during file caching
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/5aebde3ffdb38a7087ac992af144c957dd802788">Fixed</a></li>
    </ul>
  </li>
  <li>Sandbox escape via string injection
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17700/commits/f4e5e0c716585b072b5a401602f7847272ae5d4a">Fixed</a></li>
    </ul>
  </li>
  <li>Allow default rule in sandbox configuration is overly permissive
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/fea65f760332a26c116de4b675e07f679bf95b1c">Fixed</a></li>
    </ul>
  </li>
  <li>Special characters are allowed in package names and versions
    <ul>
      <li>Status: Acknowledged</li>
    </ul>
  </li>
  <li>Use of weak cryptographic digest in Formulary namespaces
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/310b5ecbe7c578c850f35d88b3ba9adbb291fc83">Fixed</a></li>
    </ul>
  </li>
  <li>Extraction is not sandboxed
    <ul>
      <li>Status: Acknowledged</li>
    </ul>
  </li>
  <li>Use of ldd on untrusted inputs
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/0fc9c9f81e2a740d733062e1b47df2b49a8363c6">Fixed</a></li>
    </ul>
  </li>
  <li>Formulas allow for external resources to be downloaded during the install step
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17703">In Progress</a></li>
    </ul>
  </li>
  <li>Use of Marshal
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/e466417cdf90c7dc8aab717cc5a591c1f31f9415">Fixed</a></li>
    </ul>
  </li>
  <li>Lack of sandboxing on Linux
    <ul>
      <li>Status: Acknowledged</li>
    </ul>
  </li>
  <li>Sandbox escape through domain socket pivot on macOS
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17734">In Progress</a></li>
    </ul>
  </li>
  <li>Formula privilege escalation through sudo
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17694/commits/2adf25dcaf8d8c66124c5b76b8a41ae228a7bb02">Fixed</a></li>
    </ul>
  </li>
  <li>Formula loading through SFTP, SCP, and other protocols
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17697/commits/8b0a4a98bf10b3441008906632648977b4a4f23e">Fixed</a></li>
    </ul>
  </li>
  <li>Sandbox allows changing permissions for important directories
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/92ef6ef7639b08b182fc0d9154cf51561365f749">Fixed</a></li>
    </ul>
  </li>
  <li>Homebrew supports only end-of-life versions of Ruby
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/16294/commits/987ebe3d6d0aaa27ab9ca2e95fe807e0718d4378">Fixed</a></li>
    </ul>
  </li>
  <li>Path traversal during bottling
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/commit/5aebde3ffdb38a7087ac992af144c957dd802788">Fixed</a></li>
    </ul>
  </li>
  <li>FileUtils.rm_rf does not check if files are deleted
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/brew/pull/17705">In Progress</a></li>
    </ul>
  </li>
  <li>Use of pull_request_target in GitHub Actions workflows
    <ul>
      <li>Status: Fixed: <a href="https://github.com/Homebrew/brew/commit/b9da669ef25c7da0757f5ae1d418985b19efb321">1</a>, <a href="https://github.com/Homebrew/actions/commit/323fc6399f7ddf2cb6ee7eb9d900dcd4deee76ec">2</a>.</li>
    </ul>
  </li>
  <li>Use of unpinned third-party workflow
    <ul>
      <li>Status: Fixed across the codebase via multiple PR’s.</li>
    </ul>
  </li>
  <li>Unpinned dependencies in formulae.brew.sh
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/formulae.brew.sh/commit/83ae27233abbf7b59db9aeb5bae311ecabf1add8">Fixed</a></li>
    </ul>
  </li>
  <li>Use of RSA for JSON API signing
    <ul>
      <li>Status: Acknowledged. Ed25519 was not an option when this was introduced. The next key reroll will use Ed25519.</li>
    </ul>
  </li>
  <li>Bottles beginning “-“ can lead to unintended options getting passed to rm
    <ul>
      <li>Status: <a href="https://github.com/Homebrew/homebrew-test-bot/pull/1062/commits/5565ba609cb6456d22741751465f088b44209813">Fixed</a></li>
    </ul>
  </li>
  <li>Code injection through inputs in multiple actions
    <ul>
      <li>Status: Fixed across the codebase via multiple PR’s.</li>
    </ul>
  </li>
  <li>Use of PGP for commit signing
    <ul>
      <li>Status: Acknowledged. Plans to remove the bot account using PGP have been established.</li>
    </ul>
  </li>
  <li>Unnecessary domain separation between signing key and key ID
    <ul>
      <li>Status: Acknowledged. Will be resolved with the next key reroll.</li>
    </ul>
  </li>
</ol>


    <div class="bottomborder"></div>

    <div id="latest-posts">
      <h3>Latest Posts</h3>
      <ul>
        

        

        <li>
          <a href="https://brew.sh/2024/11/19/homebrew-and-workbrew/">Homebrew and Workbrew</a>
        </li>
        

        

        <li>
          <a href="https://brew.sh/2024/10/01/homebrew-4.4.0/">4.4.0</a>
        </li>
        

        
        

        

        <li>
          <a href="https://brew.sh/2024/07/26/homebrew-summer-2024-hackathon/">Homebrew's Summer 2024 Hackathon</a>
        </li>
        

        

        <li>
          <a href="https://brew.sh/2024/05/14/homebrew-4.3.0/">4.3.0</a>
        </li>
        
      </ul>
    </div><form id="newsletter"
action="https://buttondown.email/api/emails/embed-subscribe/homebrew" method="post"
target="popupwindow"
  onsubmit="window.open('https://buttondown.email/homebrew', 'popupwindow')"
  class="embeddable-buttondown-form">
  <h3>
    <label for="bd-email">Subscribe to be notified about new posts</label>
  </h3>
  <p>
    <input id="newsletter-email" type="email" name="email" id="bd-email">
  </p>

  <input id="newsletter-submit" type="submit" value="Subscribe">
</form>
</div>
</div>

      </div>

    <a href="https://github.com/Homebrew/brew"><img id="forkme" src="/assets/img/forkme_right_gray_6d6d6d.svg" alt="Fork me on GitHub"></a>
    <script>
      function loadLanguage(lang) {
        if (lang === null) {
          return;
        } else if (lang === 'en') {
          window.location.assign('/');
        } else {
          window.location.assign('/' + lang);
        }
      }

      function loadAnchors() {
        anchors.options = {
          placement: 'left',
          visible: 'hover',
        };
        anchors.add('#page > h2, #page > h3, #page > h4, #page > h5, #page > h6');
      };

      function loadSearch(lang, site) {
        docsearch(Object.assign(
          { searchParameters: { facetFilters: ['site: ' + site] } },
          { initialQuery: new URLSearchParams(window.location.search).get('search') },
          { placeholder: "Search Homebrew" },
          {"apiKey":"e3369d62b2366b374c54b2c5a2835a00","indexName":"brew_all","appId":"D9HG3G8GS4","container":"#search-container"}
        ));
      };

      

      let escapeHTML = (identity) => identity;

      if (window.trustedTypes && window.trustedTypes.createPolicy) {
        let policy = trustedTypes.createPolicy(
          "forceInner",
          {
            createHTML: (to_escape) => to_escape
          }
        );
        escapeHTML = (html) => policy.createHTML(html);
      };

      async function setupCopyables() {
        if (navigator.clipboard) {
          for (const element of document.getElementsByClassName('copyable')) {
            let text = element.innerText.trim();
            if (text.startsWith('$')) {
              text = text.substr(1).trimLeft();
            }


            const button = document.createElement('button');
            button.innerHTML = escapeHTML('📋');
            button.setAttribute('aria-label', 'Copy to clipboard');
            button.onclick = () => {
              navigator.clipboard.writeText(text);
              button.innerHTML = escapeHTML('✅');
              setTimeout(() => button.innerHTML=escapeHTML('📋'), 1000);
            }
            element.appendChild(button);
          }
        }
      }

      window.addEventListener("DOMContentLoaded", function() {
        setupCopyables();
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"
            integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys="
            crossorigin="anonymous"
            onload="loadAnchors()"
            async></script>
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3/dist/umd/index.min.js"
            onload="loadSearch('', '')"
            async></script>
  </body>
</html>
