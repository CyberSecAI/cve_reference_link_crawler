Based on the provided information, this content relates to CVE-2021-47494.

**Root Cause:**
The root cause of the vulnerability is a broken locking mechanism for management frame registrations in the cfg80211 subsystem of the Linux kernel. The list of registrations was protected by a lock associated with each `wdev` (wireless device), however, the `cfg80211_mgmt_registrations_update()` function iterated through these lists without holding all the necessary spinlocks.

**Weaknesses/Vulnerabilities:**
- **Race condition:** The primary vulnerability is a race condition due to incorrect locking. The `cfg80211_mgmt_registrations_update()` function iterates through multiple `wdev` lists without holding the correct locks, leading to concurrent access and modification of the list.
- **List corruption:** The race condition can result in corruption of the management frame registration lists.

**Impact of Exploitation:**
- **Kernel crash:** List corruption can lead to unpredictable behavior and potentially kernel crashes, which can result in denial of service.

**Attack Vectors:**
The vulnerability can be triggered by:
- Registering and unregistering management frame handlers via the cfg80211 management interface.

**Required Attacker Capabilities/Position:**
- An attacker needs the capability to interact with the cfg80211 subsystem by registering or unregistering management frame handlers. This typically involves a user with sufficient privileges to interact with the network stack.

**Additional Notes:**
The provided patches move the spinlock from the `wdev` struct to the `wiphy`/`rdev` struct. This ensures that only one lock needs to be held to iterate through all lists which are related to a wiphy, addressing the issue.