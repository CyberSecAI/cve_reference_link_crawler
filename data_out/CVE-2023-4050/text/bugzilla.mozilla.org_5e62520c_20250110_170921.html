

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1843038)
* [XML](/show_bug.cgi?ctype=xml&id=1843038)

Closed
[Bug 1843038](/show_bug.cgi?id=1843038)
(CVE-2023-4050)

Opened 2 years ago
Closed 1 years ago

# Stack buffer overflow in NSSCipherStrategy::DeserializeKey

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Stack buffer overflow in NSSCipherStrategy::DeserializeKey

## Categories

### (Core :: Storage: Quota Manager, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Storage%3A%20Quota%20Manager#Storage%3A%20Quota%20Manager)

Storage: Quota Manager
▾

Core :: Storage: Quota Manager
For bugs in Gecko's centralized management of storage and disk usage quota in user profiles.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20Quota%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20Quota%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Storage%3A%20Quota%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

117 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox-esr115 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 116+ | fixed |
| firefox-esr115 | 116+ | fixed |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 | + | fixed |
| firefox117 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: markbrand, Assigned: nika)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e58e1c977570062926a2fa21d607eb7b?d=mm&size=40)  [markbrand](/user_profile?user_id=730689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2b84b1a415615d22d7afc6554020d164?d=mm&size=40)  [jjalkanen](/user_profile?user_id=689836)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1641178](/show_bug.cgi?id=1641178 "RESOLVED FIXED - Use a sufficiently secure encryption scheme")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4050

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [avaida](/user_profile?user_id=488993) | [qe-verify](#a931759_488993 "1 years ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [key\_overflow\_patch.diff](/attachment.cgi?id=9343481)  [2 years ago](#c0)  [Mark Brand](/user_profile?user_id=730689)   3.14 KB, patch |  | [Details](/attachment.cgi?id=9343481&action=edit) | [Diff](/attachment.cgi?id=9343481&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1843038&attachment=9343481) |
| --- | --- | --- |
| [server.py](/attachment.cgi?id=9343483)  [2 years ago](#c1)  [Mark Brand](/user_profile?user_id=730689)   562 bytes, text/plain |  | [Details](/attachment.cgi?id=9343483&action=edit) |
| [key\_overflow.asan.txt](/attachment.cgi?id=9343484)  [2 years ago](#c2)  [Mark Brand](/user_profile?user_id=730689)   10.65 KB, text/plain |  | [Details](/attachment.cgi?id=9343484&action=edit) |
| [Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!](/attachment.cgi?id=9343735)  [1 years ago](#c4)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c11 "1 years ago")  diannaS : [approval-mozilla-esr102+](#c13 "1 years ago")  diannaS : [approval-mozilla-esr115+](#c13 "1 years ago")  dveditz : [sec-approval+](#c8 "1 years ago") | [Details](/attachment.cgi?id=9343735&action=edit) | [Review](/attachment.cgi?id=9343735) |
| [advisory.txt](/attachment.cgi?id=9345944)  [1 years ago](#c16)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   242 bytes, text/plain |  | [Details](/attachment.cgi?id=9345944&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1843038#c0)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843038&comment_id=16493153 "1 revision") |
|  | |

Attached patch

[key\_overflow\_patch.diff](attachment.cgi?id=9343481&action=diff)
— [Details](attachment.cgi?id=9343481&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1843038&attachment=9343481)

When deserializing a DecryptingInputStream, we call NSSCipherStrategy::DeserializeKey

on an untrusted input:

```
template <typename CipherStrategy>
bool DecryptingInputStream<CipherStrategy>::Deserialize(
    const mozilla::ipc::InputStreamParams& aParams) {
  MOZ_ASSERT(aParams.type() ==
             mozilla::ipc::InputStreamParams::TEncryptedFileInputStreamParams);
  const auto& params = aParams.get_EncryptedFileInputStreamParams();

  nsCOMPtr<nsIFileInputStream> stream;
  nsFileInputStream::Create(NS_GET_IID(nsIFileInputStream),
                            getter_AddRefs(stream));
  nsCOMPtr<nsIIPCSerializableInputStream> baseSerializable =
      do_QueryInterface(stream);

  if (NS_WARN_IF(
          !baseSerializable->Deserialize(params.fileInputStreamParams()))) {
    return false;
  }

  Init(WrapNotNull<nsCOMPtr<nsIInputStream>>(std::move(stream)),
       params.blockSize());
  mKey.init(mCipherStrategy.DeserializeKey(params.key())); // <-- here
  if (NS_WARN_IF(
          NS_FAILED(mCipherStrategy.Init(CipherMode::Decrypt, params.key())))) {
    return false;
  }

  return true;
}

```

This asserts that the size is correct, but does not check it at runtime in a release build:

```
NSSCipherStrategy::KeyType NSSCipherStrategy::DeserializeKey(
    const Span<const uint8_t>& aSerializedKey) {
  KeyType res;
  MOZ_ASSERT(res.size() == aSerializedKey.size());
  std::copy(aSerializedKey.cbegin(), aSerializedKey.cend(), res.begin());
  return res;
}

```

This means that the `std::copy` call can overflow the allocated stack buffer. I've provided a patch which will convert an outgoing request body of size 0x1234 to an EncryptedInputStream and trigger this issue. I don't seem to be able to attach multiple files to the report, so I'll add my server script as a comment.

I've only tested this on linux, where the incoming IPC message is processed on the main thread. In my build this means that this appears not to be exploitable (there is nothing on the stack which can be corrupted that is used prior to the stack-cookie check), so I'm reporting this without applying a deadline.

I've still marked this as a security bug, as it may still be exploitable on other platforms/compilers or if there are situations in which other threads handle incoming IPC messages; I'm not sufficiently familiar with Firefox' threading model.

|  | [Mark Brand](/user_profile?user_id=730689)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1843038#c1)• 2 years ago |
|  | |

Attached file
[server.py](attachment.cgi?id=9343483)
— [Details](attachment.cgi?id=9343483&action=edit)

|  | [Mark Brand](/user_profile?user_id=730689)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1843038#c2)• 2 years ago |
|  | |

Attached file
[key\_overflow.asan.txt](attachment.cgi?id=9343484)
— [Details](attachment.cgi?id=9343484&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a9984_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → Storage: Quota ManagerProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a28036_406194)• 2 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1843038#c3)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843038&comment_id=16493811 "1 revision") |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

~~Span is a bounds-checked class intended to avoid this problem -- completely defeated by using a raw std::copy()~~

[sorry, the Span is the source, not the dest]

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a69911_428608)• 1 years ago |

[Attachment #9343483](/attachment.cgi?id=9343483&action=edit "server.py") -
Attachment mime type: text/x-python → text/plain

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1843038#c4)• 1 years ago |
|  | |

Attached file
[Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!](attachment.cgi?id=9343735)
— [Details](attachment.cgi?id=9343735&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a95053_600971)• 1 years ago |

Assignee: nobody → nikaStatus: NEW → ASSIGNED

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a95492_406194)• 1 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1843038#c5)• 1 years ago |
|  | |

Comment on [attachment 9343735](/attachment.cgi?id=9343735 "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") [[details]](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!")

[Bug 1843038](/show_bug.cgi?id=1843038 "RESOLVED FIXED - Stack buffer overflow in NSSCipherStrategy::DeserializeKey") - Make CypherStrategy::DeserializeKey fallible, r=janv!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: While it is very easy to figure out what the issue is from the patch, as noted in [comment 0](/show_bug.cgi?id=1843038#c0 "RESOLVED FIXED - Stack buffer overflow in NSSCipherStrategy::DeserializeKey") it is somewhat difficult, even with ACE in the child (which would be required to trigger this bug), to clobber the stack in a productive way and create a sandbox escape.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1641178](/show_bug.cgi?id=1641178 "RESOLVED FIXED - Use a sufficiently secure encryption scheme")
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I expect the patch should apply to earlier branches unchanged, as the impacted files haven't been modified much since they were introduced.
* **How likely is this patch to cause regressions; how much testing does it need?**: This is unlikely to cause regressions, upgrading an assertion to a deserialization failure.
* **Is Android affected?**: Yes

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential IPC sandbox escape/security bug
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is unlikely to cause regressions, upgrading an assertion to a deserialization failure.
* **String changes made/needed**: None
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potential IPC sandbox escape/security bug
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is unlikely to cause regressions, upgrading an assertion to a deserialization failure.
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: sec-approval?
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-release?
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-esr115?
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a108621_75935)• 1 years ago |

[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1641178](/show_bug.cgi?id=1641178 "RESOLVED FIXED - Use a sufficiently secure encryption scheme")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a108700_75935)• 1 years ago |

[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-release? → approval-mozilla-esr102?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a117959_151407)• 1 years ago |

Severity: -- → S3Priority: -- → P2

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1843038#c6)• 1 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:nika, could you consider increasing the severity of this security bug?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_high_security.py).

Flags: needinfo?(nika)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1843038#c7)• 1 years ago |
|  | |

The bug is marked as tracked for firefox116 (beta) and tracked for firefox117 (nightly). However, the bug still has low severity.

:jstutte, could you please increase the severity for this tracked bug? If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#tracked_attention.py).

Flags: needinfo?(jstutte)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a187811_534482)• 1 years ago |

Flags: needinfo?(nika)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a189136_151407)• 1 years ago |

Severity: S3 → S2

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a189152_151407)• 1 years ago |

Flags: needinfo?(jstutte)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1843038#c8)• 1 years ago |
|  | |

Comment on [attachment 9343735](/attachment.cgi?id=9343735 "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") [[details]](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!")

[Bug 1843038](/show_bug.cgi?id=1843038 "RESOLVED FIXED - Stack buffer overflow in NSSCipherStrategy::DeserializeKey") - Make CypherStrategy::DeserializeKey fallible, r=janv!

sec-approval+ = dveditz

[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a462798_1689)• 1 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1843038#c9)• 1 years ago |
|  | |

Pushed by nlayzell@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/08c2e3435979>
Make CypherStrategy::DeserializeKey fallible, r=janv

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1843038#c10)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/08c2e3435979>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 years ago
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 117 Branch

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1843038#c11)• 1 years ago |
|  | |

Comment on [attachment 9343735](/attachment.cgi?id=9343735 "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") [[details]](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!")

[Bug 1843038](/show_bug.cgi?id=1843038 "RESOLVED FIXED - Stack buffer overflow in NSSCipherStrategy::DeserializeKey") - Make CypherStrategy::DeserializeKey fallible, r=janv!

Approved for 116.0b8

[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1843038#c12)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/83e23781e1c2>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a632406_690067)• 1 years ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1843038#c13)• 1 years ago |
|  | |

Comment on [attachment 9343735](/attachment.cgi?id=9343735 "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") [[details]](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!")

[Bug 1843038](/show_bug.cgi?id=1843038 "RESOLVED FIXED - Stack buffer overflow in NSSCipherStrategy::DeserializeKey") - Make CypherStrategy::DeserializeKey fallible, r=janv!

Approved for 102.14esr

Approved for 115.1esr

[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-esr115?
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-esr115+
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-esr102?
[Attachment #9343735](/attachment.cgi?id=9343735&action=edit "Bug 1843038 - Make CypherStrategy::DeserializeKey fallible, r=janv!") -
Flags: approval-mozilla-esr102+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1843038#c14)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/f128b27632b3>

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1843038#c15)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/3a68be3f458d>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a635461_690067)• 1 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a931759_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a1253569_486733)• 1 years ago |

Whiteboard: [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1843038#c16)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9345944)
— [Details](attachment.cgi?id=9345944&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a15189153_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843038#a15195673_1689)• 1 year ago |

Alias: CVE-2023-4050

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1843038#c17)• 7 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1843038&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mark Brand](/user_profile?user_id=730689)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

