The provided content relates to a memory leak vulnerability in the AMD display driver within the Linux kernel, specifically during suspend/resume cycles. All three provided code changes address the same root cause and provide an identical fix, which is reflected by the identical "Upstream commit" message.

**Root cause of vulnerability:**
- The `dm_dmub_hw_init` function in `drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c` was allocating memory for the DMUB server wrapper (`dc_dmub_srv_create`) every time it was called. This function was called during resume, leading to memory leaks in suspend/resume scenarios because the previous allocation was not freed.

**Weaknesses/vulnerabilities present:**
- Memory leak: Repeated allocation of memory without freeing the previous allocation leads to memory exhaustion over time.

**Impact of exploitation:**
- The vulnerability could lead to memory exhaustion, potentially causing system instability or denial of service. In repeated suspend/resume cycles, the system would eventually exhaust available memory.

**Attack vectors:**
- Repeated suspend and resume cycles.

**Required attacker capabilities/position:**
- An attacker needs to be able to trigger system suspend and resume cycles. This usually doesn't require special access to a system and is part of its normal behavior.

**Technical Details:**
- The fix introduces a check to allocate memory for the DMUB server wrapper only if it hasn't been allocated already by adding `if (!adev->dm.dc->ctx->dmub_srv)`. This ensures that memory is allocated once during initialization and reused for subsequent calls during suspend and resume.
- The vulnerable code is located in the `dm_dmub_hw_init` function.
- The memory allocation is performed by the `dc_dmub_srv_create` function, which internally uses `kzalloc`.
- The changes are in the `drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c` file.
- The problematic code was:
```c
adev->dm.dc->ctx->dmub_srv = dc_dmub_srv_create(adev->dm.dc, dmub_srv);
```
- The fix is:
```c
if (!adev->dm.dc->ctx->dmub_srv)
    adev->dm.dc->ctx->dmub_srv = dc_dmub_srv_create(adev->dm.dc, dmub_srv);
```
- No deallocation of memory is included in the code. This is because once allocated, the memory for  `dmub_srv` persists and is released when the system shuts down.

The code change addresses a memory leak during suspend/resume cycles in the AMD display driver. This is achieved by checking if the required memory has been allocated before allocating it, thus preventing duplicate allocations and a potential memory leak during the `dm_dmub_hw_init` function call.