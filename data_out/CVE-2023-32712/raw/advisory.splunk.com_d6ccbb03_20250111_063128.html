<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title> SVD-2023-0606 | Splunk Vulnerability Disclosure</title><meta property="og:site_name" content="Splunk Vulnerability Disclosure"><meta property="og:site_description" content="Splunk Vulnerability Disclosure"><meta property="og:title" content="Unauthenticated Log Injection in Splunk Enterprise"><meta property="og:description" content="In Splunk Enterprise versions below 9.1.0.2, 9.0.5.1, and 8.2.11.2, an attacker can inject American National Standards Institute (ANSI) escape codes into Splunk log files that, when a vulnerable terminal application reads them, can potentially, at worst, result in possible code execution in the vulnerable application. This attack requires a user to use a terminal application that supports the translation of ANSI escape codes to read the malicious log file locally in the vulnerable terminal, and to perform additional user interaction to exploit. Universal Forwarder versions 9.1.0.1, 9.0.5, 8.2.11, and lower can be vulnerable in the following situations: * The forwarders have been configured to have management services active * The active management services are exposed and accessible from the network By default, all Universal Forwarder 9.0 and 9.1 versions bind management services to the local machine (localhost) and are not vulnerable in this specific configuration. See [SVD-2022-0605](https://advisory.splunk.com/advisories/SVD-2022-0605) for more information. Universal Forwarder versions 9.1 and higher use Unix Domain Sockets (UDS) for communication, further reducing the potential attack surface. The vulnerability does not directly affect Splunk Enterprise or Splunk Universal Forwarder. The indirect impact on the Splunk Enterprise instance and Universal Forwards can vary significantly depending on the permissions in the vulnerable terminal application and where and how the user reads the malicious log file. For example, users can copy the malicious file from the Splunk Enterprise instance and read it on their local machine."><meta property="og:locale" content="en-US"><meta property="og:url" content=""><meta property="og:image" content="/assets/img/logo_color.jpg"><link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.png"/><link rel="stylesheet" href="/assets/css/datatables.css"><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="/assets/css/fontawesome-free-6.2.0.css"> <script src="/assets/js/jquery-3.7.1.js"></script> <script src="/assets/js/jquery.greedy-navigation.js"></script> <script src="/assets/js/datatables.js"></script> <script src="/assets/js/main.js"></script></head><body class="layout--advisory"><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav class="greedy-nav"> <a class="site-logo" href="https://www.splunk.com/"><img src="/assets/img/logo.svg" alt=" "></a><ul class="visible-links"><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/" class="advisory-link">Home</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/report" class="advisory-link">Report a Vulnerability</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/faqs" class="advisory-link">FAQs</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html" class="advisory-link">Mailing List</a></li></ul><button class="greedy-nav__toggle hidden advisory-show-on-mobile" type="button"> <span class="visually-hidden">Toggle menu</span><div class="navicon"></div></button><ul class="hidden-links hidden advisory-show-on-mobile"><li class="masthead__menu-item"> <a href="/">Home</a></li><li class="masthead__menu-item"> <a href="/report">Report a Vulnerability</a></li><li class="masthead__menu-item"> <a href="/faqs">FAQs</a></li><li class="masthead__menu-item"> <a href="https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html">Mailing List</a></li></ul></nav></div></div></div><div class="initial-content"><div id="main" role="main"><article class="splash"><section class="page__content"><div class="advisory-show-on-mobile"><p>&nbsp;</p></div><div id="advisory" role="main"><div class="advisory-title"><h1>Unauthenticated Log Injection in Splunk Enterprise</h1></div><div><div class="advisory-row"><div class="advisory-column-left"><p><b>Advisory&nbsp;ID:</b>&nbsp;SVD-2023-0606</p></div><div class="advisory-column-right"><p><b>CVE&nbsp;ID:</b>&nbsp;<a href="https://www.cve.org/CVERecord?id=CVE-2023-32712" class="advisory-no-link advisory-link">CVE-2023-32712</a></p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>Published:</b>&nbsp;2023-06-01</p></div><div class="advisory-column-right"><p><b>Last&nbsp;Update:</b>&nbsp;2023-10-18</p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>CVSSv3.1&nbsp;Score:</b>&nbsp;8.6,&nbsp;High</p></div><div class="advisory-column-right"><p><b>CVSSv3.1&nbsp;Vector:</b>&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H" class="advisory-no-link advisory-link">CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H</a></p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>CWE:</b>&nbsp;<a href="https://cwe.mitre.org/data/definitions/117.html" class="advisory-no-link advisory-link">CWE-117</a></p></div><div class="advisory-column-right"><p><b>Bug&nbsp;ID:</b>&nbsp;SPL-235259</p></div></div></div><div><h2 id="description">Description</h2><p>In Splunk Enterprise versions below 9.1.0.2, 9.0.5.1, and 8.2.11.2, an attacker can inject American National Standards Institute (ANSI) escape codes into Splunk log files that, when a vulnerable terminal application reads them, can potentially, at worst, result in possible code execution in the vulnerable application. This attack requires a user to use a terminal application that supports the translation of ANSI escape codes to read the malicious log file locally in the vulnerable terminal, and to perform additional user interaction to exploit.</p><p>Universal Forwarder versions 9.1.0.1, 9.0.5, 8.2.11, and lower can be vulnerable in the following situations:</p><ul><li>The forwarders have been configured to have management services active</li><li>The active management services are exposed and accessible from the network</li></ul><p>By default, all Universal Forwarder 9.0 and 9.1 versions bind management services to the local machine (localhost) and are not vulnerable in this specific configuration. See <a href="https://advisory.splunk.com/advisories/SVD-2022-0605">SVD-2022-0605</a> for more information. Universal Forwarder versions 9.1 and higher use Unix Domain Sockets (UDS) for communication, further reducing the potential attack surface.</p><p>The vulnerability does not directly affect Splunk Enterprise or Splunk Universal Forwarder. The indirect impact on the Splunk Enterprise instance and Universal Forwards can vary significantly depending on the permissions in the vulnerable terminal application and where and how the user reads the malicious log file. For example, users can copy the malicious file from the Splunk Enterprise instance and read it on their local machine.</p><h2 id="solution">Solution</h2><p>For Splunk Enterprise, upgrade to version 8.2.11.2, 9.0.5.1, or 9.1.0.2.</p><p>For Splunk Universal Forwarder, upgrade to version 8.2.12, 9.0.6, or 9.1.1.</p><p>This vulnerability does not affect Splunk Cloud Platform instances directly. Where possible, Splunk Cloud Platform customers with on-premises Splunk infrastructure, including universal and heavy forwarders, deployment servers, and license servers, must upgrade that infrastructure to reduce their attack surface.</p><p>Upgrading or mitigating the issue prevents future log injections. However, logs that were created before performing the upgrades or mitigations can still pose a risk. Where applicable, remove Splunk Enterprise log files in the $SPLUNK_HOME/var/log/splunk/ directory.</p><h2 id="product-status">Product Status</h2><div><table class="advisory-table" id="advisory-table"><thead class="advisory-th"><tr><th>Product</th><th>Version</th><th>Component</th><th>Affected Version</th><th>Fix Version</th></tr></thead><tbody><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">8.2</td><td class="advisory-td" label="Component">-</td><td class="advisory-td" label="Affected Version">8.2.0 to 8.2.11.1</td><td class="advisory-td" label="Fix Version">8.2.11.2</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">9.0</td><td class="advisory-td" label="Component">-</td><td class="advisory-td" label="Affected Version">9.0.0 to 9.0.5</td><td class="advisory-td" label="Fix Version">9.0.5.1</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">9.1</td><td class="advisory-td" label="Component">-</td><td class="advisory-td" label="Affected Version">9.1.0 to 9.1.0.1</td><td class="advisory-td" label="Fix Version">9.1.0.2</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Universal Forwarder</td><td class="advisory-td" label="Version">8.2</td><td class="advisory-td" label="Component">REST API</td><td class="advisory-td" label="Affected Version">8.2.11 and below</td><td class="advisory-td" label="Fix Version">8.2.12</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Universal Forwarder</td><td class="advisory-td" label="Version">9.0</td><td class="advisory-td" label="Component">REST API</td><td class="advisory-td" label="Affected Version">9.0.0 to 9.0.5</td><td class="advisory-td" label="Fix Version">9.0.6</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Universal Forwarder</td><td class="advisory-td" label="Version">9.1</td><td class="advisory-td" label="Component">REST API</td><td class="advisory-td" label="Affected Version">9.1.0 to 9.1.0.1</td><td class="advisory-td" label="Fix Version">9.1.1</td></tr></tbody></table></div><h2 id="mitigations-and-workarounds">Mitigations and Workarounds</h2><p>As a partial mitigation, users can protect themselves from log injections via ANSI escape characters in general, by disabling the ability to process ANSI escape codes in terminal applications or using a terminal application that supports the filtering of ANSI codes.</p><p>For Universal Forwarder versions 8.2.x, configure management services to only accept inbound connections from the local machine (localhost).</p><p>For Universal Forwarder versions 9.0.x and 9.1.x, confirm that management services only accept inbound connections from localhost.</p><p>To deactivate remote management services on Universal Forwarder:</p><ul><li>In the <a href="https://docs.splunk.com/Documentation/Splunk/latest/Admin/Serverconf">server.conf</a> configuration file on UF, under the [httpServer] stanza, give the <code class="language-plaintext highlighter-rouge">disableDefaultPort</code> setting a value of <code class="language-plaintext highlighter-rouge">true</code>, or, under the [general] stanza, give the <code class="language-plaintext highlighter-rouge">allowRemoteLogin</code> setting a value of <code class="language-plaintext highlighter-rouge">never</code>.</li></ul><p>See <a href="https://docs.splunk.com/Documentation/Splunk/latest/Security/EnableTLSCertHostnameValidation#Configure_universal_forwarder_management_security">Configure universal forwarder management security</a> in Securing Splunk Enterprise for more information on deactivating remote management services. For improved overall security on UF versions 9.1.x and higher, where applicable, consider configuring the UF to use UDS for communication. In the <a href="https://docs.splunk.com/Documentation/Splunk/latest/Admin/Serverconf">server.conf</a> configuration file, under the [httpServer] stanza, give the <code class="language-plaintext highlighter-rouge">mgmtMode</code> setting a value of <code class="language-plaintext highlighter-rouge">UDS</code> (or <code class="language-plaintext highlighter-rouge">default</code>).</p><h2 id="detections">Detections</h2><ul><li><a href="https://research.splunk.com/application/de3908dc-1298-446d-84b9-fa81d37e959b">Splunk Unauthenticated Log Injection Web Service Log</a></li></ul><p>This detection search provides information on possible ANSI Log injection on Splunk Enterprise.</p><h2 id="severity">Severity</h2><p>Splunk rates the vulnerability as High, 8.6, with a CVSS Vector of  CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H.</p><p><strong>Attack Vector:</strong></p><p>The attack initially occurs at the network layer through an HTTP web request from the attacker to the vulnerable Splunk Enterprise instance. However, this initial attack vector does not align with the CVSS metrics for “Attack Vector.” In most vulnerabilities that Splunk rates, the vector would align with those metrics, but the CVSS specification provides two qualifications for the “Local” metric. Specifically, the second qualification states the following:</p><p><em>the attacker relies on User Interaction by another person to perform actions required to exploit the vulnerability (e.g., using social engineering techniques to trick a legitimate user into opening a malicious document).</em>”</p><p>The attack mirrors this example, requiring the user to open a malicious document, for example, the injected log file. Because of this, Splunk rated the Attack Vector as “Local” per the CVSS v3.1 Specification Document.</p><p><strong>Attack Complexity:</strong></p><p>The vulnerability requires no additional preparation from the attacker, and there are no extenuating circumstances for exploiting the vulnerability.</p><p><strong>Privileges Required:</strong></p><p>The vulnerability does not require attacker privileges and occurs through an unauthenticated request to the Splunk Enterprise instance.</p><p><strong>User Interaction:</strong></p><p>The vulnerability requires users to open or read the malicious document, file, or log for successful execution.</p><p><strong>Scope:</strong></p><p>The vulnerability does not affect Splunk Enterprise directly, only indirectly through the authorized permissions in the user’s terminal. The vulnerability directly affects the user’s terminal, which falls outside of Splunk’s security authority. As such, the vulnerability qualifies for a Change in Scope.</p><p><strong>Confidentiality/Integrity/Availability:</strong></p><p>The vulnerability allows for the potential for remote code execution within the context of a user’s terminal. Because of this, out of an abundance of caution, Splunk rated the impact on the user’s terminal as High for all three vectors. The indirect impact on Splunk Enterprise might vary significantly depending on how the user configured permissions in their terminal application.</p><h2 id="acknowledgments">Acknowledgments</h2><p>STÖK / Fredrik Alexandersson</p><h2 id="changelog">Changelog:</h2><p>2023-11-16: Updated Mitigation section. allowRemoteLogin is a server.conf setting, not web.conf.</p><p>2023-08-30: Expanded the scope of affected products to include Splunk Universal Forwarder</p><p>2023-07-31: Updated and expanded the Description, Solutions, Product Status, Mitigations, Detections, and Severity section to include two related, novel vulnerabilities and to clarify technical inaccuracies. Updated the Product Fix versions from “9.1.0.1, 9.0.5, 8.2.11” to “9.1.0.2, 9.0.5.1, 8.2.11.1” to reflect the fixes for the newly remedied vulnerabilities.</p></div></div></section></article></div></div><div id="footer" class="page__footer"><footer><div class="page__footer-follow"><ul class="social-icons"><li><a href="mailto:prodsec@splunk.com" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-regular fa-envelope advisory-icon-i"></i> Email</a></li><li><a href="/feed.xml" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-solid fa-rss advisory-icon-i"></i> RSS Feed</a></li><li><a href="https://login.splunk.com/page/sso_redirect?type=portal" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-solid fa-link advisory-icon-i"></i> Support</a></li></ul></div><div class="page__footer-copyright">&copy; 2005 - 2025 Splunk Inc. All rights reserved.</div><div class="page__footer-links"><a href="https://www.splunk.com/en_us/legal.html" rel="nofollow noopener noreferrer">Legal</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.splunk.com/en_us/legal/privacy/privacy-policy.html" rel="nofollow noopener noreferrer">Privacy<a/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.splunk.com/en_us/legal/terms/terms-of-use.html" rel="nofollow noopener noreferrer">Website Terms of Use<a/></div></footer></div></body></html>
