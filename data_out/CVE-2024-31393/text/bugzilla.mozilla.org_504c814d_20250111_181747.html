

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1879739)
* [XML](/show_bug.cgi?ctype=xml&id=1879739)

Closed
[Bug 1879739](/show_bug.cgi?id=1879739)
(CVE-2024-31393)

Opened 11 months ago
Closed 11 months ago

# JavaScript URLs load when dragged to address bar, bypassing restriction on them (Potential UXSS)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

JavaScript URLs load when dragged to address bar, bypassing restriction on them (Potential UXSS)

## Categories

### (Firefox for iOS :: Browser, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=Browser#Browser)

Browser
▾

Firefox for iOS :: Browser
The UI for browsing the web.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Browser&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Browser&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=Browser)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [124](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=124) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 124 |  |

## People

### (Reporter: sdna.muneaki.nishimura, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40)  [sdna.muneaki.nishimura](/user_profile?user_id=507051)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

2 people

## References

### ( [URL](https://csrf.jp/2024/fxios-jsurl.php "https://csrf.jp/2024/fxios-jsurl.php") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[csrf.jp/2024/fxios-jsurl.php](https://csrf.jp/2024/fxios-jsurl.php "https://csrf.jp/2024/fxios-jsurl.php")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-8432 "https://mozilla-hub.atlassian.net/browse/FXIOS-8432")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/18702 "https://github.com/mozilla-mobile/firefox-ios/pull/18702")

## Details

### (Keywords: csectype-sop, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-31393

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a847702_1689 "11 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [fxios-jsurl-uxss.mov](/attachment.cgi?id=9379376)  [11 months ago](#c0)  [Muneaki Nishimura](/user_profile?user_id=507051)   2.05 MB, video/quicktime |  | [Details](/attachment.cgi?id=9379376&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9394320)  [9 months ago](#c5)  [mreagan](/user_profile?user_id=734598)   72 bytes, text/plain |  | [Details](/attachment.cgi?id=9394320&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1879739#c0)• 11 months ago |
|  | |

Attached video
[fxios-jsurl-uxss.mov](attachment.cgi?id=9379376)
— [Details](attachment.cgi?id=9379376&action=edit)

Firefox for iOS normally disallows top-level navigation to `javascript:` URLs.

However, this limitation can be bypassed by drag-and-drop a `javascript:` URL into the address bar.

This behavior has potential use for Universal XSS attacks.

The following page is a reproduction case of this attack.

<https://csrf.jp/2024/fxios-jsurl.php>

In this page, when you drag a URL link, the page is switched to `www.google.com`.

And when you drop the link into the address bar, the script is executed on `www.google.com`.

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a22856_1689)• 11 months ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → BrowserKeywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Product: Firefox → Firefox for iOSSummary: JavaScript URLs top-level navigation can be bypassed on Firefox iOS (Potential UXSS) → JavaScript URLs load when dragged to address bar, bypassing restriction on them (Potential UXSS)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1879739#c1)• 11 months ago |
|  | |

Thank you Muneaki for reporting the issue. We are working on a WebEngine project that will as a side-effect improve how navigation is allowed/refused in our app. The current issue is yet another place where there's no scheme checks before navigation happens in the project. I'll do a quick fix for now.

For anyone following, the drag and drop is handled through this code [here](https://github.com/mozilla-mobile/firefox-ios/blob/727d6f898e075890e273ed830b1f4550dfe7fa14/firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController%2BUIDropInteractionDelegate.swift#L30-L32).

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a253402_694570)• 11 months ago |

See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-8432>

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a253485_694570)• 11 months ago |

See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/18702>

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a320821_694570)• 11 months ago |

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 11 months ago
[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [124](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=124)Resolution: --- → FIXED

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1879739#c2)• 11 months ago |
|  | |

PR was merged, is pending tests and will be part of the 124 release. Thank you :muneaki!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a847702_1689)• 11 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1879739#c3)• 11 months ago |
|  | |

Hey Muneaki. Nice find. We can see this as an XSS type of bug but not necessarily as UXSS. The bug requires you to drag and drop a link from the current web page (or an iframe) and not any, arbitrary web page. It also requires some user interaction. We're going to award this on the lower end of "sec-moderate" due to these circumstances. Thanks you for continuing to participate in our bug bounty program.

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1879739#c4)• 11 months ago |
|  | |

Verified as fixed on v124 (39092) with iPhone 15 Pro (17.1.2).

When I dragged the link over the URL [www.google.com](http://www.google.com) was loaded and displayed correctly, there was no `https://www.google.com` UXSS prompt as it can be seen in the previous version where the issue was not fixed.

Status: RESOLVED → VERIFIED

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1879739#c5)• 9 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9394320)
— [Details](attachment.cgi?id=9394320&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a4470760_578488)• 9 months ago |

Alias: CVE-2024-31393

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a9484679_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879739#a25553729_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1879739&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Muneaki Nishimura](/user_profile?user_id=507051)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

