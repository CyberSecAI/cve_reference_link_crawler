=== Content from fluidattacks.com_1d7f5bfb_20250111_111658.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Watchdog Antivirus v1.6.415 - DoS

## Summary

|  |  |
| --- | --- |
| **Name** | Watchdog Antivirus v1.6.415 - Denial of Service |
| **Code name** | [Cole](https://en.wikipedia.org/wiki/Nat_King_Cole) |
| **Product** | Watchdog Antivirus |
| **Vendor** | Watchdog |
| **Affected versions** | Version 1.6.415 |
| **State** | Public |
| **Release date** | 2024-04-22 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Denial of Service (DoS) |
| **Rule** | [002. Asymmetric Denial of Service](https://docs.fluidattacks.com/criteria/vulnerabilities/002/) |
| **Remote** | No |
| **CVSSv3 Vector** | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| **CVSSv3 Base Score** | 5.5 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2024-1241](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1241) |

## Description

Watchdog Antivirus v1.6.415 is vulnerable to
a Denial of Service vulnerability by triggering the
`0x80002014` IOCTL code of the
`wsdk-driver.sys` driver.

## Vulnerability

The `0x80002014` IOCTL code of the
`wsdk-driver.sys` driver allows to perform a Denial of Service,
leading to a BSOD of the affected computer caused by a
NULL pointer dereference.

The disassembled vulnerable function is `sub_140008D5C`:

```
__int64 __fastcall sub_140008D5C(HANDLE ProcessId) // [3]
{
 __int64 v1; // rbx
 const char *ProcessImageFileName; // rdi
 NTSTATUS v3; // eax
 int v4; // edx
 int v5; // r8d
 PEPROCESS Process; // [rsp+48h] [rbp+10h] BYREF

 Process = 0i64;
 v1 = (unsigned int)ProcessId;
 ProcessImageFileName = 0i64;
 v3 = PsLookupProcessByProcessId((HANDLE)(unsigned int)ProcessId, &Process);
 if ( v3 < 0 )
 {
 if ( off_140005250 != &off_140005250 )
 {
 _mm_lfence();
 LOBYTE(v4) = 3;
 sub_140001084((int)off_140005248->DeviceExtension, v4, v5, 0x14, (__int64)&unk_140003960, v3);
    }
  }
  else
  {
    ProcessImageFileName = (const char *)PsGetProcessImageFileName(Process);  // [2]
    ObfDereferenceObject(Process);
  }
  if ( stricmp(ProcessImageFileName, "WAV.exe") )  // [3]
    return 0xC0000001i64;
  qword_140005298 = v1;
  return 0i64;
}

```

The `sub_140008D5C` function tries to find the process
instance of the `WAV.exe` executable. It receives a
parameter called `ProcessId` at `[1]`, tries to find the
image filename with `PsGetProcessImageFileName` at `[2]` and compares
if the file name matches with `WAV.exe` using `stricmp()` at `[3]`.
However, the parameter `ProcessId` can be controlled by the
attacker, making the result of `PsGetProcessImageFileName`
to be `NULL`, performing an invalid comparison with `stricmp()`,
resulting in a NULL pointer dereference:

```
CONTEXT:  ffffca0f2802ed20 -- (.cxr 0xffffca0f2802ed20)
rax=0000000000000000 rbx=0000000041414141 rcx=0000000000000000
rdx=fffff80172caac80 rsi=0000000080002014 rdi=0000000000000000
rip=fffff80177dcc6b2 rsp=ffffca0f2802f728 rbp=ffffcf0c89df45c0
 r8=0000000000000000  r9=ffffcf0c8efe40a8 r10=fffff80172caac80
r11=0000000000000000 r12=0000000000000000 r13=0000000000000000
r14=0000000000000000 r15=ffffcf0c8e61d8f0
iopl=0         nv up ei ng nz na po nc
cs=0010  ss=0018  ds=002b  es=002b  fs=0053  gs=002b             efl=00050286
nt!_ascii_stricmp+0x6:
fffff801`77dcc6b2 450fb603        movzx   r8d,byte ptr [r11] ds:002b:00000000`00000000=??
Resetting default scope

PROCESS_NAME:  IOCTLBruteForce.exe

STACK_TEXT:
ffffca0f`2802f728 fffff801`77dcc709     : ffffca0f`28020014 ffffca0f`2802f788 00000000`00000004 00000000`00000000 : nt!_ascii_stricmp+0x6
ffffca0f`2802f730 fffff801`72ca8de7     : 00000000`41414141 00000000`80002014 00000000`41414141 00000000`00000000 : nt!stricmp+0x9
ffffca0f`2802f760 fffff801`72ca806e     : ffffcf0c`89df45c0 00000000`00000000 00000000`000000c8 fffff801`780d4b41 : wsdkd+0x8de7
ffffca0f`2802f7a0 fffff801`77cd1f35     : ffffcf0c`89df45c0 00000000`00000004 00000000`00000002 00000000`00000001 : wsdkd+0x806e

```
## Our security policy

We have reserved the ID CVE-2024-1241 to refer
to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Watchdog Antivirus v1.6.415
* Operating System: Windows

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by
[Andres Roldan](https://www.linkedin.com/in/andres-roldan/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://watchdog.dev/>

**Product page** <https://watchdog.dev/solutions/anti-virus/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-05

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-05

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-03-03

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-04-22

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from watchdog.dev_43467844_20250111_111659.html ===


[Skip to content](#content "Skip to content")
[![WATCHDOG](https://watchdog.dev/wp-content/uploads/2023/02/watchdog-logo-h-4-1-768x198-1-212x55.webp)](https://watchdog.dev/)

* ProductsMenu Toggle

  + [Anti-Virus](https://watchdog.dev/solutions/anti-virus/)Menu Toggle

    - [Product Overview](https://watchdog.dev/solutions/anti-virus/)
    - [15-day Free Trial](https://watchdog.dev/anti-virus-free-trial/)
    - [Anti-Virus Release Notes](https://watchdog.dev/anti-virus-release-notes/)
    - [Anti-Virus Activation Help](https://watchdog.dev/support/antivirus-activation-help/)
  + [Anti-Malware](https://watchdog.dev/solutions/anti-malware/)Menu Toggle

    - [Product Overview](https://watchdog.dev/solutions/anti-malware/)
    - [15-day Free Trial](https://watchdog.dev/anti-malware-free-trial/)
    - [Anti-Malware Release Notes](https://watchdog.dev/anti-malware-release-notes/)
    - [Anti-Malware Activation Help](https://watchdog.dev/support/anti-malware-activation-help/)
  + [Anti-Malware Business](https://watchdog.dev/business/anti-malware-business/)
  + [Certifications & Reviews](https://watchdog.dev/certifications-reviews/)
* SupportMenu Toggle

  + [FAQ](https://watchdog.dev/faq/)
  + [Contact Support](https://watchdog.dev/support/)
  + [Product Downloads](https://watchdog.dev/support/downloads/)
  + [How to Uninstall](https://watchdog.dev/support/uninstall/)
* CompanyMenu Toggle

  + [Contact Us](https://watchdog.dev/contact/)
  + [About Us](https://watchdog.dev/about/)
  + [Cybersecurity Blog](https://watchdog.dev/cybersecurity-blog/)
  + [Vulnerability Disclosure Policy](https://watchdog.dev/vulnerability-disclosure-policy/)
* PartnersMenu Toggle

  + [Resellers](https://watchdog.dev/partners/resellers/)
  + [Affiliates](https://watchdog.dev/partners/affiliates/)
* [Partner Login](https://partners.watchdog.dev/login)

[![WATCHDOG](https://watchdog.dev/wp-content/uploads/2023/02/watchdog-logo-h-4-1-768x198-1-212x55.webp)](https://watchdog.dev/)

Main Menu

* ProductsMenu Toggle

  + [Anti-Virus](https://watchdog.dev/solutions/anti-virus/)Menu Toggle

    - [Product Overview](https://watchdog.dev/solutions/anti-virus/)
    - [15-day Free Trial](https://watchdog.dev/anti-virus-free-trial/)
    - [Anti-Virus Release Notes](https://watchdog.dev/anti-virus-release-notes/)
    - [Anti-Virus Activation Help](https://watchdog.dev/support/antivirus-activation-help/)
  + [Anti-Malware](https://watchdog.dev/solutions/anti-malware/)Menu Toggle

    - [Product Overview](https://watchdog.dev/solutions/anti-malware/)
    - [15-day Free Trial](https://watchdog.dev/anti-malware-free-trial/)
    - [Anti-Malware Release Notes](https://watchdog.dev/anti-malware-release-notes/)
    - [Anti-Malware Activation Help](https://watchdog.dev/support/anti-malware-activation-help/)
  + [Anti-Malware Business](https://watchdog.dev/business/anti-malware-business/)
  + [Certifications & Reviews](https://watchdog.dev/certifications-reviews/)
* SupportMenu Toggle

  + [FAQ](https://watchdog.dev/faq/)
  + [Contact Support](https://watchdog.dev/support/)
  + [Product Downloads](https://watchdog.dev/support/downloads/)
  + [How to Uninstall](https://watchdog.dev/support/uninstall/)
* CompanyMenu Toggle

  + [Contact Us](https://watchdog.dev/contact/)
  + [About Us](https://watchdog.dev/about/)
  + [Cybersecurity Blog](https://watchdog.dev/cybersecurity-blog/)
  + [Vulnerability Disclosure Policy](https://watchdog.dev/vulnerability-disclosure-policy/)
* PartnersMenu Toggle

  + [Resellers](https://watchdog.dev/partners/resellers/)
  + [Affiliates](https://watchdog.dev/partners/affiliates/)
* [Partner Login](https://partners.watchdog.dev/login)

# Unmatched Cyber Protection

Our antivirus software offers robust security with a focus on advanced protection.

*★**★**★**★**★* 5/5

30 Days Money Back Guarantee

Available Languages
English

![](https://watchdog.dev/wp-content/uploads/2023/02/Watchdog-Anti-Virus-00-00-3D-EN-1500-2-e1664400316642.webp)

Windows 10 or later

## 56.99 € VAT incl.

License
1 PC\n3 PCs\n5 PCs\n

Duration
1 Year2 Years3 Years

[Buy Now](#buy)

##### STOP EXPLOITS

Prevents hacker attacks by identifying and blocking vulnerabilities.

##### REAL TIME PROTECTION

Instantly defends against malware and cyber threats as they emerge.

##### PHISHING DETECTION

Guards your identity and data by spotting and stopping phishing scams.

##### CLOUD SCANNER

Ensures lightning-fast performance while accessing a cloud-based threat database.

![](https://watchdog.dev/wp-content/uploads/2022/05/insurance.png)

## Guarding You, 24/7

Our vigilant cloud scanner works tirelessly, safeguarding your device even as you sleep. Experience uninterrupted protection with Watchdog Anti-Virus.

### Elevate your security

* Enhanced Security
* Faster Performance
* Peace of Mind

* Phishing Defense
* Improved Privacy
* Effortless Protection

## Expert Tech Support Service

Servicing our resident & business clients globally through a team of fully dedicated Microsoft certified technical repair experts. We offer custom-tailored and effective solutions for all your PC worries 24/7/365.

* DIAGNOSTICS
* VIRUS & MALWARE REMOVAL
* BROWSER & INTERNET SECURITY
* OS & SOFTWARE INSTALLATION

##### Supported operating systems:

* Microsoft Windows 10 (64bit)
* Microsoft Windows 11 (64bit)

##### Hardware requirements:

* Intel Pentium 1 GHz or higher (or equivalent)
* 1024 MB available RAM
* 400 MB free space on the hard drive
* Active Internet connection

## Safe PC, Happy User

*★**★**★**★**★* 5/5

Glad I made the purchase!! I would recommend this product to all!!

[READ REVIEWS](https://watchdog.dev/certifications-reviews/)

*★**★**★**★**★* 5/5

I’ve had my Watchdog for about three years, and I love it!

### Protect Your System Now

Download Watchdog to protect against cyber threats.

[DOWNLOAD FOR FREE](https://watchdog.dev/support/downloads/)

**Products**
[Anti-Virus](https://watchdog.dev/solutions/anti-virus/)
[Anti-Malware](https://watchdog.dev/solutions/anti-malware/)
[Anti-Malware Business](https://watchdog.dev/business/anti-malware-business/)

**Support**

[FAQ](https://watchdog.dev/faq/)[Contact Support](https://watchdog.dev/support/)[Product Downloads](https://watchdog.dev/support/downloads/)

**Company**

[Contact Us](https://watchdog.dev/contact/)
[About](https://watchdog.dev/about/)
[Cybersecurity Blog](https://watchdog.dev/cybersecurity-blog/)

**Partners**

[Resellers](https://watchdog.dev/partners/resellers/)
[Affiliates](https://watchdog.dev/partners/affiliates/)

![](https://watchdog.dev/wp-content/uploads/2023/02/watchdog-logo-h-4-1-768x198-1-300x77.webp)

[Privacy Policy](https://watchdog.dev/legal/privacy/) - [Terms & Conditions](https://watchdog.dev/legal/terms/)

Translate »

 Scroll to Top


