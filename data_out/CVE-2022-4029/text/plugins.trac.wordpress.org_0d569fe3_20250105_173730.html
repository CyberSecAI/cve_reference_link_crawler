

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2804020%2540simplepress%26old%3D2804020%2540simplepress)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2794239/simplepress "Changeset 2794239 for simplepress")
* [Next Change](/changeset/2804021/simplepress "Changeset 2804021 for simplepress") →

---

# Changeset [2804020](/changeset/2804020 "Show full changeset") for [simplepress](/browser/simplepress?rev=2804020 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/25/2022 03:40:01 PM
([2 years](/timeline?from=2022-10-25T15%3A40%3A01Z&precision=second "See timeline at 10/25/2022 03:40:01 PM") ago)

Author:
simplepress
Message:

6.8.1

Location:
[simplepress/trunk](/browser/simplepress/trunk?rev=2804020)
Files:

23 edited

* [admin/help/admin/tooltips/admin-permissions-tips-en.php](/browser/simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [admin/library/ajax/spa-ajax-help.php](/browser/simplepress/trunk/admin/library/ajax/spa-ajax-help.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [admin/library/spa-support.php](/browser/simplepress/trunk/admin/library/spa-support.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [admin/library/spa-tab-support.php](/browser/simplepress/trunk/admin/library/spa-tab-support.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [admin/panel-components/ajax/spa-ajax-components.php](/browser/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php?rev=2804020 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [admin/panel-forums/ajax/spa-ajax-forums.php](/browser/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php?rev=2804020 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [admin/panel-plugins/ajax/spa-ajax-plugins-help.php](/browser/simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [admin/panel-profiles/ajax/spa-ajax-profiles.php](/browser/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php?rev=2804020 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [admin/panel-themes/forms/spa-themes-editor-form.php](/browser/simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [admin/panel-themes/support/spa-themes-save.php](/browser/simplepress/trunk/admin/panel-themes/support/spa-themes-save.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [forum/resources/jscript/sp-forum.js](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.js?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [forum/resources/jscript/sp-forum.min.js](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.min.js?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [readme.txt](/browser/simplepress/trunk/readme.txt?rev=2804020 "Show entry in browser")
  (modified)
  ([2 diffs](#file12 "Show differences"))
* [sp-api/sp-api-class-spcdisplayfilters.php](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2804020 "Show entry in browser")
  (modified)
  ([3 diffs](#file13 "Show differences"))
* [sp-api/sp-api-class-spcfilters.php](/browser/simplepress/trunk/sp-api/sp-api-class-spcfilters.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [sp-api/sp-api-class-spcsavefilters.php](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=2804020 "Show entry in browser")
  (modified)
  ([3 diffs](#file15 "Show differences"))
* [sp-api/sp-api-class-spcuser.php](/browser/simplepress/trunk/sp-api/sp-api-class-spcuser.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file16 "Show differences"))
* [sp-control.php](/browser/simplepress/trunk/sp-control.php?rev=2804020 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [sp-startup/admin/spa-admin-menu.php](/browser/simplepress/trunk/sp-startup/admin/spa-admin-menu.php?rev=2804020 "Show entry in browser")
  (modified)
  ([2 diffs](#file18 "Show differences"))
* [sp-startup/core/sp-core-support-functions.php](/browser/simplepress/trunk/sp-startup/core/sp-core-support-functions.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [sp-startup/forum/sp-forum-framework.php](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2804020 "Show entry in browser")
  (modified)
  ([3 diffs](#file20 "Show differences"))
* [sp-startup/install/sp-upgrade-support.php](/browser/simplepress/trunk/sp-startup/install/sp-upgrade-support.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [sp-startup/install/sp-upgrade.php](/browser/simplepress/trunk/sp-startup/install/sp-upgrade.php?rev=2804020 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php](/changeset/2804020/simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php")

  | [r1972405](/browser/simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php?rev=1972405#L43 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/help/admin/tooltips/admin-permissions-tips-en.php?rev=2804020#L43 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 | $tooltips['can\_use\_smileys'] = $t.'Can use smileys in posts'; |
  | 44 | 44 | $tooltips['can\_use\_iframes'] = $t.'Can use iframes in posts'; |
  |  | 45 | $tooltips['can\_use\_object\_tag'] = $t.'Can use the OBJECT and EMBED tags in posts'; |
  | 45 | 46 | $tooltips['view\_own\_admin\_posts'] = $t.'Can view only own posts and admin/mod posts'; |
  | 46 | 47 | $tooltips['create\_links'] = $t.'Can create links in posts'; |
* ## [simplepress/trunk/admin/library/ajax/spa-ajax-help.php](/changeset/2804020/simplepress/trunk/admin/library/ajax/spa-ajax-help.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/library/ajax/spa-ajax-help.php")

  | [r2794238](/browser/simplepress/trunk/admin/library/ajax/spa-ajax-help.php?rev=2794238#L15 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/library/ajax/spa-ajax-help.php?rev=2804020#L15 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | if (!isset($\_GET['file'])) die(); |
  | 16 | 16 |  |
  | 17 |  | $file = SP()->filters->str($\_GET['file']); |
  |  | 17 | $file = SP()->filters->filename($\_GET['file']); |
  |  | 18 |  |
  |  | 19 | if (empty($file)) die(); |
  |  | 20 |  |
  | 18 | 21 | $tag = SP()->filters->str($\_GET['item']); |
  | 19 | 22 | $tag = '['.$tag.']'; |
* ## [simplepress/trunk/admin/library/spa-support.php](/changeset/2804020/simplepress/trunk/admin/library/spa-support.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/library/spa-support.php")

  | [r2794238](/browser/simplepress/trunk/admin/library/spa-support.php?rev=2794238#L528 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/library/spa-support.php?rev=2804020#L528 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 528 | 528 | SP()->auths->add('can\_use\_smileys', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can use smileys in posts')), 1, 0, 0, 0, 3, ''); |
  | 529 | 529 | SP()->auths->add('can\_use\_iframes', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can use iframes in posts')), 1, 1, 0, 0, 3, SP()->primitives->admin\_text('\*\*\* WARNING \*\*\* The use of iframes is dangerous. Allowing users to create iframes enables them to launch a potential security threat against your website. Enabling iframes requires your trust in your users. Turn on with care.')); |
  |  | 530 | SP()->auths->add('can\_use\_object\_tag', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can use OBJECT and EMBED tags in posts')), 1, 1, 0, 0, 3, SP()->primitives->admin\_text('\*\*\* WARNING \*\*\* The use of the OBJECT and EMBEG tags is dangerous. Allowing users to embed objects enables them to launch a potential security threat against your website. Enabling the OBJECT and EMBED tags requires your trust in your users. Turn on with care.')); |
  | 530 | 531 | SP()->auths->add('edit\_own\_topic\_titles', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can edit own topic titles')), 1, 1, 0, 0, 4, ''); |
  | 531 | 532 | SP()->auths->add('edit\_any\_topic\_titles', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can edit any topic title')), 1, 1, 0, 0, 4, ''); |
* ## [simplepress/trunk/admin/library/spa-tab-support.php](/changeset/2804020/simplepress/trunk/admin/library/spa-tab-support.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/library/spa-tab-support.php")

  | [r2378390](/browser/simplepress/trunk/admin/library/spa-tab-support.php?rev=2378390#L440 "Show revision 2378390 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/library/spa-tab-support.php?rev=2804020#L440 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 440 | 440 | function spa\_paint\_css\_editor($label, $name, $value, $submessage='', $rows=10) { |
  | 441 | 441 | if(floatval(get\_bloginfo('version')) >= 4.9) { |
  | 442 |  | ~~error\_log( 'blog version passed ok');~~ |
  | 443 | 442 | spa\_paint\_code\_editor('text/css', $label, $name, $value, $submessage, $rows); |
  | 444 | 443 | } else { |
* ## [simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php](/changeset/2804020/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php")

  | [r1972405](/browser/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php?rev=1972405#L62 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php?rev=2804020#L62 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 |  |
  | 63 | 63 | if ($action == 'delsmiley') { |
  | 64 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 64 | $file = SP()->filters->filename($\_GET['file']); |
  | 65 | 65 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['smileys'].'/'.$file; |
  | 66 | 66 | @unlink($path); |
  | […](/browser/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php?rev=1972405#L88) | […](/browser/simplepress/trunk/admin/panel-components/ajax/spa-ajax-components.php?rev=2804020#L88) |  |
  | 88 | 88 |  |
  | 89 | 89 | if ($action == 'delbadge') { |
  | 90 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 90 | $file = SP()->filters->filename($\_GET['file']); |
  | 91 | 91 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['ranks'].'/'.$file; |
  | 92 | 92 | @unlink($path); |
* ## [simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php](/changeset/2804020/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php")

  | [r1972405](/browser/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php?rev=1972405#L33 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php?rev=2804020#L33 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 33 | 33 |  |
  | 34 | 34 | if ($action == 'delicon') { |
  | 35 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 35 | $file = SP()->filters->filename($\_GET['file']); |
  | 36 | 36 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['custom-icons'].'/'.$file; |
  | 37 | 37 | @unlink($path); |
  | […](/browser/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php?rev=1972405#L39) | […](/browser/simplepress/trunk/admin/panel-forums/ajax/spa-ajax-forums.php?rev=2804020#L39) |  |
  | 39 | 39 |  |
  | 40 | 40 | if ($action == 'delimage') { |
  | 41 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 41 | $file = SP()->filters->filename($\_GET['file']); |
  | 42 | 42 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['forum-images'].'/'.$file; |
  | 43 | 43 | @unlink($path); |
* ## [simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php](/changeset/2804020/simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php")

  | [r1972405](/browser/simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php?rev=1972405#L15 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-plugins/ajax/spa-ajax-plugins-help.php?rev=2804020#L15 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | if (!isset($\_GET['file'])) die(); |
  | 16 | 16 |  |
  | 17 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 17 | $file = SP()->filters->filename($\_GET['file']); |
  | 18 | 18 |  |
  | 19 | 19 | # Formatting and Display of Help Panel |
* ## [simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php](/changeset/2804020/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php")

  | [r1972405](/browser/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php?rev=1972405#L19 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php?rev=2804020#L19 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 |  |
  | 20 | 20 | if ($action == 'delavatar') { |
  | 21 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 21 | $file = SP()->filters->filename($\_GET['file']); |
  | 22 | 22 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['avatar-pool'].'/'.$file; |
  | 23 | 23 | @unlink($path); |
  | […](/browser/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php?rev=1972405#L26) | […](/browser/simplepress/trunk/admin/panel-profiles/ajax/spa-ajax-profiles.php?rev=2804020#L26) |  |
  | 26 | 26 |  |
  | 27 | 27 | if ($action == 'deldefault') { |
  | 28 |  | $file = SP()->filters->~~str~~($\_GET['file']); |
  |  | 28 | $file = SP()->filters->filename($\_GET['file']); |
  | 29 | 29 | $path = SP\_STORE\_DIR.'/'.SP()->plugin->storage['avatars'].'/defaults/'.$file; |
  | 30 | 30 | @unlink($path); |
* ## [simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php](/changeset/2804020/simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php")

  | [r2215409](/browser/simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php?rev=2215409#L14 "Show revision 2215409 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-themes/forms/spa-themes-editor-form.php?rev=2804020#L14 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 14 | 14 |  |
  | 15 | 15 | $themedir = SPTHEMEBASEDIR.$curTheme['theme']; |
  | 16 |  | $file = (isset($\_GET['file'])) ? SP()->filters->~~str~~($\_GET['file']) : ''; |
  |  | 16 | $file = (isset($\_GET['file'])) ? SP()->filters->filename($\_GET['file']) : ''; |
  | 17 | 17 | $type = (isset($\_GET['type'])) ? SP()->filters->str($\_GET['type']) : 'style'; |
  | 18 | 18 | if (empty($file)) { |
* ## [simplepress/trunk/admin/panel-themes/support/spa-themes-save.php](/changeset/2804020/simplepress/trunk/admin/panel-themes/support/spa-themes-save.php "Show the changeset 2804020 restricted to simplepress/trunk/admin/panel-themes/support/spa-themes-save.php")

  | [r2794238](/browser/simplepress/trunk/admin/panel-themes/support/spa-themes-save.php?rev=2794238#L232 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/admin/panel-themes/support/spa-themes-save.php?rev=2804020#L232 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 232 | 232 |  |
  | 233 | 233 | function spa\_save\_editor\_data() { |
  |  | 234 |  |
  |  | 235 | # This function should only be called if a wp-config.php constant is defined. |
  |  | 236 | # if it's not defined, bail immediately with an error. |
  |  | 237 | if ( ( ! defined('SP\_ALLOW\_THEME\_EDITOR') ) || (defined('SP\_ALLOW\_THEME\_EDITOR') && ! SP\_ALLOW\_THEME\_EDITOR)) { |
  |  | 238 | $msg = SP()->primitives->admin\_text('Security warning - you do not have permission to edit themes.'); |
  |  | 239 | return $msg; |
  |  | 240 | } |
  |  | 241 |  |
  | 234 | 242 | check\_admin\_referer('forum-adminform\_theme-editor', 'forum-adminform\_theme-editor'); |
  | 235 | 243 |  |
  | 236 |  | $file = SP()->filters->~~str~~($\_POST['file']); |
  |  | 244 | $file = SP()->filters->filename($\_POST['file']); |
  | 237 | 245 | $newcontent = stripslashes($\_POST['spnewcontent']); |
  | 238 | 246 | if (is\_writeable($file)) { |
* ## [simplepress/trunk/forum/resources/jscript/sp-forum.js](/changeset/2804020/simplepress/trunk/forum/resources/jscript/sp-forum.js "Show the changeset 2804020 restricted to simplepress/trunk/forum/resources/jscript/sp-forum.js")

  | [r2757478](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.js?rev=2757478#L62 "Show revision 2757478 of this file in browser") | [r2804020](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.js?rev=2804020#L62 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | reason += "<strong>" + sp\_forum\_vars.iframe + "</strong><br />"; |
  | 63 | 63 | } |
  |  | 64 | if (thisPost.match('<object') && sp\_platform\_vars.checkiframe == 'yes') { |
  |  | 65 | reason += "<strong>" + sp\_forum\_vars.object\_tag + "</strong><br />"; |
  |  | 66 | } |
  |  | 67 | if (thisPost.match('<embed') && sp\_platform\_vars.checkiframe == 'yes') { |
  |  | 68 | reason += "<strong>" + sp\_forum\_vars.embed\_tag + "</strong><br />"; |
  |  | 69 | } |
  | 64 | 70 |  |
  | 65 | 71 | if (sp\_platform\_vars.postvalue != undefined) { |
* ## [simplepress/trunk/forum/resources/jscript/sp-forum.min.js](/changeset/2804020/simplepress/trunk/forum/resources/jscript/sp-forum.min.js "Show the changeset 2804020 restricted to simplepress/trunk/forum/resources/jscript/sp-forum.min.js")

  | [r2757478](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.min.js?rev=2757478#L62 "Show revision 2757478 of this file in browser") | [r2804020](/browser/simplepress/trunk/forum/resources/jscript/sp-forum.min.js?rev=2804020#L62 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | reason += "<strong>" + sp\_forum\_vars.iframe + "</strong><br />"; |
  | 63 | 63 | } |
  |  | 64 | if (thisPost.match('<object') && sp\_platform\_vars.checkiframe == 'yes') { |
  |  | 65 | reason += "<strong>" + sp\_forum\_vars.object\_tag + "</strong><br />"; |
  |  | 66 | } |
  |  | 67 | if (thisPost.match('<embed') && sp\_platform\_vars.checkiframe == 'yes') { |
  |  | 68 | reason += "<strong>" + sp\_forum\_vars.embed\_tag + "</strong><br />"; |
  |  | 69 | } |
  | 64 | 70 |  |
  | 65 | 71 | if (sp\_platform\_vars.postvalue != undefined) { |
* ## [simplepress/trunk/readme.txt](/changeset/2804020/simplepress/trunk/readme.txt "Show the changeset 2804020 restricted to simplepress/trunk/readme.txt")

  | [r2794238](/browser/simplepress/trunk/readme.txt?rev=2794238#L7 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/readme.txt?rev=2804020#L7 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | Tested up to: 6.1 |
  | 8 | 8 | Requires PHP: 7.0 |
  | 9 |  | Stable tag: 6.8.~~0~~ |
  |  | 9 | Stable tag: 6.8.1 |
  | 10 | 10 | License: GPLv2 or later |
  | 11 | 11 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/simplepress/trunk/readme.txt?rev=2794238#L323) | […](/browser/simplepress/trunk/readme.txt?rev=2804020#L323) |  |
  | 323 | 323 | == Changelog == |
  | 324 | 324 |  |
  |  | 325 | = 6.8.1 = |
  |  | 326 | \* Fix |
  |  | 327 | \* G00000: Various security related fixes. |
  |  | 328 |  |
  | 325 | 329 | = 6.8.0 = |
  | 326 | 330 | \* New |
* ## [simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php](/changeset/2804020/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php")

  | [r2794238](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2794238#L112 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2804020#L112 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 112 | 112 | $content = $this->chars($content); |
  | 113 | 113 |  |
  | 114 |  | # 2: ~~r~~emove escape slashes |
  |  | 114 | # 2: Remove escape slashes |
  | 115 | 115 | $content = $this->stripslashes($content); |
  |  | 116 |  |
  |  | 117 | # 3: Run it through the wp\_kses\_post function. |
  |  | 118 | $content = wp\_kses\_post($content); |
  | 116 | 119 |  |
  | 117 | 120 | $content = apply\_filters('sph\_display\_title\_filter', $content, $original); |
  | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2794238#L127) | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2804020#L130) |  |
  | 127 | 130 | $content = $this->chars($content); |
  | 128 | 131 |  |
  | 129 |  | # 2: ~~r~~emove escape slashes |
  |  | 132 | # 2: Remove escape slashes |
  | 130 | 133 | $content = $this->stripslashes($content); |
  |  | 134 |  |
  |  | 135 | # 3: Sanitize text field. |
  |  | 136 | $content = sanitize\_text\_field($content); |
  | 131 | 137 |  |
  | 132 | 138 | $content = apply\_filters('sph\_display\_name\_filter', $content, $original); |
  | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2794238#L142) | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcdisplayfilters.php?rev=2804020#L148) |  |
  | 142 | 148 | $email = $this->chars($email); |
  | 143 | 149 |  |
  | 144 |  | # 2: ~~r~~emove escape slashes |
  |  | 150 | # 2: Remove escape slashes |
  | 145 | 151 | $email = $this->stripslashes($email); |
  |  | 152 |  |
  |  | 153 | # 3: Run it through the native WP sanitize\_email function. |
  |  | 154 | # Warning: This function uses a smaller allowable character set than the set defined by RFC 5322. Some legal email addresses may be changed. |
  |  | 155 | $email = sanitize\_email($email); |
  | 146 | 156 |  |
  | 147 | 157 | $email = apply\_filters('sph\_display\_email\_filter', $email, $original); |
* ## [simplepress/trunk/sp-api/sp-api-class-spcfilters.php](/changeset/2804020/simplepress/trunk/sp-api/sp-api-class-spcfilters.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-api/sp-api-class-spcfilters.php")

  | [r2794238](/browser/simplepress/trunk/sp-api/sp-api-class-spcfilters.php?rev=2794238#L53 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-api/sp-api-class-spcfilters.php?rev=2804020#L53 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 53 | 53 | $string = wp\_kses($string, array()); |
  | 54 | 54 |  |
  |  | 55 | return $string; |
  |  | 56 | } |
  |  | 57 |  |
  |  | 58 | public function filename($string) { |
  |  | 59 |  |
  |  | 60 | # 1. Remove slashes. |
  |  | 61 | $string = str\_replace ( '/' , "", $string); |
  |  | 62 |  |
  |  | 63 | #2. Remove backslashes (note use of double back-slash - str\_replace needs it as an escape mechanism since back-slash has special meaning for it.) |
  |  | 64 | $string = str\_replace ( '\\' , "", $string); |
  |  | 65 |  |
  |  | 66 | #3. Run it through the wp file sanitization function to remove everything else |
  |  | 67 | $string = sanitize\_file\_name($string); |
  |  | 68 |  |
  | 55 | 69 | return $string; |
  | 56 | 70 | } |
* ## [simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php](/changeset/2804020/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php")

  | [r1995259](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=1995259#L96 "Show revision 1995259 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=2804020#L96 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 96 | 96 | $original = $content; |
  | 97 | 97 |  |
  | 98 |  | # 1: strip mb4 chars if unsuppo~~f~~rted |
  |  | 98 | # 1: strip mb4 chars if unsupported |
  | 99 | 99 | $content = $this->utf8mb4($content, $table, $column); |
  | 100 | 100 |  |
  | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=1995259#L118) | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=2804020#L118) |  |
  | 118 | 118 | $original = $content; |
  | 119 | 119 |  |
  | 120 |  | #1: Remo~~b~~e control chars |
  |  | 120 | #1: Remove control chars |
  | 121 | 121 | $content = $this->nocontrolchars($content); |
  | 122 | 122 |  |
  | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=1995259#L597) | […](/browser/simplepress/trunk/sp-api/sp-api-class-spcsavefilters.php?rev=2804020#L597) |  |
  | 597 | 597 |  |
  | 598 | 598 | $allowedforumprotocols = apply\_filters('sph\_allowed\_protocols', array('http', 'https', 'ftp', 'ftps', 'mailto', 'news', 'irc', 'gopher', 'nntp', 'feed', 'telnet', 'clsid', 'data')); |
  | 599 |  | $allowedforumtags      = array('address' => array('class' => true), 'a' => array('class' => true, 'href' => true, 'id' => true, 'title' => true, 'rel' => true, 'rev' => true, 'name' => true, 'target' => true, 'style' => true), 'abbr' => array('class' => true, 'title' => true), 'acronym' => array('title' => true, 'class' => true), 'article' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'aside' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'audio' => array('autoplay' => true, 'class' => true, 'controls' => true, 'id' => true, 'loop' => true, 'muted' => true, 'poster' => true, 'preload' => true, 'src' => true, 'style' => true), 'b' => array('class' => true), 'big' => array('class' => true), 'blockquote' => array('id' => true, 'cite' => true, 'class' => true, 'lang' => true, 'xml:lang' => true, 'style' => true), 'br' => array('class' => true), 'caption' => array('align' => true, 'class' => true), 'cite' => array('class' => true, 'dir' => true, 'lang' => true, 'title' => true), 'code' => array('class' => true, 'style' => true), 'dd' => array('class' => true), 'del' => array('datetime' => true), 'details' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'open' => true, 'style' => true, 'xml:lang' => true), 'div' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'dl' => array('class' => true), 'dt' => array('class' => true), 'em' => array('class' => true), 'embed' => array('height' => true, 'name' => true, 'pallette' => true, 'src' => true, 'type' => true, 'width' => true), 'figure' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'figcaption' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'font' => array('color' => true, 'face' => true, 'size' => true), 'footer' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'header' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'hgroup' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'h1' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'h2' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'h3' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'h4' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'h5' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'h6' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'hr' => array('align' => true, 'class' => true, 'noshade' => true, 'size' => true, 'width' => true), 'i' => array('class' => true), 'img' => array('alt' => true, 'title' => true, 'align' => true, 'border' => true, 'class' => true, 'height' => true, 'hspace' => true, 'longdesc' => true, 'vspace' => true, 'src' => true, 'style' => true, 'width' => true, 'data-upload' => true, 'data-width' => true, 'data-height' => true), 'ins' => array('datetime' => true, 'cite' => true), 'kbd' => array('class' => true), 'label' => array('for' => true), 'legend' => array('align' => true), 'li' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), 'menu' => array('class' => true, 'style' => true, 'type' => true), 'nav' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'object' => array('classid' => true, 'codebase' => true, 'codetype' => true, 'data' => true, 'declare' => true, 'height' => true, 'name' => true, 'param' => true, 'standby' => true, 'type' => true, 'usemap' => true, 'width' => true), 'param' => array('id' => true, 'name' => true, 'type' => true, 'value' => true, 'valuetype' => true), 'p' => array('class' => true, 'align' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'pre' => array('class' => true, 'style' => true, 'width' => true), 'q' => array('cite' => true), 's' => array('class' => true), 'section' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'small' => array('class' => true), 'source' => array('class' => true, 'id' => true, 'media' => true, 'src' => true, 'style' => true, 'type' => true), 'span' => array('class' => true, 'dir' => true, 'align' => true, 'lang' => true, 'style' => true, 'title' => true, 'xml:lang' => true, 'id' => true), 'strike' => array('class' => true), 'strong' => array('class' => true), 'sub' => array('class' => true), 'summary' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), 'sup' => array('class' => true), 'table' => array('align' => true, 'bgcolor' => true, 'border' => true, 'cellpadding' => true, 'cellspacing' => true, 'class' => true, 'dir' => true, 'id' => true, 'rules' => true, 'style' => true, 'summary' => true, 'width' => true), 'tbody' => array('align' => true, 'char' => true, 'charoff' => true, 'valign' => true), 'td' => array('abbr' => true, 'align' => true, 'axis' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'colspan' => true, 'dir' => true, 'headers' => true, 'height' => true, 'nowrap' => true, 'rowspan' => true, 'scope' => true, 'style' => true, 'valign' => true, 'width' => true), 'tfoot' => array('align' => true, 'char' => true, 'class' => true, 'charoff' => true, 'valign' => true), 'th' => array('abbr' => true, 'align' => true, 'axis' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'colspan' => true, 'headers' => true, 'height' => true, 'nowrap' => true, 'rowspan' => true, 'scope' => true, 'valign' => true, 'width' => true), 'thead' => array('align' => true, 'char' => true, 'charoff' => true, 'class' => true, 'valign' => true), 'title' => array('class' => true), 'tr' => array('align' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'style' => true, 'valign' => true), 'tt' => array('class' => true), 'u' => array('class' => true), 'ul' => array('class' => true, 'style' => true, 'type' => true), 'ol' => array('class' => true, 'start' => true, 'style' => true, 'type' => true), 'var' => array('class' => true), 'video' => array('autoplay' => true, 'class' => true, 'controls' => true, 'height' => true, 'id' => true, 'loop' => true, 'muted' => true, 'poster' => true, 'preload' => true, 'src' => true, 'style' => true, 'width' => true)); |
  |  | 599 | $allowedforumtags      = array('address' => array('class' => true), |
  |  | 600 | 'a' => array('class' => true, 'href' => true, 'id' => true, 'title' => true, 'rel' => true, 'rev' => true, 'name' => true, 'target' => true, 'style' => true), |
  |  | 601 | 'abbr' => array('class' => true, 'title' => true), |
  |  | 602 | 'acronym' => array('title' => true, 'class' => true), |
  |  | 603 | 'article' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 604 | 'aside' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 605 | 'audio' => array('autoplay' => true, 'class' => true, 'controls' => true, 'id' => true, 'loop' => true, 'muted' => true, 'poster' => true, 'preload' => true, 'src' => true, 'style' => true), |
  |  | 606 | 'b' => array('class' => true), |
  |  | 607 | 'big' => array('class' => true), |
  |  | 608 | 'blockquote' => array('id' => true, 'cite' => true, 'class' => true, 'lang' => true, 'xml:lang' => true, 'style' => true), |
  |  | 609 | 'br' => array('class' => true), |
  |  | 610 | 'caption' => array('align' => true, 'class' => true), |
  |  | 611 | 'cite' => array('class' => true, 'dir' => true, 'lang' => true, 'title' => true), |
  |  | 612 | 'code' => array('class' => true, 'style' => true), 'dd' => array('class' => true), |
  |  | 613 | 'del' => array('datetime' => true), |
  |  | 614 | 'details' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'open' => true, 'style' => true, 'xml:lang' => true), |
  |  | 615 | 'div' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 616 | 'dl' => array('class' => true), |
  |  | 617 | 'dt' => array('class' => true), |
  |  | 618 | 'em' => array('class' => true), |
  |  | 619 | 'figure' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 620 | 'figcaption' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 621 | 'font' => array('color' => true, 'face' => true, 'size' => true), |
  |  | 622 | 'footer' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 623 | 'header' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 624 | 'hgroup' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 625 | 'h1' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 626 | 'h2' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 627 | 'h3' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 628 | 'h4' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 629 | 'h5' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 630 | 'h6' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 631 | 'hr' => array('align' => true, 'class' => true, 'noshade' => true, 'size' => true, 'width' => true), |
  |  | 632 | 'i' => array('class' => true), |
  |  | 633 | 'img' => array('alt' => true, 'title' => true, 'align' => true, 'border' => true, 'class' => true, 'height' => true, 'hspace' => true, 'longdesc' => true, 'vspace' => true, 'src' => true, 'style' => true, 'width' => true, 'data-upload' => true, 'data-width' => true, 'data-height' => true), |
  |  | 634 | 'ins' => array('datetime' => true, 'cite' => true), |
  |  | 635 | 'kbd' => array('class' => true), |
  |  | 636 | 'label' => array('for' => true), |
  |  | 637 | 'legend' => array('align' => true), |
  |  | 638 | 'li' => array('align' => true, 'class' => true, 'id' => true, 'style' => true), |
  |  | 639 | 'menu' => array('class' => true, 'style' => true, 'type' => true), |
  |  | 640 | 'nav' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 641 | 'param' => array('id' => true, 'name' => true, 'type' => true, 'value' => true, 'valuetype' => true), |
  |  | 642 | 'p' => array('class' => true, 'align' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 643 | 'pre' => array('class' => true, 'style' => true, 'width' => true), 'q' => array('cite' => true), |
  |  | 644 | 's' => array('class' => true), |
  |  | 645 | 'section' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 646 | 'small' => array('class' => true), |
  |  | 647 | 'source' => array('class' => true, 'id' => true, 'media' => true, 'src' => true, 'style' => true, 'type' => true), |
  |  | 648 | 'span' => array('class' => true, 'dir' => true, 'align' => true, 'lang' => true, 'style' => true, 'title' => true, 'xml:lang' => true, 'id' => true), |
  |  | 649 | 'strike' => array('class' => true), |
  |  | 650 | 'strong' => array('class' => true), |
  |  | 651 | 'sub' => array('class' => true), |
  |  | 652 | 'summary' => array('align' => true, 'class' => true, 'dir' => true, 'lang' => true, 'style' => true, 'xml:lang' => true), |
  |  | 653 | 'sup' => array('class' => true), |
  |  | 654 | 'table' => array('align' => true, 'bgcolor' => true, 'border' => true, 'cellpadding' => true, 'cellspacing' => true, 'class' => true, 'dir' => true, 'id' => true, 'rules' => true, 'style' => true, 'summary' => true, 'width' => true), |
  |  | 655 | 'tbody' => array('align' => true, 'char' => true, 'charoff' => true, 'valign' => true), |
  |  | 656 | 'td' => array('abbr' => true, 'align' => true, 'axis' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'colspan' => true, 'dir' => true, 'headers' => true, 'height' => true, 'nowrap' => true, 'rowspan' => true, 'scope' => true, 'style' => true, 'valign' => true, 'width' => true), |
  |  | 657 | 'tfoot' => array('align' => true, 'char' => true, 'class' => true, 'charoff' => true, 'valign' => true), |
  |  | 658 | 'th' => array('abbr' => true, 'align' => true, 'axis' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'colspan' => true, 'headers' => true, 'height' => true, 'nowrap' => true, 'rowspan' => true, 'scope' => true, 'valign' => true, 'width' => true), |
  |  | 659 | 'thead' => array('align' => true, 'char' => true, 'charoff' => true, 'class' => true, 'valign' => true), |
  |  | 660 | 'title' => array('class' => true), |
  |  | 661 | 'tr' => array('align' => true, 'bgcolor' => true, 'char' => true, 'charoff' => true, 'class' => true, 'style' => true, 'valign' => true), |
  |  | 662 | 'tt' => array('class' => true), |
  |  | 663 | 'u' => array('class' => true), |
  |  | 664 | 'ul' => array('class' => true, 'style' => true, 'type' => true), |
  |  | 665 | 'ol' => array('class' => true, 'start' => true, 'style' => true, 'type' => true), |
  |  | 666 | 'var' => array('class' => true), |
  |  | 667 | 'video' => array('autoplay' => true, 'class' => true, 'controls' => true, 'height' => true, 'id' => true, 'loop' => true, 'muted' => true, 'poster' => true, 'preload' => true, 'src' => true, 'style' => true, 'width' => true) |
  |  | 668 | ); |
  | 600 | 669 |  |
  | 601 | 670 | $target = (isset(SP()->rewrites->pageData['forumid'])) ? SP()->rewrites->pageData['forumid'] : 'global'; |
  |  | 671 |  |
  | 602 | 672 | if (isset(SP()->user->thisUser) && SP()->auths->get('can\_use\_iframes', $target, SP()->user->thisUser->ID)) { |
  | 603 | 673 | $allowedforumtags['iframe'] = array('width' => true, 'height' => true, 'frameborder' => true, 'src' => true, 'marginwidth' => true, 'marginheight' => true); |
  | 604 | 674 | } |
  |  | 675 | if (isset(SP()->user->thisUser) && SP()->auths->get('can\_use\_object\_tag', $target, SP()->user->thisUser->ID)) { |
  |  | 676 | $allowedforumtags['object'] = array('classid' => true, 'codebase' => true, 'codetype' => true, 'data' => true, 'declare' => true, 'height' => true, 'name' => true, 'param' => true, 'standby' => true, 'type' => true, 'usemap' => true, 'width' => true); |
  |  | 677 | $allowedforumtags['embed']  = array('height' => true, 'name' => true, 'pallette' => true, 'src' => true, 'type' => true, 'width' => true); |
  |  | 678 | } |
  | 605 | 679 |  |
  | 606 | 680 | $allowedforumtags = apply\_filters('sph\_kses\_allowed\_tags', $allowedforumtags); |
* ## [simplepress/trunk/sp-api/sp-api-class-spcuser.php](/changeset/2804020/simplepress/trunk/sp-api/sp-api-class-spcuser.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-api/sp-api-class-spcuser.php")

  | [r2450100](/browser/simplepress/trunk/sp-api/sp-api-class-spcuser.php?rev=2450100#L408 "Show revision 2450100 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-api/sp-api-class-spcuser.php?rev=2804020#L408 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 408 | 408 | $sfmemberopts = SP()->options->get('sfmemberopts'); |
  | 409 | 409 | if (isset($\_COOKIE['sforum\_'.COOKIEHASH]) && $sfmemberopts['sfcheckformember']) { |
  | 410 |  | # Yes it is - a user not logged in |
  | 411 |  | $username = $\_COOKIE['sforum\_'.COOKIEHASH]; |
  | 412 |  |  |
  |  | 410 | # Yes it is - a user not logged in.  So grab the user name but sanitize it in case its used for anything other than a display. |
  |  | 411 | $username = SP()->displayFilters->name($\_COOKIE['sforum\_'.COOKIEHASH]); |
  | 413 | 412 | return $username; |
  | 414 | 413 | } |
* ## [simplepress/trunk/sp-control.php](/changeset/2804020/simplepress/trunk/sp-control.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-control.php")

  | [r2794238](/browser/simplepress/trunk/sp-control.php?rev=2794238#L10 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-control.php?rev=2804020#L10 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* Plugin Name:         Simple:Press |
  | 11 | 11 | \* Plugin URI:          https://simple-press.com |
  | 12 |  | \* Version:             6.8.~~0~~ |
  |  | 12 | \* Version:             6.8.1 |
  | 13 | 13 | \* Description:         The most versatile and feature-rich forums plugin for WordPress |
  | 14 | 14 | \* Author:              The Simple:Press Team |
  | […](/browser/simplepress/trunk/sp-control.php?rev=2794238#L341) | […](/browser/simplepress/trunk/sp-control.php?rev=2804020#L341) |  |
  | 341 | 341 | # version and system control constants |
  | 342 | 342 | define('SPPLUGNAME', 'Simple:Press'); |
  | 343 |  | define('SPVERSION', '6.8.~~0~~'); |
  |  | 343 | define('SPVERSION', '6.8.1'); |
  | 344 | 344 |  |
  | 345 | 345 | # Define a variable that can be used for versioning scripts - required to force multisite to use different version numbers for each site. |
  | […](/browser/simplepress/trunk/sp-control.php?rev=2794238#L358) | […](/browser/simplepress/trunk/sp-control.php?rev=2804020#L358) |  |
  | 358 | 358 | } |
  | 359 | 359 |  |
  | 360 |  | define('SPBUILD', 1587~~7~~); |
  | 361 |  | define('SPSILENT', 158~~65~~); |
  |  | 360 | define('SPBUILD', 15878); |
  |  | 361 | define('SPSILENT', 15878); |
  | 362 | 362 | define('SPRELEASE', 'Release'); |
  | 363 | 363 |  |
* ## [simplepress/trunk/sp-startup/admin/spa-admin-menu.php](/changeset/2804020/simplepress/trunk/sp-startup/admin/spa-admin-menu.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-startup/admin/spa-admin-menu.php")

  | [r2794238](/browser/simplepress/trunk/sp-startup/admin/spa-admin-menu.php?rev=2794238#L374 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-startup/admin/spa-admin-menu.php?rev=2804020#L374 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 374 | 374 | 'tablet' => 'sfreloadtablist')); |
  | 375 | 375 | if (!is\_multisite() || is\_super\_admin()) { |
  | 376 |  | $forms[SP()->primitives->admin\_text('Theme Editor')] = array( |
  | 377 |  | 'editor' => 'sfreloadttedit'); |
  |  | 376 | # Only allow the theme editor if defined in the wp-config.php file. |
  |  | 377 | # Note that allowing this option allows the admin to write to ANY file in the wp installation folder. |
  |  | 378 | # And, if the web server or php configuration is insecure, potentially write to any file on the server. |
  |  | 379 | if (defined('SP\_ALLOW\_THEME\_EDITOR') && SP\_ALLOW\_THEME\_EDITOR) { |
  |  | 380 | $forms[SP()->primitives->admin\_text('Theme Editor')] = array( |
  |  | 381 | 'editor' => 'sfreloadttedit'); |
  |  | 382 | } |
  | 378 | 383 | $forms[SP()->primitives->admin\_text('Custom CSS')] = array( |
  | 379 | 384 | 'css' => 'sfreloadcss'); |
  | […](/browser/simplepress/trunk/sp-startup/admin/spa-admin-menu.php?rev=2794238#L390) | […](/browser/simplepress/trunk/sp-startup/admin/spa-admin-menu.php?rev=2804020#L395) |  |
  | 390 | 395 | } |
  | 391 | 396 | if (spa\_saas\_check()) { |
  | 392 |  | unset($forms[SP()->primitives->admin\_text('Theme Editor')]); |
  |  | 397 | # The theme editor menu option is only allowed sometimes so check to make sure it's even in the array before attempting to unset it. |
  |  | 398 | if (isset($forms[SP()->primitives->admin\_text('Theme Editor')])) { |
  |  | 399 | unset($forms[SP()->primitives->admin\_text('Theme Editor')]); |
  |  | 400 | } |
  | 393 | 401 | } |
  | 394 | 402 | if (spa\_saas\_check()) { |
* ## [simplepress/trunk/sp-startup/core/sp-core-support-functions.php](/changeset/2804020/simplepress/trunk/sp-startup/core/sp-core-support-functions.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-startup/core/sp-core-support-functions.php")

  | [r2794238](/browser/simplepress/trunk/sp-startup/core/sp-core-support-functions.php?rev=2794238#L57 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-startup/core/sp-core-support-functions.php?rev=2804020#L57 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 57 | 57 | # first check that an uograde is actually necessary or whether we can do it silently |
  | 58 | 58 | if (SP()->options->get('sfforceupgrade') == false && $current\_build >= SPSILENT) { |
  | 59 |  | # we can do it s~~li~~ently... |
  |  | 59 | # we can do it silently... |
  | 60 | 60 | require\_once SP\_PLUGIN\_DIR.'/sp-startup/install/sp-upgrade-support.php'; |
  | 61 | 61 | require\_once SP\_PLUGIN\_DIR.'/sp-startup/install/sp-install-support.php'; |
* ## [simplepress/trunk/sp-startup/forum/sp-forum-framework.php](/changeset/2804020/simplepress/trunk/sp-startup/forum/sp-forum-framework.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-startup/forum/sp-forum-framework.php")

  | [r2215409](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2215409#L20 "Show revision 2215409 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2804020#L20 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | function sp\_load\_forum\_scripts() { |
  | 21 | 21 | # Older themes (Unified) define a constant SP\_MOBILE\_THEME now being deprecated. |
  | 22 |  | # if this constant exists (custom Unfied theme) swap for theme cap registration |
  |  | 22 | # if this constant exists (custom Unified theme) swap for theme cap registration |
  | 23 | 23 | if (defined('SP\_MOBILE\_THEME') && SP\_MOBILE\_THEME) add\_theme\_support('sp-theme-responsive'); |
  | 24 | 24 |  |
  | […](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2215409#L62) | […](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2804020#L62) |  |
  | 62 | 62 | 'rejected'       => SP()->primitives->front\_text('This post is rejected because it contains embedded formatting, probably pasted in form MS Word or other WYSIWYG editor'), |
  | 63 | 63 | 'iframe'         => SP()->primitives->front\_text('This post contains an iframe which are disallowed'), |
  |  | 64 | 'object\_tag'     => SP()->primitives->front\_text('This post contains an OBJECT tag which are disallowed'), |
  |  | 65 | 'embed\_tag'      => SP()->primitives->front\_text('This post contains an EMBED tag which are disallowed'), |
  | 64 | 66 | 'savingpost'     => SP()->primitives->front\_text('Saving post'), |
  | 65 | 67 | 'nosearch'       => SP()->primitives->front\_text('No search text entered'), |
  | […](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2215409#L107) | […](/browser/simplepress/trunk/sp-startup/forum/sp-forum-framework.php?rev=2804020#L109) |  |
  | 107 | 109 | do\_action('sph\_print\_plugin\_scripts', $footer); |
  | 108 | 110 |  |
  | 109 |  | # either enqueue the combines js script cache (checks for u~~dp~~ates first) )or enqueue individual scripts |
  |  | 111 | # either enqueue the combines js script cache (checks for updates first) )or enqueue individual scripts |
  | 110 | 112 | $combine\_js = SP()->options->get('combinejs'); |
  | 111 | 113 | if ($combine\_js) { # use compressed scripts |
* ## [simplepress/trunk/sp-startup/install/sp-upgrade-support.php](/changeset/2804020/simplepress/trunk/sp-startup/install/sp-upgrade-support.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-startup/install/sp-upgrade-support.php")

  | [r1972405](/browser/simplepress/trunk/sp-startup/install/sp-upgrade-support.php?rev=1972405#L123 "Show revision 1972405 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-startup/install/sp-upgrade-support.php?rev=2804020#L123 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 123 | 123 | sp\_log\_event(SPRELEASE, SPVERSION, SPBUILD, 0); |
  | 124 | 124 |  |
  | 125 |  | # and some final cleanu~~o~~p tasks |
  |  | 125 | # and some final cleanup tasks |
  | 126 | 126 | SP()->auths->reset\_cache(); |
  | 127 | 127 |  |
* ## [simplepress/trunk/sp-startup/install/sp-upgrade.php](/changeset/2804020/simplepress/trunk/sp-startup/install/sp-upgrade.php "Show the changeset 2804020 restricted to simplepress/trunk/sp-startup/install/sp-upgrade.php")

  | [r2794238](/browser/simplepress/trunk/sp-startup/install/sp-upgrade.php?rev=2794238#L486 "Show revision 2794238 of this file in browser") | [r2804020](/browser/simplepress/trunk/sp-startup/install/sp-upgrade.php?rev=2804020#L486 "Show revision 2804020 of this file in browser") |  |
  | --- | --- | --- |
  | 486 | 486 | } |
  | 487 | 487 |  |
  |  | 488 | # Start of Upgrade Routines - 6.8.1 ============================================================ |
  |  | 489 | $section = 15878; |
  |  | 490 | if ($build < $section) { |
  |  | 491 |  |
  |  | 492 | // Add new AUTHS. |
  |  | 493 | SP()->auths->add('can\_use\_object\_tag', SP()->filters->esc\_sql(SP()->primitives->admin\_text\_noesc('Can use OBJECT and EMBED tags in posts')), 1, 1, 0, 0, 3, SP()->primitives->admin\_text('\*\*\* WARNING \*\*\* The use of the OBJECT and EMBEG tags is dangerous. Allowing users to embed objects enables them to launch a potential security threat against your website. Enabling the OBJECT and EMBED tags requires your trust in your users. Turn on with care.')); |
  |  | 494 | sp\_response($section); |
  |  | 495 | } |
  |  | 496 |  |
  | 488 | 497 | # \*\*\*\*\*\* IMPORTANT: THE FINAL $section values MUST be the same as the SPBUILD constant |
  | 489 | 498 | # \*\*\*\*\*\*            for the Upgrade to complete correctly |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2804020)
* [Zip Archive](?format=zip&new=2804020)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

