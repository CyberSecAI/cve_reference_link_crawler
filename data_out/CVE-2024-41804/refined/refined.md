Based on the provided information, here's an analysis of CVE-2024-41804:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a lack of proper sanitization and validation of user-supplied input within the `formula` parameter when adding or editing DataSet column formulas in the Xibo CMS. Specifically, the application does not adequately prevent SQL injection when processing this parameter.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is SQL injection. By crafting malicious SQL code within the `formula` parameter, an attacker can inject it into the SQL query executed by the application.
*   **Insufficient Input Validation:** The application fails to sanitize or validate the `formula` parameter, allowing for the injection of potentially harmful SQL code.

**Impact of Exploitation:**

*   **Arbitrary Data Access:** Successful exploitation allows an attacker to obtain and modify arbitrary data from the Xibo database.
*   **Data Modification:** The attacker can not only read but also modify sensitive information within the database.

**Attack Vectors:**

*   **Network:** The attack vector is network-based, as the API route is accessed over a network.
*   **API Route:** The specific vulnerable API route is responsible for adding/editing DataSet column formulas.
*   **`formula` parameter:** The `formula` parameter is the entry point for the SQL injection attack.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be an authenticated user of the Xibo CMS.
*   **Specific Privileges:** The attacker must have privileges to access the DataSet feature within the CMS.

**Additional Information:**

*   **Affected Versions:** The vulnerability affects Xibo CMS versions 2.1.0 and later, but prior to 3.3.12 and 4.0.14.
*   **Patched Versions:** The vulnerability is fixed in versions 3.3.12 and 4.0.14, and later.
*   **Mitigation:** The provided patch implements a blacklist of SQL keywords, replacing them within the formula. Also, the patch checks how many replacements were done, triggering an error if any of the blacklisted words were detected. This helps to prevent the injection of malicious SQL code.
*   **CVSS Score:** The vulnerability has a CVSS v3 base score of 6.5, indicating a moderate severity.
*   **CWE:** The vulnerability is categorized as CWE-89 (Improper Neutralization of Special Elements used in an SQL Command)
*   The advisory also references K-Xibo-2024-007, the internal reference for this SQL Injection issue

In summary, CVE-2024-41804 is an SQL injection vulnerability in Xibo CMS, allowing authenticated users with DataSet access to manipulate database content by injecting code through the `formula` parameter.