The content is related to CVE-2022-48867.

**Root cause of vulnerability:**
Use-after-free in the Intel Data Accelerator (IDXD) driver during the driver unload process.

**Weaknesses/vulnerabilities present:**
- The driver frees descriptor memory before the device has completed any potential writes to it. This is triggered during the driver unload phase when pending descriptors are flushed.
- Specifically, the `idxd_wq_free_resources()` function is called before flushing descriptors, causing the descriptor memory to be freed before it is no longer needed by the device, which leads to a use-after-free.

**Impact of exploitation:**
- Kernel crash: A "not present" page fault is triggered when the device attempts to write to the freed memory, resulting in a kernel panic.
- The vulnerability leads to a denial of service due to the system crash.

**Attack vectors:**
- The vulnerability is triggered during the driver unload process.
- Specifically, the sequence of operations triggered when unloading the idxd driver leads to the vulnerability if there are still descriptors that need to be flushed.

**Required attacker capabilities/position:**
- An attacker needs to be able to trigger the unload of the IDXD driver, and have in-flight descriptors when the driver unload process begins.