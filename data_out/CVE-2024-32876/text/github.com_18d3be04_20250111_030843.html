
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTeamNewPipe%2FNewPipe%2Fsecurity%2Fadvisories%2FGHSA-wxrm-jhpf-vp6v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTeamNewPipe%2FNewPipe%2Fsecurity%2Fadvisories%2FGHSA-wxrm-jhpf-vp6v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=TeamNewPipe%2FNewPipe)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[TeamNewPipe](/TeamNewPipe)
/
**[NewPipe](/TeamNewPipe/NewPipe)**
Public

* [Notifications](/login?return_to=%2FTeamNewPipe%2FNewPipe) You must be signed in to change notification settings
* [Fork
  3.1k](/login?return_to=%2FTeamNewPipe%2FNewPipe)
* [Star
   32.2k](/login?return_to=%2FTeamNewPipe%2FNewPipe)

* [Code](/TeamNewPipe/NewPipe)
* [Issues
  1.2k](/TeamNewPipe/NewPipe/issues)
* [Pull requests
  14](/TeamNewPipe/NewPipe/pulls)
* [Discussions](/TeamNewPipe/NewPipe/discussions)
* [Actions](/TeamNewPipe/NewPipe/actions)
* [Projects
  2](/TeamNewPipe/NewPipe/projects)
* [Wiki](/TeamNewPipe/NewPipe/wiki)
* [Security](/TeamNewPipe/NewPipe/security)
* [Insights](/TeamNewPipe/NewPipe/pulse)

Additional navigation options

* [Code](/TeamNewPipe/NewPipe)
* [Issues](/TeamNewPipe/NewPipe/issues)
* [Pull requests](/TeamNewPipe/NewPipe/pulls)
* [Discussions](/TeamNewPipe/NewPipe/discussions)
* [Actions](/TeamNewPipe/NewPipe/actions)
* [Projects](/TeamNewPipe/NewPipe/projects)
* [Wiki](/TeamNewPipe/NewPipe/wiki)
* [Security](/TeamNewPipe/NewPipe/security)
* [Insights](/TeamNewPipe/NewPipe/pulse)

# Importing malicious backups can result in arbitrary code execution

High

[Stypox](/Stypox)
published
GHSA-wxrm-jhpf-vp6v
Apr 24, 2024

## Package

org.schabi.newpipe
(Java)

## Affected versions

>= 0.13.4 and < 0.27.0

## Patched versions

>= 0.27.0

## Description

## Summary and impact

NewPipe is an Android app written in Java. It supports exporting and importing backups, as a way to let users move their data to a new device effortlessly. However, in versions up to NewPipe 0.26.1, importing a backup file from an untrusted source could have resulted in *Arbitrary Code Execution*. This is because backups are serialized/deserialized using [*Java's Object Serialization Stream Protocol*](https://docs.oracle.com/javase/6/docs/platform/serialization/spec/protocol.html), which can allow constructing any class in the app, unless properly restricted.

To exploit this vulnerability, an attacker would need to build a backup file containing the exploit, and then persuade a user into importing it. During the import process, the malicious code would be executed, possibly crashing the app, stealing user data from the NewPipe app, performing nasty actions through Android APIs, and attempting Android JVM/Sandbox escapes through vulnerabilities in the Android OS.

The attack can take place only if the user imports a malicious backup file, so an attacker would need to trick a user into importing a backup file from a source they can control. The implementation details of the malicious backup file can be independent of the attacked user or the device they are being run on, and do not require additional privileges.

## Affected versions and remediation options

All NewPipe versions from 0.13.4 to **0.26.1** are **vulnerable**.

NewPipe version **0.27.0** fixes the issue by doing the following:

* Restrict the classes that can be deserialized when calling *Java's Object Serialization Stream Protocol*, by adding a whitelist with only innocuous data-only classes that can't lead to *Abitrary Code Execution*: `Boolean`, `Byte`, `Character`, `Short`, `Integer`, `Long`, `Float`, `Double`, `Void`, `HashMap`, `HashSet` (see [cmu.edu](https://wiki.sei.cmu.edu/confluence/display/java/SER00-J.%2BEnable%2Bserialization%2Bcompatibility%2Bduring%2Bclass%2Bevolution), [OWASP cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html#harden-your-own-javaioobjectinputstream) and [Apache's `ValidatingObjectInputStream`](https://commons.apache.org/proper/commons-io/apidocs/src-html/org/apache/commons/io/serialization/ValidatingObjectInputStream.html#line-118) )
* Deprecate backups serialized with *Java's Object Serialization Stream Protocol*
* Use *JSON* serialization for all newly created backups (but still include an alternative file serialized with *Java's Object Serialization Stream Protocol* in the backup zip for backwards compatibility)
* Show a warning to the user when attempting to import a backup where the only available serialization mode is *Java's Object Serialization Stream Protocol* (note that in the future this serialization mode will be removed completely)

## More details

NewPipe backups are a `.zip` with two files:

* SQLite database (not relevant for this vulnerability)
* settings (an exploit can be embedded here)

During the import process, an `ObjectInputStream` object is used to deserialize the contents of the settings file ([see the code](https://github.com/TeamNewPipe/NewPipe/blob/v0.26.1/app/src/main/java/org/schabi/newpipe/settings/ContentSettingsManager.kt#L80)). In order for the vulnerability to be exploited, the attacker needs to find a class that allows code execution when deserialized. Note that the attacker cannot define a custom Java class within the settings file for this purpose, because Android DEX doesn't allow creating classes at runtime.

The reporter [@litetex](https://github.com/litetex) provided a *Proof of Concept* of the exploit, with a malicious backup that runs `System.exit(1337)` when imported.

## CVSS score

The potential CVSS score would be [8.5 (High)](https://chandanbn.github.io/cvss/#CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L). Here is a breakdown according to <https://www.first.org/cvss/v3.1/user-guide#Scoring-Rubrics> :

| Category | Value | Why? |
| --- | --- | --- |
| Attack vector | Local | The user needs to be tricked into importing the malicious settings |
| Attack complexity | Low | No special conditions exists, the attack works repeatably |
| User interaction | Required | The user needs to be tricked into importing the malicious settings |
| Privileges Required | None | - |
| Scope | Changed | The exploit can be used to gain further access / run any code |
| Confidentiality | High | All resources of NewPipe can be modified or stolen |
| Integrity | High | All resources of NewPipe can be modified or stolen |
| Availability | Low | An attacker can crash the app once |

## Credits

All credits for the discovery of this vulnerability go to [@litetex](https://github.com/litetex), who also provided a *Proof of Concept* exploit to the NewPipe team and an initial fix attempt in [#9887](https://github.com/TeamNewPipe/NewPipe/pull/9887). The final fix for the vulnerability was provided by [@Stypox](https://github.com/Stypox) along with the help of the NewPipe team.

### Severity

High

8.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L

### CVE ID

CVE-2024-32876

### Weaknesses

[CWE-502](/advisories?query=cwe%3A502)

### Credits

* [![@litetex](https://avatars.githubusercontent.com/u/40789489?s=40&v=4)](/litetex)
  [litetex](/litetex)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

