=== Content from element.io_50938e5f_20250110_190404.html ===

[![](/blog/assets/images/element-blog-logo.svg?v=cfa024741f)](https://element.io/)
[See all posts](https://element.io/blog)
[Get Started](https://element.io/get-started)

![](/blog/assets/images/element-logo.svg?v=cfa024741f)
[See all posts](https://element.io/blog)[Get Started](https://element.io/get-started)

# Security release: Element Android 1.6.12

February 20, 2024[Security](https://element.io/blog/tag/security/)

Hello,

Today we have released a security update of Element Android to address a pair of vulnerabilities. Please upgrade to the new version (1.6.12) at your earliest convenience.

The two vulnerabilities are as follows:

* Sensitive file disclosure via share activity (*Medium*, [CVE-2024-26132](https://www.cve.org/CVERecord?id=CVE-2024-26132), [GHSA-8wj9-cx7h-pvm4](https://github.com/element-hq/element-android/security/advisories/GHSA-8wj9-cx7h-pvm4))
* Intent redirection (*High*, [CVE-2024-26131](https://www.cve.org/CVERecord?id=CVE-2024-26131), [GHSA-j6pr-fpc8-q9vm](https://github.com/element-hq/element-android/security/advisories/GHSA-j6pr-fpc8-q9vm))

Both vulnerabilities require a malicious third-party application to be installed on the phone, alongside a vulnerable Element Android, in order to be exploited.

The new version is available on the Play Store, but we have also worked with the F-Droid package repository and SchildiChat Android (a fork of Element Android) to help ensure they have timely releases as well.

Finally, we thank Pietro `suidpit` Tirenna, Davide `TheZero` Silvetti and Abdel Adim `smaury` Oisfi of [Shielder](https://www.shielder.com/) for finding and responsibly disclosing these issues to us, helping make Element and Matrix safer for everyone.

[![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)](https://element.io/blog/author/element/)[Element Security](https://element.io/blog/author/element/)

## Related Posts

[Synapse

ESS 24.07: Enhanced deployment health monitoring and next generation authentication
We’re excited to bring you Element Server Suite (ESS) 24.07, this month’s release includes several improvements to make your organisation’s Element experience smoother and more efficient.

![](https://element.io/blog/content/images/2022/08/LIPP1sa.png)
Archie W
31/07/2024](/blog/ess-24-07-enhanced-deployment-health-monitoring-and-next-generation-authentication/)
[Cybersecurity

Disney’s Slack breach tells an important story
News of Disney’s alleged Slack breach shows what can happen when organisations trust centralised communications platforms that don’t use end-to-end encryption

![](https://element.io/blog/content/images/2020/09/Steve-Loynes.jpg)
Steve Loynes
14/07/2024](/blog/disneys-slack-breach-tells-an-important-story/)
[Security

Security release: Element X Android (0.4.12) and iOS (1.6.7)
We have released security updates

![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)
Element Security
15/05/2024](/blog/security-release-element-x-android-0-4-12-and-ios-1-6-7/)
[Security

Security release: Synapse 1.105.1
Today we are releasing Synapse

![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)
Element Security
23/04/2024](/blog/security-release-synapse-1-105-1/)

## By the same author

[Security

Security release: Element X Android (0.4.12) and iOS (1.6.7)
We have released security updates

![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)
Element Security
15/05/2024](/blog/security-release-element-x-android-0-4-12-and-ios-1-6-7/)
[Element app

Resetting the server-side key backup
What is the server-side key

![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)
Element Security
15/05/2024](/blog/resetting-the-server-side-key-backup/)
[Security

Security release: Synapse 1.105.1
Today we are releasing Synapse

![](https://element.io/blog/content/images/2024/05/Element-Logomark----Transparent---1024px.png)
Element Security
23/04/2024](/blog/security-release-synapse-1-105-1/)

### Element is the fast, simple and private way to communicate with family, friends, teams, colleagues, organisations and the wider world.

Thanks for reading our blog— if you got this far, you should head to[element.io](https://element.io)to learn more!

[Get started](https://element.io/get-started)

For Web, Android, iOS, macOS, Windows & Linux



=== Content from github.com_690050fe_20250110_190410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Felement-hq%2Felement-android%2Fsecurity%2Fadvisories%2FGHSA-j6pr-fpc8-q9vm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Felement-hq%2Felement-android%2Fsecurity%2Fadvisories%2FGHSA-j6pr-fpc8-q9vm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=element-hq%2Felement-android)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[element-hq](/element-hq)
/
**[element-android](/element-hq/element-android)**
Public

* [Notifications](/login?return_to=%2Felement-hq%2Felement-android) You must be signed in to change notification settings
* [Fork
  747](/login?return_to=%2Felement-hq%2Felement-android)
* [Star
   3.4k](/login?return_to=%2Felement-hq%2Felement-android)

* [Code](/element-hq/element-android)
* [Issues
  2.1k](/element-hq/element-android/issues)
* [Pull requests
  31](/element-hq/element-android/pulls)
* [Actions](/element-hq/element-android/actions)
* [Projects
  1](/element-hq/element-android/projects)
* [Security](/element-hq/element-android/security)
* [Insights](/element-hq/element-android/pulse)

Additional navigation options

* [Code](/element-hq/element-android)
* [Issues](/element-hq/element-android/issues)
* [Pull requests](/element-hq/element-android/pulls)
* [Actions](/element-hq/element-android/actions)
* [Projects](/element-hq/element-android/projects)
* [Security](/element-hq/element-android/security)
* [Insights](/element-hq/element-android/pulse)

# Element Android Intent Redirection

High

[dkasak](/dkasak)
published
GHSA-j6pr-fpc8-q9vm
Feb 20, 2024

## Package

im.vector.app
(Kotlin)

## Affected versions

>= 1.4.3, < 1.6.12

## Patched versions

1.6.12

## Description

### Impact

Element Android versions 1.4.3 (released on 2022-09-10) through 1.6.10 are vulnerable to intent redirection, allowing a third-party malicious application installed on the phone to start any internal activity by passing some extra parameters.

This could be exploited to make Element Android display an arbitrary web page or bypass the PIN code protection.

### Patches

Fixed in Element Android 1.6.12 (commit [5373425](https://github.com/element-hq/element-android/commit/53734255ec270b0814946350787393dfcaa2a5a9)).

### Workarounds

There is no known workaround to mitigate the issue.

### References

* [Blog post](https://element.io/blog/security-release-element-android-1-6-12/)
* <https://support.google.com/faqs/answer/9267555?hl=en>
* [5373425](https://github.com/element-hq/element-android/commit/53734255ec270b0814946350787393dfcaa2a5a9)

### For more information:

If you have any questions or comments about this advisory, please email us at security at element.io.

### Severity

High

### CVE ID

CVE-2024-26131

### Weaknesses

[CWE-923](/advisories?query=cwe%3A923) [CWE-940](/advisories?query=cwe%3A940)

### Credits

* [![@suidpit](https://avatars.githubusercontent.com/u/25264901?s=40&v=4)](/suidpit)
  [suidpit](/suidpit)
  Finder
* [![@TheZ3ro](https://avatars.githubusercontent.com/u/686894?s=40&v=4)](/TheZ3ro)
  [TheZ3ro](/TheZ3ro)
  Finder
* [![@smaury](https://avatars.githubusercontent.com/u/1758689?s=40&v=4)](/smaury)
  [smaury](/smaury)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from support.google.com_ae32479b_20250110_190411.html ===
 [Skip to main content](#hcfe-content)   [Google Help](/faqs)[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=http://support.google.com/faqs/answer/9267555%3Fhl%3Den&ec=GAZAdQ)[Google Help](/)

[* Help Center](/faqs/?hl=en)[* Google](//www.google.com/)[* Privacy Policy](//www.google.com/intl/en/privacy.html)[* Terms of Service](https://www.google.com/accounts/TOS)* Submit feedback Send feedback on...This help content & informationGeneral Help Center experienceNext[Google](//www.google.com/)
# Remediation for Intent Redirection Vulnerability

This information is intended for developers with app(s) that contain the Intent Redirection Vulnerability.

### **What’s happening**

One or more of your apps contain an Intent Redirection issue which can allow malicious apps to access private app components or files. Vulnerable locations in your app can be found in the [Play Console](https://play.google.com/console/) notification for your app. If a location ends with “(in dynamically loaded code)” then the location is in code dynamically loaded by the app or by libraries used by the app. Applications typically use dynamically loaded code through [on-demand feature delivery](https://developer.android.com/guide/playcore/feature-delivery), though other [unrecommended techniques](https://developer.android.com/training/articles/security-tips#DynamicCode) exist (some unrecommended techniques also violate the [Google Play policy](https://support.google.com/googleplay/android-developer/answer/9888379?hl=en) and should not be used). Additionally, packers can transform application code into dynamically loaded code. Please review the detailed steps below to fix the issue with your apps.

After the deadlines shown in your [Play Console](https://play.google.com/apps/publish), any apps that contain unfixed security vulnerabilities will be removed from Google Play.

### **Action required​**

1. Sign in to your [Play Console](https://play.google.com/apps/publish), and navigate to the Alerts section to see which apps are affected and the deadlines to resolve these issues.
2. Update your affected apps using the steps highlighted below.
3. Submit the updated versions of your affected apps.

Upon resubmission, your app will be reviewed again. This process can take several hours. If the app passes review and is published successfully, then no further action is required. If the app fails review, then the new app version will not be published and you will receive an email notification.

### **Additional details**

Using an untrusted [Intent](https://developer.android.com/reference/android/content/Intent.html) to launch a component (for example, by calling [startActivity](https://developer.android.com/reference/android/app/Activity#startActivity(android.content.Intent))) or to return data (for example, by calling [setResult](https://developer.android.com/reference/android/app/Activity#setResult(int,%20android.content.Intent))) is dangerous and can allow malicious apps to cause the following problems:

1. Steal sensitive files or system data (like SMS messages) from your app
2. Launch your app’s private components with poisoned arguments.

It is important that your app does not call [startActivit](https://developer.android.com/reference/android/app/Activity#startActivity(android.content.Intent))y, [startService](https://developer.android.com/reference/android/content/Context#startService(android.content.Intent)), [sendBroadcast](https://developer.android.com/reference/android/content/Context#sendBroadcast(android.content.Intent)), or [setResult](https://developer.android.com/reference/android/app/Activity#setResult(int,%20android.content.Intent)) on untrusted Intents without validating or sanitizing these Intents.

We recommend that you prevent this vulnerability in one of the following ways:

**Option 1: Make the affected app component, from which the extracted Intent is redirected, private.**

If the affected app component does not need to receive Intents from other apps then you can make that app component private by setting [android:exported=”false”](https://developer.android.com/guide/topics/manifest/activity-element#exported) in your Manifest.

**Option 2: Ensure that the extracted Intent is from a trustworthy source.**

You can verify that the originating Activity can be trusted using methods like [getCallingActivity](https://developer.android.com/reference/android/app/Activity.html#getCallingActivity()). For example:

`// check if the originating Activity is from trusted package

 if (getCallingActivity().getPackageName().equals(“known”)) {

   Intent intent = getIntent();

   // extract the nested Intent

   Intent forward = (Intent) intent.getParcelableExtra(“key”);

   // redirect the nested Intent

   startActivity(forward);

 }`

Note:

* Checking if getCallingActivity() returns a non-null value is insufficient to prevent the vulnerability. Malicious apps can supply a null value for this function.
* In the case of [Google Play Services SMS Retriever Auth](https://developers.google.com/identity/sms-retriever), protecting a broadcast receiver with the [SEND\_PERMISSION](https://developers.google.com/identity/sms-retriever/user-consent/request#2_start_listening_for_incoming_messages) will ensure that an Intent comes from Play Services.

**Option 3: Ensure that the to-be-redirected Intent is not harmful.**

You should verify that the redirected Intent

1. will not be sent to any of your app’s private components, and
2. will not be sent to an external app's component. If the redirect is intended to target an external app, be sure the intent will not [grant a URI permission](https://developer.android.com/reference/android/content/Intent.html#FLAG_GRANT_READ_URI_PERMISSION) to one of your app’s private [content providers](https://developer.android.com/guide/topics/providers/content-providers) or system data.

Apps can check which component will be used to handle the Intent before redirecting it using methods like [resolveActivity](https://developer.android.com/reference/android/content/Intent.html#resolveActivity(android.content.pm.PackageManager)). For example:

`Intent intent = getIntent();

 // extract the nested Intent

 Intent forward = (Intent) intent.getParcelableExtra(“key”);

 // get the component name

 ComponentName name = forward.resolveActivity(getPackageManager());

 // check that the package name and class name are as intended

 if (name.getPackageName().equals(“safe_package”) &&

     name.getClassName().equals(“safe_class”)) {

   // redirect the nested Intent

   startActivity(forward);

 }`

Apps can check whether an Intent grants a URI permission using methods like [getFlags](https://developer.android.com/reference/android/content/Intent#getFlags()). For example:

`// extract the nested Intent

 Intent forward = (Intent) intent.getParcelableExtra(“key”);

 // get the flags

 int flags = forward.getFlags();

 // check that the nested intent does not grant URI permissions

 if ((flags & Intent.FLAG_GRANT_READ_URI_PERMISSION == 0) &&

     (flags & Intent.FLAG_GRANT_WRITE_URI_PERMISSION == 0)) {

   // redirect the nested Intent

   startActivity(forward);

 }`

Apps can also remove grants of URI permissions using [removeFlags](https://developer.android.com/reference/android/content/Intent#removeFlags(int)). For example:

`// untrusted Intent

 Intent intent = getIntent();

 // remove the grant URI permissions in the untrusted Intent

 intent.removeFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);

 intent.removeFlags(Intent.FLAG_GRANT_WRITE_URI_PERMISSION);

 // pass the untrusted Intent

 setResult(intent);`

### **Understanding Alerts and Choosing a Prevention Option**

The Play Console alert reports where your app calls startActivity, startActivityForResult, startService, sendBroadcast, or setResult using an untrusted Intent. To better understand which prevention option is most appropriate, trace back and look at callers of methods to find where the untrusted Intent originates. For example, for Option 1, trace back to determine which component to make private.

**We’re here to help**

If you have technical questions about the vulnerability, you can post to [Stack Overflow](http://stackoverflow.com/questions) and use the tag “android-security.” For clarification on steps you need to take to resolve this issue, you can contact our [developer support team](https://support.google.com/googleplay/android-developer/contact/app_vuln).

## Was this helpful?

How can we improve it?YesNoSubmit       false

* ©2025 Google
* [Privacy Policy](//www.google.com/intl/en/privacy.html)
* [Terms of Service](https://www.google.com/accounts/TOS)

  Language   català‎dansk‎Deutsch‎eesti‎English (Australia)‎English (United Kingdom)‎español‎español (Latinoamérica)‎Filipino‎français‎hrvatski‎Indonesia‎italiano‎Kiswahili‎latviešu‎lietuvių‎magyar‎Melayu‎Nederlands‎norsk‎polski‎português‎português (Brasil)‎română‎slovenčina‎slovenščina‎suomi‎svenska‎Tiếng Việt‎Türkçe‎čeština‎Ελληνικά‎български‎русский‎српски‎українська‎‏עברית‏اردو‏العربيةमराठी‎हिन्दी‎বাংলা‎ਪੰਜਾਬੀ‎ગુજરાતી‎தமிழ்‎తెలుగు‎ಕನ್ನಡ‎മലയാളം‎සිංහල‎ไทย‎中文（简体）‎中文（繁體）‎中文（香港）‎日本語‎한국어‎ English‎       Enable Dark Mode     Send feedback on... This help content & information General Help Center experience       Google appsMain menu    5242658568689629719              true       Search Help Center  true   true   true        true true 5016068             false                    false

=== Content from github.com_a1fcc179_20250110_190410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Felement-hq%2Felement-android%2Fcommit%2F53734255ec270b0814946350787393dfcaa2a5a9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Felement-hq%2Felement-android%2Fcommit%2F53734255ec270b0814946350787393dfcaa2a5a9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=element-hq%2Felement-android)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[element-hq](/element-hq)
/
**[element-android](/element-hq/element-android)**
Public

* [Notifications](/login?return_to=%2Felement-hq%2Felement-android) You must be signed in to change notification settings
* [Fork
  747](/login?return_to=%2Felement-hq%2Felement-android)
* [Star
   3.4k](/login?return_to=%2Felement-hq%2Felement-android)

* [Code](/element-hq/element-android)
* [Issues
  2.1k](/element-hq/element-android/issues)
* [Pull requests
  31](/element-hq/element-android/pulls)
* [Actions](/element-hq/element-android/actions)
* [Projects
  1](/element-hq/element-android/projects)
* [Security](/element-hq/element-android/security)
* [Insights](/element-hq/element-android/pulse)

Additional navigation options

* [Code](/element-hq/element-android)
* [Issues](/element-hq/element-android/issues)
* [Pull requests](/element-hq/element-android/pulls)
* [Actions](/element-hq/element-android/actions)
* [Projects](/element-hq/element-android/projects)
* [Security](/element-hq/element-android/security)
* [Insights](/element-hq/element-android/pulse)

## Commit

[Permalink](/element-hq/element-android/commit/53734255ec270b0814946350787393dfcaa2a5a9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add a check on incoming intent.

[Browse files](/element-hq/element-android/tree/53734255ec270b0814946350787393dfcaa2a5a9)
Browse the repository at this point in the history

* Loading branch information

[![@bmarty](https://avatars.githubusercontent.com/u/3940906?s=40&v=4)](/bmarty)

[bmarty](/element-hq/element-android/commits?author=bmarty "View all commits by bmarty")
committed
Feb 16, 2024

1 parent
[355d091](/element-hq/element-android/commit/355d091c941774503707384732afc34a774392d1)

commit 5373425

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**20 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changelog.d

  + changelog.d/+check-intent.bugfix
    [+check-intent.bugfix](#diff-41c54403bd16235b851a4942ed9b31bf073e81db7955497d08c9874694652f17)
* vector/src/main/java/im/vector/app/features

  + vector/src/main/java/im/vector/app/features/MainActivity.kt
    [MainActivity.kt](#diff-e39e974dc940da7a8c652504ffbfb1506a3296fc6ceb2c0c28f5524a1e900f5f)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[changelog.d/+check-intent.bugfix](#diff-41c54403bd16235b851a4942ed9b31bf073e81db7955497d08c9874694652f17 "changelog.d/+check-intent.bugfix")

Show comments

[View file](/element-hq/element-android/blob/53734255ec270b0814946350787393dfcaa2a5a9/changelog.d/%2Bcheck-intent.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | Add a check on incoming intent. |

19 changes: 19 additions & 0 deletions

19
[vector/src/main/java/im/vector/app/features/MainActivity.kt](#diff-e39e974dc940da7a8c652504ffbfb1506a3296fc6ceb2c0c28f5524a1e900f5f "vector/src/main/java/im/vector/app/features/MainActivity.kt")

Show comments

[View file](/element-hq/element-android/blob/53734255ec270b0814946350787393dfcaa2a5a9/vector/src/main/java/im/vector/app/features/MainActivity.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,6 +39,9 @@ import im.vector.app.features.analytics.VectorAnalytics |
|  |  | import im.vector.app.features.analytics.plan.ViewRoom |
|  |  | import im.vector.app.features.home.HomeActivity |
|  |  | import im.vector.app.features.home.ShortcutsHandler |
|  |  | import im.vector.app.features.home.room.detail.RoomDetailActivity |
|  |  | import im.vector.app.features.home.room.threads.ThreadsActivity |
|  |  | import im.vector.app.features.location.live.map.LiveLocationMapViewActivity |
|  |  | import im.vector.app.features.notifications.NotificationDrawerManager |
|  |  | import im.vector.app.features.pin.UnlockedActivity |
|  |  | import im.vector.app.features.pin.lockscreen.crypto.LockScreenKeyRepository |
| Expand Down  Expand Up | | @@ -115,6 +118,14 @@ class MainActivity : VectorBaseActivity<ActivityMainBinding>(), UnlockedActivity |
|  |  | putExtra(EXTRA\_ROOM\_ID, roomId) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | val allowList = listOf( |
|  |  | HomeActivity::class.java.name, |
|  |  | MainActivity::class.java.name, |
|  |  | RoomDetailActivity::class.java.name, |
|  |  | ThreadsActivity::class.java.name, |
|  |  | LiveLocationMapViewActivity::class.java.name, |
|  |  | ) |
|  |  | } |
|  |  |  |
|  |  | private val startAppViewModel: StartAppViewModel by viewModel() |
| Expand Down  Expand Up | | @@ -186,6 +197,7 @@ class MainActivity : VectorBaseActivity<ActivityMainBinding>(), UnlockedActivity |
|  |  | // Start the next Activity |
|  |  | startSyncing() |
|  |  | val nextIntent = intent.getParcelableExtraCompat<Intent>(EXTRA\_NEXT\_INTENT) |
|  |  | ?.takeIf { it.isValid() } |
|  |  | startIntentAndFinish(nextIntent) |
|  |  | } else if (intent.hasExtra(EXTRA\_INIT\_SESSION)) { |
|  |  | startSyncing() |
| Expand Down  Expand Up | | @@ -380,4 +392,11 @@ class MainActivity : VectorBaseActivity<ActivityMainBinding>(), UnlockedActivity |
|  |  | intent?.let { startActivity(it) } |
|  |  | finish() |
|  |  | } |
|  |  |  |
|  |  | private fun Intent.isValid(): Boolean { |
|  |  | val componentName = resolveActivity(packageManager) ?: return false |
|  |  | val packageName = componentName.packageName |
|  |  | val className = componentName.className |
|  |  | return packageName == buildMeta.applicationId && className in allowList |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `5373425`

[![@NicolasBuquet](https://avatars.githubusercontent.com/u/18608158?s=80&v=4)](/NicolasBuquet)

Copy link

### @NicolasBuquet **[NicolasBuquet](/NicolasBuquet)** commented on `[5373425](/element-hq/element-android/commit/53734255ec270b0814946350787393dfcaa2a5a9)` [Feb 21, 2024](#commitcomment-138885096)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Is the comparison against list of class names ok with code obfuscation?

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Felement-hq%2Felement-android%2Fcommit%2F53734255ec270b0814946350787393dfcaa2a5a9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


