Based on the provided content, here's an analysis of the vulnerability described in the context of CVE-2021-41571:

**Root cause of vulnerability:**

The `get-message-by-id` admin command in Apache Pulsar did not properly validate the topic associated with the message ID being requested. It would fetch and return the message based on the message ID (ledger ID and entry ID), regardless of the topic specified in the command. This is because the topic was only used for validating ledgerId and some auth, not when fetching the message by id

**Weaknesses/vulnerabilities present:**
- **Insecure message retrieval:** The `get-message-by-id` command did not enforce topic boundaries during message retrieval. This allowed a user with access to the admin command to retrieve messages from other topics by using the correct ledger and entry id, even without permission to access the topic.
- **Potential for ledger cache contamination**: Incorrect use of topics to look up messages by id could contaminate the managed ledger's cache.

**Impact of exploitation:**
- **Data leakage:** An attacker could potentially retrieve messages from topics they were not authorized to access, leading to data breaches and confidentiality violations.
- **Cache pollution:** Incorrectly retrieving messages by ID could lead to the ledger's cache being contaminated with data from other topics

**Attack vectors:**

- An attacker with access to the Pulsar admin command-line interface (CLI) or the administrative API could use the `get-message-by-id` command with a message ID (ledger ID and entry ID) from a topic they don't have access to, but can be used to fetch messages by id.

**Required attacker capabilities/position:**
- The attacker needs to have the ability to execute Pulsar admin commands, this requires administrative privileges or access to a service account with the appropriate permissions.
- The attacker needs to know or obtain message IDs (ledger ID and entry ID) from other topics to exploit this vulnerability.

**Additional Notes:**

- The provided content indicates that this issue was reported as a security concern.
- The vulnerability was addressed by adding a check in the `internalGetMessageById` method in `PersistentTopicsBase` to verify if the ledger ID belongs to the topic specified in the command and throwing an exception if it doesn't.
- The fix was backported to multiple branches of Pulsar.
- The comments in the issue suggest that while the topic parameter is used for lookup and authorization, it wasn't checked after the ledger is located, which exposed the vulnerability.