=== Content from www.mozilla.org_4786c028_20250108_120131.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-49

## Security Vulnerabilities fixed in Thunderbird 102.5

Announced
November 15, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Thunderbird has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Thunderbird on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Thunderbird 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_575173ab_20250108_120131.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-48

## Security Vulnerabilities fixed in Firefox ESR 102.5

Announced
November 15, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.5

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_5322b08c_20250108_120130.html ===


![](/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1790311)
* [XML](/show_bug.cgi?ctype=xml&id=1790311)

Closed
[Bug 1790311](/show_bug.cgi?id=1790311)
(CVE-2022-45411)

Opened 2 years ago
Closed 2 years ago

# Generic CORS bypass that enables Cross-Site-Tracing (XST)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Generic CORS bypass that enables Cross-Site-Tracing (XST)

## Categories

### (Core :: DOM: Networking, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Networking#DOM%3A%20Networking)

DOM: Networking
▾

Core :: DOM: Networking
Networking-related DOM APIs, such as XmlHttpRequest, Fetch, Web Sockets, EventSource, and Beacon.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 104

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

108 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed) |
| firefox108 | [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 107+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox106 |  | wontfix |
| firefox107 | + | fixed |
| firefox108 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: martin.oneal, Assigned: smayya, Mentored)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/b032108dab3ccfada1140fb485c6e182?d=mm&size=40)  [smayya](/user_profile?user_id=711499)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/f189c991b3a0cfc2f34ef558713fd1ef?d=mm&size=40)  [martin.oneal](/user_profile?user_id=713228)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b032108dab3ccfada1140fb485c6e182?d=mm&size=40)  [smayya](/user_profile?user_id=711499)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1797285](/show_bug.cgi?id=1797285 "RESOLVED DUPLICATE - cross-browser CORS bypass")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1362331 "https://bugs.chromium.org/p/chromium/issues/detail?id=1362331")

[github.com/whatwg/fetch/security/advi...](https://github.com/whatwg/fetch/security/advisories/GHSA-9hrx-wr8g-chvg "https://github.com/whatwg/fetch/security/advisories/GHSA-9hrx-wr8g-chvg")

[bugs.webkit.org/show\_bug.cgi?id=246075](https://bugs.webkit.org/show_bug.cgi?id=246075 "https://bugs.webkit.org/show_bug.cgi?id=246075")

## Details

### (4 keywords, Whiteboard: [necko-triaged][post-critsmash-triage][adv-main107+][adv-esr102.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-45411

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][post-critsmash-triage][adv-main107+][adv-esr102.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3843124_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [dmeehan](/user_profile?user_id=695136) | [in-testsuite](#c37 "2 years ago") | + |
| --- | --- | --- |
| [dmeehan](/user_profile?user_id=695136) | in-testsuite | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a4003014_553429 "2 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko](/attachment.cgi?id=9295420)  [2 years ago](#c9)  [Sunil Mayya](/user_profile?user_id=711499)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c35 "2 years ago")  dmeehan : [approval-mozilla-esr102+](#c42 "2 years ago")  tjr : [sec-approval+](#c26 "2 years ago") | [Details](/attachment.cgi?id=9295420&action=edit) | [Review](/attachment.cgi?id=9295420) |
| --- | --- | --- |
| [Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko](/attachment.cgi?id=9296476)  [2 years ago](#c10)  [Sunil Mayya](/user_profile?user_id=711499)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c36 "2 years ago")  dmeehan : [approval-mozilla-esr102+](#c43 "2 years ago")  tjr : [sec-approval+](#c30 "2 years ago") | [Details](/attachment.cgi?id=9296476&action=edit) | [Review](/attachment.cgi?id=9296476) |
| [advisory.txt](/attachment.cgi?id=9302886)  [2 years ago](#c45)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   651 bytes, text/plain |  | [Details](/attachment.cgi?id=9302886&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1790311#c0)• 2 years ago |
|  | |

Steps to reproduce:

Cross Site Tracing (XST) used to be an effective way to bypass local controls and gain access to authorization headers and cookies protected by httponly attributes. However, for many years the main browsers have implemented limits on fetch and XMLHttpRequest that stop the direct use of the TRACE method.

Out in the real world, some servers that implement CORS simply echo back the contents of the Access-Control-Request-Headers request header in the Access-Control-Allow-Headers response header. This means that it is possible to add an X-Http-Method-Override: TRACE header, which will bypass CORS protections.

The result being that if certain conditions are met (a server has lax CORS, implements the TRACE method and the X-Http-Method-Override header), then fetch and XMLHttpRequest can still be used to bypass CORS and deliver an XST attack.

This will allow any functional XSS on the site to gain access to authorization headers and cookies protected by httponly attributes.

An example of a server with CORS that echos back the Access-Control-Request-Headers header:

fetch( '<https://realtime.www.linkedin.com/realtime/connect>', {

method: 'GET',

mode: 'cors',

headers: {

'x-http-method-override': 'TRACE'

}

} );

Actual results:

The combination of issues allows an XST attack to be delivered.

Expected results:

The TRACE method should be blocked in requests from fetch and XMLHttpRequest, whether it is in the main method parameter, or in common override headers ( 'x-http-method-override, x-http-method, x-http-override )

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1790311#c1)• 2 years ago |
|  | |

Hi,

It appears this issue affects all the main browsers, and it also appears that the description above may not be the clearest possible.

I'll have another go at explaining, which should hopefully clear things up.

So a normal CORS fails because the TRACE method is blocked. This is something inherrent in all the major browsers, and was a deliberate change to stop XST.

You can see this in action if you browse to <https://www.linkedin.com>, then paste the following into the browser console. You'll see the browser block the request. All good.

```
fetch( 'https://realtime.www.linkedin.com/realtime/connect', {
      method: 'TRACE',
      mode: 'cors',
      cache: 'no-store'
} ).then( response => { console.log( response ) } )

```

Now instead, paste in the following. The CORS succeeds and the TRACE overide is sent. Not so good.

```
fetch( 'https://realtime.www.linkedin.com/realtime/connect', {
      method: 'GET',
      mode: 'cors',
      cache: 'no-store',
      headers: {
            'x-http-method-override': 'TRACE'
      }
} ).then( response => { console.log( response ) } )

```

All that is required are three things to leverage this into a working XST attack (which can be used with any XSS to bypass the httponly flags and also gain access to any authentication tokens in the header):

* a server that echos the CORS request headers (there are oodles of these);
* a server with TRACE enabled (there are also lots of these: people don't consider it an issue any more because CORS should protect it); and
* a server that responds to x-http-method-override: TRACE (less of these, but there are still plenty about).

Hopefully that helps your triage.

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1790311#c2)• 2 years ago |
|  | |

Just had confirmation from the Google team that they consider this a security bug in chrome, and are going ahead with a fix.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1790311#c3)• 2 years ago |
|  | |

Well, this is fun. Thank you for the report.

Do you know the origin of this `x-http-method-override` thing? I found <https://www.ibm.com/docs/en/odm/8.10?topic=methods-overriding-security-restrictions-http> and <https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-odata/bdbabfa6-8c4a-4741-85a9-8d93ffd66c41> but no formal specs or definitions of how this is supposed to interact with CORS.

Given this is a cross-browser issue I expect that we might need a spec update. I also wonder how this interacts with CORS simple / preflighted requests - I guess setting the header makes it a preflight request anyway? But it's ironic that both those documents basically go "ah yes, these pesky security restrictions from firewalls, here is how you bypass them", apparently without anyone thinking that maybe there were reasons for some of the security restrictions...

(In reply to scarlet from [comment #2](/show_bug.cgi?id=1790311#c2 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)"))

> Just had confirmation from the Google team that they consider this a security bug in chrome, and are going ahead with a fix.

Thanks for this as well - could you link to the chromium ticket? (Fine if confidential/hidden, but it will help us coordinate and avoid 0-daying the other browsers...)

Valentin: I *think* this is DOM: networking because fetch/xhr, but feel free to move to "regular" networking if I'm wrong...

Group: firefox-core-security → dom-core-securityStatus: UNCONFIRMED → NEWComponent: Untriaged → DOM: NetworkingEver confirmed: trueFlags: needinfo?(valentin.gosu)Flags: needinfo?(martin.oneal)Product: Firefox → Core

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1790311#c4)• 2 years ago |
|  | |

The Google chromium ticket is here: <https://bugs.chromium.org/p/chromium/issues/detail?id=1362331>

Flags: needinfo?(martin.oneal)

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1790311#c5)• 2 years ago |
|  | |

The override headers have been around fooooorever. Like you point out, they were originally plugged in by app devs to bypass pesky firewall restrictions.

But a lot of sites have these overrides enabled by default (plenty of big names in there ;) and also, so many sites have at least one CORS endpoint that simply reflects back all the headers (origin, allow and auth).

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a291625_159069)• 2 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1362331>

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1790311#c6)• 2 years ago |
|  | |

To help with the triage, I've run up a full PoC so that it is clear what the problem is, and how it works.

First browse to <https://xst.scarlet.ae> so the cookies are set (and you have something sensitive in the headers).

Then browse to any other site (such as <https://www.google.com>) so that CORS will be activated.

Then paste the following into the browser developer tools, console tab:

```
fetch( 'https://xst.scarlet.ae/', {
      method: 'POST',
      mode: 'cors',
      cache: 'no-store',
      credentials: 'include',
      headers: {
            'x-http-method-override': 'TRACE'
      }
} )
.then( ( response ) => response.text( ) )
.then( ( text ) => console.log( text ) )

```

You should now see the TRACE output, with the request headers, including cookies.

|  | [Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1790311#c7)• 2 years ago |
|  | |

Great report!

As far as I understand, this only affects servers that do the `x-http-method-override: TRACE` thing?

Could you let us know who is working on the Chrome bug, so we coordinate with them on a fix?

I assume their proposed fix is along the lines of:

> The TRACE method should be blocked in requests from fetch and XMLHttpRequest, whether it is in the main method parameter, or in common override headers ( 'x-http-method-override, x-http-method, x-http-override )

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1790311#c8)• 2 years ago |
|  | |

Exactly: if the server doesn't support the method override then it goes nowhere!

Just to add to the excitement though, there are three common override methods though:

* x-http-method-override
* x-http-method
* x-method-override

The google team are currently haggling over which subteam gets the work, but as soon as they firm it up, I'll coordinate the details!

|  | [Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a631363_415378)• 2 years ago |

Assignee: nobody → smayyaMentor: valentin.gosuSeverity: -- → S3Flags: needinfo?(valentin.gosu)Priority: -- → P1Whiteboard: [necko-triaged]

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a633074_711499)• 2 years ago |

Status: NEW → ASSIGNED

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1790311#c9)• 2 years ago |
|  | |

Attached file
[Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko](attachment.cgi?id=9295420)
— [Details](attachment.cgi?id=9295420&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a719529_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: WIP: Bug 1790311 - add guard to block usage of unsafe methods in http override headers → WIP: Bug 1790311 - add guard to block usage of unsafe methods in http override headers. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a886000_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: WIP: Bug 1790311 - add guard to block usage of unsafe methods in http override headers. r=#necko → Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a898581_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko → WIP: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a898945_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: WIP: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko → Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a899013_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko → WIP: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a899709_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: WIP: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko → Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1790311#c10)• 2 years ago |
|  | |

Attached file
[Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko](attachment.cgi?id=9296476)
— [Details](attachment.cgi?id=9296476&action=edit)

Depends on D157729

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1790311#c11)• 2 years ago |
|  | |

Just so you know, it is looking like this will be pushed through as a change to the fetch spec: <https://fetch.spec.whatwg.org/#forbidden-header-name>

|  | [Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1790311#c12)• 2 years ago |
|  | |

(In reply to scarlet from [comment #11](/show_bug.cgi?id=1790311#c11 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)"))

> Just so you know, it is looking like this will be pushed through as a change to the fetch spec: <https://fetch.spec.whatwg.org/#forbidden-header-name>

Is there a PR for this on the repo?

Also, has the Chrome bug been assigned to anyone yet. It would be nice to sync with them deploying the fix.

Flags: needinfo?(martin.oneal)

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1790311#c13)• 2 years ago |
|  | |

No PR yet: do you chaps have contacts within WHATWG that can escalate it?

Thinking about it, there will likely be other headers that should also be on the forbidden list, like Max-Forwards too.

Flags: needinfo?(martin.oneal)

|  | [Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1790311#c14)• 2 years ago |
|  | |

Maybe Anne can help with that.

Flags: needinfo?(annevk)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1790311#c15)• 2 years ago |
|  | |

I created <https://github.com/whatwg/fetch/security/advisories/GHSA-9hrx-wr8g-chvg> to discuss this. (If you want to be added, I'll need your GitHub ID.)

scarlet, could you cc annevankesteren@gmail.com on the Chromium bug? Thanks!

Flags: needinfo?(annevk)

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1790311#c16)• 2 years ago |
|  | |

Thanks: my github is <https://github.com/dramatic-bishop>

I've asked the Chromium chaps to add you to the bug too.

Do you have a contact at Apple? There's a similar browser bug going through the system there, and it might be good to pull all the people together to get a consensus on the standard first, which should make synchronising the behaviour much easier.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1790311#c17)• 2 years ago |
|  | |

Anne -is- our contact at Apple :-)

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1790311#c18)• 2 years ago |
|  | |

Haha, that makes things simple ;)

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1790311#c19)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1790311&comment_id=16099621 "2 revisions") |
|  | |

(In reply to Anne (:annevk) from [comment #15](/show_bug.cgi?id=1790311#c15 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)"))

> I created <https://github.com/whatwg/fetch/security/advisories/GHSA-9hrx-wr8g-chvg> to discuss this. (If you want to be added, I'll need your GitHub ID.)

Anne could you please add me to Bug discussion?

My github ID is - MayyaSunil

Thanks in advance!

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1790311#c20)• 2 years ago |
|  | |

Sunil, done!

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1790311#c21)• 2 years ago |
|  | |

Everything progressing ok? Do you have an ETA for a release yet?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3099960_1689)• 2 years ago |

See Also: → <https://github.com/whatwg/fetch/security/advisories/GHSA-9hrx-wr8g-chvg>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3100010_1689)• 2 years ago |

See Also: → <https://bugs.webkit.org/show_bug.cgi?id=246075>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1790311#c22)• 2 years ago |
|  | |

needinfo? for [comment 21](/show_bug.cgi?id=1790311#c21 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)")

Flags: needinfo?(valentin.gosu)Flags: needinfo?(smayya)

|  | [Valentin Gosu [:valentin] (he/him) {{ PTO 21 Dec - 06 Jan }}](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1790311#c23)• 2 years ago |
|  | |

(In reply to scarlet from [comment #21](/show_bug.cgi?id=1790311#c21 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)"))

> Everything progressing ok? Do you have an ETA for a release yet?

I just checked with the other maintainers on the github issue, and it seems the other implementers are happy to follow close.

I'll be collaborating with Sunil on the WPT tests for this, and expect we'll be requesting sec-approval in the next couple of days.

Flags: needinfo?(valentin.gosu)

|  | [scarlet](/user_profile?user_id=713228)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1790311#c24)• 2 years ago |
|  | |

cool!

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3129306_600971)• 2 years ago |

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Attachment description: WIP: Bug 1790311 - add tests to check usage of unsafe methods with x-http-override headers for Fetch/XHR → Bug 1790311 - add tests to check usage of unsafe methods with x-http-override headers for Fetch/XHR. r=#necko

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3131434_711499)• 2 years ago |

Flags: needinfo?(smayya)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3301724_600971)• 2 years ago |

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Attachment description: Bug 1790311 - Block usage of unsafe methods in http override headers for fetch/xhr. r=#necko → Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3301734_600971)• 2 years ago |

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Attachment description: Bug 1790311 - add tests to check usage of unsafe methods with x-http-override headers for Fetch/XHR. r=#necko → Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1790311#c25)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Based on the patch it is not straightforward to create an exploit.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: It is straightforward to port to other branches.

  The severity is low.
* **How likely is this patch to cause regressions; how much testing does it need?**: less likely as the code does not change any core behavior. It just introduces additional checks specific to this vulnerability.
* **Is Android affected?**: Yes
[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: sec-approval?

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3303187_711499)• 2 years ago |

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1790311#c26)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

Approved to land and request uplift. I am not sure what the policy is on WPT; I'm going to inquire if those should land now or we should hold them. Do you know if these WPT changes have been discussed or coordinated with Chrome?

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: sec-approval? → sec-approval+

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1790311#c27)• 2 years ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #26](/show_bug.cgi?id=1790311#c26 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)"))

> Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")
>
> [Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko
>
> Approved to land and request uplift. I am not sure what the policy is on WPT; I'm going to inquire if those should land now or we should hold them. Do you know if these WPT changes have been discussed or coordinated with Chrome?

Thank you Tom for approving this. We have shared the WPT patch with Chrome.

We received a suggestion to add few more positive cases for the test.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1790311#c28)• 2 years ago |
|  | |

Anne, what would you like to see as far as the WPT? Should we land them, or wait until the spec issue is public?

Flags: needinfo?(annevk)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1790311#c29)• 2 years ago |
|  | |

I think landing them would be easier for other implementers. I personally don't think the risk here is big enough to warrant more complexity.

Flags: needinfo?(annevk)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1790311#c30)• 2 years ago |
|  | |

Comment on [attachment 9296476](/attachment.cgi?id=9296476 "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") [[details]](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update WPT tests for request headers in XHR/Fetch. r=#necko

Thanks - approved to land!

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1790311#c31)• 2 years ago |
|  | |

update handling of request headers in Fetch/XHR. r=necko-reviewers,valentin

<https://hg.mozilla.org/integration/autoland/rev/7c8a24ef4a8339190e8daea55e99ce3ca4ff1d47>

<https://hg.mozilla.org/mozilla-central/rev/7c8a24ef4a83>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 108 Branch

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1790311#c32)• 2 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/4b82c5a227c7e5c7ec692f552570fc6d61833920>

Backed out for causing lint failures: <https://hg.mozilla.org/integration/autoland/rev/8938aef1f835b98b1b4286e6f2cd15db3500193e>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=HEwY3ZiDTLKxSR5qkuOtLg.0&searchStr=linting%2Copt%2Cmisc%2Cchecks%2Csource-test-mozlint-wptlint-gecko%2Cw&revision=4b82c5a227c7e5c7ec692f552570fc6d61833920>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=394215547&repo=autoland>

Failure lines:

```
TEST-UNEXPECTED-ERROR | /builds/worker/checkouts/gecko/testing/web-platform/tests/xhr/setrequestheader-header-forbidden.htm:74 | Whitespace at EOL (TRAILING WHITESPACE)
TEST-UNEXPECTED-ERROR | /builds/worker/checkouts/gecko/testing/web-platform/tests/xhr/setrequestheader-header-forbidden.htm:90 | Whitespace at EOL (TRAILING WHITESPACE)
TEST-UNEXPECTED-ERROR | /builds/worker/checkouts/gecko/tools/lint/wpt.yml:0 | Lint process exited with return code 2 (wpt)

```
Flags: needinfo?(smayya)

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1790311#c33)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

### Beta/Release Uplift Approval Request

* **User impact if declined**: Cross-Site-Tracing (XST) attack can be carried out on Servers implementing the TRACE method and supporting HTTP override headers.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The changes does not change any core functional behavior. It adds an extra layer of validation of x-http-override/x-method-override/x-http-method headers for fetch/xhr. The impact is limited to these headers.
* **String changes made/needed**:
* **Is Android affected?**: Yes
[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: approval-mozilla-beta?

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3733087_711499)• 2 years ago |

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: approval-mozilla-beta?

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3740736_711499)• 2 years ago |

Flags: needinfo?(smayya)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3745213_578488)• 2 years ago |

Flags: sec-bounty?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3784304_75935)• 2 years ago |

[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox107](/buglist.cgi?f1=cf_tracking_firefox107&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B)
[tracking-firefox108](/buglist.cgi?f1=cf_tracking_firefox108&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1790311#c34)• 2 years ago |
|  | |

update WPT tests for request headers in XHR/Fetch. r=necko-reviewers,valentin

<https://hg.mozilla.org/integration/autoland/rev/9078a8c3aa648c9d24f867655a88ac5db0810108>

<https://hg.mozilla.org/mozilla-central/rev/9078a8c3aa64>

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1790311#c35)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

Approved for 107.0b6.

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1790311#c36)• 2 years ago |
|  | |

Comment on [attachment 9296476](/attachment.cgi?id=9296476 "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") [[details]](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update WPT tests for request headers in XHR/Fetch. r=#necko

Approved for 107.0b6.

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1790311#c37)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/2f787b9f88a4>

<https://hg.mozilla.org/releases/mozilla-beta/rev/e27520f90e7a>

[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1790311#c38)• 2 years ago |
|  | |

Sunil, both patches graft cleanly to esr102. If you could add an esr uplift request when ready?

Flags: needinfo?(smayya)

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1790311#c39)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: The bug exposed vulnerability in our code which can enable an attacker to carry out Cross-Site-Tracing (XST). The bug was serious enough to enforce a change in the current fetch specification.
* **User impact if declined**: XST attack can be carried out on Servers implementing the TRACE method and supporting HTTP override headers.
* **Fix Landed on Version**: 107.0b6
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The changes does not change any core functional behavior. It adds an extra layer of validation of x-http-override/x-method-override/x-http-method headers for fetch/xhr. The impact is limited to these headers.
Flags: needinfo?(smayya)
[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: approval-mozilla-esr102?

|  | [Sunil Mayya](/user_profile?user_id=711499)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3835656_711499)• 2 years ago |

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: approval-mozilla-esr102?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3843124_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1790311#c40)• 2 years ago |
|  | |

Thank you for reporting this issue. Although I don't believe this was in any way a *browser* bug, let alone a Firefox bug, this problem that web sites have brought upon themselves was clearly putting Firefox users in danger in some cases. In that light this fix makes users safer and we are awarding a security bug bounty for that.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a3850579_406194)• 2 years ago |

Duplicate of this bug: [1797285](/show_bug.cgi?id=1797285 "RESOLVED DUPLICATE - cross-browser CORS bypass")

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1790311#c42)• 2 years ago |
|  | |

Comment on [attachment 9295420](/attachment.cgi?id=9295420 "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") [[details]](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update handling of request headers in Fetch/XHR. r=#necko

Approved for 102.5esr.

[Attachment #9295420](/attachment.cgi?id=9295420&action=edit "Bug 1790311 - update handling of request headers in Fetch/XHR. r=#necko") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1790311#c43)• 2 years ago |
|  | |

Comment on [attachment 9296476](/attachment.cgi?id=9296476 "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") [[details]](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko")

[Bug 1790311](/show_bug.cgi?id=1790311 "RESOLVED FIXED - Generic CORS bypass that enables Cross-Site-Tracing (XST)") - update WPT tests for request headers in XHR/Fetch. r=#necko

Approved for 102.5esr.

[Attachment #9296476](/attachment.cgi?id=9296476&action=edit "Bug 1790311 - update WPT tests for request headers in XHR/Fetch. r=#necko") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1790311#c44)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/c8dab52e2ead>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/ede4ac9e5b4a>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a4003014_553429)• 2 years ago |

Flags: qe-verify-Whiteboard: [necko-triaged] → [necko-triaged][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a5136416_578488)• 2 years ago |

Whiteboard: [necko-triaged][post-critsmash-triage] → [necko-triaged][post-critsmash-triage][adv-main107+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1790311#c45)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9302886)
— [Details](attachment.cgi?id=9302886&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a5151898_578488)• 2 years ago |

Whiteboard: [necko-triaged][post-critsmash-triage][adv-main107+] → [necko-triaged][post-critsmash-triage][adv-main107+][adv-esr102.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a5489456_578488)• 2 years ago |

Alias: CVE-2022-45411

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a20919830_428608)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790311#a54132688_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1790311&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Sunil Mayya](/user_profile?user_id=711499)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_18bdcdd2_20250108_120130.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-47

## Security Vulnerabilities fixed in Firefox 107

Announced
November 15, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 107

This advisory was updated December 13, 2022 to add CVE-2022-46882 and CVE-2022-46883. Both fixes were included in the original release of Firefox 107, but did not appear in the advisory published at that time.

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45407: Loading fonts on workers was not thread-safe](#CVE-2022-45407)

Reporter
Armin Ebert
Impact
high
##### Description

If an attacker loaded a font using `FontFace()` on a background worker, a use-after-free could have occurred, leading to a potentially exploitable crash.

##### References

* [Bug 1793314](https://bugzilla.mozilla.org/show_bug.cgi?id=1793314)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45413: SameSite=Strict cookies could have been sent cross-site via intent URLs](#CVE-2022-45413)

Reporter
Axel Chong
Impact
moderate
##### Description

Using the `S.browser_fallback_url parameter` parameter, an attacker could redirect a user to a URL and cause SameSite=Strict cookies to be sent.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1791201](https://bugzilla.mozilla.org/show_bug.cgi?id=1791201)

#### [#CVE-2022-40674: Use-after-free vulnerability in expat](#CVE-2022-40674)

Reporter
Rhodri James
Impact
moderate
##### Description

A flaw in XML parsing could have led to a use-after-free causing a potentially exploitable crash.
*In official releases of Firefox this vulnerability is mitigated by wasm sandboxing; versions managed by Linux distributions may have other settings.*

##### References

* [Bug 1791598](https://bugzilla.mozilla.org/show_bug.cgi?id=1791598)

#### [#CVE-2022-45415: Downloaded file may have been saved with malicious extension](#CVE-2022-45415)

Reporter
Jefferson Scher and Jayateertha Guruprasad
Impact
moderate
##### Description

When downloading an HTML file, if the title of the page was formatted as a filename with a malicious extension, Firefox may have saved the file with that extension, leading to possible system compromise if the downloaded file was later ran.

##### References

* [Bug 1793551](https://bugzilla.mozilla.org/show_bug.cgi?id=1793551)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45417: Service Workers in Private Browsing Mode may have been written to disk](#CVE-2022-45417)

Reporter
Kagami
Impact
moderate
##### Description

Service Workers did not detect Private Browsing Mode correctly in all cases, which could have led to Service Workers being written to disk for websites visited in Private Browsing Mode. This would not have persisted them in a state where they would run again, but it would have leaked Private Browsing Mode details to disk.

##### References

* [Bug 1794508](https://bugzilla.mozilla.org/show_bug.cgi?id=1794508)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-45419: Deleting a security exception did not take effect immediately](#CVE-2022-45419)

Reporter
Ronald Crane
Impact
low
##### Description

If the user added a security exception for an invalid TLS certificate, opened an ongoing TLS connection with a server that used that certificate, and then deleted the exception, Firefox would have kept the connection alive, making it seem like the certificate was still trusted.

##### References

* [Bug 1716082](https://bugzilla.mozilla.org/show_bug.cgi?id=1716082)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Using tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

#### [#CVE-2022-46883: Memory safety bugs fixed in Firefox 107](#CVE-2022-46883)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Yulia Startsev, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 106. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1584674%2C1791152%2C1792241%2C1792984%2C1793127%2C1794645)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


