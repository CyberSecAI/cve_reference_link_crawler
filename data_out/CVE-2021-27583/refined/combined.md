=== Content from github.com_ea750f4f_20250110_181341.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsgranel%2Fdirectusv8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsgranel%2Fdirectusv8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=sgranel%2Fdirectusv8)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sgranel](/sgranel)
/
**[directusv8](/sgranel/directusv8)**
Public

* [Notifications](/login?return_to=%2Fsgranel%2Fdirectusv8) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fsgranel%2Fdirectusv8)
* [Star
   0](/login?return_to=%2Fsgranel%2Fdirectusv8)

Directus V8

[0
stars](/sgranel/directusv8/stargazers) [0
forks](/sgranel/directusv8/forks) [Branches](/sgranel/directusv8/branches) [Tags](/sgranel/directusv8/tags) [Activity](/sgranel/directusv8/activity)
 [Star](/login?return_to=%2Fsgranel%2Fdirectusv8)

 [Notifications](/login?return_to=%2Fsgranel%2Fdirectusv8) You must be signed in to change notification settings

* [Code](/sgranel/directusv8)
* [Issues
  0](/sgranel/directusv8/issues)
* [Pull requests
  0](/sgranel/directusv8/pulls)
* [Actions](/sgranel/directusv8/actions)
* [Projects
  0](/sgranel/directusv8/projects)
* [Security](/sgranel/directusv8/security)
* [Insights](/sgranel/directusv8/pulse)

Additional navigation options

* [Code](/sgranel/directusv8)
* [Issues](/sgranel/directusv8/issues)
* [Pull requests](/sgranel/directusv8/pulls)
* [Actions](/sgranel/directusv8/actions)
* [Projects](/sgranel/directusv8/projects)
* [Security](/sgranel/directusv8/security)
* [Insights](/sgranel/directusv8/pulse)

# sgranel/directusv8

    main[Branches](/sgranel/directusv8/branches)[Tags](/sgranel/directusv8/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[8 Commits](/sgranel/directusv8/commits/main/) | | |
| [2fa\_secret\_readable.PNG](/sgranel/directusv8/blob/main/2fa_secret_readable.PNG "2fa_secret_readable.PNG") | | [2fa\_secret\_readable.PNG](/sgranel/directusv8/blob/main/2fa_secret_readable.PNG "2fa_secret_readable.PNG") |  |  |
| [Generate\_QRCode.PNG](/sgranel/directusv8/blob/main/Generate_QRCode.PNG "Generate_QRCode.PNG") | | [Generate\_QRCode.PNG](/sgranel/directusv8/blob/main/Generate_QRCode.PNG "Generate_QRCode.PNG") |  |  |
| [QRCode.png](/sgranel/directusv8/blob/main/QRCode.png "QRCode.png") | | [QRCode.png](/sgranel/directusv8/blob/main/QRCode.png "QRCode.png") |  |  |
| [QRCode\_read.jpg](/sgranel/directusv8/blob/main/QRCode_read.jpg "QRCode_read.jpg") | | [QRCode\_read.jpg](/sgranel/directusv8/blob/main/QRCode_read.jpg "QRCode_read.jpg") |  |  |
| [README.md](/sgranel/directusv8/blob/main/README.md "README.md") | | [README.md](/sgranel/directusv8/blob/main/README.md "README.md") |  |  |
| [admin\_profile.PNG](/sgranel/directusv8/blob/main/admin_profile.PNG "admin_profile.PNG") | | [admin\_profile.PNG](/sgranel/directusv8/blob/main/admin_profile.PNG "admin_profile.PNG") |  |  |
| [edited\_request.PNG](/sgranel/directusv8/blob/main/edited_request.PNG "edited_request.PNG") | | [edited\_request.PNG](/sgranel/directusv8/blob/main/edited_request.PNG "edited_request.PNG") |  |  |
| [limited\_right.png](/sgranel/directusv8/blob/main/limited_right.png "limited_right.png") | | [limited\_right.png](/sgranel/directusv8/blob/main/limited_right.png "limited_right.png") |  |  |
| [original\_request.PNG](/sgranel/directusv8/blob/main/original_request.PNG "original_request.PNG") | | [original\_request.PNG](/sgranel/directusv8/blob/main/original_request.PNG "original_request.PNG") |  |  |
| [response.PNG](/sgranel/directusv8/blob/main/response.PNG "response.PNG") | | [response.PNG](/sgranel/directusv8/blob/main/response.PNG "response.PNG") |  |  |
| [system\_information.PNG](/sgranel/directusv8/blob/main/system_information.PNG "system_information.PNG") | | [system\_information.PNG](/sgranel/directusv8/blob/main/system_information.PNG "system_information.PNG") |  |  |
| [user\_enumeration\_reset1.PNG](/sgranel/directusv8/blob/main/user_enumeration_reset1.PNG "user_enumeration_reset1.PNG") | | [user\_enumeration\_reset1.PNG](/sgranel/directusv8/blob/main/user_enumeration_reset1.PNG "user_enumeration_reset1.PNG") |  |  |
| [user\_enumeration\_reset2.PNG](/sgranel/directusv8/blob/main/user_enumeration_reset2.PNG "user_enumeration_reset2.PNG") | | [user\_enumeration\_reset2.PNG](/sgranel/directusv8/blob/main/user_enumeration_reset2.PNG "user_enumeration_reset2.PNG") |  |  |
| View all files | | |

## Repository files navigation

* README
# Directus V8

This article aims to discuss about security issues found in CMS Directus in version 8.7.2.

In a professional context, I process security audit against Web application running under CMS Directus. From security best practices assessment, I found several flaws which can have a significant impact on overall security. The audited platform is using php 7.4, mysql (VERSION) and Directus 8.7.2.

## Users iteration

This vulnerability aims to allow an attacker to list all configured users though the reset function.

If an attacker tries to reset an email which is already configured in the database, the service responds that a reset email was sent. However, in case of unexisting email address, the service responds that the reset email cannot be sent. From a enumeration attack with correct wordlist, an attacker will be able to identify all configured address for further password bruteforce attacks.

Request :

```
Host: demo.directus.io
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0
Accept: application/json, text/plain, */*
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/json;charset=utf-8
Content-Length: 28
Origin: https://demo.directus.io
DNT: 1
Connection: close
Referer: https://demo.directus.io/admin/

{"email":"test@yopmail.com"}

```

Response :

```
Date: Tue, 23 Feb 2021 16:16:09 GMT
Server: Apache/2.4.29 (Ubuntu)
Access-Control-Allow-Origin: https://demo.directus.io
Access-Control-Allow-Credentials: true
Content-Length: 81
Connection: close
Content-Type: application/json

{"error":{"code":107,"message":"User with email \"test@yopmail.com\" not found"}}
```

[![User enumeration with burp](https://github.com/sgranel/directusv8/raw/main/user_enumeration_reset1.PNG)](https://github.com/sgranel/directusv8/blob/main/user_enumeration_reset1.PNG)

[![User enumeration with the interface](https://github.com/sgranel/directusv8/raw/main/user_enumeration_reset2.PNG)](https://github.com/sgranel/directusv8/blob/main/user_enumeration_reset2.PNG)

**This vulnerability is reported with the CVE ID : [CVE-2021-27583](https://nvd.nist.gov/vuln/detail/CVE-2021-27583)**

## System information

This vulnerability aims to allow to an attacker to get technical information about the server engine. From a simple API calling, the server responds with technical information like, directus version, PHP version and type of database.

The attacker needs to be connected to see these information.

According to the following screenshot, all technical information can easily retrieved.

[![System information with Burp](https://github.com/sgranel/directusv8/raw/main/system_information.PNG)](https://github.com/sgranel/directusv8/blob/main/system_information.PNG)

**This vulnerability is reported with the CVE ID : [CVE-2021-26595](https://nvd.nist.gov/vuln/detail/CVE-2021-26595)**

## Privilege elevation

This vulnerability aims to allow an attacker to elevation his privilege to administrator level. On directus plaform, according high privilege to an attack can be do by accessing to the mysite/users/ID using PATCH HTTP Method. On parameters, it is quite easy to guess that administrator role is associated to the ID 1.

[![Admin profile](https://github.com/sgranel/directusv8/raw/main/admin_profile.PNG)](https://github.com/sgranel/directusv8/blob/main/admin_profile.PNG)

With a limited privilege account, it not possible to change role from interface :

[![Limited right profile](https://github.com/sgranel/directusv8/raw/main/limited_right.png)](https://github.com/sgranel/directusv8/blob/main/limited_right.png)

According to the following screenshot, the PATCH request was sent with a standard user account and is sucessfully accepted by the server:

Original request:

[![Original request](https://github.com/sgranel/directusv8/raw/main/original_request.PNG)](https://github.com/sgranel/directusv8/blob/main/original_request.PNG)

Edited request by Burp Suite:

[![Edited request](https://github.com/sgranel/directusv8/raw/main/edited_request.PNG)](https://github.com/sgranel/directusv8/blob/main/edited_request.PNG)

Response concerning the edited request:

[![Response](https://github.com/sgranel/directusv8/raw/main/response.PNG)](https://github.com/sgranel/directusv8/blob/main/response.PNG)

**This vulnerability is reported with the CVE ID : [CVE-2021-26594](https://nvd.nist.gov/vuln/detail/CVE-2021-26594)**

## Retrieve all two-factor authentications

This vulnerability aims to allow to an attacker to retrieve sensitive information about users. On directus, two-factor authentication can be configured by using QrCode.

To secure an account, a user can use a two factor authentication. To log in, he needs to send his password and then he has to write a number generated by a specific application. These number have been generated from a secret (<https://en.wikipedia.org/wiki/Multi-factor_authentication> ), saved in directus to verify the validity of the two-factor sent.

When a user enables the two-factor, he receives an QRCode to import this two factor in the specific application.

[![QR Code](https://github.com/sgranel/directusv8/raw/main/QRCode.png)](https://github.com/sgranel/directusv8/blob/main/QRCode.png)

It is possible to read this QRCode with QRCode Scanner (read with “Scanner QR” application on Android) :

[![QR Code readed](https://github.com/sgranel/directusv8/raw/main/QRCode_read.jpg)](https://github.com/sgranel/directusv8/blob/main/QRCode_read.jpg)

When an attacker, connected, can see all users and their 2FA secret :

[![All 2 FA secrets](https://github.com/sgranel/directusv8/raw/main/2fa_secret_readable.PNG)](https://github.com/sgranel/directusv8/blob/main/2fa_secret_readable.PNG)

According to the following screenshot, the server responds with full users’ data, especially 2fa\_secret parameters. From this secret information, an attacker can generate QrCode with free online website like :

[![Generating new QR Code](https://github.com/sgranel/directusv8/raw/main/Generate_QRCode.PNG)](https://github.com/sgranel/directusv8/blob/main/Generate_QRCode.PNG)

**This vulnerability is reported with the CVE ID : [CVE-2021-26593](https://nvd.nist.gov/vuln/detail/CVE-2021-26593)**

**Authors** : Stanislas GRANEL, Arnaud COURTY

This work is licensed under a
[Creative Commons Attribution-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-sa/4.0/).

[![CC BY-SA 4.0](https://camo.githubusercontent.com/13a7e651aaf2dd149483770d9c3989f48b25c5c2e09b9f21fcb7ff0f24c673d9/68747470733a2f2f6c6963656e7365627574746f6e732e6e65742f6c2f62792d73612f342e302f38387833312e706e67)](http://creativecommons.org/licenses/by-sa/4.0/)

## About

Directus V8

### Resources

[Readme](#readme-ov-file)

[Activity](/sgranel/directusv8/activity)
### Stars

[**0**
stars](/sgranel/directusv8/stargazers)
### Watchers

[**1**
watching](/sgranel/directusv8/watchers)
### Forks

[**0**
forks](/sgranel/directusv8/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsgranel%2Fdirectusv8&report=sgranel+%28user%29)

## [Releases](/sgranel/directusv8/releases)

No releases published

## [Packages 0](/users/sgranel/packages?repo_name=directusv8)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


