

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3033134%2540awesome-support%26old%3D3033134%2540awesome-support)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3018193/awesome-support "Changeset 3018193 for awesome-support")
* [Next Change](/changeset/3033138/awesome-support "Changeset 3033138 for awesome-support") →

---

# Changeset [3033134](/changeset/3033134 "Show full changeset") for [awesome-support](/browser/awesome-support?rev=3033134 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/08/2024 11:33:27 AM
([11 months](/timeline?from=2024-02-08T11%3A33%3A27Z&precision=second "See timeline at 02/08/2024 11:33:27 AM") ago)

Author:
yeisonbp
Message:

init v6.1.8

Location:
[awesome-support/trunk](/browser/awesome-support/trunk?rev=3033134)
Files:

14 edited

* [assets/admin/js/admin-edit-ticket-content.js](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=3033134 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [assets/admin/js/admin-reply.js](/browser/awesome-support/trunk/assets/admin/js/admin-reply.js?rev=3033134 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [assets/admin/js/admin-users.js](/browser/awesome-support/trunk/assets/admin/js/admin-users.js?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [awesome-support.php](/browser/awesome-support/trunk/awesome-support.php?rev=3033134 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/admin/settings/settings-style.php](/browser/awesome-support/trunk/includes/admin/settings/settings-style.php?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [includes/admin/upgrade/functions-upgrade.php](/browser/awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [includes/admin/views/about-tab-change-log.php](/browser/awesome-support/trunk/includes/admin/views/about-tab-change-log.php?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/class-member-query.php](/browser/awesome-support/trunk/includes/class-member-query.php?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [includes/class-wpas-editor-ajax.php](/browser/awesome-support/trunk/includes/class-wpas-editor-ajax.php?rev=3033134 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/functions-post.php](/browser/awesome-support/trunk/includes/functions-post.php?rev=3033134 "Show entry in browser")
  (modified)
  ([3 diffs](#file9 "Show differences"))
* [includes/functions-user.php](/browser/awesome-support/trunk/includes/functions-user.php?rev=3033134 "Show entry in browser")
  (modified)
  ([3 diffs](#file10 "Show differences"))
* [includes/gas-framework/lib/class-gas-framework.php](/browser/awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php?rev=3033134 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [includes/scripts.php](/browser/awesome-support/trunk/includes/scripts.php?rev=3033134 "Show entry in browser")
  (modified)
  ([3 diffs](#file12 "Show differences"))
* [readme.txt](/browser/awesome-support/trunk/readme.txt?rev=3033134 "Show entry in browser")
  (modified)
  ([2 diffs](#file13 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js](/changeset/3033134/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js "Show the changeset 3033134 restricted to awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js")

  | [r2619580](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=2619580#L37 "Show revision 2619580 of this file in browser") | [r3033134](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=3033134#L37 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 | var data = { |
  | 38 | 38 | 'action': 'wp\_editor\_content\_ajax', |
  |  | 39 | 'nonce' : WPAS\_Edit\_Ticket\_Content.editor\_content\_nonce, |
  | 39 | 40 | 'post\_id':  $(this).data('ticketid') |
  | 40 | 41 | }; |
  | […](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=2619580#L65) | […](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=3033134#L66) |  |
  | 65 | 66 | 'action': 'wpas\_edit\_ticket\_content', |
  | 66 | 67 | 'post\_id':  $(this).data('ticketid'), |
  |  | 68 | 'nonce' : WPAS\_Edit\_Ticket\_Content.editor\_content\_nonce, |
  | 67 | 69 | 'content': content |
  | 68 | 70 | }; |
  | […](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=2619580#L103) | […](/browser/awesome-support/trunk/assets/admin/js/admin-edit-ticket-content.js?rev=3033134#L105) |  |
  | 103 | 105 | var data = { |
  | 104 | 106 | 'action': 'wp\_editor\_content\_ajax', |
  |  | 107 | 'nonce' : WPAS\_Edit\_Ticket\_Content.editor\_content\_nonce, |
  | 105 | 108 | 'post\_id':  $(this).data('ticketid') |
  | 106 | 109 | }; |
* ## [awesome-support/trunk/assets/admin/js/admin-reply.js](/changeset/3033134/awesome-support/trunk/assets/admin/js/admin-reply.js "Show the changeset 3033134 restricted to awesome-support/trunk/assets/admin/js/admin-reply.js")

  | [r2978238](/browser/awesome-support/trunk/assets/admin/js/admin-reply.js?rev=2978238#L52 "Show revision 2978238 of this file in browser") | [r3033134](/browser/awesome-support/trunk/assets/admin/js/admin-reply.js?rev=3033134#L52 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 52 | 52 | data = { |
  | 53 | 53 | 'action': 'wp\_editor\_ajax', |
  |  | 54 | 'nonce' : wpasL10n.reply\_nonce, |
  | 54 | 55 | 'post\_id': replyId, |
  | 55 | 56 | 'editor\_id': editorId |
  | […](/browser/awesome-support/trunk/assets/admin/js/admin-reply.js?rev=2978238#L126) | […](/browser/awesome-support/trunk/assets/admin/js/admin-reply.js?rev=3033134#L127) |  |
  | 126 | 127 | var data = { |
  | 127 | 128 | 'action': 'wp\_editor\_content\_ajax', |
  |  | 129 | 'nonce' : wpasL10n.editor\_content\_nonce, |
  | 128 | 130 | 'post\_id': replyId |
  | 129 | 131 | }; |
* ## [awesome-support/trunk/assets/admin/js/admin-users.js](/changeset/3033134/awesome-support/trunk/assets/admin/js/admin-users.js "Show the changeset 3033134 restricted to awesome-support/trunk/assets/admin/js/admin-users.js")

  | [r2314850](/browser/awesome-support/trunk/assets/admin/js/admin-users.js?rev=2314850#L32 "Show revision 2314850 of this file in browser") | [r3033134](/browser/awesome-support/trunk/assets/admin/js/admin-users.js?rev=3033134#L32 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 32 | 32 | return { |
  | 33 | 33 | action: 'wpas\_get\_users', |
  |  | 34 | get\_users\_nonce: WPAS\_get\_users.get\_users\_nonce, |
  | 34 | 35 | cap: capability, |
  | 35 | 36 | q: params.term |
* ## [awesome-support/trunk/awesome-support.php](/changeset/3033134/awesome-support/trunk/awesome-support.php "Show the changeset 3033134 restricted to awesome-support/trunk/awesome-support.php")

  | [r3018187](/browser/awesome-support/trunk/awesome-support.php?rev=3018187#L11 "Show revision 3018187 of this file in browser") | [r3033134](/browser/awesome-support/trunk/awesome-support.php?rev=3033134#L11 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \* Plugin URI:        https://getawesomesupport.com |
  | 12 | 12 | \* Description:       Awesome Support is a great ticketing system that will help you improve your customer satisfaction by providing a unique customer support experience. |
  | 13 |  | \* Version:           6.1.~~7~~ |
  |  | 13 | \* Version:           6.1.8 |
  | 14 | 14 | \* Author:            Awesome Support Team |
  | 15 | 15 | \* Author URI:         https://getawesomesupport.com |
  | […](/browser/awesome-support/trunk/awesome-support.php?rev=3018187#L250) | […](/browser/awesome-support/trunk/awesome-support.php?rev=3033134#L250) |  |
  | 250 | 250 | \*/ |
  | 251 | 251 | private function setup\_constants() { |
  | 252 |  | define( 'WPAS\_VERSION',           '6.1.~~7~~' ); |
  |  | 252 | define( 'WPAS\_VERSION',           '6.1.8' ); |
  | 253 | 253 | define( 'WPAS\_DB\_VERSION',        '1' ); |
  | 254 | 254 | define( 'WPAS\_URL',               trailingslashit( plugin\_dir\_url( \_\_FILE\_\_ ) ) ); |
* ## [awesome-support/trunk/includes/admin/settings/settings-style.php](/changeset/3033134/awesome-support/trunk/includes/admin/settings/settings-style.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/admin/settings/settings-style.php")

  | [r2314850](/browser/awesome-support/trunk/includes/admin/settings/settings-style.php?rev=2314850#L62 "Show revision 2314850 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/admin/settings/settings-style.php?rev=3033134#L62 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | array( |
  | 63 | 63 | 'name'    => \_\_( 'Closed Status', 'awesome-support' ), |
  | 64 |  | 'id'      => 'color\_closed', |
  |  | 64 | 'id'      => 'gas\_color\_closed', |
  | 65 | 65 | 'type'    => 'color', |
  | 66 | 66 | 'default' => '#dd3333', |
* ## [awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php](/changeset/3033134/awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php")

  | [r3018187](/browser/awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php?rev=3018187#L872 "Show revision 3018187 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/admin/upgrade/functions-upgrade.php?rev=3033134#L872 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 872 | 872 | wpas\_upgrade\_581(); |
  | 873 | 873 | } |
  |  | 874 |  |
  |  | 875 | /\*\* |
  |  | 876 | \* Upgrade function for version 6.1.8 |
  |  | 877 | \* |
  |  | 878 | \* No new capabilities need to be added to certain roles. |
  |  | 879 | \* |
  |  | 880 | \* @since 6.1 |
  |  | 881 | \* @return void |
  |  | 882 | \*/ |
  |  | 883 | function wpas\_upgrade\_6180() { |
  |  | 884 | // Run the 581 upgrade option for version 6014. |
  |  | 885 | // The 581 upgrade was the internal upgrade option during testing of the 6013 release. |
  |  | 886 | // Therefore the two routines are the same and there is no reason to write a separate 6013 routine. |
  |  | 887 | // But we do want early 581 adopters to get the later changes to the update routine.  So |
  |  | 888 | // we create this 6014 routine to make sure it runs for early 520 adopters. |
  |  | 889 | wpas\_upgrade\_581(); |
  |  | 890 | } |
* ## [awesome-support/trunk/includes/admin/views/about-tab-change-log.php](/changeset/3033134/awesome-support/trunk/includes/admin/views/about-tab-change-log.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/admin/views/about-tab-change-log.php")

  | [r3018187](/browser/awesome-support/trunk/includes/admin/views/about-tab-change-log.php?rev=3018187#L3 "Show revision 3018187 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/admin/views/about-tab-change-log.php?rev=3033134#L3 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | <div class="changelog"> |
  | 4 | 4 |  |
  |  | 5 | <div class="row"> |
  |  | 6 | <div> |
  |  | 7 | <div class="about-body"> |
  |  | 8 | <h1>What's New In 6.1.8</h1> |
  |  | 9 | <h3>6.1.8 includes the 3 vulnerabilities fixes and security patches. Here is a more comprehensive list:</h3> |
  |  | 10 | <ul style="padding-left: 3em; list-style-type: disc;"> |
  |  | 11 | <li>Authenticated (Subscriber+) SQL Injection.</li> |
  |  | 12 | <li>Missing Authorization via wpas\_get\_users() function.</li> |
  |  | 13 | <li>Missing Authorization via editor\_html() function.</li> |
  |  | 14 | </ul> |
  |  | 15 | </div> |
  |  | 16 | </div> |
  |  | 17 | </div> |
  |  | 18 |  |
  |  | 19 | <hr /> |
  | 5 | 20 | <div class="row"> |
  | 6 | 21 | <div> |
* ## [awesome-support/trunk/includes/class-member-query.php](/changeset/3033134/awesome-support/trunk/includes/class-member-query.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/class-member-query.php")

  | [r2619580](/browser/awesome-support/trunk/includes/class-member-query.php?rev=2619580#L413 "Show revision 2619580 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/class-member-query.php?rev=3033134#L413 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 413 | 413 | $order\_type = $this->order ? $this->order : 'ASC'; |
  | 414 | 414 |  |
  | 415 |  | $sql .= " ORDER BY {$wpdb->users}.{$order\_field} {$order\_type}"; |
  | 416 |  | $this->members = $wpdb->get\_results( $sql ); |
  |  | 415 | $sql .= " ORDER BY {$wpdb->users}.{$order\_field} {$order\_type}"; |
  |  | 416 |  |
  |  | 417 | $prepared\_query = $wpdb->prepare( $sql ); |
  |  | 418 |  |
  |  | 419 | $this->members = $wpdb->get\_results( $prepared\_query ); |
  | 417 | 420 |  |
  | 418 | 421 | // Cache the results |
* ## [awesome-support/trunk/includes/class-wpas-editor-ajax.php](/changeset/3033134/awesome-support/trunk/includes/class-wpas-editor-ajax.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/class-wpas-editor-ajax.php")

  | [r2973923](/browser/awesome-support/trunk/includes/class-wpas-editor-ajax.php?rev=2973923#L100 "Show revision 2973923 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/class-wpas-editor-ajax.php?rev=3033134#L100 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 100 | 100 | public function editor\_html() { |
  | 101 | 101 |  |
  | 102 |  | $post\_id   = filter\_input( INPUT\_POST, 'post\_id',         FILTER\_SANITIZE\_NUMBER\_INT ); |
  | 103 |  | $editor\_id = isset( $\_POST['editor\_id'] ) ? wp\_unslash( sanitize\_text\_field( $\_POST['editor\_id'] ) ) : ''; |
  |  | 102 | /\*\* |
  |  | 103 | \* Security checking. Verify ajax via nonce. |
  |  | 104 | \*/ |
  |  | 105 | if( !check\_ajax\_referer( 'wpas\_edit\_reply', 'nonce', false ) ) { |
  |  | 106 | wpas\_debug\_display( array( 'message' => \_\_( "You don't have access to perform this action." , 'awesome-support') ) ); |
  |  | 107 | die(); |
  |  | 108 | } |
  |  | 109 |  |
  |  | 110 | $post\_id   = filter\_input( INPUT\_POST, 'post\_id',         FILTER\_SANITIZE\_NUMBER\_INT ); |
  |  | 111 | $editor\_id = isset( $\_POST['editor\_id'] ) ? wp\_unslash( sanitize\_text\_field( $\_POST['editor\_id'] ) ) : ''; |
  |  | 112 |  |
  |  | 113 | //Check permission for capability of current user |
  |  | 114 | if ( ! current\_user\_can( 'edit\_post', $post\_id ) ) { |
  |  | 115 | wpas\_debug\_display( array( 'message' => \_\_( "You don't have access to perform this action." , 'awesome-support') ) ); |
  |  | 116 | die(); |
  |  | 117 | } |
  |  | 118 |  |
  | 104 | 119 | $name = isset( $\_POST['textarea\_name'] ) ?  sanitize\_text\_field( $\_POST['textarea\_name'] ) : ''; |
  | 105 | 120 | $settings  = (array) filter\_input( INPUT\_POST, 'editor\_settings', FILTER\_UNSAFE\_RAW); |
  | […](/browser/awesome-support/trunk/includes/class-wpas-editor-ajax.php?rev=2973923#L169) | […](/browser/awesome-support/trunk/includes/class-wpas-editor-ajax.php?rev=3033134#L184) |  |
  | 169 | 184 | public function get\_content() { |
  | 170 | 185 |  |
  |  | 186 | /\*\* |
  |  | 187 | \* Security checking. Verify ajax via nonce. |
  |  | 188 | \*/ |
  |  | 189 | if( !check\_ajax\_referer( 'wpas-editor-content-nonce', 'nonce', false ) ) { |
  |  | 190 | wpas\_debug\_display( array( 'message' => \_\_( "You don't have access to perform this action." , 'awesome-support') ) ); |
  |  | 191 | die(); |
  |  | 192 | } |
  |  | 193 |  |
  | 171 | 194 | $post\_id = filter\_input( INPUT\_POST, 'post\_id', FILTER\_SANITIZE\_NUMBER\_INT ); |
  | 172 | 195 |  |
  | 173 | 196 | if ( empty( $post\_id ) ) { |
  | 174 |  | echo ''; |
  | 175 |  | die(); |
  | 176 |  | } |
  | 177 |  |  |
  |  | 197 | wpas\_debug\_display( array( 'message' => \_\_( "You don't have access to perform this action." , 'awesome-support') ) ); |
  |  | 198 | die(); |
  |  | 199 | } |
  |  | 200 |  |
  |  | 201 | //Check permission for capability of current user |
  |  | 202 | if ( ! current\_user\_can( 'edit\_ticket', $post\_id ) || !wpas\_can\_view\_ticket( $post\_id ) ) { |
  |  | 203 | wpas\_debug\_display( array( 'message' => \_\_( "You don't have access to perform this action." , 'awesome-support') ) ); |
  |  | 204 | die(); |
  |  | 205 | } |
  |  | 206 |  |
  | 178 | 207 | $post = get\_post( $post\_id ); |
  | 179 | 208 |  |
* ## [awesome-support/trunk/includes/functions-post.php](/changeset/3033134/awesome-support/trunk/includes/functions-post.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/functions-post.php")

  | [r2995351](/browser/awesome-support/trunk/includes/functions-post.php?rev=2995351#L1912 "Show revision 2995351 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/functions-post.php?rev=3033134#L1912 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 1912 | 1912 |  |
  | 1913 | 1913 | /\*\* |
  |  | 1914 | \* Security checking. Verify ajax via nonce. |
  |  | 1915 | \*/ |
  |  | 1916 | if( !check\_ajax\_referer( 'wpas-editor-content-nonce', 'nonce', false ) ) { |
  |  | 1917 | $response['message'] = \_\_( "You don't have access to perform this action." , 'awesome-support' ); |
  |  | 1918 | wp\_send\_json( $response ); |
  |  | 1919 | die(); |
  |  | 1920 | } |
  |  | 1921 |  |
  |  | 1922 | /\*\* |
  | 1914 | 1923 | \* The default response |
  | 1915 | 1924 | \*/ |
  | […](/browser/awesome-support/trunk/includes/functions-post.php?rev=2995351#L1924) | […](/browser/awesome-support/trunk/includes/functions-post.php?rev=3033134#L1933) |  |
  | 1924 | 1933 | $ticket\_id = isset( $\_POST['post\_id'] ) ? sanitize\_text\_field( $\_POST['post\_id'] ) : ''; |
  | 1925 | 1934 | $content   = isset( $\_POST['content'] ) ? wp\_kses\_post( $\_POST['content'] ) : ''; |
  |  | 1935 |  |
  | 1926 | 1936 |  |
  | 1927 | 1937 | /\*\* |
  | […](/browser/awesome-support/trunk/includes/functions-post.php?rev=2995351#L1942) | […](/browser/awesome-support/trunk/includes/functions-post.php?rev=3033134#L1952) |  |
  | 1942 | 1952 | wp\_die(); |
  | 1943 | 1953 | } |
  | 1944 |  |  |
  |  | 1954 |  |
  |  | 1955 | //Check permission for capability of current user |
  |  | 1956 | if ( ! current\_user\_can( 'edit\_ticket', $ticket\_id ) || !wpas\_can\_view\_ticket( $ticket\_id ) ) { |
  |  | 1957 | $response['message'] = \_\_( "You don't have access to perform this action." , 'awesome-support' ); |
  |  | 1958 | wp\_send\_json( $response ); |
  |  | 1959 | die(); |
  |  | 1960 | } |
  |  | 1961 |  |
  | 1945 | 1962 | /\*\* |
  | 1946 | 1963 | \* Make sure we are on the correct post type |
* ## [awesome-support/trunk/includes/functions-user.php](/changeset/3033134/awesome-support/trunk/includes/functions-user.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/functions-user.php")

  | [r2768237](/browser/awesome-support/trunk/includes/functions-user.php?rev=2768237#L1231 "Show revision 2768237 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/functions-user.php?rev=3033134#L1231 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 1231 | 1231 | function wpas\_get\_users\_ajax( $args = array() ) { |
  | 1232 | 1232 |  |
  | 1233 |  | global $wpdb; |
  | 1234 |  |  |
  |  | 1233 | global $wpdb; |
  |  | 1234 |  |
  |  | 1235 | /\*\* |
  |  | 1236 | \* Security checking. Verify ajax via nonce. |
  |  | 1237 | \*/ |
  |  | 1238 | if( !check\_ajax\_referer( 'wpas-get-users', 'get\_users\_nonce', false ) ) { |
  |  | 1239 |  |
  |  | 1240 | wp\_send\_json\_error( array( 'message' => "You don't have access to perform this action." ) ); |
  |  | 1241 | die(); |
  |  | 1242 | } |
  |  | 1243 |  |
  |  | 1244 | //Check permission for capability of current user |
  |  | 1245 | if ( ! current\_user\_can( 'edit\_ticket' ) ) { |
  |  | 1246 | wp\_send\_json\_error( array( 'message' => "You don't have access to perform this action." ) ); |
  |  | 1247 | die(); |
  |  | 1248 | } |
  |  | 1249 |  |
  | 1235 | 1250 | $defaults = array( |
  | 1236 | 1251 | 'cap'         => 'edit\_ticket', |
  | […](/browser/awesome-support/trunk/includes/functions-user.php?rev=2768237#L1248) | […](/browser/awesome-support/trunk/includes/functions-user.php?rev=3033134#L1263) |  |
  | 1248 | 1263 | } |
  | 1249 | 1264 | } |
  | 1250 |  |  |
  |  | 1265 |  |
  | 1251 | 1266 | $args = wp\_parse\_args( $args, $defaults ); |
  | 1252 | 1267 |  |
  | […](/browser/awesome-support/trunk/includes/functions-user.php?rev=2768237#L1286) | […](/browser/awesome-support/trunk/includes/functions-user.php?rev=3033134#L1301) |  |
  | 1286 | 1301 | 'ids'         => array\_map( 'intval', array\_filter( (array) $ids ) ), |
  | 1287 | 1302 | 'search'      => array( |
  | 1288 |  | 'query'    => sanitize\_text\_field( ~~$args['q']~~ ), |
  |  | 1303 | 'query'    => sanitize\_text\_field( esc\_sql( $args['q'] )), |
  | 1289 | 1304 | 'fields'   => array( 'user\_nicename', 'display\_name', 'id', 'user\_email' ), |
  | 1290 | 1305 | 'relation' => 'OR' |
* ## [awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php](/changeset/3033134/awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php")

  | [r2659569](/browser/awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php?rev=2659569#L185 "Show revision 2659569 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/gas-framework/lib/class-gas-framework.php?rev=3033134#L185 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 185 | 185 | public function rememberAllOptions( $option ) { |
  | 186 | 186 | if ( ! empty( $option->settings['id'] ) ) { |
  | 187 |  |  |
  |  | 187 |  |
  |  | 188 | if( $option->settings['id'] == 'color\_closed' ) |
  |  | 189 | { |
  |  | 190 | //echo "option<pre>";var\_dump($option);echo "<pre>"; exit; |
  |  | 191 | } |
  |  | 192 |  |
  | 188 | 193 | if ( is\_admin() && isset( $this->optionsUsed[ $option->settings['id'] ] ) ) { |
  |  | 194 |  |
  | 189 | 195 | self::displayFrameworkError( |
  | 190 | 196 | sprintf( \_\_( 'All option IDs per namespace must be unique. The id %s has been used multiple times.', GASF\_I18NDOMAIN ), |
* ## [awesome-support/trunk/includes/scripts.php](/changeset/3033134/awesome-support/trunk/includes/scripts.php "Show the changeset 3033134 restricted to awesome-support/trunk/includes/scripts.php")

  | [r2995351](/browser/awesome-support/trunk/includes/scripts.php?rev=2995351#L198 "Show revision 2995351 of this file in browser") | [r3033134](/browser/awesome-support/trunk/includes/scripts.php?rev=3033134#L198 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 198 | 198 | 'alertNoTinyMCE' => \_\_( 'No instance of TinyMCE found. Please use wp\_editor on this page at least once: http://codex.wordpress.org/Function\_Reference/wp\_editor', 'awesome-support' ), |
  | 199 | 199 | 'alertNoContent' => \_\_( "You can't submit an empty reply", 'awesome-support' ), |
  | 200 |  | 'reply\_nonce' => wp\_create\_nonce( 'wpas\_edit\_reply' ) |
  |  | 200 | 'reply\_nonce' => wp\_create\_nonce( 'wpas\_edit\_reply' ), |
  |  | 201 | 'editor\_content\_nonce' => wp\_create\_nonce( 'wpas-editor-content-nonce' ) |
  | 201 | 202 | ) ); |
  | 202 | 203 | wp\_localize\_script( 'wpas-admin-reply-history', 'WPAS\_Reply\_History', array( |
  | […](/browser/awesome-support/trunk/includes/scripts.php?rev=2995351#L362) | […](/browser/awesome-support/trunk/includes/scripts.php?rev=3033134#L363) |  |
  | 362 | 363 | wp\_enqueue\_script( 'wpas-admin-tabletojson' ); |
  | 363 | 364 | wp\_enqueue\_script( 'wpas-users' ); |
  |  | 365 | wp\_localize\_script( 'wpas-users', 'WPAS\_get\_users', array( |
  |  | 366 | 'get\_users\_nonce' => wp\_create\_nonce( 'wpas-get-users' ) |
  |  | 367 | ) ); |
  | 364 | 368 | wp\_enqueue\_script( 'wpas-admin-helpers\_functions' ); |
  | 365 | 369 | wp\_enqueue\_script( 'wpas-admin-upload' ); |
  | […](/browser/awesome-support/trunk/includes/scripts.php?rev=2995351#L374) | […](/browser/awesome-support/trunk/includes/scripts.php?rev=3033134#L378) |  |
  | 374 | 378 | wp\_enqueue\_script( 'wpas-admin-edit-ticket-content-script'); |
  | 375 | 379 | wp\_localize\_script( 'wpas-admin-edit-ticket-content-script', 'WPAS\_Edit\_Ticket\_Content', array( |
  | 376 |  | 'ajax\_url' => admin\_url( 'admin-ajax.php' ) |
  |  | 380 | 'ajax\_url' => admin\_url( 'admin-ajax.php' ), |
  |  | 381 | 'editor\_content\_nonce' => wp\_create\_nonce( 'wpas-editor-content-nonce' ) |
  | 377 | 382 | )); |
  | 378 | 383 |  |
* ## [awesome-support/trunk/readme.txt](/changeset/3033134/awesome-support/trunk/readme.txt "Show the changeset 3033134 restricted to awesome-support/trunk/readme.txt")

  | [r3018187](/browser/awesome-support/trunk/readme.txt?rev=3018187#L5 "Show revision 3018187 of this file in browser") | [r3033134](/browser/awesome-support/trunk/readme.txt?rev=3033134#L5 "Show revision 3033134 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 4.0 |
  | 6 | 6 | Tested up to: 6.4 |
  | 7 |  | Stable tag: 6.1.~~7~~ |
  |  | 7 | Stable tag: 6.1.8 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/awesome-support/trunk/readme.txt?rev=3018187#L448) | […](/browser/awesome-support/trunk/readme.txt?rev=3033134#L448) |  |
  | 448 | 448 | == Changelog == |
  | 449 | 449 |  |
  |  | 450 | = 6.1.8 |
  |  | 451 | \* Fix |
  |  | 452 | \* We fixed the 3 vulnerabilities: |
  |  | 453 | - Authenticated (Subscriber+) SQL Injection. |
  |  | 454 | - Missing Authorization via wpas\_get\_users() function. |
  |  | 455 | - Missing Authorization via editor\_html() function. |
  |  | 456 |  |
  | 450 | 457 | = 6.1.7 |
  | 451 | 458 | \* Fix |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3033134)
* [Zip Archive](?format=zip&new=3033134)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

