

:

[Skip
Navigation](#skipNav)
[![Sonatype Logo Horizontal White Color Hex](https://www.sonatype.com/hubfs/Imported%20images/Sonatype%20Logo%20Horizontal%20White%20Color%20Hex.svg)](/)
[![Sonatype_logo_full_color](https://www.sonatype.com/hs-fs/hubfs/Sonatype_logo_full_color.png?width=111&height=19&name=Sonatype_logo_full_color.png)](/)

Back

* Platform
  + - [Platform overview
      Automate your software supply chain security](/products/software-supply-chain-management)
      * [![Repo Nav Icon updated](https://www.sonatype.com/hubfs/2-2023-Product%20Logos/Repo%20Nav%20Icon%20updated.png)

        Sonatype Nexus Repository
        Build fast with centralized components](/products/sonatype-nexus-repository)
      * [![Firewall nav icon updated](https://www.sonatype.com/hubfs/2-2023-Product%20Logos/Firewall%20nav%20icon%20updated.png)

        Sonatype Repository Firewall
        Intercept malicious open source at the door.](/products/sonatype-repository-firewall)
      * [![Lifecycle nav logo updated](https://www.sonatype.com/hubfs/2-2023-Product%20Logos/Lifecycle%20nav%20logo%20updated.png)

        Sonatype Lifecycle
        Control open source risk across your SDLC](/products/open-source-security-dependency-management)
      * [![Sbom-manager-nav-icon-v2](https://www.sonatype.com/hubfs/SBOM%20Manager%20Logos/Icon%20Only/Sbom-manager-nav-icon-v2.png)

        Sonatype SBOM Manager
        Simplify SBOM compliance and monitoring](https://www.sonatype.com/products/sonatype-sbom-manager)
    - [Integrations
      Work in the tools, languages, and packages you already use](/products/integrations)
* Solutions
  + - [Integrated Innovation
      Align dev, security, and ops teams to fuel secure deployment](https://www.sonatype.com/integrated-innovation)
      * [DevOps
        Accelerate release velocity](https://www.sonatype.com/solutions/devops)
      * [Developers
        Deliver quality code fast](/solutions/software-developers)
      * [Application Security
        Manage vulnerability risks](/solutions/appsec-professionals)
      * [Legal & Compliance
        Enforce policy at scale](/solutions/legal-and-compliance-officers)
  + By Industry
    - [Government](/solutions/government)
    - [Financial Services](/solutions/banking-and-financial-services)
    - [Manufacturing](/solutions/manufacturing)
    - [Technology](/solutions/technology-and-software)
    - [Healthcare](/solutions/healthcare)
* [Pricing](https://www.sonatype.com/products/pricing)
* Resources
  + - [Resource Center
      Articles, videos, and reports that help transform the way you innovate.](https://www.sonatype.com/resources)
      * [Application Security](https://www.sonatype.com/resource-hub/appsec)
      * [DevOps](https://www.sonatype.com/resource-hub/devops)
      * [Malware & Vulnerabilities](https://www.sonatype.com/resource-hub/open-source-malware)
      * [Regulations & Compliance](https://www.sonatype.com/resource-hub/regulations-and-compliance)
      * [Software Development](https://www.sonatype.com/resource-hub/development)
      * [Software Bill of Materials (SBOM)](https://www.sonatype.com/resource-hub/sboms)
  + Resource Content- [Blogs](https://www.sonatype.com/blog)
    - [Webinars](https://www.sonatype.com/resources/webinars)
    - [Whitepapers & eBooks](https://www.sonatype.com/resources/whitepapers)

     - [101 Articles](https://www.sonatype.com/resources/articles)
    - [Videos](https://www.sonatype.com/resources/videos)
    - [Customer Stories](https://www.sonatype.com/customer-stories)
* Partners
  + - [Partner Program
      Explore the Sonatype Partner Acceleration Program](/partners)
      * [Become a Partner
        Join our extensive Sonatype Partner Network](/become-a-sonatype-partner)
      * [Find a Partner
        Find and connect with a certified Sonatype Partner](/partner/find-a-partner)
* Company
  + - [About
      Explore our software supply chain management story](/company)
    - [Careers
      Innovate with us—explore opportunities at Sonatype](/company/careers)
    - [Events
      Attend in-person or virtual learning events](/resources/upcoming-events)
    - [Newsroom
      Keep up to date on Sonatype in the news](/newsroom)
    - [Contact
      Let’s talk software supply chain](/contactus)

[Book a Demo](https://www.sonatype.com/request-a-personalized-demo)

[Book a Demo](https://www.sonatype.com/request-a-personalized-demo)

[Book a Demo](https://www.sonatype.com/request-a-personalized-demo)

[Resources](/resources)
![](https://www.sonatype.com/hubfs/1-2023%20New%20Site%20Assets/icon-chevron_btn-white.svg)
[Blog](/blog)
![](https://www.sonatype.com/hubfs/1-2023%20New%20Site%20Assets/icon-chevron_btn-white.svg)
Exploited Ivanti Connect SSRF vulnerability traced back to ...

![Sonatype Logo Full Color](https://www.sonatype.com/hubfs/Sonatype_logo_full_color.png)
![Sonatype Logo White](https://www.sonatype.com/hubfs/Logo%20-%202019/Sonatype%20Logo%20Horizontal%20White%20Color%20Hex.svg)
# Exploited Ivanti Connect SSRF vulnerability traced back to 'xmltooling' OSS library

February 05, 2024

By [Ax Sharma](https://www.sonatype.com/blog/author/ax-sharma)

5 minute read time

![](https://www.sonatype.com/hubfs/2024%20Blog%20Post%20Images/GettyImages-1939454751.jpg)

Over the past few weeks, vulnerabilities in proprietary Ivanti products, in particular Ivanti Connect Secure, Policy Secure, and ZTA gateways, have [been making headlines](https://www.bleepingcomputer.com/news/security/ivanti-warns-of-new-connect-secure-zero-day-exploited-in-attacks/) for their active exploitation in the wild.

Last month, U.S. CISA issued its first [emergency directive](https://www.bleepingcomputer.com/news/security/cisa-emergency-directive-mitigate-ivanti-zero-days-immediately/) for 2024 asking federal agencies to promptly mitigate Ivanti zero-days, primarily in response to mass exploitation of these vulnerabilities by different threat actors. After all, just as of last week, Shodan listed upwards of 22,000 internet-exposed Ivanti devices, and Shadowserver tracked more than [460 compromised Ivanti VPNs](https://twitter.com/Shadowserver/status/1749390385346994613) as of January 30, 2024. Threat actors [continue to target](https://twitter.com/Shadowserver/status/1754145361029960189) vulnerable devices as of today.

![Internet-exposed Ivanti appliances](https://www.sonatype.com/hs-fs/hubfs/DevSecOpsDays.com%20master/Imported_Blog_Media/Shodan%20-%20Internet-exposed%20Ivanti%20appliances.jpg?width=749&height=279&name=Shodan%20-%20Internet-exposed%20Ivanti%20appliances.jpg)
## xmltooling: The open source connection

It might be a little known fact that one of the high severity zero-days found in Ivanti devices is actually present in an open source component that the company has deployed in its products. The average modern application contains anywhere [between 128](https://www.sonatype.com/hubfs/Q3%202021-State%20of%20the%20Software%20Supply%20Chain-Report/SSSC-Report-2021_0913_PM_2.pdf) and [500](https://www.darkreading.com/application-security/dependency-problems-increase-for-open-source-components) open source [dependencies](/resources/articles/what-are-software-dependencies), and Ivanti's proprietary products, that also use OSS components, are no exception.

Tracked as [CVE-2024-21893](https://attackerkb.com/topics/FGlK1TVnB2/cve-2024-21893/rapid7-analysis), the Server-Side Request Forgery (SSRF) vulnerability in the SAML component used by Ivanti Connect Secure, Policy Secure, and ZTA gateways can be exploited by threat actors to access restricted resources without authentication.

Thanks to [Assetnote's](https://www.assetnote.io/resources/research/ivantis-pulse-connect-secure-auth-bypass-round-two) Dylan Pindur and Rapid7's principal security researcher, Stephen Fewer, we now know that CVE-2024-21893 is an alias for [CVE-2023-36661](https://nvd.nist.gov/vuln/detail/CVE-2023-36661) — an SSRF vulnerability present in the open source Shibboleth 'xmltooling' library, which was disclosed in June 2023.

"The SSRF, as we found it, is actually an n-day in the xmltooling library, patched out around June 2023 and assigned CVE-2023-36661," [writes](https://twitter.com/stephenfewer/status/1753507673742405636) Fewer. "The SSRF can be chained to [CVE-2024-21887](https://nvd.nist.gov/vuln/detail/CVE-2024-21887) for unauthenticated command injection with root privileges."

CVE-2023-36661 is a high-severity SSRF flaw present in the Shibboleth XMLTooling versions prior to 3.2.4, as used in OpenSAML and Shibboleth Service Provider.

Shibboleth's [official advisory](https://shibboleth.net/community/advisories/secadv_20230612.txt) notes that the flaw can be exploited by threat actors including malicious content in the KeyInfo element of the input XML that gets parsed by the library. The problematic URI, in such a case, will get resolved by the shibd process resulting in either Denial of Service (DoS) and possibly "more serious vulnerabilities."

A Proof-of-Concept (PoC) [exploit](https://attackerkb.com/topics/FGlK1TVnB2/cve-2024-21893/rapid7-analysis) shared by Rapid7, for example, demonstrates how this SSRF flaw can be leveraged by threat actors who may additionally chain it with other vulnerabilities to obtain unauthenticated remote code execution (RCE) on vulnerable Ivanti Connect Secure appliances:

![](https://www.sonatype.com/hs-fs/hubfs/DevSecOpsDays.com%20master/Imported_Blog_Media/image-png-Feb-05-2024-08-35-02-2870-AM.png?width=1666&height=510&name=image-png-Feb-05-2024-08-35-02-2870-AM.png)![](https://www.sonatype.com/hs-fs/hubfs/DevSecOpsDays.com%20master/Imported_Blog_Media/image-png-Feb-05-2024-08-37-25-4085-AM.png?width=1676&height=622&name=image-png-Feb-05-2024-08-37-25-4085-AM.png)

## Mitigations for the xmltooling flaw

Shibboleth patched CVE-2023-36661 in xmltooling v3.2.4 and above last year, but warned at the time that "this issue is not specific to the V3 XMLTooling software and is believed to impact all versions prior to v3.2.4."

The project has addressed the flaw by restricting resolution of unsafe URIs present in the XML input by adding a "BlockingXSECURIResolver" class as a part of the fix, that should thwart exploits like the one shown above.

![](https://www.sonatype.com/hs-fs/hubfs/DevSecOpsDays.com%20master/Imported_Blog_Media/image-png-Feb-05-2024-07-59-25-4275-AM.png?width=1570&height=586&name=image-png-Feb-05-2024-07-59-25-4275-AM.png)

Note, fixed v3.2.4 and higher of the XMLTooling (C++) library do not (yet) exist on the [Fedora/EPEL](https://koji.fedoraproject.org/koji/packageinfo?packageID=9386) repository. As such, it may be wiser for users relying on the repository for the xmltooling component to manually incorporate the [fix commit](https://git.shibboleth.net/view/?p=cpp-xmltooling.git;a=commitdiff;h=6080f6343f98fec085bc0fd746913ee418cc9d30) (where applicable) provided on the upstream repository to patch the flaw. According to the project, the commit may also be "in general terms applicable to V2 of the library."

![](https://www.sonatype.com/hs-fs/hubfs/DevSecOpsDays.com%20master/Imported_Blog_Media/image-png-Feb-05-2024-08-26-36-4931-AM.png?width=1350&height=806&name=image-png-Feb-05-2024-08-26-36-4931-AM.png)

Upgrading the component on Linux and similar platforms will additionally require restarting the shibd process to mitigate the flaw. Shibboleth's Service Provider Windows software v3.4.1.3 and higher also contain patched version of the library.

Ivanti's ongoing vulnerability disclosures — this one in particular, underlines the importance of employing automation for streamlining your dependency and artifact management needs as well as for preventing known vulnerable components from entering your software builds.

Security expert Will Dormann further unveiled dated open source components used by Ivanti VPN appliances as recent as 2023, hinting at other known vulnerabilities that may be exploitable in these devices.

> Things on a currrent Ivanti VPN box:
> curl 7.19.7 2009-11-04 (14 years)
> openssl 1.0.2n-fips 2017-12-07 (6 years)
> perl 5.6.1 2001-04-09 (23 years)
> psql 9.6.14 2019-06-20 (5 years)
> cabextract 0.5 2001-08-20 (22 years)
> ssh 5.3p1 2009-10-01 (14 years)
> unzip 6.00 2009-04-29 (15 years)
>
> — Will Dormann (@wdormann)
> [February 5, 2024](https://twitter.com/wdormann/status/1754574402903998502?ref_src=twsrc%5Etfw)

"This is just a spot check of a few execuables on the system. I didn't even look at any of the libraries," [writes](https://twitter.com/wdormann/status/1754582569490788742) Dormann. "If customers knew what they were purchasing, do you think they'd go through with the purchase? Imagine a complete SBOM for everything on the box..."

[Sonatype Lifecycle](https://www.sonatype.com/products/open-source-security-dependency-management) users can rely on our products to ensure they receive most up to date guidance and mitigation advice on vulnerabilities impacting open source software, and keep their [*software development life cycle (SDLC)*](https://www.sonatype.com/launchpad/guide-to-software-development-life-cycle) safe.

Update, February 5, 2024, 11:22 pm ET: Added Will Dormann's statement.

![Picture of Ax Sharma](https://www.sonatype.com/hubfs/me-quays-side-suit.jpeg)

Written by **Ax Sharma**

Ax is a Staff Security Researcher & Malware Analyst at Sonatype with a penchant for open source software. His works and expert analyses have frequently been featured by leading media outlets including the BBC. Ax's expertise lies in security vulnerability research, reverse engineering, and cybercrime investigations. He has a passion for educating a wide range of audiences through writing and vlogs.

[Explore All Posts by Ax Sharma](https://www.sonatype.com/blog/author/ax-sharma)

Tags

[vulnerability](https://www.sonatype.com/blog/tag/vulnerability)
[vulnerabilities](https://www.sonatype.com/blog/tag/vulnerabilities)
[featured](https://www.sonatype.com/blog/tag/featured)
[Sonatype Lifecycle](https://www.sonatype.com/blog/tag/sonatype-lifecycle)

### Get Sonatype Blog Digest

###

Share

## Related Resources

![SSCR - Webinar Banners_1200x627 - Webinar Social Template copy 2](https://www.sonatype.com/hubfs/SSCR%20-%20Webinar%20Banners_1200x627%20-%20Webinar%20Social%20Template%20copy%202.png)

Webinar
### [SSCR Authors Panel: AI and the Future of Open Source Security](https://www.sonatype.com/resources/webinars/sscr-authors-panel-3 "Internal link to SSCR Authors Panel: AI and the Future of Open Source Security blog post")

Register

![SSCR - Webinar Banners_1200x627 - Webinar Social Template copy 2](https://www.sonatype.com/hubfs/SSCR%20-%20Webinar%20Banners_1200x627%20-%20Webinar%20Social%20Template%20copy%202.png)

Webinar
### [SSCR Authors Panel: Malware and Security Threats in the Software Supply Chain](https://www.sonatype.com/resources/webinars/sscr-authors-panel-2 "Internal link to SSCR Authors Panel: Malware and Security Threats in the Software Supply Chain blog post")

Watch On Demand

![](https://www.sonatype.com/hubfs/12%20Days%20of%20Customers%20Social%20-%20Final%20Final%20Working%20file-21.png)

Blog Post
### [Sonatype customers leading with innovation in the new year](https://www.sonatype.com/blog/sonatype-customers-leading-with-innovation-in-the-new-year "Internal link to Sonatype customers leading with innovation in the new year blog post")

Read More

![Sonatype_logo_full_color_reverse-1](https://www.sonatype.com/hs-fs/hubfs/1-2023%20New%20Site%20Assets/SONA%20Logos/Sonatype_logo_full_color_reverse-1.png?width=182&height=37&name=Sonatype_logo_full_color_reverse-1.png)

* Platform
  + [Overview](https://www.sonatype.com/products/software-supply-chain-management)
  + [Repository](https://www.sonatype.com/products/sonatype-nexus-repository)
  + [Pricing](https://www.sonatype.com/products/pricing)
  + [Firewall](https://www.sonatype.com/products/sonatype-repository-firewall)
  + [SBOM Manager](https://www.sonatype.com/products/sonatype-sbom-manager)
  + [Lifecycle](https://www.sonatype.com/products/open-source-security-dependency-management)
  + [Integrations](https://www.sonatype.com/products/integrations)
  + Other Products
    - [Container](https://www.sonatype.com/products/container)
    - [Advanced Legal Pack](https://www.sonatype.com/products/advanced-legal-pack)

* Solutions
  + [Application Security](https://www.sonatype.com/solutions/appsec-professionals)
  + [Developers](https://www.sonatype.com/solutions/software-developers)
  + [Integrated Innovation](https://www.sonatype.com/integrated-innovation)
  + [Legal & Compliance](https://www.sonatype.com/solutions/legal-and-compliance-officers)

* Community
  + [All Day DevOps (ADDO)](https://www.alldaydevops.com/)
  + [Nexus Repository OSS](https://www.sonatype.com/products/sonatype-nexus-oss-download)
  + [Sonatype OSS Index](https://ossindex.sonatype.org/)
  + [Resource Center](https://www.sonatype.com/resources)
    - [Blog](https://www.sonatype.com/blog)
    - [Whitepapers & eBooks](https://www.sonatype.com/resources/whitepapers)
    - [Log4j Updates](https://www.sonatype.com/resources/log4j-vulnerability-resource-center)
    - [Customer Stories](https://www.sonatype.com/customer-stories)
    - [Articles](https://www.sonatype.com/resources/articles)
    - [Webinars](https://www.sonatype.com/resources/webinars)

* Partners
  + [Amazon Web Services (AWS)](https://www.sonatype.com/partners/aws-sonatype-nexus-lifecycle-sonatype)
  + [Partner Program](https://www.sonatype.com/partners)
  + [Become a Partner](https://www.sonatype.com/become-a-sonatype-partner)
  + [Find a Partner](https://www.sonatype.com/partner/find-a-partner)
  + [Red Hat OpenShift](https://www.sonatype.com/partners/redhat-openshift-sonatype-nexus-lifecycle-sonatype)
  + Customer Portal
    - [Documentation](https://help.sonatype.com/docs)
    - [My Sonatype](https://my.sonatype.com/)
    - [Customer Support](https://help.sonatype.com/docs)
    - [Training & Workshops](https://www.sonatype.com/training)

* Company
  + [Careers](https://www.sonatype.com/company/careers)
  + [Contact](https://www.sonatype.com/contactus)
  + [About](https://www.sonatype.com/company)
  + [Newsroom](https://www.sonatype.com/newsroom)
  + [Trust Center](https://www.sonatype.com/trust-center)
  + [Investors](https://www.sonatype.com/company)
  + [Press Kit](https://www.sonatype.com/newsroom)

#### Subscribe for all the latest software security news and events

Subscribe

### Subscribe Today

###

* [Terms of Service](https://www.sonatype.com/terms-of-service)
* [Privacy Policy](https://www.sonatype.com/privacy-policy)
* [Modern Slavery Statement](https://www.sonatype.com/legal/modern-slavery-statement)
* [Event Terms and Conditions](https://www.sonatype.com/events-terms-and-conditions)
* [Do Not Sell My Personal Information](https://www.requesteasy.com/5ee2-5766)
* Cookie Preferences

Copyright © 2008-present, Sonatype Inc. All rights reserved. Includes the third-party code listed here. Sonatype and Sonatype Nexus are trademarks of Sonatype, Inc. Apache Maven and Maven are trademarks of the Apache Software Foundation. M2Eclipse is a trademark of the Eclipse Foundation. All other trademarks are the property of their respective owners.

