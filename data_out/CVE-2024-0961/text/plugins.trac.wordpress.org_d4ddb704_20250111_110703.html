

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3027675%2540so-widgets-bundle%252Ftrunk%26old%3D3027506%2540so-widgets-bundle%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3027506/so-widgets-bundle/trunk?old=3027675&old_path=%2Fso-widgets-bundle%2Ftrunk)

---

# Changes in [so-widgets-bundle/trunk](/browser/so-widgets-bundle/trunk?rev=3027675 "Show entry in browser") [[3027506:3027675]](/log/so-widgets-bundle/trunk?rev=3027675&stop_rev=3027506 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[so-widgets-bundle/trunk](/browser/so-widgets-bundle/trunk?rev=3027675)
Files:

5 edited

* [base/base.php](/browser/so-widgets-bundle/trunk/base/base.php?rev=3027675 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [readme.txt](/browser/so-widgets-bundle/trunk/readme.txt?rev=3027675 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [so-widgets-bundle.php](/browser/so-widgets-bundle/trunk/so-widgets-bundle.php?rev=3027675 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [widgets/button/tpl/default.php](/browser/so-widgets-bundle/trunk/widgets/button/tpl/default.php?rev=3027675 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [widgets/contact/tpl/default.php](/browser/so-widgets-bundle/trunk/widgets/contact/tpl/default.php?rev=3027675 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [so-widgets-bundle/trunk/base/base.php](/changeset/3027675/so-widgets-bundle/trunk/base/base.php?old=3027506&old_path=so-widgets-bundle%2Ftrunk%2Fbase%2Fbase.php "Show the [3027506:3027675] differences restricted to so-widgets-bundle/trunk/base/base.php")

  | [r3027506](/browser/so-widgets-bundle/trunk/base/base.php?rev=3027506#L395 "Show revision 3027506 of this file in browser") | [r3027675](/browser/so-widgets-bundle/trunk/base/base.php?rev=3027675#L395 "Show revision 3027675 of this file in browser") |  |
  | --- | --- | --- |
  | 395 | 395 | } |
  | 396 | 396 | add\_action( 'wp\_ajax\_so\_widgets\_links\_get\_title', 'siteorigin\_widgets\_links\_get\_title' ); |
  |  | 397 |  |
  |  | 398 | /\*\* |
  |  | 399 | \* Filters onclick attributes to remove disallowed code. |
  |  | 400 | \* |
  |  | 401 | \* @param string $onclick The onclick attribute value. |
  |  | 402 | \* @return string The filtered onclick attribute value. |
  |  | 403 | \*/ |
  |  | 404 | function siteorigin\_widget\_onclick( $onclick ) { |
  |  | 405 | if ( empty( $onclick ) ) { |
  |  | 406 | return; |
  |  | 407 | } |
  |  | 408 |  |
  |  | 409 | if ( apply\_filters( 'siteorigin\_widgets\_onclick\_disallowlist', true ) ) { |
  |  | 410 | // It's possible for allowed functions to contain disallowed functions, so we need to loop through and remove. |
  |  | 411 | $disallowed\_functions = array( 'alert', 'eval', 'execScript', 'setTimeout', 'setInterval', 'function', 'document', 'Object', 'window', 'innerHTML', 'outerHTML', 'onload', 'onerror', 'onclick', 'localStorage', 'sessionStorage', 'fetch', 'XMLHttpRequest', 'jQuery', '$.', 'prototype', '\_\_proto\_\_', 'constructor', 'decode', 'encode', 'atob', 'btoa', 'Promise', 'setImmediate', 'unescape', 'escape', 'captureEvents', 'proxy', 'Reflect', 'Array', 'String', 'Math', 'Date', 'property', 'Properties', 'Error', 'Map', 'Set', 'Generator', 'Web', 'dataview', 'Blob', 'URL', 'Text', 'Intl', 'JSON', 'RegExp', 'console', 'history', 'location', 'navigator', 'screen', 'worker', 'FinalizationRegistry', 'weak' ); |
  |  | 412 |  |
  |  | 413 | do { |
  |  | 414 | $previous = $onclick; |
  |  | 415 | $onclick = preg\_replace( '/(' . implode( '|', $disallowed\_functions ) . ')/i', '', $onclick ); |
  |  | 416 | } while ( $onclick !== $previous ); |
  |  | 417 | } |
  |  | 418 |  |
  |  | 419 | if ( apply\_filters( 'siteorigin\_widgets\_onclick\_allowlist', true ) ) { |
  |  | 420 | $onclick\_parts = explode( ';', $onclick ); |
  |  | 421 | $allowed\_functions = array\_flip( array( |
  |  | 422 | '\_km', |
  |  | 423 | '\_paq', |
  |  | 424 | '\_qevents', |
  |  | 425 | '\_vis\_opt', |
  |  | 426 | 'amplitude', |
  |  | 427 | 'ce', |
  |  | 428 | 'chartbeat', |
  |  | 429 | 'clarity', |
  |  | 430 | 'clicky', |
  |  | 431 | 'crazyegg', |
  |  | 432 | 'datalayer.push', |
  |  | 433 | 'fathom', |
  |  | 434 | 'fbq', |
  |  | 435 | 'fullstory', |
  |  | 436 | 'ga', |
  |  | 437 | 'google\_optimize', |
  |  | 438 | 'gosquared', |
  |  | 439 | 'gtag', |
  |  | 440 | 'heap', |
  |  | 441 | 'hj', |
  |  | 442 | 'hubspot', |
  |  | 443 | 'Intercom', |
  |  | 444 | 'linkedin\_data\_partner\_id', |
  |  | 445 | 'logrocket', |
  |  | 446 | 'mixpanel', |
  |  | 447 | 'mouseflow', |
  |  | 448 | 'optimizely', |
  |  | 449 | 'parsely', |
  |  | 450 | 'pinterest', |
  |  | 451 | 'piwik', |
  |  | 452 | 'plausible', |
  |  | 453 | 's.omtr', |
  |  | 454 | 'snaptr', |
  |  | 455 | 'statcounter', |
  |  | 456 | 'tealium', |
  |  | 457 | 'twttr', |
  |  | 458 | 'woopra', |
  |  | 459 | 'ym', |
  |  | 460 | ) ); |
  |  | 461 |  |
  |  | 462 | // Remove anything not inside of an allowed function. |
  |  | 463 | foreach ( $onclick\_parts as $part ) { |
  |  | 464 | $function\_name = substr( $part, 0, strpos( $part, '(' ) ); |
  |  | 465 | $function\_name = strtolower( trim( $function\_name ) ); |
  |  | 466 | if ( ! isset( $allowed\_functions[ $function\_name ] ) ) { |
  |  | 467 | // Not an allowed function name, skip this part |
  |  | 468 | continue; |
  |  | 469 | } |
  |  | 470 | $onclick .= $part . ';'; |
  |  | 471 | } |
  |  | 472 | } |
  |  | 473 |  |
  |  | 474 | return wp\_unslash( esc\_js( $onclick ) ); |
  |  | 475 | } |
* ## [so-widgets-bundle/trunk/readme.txt](/changeset/3027675/so-widgets-bundle/trunk/readme.txt?old=3027506&old_path=so-widgets-bundle%2Ftrunk%2Freadme.txt "Show the [3027506:3027675] differences restricted to so-widgets-bundle/trunk/readme.txt")

  | [r3027506](/browser/so-widgets-bundle/trunk/readme.txt?rev=3027506#L4 "Show revision 3027506 of this file in browser") | [r3027675](/browser/so-widgets-bundle/trunk/readme.txt?rev=3027675#L4 "Show revision 3027675 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tested up to: 6.4 |
  | 5 | 5 | Requires PHP: 5.6.20 |
  | 6 |  | Stable tag: 1.58.~~1~~ |
  | 7 |  | Build time: 2024-01-2~~6T20:47:02~~+00:00 |
  |  | 6 | Stable tag: 1.58.2 |
  |  | 7 | Build time: 2024-01-27T17:27:08+00:00 |
  | 8 | 8 | License: GPLv3 or later |
  | 9 | 9 | Contributors: gpriday, braam-genis, alexgso |
  | […](/browser/so-widgets-bundle/trunk/readme.txt?rev=3027506#L106) | […](/browser/so-widgets-bundle/trunk/readme.txt?rev=3027675#L106) |  |
  | 106 | 106 |  |
  | 107 | 107 | == Changelog == |
  |  | 108 |  |
  |  | 109 | = 1.58.2 - 27 January 2024 = |
  |  | 110 | \* Button: Restricted OnClick field allowed values to known services and functions. |
  | 108 | 111 |  |
  | 109 | 112 | = 1.58.1 - 26 January 2024 = |
* ## [so-widgets-bundle/trunk/so-widgets-bundle.php](/changeset/3027675/so-widgets-bundle/trunk/so-widgets-bundle.php?old=3027506&old_path=so-widgets-bundle%2Ftrunk%2Fso-widgets-bundle.php "Show the [3027506:3027675] differences restricted to so-widgets-bundle/trunk/so-widgets-bundle.php")

  | [r3027506](/browser/so-widgets-bundle/trunk/so-widgets-bundle.php?rev=3027506#L3 "Show revision 3027506 of this file in browser") | [r3027675](/browser/so-widgets-bundle/trunk/so-widgets-bundle.php?rev=3027675#L3 "Show revision 3027675 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Plugin Name: SiteOrigin Widgets Bundle |
  | 4 | 4 | Description: A highly customizable collection of widgets, ready to be used anywhere, neatly bundled into a single plugin. |
  | 5 |  | Version: 1.58.~~1~~ |
  |  | 5 | Version: 1.58.2 |
  | 6 | 6 | Text Domain: so-widgets-bundle |
  | 7 | 7 | Domain Path: /lang |
  | […](/browser/so-widgets-bundle/trunk/so-widgets-bundle.php?rev=3027506#L13) | […](/browser/so-widgets-bundle/trunk/so-widgets-bundle.php?rev=3027675#L13) |  |
  | 13 | 13 | \*/ |
  | 14 | 14 |  |
  | 15 |  | define( 'SOW\_BUNDLE\_VERSION', '1.58.~~1~~' ); |
  |  | 15 | define( 'SOW\_BUNDLE\_VERSION', '1.58.2' ); |
  | 16 | 16 | define( 'SOW\_BUNDLE\_BASE\_FILE', \_\_FILE\_\_ ); |
  | 17 | 17 |  |
* ## [so-widgets-bundle/trunk/widgets/button/tpl/default.php](/changeset/3027675/so-widgets-bundle/trunk/widgets/button/tpl/default.php?old=2939064&old_path=so-widgets-bundle%2Ftrunk%2Fwidgets%2Fbutton%2Ftpl%2Fdefault.php "Show the [3027506:3027675] differences restricted to so-widgets-bundle/trunk/widgets/button/tpl/default.php")

  | [r3027506](/browser/so-widgets-bundle/trunk/widgets/button/tpl/default.php?rev=2939064#L18 "Show revision 3027506 of this file in browser") | [r3027675](/browser/so-widgets-bundle/trunk/widgets/button/tpl/default.php?rev=3027675#L18 "Show revision 3027675 of this file in browser") |  |
  | --- | --- | --- |
  | 18 | 18 | echo esc\_attr( $name ) . '="' . esc\_attr( $val ) . '" '; |
  | 19 | 19 | } |
  | 20 |  |  |
  |  | 20 |  |
  | 21 | 21 | if ( ! empty( $on\_click ) ) { |
  | 22 |  | echo 'onclick="' . ~~wp\_unslash( esc\_js( $on\_click )~~ ) . '"'; |
  |  | 22 | echo 'onclick="' . siteorigin\_widget\_onclick( $on\_click ) . '"'; |
  | 23 | 23 | } ?> |
  | 24 | 24 | > |
* ## [so-widgets-bundle/trunk/widgets/contact/tpl/default.php](/changeset/3027675/so-widgets-bundle/trunk/widgets/contact/tpl/default.php?old=3023735&old_path=so-widgets-bundle%2Ftrunk%2Fwidgets%2Fcontact%2Ftpl%2Fdefault.php "Show the [3027506:3027675] differences restricted to so-widgets-bundle/trunk/widgets/contact/tpl/default.php")

  | [r3027506](/browser/so-widgets-bundle/trunk/widgets/contact/tpl/default.php?rev=3023735#L78 "Show revision 3027506 of this file in browser") | [r3027675](/browser/so-widgets-bundle/trunk/widgets/contact/tpl/default.php?rev=3027675#L78 "Show revision 3027675 of this file in browser") |  |
  | --- | --- | --- |
  | 78 | 78 |  |
  | 79 | 79 | if ( ! empty( $onclick ) ) { |
  | 80 |  | echo 'onclick="' . ~~esc\_js~~( $onclick ) . '"'; |
  |  | 80 | echo 'onclick="' . siteorigin\_widget\_onclick( $onclick ) . '"'; |
  | 81 | 81 | } |
  | 82 | 82 | ?> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3027675&old=3027506&new_path=%2Fso-widgets-bundle%2Ftrunk&old_path=%2Fso-widgets-bundle%2Ftrunk)
* [Zip Archive](?format=zip&new=3027675&old=3027506&new_path=%2Fso-widgets-bundle%2Ftrunk&old_path=%2Fso-widgets-bundle%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

