The provided content is related to CVE-2021-47107.

**Root cause of vulnerability:**
- The vulnerability stems from an integer underflow during the calculation of the buffer size for the READDIR operation in the Network File System daemon (NFSD). Specifically, if a client sends a READDIR request with a very small count argument (e.g., zero), the calculation `count - XDR_UNIT * 2` can underflow, leading to a large positive value.

**Weaknesses/vulnerabilities present:**
- Integer underflow: When calculating the buffer size, a small `count` value results in an underflow, leading to a much larger buffer size being allocated than intended.
- Lack of input validation: The NFSD doesn't properly validate the READDIR count argument provided by the client.
- Buffer overflow: The underflowed buffer size is then used by the XDR stream functions (`xdr_reserve_space`) which write data beyond the actual allocated buffer.

**Impact of exploitation:**
- Memory corruption: The out-of-bounds write can lead to memory corruption. This could potentially lead to a denial of service (DoS), or in a worst case, arbitrary code execution if attacker gains control over the corrupted memory locations.

**Attack vectors:**
- Sending a crafted READDIR request with a small `count` argument (e.g., zero). This can be done by an attacker who can communicate with the NFS server.

**Required attacker capabilities/position:**
- The attacker needs to be able to send NFS requests to the vulnerable server.

**Additional details:**
- The vulnerability is triggered in the `nfsd_init_dirlist_pages` functions for both NFSv2/3.
- The fix involves clamping the input count using `clamp(count, (u32)(XDR_UNIT * 2), svc_max_payload(rqstp))`, ensuring that the minimum buffer size is always at least `XDR_UNIT * 2`.