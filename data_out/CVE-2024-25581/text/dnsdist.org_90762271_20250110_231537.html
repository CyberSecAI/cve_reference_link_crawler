
[![PowerDNS Logo](../_static/powerdns-logo-trans.png)](../index.html)

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](../common/security-policy.html "PowerDNS Security Policy") |
* [previous](powerdns-advisory-for-dnsdist-2018-08.html "PowerDNS Security Advisory for dnsdist 2018-08: Record smuggling when adding ECS or XPF") |
* [dnsdist documentation](../index_TOC.html) »
* [Security Advisories](index.html) »

# PowerDNS Security Advisory 2024-03: Transfer requests received over DoH can lead to a denial of service in DNSdist[Â¶](#powerdns-security-advisory-2024-03-transfer-requests-received-over-doh-can-lead-to-a-denial-of-service-in-dnsdist "Permalink to this headline")

* CVE: CVE-2024-25581
* Date: May 13th 2024
* Affects: PowerDNS DNSdist 1.9.0, 1.9.1, 1.9.2 and 1.9.3, earlier versions are not affected
* Not affected: PowerDNS DNSdist 1.9.4
* Severity: High (only in specific configurations, see below)
* Impact: Denial of service
* Exploit: This problem can be triggered by a remote, unauthenticated attacker sending a DNS query
* Risk of system compromise: None
* Solution: Upgrade to patched version or apply the workaround described below

When incoming DNS over HTTPS support is enabled using the nghttp2 provider, and queries are routed to a tcp-only or
DNS over TLS backend, an attacker can trigger an assertion failure in DNSdist by sending a request for a zone transfer
(AXFR or IXFR) over DNS over HTTPS, causing the process to stop and thus leading to a Denial of Service.
DNS over HTTPS is not enabled by default, and backends are using plain DNS (Do53) by default.

[CVSS Score: 7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1), only for configurations where incoming DoH is enabled and a TCP-only/DoT backend is enabled.

Two workarounds are available:

* refuse incoming XFR requests via a DNSdist rule: `addAction(OrRule({QTypeRule(DNSQType.AXFR), QTypeRule(DNSQType.IXFR)}), RCodeAction(DNSRCode.REFUSED))`
* switch to the legacy h2o provider by setting `library='h2o'` in the `addDOHLocal` directive

For those unable to upgrade to a new version, a minimal patch is [available for 1.9.3](https://downloads.powerdns.com/patches/2024-03)

We would like to thank Daniel Stirnimann from Switch for finding and subsequently reporting this issue.

### Quick search

#### Previous topic

[PowerDNS Security Advisory for dnsdist 2018-08: Record smuggling when adding ECS or XPF](powerdns-advisory-for-dnsdist-2018-08.html "previous chapter")

#### Next topic

[PowerDNS Security Policy](../common/security-policy.html "next chapter")

### [Table of Contents](../index_TOC.html)

* [dnsdist Overview](../index.html)
* [Installing dnsdist](../install.html)
* [Quickstart Guide](../quickstart.html)
* [Running and Configuring dnsdist](../running.html)
* [Packet Policies](../rules-actions.html)
* [Statistics](../statistics.html)
* [Caching Responses](../guides/cache.html)
* [Exporting statistics via Carbon](../guides/carbon.html)
* [Working with the dnsdist Console](../guides/console.html)
* [DNS-over-HTTP/3 (DoH3)](../guides/dns-over-http3.html)
* [DNS-over-HTTPS (DoH)](../guides/dns-over-https.html)
* [DNS-over-QUIC (DoQ)](../guides/dns-over-quic.html)
* [DNS-over-TLS](../guides/dns-over-tls.html)
* [DNSCrypt](../guides/dnscrypt.html)
* [Configuring Downstream Servers](../guides/downstreams.html)
* [Dynamic Rule Generation](../guides/dynblocks.html)
* [Guides](../guides/index.html)
* [Server pools](../guides/serverpools.html)
* [Loadbalancing and Server Policies](../guides/serverselection.html)
* [Built-in webserver](../guides/webserver.html)
* [Advanced Topics](../advanced/index.html)
* [Reference Guides](../reference/index.html)
* [Manual Pages](../manpages/index.html)
* [Changelog](../changelog.html)
* [Upgrade Guide](../upgrade_guide.html)
* [Security Advisories](index.html)
  + PowerDNS Security Advisory 2024-03: Transfer requests received over DoH can lead to a denial of service in DNSdist
  + [PowerDNS Security Advisory for dnsdist 2018-08: Record smuggling when adding ECS or XPF](powerdns-advisory-for-dnsdist-2018-08.html)
  + [PowerDNS Security Advisory 2017-02 for dnsdist: Alteration of ACLs via API authentication bypass](powerdns-advisory-for-dnsdist-2017-02.html)
  + [PowerDNS Security Advisory 2017-01 for dnsdist: Crafted backend responses can cause a denial of service](powerdns-advisory-for-dnsdist-2017-01.html)
* [PowerDNS Security Policy](../common/security-policy.html)
* [Glossary](../glossary.html)
* [PowerDNS/dnsdist license](../common/license.html)
* [End of life statements](../eol.html)

### This Page

* [Show Source](../_sources/security-advisories/powerdns-advisory-for-dnsdist-2024-03.rst.txt)

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](../common/security-policy.html "PowerDNS Security Policy") |
* [previous](powerdns-advisory-for-dnsdist-2018-08.html "PowerDNS Security Advisory for dnsdist 2018-08: Record smuggling when adding ECS or XPF") |
* [dnsdist documentation](../index_TOC.html) »
* [Security Advisories](index.html) »

© Copyright PowerDNS.COM BV and its contributors.
Created using [Sphinx](http://sphinx-doc.org/) 1.8.6.

