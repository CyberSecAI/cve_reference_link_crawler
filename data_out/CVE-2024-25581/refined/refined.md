Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**

- The vulnerability lies in how DNSdist handles zone transfer requests (AXFR or IXFR) when received over DNS over HTTPS (DoH) using the `nghttp2` provider.
- Specifically, when such requests are routed to a TCP-only or DNS over TLS (DoT) backend, it triggers an assertion failure.

**Weaknesses/Vulnerabilities Present:**

- **Assertion Failure:** The core issue is an assertion failure within the DNSdist process when handling specific combinations of DoH and TCP/DoT backends with zone transfer requests.
- **Lack of Proper Handling:** The software doesn't handle zone transfer requests over DoH correctly when configured with TCP-only or DoT backends, leading to the assertion failure.

**Impact of Exploitation:**

- **Denial of Service (DoS):** The assertion failure causes the DNSdist process to terminate, resulting in a denial of service. This means the DNS service provided by DNSdist becomes unavailable.

**Attack Vectors:**

- **Remote, Unauthenticated Attack:** An attacker can exploit this vulnerability remotely by sending a specifically crafted DNS query (AXFR or IXFR) over DoH.
- **Network Access:** The attacker needs network access to send the malicious DoH query to the vulnerable DNSdist instance.

**Required Attacker Capabilities/Position:**

- **Network access:** The attacker must be able to send network packets to the vulnerable DNSdist instance.
- **No Authentication Required:** The vulnerability can be triggered without requiring any authentication.
- **Knowledge of Target Configuration:** While not strictly required, knowledge that the target DNSdist instance uses the vulnerable `nghttp2` provider for DoH and routes to TCP-only or DoT backends would make targeting more efficient.

**Additional Details:**

- The vulnerability is present in PowerDNS DNSdist versions 1.9.0, 1.9.1, 1.9.2, and 1.9.3.
- Version 1.9.4 is not affected.
- The issue only occurs when incoming DoH is enabled with the `nghttp2` provider, and the traffic is routed to a TCP-only or DoT backend.
- DNS over HTTPS is not enabled by default.
- The CVSS score is 7.5, with the vector AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H for vulnerable configurations.

**Workarounds:**

- Refuse incoming AXFR/IXFR requests using a DNSdist rule.
- Switch to the legacy `h2o` provider for DoH by setting `library='h2o'` in the `addDOHLocal` directive.

**Patch Information:**

- A minimal patch is available for version 1.9.3.
- Upgrading to version 1.9.4 resolves this issue.