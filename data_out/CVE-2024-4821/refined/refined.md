Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the `su_lightbox` shortcode of the "Shortcodes Ultimate" WordPress plugin. Specifically, the `src` attribute of the `su_lightbox` shortcode was not properly sanitized before being outputted.

**Weaknesses/Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is stored XSS. The plugin fails to properly sanitize the `src` attribute, allowing an attacker to inject malicious JavaScript code.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** By injecting malicious JavaScript, an attacker can execute arbitrary code in the context of a user's browser whenever a page containing the crafted shortcode is viewed.
- **Malicious Actions:**  This can lead to various malicious actions, such as:
    - Stealing cookies and session tokens.
    - Redirecting users to phishing websites.
    - Defacing the website.
    - Performing actions on behalf of the logged-in user.

**Attack Vectors:**
- **Shortcode Injection:** An attacker with Contributor level access or higher can inject the malicious shortcode into a post or page.
- **`src` Attribute:** The attack vector lies in the `src` attribute of the `su_lightbox` shortcode, where unsanitized input is placed.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker needs to have at least Contributor-level access to the WordPress site. This level of access allows them to create or edit posts and pages where they can inject the malicious shortcode.

**Additional Details:**

- The vulnerable code is located in the `lightbox.php` file of the plugin, specifically in the `su_shortcode_lightbox` function.
- The fix involves replacing `su_do_attribute( $atts['src'] )` with `str_replace( 'javascript', '', su_do_attribute( $atts['src'] ) )` in line 71 of the `lightbox.php` file to strip out the word `javascript` from the input.
- The vulnerability affects all versions of the plugin up to and including 7.1.6.
- The vulnerability was fixed in version 7.1.7 by stripping `javascript` from the src attribute.