```
{
  "vulnerability": {
    "root_cause": "The `Kirby\\Http\\Response::file()` method did not have an explicit fallback if the MIME type could not be determined from the file extension.",
    "weaknesses": [
      "Cross-site scripting (XSS) vulnerability due to incorrect MIME type handling during file serving.",
      "The vulnerability is caused by the underlying `Kirby\\Http\\Response::file()` method, which didn't have an explicit fallback if the MIME type could not be determined from the file extension."
    ],
    "impact": "An editor with write access to the Kirby Panel could upload a file with an unknown file extension that contains HTML code including harmful content like `<script>` tags. If the victim opened that link in a browser where they are logged in to Kirby and the file had not been opened by anyone since the upload, Kirby would serve the file with an incorrect MIME type of `text/html`. The browser would then run the script, which could for example trigger requests to Kirby's API with the permissions of the victim.",
    "attack_vectors": [
      "Upload of a file with an unknown extension containing malicious HTML/JavaScript code.",
      "User interaction is required as another user or visitor has to open the malicious file link."
    ],
    "required_attacker_capabilities": "An attacker needs write access to the Kirby Panel to upload a malicious file. They also need to trick other users or visitors into clicking on the link to the malicious file."
  },
  "affected_versions": [
    "<=3.5.8.2",
    "3.6.0-3.6.6.2",
    "3.7.0-3.7.5.1",
    "3.8.0-3.8.4",
    "3.9.0-3.9.5"
  ],
  "patched_versions": [
    "3.5.8.3",
    "3.6.6.3",
    "3.7.5.2",
    "3.8.4.1",
    "3.9.6"
  ],
    "additional_details": "The fix involves setting a fallback MIME type of `text/plain` and adding the `X-Content-Type-Options: nosniff` header when the MIME type of a file cannot be determined."
}
```