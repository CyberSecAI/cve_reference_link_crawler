
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

April 18, 2024
# GHSL-2023-257: Server-Side Request Forgery (SSRF) in Plane - CVE-2024-31461

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2023-12-06: Sent report to a maintainer’s email.
* 2024-01-04: Sent a follow up email.
* 2024-01-08: Received an answer that the fix was created.
* 2024-02-12: Sent a reminder about creating an advisory and the deadline for this report.
* 2024-02-14: Received an answer that a fix is being worked on.
* 2024-03-11: Sent a follow up email asking about when the new release with the fix will be published.
* 2024-03-13: Received an answer that the affected code will be removed in the upcoming release.
* 2024-04-08: Sent an email asking about the fix and advisory, and informed that GitHub Security Lab would like to requesting a CVE for this vulnerability.
* 2024-04-09: Received a reply with a draft advisory and that a CVE has been requested.
* 2024-04-10: [Advisory](https://github.com/makeplane/plane/security/advisories/GHSA-j77v-w36v-63v6) is published.

## Summary

Plane v0.13-dev is vulnerable to authenticated blind server-side request forgery vulnerability.

## Project

makeplane/plane

## Tested Version

[v0.13-dev](https://github.com/makeplane/plane/releases/tag/v0.13-dev)

## Details

### blind SSRF in jira.py (`GHSL-2023-257`)

The [`get`](https://github.com/makeplane/plane/blob/f7516197592ada159730c6bf1ffb9d851e62b92c/apiserver/plane/api/views/importer.py#L46) function of the `ServiceIssueImportSummaryEndpoint` class in [apiserver/plane/api/views/importer.py](https://github.com/makeplane/plane/blob/v0.13-dev/apiserver/plane/api/views/importer.py) takes the user-controlled [`cloud_hostname`](https://github.com/makeplane/plane/blob/f7516197592ada159730c6bf1ffb9d851e62b92c/apiserver/plane/api/views/importer.py#L104) GET parameter, and passes it to the [jira\_project\_issue\_summary](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L6) function, which concatenates it unsafely with a URL on lines [11](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L11), [16](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L16), [21](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L21), [26](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L26) and [36](https://github.com/makeplane/plane/blob/ee2ad400ba31fd99b1dc42f6d638f6e0b7d659d4/apiserver/plane/utils/importers/jira.py#L32) and consequently uses the URLs to make GET requests to arbitrary destinations, which leads to blind server side request forgery.

```
def jira_project_issue_summary(email, api_token, project_key, hostname):
    try:
        auth = HTTPBasicAuth(email, api_token)
        headers = {"Accept": "application/json"}

        issue_url = f"https://{hostname}/rest/api/3/search?jql=project={project_key} AND issuetype=Story"
        issue_response = requests.request(
            "GET", issue_url, headers=headers, auth=auth
        ).json()["total"]

        module_url = f"https://{hostname}/rest/api/3/search?jql=project={project_key} AND issuetype=Epic"
        module_response = requests.request(
            "GET", module_url, headers=headers, auth=auth
        ).json()["total"]

        status_url = f"https://{hostname}/rest/api/3/status/?jql=project={project_key}"
        status_response = requests.request(
            "GET", status_url, headers=headers, auth=auth
        ).json()

        labels_url = f"https://{hostname}/rest/api/3/label/?jql=project={project_key}"
        labels_response = requests.request(
            "GET", labels_url, headers=headers, auth=auth
        ).json()["total"]

        users_url = (
            f"https://{hostname}/rest/api/3/users/search?jql=project={project_key}"
        )
        users_response = requests.request(
            "GET", users_url, headers=headers, auth=auth
        ).json()

```

This issue was found with help of [CodeQL](https://codeql.github.com/codeql-query-help/python/py-full-ssrf/).

#### Impact

This issue may lead to `Information Disclosure`. The vulnerability allows for sending GET requests to arbitrary destinations using the server.

#### Resources

* [Blind SSRF](https://portswigger.net/web-security/ssrf/blind)

## CVE

* CVE-2024-31461

## Credit

This issue was discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-257` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

